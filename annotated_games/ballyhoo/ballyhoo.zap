	.INSERT "annotated_games/ballyhoo/ballyhoo_freq"
	.INSERT "annotated_games/ballyhoo/ballyhoo_data"

	.FUNCT PRINT-DESC1,OBJ
	ZERO? OBJ /FALSE
	CALL DPRINT,OBJ >STACK
	RSTACK

	.FUNCT PRINT-ID,ID,CONDITION=1
	ZERO? CONDITION /FALSE
	PRINTI "[ID: "
	PRINT ID
	PRINTI ", PRSO: "
	CALL PRINT-DESC1,PRSO
	PRINTI ", PRSI: "
	CALL PRINT-DESC1,PRSI
	PRINTI "]"
	RTRUE

	.FUNCT PRINT-DEBUG,TEXT,CONDITION=1
	ZERO? CONDITION /FALSE
	PRINTI "DEBUG FLAG: "
	PRINT TEXT
	RTRUE

	.FUNCT IS-THEFT?
	EQUAL? PRSA,V?TAKE \FALSE
	EQUAL? PRSO,ANDREW-CLOTHES,BALLOON,BANANA /TRUE
	EQUAL? PRSO,BANNER,BLACKJACK,BOOKS /TRUE
	EQUAL? PRSO,BUCKET,BUTTON,CAR /TRUE
	EQUAL? PRSO,CHAIN,CHAIR,CHANDELIER /TRUE
	EQUAL? PRSO,COAT,COSTUME,CRANK /TRUE
	EQUAL? PRSO,CROWBAR,CURTAINS,DEGREE /TRUE
	EQUAL? PRSO,DESK,DESK-ON-WAGON,DIAL /TRUE
	EQUAL? PRSO,DRESS,FLASK,FLOWER /TRUE
	EQUAL? PRSO,GLOBAL-MONEY,GRANOLA,GRATE /TRUE
	EQUAL? PRSO,GUY-WIRES,HEADPHONES,LADDER /TRUE
	EQUAL? PRSO,KEY,MASK,MIRROR /TRUE
	EQUAL? PRSO,NET,MOOSE,PANEL /TRUE
	EQUAL? PRSO,PHONE,PROD,RADIO /TRUE
	EQUAL? PRSO,SHAWL,SHEET,SOFA /TRUE
	EQUAL? PRSO,STOOL,SUIT,SUNGLASSES /TRUE
	EQUAL? PRSO,SWITCH,TABLE,TAFT /TRUE
	EQUAL? PRSO,TRADE-CARD,TRAY,TUX /TRUE
	EQUAL? PRSO,UNIFORM,WHIP \FALSE
	RTRUE

	.FUNCT IS-OFF-LIMITS-DOOR?
	EQUAL? PRSO,BLUE-DOOR,APE-DOOR,LION-DOOR /TRUE
	EQUAL? PRSO,OFFICE-DOOR,ROUST-DOOR,TAMER-DOOR /TRUE
	EQUAL? PRSO,TRAP-DOOR,TRAP-DOOR,WARPED-DOOR \FALSE
	RTRUE

	.FUNCT IS-OBJECT-OR-PROPERTY?
	EQUAL? PRSO,ANDREW-CLOTHES,APE-DOOR,BALLOON /TRUE
	EQUAL? PRSO,BANANA,BANNER,BLACKJACK /TRUE
	EQUAL? PRSO,BLUE-DOOR,BOOKS,BUCKET /TRUE
	EQUAL? PRSO,BUTTON,CAGE,CANVAS /TRUE
	EQUAL? PRSO,CAR,CASE,CEILING /TRUE
	EQUAL? PRSO,CENTER-POLE,CHAIN,CHAIR /TRUE
	EQUAL? PRSO,CHANDELIER,CHEESE,COAT /TRUE
	EQUAL? PRSO,COSTUME,CRANK,CROWBAR /TRUE
	EQUAL? PRSO,CURTAINS,DEGREE,DESK /TRUE
	EQUAL? PRSO,DESK-ON-WAGON,DIAL,DOLLAR /TRUE
	EQUAL? PRSO,DRESS,FENCE,FLASK /TRUE
	EQUAL? PRSO,FLOWER,FOUNTAIN,GLOBAL-MONEY /TRUE
	EQUAL? PRSO,GLOBAL-NET,GRANOLA,GRATE /TRUE
	EQUAL? PRSO,GUY-WIRES,HEADPHONES,LADDER /TRUE
	EQUAL? PRSO,KEY,LIGHT,LION-CAGE /TRUE
	EQUAL? PRSO,MASK,MEAT,MIRROR /TRUE
	EQUAL? PRSO,NET,MOOSE,OFFICE-DOOR /TRUE
	EQUAL? PRSO,PANEL,PHONE,POLE /TRUE
	EQUAL? PRSO,PROD,RADIO,RIBBON /TRUE
	EQUAL? PRSO,RING,SHAWL,SHEET /TRUE
	EQUAL? PRSO,SOFA,STAIRCASE,STOOL /TRUE
	EQUAL? PRSO,STRAW,SUIT,SUNGLASSES /TRUE
	EQUAL? PRSO,SWITCH,TABLE,TAFT /TRUE
	EQUAL? PRSO,TENT,TIGHTROPE-OBJECT,TRADE-CARD /TRUE
	EQUAL? PRSO,TRAY,TURNSTILE,TUX /TRUE
	EQUAL? PRSO,UNIFORM,VEIL,WAGON /TRUE
	EQUAL? PRSO,WALLS,WARPED-DOOR,WHIP /TRUE
	EQUAL? PRSO,WINDOW \FALSE
	RTRUE

	.FUNCT BAD-TO-GIVE-TO-GIRL?
	EQUAL? PRSO,CASE,MEAT,MIRROR /TRUE
	EQUAL? PRSO,MOOSE,PROD,WHIP \FALSE
	RTRUE

	.FUNCT DANGEROUS-TO-PUT-ON?
	EQUAL? PRSO,CHAIR,CHANDELIER,CROWBAR /TRUE
	EQUAL? PRSO,DESK,DESK-ON-WAGON,LADDER /TRUE
	EQUAL? PRSO,LION-CAGE,MIRROR,MOOSE /TRUE
	EQUAL? PRSO,PANEL,PROD,RADIO /TRUE
	EQUAL? PRSO,SOFA,STOOL,TABLE /TRUE
	EQUAL? PRSO,WAGON,WHIP \FALSE
	RTRUE

	.FUNCT IS-PERSON?
	FSET? PRSO,PERSON /TRUE
	EQUAL? PRSO,FAT-EAST,FAT-HAND,FAT-WEST /TRUE
	RFALSE

	.FUNCT DANGEROUS-DRINK?
	RFALSE

	.FUNCT DANGEROUS-FOOD?,?TMP
	CALL IS-PART-OF-SELF? >?TMP
	ZERO? ?TMP /?L2
	RETURN ?TMP
?L2:	CALL IS-OBJECT-OR-PROPERTY? >STACK
	RSTACK

	.FUNCT IS-ANIMAL?
	EQUAL? PRSO,APE,BULL,MONKEY /TRUE
	EQUAL? PRSO,MOUSE,NIMROD \FALSE
	RTRUE

	.FUNCT IS-OBJ-PROP-ANIMAL?,?TMP
	CALL IS-OBJECT-OR-PROPERTY? >?TMP
	ZERO? ?TMP /?L2
	RETURN ?TMP
?L2:	CALL IS-ANIMAL? >STACK
	RSTACK

	.FUNCT IS-SELF?
	EQUAL? PRSO,ME \FALSE
	RTRUE

	.FUNCT IS-PART-OF-SELF?
	EQUAL? PRSO,HANDS,BACK,HEAD \FALSE
	RTRUE

	.FUNCT IS-PART-OF-SELF-OR-SELF?,?TMP
	CALL IS-SELF? >?TMP
	ZERO? ?TMP /?L2
	RETURN ?TMP
?L2:	CALL IS-PART-OF-SELF? >STACK
	RSTACK

	.FUNCT ENABLED?,RTN,C,E
	ADD C-TABLE,C-TABLELEN >E
	ADD C-TABLE,C-INTS >C
?L1:	EQUAL? C,E /FALSE
	GET C,C-RTN >STACK
	EQUAL? STACK,RTN \?L8
	GET C,C-ENABLED? >STACK
	ZERO? STACK \TRUE
	RFALSE
?L8:	ADD C,C-INTLEN >C
	JUMP ?L1

	.FUNCT RUNNING?,RTN,C,E,TICK
	ADD C-TABLE,C-TABLELEN >E
	ADD C-TABLE,C-INTS >C
?L1:	EQUAL? C,E /FALSE
	GET C,C-RTN >STACK
	EQUAL? STACK,RTN \?L9
	GET C,C-ENABLED? >STACK
	ZERO? STACK /FALSE
	GET C,C-TICK >TICK
	ZERO? TICK /FALSE
	GRTR? TICK,1 \TRUE
	RFALSE
?L9:	ADD C,C-INTLEN >C
	JUMP ?L1

	.FUNCT PICK-ONE,FROB,THIS=0,L,CNT,RND,MSG,RFROB
	GET FROB,0 >L
	GET FROB,1 >CNT
	DEC 'L
	ADD FROB,2 >FROB
	MUL CNT,2 >STACK
	ADD FROB,STACK >RFROB
	ZERO? THIS /?L1
	ZERO? CNT \?L1
	SET 'RND,THIS
	JUMP ?L3
?L1:	SUB L,CNT >STACK
	RANDOM STACK >RND
?L3:	GET RFROB,RND >MSG
	GET RFROB,1 >STACK
	PUT RFROB,RND,STACK
	PUT RFROB,1,MSG
	INC 'CNT
	EQUAL? CNT,L \?L4
	SET 'CNT,0
?L4:	PUT FROB,0,CNT
	RETURN MSG

	.FUNCT DPRINT,OBJ
	GETP OBJ,P?SDESC >STACK
	ZERO? STACK /?L1
	GETP OBJ,P?SDESC >STACK
	PRINT STACK
	RTRUE
?L1:	PRINTD OBJ
	RTRUE

	.FUNCT GO
START::
?L0:	SET 'WINNER,PROTAGONIST
	SET 'PLAYER,PROTAGONIST
	SET 'HERE,WINGS
	MOVE PROTAGONIST,WINGS
	CALL V-VERSION
	CRLF
	PRINTI "As you trudge along in the wake of the outflowing crowd, you thumb through your memories of this evening. Your experience of the circus, with its ballyhooed promises of wonderment and its ultimate disappointment, has been to sink your teeth into a candy apple whose fruit is rotten.

Never mind the outrageous prices, the Mt. Everest vantage point, the communistically long lines, the audience more savage than the lion act. And it wasn't the shabbiness of the performances themselves that's got you soured on Spangleland. No, instead it's that the circus is a reminder of your own secret irrational desire to steal the spotlight, to defy death, and to bask in the thunder of applause."
	CRLF
	CRLF
	CALL V-LOOK
	PUTB P-LEXV,0,59
	CALL MAIN-LOOP
	JUMP ?L0

	.FUNCT MAIN-LOOP,TRASH
?L1:	CALL MAIN-LOOP-1 >TRASH
	JUMP ?L1

	.FUNCT MAIN-LOOP-1,ICNT,OCNT,NUM,CNT,OBJ,TBL,V,PTBL,OBJ1,TMP
	SET 'CNT,0
	SET 'OBJ,0
	SET 'P-MULT,0
	SET 'PTBL,1
	CALL PARSER >P-WON
	ZERO? P-WON /?L1
	GET P-PRSI,P-MATCHLEN >ICNT
	GET P-PRSO,P-MATCHLEN >OCNT
	ZERO? P-IT-OBJECT /?L3
	CALL ACCESSIBLE?,P-IT-OBJECT >STACK
	ZERO? STACK /?L3
	SET 'TMP,0
?L5:	IGRTR? 'CNT,ICNT /?L6
	GET P-PRSI,CNT >STACK
	EQUAL? STACK,IT \?L5
	PUT P-PRSI,CNT,P-IT-OBJECT
	SET 'TMP,1
?L6:	ZERO? TMP \?L16
	SET 'CNT,0
?L15:	IGRTR? 'CNT,OCNT /?L16
	GET P-PRSO,CNT >STACK
	EQUAL? STACK,IT \?L15
	PUT P-PRSO,CNT,P-IT-OBJECT
?L16:	SET 'CNT,0
?L3:	ZERO? OCNT \?L25
	SET 'NUM,OCNT
	JUMP ?L32
?L25:	GRTR? OCNT,1 \?L27
	SET 'TBL,P-PRSO
	ZERO? ICNT \?L28
	SET 'OBJ,0
	JUMP ?L30
?L28:	GET P-PRSI,1 >OBJ
?L30:	SET 'NUM,OCNT
	JUMP ?L32
?L27:	GRTR? ICNT,1 \?L31
	SET 'PTBL,0
	SET 'TBL,P-PRSI
	GET P-PRSO,1 >OBJ
	SET 'NUM,ICNT
	JUMP ?L32
?L31:	SET 'NUM,1
?L32:	ZERO? OBJ \?L33
	EQUAL? ICNT,1 \?L33
	GET P-PRSI,1 >OBJ
?L33:	EQUAL? PRSA,V?WALK \?L36
	CALL PERFORM,PRSA,PRSO >V
	JUMP ?L61
?L36:	ZERO? NUM \?L38
	GETB P-SYNTAX,P-SBITS >STACK
	BAND STACK,P-SONUMS >STACK
	ZERO? STACK \?L39
	CALL PERFORM,PRSA >V
	SET 'PRSO,0
	JUMP ?L61
?L39:	ZERO? LIT \?L41
	PRINT TOO-DARK
	CRLF
	CALL STOP
	JUMP ?L61
?L41:	PRINTI "[There isn't anything to "
	GET P-ITBL,P-VERBN >TMP
	EQUAL? PRSA,V?TELL \?L47
	PRINTI "talk to"
	JUMP ?L53
?L47:	ZERO? P-OFLAG \?L52
	ZERO? P-MERGED /?L51
?L52:	GET TMP,0 >STACK
	PRINTB STACK
	JUMP ?L53
?L51:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
?L53:	PRINTI ".]"
	CRLF
	SET 'V,0
	CALL STOP
	JUMP ?L61
?L38:	SET 'P-NOT-HERE,0
	GRTR? NUM,1 \?L57
	SET 'P-MULT,1
?L57:	SET 'TMP,0
?L60:	IGRTR? 'CNT,NUM \?L62
	GRTR? P-NOT-HERE,0 \?L64
	PRINTI "[The "
	EQUAL? P-NOT-HERE,NUM /?L68
	PRINTI "other "
?L68:	PRINTI "object"
	EQUAL? P-NOT-HERE,1 /?L75
	PRINTI "s"
?L75:	PRINTI " that you mentioned "
	EQUAL? P-NOT-HERE,1 /?L82
	PRINTI "are"
	JUMP ?L86
?L82:	PRINTI "is"
?L86:	PRINTI "n't here.]"
	CRLF
	JUMP ?L61
?L64:	ZERO? TMP \?L61
	PRINT REFERRING
	CRLF
	JUMP ?L61
?L62:	ZERO? PTBL /?L96
	GET P-PRSO,CNT >OBJ1
	JUMP ?L98
?L96:	GET P-PRSI,CNT >OBJ1
?L98:	ZERO? PTBL /?L99
	SET 'PRSO,OBJ1
	JUMP ?L101
?L99:	SET 'PRSO,OBJ
?L101:	ZERO? PTBL /?L102
	SET 'PRSI,OBJ
	JUMP ?L104
?L102:	SET 'PRSI,OBJ1
?L104:	GRTR? NUM,1 /?L107
	GET P-ITBL,P-NC1 >STACK
	GET STACK,0 >STACK
	EQUAL? STACK,W?ALL \?L122
?L107:	EQUAL? OBJ1,NOT-HERE-OBJECT \?L108
	INC 'P-NOT-HERE
	JUMP ?L60
?L108:	EQUAL? P-GETFLAGS,P-ALL \?L110
	EQUAL? PRSA,V?TAKE \?L117
	LOC OBJ1 >STACK
	EQUAL? STACK,WINNER,HERE,PRSI /?L112
	LOC OBJ1 >STACK
	FSET? STACK,SURFACEBIT \?L60
?L112:	FSET? OBJ1,TAKEBIT /?L113
	FSET? OBJ1,TRYTAKEBIT \?L60
?L113:	EQUAL? OBJ1,DESK-ON-WAGON,FAT-HAND,DIAL /?L60
	EQUAL? OBJ1,STAND \?L114
	FSET? STAND,NDESCBIT /?L60
?L114:	EQUAL? OBJ1,MOUSE \?L115
	FSET? MOUSE,NDESCBIT /?L115
	IN? MOUSE,PROP-ROOM /?L60
?L115:	EQUAL? OBJ1,THUMB \?L116
	FSET? THUMB,NDESCBIT /?L60
?L116:	EQUAL? OBJ1,KEY \?L110
	FSET? KEY,TRYTAKEBIT /?L60
?L110:	EQUAL? PRSA,V?TAKE \?L117
	ZERO? PRSI /?L117
	IN? PRSO,PRSI \?L60
?L117:	EQUAL? P-GETFLAGS,P-ALL \?L120
	EQUAL? PRSA,V?DROP \?L118
	IN? OBJ1,WINNER \?L60
?L118:	EQUAL? P-GETFLAGS,P-ALL \?L120
	ZERO? PRSI /?L119
	EQUAL? PRSO,PRSI /?L60
?L119:	EQUAL? P-GETFLAGS,P-ALL \?L120
	EQUAL? PRSA,V?PUT \?L120
	CALL HELD?,PRSO,PRSI >STACK
	ZERO? STACK \?L60
?L120:	CALL ACCESSIBLE?,OBJ1 >STACK
	ZERO? STACK /?L60
	EQUAL? OBJ1,IT \?L123
	CALL DPRINT,P-IT-OBJECT
	JUMP ?L125
?L123:	CALL DPRINT,OBJ1
?L125:	PRINTI ": "
?L122:	SET 'TMP,1
	CALL PERFORM,PRSA,PRSO,PRSI >V
	EQUAL? V,M-FATAL \?L60
?L61:	EQUAL? V,M-FATAL /?L137
	EQUAL? PRSA,V?SUPER-BRIEF,V?BRIEF,V?TELL /?L137
	EQUAL? PRSA,V?VERSION,V?SAVE,V?VERBOSE /?L137
	EQUAL? PRSA,V?UNSCRIPT,V?SCRIPT,V?RESTORE /?L137
	LOC WINNER >STACK
	GETP STACK,P?ACTION >STACK
	CALL STACK,M-END >V
?L137:	EQUAL? PRSA,V?SCRIPT,V?RESTORE,V?SAVE /?L142
	EQUAL? PRSA,V?BRIEF,V?VERBOSE,V?UNSCRIPT /?L142
	EQUAL? PRSA,V?SUPER-BRIEF /?L142
	ZERO? P-OFLAG /?L142
?L142:	EQUAL? V,M-FATAL \?L147
	SET 'P-CONT,0
	JUMP ?L147
?L1:	SET 'P-CONT,0
?L147:	ZERO? P-WON /FALSE
	EQUAL? PRSA,V?SUPER-BRIEF,V?BRIEF,V?TELL /?L153
	EQUAL? PRSA,V?QUIT,V?VERSION,V?VERBOSE /?L153
	EQUAL? PRSA,V?RESTORE,V?SAVE,V?SCORE /?L153
	EQUAL? PRSA,V?HELP,V?UNSCRIPT,V?SCRIPT /?L153
	EQUAL? PRSA,V?RESTART /?L153
	CALL CLOCKER >V
?L153:	SET 'PRSA,0
	SET 'PRSO,0
	SET 'PRSI,0
	RETURN PRSI

	.FUNCT FIXED-FONT-ON
	GET 0,8 >STACK
	BOR STACK,2 >STACK
	PUT 0,8,STACK
	RTRUE

	.FUNCT FIXED-FONT-OFF
	GET 0,8 >STACK
	BAND STACK,-3 >STACK
	PUT 0,8,STACK
	RTRUE

	.FUNCT FAKE-ORPHAN,TMP
	CALL ORPHAN,P-SYNTAX,0
	PRINTI "[Be specific: What object do you want to "
	GET P-OTBL,P-VERBN >TMP
	ZERO? TMP \?L3
	PRINTI "tell"
	JUMP ?L8
?L3:	GETB P-VTBL,2 >STACK
	ZERO? STACK \?L7
	GET TMP,0 >STACK
	PRINTB STACK
	JUMP ?L8
?L7:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
	PUTB P-VTBL,2,0
?L8:	SET 'P-OFLAG,1
	SET 'P-WON,0
	GETB P-SYNTAX,P-SPREP1 >STACK
	CALL PREP-PRINT,STACK
	PRINTR "?]"

	.FUNCT PERFORM,A,O=0,I=0,V,OA,OO,OI
	SET 'OA,PRSA
	SET 'OO,PRSO
	SET 'OI,PRSI
	SET 'PRSA,A
	EQUAL? IT,I,O \?L1
	EQUAL? A,V?WALK /?L1
	ZERO? I \?L3
	CALL FAKE-ORPHAN
	RETURN 2
?L3:	PRINT REFERRING
	CRLF
	RETURN 2
?L1:	SET 'PRSO,O
	ZERO? PRSO /?L11
	EQUAL? PRSA,V?WALK /?L11
	EQUAL? PRSO,NOT-HERE-OBJECT /?L11
	SET 'P-IT-OBJECT,PRSO
?L11:	SET 'PRSI,I
	EQUAL? A,V?WALK /?L14
	EQUAL? NOT-HERE-OBJECT,PRSO,PRSI \?L14
	CALL D-APPLY,STR?36,NOT-HERE-OBJECT-F >V
	ZERO? V /?L14
	SET 'P-WON,0
	JUMP ?L24
?L14:	SET 'O,PRSO
	SET 'I,PRSI
	GETP WINNER,P?ACTION >STACK
	CALL D-APPLY,STR?37,STACK >V
	ZERO? V \?L24
	LOC WINNER >STACK
	GETP STACK,P?ACTION >STACK
	CALL D-APPLY,STR?38,STACK,M-BEG >V
	ZERO? V \?L24
	GET PREACTIONS,A >STACK
	CALL D-APPLY,STR?39,STACK >V
	ZERO? V \?L24
	ZERO? I /?L21
	GETP I,P?ACTION >STACK
	CALL D-APPLY,STR?40,STACK >V
	ZERO? V \?L24
?L21:	ZERO? O /?L23
	EQUAL? A,V?WALK /?L22
	LOC O >STACK
	ZERO? STACK /?L22
	LOC O >STACK
	GETP STACK,P?CONTFCN >STACK
	ZERO? STACK /?L22
	LOC O >STACK
	GETP STACK,P?CONTFCN >STACK
	CALL D-APPLY,STR?41,STACK >V
	ZERO? V \?L24
?L22:	ZERO? O /?L23
	EQUAL? A,V?WALK /?L23
	GETP O,P?ACTION >STACK
	CALL D-APPLY,STR?42,STACK >V
	ZERO? V \?L24
?L23:	GET ACTIONS,A >STACK
	CALL D-APPLY,0,STACK >V
	ZERO? V /?L24
?L24:	SET 'PRSA,OA
	SET 'PRSO,OO
	SET 'PRSI,OI
	RETURN V

	.FUNCT D-APPLY,STR,FCN,FOO=0,RES
	ZERO? FCN /FALSE
	ZERO? FOO /?L4
	CALL FCN,FOO >RES
	RETURN RES
?L4:	CALL FCN >RES
	RETURN RES

	.FUNCT QUEUE,RTN,TICK,CINT
	CALL INT,RTN >CINT
	PUT CINT,C-TICK,TICK
	RETURN CINT

	.FUNCT INT,RTN,E,C,INT?1
	ADD C-TABLE,C-TABLELEN >E
	ADD C-TABLE,C-INTS >C
?L1:	EQUAL? C,E \?L3
	SUB C-INTS,C-INTLEN >C-INTS
	ADD C-TABLE,C-INTS >INT?1
	PUT INT?1,C-RTN,RTN
	RETURN INT?1
?L3:	GET C,C-RTN >STACK
	EQUAL? STACK,RTN \?L5
	RETURN C
?L5:	ADD C,C-INTLEN >C
	JUMP ?L1

	.FUNCT CLOCKER,C,E,TICK,FLG=0
	ZERO? CLOCK-WAIT /?L1
	SET 'CLOCK-WAIT,0
	RFALSE
?L1:	ZERO? P-WON /?L4
	PUSH C-INTS
	JUMP ?L5
?L4:	PUSH 0
?L5:	ADD C-TABLE,STACK >C
	ADD C-TABLE,C-TABLELEN >E
?L7:	EQUAL? C,E \?L9
	INC 'MOVES
	RETURN FLG
?L9:	GET C,C-ENABLED? >STACK
	ZERO? STACK /?L15
	GET C,C-TICK >TICK
	ZERO? TICK /?L15
	SUB TICK,1 >STACK
	PUT C,C-TICK,STACK
	GRTR? TICK,1 /?L15
	GET C,C-RTN >STACK
	CALL STACK >STACK
	ZERO? STACK /?L15
	SET 'FLG,1
?L15:	ADD C,C-INTLEN >C
	JUMP ?L7

	.FUNCT PARSER,PTR=P-LEXSTART,WRD,VAL=0,VERB=0,OMERGED,OWINNER,OLEN,LEN,DIR=0,NW=0,LW=0,CNT=-1
?L1:	IGRTR? 'CNT,P-ITBLLEN /?L2
	ZERO? P-OFLAG \?L6
	GET P-ITBL,CNT >STACK
	PUT P-OTBL,CNT,STACK
?L6:	PUT P-ITBL,CNT,0
	JUMP ?L1
?L2:	SET 'IN-FRONT-FLAG,0
	SET 'P-DOLLAR-FLAG,0
	SET 'OMERGED,P-MERGED
	SET 'OWINNER,WINNER
	PUT P-NAMW,0,0
	PUT P-NAMW,1,0
	PUT P-ADJW,0,0
	PUT P-ADJW,1,0
	SET 'P-ADVERB,0
	SET 'P-MERGED,0
	SET 'P-END-ON-PREP,0
	PUT P-PRSO,P-MATCHLEN,0
	PUT P-PRSI,P-MATCHLEN,0
	PUT P-BUTS,P-MATCHLEN,0
	ZERO? QUOTE-FLAG \?L9
	EQUAL? WINNER,PLAYER /?L9
	SET 'WINNER,PLAYER
	LOC WINNER >STACK
	FSET? STACK,VEHBIT /?L11
	LOC WINNER >HERE
?L11:	CALL LIT?,HERE >LIT
?L9:	ZERO? RESERVE-PTR /?L15
	SET 'PTR,RESERVE-PTR
	CALL STUFF,P-LEXV,RESERVE-LEXV
	CALL INBUF-STUFF,P-INBUF,RESERVE-INBUF
	EQUAL? VERBOSITY,1,2 \?L17
	EQUAL? PLAYER,WINNER \?L17
	CRLF
?L17:	SET 'RESERVE-PTR,0
	SET 'P-CONT,0
	JUMP ?L24
?L15:	ZERO? P-CONT /?L20
	SET 'PTR,P-CONT
	EQUAL? VERBOSITY,1,2 \?L21
	EQUAL? PLAYER,WINNER \?L21
	CRLF
?L21:	SET 'P-CONT,0
	JUMP ?L24
?L20:	SET 'WINNER,PLAYER
	SET 'QUOTE-FLAG,0
	LOC WINNER >STACK
	FSET? STACK,VEHBIT /?L25
	LOC WINNER >HERE
?L25:	CALL LIT?,HERE >LIT
	EQUAL? VERBOSITY,1,2 \?L28
	CRLF
?L28:	PRINTI ">"
	READ P-INBUF,P-LEXV
	GETB P-LEXV,P-LEXWORDS >OLEN
?L24:	GETB P-LEXV,P-LEXWORDS >P-LEN
	ZERO? P-LEN \?L33
	PRINTI "[I beg your pardon?]"
	CRLF
	RFALSE
?L33:	GET P-LEXV,PTR >STACK
	EQUAL? STACK,W?OOPS \?L37
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?$PERIOD,W?$COMMA \?L38
	ADD PTR,P-LEXELEN >PTR
	DEC 'P-LEN
?L38:	GRTR? P-LEN,1 /?L41
	CALL YOU-CANT-USE,STR?43
	RFALSE
?L41:	GET OOPS-TABLE,O-PTR >STACK
	ZERO? STACK /?L43
	GRTR? P-LEN,2 \?L44
	PRINTI "[Warning: Only the first word after OOPS is used.]"
	CRLF
?L44:	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	GET OOPS-TABLE,O-PTR >STACK
	PUT AGAIN-LEXV,STACK,STACK
	SET 'WINNER,OWINNER
	GET OOPS-TABLE,O-PTR >STACK
	MUL STACK,P-LEXELEN >STACK
	ADD STACK,3 >STACK
	MUL PTR,P-LEXELEN >STACK
	ADD STACK,7 >STACK
	GETB P-LEXV,STACK >STACK
	MUL PTR,P-LEXELEN >STACK
	ADD STACK,6 >STACK
	GETB P-LEXV,STACK >STACK
	CALL INBUF-ADD,STACK,STACK,STACK
	CALL STUFF,P-LEXV,AGAIN-LEXV
	GETB P-LEXV,P-LEXWORDS >P-LEN
	GET OOPS-TABLE,O-START >PTR
	CALL INBUF-STUFF,P-INBUF,OOPS-INBUF
	JUMP ?L52
?L43:	PUT OOPS-TABLE,O-END,0
	PRINTI "[There was no word to replace.]"
	CRLF
	RFALSE
?L37:	PUT OOPS-TABLE,O-END,0
?L52:	GET P-LEXV,PTR >STACK
	EQUAL? STACK,W?AGAIN,W?G \?L53
	SET 'P-DOLLAR-FLAG,1
	ZERO? P-OFLAG \?L57
	CALL RUNNING?,I-CURSE >STACK
	ZERO? STACK /?L55
?L57:	CALL YOU-CANT-USE,STR?44
	RFALSE
?L55:	ZERO? P-WON \?L58
	PRINTI "[That would just repeat a mistake.]"
	CRLF
	RFALSE
?L58:	EQUAL? OWINNER,PLAYER /?L61
	CALL VISIBLE?,OWINNER >STACK
	ZERO? STACK \?L61
	PRINTI "[You can't see"
	CALL ARTICLE,OWINNER,1
	PRINTI " any more.]"
	CRLF
	RFALSE
?L61:	GRTR? P-LEN,1 \?L66
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?$PERIOD,W?$COMMA,W?THEN /?L69
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?AND \?L67
?L69:	ADD PTR,4 >PTR
	GETB P-LEXV,P-LEXWORDS >STACK
	SUB STACK,2 >STACK
	PUTB P-LEXV,P-LEXWORDS,STACK
	JUMP ?L73
?L67:	PRINT BAD-SENTENCE
	CRLF
	RFALSE
?L66:	ADD PTR,P-LEXELEN >PTR
	GETB P-LEXV,P-LEXWORDS >STACK
	DEC 'STACK
	PUTB P-LEXV,P-LEXWORDS,STACK
?L73:	GETB P-LEXV,P-LEXWORDS >STACK
	GRTR? STACK,0 \?L74
	CALL STUFF,RESERVE-LEXV,P-LEXV
	CALL INBUF-STUFF,RESERVE-INBUF,P-INBUF
	SET 'RESERVE-PTR,PTR
	JUMP ?L76
?L74:	SET 'RESERVE-PTR,0
?L76:	SET 'WINNER,OWINNER
	SET 'P-MERGED,OMERGED
	CALL INBUF-STUFF,P-INBUF,OOPS-INBUF
	CALL STUFF,P-LEXV,AGAIN-LEXV
	SET 'CNT,-1
	SET 'DIR,AGAIN-DIR
?L77:	IGRTR? 'CNT,P-ITBLLEN /?L84
	GET P-OTBL,CNT >STACK
	PUT P-ITBL,CNT,STACK
	JUMP ?L77
?L53:	CALL STUFF,AGAIN-LEXV,P-LEXV
	CALL INBUF-STUFF,OOPS-INBUF,P-INBUF
	PUT OOPS-TABLE,O-START,PTR
	MUL 4,P-LEN >STACK
	PUT OOPS-TABLE,O-LENGTH,STACK
	GETB P-LEXV,P-LEXWORDS >STACK
	MUL P-LEXELEN,STACK >STACK
	ADD PTR,STACK >STACK
	MUL 2,STACK >LEN
	SUB LEN,2 >STACK
	GETB P-LEXV,STACK >STACK
	SUB LEN,1 >STACK
	GETB P-LEXV,STACK >STACK
	ADD STACK,STACK >STACK
	PUT OOPS-TABLE,O-END,STACK
	SET 'RESERVE-PTR,0
	SET 'LEN,P-LEN
	SET 'P-NCN,0
	SET 'P-GETFLAGS,0
?L83:	DLESS? 'P-LEN,0 \?L85
	SET 'QUOTE-FLAG,0
	JUMP ?L84
?L85:	GET P-LEXV,PTR >WRD
	CALL CLEAN-TALK?,WRD >STACK
	ZERO? STACK \FALSE
	GET P-LEXV,PTR >WRD
	CALL BUZZER-WORD?,WRD >STACK
	ZERO? STACK \FALSE
	GET P-LEXV,PTR >WRD
	ZERO? WRD \?L90
	CALL NUMBER?,PTR >WRD
	ZERO? WRD /?L89
?L90:	EQUAL? WRD,W?TO \?L91
	EQUAL? VERB,ACT?TELL,ACT?ASK \?L91
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	CALL WT?,STACK,PS?VERB,P1?VERB >STACK
	ZERO? STACK /?L91
	PUT P-ITBL,P-VERB,ACT?TELL
	SET 'WRD,W?$QUOTE
	JUMP ?L94
?L91:	EQUAL? WRD,W?THEN \?L93
	GRTR? P-LEN,0 \?L93
	ZERO? VERB \?L93
	ZERO? QUOTE-FLAG \?L93
	PUT P-ITBL,P-VERB,ACT?TELL
	PUT P-ITBL,P-VERBN,0
	SET 'WRD,W?$QUOTE
	JUMP ?L94
?L93:	EQUAL? WRD,W?$PERIOD \?L94
	EQUAL? LW,W?MR,W?DR \?L94
	DEC 'P-NCN
	CALL CHANGE-LEXV,PTR,LW,1
	SET 'WRD,LW
	SET 'LW,0
?L94:	EQUAL? WRD,W?THEN,W?$PERIOD /?L98
	EQUAL? WRD,W?$QUOTE \?L96
?L98:	EQUAL? WRD,W?$QUOTE \?L103
	ZERO? QUOTE-FLAG /?L101
	SET 'QUOTE-FLAG,0
	JUMP ?L103
?L101:	SET 'QUOTE-FLAG,1
?L103:	ZERO? P-LEN /?L105
	ADD PTR,P-LEXELEN >P-CONT
?L105:	PUTB P-LEXV,P-LEXWORDS,P-LEN
	JUMP ?L84
?L96:	CALL WT?,WRD,PS?DIRECTION,P1?DIRECTION >VAL
	ZERO? VAL /?L107
	EQUAL? VERB,0,ACT?WALK,ACT?GO \?L107
	EQUAL? LEN,1 /?L108
	EQUAL? LEN,2 \?L109
	EQUAL? VERB,ACT?WALK,ACT?GO /?L108
?L109:	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >NW
	EQUAL? NW,W?THEN,W?$PERIOD,W?$QUOTE \?L110
	LESS? LEN,2 \?L108
?L110:	ZERO? QUOTE-FLAG /?L111
	EQUAL? LEN,2 \?L111
	EQUAL? NW,W?$QUOTE /?L108
?L111:	GRTR? LEN,2 \?L107
	EQUAL? NW,W?$COMMA,W?AND \?L107
?L108:	SET 'DIR,VAL
	EQUAL? NW,W?$COMMA,W?AND \?L112
	ADD PTR,P-LEXELEN >STACK
	CALL CHANGE-LEXV,STACK,W?THEN
?L112:	GRTR? LEN,2 /?L150
	SET 'QUOTE-FLAG,0
	JUMP ?L84
?L107:	CALL WT?,WRD,PS?VERB,P1?VERB >VAL
	ZERO? VAL /?L118
	ZERO? VERB \?L118
	SET 'P-PRSA-WORD,WRD
	SET 'VERB,VAL
	PUT P-ITBL,P-VERB,VAL
	PUT P-ITBL,P-VERBN,P-VTBL
	PUT P-VTBL,0,WRD
	MUL PTR,2 >STACK
	ADD STACK,2 >CNT
	GETB P-LEXV,CNT >STACK
	PUTB P-VTBL,2,STACK
	ADD CNT,1 >STACK
	GETB P-LEXV,STACK >STACK
	PUTB P-VTBL,3,STACK
	JUMP ?L150
?L118:	CALL WT?,WRD,PS?PREPOSITION,0 >VAL
	ZERO? VAL \?L120
	EQUAL? WRD,W?ALL,W?ONE,W?BOTH /?L121
	CALL WT?,WRD,PS?ADJECTIVE >STACK
	ZERO? STACK \?L121
	CALL WT?,WRD,PS?OBJECT >STACK
	ZERO? STACK /?L119
?L121:	SET 'VAL,0
?L120:	GRTR? P-LEN,0 \?L122
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?OF \?L122
	ZERO? VAL \?L160
	EQUAL? WRD,W?ALL,W?ONE,W?A /?L122
	EQUAL? WRD,W?BOTH /?L122
	EQUAL? WRD,W?FRONT,W?HEAD \?L150
	SET 'IN-FRONT-FLAG,1
	JUMP ?L150
?L122:	ZERO? VAL /?L127
?L160:	ZERO? P-LEN /?L128
	ADD PTR,2 >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?THEN,W?$PERIOD \?L127
?L128:	SET 'P-END-ON-PREP,1
	LESS? P-NCN,2 \?L150
	PUT P-ITBL,P-PREP1,VAL
	PUT P-ITBL,P-PREP1N,WRD
	JUMP ?L150
?L127:	EQUAL? P-NCN,2 \?L132
	PRINTI "[There were too many nouns in that sentence.]"
	CRLF
	RFALSE
?L132:	INC 'P-NCN
	EQUAL? VAL,PR?IN \?L136
	ADD PTR,2 >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?FRONT \?L136
	SET 'IN-FRONT-FLAG,1
	JUMP ?L140
?L136:	ADD PTR,2 >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?FRONT,W?HEAD /?L139
	ADD PTR,3 >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?FRONT,W?HEAD /?L139
	ADD PTR,4 >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?FRONT,W?HEAD \?L138
?L139:	SET 'IN-FRONT-FLAG,1
	JUMP ?L140
?L138:	EQUAL? VAL,PR?DOWN \?L140
	ADD PTR,2 >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?IN \?L140
	ADD PTR,4 >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?FRONT \?L140
	SET 'IN-FRONT-FLAG,1
?L140:	CALL CLAUSE,PTR,VAL,WRD >PTR
	ZERO? PTR /FALSE
	LESS? PTR,0 \?L150
	SET 'QUOTE-FLAG,0
	JUMP ?L84
?L119:	CALL WT?,WRD,PS?BUZZ-WORD >STACK
	ZERO? STACK \?L150
	EQUAL? VERB,ACT?TELL \?L148
	CALL WT?,WRD,PS?VERB,P1?VERB >STACK
	ZERO? STACK /?L148
	EQUAL? WINNER,PLAYER \?L148
	CALL TELL-SEE-MANUAL
	RFALSE
?L148:	CALL CANT-USE,PTR
	RFALSE
?L89:	CALL UNKNOWN-WORD,PTR
	RFALSE
?L150:	SET 'LW,WRD
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L83
?L84:	PUT OOPS-TABLE,O-PTR,0
	ZERO? DIR /?L151
	SET 'PRSA,V?WALK
	SET 'PRSO,DIR
	SET 'P-OFLAG,0
	SET 'P-WALK-DIR,DIR
	SET 'AGAIN-DIR,DIR
	RTRUE
?L151:	SET 'P-WALK-DIR,0
	SET 'AGAIN-DIR,0
	ZERO? P-OFLAG /?L154
	CALL ORPHAN-MERGE
?L154:	CALL SYNTAX-CHECK >STACK
	ZERO? STACK /FALSE
	CALL SNARF-OBJECTS >STACK
	ZERO? STACK /FALSE
	CALL MANY-CHECK >STACK
	ZERO? STACK /FALSE
	CALL TAKE-CHECK >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT CHANGE-LEXV,PTR,WRD,PTRS?=0,X,Y,Z
	ZERO? PTRS? /?L1
	SUB PTR,P-LEXELEN >STACK
	MUL 2,STACK >STACK
	ADD 2,STACK >X
	GETB P-LEXV,X >Y
	MUL 2,PTR >STACK
	ADD 2,STACK >Z
	PUTB P-LEXV,Z,Y
	PUTB AGAIN-LEXV,Z,Y
	ADD 1,X >STACK
	GETB P-LEXV,STACK >Y
	MUL 2,PTR >STACK
	ADD 3,STACK >Z
	PUTB P-LEXV,Z,Y
	PUTB AGAIN-LEXV,Z,Y
?L1:	PUT P-LEXV,PTR,WRD
	PUT AGAIN-LEXV,PTR,WRD
	RTRUE

	.FUNCT STUFF,DEST,SRC,MAX=29,PTR=P-LEXSTART,CTR=1,BPTR
	GETB SRC,0 >STACK
	PUTB DEST,0,STACK
	GETB SRC,1 >STACK
	PUTB DEST,1,STACK
?L1:	GET SRC,PTR >STACK
	PUT DEST,PTR,STACK
	MUL PTR,2 >STACK
	ADD STACK,2 >BPTR
	GETB SRC,BPTR >STACK
	PUTB DEST,BPTR,STACK
	MUL PTR,2 >STACK
	ADD STACK,3 >BPTR
	GETB SRC,BPTR >STACK
	PUTB DEST,BPTR,STACK
	ADD PTR,P-LEXELEN >PTR
	IGRTR? 'CTR,MAX \?L1
	RTRUE

	.FUNCT INBUF-STUFF,DEST,SRC,CNT=-1
?L1:	IGRTR? 'CNT,59 /TRUE
	GETB SRC,CNT >STACK
	PUTB DEST,CNT,STACK
	JUMP ?L1

	.FUNCT INBUF-ADD,LEN,BEG,SLOT?1,DBEG,CTR=0,TMP,?TMP
	GET OOPS-TABLE,O-END >TMP
	ZERO? TMP /?L1
	SET 'DBEG,TMP
	JUMP ?L3
?L1:	GET OOPS-TABLE,O-LENGTH >TMP
	GETB AGAIN-LEXV,TMP >?TMP
	ADD TMP,1 >STACK
	GETB AGAIN-LEXV,STACK >STACK
	ADD ?TMP,STACK >DBEG
?L3:	ADD DBEG,LEN >STACK
	PUT OOPS-TABLE,O-END,STACK
?L4:	ADD BEG,CTR >STACK
	GETB P-INBUF,STACK >STACK
	ADD DBEG,CTR >STACK
	PUTB OOPS-INBUF,STACK,STACK
	INC 'CTR
	EQUAL? CTR,LEN \?L4
	PUTB AGAIN-LEXV,SLOT?1,DBEG
	SUB SLOT?1,1 >STACK
	PUTB AGAIN-LEXV,STACK,LEN
	RTRUE

	.FUNCT WT?,PTR,BIT,B1=5,OFFS=P-P1OFF,TYP
	GETB PTR,P-PSOFF >TYP
	BTST TYP,BIT \FALSE
	GRTR? B1,4 /TRUE
	BAND TYP,P-P1BITS >TYP
	EQUAL? TYP,B1 /?L6
	INC 'OFFS
?L6:	GETB PTR,OFFS >STACK
	RSTACK

	.FUNCT CLAUSE,PTR,VAL,WRD,OFF,NUM,ANDFLG=0,FIRST??=1,NW,LW=0
	SUB P-NCN,1 >STACK
	MUL STACK,2 >OFF
	ZERO? VAL /?L1
	ADD P-PREP1,OFF >NUM
	PUT P-ITBL,NUM,VAL
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,WRD
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L3
?L1:	INC 'P-LEN
?L3:	ZERO? P-LEN \?L4
	DEC 'P-NCN
	RETURN -1
?L4:	ADD P-NC1,OFF >NUM
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	PUT P-ITBL,NUM,STACK
	GET P-LEXV,PTR >STACK
	EQUAL? STACK,W?THE,W?A,W?AN \?L7
	GET P-ITBL,NUM >STACK
	ADD STACK,4 >STACK
	PUT P-ITBL,NUM,STACK
?L7:	DLESS? 'P-LEN,0 \?L12
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,STACK
	RETURN -1
?L12:	GET P-LEXV,PTR >WRD
	ZERO? WRD \?L17
	CALL NUMBER?,PTR >WRD
	ZERO? WRD /?L15
?L17:	ZERO? P-LEN \?L18
	SET 'NW,0
	JUMP ?L20
?L18:	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >NW
?L20:	EQUAL? WRD,W?$PERIOD \?L21
	EQUAL? LW,W?MR,W?DR \?L21
	SET 'LW,0
	JUMP ?L42
?L21:	EQUAL? WRD,W?AND,W?$COMMA \?L23
	SET 'ANDFLG,1
	JUMP ?L42
?L23:	EQUAL? WRD,W?ALL,W?ONE,W?BOTH \?L24
	EQUAL? NW,W?OF \?L42
	DEC 'P-LEN
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L42
?L24:	EQUAL? WRD,W?THEN,W?$PERIOD /?L29
	CALL WT?,WRD,PS?PREPOSITION >STACK
	ZERO? STACK /?L28
	GET P-ITBL,P-VERB >STACK
	ZERO? STACK /?L28
	ZERO? FIRST?? \?L28
?L29:	INC 'P-LEN
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,STACK
	SUB PTR,P-LEXELEN >STACK
	RSTACK
?L28:	ZERO? ANDFLG /?L30
	GET P-ITBL,P-VERB >STACK
	ZERO? STACK \?L30
	SUB PTR,4 >PTR
	ADD PTR,2 >STACK
	CALL CHANGE-LEXV,STACK,W?THEN
	ADD P-LEN,2 >P-LEN
	JUMP ?L42
?L30:	CALL WT?,WRD,PS?OBJECT >STACK
	ZERO? STACK /?L31
	GRTR? P-LEN,0 \?L32
	EQUAL? NW,W?OF \?L32
	EQUAL? WRD,W?ALL,W?ONE \?L42
?L32:	CALL WT?,WRD,PS?ADJECTIVE,P1?ADJECTIVE >STACK
	ZERO? STACK /?L34
	ZERO? NW /?L34
	CALL WT?,NW,PS?OBJECT >STACK
	ZERO? STACK \?L42
	CALL WT?,NW,PS?ADJECTIVE >STACK
	ZERO? STACK \?L42
?L34:	ZERO? ANDFLG \?L36
	EQUAL? NW,W?BUT,W?EXCEPT,W?AND /?L36
	EQUAL? NW,W?$COMMA /?L36
	ADD PTR,2 >STACK
	MUL STACK,2 >STACK
	ADD P-LEXV,STACK >STACK
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,STACK
	RETURN PTR
?L36:	SET 'ANDFLG,0
	JUMP ?L42
?L31:	CALL WT?,WRD,PS?ADJECTIVE >STACK
	ZERO? STACK \?L42
	CALL WT?,WRD,PS?BUZZ-WORD >STACK
	ZERO? STACK \?L42
	CALL WT?,WRD,PS?PREPOSITION >STACK
	ZERO? STACK \?L42
	CALL CANT-USE,PTR
	RFALSE
?L15:	CALL UNKNOWN-WORD,PTR
	RFALSE
?L42:	SET 'LW,WRD
	SET 'FIRST??,0
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L7

	.FUNCT NUMBER?,PTR,CNT,BPTR,CHR,SUM=0,TIM=0,DOLLAR?1=0,EXC=0,CCTR,TMP,NW
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	GETB STACK,2 >CNT
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	GETB STACK,3 >BPTR
?L1:	DLESS? 'CNT,0 /?L2
	GETB P-INBUF,BPTR >CHR
	EQUAL? CHR,58 \?L6
	ZERO? EXC \FALSE
	SET 'TIM,SUM
	SET 'SUM,0
	JUMP ?L14
?L6:	GRTR? SUM,9999 /FALSE
	LESS? CHR,58 \?L12
	GRTR? CHR,47 \?L12
	SUB CHR,48 >STACK
	MUL SUM,10 >STACK
	ADD STACK,STACK >SUM
	JUMP ?L14
?L12:	EQUAL? CHR,36 \FALSE
	SET 'DOLLAR?1,1
?L14:	INC 'BPTR
	JUMP ?L1
?L2:	CALL CHANGE-LEXV,PTR,W?INTNUM
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >NW
	ZERO? DOLLAR?1 /?L28
	EQUAL? NW,W?$PERIOD \?L15
	GRTR? P-LEN,1 \?L15
	ADD PTR,4 >STACK
	CALL CENTS-CHECK,STACK >TMP
	ZERO? TMP /?L30
	EQUAL? TMP,100 \?L19
	SET 'TMP,0
?L19:	MUL 100,SUM >STACK
	ADD STACK,TMP >SUM
	SUB P-LEN,2 >CCTR
?L22:	DLESS? 'CCTR,0 /?L23
	ADD PTR,P-LEXELEN >PTR
	ADD PTR,4 >STACK
	GET P-LEXV,STACK >STACK
	CALL CHANGE-LEXV,PTR,STACK
	ADD PTR,4 >STACK
	MUL STACK,2 >STACK
	ADD STACK,2 >STACK
	GETB P-LEXV,STACK >STACK
	MUL PTR,2 >STACK
	ADD STACK,2 >STACK
	PUTB P-LEXV,STACK,STACK
	ADD PTR,4 >STACK
	MUL STACK,2 >STACK
	ADD STACK,3 >STACK
	GETB P-LEXV,STACK >STACK
	MUL PTR,2 >STACK
	ADD STACK,3 >STACK
	PUTB P-LEXV,STACK,STACK
	JUMP ?L22
?L23:	SUB P-LEN,2 >P-LEN
	GETB P-LEXV,P-LEXWORDS >STACK
	SUB STACK,2 >STACK
	PUTB P-LEXV,P-LEXWORDS,STACK
	JUMP ?L30
?L15:	ZERO? DOLLAR?1 /?L28
	MUL SUM,100 >SUM
	JUMP ?L30
?L28:	EQUAL? NW,W?DOLLAR \?L29
	SET 'DOLLAR?1,1
	MUL SUM,100 >SUM
	JUMP ?L30
?L29:	EQUAL? NW,W?CENT,W?CENTS \?L30
	SET 'DOLLAR?1,1
?L30:	GRTR? SUM,9999 /FALSE
	ZERO? EXC /?L34
	SET 'P-EXCHANGE,0
	JUMP ?L39
?L34:	ZERO? TIM /?L35
	SET 'P-EXCHANGE,0
	GRTR? TIM,23 /FALSE
	MUL TIM,60 >STACK
	ADD SUM,STACK >SUM
	JUMP ?L39
?L35:	SET 'P-EXCHANGE,0
?L39:	ZERO? DOLLAR?1 /?L40
	GRTR? SUM,0 \?L40
	SET 'P-AMOUNT,SUM
	SET 'P-DOLLAR-FLAG,1
	PUTP INTNUM,P?SDESC,STR?45
	RETURN W?MONEY
?L40:	SET 'P-NUMBER,SUM
	PUTP INTNUM,P?SDESC,STR?46
	RETURN W?NUMBER

	.FUNCT CENTS-CHECK,PTR,CNT,BPTR,CCTR=0,CHR,SUM=0
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	GETB STACK,2 >CNT
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	GETB STACK,3 >BPTR
?L1:	DLESS? 'CNT,0 /?L2
	GETB P-INBUF,BPTR >CHR
	IGRTR? 'CCTR,2 /FALSE
	LESS? CHR,58 \FALSE
	GRTR? CHR,47 \FALSE
	SUB CHR,48 >STACK
	MUL SUM,10 >STACK
	ADD STACK,STACK >SUM
	INC 'BPTR
	JUMP ?L1
?L2:	ZERO? SUM \?L10
	RETURN 100
?L10:	EQUAL? CCTR,1 \?L12
	MUL 10,SUM >STACK
	RSTACK
?L12:	RETURN SUM

	.FUNCT ORPHAN-MERGE,CNT=-1,TEMP,VERB,BEG,END,ADJ=0,WRD,?TMP
	SET 'P-OFLAG,0
	GET P-ITBL,P-VERBN >STACK
	GET STACK,0 >WRD
	CALL WT?,WRD,PS?VERB,P1?VERB >?TMP
	GET P-OTBL,P-VERB >STACK
	EQUAL? ?TMP,STACK /?L3
	CALL WT?,WRD,PS?ADJECTIVE >STACK
	ZERO? STACK /?L1
?L3:	SET 'ADJ,1
	JUMP ?L4
?L1:	CALL WT?,WRD,PS?OBJECT,P1?OBJECT >STACK
	ZERO? STACK /?L4
	ZERO? P-NCN \?L4
	PUT P-ITBL,P-VERB,0
	PUT P-ITBL,P-VERBN,0
	ADD P-LEXV,2 >STACK
	PUT P-ITBL,P-NC1,STACK
	ADD P-LEXV,6 >STACK
	PUT P-ITBL,P-NC1L,STACK
	SET 'P-NCN,1
?L4:	GET P-ITBL,P-VERB >VERB
	ZERO? VERB /?L6
	ZERO? ADJ \?L6
	GET P-OTBL,P-VERB >STACK
	EQUAL? VERB,STACK \FALSE
?L6:	EQUAL? P-NCN,2 /FALSE
	GET P-OTBL,P-NC1 >STACK
	EQUAL? STACK,1 \?L9
	GET P-ITBL,P-PREP1 >TEMP
	GET P-OTBL,P-PREP1 >STACK
	EQUAL? TEMP,STACK /?L12
	ZERO? TEMP \FALSE
?L12:	ZERO? ADJ /?L13
	ADD P-LEXV,2 >STACK
	PUT P-OTBL,P-NC1,STACK
	GET P-ITBL,P-NC1L >STACK
	ZERO? STACK \?L15
	ADD P-LEXV,6 >STACK
	PUT P-ITBL,P-NC1L,STACK
?L15:	ZERO? P-NCN \?L21
	SET 'P-NCN,1
	JUMP ?L21
?L13:	GET P-ITBL,P-NC1 >STACK
	PUT P-OTBL,P-NC1,STACK
?L21:	GET P-ITBL,P-NC1L >STACK
	PUT P-OTBL,P-NC1L,STACK
	JUMP ?L42
?L9:	GET P-OTBL,P-NC2 >STACK
	EQUAL? STACK,1 \?L23
	GET P-ITBL,P-PREP1 >TEMP
	GET P-OTBL,P-PREP2 >STACK
	EQUAL? TEMP,STACK /?L26
	ZERO? TEMP \FALSE
?L26:	ZERO? ADJ /?L29
	ADD P-LEXV,2 >STACK
	PUT P-ITBL,P-NC1,STACK
	GET P-ITBL,P-NC1L >STACK
	ZERO? STACK \?L29
	ADD P-LEXV,6 >STACK
	PUT P-ITBL,P-NC1L,STACK
?L29:	GET P-ITBL,P-NC1 >STACK
	PUT P-OTBL,P-NC2,STACK
	GET P-ITBL,P-NC1L >STACK
	PUT P-OTBL,P-NC2L,STACK
	SET 'P-NCN,2
	JUMP ?L42
?L23:	ZERO? P-ACLAUSE /?L42
	EQUAL? P-NCN,1 /?L35
	ZERO? ADJ \?L35
	SET 'P-ACLAUSE,0
	RFALSE
?L35:	GET P-ITBL,P-NC1 >BEG
	ZERO? ADJ /?L38
	ADD P-LEXV,2 >BEG
	SET 'ADJ,0
?L38:	GET P-ITBL,P-NC1L >END
?L41:	GET BEG,0 >WRD
	EQUAL? BEG,END \?L43
	ZERO? ADJ /?L45
	CALL ACLAUSE-WIN,ADJ
	JUMP ?L42
?L45:	SET 'P-ACLAUSE,0
	RFALSE
?L43:	ZERO? ADJ \?L48
	GETB WRD,P-PSOFF >STACK
	BTST STACK,PS?ADJECTIVE /?L49
	EQUAL? WRD,W?ALL,W?ONE \?L48
?L49:	SET 'ADJ,WRD
	JUMP ?L51
?L48:	EQUAL? WRD,W?ONE \?L50
	CALL ACLAUSE-WIN,ADJ
	JUMP ?L42
?L50:	GETB WRD,P-PSOFF >STACK
	BTST STACK,PS?OBJECT \?L51
	EQUAL? WRD,P-ANAM \?L52
	CALL ACLAUSE-WIN,ADJ
	JUMP ?L42
?L52:	CALL NCLAUSE-WIN
	JUMP ?L42
?L51:	ADD BEG,P-WORDLEN >BEG
	ZERO? END \?L41
	SET 'END,BEG
	SET 'P-NCN,1
	SUB BEG,4 >STACK
	PUT P-ITBL,P-NC1,STACK
	PUT P-ITBL,P-NC1L,BEG
	JUMP ?L41
?L42:	GET P-OVTBL,0 >STACK
	PUT P-VTBL,0,STACK
	GETB P-OVTBL,2 >STACK
	PUTB P-VTBL,2,STACK
	GETB P-OVTBL,3 >STACK
	PUTB P-VTBL,3,STACK
	PUT P-OTBL,P-VERBN,P-VTBL
	PUTB P-VTBL,2,0
?L60:	IGRTR? 'CNT,P-ITBLLEN \?L62
	SET 'P-MERGED,1
	RTRUE
?L62:	GET P-OTBL,CNT >STACK
	PUT P-ITBL,CNT,STACK
	JUMP ?L60

	.FUNCT ACLAUSE-WIN,ADJ
	GET P-OTBL,P-VERB >STACK
	PUT P-ITBL,P-VERB,STACK
	PUT P-CCTBL,CC-SBPTR,P-ACLAUSE
	ADD P-ACLAUSE,1 >STACK
	PUT P-CCTBL,CC-SEPTR,STACK
	PUT P-CCTBL,CC-DBPTR,P-ACLAUSE
	ADD P-ACLAUSE,1 >STACK
	PUT P-CCTBL,CC-DEPTR,STACK
	CALL CLAUSE-COPY,P-OTBL,P-OTBL,ADJ
	GET P-OTBL,P-NC2 >STACK
	ZERO? STACK /?L1
	SET 'P-NCN,2
?L1:	SET 'P-ACLAUSE,0
	RTRUE

	.FUNCT NCLAUSE-WIN
	PUT P-CCTBL,CC-SBPTR,P-NC1
	PUT P-CCTBL,CC-SEPTR,P-NC1L
	PUT P-CCTBL,CC-DBPTR,P-ACLAUSE
	ADD P-ACLAUSE,1 >STACK
	PUT P-CCTBL,CC-DEPTR,STACK
	CALL CLAUSE-COPY,P-ITBL,P-OTBL
	GET P-OTBL,P-NC2 >STACK
	ZERO? STACK /?L1
	SET 'P-NCN,2
?L1:	SET 'P-ACLAUSE,0
	RTRUE

	.FUNCT WORD-PRINT,CNT,BUF
?L1:	DLESS? 'CNT,0 /TRUE
	GETB P-INBUF,BUF >STACK
	PRINTC STACK
	INC 'BUF
	JUMP ?L1

	.FUNCT UNKNOWN-WORD,PTR,BUF,?TMP
	PUT OOPS-TABLE,O-PTR,PTR
	PRINTI "[I don't know the word """
	MUL PTR,2 >BUF
	ADD P-LEXV,BUF >STACK
	GETB STACK,2 >?TMP
	ADD P-LEXV,BUF >STACK
	GETB STACK,3 >STACK
	CALL WORD-PRINT,?TMP,STACK
	PRINTI ".""]"
	CRLF
	SET 'QUOTE-FLAG,0
	SET 'P-OFLAG,0
	RETURN P-OFLAG

	.FUNCT CANT-USE,PTR,BUF,?TMP
	PRINTI "[You used the word """
	MUL PTR,2 >BUF
	ADD P-LEXV,BUF >STACK
	GETB STACK,2 >?TMP
	ADD P-LEXV,BUF >STACK
	GETB STACK,3 >STACK
	CALL WORD-PRINT,?TMP,STACK
	PRINTI """ in a way that I don't understand.]"
	CRLF
	SET 'QUOTE-FLAG,0
	SET 'P-OFLAG,0
	RETURN P-OFLAG

	.FUNCT SYNTAX-CHECK,SYN,LEN,NUM,OBJ,DRIVE1=0,DRIVE2=0,PREP,VERB,TMP
	GET P-ITBL,P-VERB >VERB
	ZERO? VERB \?L1
	PRINTI "[There was no verb in that sentence!]"
	CRLF
	RFALSE
?L1:	SUB 255,VERB >STACK
	GET VERBS,STACK >SYN
	GETB SYN,0 >LEN
	INC 'SYN
?L6:	GETB SYN,P-SBITS >STACK
	BAND STACK,P-SONUMS >NUM
	GRTR? P-NCN,NUM /?L15
	LESS? NUM,1 /?L10
	ZERO? P-NCN \?L10
	GET P-ITBL,P-PREP1 >PREP
	ZERO? PREP /?L11
	GETB SYN,P-SPREP1 >STACK
	EQUAL? PREP,STACK \?L10
?L11:	SET 'DRIVE1,SYN
	JUMP ?L15
?L10:	GET P-ITBL,P-PREP1 >STACK
	GETB SYN,P-SPREP1 >STACK
	EQUAL? STACK,STACK \?L15
	EQUAL? NUM,2 \?L13
	EQUAL? P-NCN,1 \?L13
	SET 'DRIVE2,SYN
	JUMP ?L15
?L13:	GET P-ITBL,P-PREP2 >STACK
	GETB SYN,P-SPREP2 >STACK
	EQUAL? STACK,STACK \?L15
	CALL SYNTAX-FOUND,SYN
	RTRUE
?L15:	DLESS? 'LEN,1 \?L18
	ZERO? DRIVE1 \?L74
	ZERO? DRIVE2 \?L7
	CALL V-TELL-TIME
	RFALSE
?L18:	ADD SYN,P-SYNLEN >SYN
	JUMP ?L6
?L7:	ZERO? DRIVE1 /?L25
?L74:	GETB DRIVE1,P-SPREP1 >STACK
	GETB DRIVE1,P-SLOC1 >STACK
	GETB DRIVE1,P-SFWIM1 >STACK
	CALL GWIM,STACK,STACK,STACK >OBJ
	ZERO? OBJ /?L25
	PUT P-PRSO,P-MATCHLEN,1
	PUT P-PRSO,1,OBJ
	CALL SYNTAX-FOUND,DRIVE1 >STACK
	RSTACK
?L25:	ZERO? DRIVE2 /?L27
	GETB DRIVE2,P-SPREP2 >STACK
	GETB DRIVE2,P-SLOC2 >STACK
	GETB DRIVE2,P-SFWIM2 >STACK
	CALL GWIM,STACK,STACK,STACK >OBJ
	ZERO? OBJ /?L27
	PUT P-PRSI,P-MATCHLEN,1
	PUT P-PRSI,1,OBJ
	CALL SYNTAX-FOUND,DRIVE2 >STACK
	RSTACK
?L27:	EQUAL? VERB,ACT?FIND \?L28
	PRINTI "[That question can't be answered.]"
	CRLF
	RFALSE
?L28:	EQUAL? WINNER,PLAYER \?L32
	CALL ORPHAN,DRIVE1,DRIVE2
	PRINTI "[Wh"
	JUMP ?L36
?L32:	PRINTI "[Your command was not complete. Next time, type wh"
?L36:	EQUAL? VERB,ACT?WALK,ACT?GO,ACT?LEAN /?L41
	EQUAL? P-PRSA-WORD,W?CRAWL \?L39
?L41:	PRINTI "ere"
	JUMP ?L49
?L39:	ZERO? DRIVE1 /?L46
	GETB DRIVE1,P-SFWIM1 >STACK
	EQUAL? STACK,ACTORBIT /?L45
?L46:	ZERO? DRIVE2 /?L44
	GETB DRIVE2,P-SFWIM2 >STACK
	EQUAL? STACK,ACTORBIT \?L44
?L45:	PRINTI "om"
	JUMP ?L49
?L44:	PRINTI "at"
?L49:	EQUAL? WINNER,PLAYER \?L52
	PRINTI " do you want to "
	JUMP ?L56
?L52:	PRINTI " you want"
	CALL ARTICLE,WINNER,1
	PRINTI " to "
?L56:	CALL VERB-PRINT
	ZERO? DRIVE2 /?L61
	CALL CLAUSE-PRINT,P-NC1,P-NC1L
?L61:	SET 'P-OFLAG,1
	ZERO? DRIVE1 /?L64
	GETB DRIVE1,P-SPREP1 >STACK
	JUMP ?L66
?L64:	GETB DRIVE2,P-SPREP2 >STACK
?L66:	CALL PREP-PRINT,STACK
	EQUAL? WINNER,PLAYER \?L67
	SET 'P-OFLAG,1
	PRINTI "?]"
	CRLF
	RFALSE
?L67:	SET 'P-OFLAG,0
	PRINTI ".]"
	CRLF
	RFALSE

	.FUNCT VERB-PRINT,TMP
	GET P-ITBL,P-VERBN >TMP
	ZERO? TMP \?L1
	PRINTI "tell"
	RTRUE
?L1:	GETB P-VTBL,2 >STACK
	ZERO? STACK \?L5
	GET TMP,0 >STACK
	PRINTB STACK
	RTRUE
?L5:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
	PUTB P-VTBL,2,0
	RTRUE

	.FUNCT CANT-ORPHAN
	PRINTI """I don't understand! What are you referring to?"""
	CRLF
	RFALSE

	.FUNCT ORPHAN,D1,D2,CNT=-1
	ZERO? P-MERGED \?L1
	PUT P-OCLAUSE,P-MATCHLEN,0
?L1:	GET P-VTBL,0 >STACK
	PUT P-OVTBL,0,STACK
	GETB P-VTBL,2 >STACK
	PUTB P-OVTBL,2,STACK
	GETB P-VTBL,3 >STACK
	PUTB P-OVTBL,3,STACK
?L4:	IGRTR? 'CNT,P-ITBLLEN /?L5
	GET P-ITBL,CNT >STACK
	PUT P-OTBL,CNT,STACK
	JUMP ?L4
?L5:	EQUAL? P-NCN,2 \?L9
	PUT P-CCTBL,CC-SBPTR,P-NC2
	PUT P-CCTBL,CC-SEPTR,P-NC2L
	PUT P-CCTBL,CC-DBPTR,P-NC2
	PUT P-CCTBL,CC-DEPTR,P-NC2L
	CALL CLAUSE-COPY,P-ITBL,P-OTBL
?L9:	LESS? P-NCN,1 /?L12
	PUT P-CCTBL,CC-SBPTR,P-NC1
	PUT P-CCTBL,CC-SEPTR,P-NC1L
	PUT P-CCTBL,CC-DBPTR,P-NC1
	PUT P-CCTBL,CC-DEPTR,P-NC1L
	CALL CLAUSE-COPY,P-ITBL,P-OTBL
?L12:	ZERO? D1 /?L15
	GETB D1,P-SPREP1 >STACK
	PUT P-OTBL,P-PREP1,STACK
	PUT P-OTBL,P-NC1,1
	RTRUE
?L15:	ZERO? D2 /FALSE
	GETB D2,P-SPREP2 >STACK
	PUT P-OTBL,P-PREP2,STACK
	PUT P-OTBL,P-NC2,1
	RTRUE

	.FUNCT CLAUSE-PRINT,BPTR,EPTR,THE?=1
	GET P-ITBL,EPTR >STACK
	GET P-ITBL,BPTR >STACK
	CALL BUFFER-PRINT,STACK,STACK,THE? >STACK
	RSTACK

	.FUNCT BUFFER-PRINT,BEG,END,CP,NOSP=0,WRD,FIRST??=1,PN=0
?L1:	EQUAL? BEG,END /TRUE
	ZERO? NOSP /?L6
	SET 'NOSP,0
	JUMP ?L8
?L6:	PRINTI " "
?L8:	GET BEG,0 >WRD
	EQUAL? WRD,W?$PERIOD \?L11
	SET 'NOSP,1
	JUMP ?L15
?L11:	EQUAL? WRD,W?ME \?L13
	CALL DPRINT,ME
	SET 'PN,1
	JUMP ?L15
?L13:	CALL NAME?,WRD >STACK
	ZERO? STACK /?L14
	CALL CAPITALIZE,BEG
	SET 'PN,1
	JUMP ?L15
?L14:	ZERO? FIRST?? /?L16
	ZERO? PN \?L16
	ZERO? CP /?L16
	PRINTI "the "
?L16:	ZERO? P-OFLAG \?L23
	ZERO? P-MERGED /?L21
?L23:	PRINTB WRD
	JUMP ?L25
?L21:	EQUAL? WRD,W?IT \?L24
	CALL ACCESSIBLE?,P-IT-OBJECT >STACK
	ZERO? STACK /?L24
	CALL DPRINT,P-IT-OBJECT
	JUMP ?L25
?L24:	GETB BEG,3 >STACK
	GETB BEG,2 >STACK
	CALL WORD-PRINT,STACK,STACK
?L25:	SET 'FIRST??,0
?L15:	ADD BEG,P-WORDLEN >BEG
	JUMP ?L1

	.FUNCT NAME?,WRD
	EQUAL? WRD,W?HARRY,W?ELSIE,W?NIMROD /TRUE
	EQUAL? WRD,W?SMALDO,W?EDDIE,W?HARRY /TRUE
	EQUAL? WRD,W?CONSTA,W?THUMB,W?COMRAD /TRUE
	EQUAL? WRD,W?CHUCKLES,W?JENNY,W?ANDREW /TRUE
	EQUAL? WRD,W?BILL,W?BILLY,W?MONDAY /TRUE
	EQUAL? WRD,W?GOTTFR,W?KATZEN,W?WILHEL /TRUE
	EQUAL? WRD,W?MUNRAB,W?HERR,W?TINA /TRUE
	EQUAL? WRD,W?RIMSHA,W?HOWARD,W?ED /TRUE
	EQUAL? WRD,W?COKE,W?WILLIAM,W?JERRY /TRUE
	EQUAL? WRD,W?ANNIE,W?OAKLEY,W?MAHLER /TRUE
	EQUAL? WRD,W?KATZ,W?JOEY,W?CHELSEA /TRUE
	EQUAL? WRD,W?TAFT,W?HANNIBAL,W?ANDY /TRUE
	EQUAL? WRD,W?JENNIF,W?MR,W?GENATOSSIO /TRUE
	EQUAL? WRD,W?MALCOM,W?GLORIA /TRUE
	EQUAL? WRD,W?DUFFY,W?SGT \FALSE
	RTRUE

	.FUNCT CAPITALIZE,PTR
	ZERO? P-OFLAG \?L3
	ZERO? P-MERGED /?L1
?L3:	GET PTR,0 >STACK
	PRINTB STACK
	RTRUE
?L1:	GETB PTR,3 >STACK
	GETB P-INBUF,STACK >STACK
	SUB STACK,32 >STACK
	PRINTC STACK
	GETB PTR,3 >STACK
	INC 'STACK
	GETB PTR,2 >STACK
	DEC 'STACK
	CALL WORD-PRINT,STACK,STACK >STACK
	RSTACK

	.FUNCT PREP-PRINT,PREP,WRD
	ZERO? PREP /FALSE
	PRINTI " "
	EQUAL? PREP,PR?THROUGH \?L5
	PRINTI "through"
	RTRUE
?L5:	CALL PREP-FIND,PREP >WRD
	PRINTB WRD
	RTRUE

	.FUNCT CLAUSE-COPY,SRC,DEST,INSRT=0,BEG,END
	GET P-CCTBL,CC-SBPTR >STACK
	GET SRC,STACK >BEG
	GET P-CCTBL,CC-SEPTR >STACK
	GET SRC,STACK >END
	GET P-OCLAUSE,P-MATCHLEN >STACK
	MUL STACK,P-LEXELEN >STACK
	ADD STACK,2 >STACK
	ADD P-OCLAUSE,STACK >STACK
	GET P-CCTBL,CC-DBPTR >STACK
	PUT DEST,STACK,STACK
?L1:	EQUAL? BEG,END \?L3
	GET P-OCLAUSE,P-MATCHLEN >STACK
	MUL STACK,P-LEXELEN >STACK
	ADD STACK,2 >STACK
	ADD P-OCLAUSE,STACK >STACK
	GET P-CCTBL,CC-DEPTR >STACK
	PUT DEST,STACK,STACK
	RTRUE
?L3:	ZERO? INSRT /?L6
	GET BEG,0 >STACK
	EQUAL? P-ANAM,STACK \?L6
	CALL CLAUSE-ADD,INSRT
?L6:	GET BEG,0 >STACK
	CALL CLAUSE-ADD,STACK
	ADD BEG,P-WORDLEN >BEG
	JUMP ?L1

	.FUNCT CLAUSE-ADD,WRD,PTR
	GET P-OCLAUSE,P-MATCHLEN >STACK
	ADD STACK,2 >PTR
	SUB PTR,1 >STACK
	PUT P-OCLAUSE,STACK,WRD
	PUT P-OCLAUSE,PTR,0
	PUT P-OCLAUSE,P-MATCHLEN,PTR
	RTRUE

	.FUNCT PREP-FIND,PREP,CNT=0,SIZE
	GET PREPOSITIONS,0 >STACK
	MUL STACK,2 >SIZE
?L1:	IGRTR? 'CNT,SIZE /FALSE
	GET PREPOSITIONS,CNT >STACK
	EQUAL? STACK,PREP \?L1
	SUB CNT,1 >STACK
	GET PREPOSITIONS,STACK >STACK
	RSTACK

	.FUNCT SYNTAX-FOUND,SYN
	SET 'P-SYNTAX,SYN
	GETB SYN,P-SACTION >PRSA
	RETURN PRSA

	.FUNCT GWIM,GBIT,LBIT,PREP,OBJ
	EQUAL? GBIT,RLANDBIT \?L1
	RETURN ROOMS
?L1:	SET 'P-GWIMBIT,GBIT
	SET 'P-SLOCBITS,LBIT
	PUT P-MERGE,P-MATCHLEN,0
	CALL GET-OBJECT,P-MERGE,0 >STACK
	ZERO? STACK /?L4
	SET 'P-GWIMBIT,0
	GET P-MERGE,P-MATCHLEN >STACK
	EQUAL? STACK,1 \FALSE
	GET P-MERGE,1 >OBJ
	PRINTI "["
	ZERO? PREP /?L21
	ZERO? P-END-ON-PREP \?L21
	CALL PREP-FIND,PREP >PREP
	PRINTB PREP
	EQUAL? PREP,W?OUT \?L12
	PRINTI " of"
?L12:	FSET? OBJ,NARTICLEBIT /?L17
	PRINTI " the "
	JUMP ?L21
?L17:	PRINTI " "
?L21:	CALL DPRINT,OBJ
	PRINTI "]"
	CRLF
	RETURN OBJ
?L4:	SET 'P-GWIMBIT,0
	RFALSE

	.FUNCT SNARF-OBJECTS,PTR
	GET P-ITBL,P-NC1 >PTR
	ZERO? PTR /?L5
	SET 'P-PHR,0
	GETB P-SYNTAX,P-SLOC1 >P-SLOCBITS
	GET P-ITBL,P-NC1L >STACK
	CALL SNARFEM,PTR,STACK,P-PRSO >STACK
	ZERO? STACK /FALSE
	GET P-BUTS,P-MATCHLEN >STACK
	ZERO? STACK /?L5
	CALL BUT-MERGE,P-PRSO >P-PRSO
?L5:	GET P-ITBL,P-NC2 >PTR
	ZERO? PTR /TRUE
	SET 'P-PHR,1
	GETB P-SYNTAX,P-SLOC2 >P-SLOCBITS
	GET P-ITBL,P-NC2L >STACK
	CALL SNARFEM,PTR,STACK,P-PRSI >STACK
	ZERO? STACK /FALSE
	GET P-BUTS,P-MATCHLEN >STACK
	ZERO? STACK /TRUE
	GET P-PRSI,P-MATCHLEN >STACK
	EQUAL? STACK,1 \?L14
	CALL BUT-MERGE,P-PRSO >P-PRSO
	RTRUE
?L14:	CALL BUT-MERGE,P-PRSI >P-PRSI
	RTRUE

	.FUNCT BUT-MERGE,TBL,LEN,BUTLEN,CNT=1,MATCHES=0,OBJ,NTBL
	GET TBL,P-MATCHLEN >LEN
	PUT P-MERGE,P-MATCHLEN,0
?L1:	DLESS? 'LEN,0 /?L2
	GET TBL,CNT >OBJ
	CALL ZMEMQ,OBJ,P-BUTS >STACK
	ZERO? STACK \?L6
	ADD MATCHES,1 >STACK
	PUT P-MERGE,STACK,OBJ
	INC 'MATCHES
?L6:	INC 'CNT
	JUMP ?L1
?L2:	PUT P-MERGE,P-MATCHLEN,MATCHES
	SET 'NTBL,P-MERGE
	SET 'P-MERGE,TBL
	RETURN NTBL

	.FUNCT SNARFEM,PTR,EPTR,TBL,BUT=0,LEN,WV,WRD,NW,WAS-ALL=0
	SET 'P-AND,0
	EQUAL? P-GETFLAGS,P-ALL \?L1
	SET 'WAS-ALL,1
?L1:	SET 'P-GETFLAGS,0
	PUT P-BUTS,P-MATCHLEN,0
	PUT TBL,P-MATCHLEN,0
	GET PTR,0 >WRD
?L4:	EQUAL? PTR,EPTR \?L6
?L56:	ZERO? BUT /?L9
	PUSH BUT
	JUMP ?L8
?L9:	PUSH TBL
?L8:	CALL GET-OBJECT,STACK >WV
	ZERO? WAS-ALL /?L10
	SET 'P-GETFLAGS,P-ALL
?L10:	RETURN WV
?L6:	GET PTR,P-LEXELEN >NW
	EQUAL? WRD,W?ALL,W?BOTH \?L14
	SET 'P-GETFLAGS,P-ALL
	EQUAL? NW,W?OF \?L51
	ADD PTR,P-WORDLEN >PTR
	JUMP ?L51
?L14:	CALL CLEAN-TALK?,WRD >STACK
	ZERO? STACK \FALSE
	CALL BUZZER-WORD?,WRD >STACK
	ZERO? STACK \FALSE
	EQUAL? WRD,W?BUT,W?EXCEPT \?L21
	ZERO? BUT /?L25
	PUSH BUT
	JUMP ?L24
?L25:	PUSH TBL
?L24:	CALL GET-OBJECT,STACK >STACK
	ZERO? STACK /FALSE
	SET 'BUT,P-BUTS
	PUT BUT,P-MATCHLEN,0
	JUMP ?L51
?L21:	EQUAL? WRD,W?A,W?ONE \?L26
	ZERO? P-ADJ \?L27
	SET 'P-GETFLAGS,P-ONE
	EQUAL? NW,W?OF \?L51
	ADD PTR,P-WORDLEN >PTR
	JUMP ?L51
?L27:	SET 'P-NAM,P-ONEOBJ
	ZERO? BUT /?L36
	PUSH BUT
	JUMP ?L35
?L36:	PUSH TBL
?L35:	CALL GET-OBJECT,STACK >STACK
	ZERO? STACK /FALSE
	ZERO? NW /TRUE
	JUMP ?L51
?L26:	EQUAL? WRD,W?AND,W?$COMMA \?L39
	EQUAL? NW,W?AND,W?$COMMA /?L39
	SET 'P-AND,1
	ZERO? BUT /?L43
	PUSH BUT
	JUMP ?L42
?L43:	PUSH TBL
?L42:	CALL GET-OBJECT,STACK >STACK
	ZERO? STACK /FALSE
	JUMP ?L51
?L39:	CALL WT?,WRD,PS?BUZZ-WORD >STACK
	ZERO? STACK \?L51
	EQUAL? WRD,W?AND,W?$COMMA /?L51
	EQUAL? WRD,W?OF \?L46
	ZERO? P-GETFLAGS \?L51
	SET 'P-GETFLAGS,P-INHIBIT
	JUMP ?L51
?L46:	CALL WT?,WRD,PS?ADJECTIVE,P1?ADJECTIVE >WV
	ZERO? WV /?L50
	CALL ADJ-CHECK,WRD >STACK
	ZERO? STACK /?L50
	EQUAL? NW,W?OF /?L50
	SET 'P-ADJ,WV
	SET 'P-ADJN,WRD
	JUMP ?L51
?L50:	CALL WT?,WRD,PS?OBJECT,P1?OBJECT >STACK
	ZERO? STACK /?L51
	SET 'P-NAM,WRD
	SET 'P-ONEOBJ,WRD
?L51:	EQUAL? PTR,EPTR /?L56
	ADD PTR,P-WORDLEN >PTR
	SET 'WRD,NW
	JUMP ?L4

	.FUNCT BUZZER-WORD?,WORD
	EQUAL? WORD,W?SAY \?L1
	CALL TELL-SEE-MANUAL
	RTRUE
?L1:	CALL DIRTY-WORD?,WORD >STACK
	ZERO? STACK \?L4
	CALL LIGHT-WEIGHT?,WORD >STACK
	ZERO? STACK /FALSE
?L4:	EQUAL? FOLLOW-FLAG,7 \?L5
	PRINTR "It didn't hurt that much."
?L5:	PRINTR "[That's uncalled for.]"

	.FUNCT CLEAN-TALK?,WORD
	CALL RUNNING?,I-CURSE >STACK
	ZERO? STACK /FALSE
	SET 'P-CONT,0
	INC 'CURSE-C
	EQUAL? HERE,APE-ROOM \?L3
	CALL DIRTY-WORD?,WORD >STACK
	ZERO? STACK /?L5
	CALL DPRINT,APE
	PRINTI " takes it as an insult. He"
	JUMP ?L12
?L5:	CALL LIGHT-WEIGHT?,WORD >STACK
	ZERO? STACK /?L9
	PRINTI "No respecter of nuance in language, "
	CALL DPRINT,APE
	JUMP ?L12
?L9:	PRINTI "No time for that. "
	CALL DPRINT,APE
?L12:	CALL LUGGAGE
	RTRUE
?L3:	CALL DIRTY-WORD?,WORD >STACK
	ZERO? STACK /?L15
	CALL PICK-ONE,TOO-DIRTY >STACK
	PRINT STACK
	CRLF
	RTRUE
?L15:	CALL LIGHT-WEIGHT?,WORD >STACK
	ZERO? STACK /?L18
	ZERO? CURSED-ONCE? /?L19
	SET 'CURSED-ONCE?,0
	CALL INT,I-CURSE >STACK
	PUT STACK,0,0
	PRINTR "Cut! Cut! Okay, that's a wrap."
?L19:	SET 'CURSED-ONCE?,1
	PRINTR "Bravisimo! Once more now, with feeling."
?L18:	GRTR? CURSE-C,4 \?L26
	SET 'CURSE-C,0
	CALL INT,I-CURSE >STACK
	PUT STACK,0,0
	PRINTR "You've lost the opportunity to curse the pain, and it overtakes you: ""Aaaaaaaarrrrrrrrrrgggggggghhhhhhh."""
?L26:	CALL PICK-ONE,COACH >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT DIRTY-WORD?,WORD
	EQUAL? WORD,W?SHIT,W?FUCK,W?BITCH /TRUE
	EQUAL? WORD,W?SHITHEAD,W?PISS,W?BASTARD /TRUE
	EQUAL? WORD,W?SCREW,W?FUCKING,W?FUCKED /TRUE
	EQUAL? WORD,W?CUNT,W?ASSHOLE /TRUE
	EQUAL? WORD,W?GODDAMNED,W?COCKSUCKER \FALSE
	RTRUE

	.FUNCT LIGHT-WEIGHT?,WORD
	EQUAL? WORD,W?CURSE,W?DAMN,W?DAMNED /TRUE
	EQUAL? WORD,W?HELL,W?DARN,W?SHUCKS /TRUE
	EQUAL? WORD,W?PEE,W?FUDGE,W?HECK /TRUE
	EQUAL? WORD,W?CUSS,W?DAGNAB,W?OUCH /TRUE
	EQUAL? WORD,W?DRAT,W?SHOOT \FALSE
	RTRUE

	.FUNCT ADJ-CHECK,WRD
	ZERO? P-ADJ /TRUE
	RFALSE

	.FUNCT GET-OBJECT,TBL,VRB=1,BITS,LEN,XBITS,TLEN,GCHECK=0,OLEN=0,OBJ
	SET 'XBITS,P-SLOCBITS
	GET TBL,P-MATCHLEN >TLEN
	BTST P-GETFLAGS,P-INHIBIT /TRUE
	ZERO? P-NAM \?L11
	ZERO? P-ADJ /?L8
	CALL WT?,P-ADJN,PS?OBJECT,P1?OBJECT >STACK
	ZERO? STACK /?L6
	SET 'P-NAM,P-ADJN
	SET 'P-ADJ,0
	JUMP ?L8
?L6:	CALL WT?,P-ADJN,PS?DIRECTION,P1?DIRECTION >BITS
	ZERO? BITS /?L8
	SET 'P-DIRECTION,BITS
?L8:	ZERO? P-NAM \?L11
	ZERO? P-ADJ \?L11
	EQUAL? P-GETFLAGS,P-ALL /?L77
	ZERO? P-GWIMBIT \?L11
	ZERO? VRB /FALSE
	PRINT NOUN-MISSING
	CRLF
	RFALSE
?L11:	EQUAL? P-GETFLAGS,P-ALL \?L21
?L77:	ZERO? P-SLOCBITS \?L19
?L21:	SET 'P-SLOCBITS,-1
?L19:	SET 'P-TABLE,TBL
?L23:	ZERO? GCHECK /?L25
	CALL GLOBAL-CHECK,TBL
	JUMP ?L27
?L25:	ZERO? LIT /?L28
	FCLEAR PLAYER,TRANSBIT
	CALL DO-SL,HERE,SOG,SIR
	FSET PLAYER,TRANSBIT
?L28:	CALL DO-SL,PLAYER,SH,SC
?L27:	GET TBL,P-MATCHLEN >STACK
	SUB STACK,TLEN >LEN
	BTST P-GETFLAGS,P-ALL /?L45
	BTST P-GETFLAGS,P-ONE \?L33
	ZERO? LEN /?L33
	EQUAL? LEN,1 /?L34
	RANDOM LEN >STACK
	GET TBL,STACK >STACK
	PUT TBL,1,STACK
	PRINTI "[How about the "
	GET TBL,1 >STACK
	CALL DPRINT,STACK
	PRINTI "?]"
	CRLF
?L34:	PUT TBL,P-MATCHLEN,1
	JUMP ?L45
?L33:	GRTR? LEN,1 /?L42
	ZERO? LEN \?L75
	EQUAL? P-SLOCBITS,-1 /?L45
?L42:	EQUAL? P-SLOCBITS,-1 \?L43
	SET 'P-SLOCBITS,XBITS
	SET 'OLEN,LEN
	GET TBL,P-MATCHLEN >STACK
	SUB STACK,LEN >STACK
	PUT TBL,P-MATCHLEN,STACK
	JUMP ?L23
?L43:	PUT P-NAMW,P-PHR,P-NAM
	PUT P-ADJW,P-PHR,P-ADJN
	ZERO? LEN \?L46
	SET 'LEN,OLEN
?L46:	ZERO? P-NAM /?L49
	ADD TLEN,1 >STACK
	GET TBL,STACK >OBJ
	ZERO? OBJ /?L49
	GETP OBJ,P?GENERIC >STACK
	CALL STACK >OBJ
	ZERO? OBJ /?L49
	EQUAL? OBJ,NOT-HERE-OBJECT /FALSE
	PUT TBL,1,OBJ
	PUT TBL,P-MATCHLEN,1
	SET 'P-NAM,0
	SET 'P-ADJ,0
	RTRUE
?L49:	ZERO? VRB /?L59
	EQUAL? WINNER,PROTAGONIST /?L54
	CALL CANT-ORPHAN
	SET 'P-NAM,0
	SET 'P-ADJ,0
	RFALSE
?L54:	ZERO? VRB /?L59
	ZERO? P-NAM /?L55
	CALL WHICH-PRINT,TLEN,LEN,TBL
	EQUAL? TBL,P-PRSO \?L56
	SET 'P-ACLAUSE,P-NC1
	JUMP ?L58
?L56:	SET 'P-ACLAUSE,P-NC2
?L58:	SET 'P-AADJ,P-ADJ
	SET 'P-ANAM,P-NAM
	CALL ORPHAN,0,0
	SET 'P-OFLAG,1
	JUMP ?L59
?L55:	ZERO? VRB /?L59
	PRINT NOUN-MISSING
	CRLF
?L59:	SET 'P-NAM,0
	SET 'P-ADJ,0
	RFALSE
?L45:	ZERO? LEN \?L75
	ZERO? GCHECK /?L64
	PUT P-NAMW,P-PHR,P-NAM
	PUT P-ADJW,P-PHR,P-ADJN
	ZERO? VRB /?L71
	SET 'P-SLOCBITS,XBITS
	ZERO? LIT \?L70
	EQUAL? PRSA,V?TELL /?L70
	EQUAL? PRSA,V?WHERE,V?WHAT,V?WHO \?L68
?L70:	CALL OBJ-FOUND,NOT-HERE-OBJECT,TBL
	SET 'P-XNAM,P-NAM
	SET 'P-XADJ,P-ADJ
	SET 'P-XADJN,P-ADJN
	SET 'P-NAM,0
	SET 'P-ADJ,0
	SET 'P-ADJN,0
	RTRUE
?L68:	PRINT TOO-DARK
	CRLF
?L71:	SET 'P-NAM,0
	SET 'P-ADJ,0
	RFALSE
?L64:	ZERO? LEN \?L75
	SET 'GCHECK,1
	JUMP ?L23
?L75:	SET 'P-SLOCBITS,XBITS
	PUT P-NAMW,P-PHR,P-NAM
	PUT P-ADJW,P-PHR,P-ADJN
	SET 'P-NAM,0
	SET 'P-ADJ,0
	RTRUE

	.FUNCT MOBY-FIND,TBL,OBJ=1,LEN,FOO,NAM,ADJ
	SET 'NAM,P-NAM
	SET 'ADJ,P-ADJ
	SET 'P-NAM,P-XNAM
	SET 'P-ADJ,P-XADJ
	PUT TBL,P-MATCHLEN,0
?L1:	IN? OBJ,ROOMS /?L5
	CALL THIS-IT?,OBJ >FOO
	ZERO? FOO /?L5
	CALL OBJ-FOUND,OBJ,TBL >FOO
?L5:	IGRTR? 'OBJ,LAST-OBJECT \?L1
	GET TBL,P-MATCHLEN >LEN
	EQUAL? LEN,1 \?L11
	GET TBL,1 >P-MOBY-FOUND
?L11:	SET 'P-NAM,NAM
	SET 'P-ADJ,ADJ
	RETURN LEN

	.FUNCT WHICH-PRINT,TLEN,LEN,TBL,OBJ,RLEN
	SET 'RLEN,LEN
	PRINTI "[Which"
	ZERO? P-OFLAG \?L5
	ZERO? P-MERGED \?L5
	ZERO? P-AND /?L3
?L5:	PRINTI " "
	PRINTB P-NAM
	JUMP ?L9
?L3:	EQUAL? TBL,P-PRSO \?L8
	CALL CLAUSE-PRINT,P-NC1,P-NC1L,0
	JUMP ?L9
?L8:	CALL CLAUSE-PRINT,P-NC2,P-NC2L,0
?L9:	PRINTI " do you mean, "
?L12:	INC 'TLEN
	GET TBL,TLEN >OBJ
	FSET? OBJ,NARTICLEBIT /?L14
	PRINTI "the "
?L14:	CALL DPRINT,OBJ
	EQUAL? LEN,2 \?L21
	EQUAL? RLEN,2 /?L23
	PRINTI ","
?L23:	PRINTI " or "
	JUMP ?L30
?L21:	GRTR? LEN,2 \?L30
	PRINTI ", "
?L30:	DLESS? 'LEN,1 \?L12
	PRINTR "?]"

	.FUNCT GLOBAL-CHECK,TBL,LEN,RMG,RMGL,CNT=0,OBJ,OBITS,FOO
	GET TBL,P-MATCHLEN >LEN
	SET 'OBITS,P-SLOCBITS
	GETPT HERE,P?GLOBAL >RMG
	ZERO? RMG /?L4
	PTSIZE RMG >STACK
	SUB STACK,1 >RMGL
?L3:	GETB RMG,CNT >OBJ
	CALL THIS-IT?,OBJ >STACK
	ZERO? STACK /?L5
	CALL OBJ-FOUND,OBJ,TBL
?L5:	IGRTR? 'CNT,RMGL \?L3
?L4:	GETPT HERE,P?PSEUDO >RMG
	ZERO? RMG /?L15
	PTSIZE RMG >STACK
	DIV STACK,4 >STACK
	SUB STACK,1 >RMGL
	SET 'CNT,0
?L14:	MUL CNT,2 >STACK
	GET RMG,STACK >STACK
	EQUAL? P-NAM,STACK \?L16
	SET 'LAST-PSEUDO-LOC,HERE
	MUL CNT,2 >STACK
	INC 'STACK
	GET RMG,STACK >STACK
	PUTP PSEUDO-OBJECT,P?ACTION,STACK
	GETPT PSEUDO-OBJECT,P?ACTION >STACK
	SUB STACK,5 >FOO
	GET P-NAM,0 >STACK
	PUT FOO,0,STACK
	GET P-NAM,1 >STACK
	PUT FOO,1,STACK
	CALL OBJ-FOUND,PSEUDO-OBJECT,TBL
	JUMP ?L15
?L16:	IGRTR? 'CNT,RMGL \?L14
?L15:	GET TBL,P-MATCHLEN >STACK
	EQUAL? STACK,LEN \FALSE
	SET 'P-SLOCBITS,-1
	SET 'P-TABLE,TBL
	CALL DO-SL,GLOBAL-OBJECTS,1,1
	SET 'P-SLOCBITS,OBITS
	RETURN P-SLOCBITS

	.FUNCT DO-SL,OBJ,BIT1,BIT2,BTS
	ADD BIT1,BIT2 >STACK
	BTST P-SLOCBITS,STACK \?L1
	CALL SEARCH-LIST,OBJ,P-TABLE,P-SRCALL >STACK
	RSTACK
?L1:	BTST P-SLOCBITS,BIT1 \?L4
	CALL SEARCH-LIST,OBJ,P-TABLE,P-SRCTOP >STACK
	RSTACK
?L4:	BTST P-SLOCBITS,BIT2 \TRUE
	CALL SEARCH-LIST,OBJ,P-TABLE,P-SRCBOT >STACK
	RSTACK

	.FUNCT SEARCH-LIST,OBJ,TBL,LVL,FLS,NOBJ
	FIRST? OBJ >OBJ \FALSE
?L3:	EQUAL? LVL,P-SRCBOT /?L5
	GETPT OBJ,P?SYNONYM >STACK
	ZERO? STACK /?L5
	CALL THIS-IT?,OBJ >STACK
	ZERO? STACK /?L5
	CALL OBJ-FOUND,OBJ,TBL
?L5:	EQUAL? LVL,P-SRCTOP \?L10
	FSET? OBJ,SEARCHBIT /?L10
	FSET? OBJ,SURFACEBIT \?L11
?L10:	FIRST? OBJ >NOBJ \?L11
	FSET? OBJ,OPENBIT /?L13
	FSET? OBJ,TRANSBIT /?L13
	ZERO? P-MOBY-FLAG /?L11
?L13:	FSET? OBJ,SURFACEBIT \?L14
	PUSH P-SRCALL
	JUMP ?L17
?L14:	FSET? OBJ,SEARCHBIT \?L16
	PUSH P-SRCALL
	JUMP ?L17
?L16:	PUSH P-SRCTOP
?L17:	CALL SEARCH-LIST,OBJ,TBL,STACK >FLS
?L11:	NEXT? OBJ >OBJ /?L3
	RTRUE

	.FUNCT OBJ-FOUND,OBJ,TBL,PTR
	GET TBL,P-MATCHLEN >PTR
	ADD PTR,1 >STACK
	PUT TBL,STACK,OBJ
	ADD PTR,1 >STACK
	PUT TBL,P-MATCHLEN,STACK
	RTRUE

	.FUNCT TAKE-CHECK
	GETB P-SYNTAX,P-SLOC1 >STACK
	CALL ITAKE-CHECK,P-PRSO,STACK >STACK
	ZERO? STACK /FALSE
	GETB P-SYNTAX,P-SLOC2 >STACK
	CALL ITAKE-CHECK,P-PRSI,STACK >STACK
	RSTACK

	.FUNCT ITAKE-CHECK,TBL,IBITS,PTR,OBJ,TAKEN
	GET TBL,P-MATCHLEN >PTR
	ZERO? PTR /TRUE
	BTST IBITS,SHAVE /?L3
	BTST IBITS,STAKE \TRUE
?L3:	DLESS? 'PTR,0 /TRUE
	ADD PTR,1 >STACK
	GET TBL,STACK >OBJ
	EQUAL? OBJ,IT \?L15
	CALL ACCESSIBLE?,P-IT-OBJECT >STACK
	ZERO? STACK \?L11
	PRINT REFERRING
	CRLF
	RFALSE
?L11:	SET 'OBJ,P-IT-OBJECT
?L15:	CALL HELD?,OBJ >STACK
	ZERO? STACK \?L3
	EQUAL? OBJ,GLOBAL-MONEY,INTNUM,HANDS /?L3
	EQUAL? OBJ,DOLLAR /?L3
	EQUAL? HERE,LEFT-HANGING \?L17
	EQUAL? OBJ,TIGHTROPE-OBJECT /?L3
?L17:	SET 'PRSO,OBJ
	FSET? OBJ,TRYTAKEBIT \?L21
	SET 'TAKEN,1
	JUMP ?L25
?L21:	EQUAL? WINNER,PROTAGONIST /?L23
	SET 'TAKEN,0
	JUMP ?L25
?L23:	BTST IBITS,STAKE \?L24
	CALL ITAKE,0 >STACK
	EQUAL? STACK,1 \?L24
	SET 'TAKEN,0
	JUMP ?L25
?L24:	SET 'TAKEN,1
?L25:	ZERO? TAKEN /?L55
	BTST IBITS,SHAVE \?L26
	GET TBL,P-MATCHLEN >STACK
	LESS? 1,STACK \?L28
	PRINT NOT-HOLDING
	PRINTI " all those things!"
	CRLF
	RFALSE
?L28:	EQUAL? OBJ,NOT-HERE-OBJECT \?L32
	EQUAL? HERE,PARLOR \?L33
	EQUAL? OBJ,PRSO \?L33
	CALL CANT-SEE,PRSO
	RFALSE
?L33:	CALL CANT-SEE,0,STR?47
	RFALSE
?L32:	EQUAL? WINNER,PROTAGONIST \?L37
	PRINT NOT-HOLDING
	JUMP ?L41
?L37:	PRINTI "It doesn't look like"
	CALL ARTICLE,WINNER,1
	PRINTI " is holding"
?L41:	CALL ARTICLE,OBJ,1
	SET 'P-IT-OBJECT,OBJ
	PRINT PERIOD
	RFALSE
?L26:	ZERO? TAKEN \?L3
?L55:	EQUAL? WINNER,PROTAGONIST \?L3
	PRINTI "[Taking"
	CALL ARTICLE,OBJ,1
	PRINTI " first]"
	CRLF
	JUMP ?L3

	.FUNCT MANY-CHECK,LOSS=0,TMP
	GET P-PRSO,P-MATCHLEN >STACK
	GRTR? STACK,1 \?L1
	GETB P-SYNTAX,P-SLOC1 >STACK
	BTST STACK,SMANY /?L1
	SET 'LOSS,1
	JUMP ?L3
?L1:	GET P-PRSI,P-MATCHLEN >STACK
	GRTR? STACK,1 \?L3
	GETB P-SYNTAX,P-SLOC2 >STACK
	BTST STACK,SMANY /?L3
	SET 'LOSS,2
?L3:	ZERO? LOSS /TRUE
	PRINTI "[You can't use multiple "
	EQUAL? LOSS,2 \?L9
	PRINTI "in"
?L9:	PRINTI "direct objects with """
	GET P-ITBL,P-VERBN >TMP
	ZERO? TMP \?L16
	PRINTI "tell"
	JUMP ?L22
?L16:	ZERO? P-OFLAG \?L21
	ZERO? P-MERGED /?L20
?L21:	GET TMP,0 >STACK
	PRINTB STACK
	JUMP ?L22
?L20:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
?L22:	PRINTI ".""]"
	CRLF
	RFALSE

	.FUNCT ZMEMQ,ITM,TBL,SIZE=-1,CNT=1
	ZERO? TBL /FALSE
	LESS? SIZE,0 /?L4
	SET 'CNT,0
	JUMP ?L6
?L4:	GET TBL,0 >SIZE
?L6:	GET TBL,CNT >STACK
	EQUAL? ITM,STACK /TRUE
	IGRTR? 'CNT,SIZE \?L6
	RFALSE

	.FUNCT ZMEMQB,ITM,TBL,SIZE,CNT=0
?L1:	GETB TBL,CNT >STACK
	EQUAL? ITM,STACK /TRUE
	IGRTR? 'CNT,SIZE \?L1
	RFALSE

	.FUNCT LIT?,RM,RMBIT=1,OHERE,LIT?1=0
	SET 'P-GWIMBIT,ONBIT
	SET 'OHERE,HERE
	SET 'HERE,RM
	ZERO? RMBIT /?L1
	FSET? RM,ONBIT \?L1
	SET 'LIT?1,1
	JUMP ?L10
?L1:	PUT P-MERGE,P-MATCHLEN,0
	SET 'P-TABLE,P-MERGE
	SET 'P-SLOCBITS,-1
	EQUAL? OHERE,RM \?L6
	CALL DO-SL,WINNER,1,1
	EQUAL? WINNER,PLAYER /?L6
	IN? PLAYER,RM \?L6
	CALL DO-SL,PLAYER,1,1
?L6:	CALL DO-SL,RM,1,1
	GET P-TABLE,P-MATCHLEN >STACK
	GRTR? STACK,0 \?L10
	SET 'LIT?1,1
?L10:	SET 'HERE,OHERE
	SET 'P-GWIMBIT,0
	RETURN LIT?1

	.FUNCT PRSO-PRINT,PTR
	ZERO? P-MERGED \?L3
	GET P-ITBL,P-NC1 >PTR
	GET PTR,0 >STACK
	EQUAL? STACK,W?IT \?L1
?L3:	PRINTI " "
	CALL DPRINT,PRSO >STACK
	RSTACK
?L1:	GET P-ITBL,P-NC1L >STACK
	CALL BUFFER-PRINT,PTR,STACK,0 >STACK
	RSTACK

	.FUNCT PRSI-PRINT,PTR
	ZERO? P-MERGED \?L3
	GET P-ITBL,P-NC2 >PTR
	GET PTR,0 >STACK
	EQUAL? STACK,W?IT \?L1
?L3:	PRINTI " "
	CALL DPRINT,PRSO >STACK
	RSTACK
?L1:	GET P-ITBL,P-NC2L >STACK
	CALL BUFFER-PRINT,PTR,STACK,0 >STACK
	RSTACK

	.FUNCT THIS-IT?,OBJ,SYNS
	FSET? OBJ,INVISIBLE /FALSE
	ZERO? P-NAM /?L3
	GETPT OBJ,P?SYNONYM >SYNS
	PTSIZE SYNS >STACK
	DIV STACK,2 >STACK
	DEC 'STACK
	CALL ZMEMQ,P-NAM,SYNS,STACK >STACK
	ZERO? STACK /FALSE
?L3:	ZERO? P-ADJ /?L4
	GETPT OBJ,P?ADJECTIVE >SYNS
	ZERO? SYNS /FALSE
	PTSIZE SYNS >STACK
	DEC 'STACK
	CALL ZMEMQB,P-ADJ,SYNS,STACK >STACK
	ZERO? STACK /FALSE
?L4:	ZERO? P-GWIMBIT /TRUE
	FSET? OBJ,P-GWIMBIT /TRUE
	RFALSE

	.FUNCT V-$0024COMMAND
	DIRIN 1
	RTRUE

	.FUNCT V-$0024RANDOM
	EQUAL? PRSO,INTNUM /?L1
	PRINTR "Illegal call to #RANDOM."
?L1:	SUB 0,P-NUMBER >STACK
	RANDOM STACK >STACK
	RTRUE

	.FUNCT V-$0024RECORD
	DIROUT D-RECORD-ON
	RTRUE

	.FUNCT V-$0024UNRECORD
	DIROUT D-RECORD-OFF
	RTRUE

	.FUNCT BACK-F
	CALL IS-NOUN?,W?STOMACH >STACK
	ZERO? STACK /FALSE
	EQUAL? PRSA,V?LISTEN \?L3
	CALL PERFORM,V?LISTEN,ROAR
	RTRUE
?L3:	CALL V-COUNT >STACK
	RSTACK

	.FUNCT INTNUM-F
	ZERO? P-DOLLAR-FLAG /?L1
	EQUAL? PRSA,V?TAKE,V?ASK-FOR,V?BET /?L1
	EQUAL? WINNER,PROTAGONIST \?L1
	GRTR? P-AMOUNT,POCKET-CHANGE \?L1
	PRINT THAT-MUCH
	RTRUE
?L1:	EQUAL? P-NUMBER,21 \FALSE
	EQUAL? INTNUM,PRSO \?L6
	CALL PERFORM,PRSA,BLACKJACK,PRSI
	RTRUE
?L6:	CALL PERFORM,PRSA,PRSO,BLACKJACK
	RTRUE

	.FUNCT GLOBAL-MONEY-F
	CALL DONT-HANDLE?,GLOBAL-MONEY >STACK
	ZERO? STACK \FALSE
	EQUAL? PRSA,V?FIND \?L3
	CALL V-DIG
	RTRUE
?L3:	EQUAL? PRSA,V?PASS /FALSE
	GRTR? POCKET-CHANGE,0 \?L5
	EQUAL? PRSA,V?COUNT \?L6
	PRINTI "You're carrying "
	CALL PRINT-AMOUNT,POCKET-CHANGE
	PRINT PERIOD
	RTRUE
?L6:	EQUAL? PRSA,V?EXAMINE \?L12
	PRINTI "It looks a lot like "
	CALL PRINT-AMOUNT,POCKET-CHANGE
	PRINT PERIOD
	RTRUE
?L12:	EQUAL? PRSA,V?TAKE \?L17
	CALL HAVE-IT >STACK
	RSTACK
?L17:	PRINTI "Treating your hard-earned cash this way won't get you anywhere."
	CRLF
	RETURN 2
?L5:	CALL CANT-SEE,GLOBAL-MONEY >STACK
	RSTACK

	.FUNCT DOLLAR-F
	LESS? POCKET-CHANGE,100 \?L1
	ZERO? POCKET-CHANGE /?L1
	PRINT THAT-MUCH
	RTRUE
?L1:	ZERO? P-MULT /?L5
	CALL SPECIFY-MONEY
	RETURN 2
?L5:	EQUAL? PRSA,V?BET \?L8
	GET P-ADJW,0 >STACK
	EQUAL? STACK,W?TWO \?L9
	SET 'P-AMOUNT,200
	JUMP ?L11
?L9:	SET 'P-AMOUNT,100
?L11:	SET 'P-DOLLAR-FLAG,1
	CALL PERFORM,V?BET,INTNUM
	RTRUE
?L8:	EQUAL? PRSA,V?EXAMINE /FALSE
	CALL GLOBAL-MONEY-F >STACK
	RSTACK

	.FUNCT NOT-HERE-OBJECT-F,TBL,PRSO?=1,OBJ,X=0
	EQUAL? PRSO,NOT-HERE-OBJECT \?L5
	EQUAL? PRSI,NOT-HERE-OBJECT \?L1
	PRINTR "[Those things aren't here!]"
?L1:	EQUAL? PRSO,NOT-HERE-OBJECT \?L5
	SET 'TBL,P-PRSO
	JUMP ?L6
?L5:	SET 'TBL,P-PRSI
	SET 'PRSO?,0
?L6:	ZERO? PRSO? /?L7
	EQUAL? PRSA,V?FIND,V?FOLLOW,V?PHONE /?L11
	EQUAL? PRSA,V?WHAT,V?WHERE,V?WHO /?L11
	EQUAL? PRSA,V?WAIT-FOR,V?WALK-TO,V?PHONE-WITH /?L11
	EQUAL? PRSA,V?BUY,V?CALL /?L11
	EQUAL? PRSO,GIRL \?L28
	EQUAL? PRSA,V?LISTEN \?L28
	IN? GIRL,LOCAL-GLOBALS \?L28
?L11:	SET 'X,1
	CALL FIND-NOT-HERE,TBL,PRSO? >OBJ
	ZERO? OBJ /FALSE
	EQUAL? OBJ,NOT-HERE-OBJECT /?L28
	RTRUE
?L7:	EQUAL? PRSA,V?ASK-ABOUT,V?ASK-FOR,V?TELL-ABOUT /?L22
	EQUAL? PRSA,V?SEARCH-OBJECT-FOR \?L28
?L22:	SET 'X,1
	CALL FIND-NOT-HERE,TBL,PRSO? >OBJ
	ZERO? OBJ /FALSE
	EQUAL? OBJ,NOT-HERE-OBJECT \TRUE
?L28:	ZERO? X /?L30
	PRINT SPECIFIC
	JUMP ?L55
?L30:	EQUAL? WINNER,PROTAGONIST \?L34
	PRINTI "[You can't "
	EQUAL? P-XNAM,W?CONVER,W?VOICE,W?VOICES \?L37
	PRINTI "hear"
	JUMP ?L41
?L37:	PRINTI "see"
?L41:	CALL NAME?,P-XNAM >STACK
	ZERO? STACK \?L44
	PRINTI " any"
?L44:	CALL NOT-HERE-PRINT,PRSO?
	PRINTI " here.]"
	CRLF
	JUMP ?L55
?L34:	EQUAL? THUMB,WINNER /FALSE
	EQUAL? DICK,WINNER \?L51
	FSET? DICK,RMUNGBIT /FALSE
	ZERO? DICK-UNRESPONSIVE \FALSE
?L51:	EQUAL? WINNER,GUARD /FALSE
	PRINTI "Looking confused,"
	CALL ARTICLE,WINNER,1
	PRINTI " says, ""I don't see"
	CALL NAME?,P-XNAM >STACK
	ZERO? STACK \?L60
	PRINTI " any"
?L60:	CALL NOT-HERE-PRINT,PRSO?
	PRINTI " here!"""
	CRLF
?L55:	CALL STOP >STACK
	RSTACK

	.FUNCT FIND-NOT-HERE,TBL,PRSO?,M-F,OBJ
	CALL MOBY-FIND,TBL >M-F
	EQUAL? 1,M-F \?L1
	ZERO? PRSO? /?L3
	SET 'PRSO,P-MOBY-FOUND
	SET 'P-IT-OBJECT,PRSO
	RFALSE
?L3:	SET 'PRSI,P-MOBY-FOUND
	RFALSE
?L1:	LESS? 1,M-F \?L6
	GET TBL,1 >OBJ
	GETP OBJ,P?GENERIC >STACK
	CALL STACK >OBJ
	ZERO? OBJ /?L6
	EQUAL? OBJ,NOT-HERE-OBJECT /TRUE
	ZERO? PRSO? /?L9
	SET 'PRSO,OBJ
	SET 'P-IT-OBJECT,PRSO
	RFALSE
?L9:	SET 'PRSI,OBJ
	RFALSE
?L6:	RETURN NOT-HERE-OBJECT

	.FUNCT NOT-HERE-PRINT,PRSO?
	EQUAL? P-XNAM,EDDIE \?L1
	PRINTI "anyone by that name"
	RTRUE
?L1:	ZERO? P-OFLAG /?L5
	ZERO? P-XADJ /?L6
	PRINTI " "
	PRINTB P-XADJN
?L6:	ZERO? P-XNAM /FALSE
	PRINTI " "
	PRINTB P-XNAM
	RTRUE
?L5:	ZERO? PRSO? /?L16
	GET P-ITBL,P-NC1L >STACK
	GET P-ITBL,P-NC1 >STACK
	CALL BUFFER-PRINT,STACK,STACK,0 >STACK
	RSTACK
?L16:	GET P-ITBL,P-NC2L >STACK
	GET P-ITBL,P-NC2 >STACK
	CALL BUFFER-PRINT,STACK,STACK,0 >STACK
	RSTACK

	.FUNCT LIGHT-F
	EQUAL? PRSA,V?LAMP-OFF,V?LAMP-ON \FALSE
	PRINTR "You've no access to the lighting equipment."

	.FUNCT DARKNESS-F
	EQUAL? PRSA,V?WALK-TO,V?BOARD,V?THROUGH \FALSE
	CALL V-WALK-AROUND >STACK
	RSTACK

	.FUNCT GROUND-F
	EQUAL? PRSA,V?CLIMB-FOO,V?CLIMB-ON,V?CLIMB-UP /?L3
	EQUAL? PRSA,V?BOARD \?L1
?L3:	CALL V-DIG >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?LOOK-UNDER \?L4
	CALL V-COUNT >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?SEARCH-OBJECT-FOR \?L5
	EQUAL? HERE,UNDER-STANDS \?L5
	EQUAL? PRSO,GROUND \?L5
	CALL PERFORM,V?SEARCH-OBJECT-FOR,GARBAGE,PRSI
	RTRUE
?L5:	EQUAL? PRSA,V?EXAMINE \?L7
	EQUAL? HERE,PLATFORM-1,PLATFORM-2,TIGHTROPE-ROOM \?L6
	CALL PERFORM,V?LOOK-DOWN
	RTRUE
?L6:	EQUAL? PRSA,V?EXAMINE \?L7
	EQUAL? HERE,APE-ROOM \?L7
	CALL V-LOOK >STACK
	RSTACK
?L7:	EQUAL? PRSA,V?THROUGH \?L8
	CALL V-WALK-AROUND >STACK
	RSTACK
?L8:	EQUAL? PRSA,V?LEAVE \FALSE
	CALL DO-WALK,P?UP >STACK
	RSTACK

	.FUNCT WALLS-F
	EQUAL? HERE,PROP-ROOM,WEST-CAMP \?L1
	CALL PERFORM,PRSA,CANVAS
	RTRUE
?L1:	EQUAL? PRSA,V?PUT \?L3
	EQUAL? PRSO,THUMB \?L3
	EQUAL? HERE,TAMER-ROOM \?L3
	CALL PERFORM,V?PUT,THUMB,CRAWL-SPACE
	RTRUE
?L3:	EQUAL? PRSA,V?KNOCK \FALSE
	EQUAL? HERE,TAMER-ROOM \FALSE
	IN? GIRL,LOCAL-GLOBALS \FALSE
	ZERO? GIRL-CRIED \FALSE
	CALL TELL-WIMPER >STACK
	RSTACK

	.FUNCT TELL-WIMPER
	SET 'GIRL-CRIED,1
	PRINTI "You can hear a faint whimper coming from the "
	CALL DPRINT,CRAWL-SPACE
	PRINTR "."

	.FUNCT CEILING-F
	EQUAL? HERE,ON-WAGON \?L1
	IN? MUNRAB,ON-WAGON \?L1
	CALL PERFORM,V?KNOCK,OFFICE-DOOR
	RTRUE
?L1:	EQUAL? PRSA,V?LOOK-UNDER \FALSE
	CALL PERFORM,V?LOOK
	RTRUE

	.FUNCT CORNER-F
	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L1
	CALL V-LOOK
	RTRUE
?L1:	EQUAL? PRSA,V?THROUGH,V?ENTER,V?WALK-TO \FALSE
	EQUAL? HERE,BLUE-ROOM \?L4
	CALL PERFORM,V?WALK-TO,POKER
	RTRUE
?L4:	PRINTI "You're close enough to the "
	CALL DPRINT,CORNER
	PRINTR " already."

	.FUNCT EGRESS-F
	EQUAL? PRSA,V?WHAT \?L1
	PRINTR "You'd have to see it to believe it."
?L1:	EQUAL? PRSA,V?WALK-TO \FALSE
	CALL DO-WALK,P?OUT >STACK
	RSTACK

	.FUNCT LADDER-F
	EQUAL? HERE,NEAR-WAGON \?L1
	FSET? LADDER,RMUNGBIT /?L1
	CALL CANT-SEE,LADDER >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?TAKE \?L3
	EQUAL? P-PRSA-WORD,W?TAKE,W?GET,W?REMOVE \?L4
	PRINTR "It's not takeable."
?L4:	CALL PERFORM,V?CLIMB-FOO,LADDER
	RTRUE
?L3:	EQUAL? HERE,ON-TENT \?L9
	EQUAL? PRSA,V?CLIMB-DOWN,V?FIND,V?EXAMINE /?L12
	EQUAL? PRSA,V?CLIMB-FOO \?L10
?L12:	CALL ENABLED?,I-POKE >STACK
	ZERO? STACK /?L13
	PRINTR "You desperately grope in the darkness for the rope ladder, but can't seem to find it."
?L13:	PRINTI "You can barely see the ladder. "
	EQUAL? PRSA,V?CLIMB-FOO,V?CLIMB-DOWN \?L20
	CALL DO-WALK,P?DOWN
	RTRUE
?L20:	CRLF
	RTRUE
?L10:	CALL ENABLED?,I-POKE >STACK
	ZERO? STACK /FALSE
	CALL CANT-SEE,LADDER >STACK
	RSTACK
?L9:	ZERO? END-GAME /?L27
	EQUAL? HERE,RING,PLATFORM-1 \?L27
	LOC PROTAGONIST >STACK
	EQUAL? STACK,STAND /?L27
	EQUAL? PRSA,V?UNTIE /?L27
	CALL TOUCHING?,LADDER >STACK
	ZERO? STACK /?L28
	CALL DO-WALK,P?UP >STACK
	RSTACK
?L28:	EQUAL? PRSA,V?EXAMINE \FALSE
	CALL TANGLED-ROPE,1 >STACK
	RSTACK
?L27:	EQUAL? PRSA,V?TAKE-WITH,V?UNTIE \?L32
	EQUAL? PRSI,POLE \?L32
	CALL PERFORM,V?UNTIE,LADDER
	RTRUE
?L32:	EQUAL? PRSA,V?CLIMB-FOO,V?CLIMB-UP \?L33
	EQUAL? HERE,CLOWN-ALLEY \?L33
	CALL PERFORM,V?BOARD,UPPER
	RTRUE
?L33:	EQUAL? PRSA,V?CLIMB-FOO \?L34
	EQUAL? HERE,ON-WAGON \?L34
	CALL PERFORM,V?CLIMB-DOWN,LADDER
	RTRUE
?L34:	EQUAL? PRSA,V?CLIMB-FOO,V?CLIMB-UP \?L35
	CALL DO-WALK,P?UP >STACK
	RSTACK
?L35:	EQUAL? PRSA,V?CLIMB-DOWN \FALSE
	EQUAL? HERE,ON-WAGON \?L37
	CALL CLIMB? >STACK
	ZERO? STACK \TRUE
	CALL RUNNING?,I-OFFICE >STACK
	ZERO? STACK /?L41
	CALL MUNRAB-ENTERS-OFFICE,1
?L41:	CALL GOTO,NEAR-WAGON
	RTRUE
?L37:	CALL DO-WALK,P?DOWN >STACK
	RSTACK

	.FUNCT CLIMB?,X,TO-GROUND?=1,GROUND?1=0
	ZERO? END-GAME /?L1
	EQUAL? HERE,RING \?L1
	IN? PROTAGONIST,STAND /?L1
	PRINTI "The rope "
	CALL DPRINT,LADDER
	PRINTR ", which is tangled around its platform, dangles down a couple of feet out of your reach."
?L1:	CALL CANT-CLIMB? >STACK
	ZERO? STACK /?L5
	FIRST? PROTAGONIST >X /?L6
?L6:	FSET? X,WORNBIT /?L9
	EQUAL? X,BALLOON,MOUSE \?L8
?L9:	NEXT? X >X /?L6
	JUMP ?L6
?L8:	GETP HERE,P?GROUND-LOC >GROUND?1
	ZERO? GROUND?1 /?L13
	MOVE X,GROUND?1
	JUMP ?L15
?L13:	SET 'TO-GROUND?,0
	MOVE X,HERE
?L15:	PRINTI "Trying to grip the "
	CALL DPRINT,LADDER
	PRINTI ", you fumble away"
	CALL ARTICLE,X,1
	ZERO? TO-GROUND? /?L18
	PRINTI " and it falls to the ground below"
?L18:	PRINT PERIOD
	RTRUE
?L5:	EQUAL? APE-LOC,1 \FALSE
	EQUAL? HERE,RING \FALSE
	SET 'APE-LOC,2
	FCLEAR PLATFORM-1,TOUCHBIT
	PRINTI "As you hoist "
	CALL DPRINT,ME
	PRINTI " onto the "
	CALL DPRINT,LADDER
	PRINTI ", the platform buckles with the addition of your weight. "
	CALL DPRINT,APE
	PRINTI " is spooked, and "
	IN? NET,MUNRAB /?L28
	PRINTI "loses his bundle which falls tragically in front of your horrified face to the ground below."
	CALL PRINT-ID,STR?48
	CALL FINISH >STACK
	RSTACK
?L28:	PRINTI "clambers up into the supporting apparatus as you board the platform."
	CRLF
	CRLF
	CALL META-LOC,RADIO >STACK
	EQUAL? STACK,PLATFORM-1 \?L35
	FSET? RADIO,ONBIT \?L35
	EQUAL? STATION,1170 \?L35
	PRINTI "In his distress, "
	CALL DPRINT,APE
	PRINTI " must not have noticed the radio playing."
	CRLF
	CRLF
?L35:	CALL GOTO,PLATFORM-1
	RTRUE

	.FUNCT CANT-CLIMB?
	CALL CCOUNT,PROTAGONIST >STACK
	GRTR? STACK,2 /?L3
	CALL WEIGHT,PROTAGONIST >STACK
	GRTR? STACK,30 \?L1
?L3:	CALL HELD?,POLE >STACK
	ZERO? STACK /TRUE
?L1:	CALL HELD?,POLE >STACK
	ZERO? STACK /?L6
	CALL CCOUNT,PROTAGONIST >STACK
	GRTR? STACK,1 /TRUE
?L6:	CALL HELD?,STAND >STACK
	ZERO? STACK /FALSE
	RTRUE

	.FUNCT UP-LADDER
	EQUAL? HERE,NEAR-WAGON \?L1
	FSET? LADDER,RMUNGBIT /?L1
	PRINT CANT-GO
	CRLF
	RFALSE
?L1:	CALL CLIMB? >STACK
	ZERO? STACK \FALSE
	CALL TELL-CLIMBING
	EQUAL? HERE,RING \?L8
	RETURN PLATFORM-1
?L8:	EQUAL? HERE,NEAR-WAGON \?L10
	RETURN ON-WAGON
?L10:	RETURN ON-TENT

	.FUNCT DOWN-LADDER
	CALL CLIMB? >STACK
	ZERO? STACK \FALSE
	CALL TELL-CLIMBING
	EQUAL? HERE,PLATFORM-1 \?L3
	RETURN RING
?L3:	EQUAL? HERE,ON-WAGON \?L5
	RETURN NEAR-WAGON
?L5:	RETURN ON-CAGE

	.FUNCT TELL-CLIMBING
	EQUAL? HERE,ON-WAGON \?L1
	CALL RUNNING?,I-OFFICE >STACK
	ZERO? STACK /?L1
	CALL MUNRAB-ENTERS-OFFICE,1
	RTRUE
?L1:	PRINTI "You grasp the "
	CALL DPRINT,LADDER
	PRINTI " firmly and climb "
	EQUAL? P-WALK-DIR,P?UP \?L6
	PRINTI "up"
	JUMP ?L10
?L6:	PRINTI "down"
?L10:	PRINTI " ..."
	CRLF
	CRLF
	RTRUE

	.FUNCT AIR-F
	EQUAL? PRSA,V?SMELL \FALSE
	CALL PERFORM,V?SMELL
	RTRUE

	.FUNCT HANDS-F,ACTOR
	EQUAL? PRSA,V?WAVE \?L1
	SET 'PRSO,0
	CALL PERFORM,V?WAVE-AT
	RTRUE
?L1:	EQUAL? PRSA,V?RUB,V?READ \?L3
	EQUAL? PRSO,HANDS \?L3
	CALL ENABLED?,I-HYP >STACK
	ZERO? STACK /?L3
	SET 'WINNER,HYP
	CALL PERFORM,PRSA,PRSO
	SET 'WINNER,PROTAGONIST
	RTRUE
?L3:	EQUAL? PRSA,V?EXAMINE,V?READ \?L4
	PRINTR "Your lifeline is very short."
?L4:	EQUAL? PRSA,V?CLAP \?L7
	SET 'PRSO,0
	CALL PERFORM,V?CLAP
	RTRUE
?L7:	EQUAL? PRSA,V?PUT \?L8
	EQUAL? PRSI,HANDS \?L8
	CALL PERFORM,V?TAKE,PRSO
	RTRUE
?L8:	EQUAL? PRSA,V?SHAKE \FALSE
	CALL FIND-IN,HERE,PERSON >ACTOR
	ZERO? ACTOR /?L10
	EQUAL? ACTOR,FAT \?L12
	CALL PERFORM,V?SHAKE,FAT-HAND
	RTRUE
?L12:	CALL PERFORM,V?THANK,ACTOR
	RTRUE
?L10:	PRINTI "Glad to meet you."
	CRLF
	CALL PRINT-ID,STR?49 >STACK
	RSTACK

	.FUNCT MONKEY-F
	IN? MONKEY,DICK \?L1
	IN? DICK,HERE \?L1
	PRINTI "Obviously, the "
	CALL DPRINT,DICK
	PRINTI " doesn't ACTUALLY have a "
	CALL DPRINT,MONKEY
	PRINTR " on his back. This is merely a metaphor indicating ""obsession"" or ""addiction""; in the detective's case, the latter."
?L1:	IN? MONKEY,PROTAGONIST \FALSE
	EQUAL? PRSA,V?EXAMINE \?L6
	PRINTI """Obsessed"" though you may be, that is no metaphorical "
	CALL DPRINT,MONKEY
	PRINTR ". It's high-strung, ill-mannered and foul-smelling."
?L6:	CALL HURT?,MONKEY >STACK
	ZERO? STACK \?L12
	EQUAL? PRSA,V?FOLLOW,V?REMOVE,V?TAKE /?L12
	EQUAL? PRSA,V?MOVE \?L10
?L12:	PRINTI "The animal darts over to your opposite shoulder, piercing your ear with a shriek."
	CRLF
	CALL HURT?,MONKEY >STACK
	ZERO? STACK \?L15
	PUSH 1
	JUMP ?L16
?L15:	PUSH 0
?L16:	CALL PRINT-ID,STR?50,STACK
	CALL HURT?,MONKEY >STACK
	CALL PRINT-ID,STR?51,STACK >STACK
	RSTACK
?L10:	EQUAL? PRSA,V?RUB \?L17
	PRINTI "He snaps his primate choppers at "
	CALL DPRINT,HANDS
	PRINTR " and you flinch."
?L17:	EQUAL? PRSA,V?SHOW,V?GIVE \?L20
	EQUAL? PRSI,MONKEY \?L20
	EQUAL? PRSO,BANANA \?L21
	FSET? BANANA,RMUNGBIT \?L23
	MOVE BANANA,MONKEY
	FSET BANANA,NDESCBIT
	PRINTI "The human-like hand of the "
	CALL DPRINT,MONKEY
	PRINTI " grasps it and chomps away while clinging ever more tightly onto "
	CALL DPRINT,BACK
	PRINTI "."
	CRLF
	CALL PRINT-ID,STR?52 >STACK
	RSTACK
?L23:	CALL NOT-INTERESTED >STACK
	RSTACK
?L21:	CALL PERFORM,V?TAKE,MONKEY
	RTRUE
?L20:	CALL TALKING-TO?,MONKEY >STACK
	ZERO? STACK /?L29
	PRINTI "It screeches loudly."
	CRLF
	CALL STOP >STACK
	RSTACK
?L29:	EQUAL? PRSA,V?SMELL \FALSE
	PRINTR "Foul."

	.FUNCT HEAD-F
	EQUAL? PRSA,V?READ,V?RUB \FALSE
	EQUAL? PRSO,HEAD \FALSE
	CALL ENABLED?,I-HYP >STACK
	ZERO? STACK /FALSE
	SET 'WINNER,HYP
	CALL PERFORM,PRSA,PRSO
	SET 'WINNER,PROTAGONIST
	RTRUE

	.FUNCT PROTAGONIST-F
	RFALSE

	.FUNCT PROTAGONIST-HACK-F
	FSET? MASK,WORNBIT \?L1
	EQUAL? WINNER,PROTAGONIST \?L6
	EQUAL? PRSA,V?TELL-ABOUT,V?TELL,V?ASK-ABOUT /?L6
	EQUAL? PRSA,V?REPLY,V?HELLO \?L3
?L6:	PRINTI "The "
	CALL DPRINT,MASK
	PRINTI " muffles your words."
	CRLF
	SET 'P-IT-OBJECT,MASK
	CALL STOP >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?KISS,V?INHALE \FALSE
	ZERO? PRSO /FALSE
	PRINTI "The "
	CALL DPRINT,MASK
	PRINTI " is in the way."
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?53,STACK
	SET 'P-IT-OBJECT,MASK
	CALL STOP >STACK
	RSTACK
?L1:	CALL ENABLED?,I-HELIUM >STACK
	ZERO? STACK /FALSE
	CALL TALKING-TO?,GUARD >STACK
	ZERO? STACK \FALSE
	EQUAL? PRSO,HEADPHONES /FALSE
	EQUAL? PRSA,V?TELL-ABOUT,V?TELL,V?ASK-ABOUT /?L14
	EQUAL? PRSA,V?REPLY,V?HELLO /?L14
	EQUAL? WINNER,PROTAGONIST /FALSE
?L14:	SET 'SPEAK-HELIUM,1
	PUTP PROTAGONIST,P?ACTION,PROTAGONIST-F
	PRINTI "As a squeaky voice emerges, you're surprised"
	EQUAL? PRSO,0,ME /?L17
	PRINTI " but"
	CALL ARTICLE,PRSO,1
	PRINTI " isn't at all amused"
?L17:	PRINT PERIOD
	CALL STOP >STACK
	RSTACK

	.FUNCT YOU-F
	EQUAL? PRSA,V?ASK-ABOUT \?L1
	EQUAL? PRSI,YOU \?L1
	CALL PERFORM,V?ASK-ABOUT,PRSO,PRSO
	RTRUE
?L1:	EQUAL? PRSA,V?TELL-ABOUT \FALSE
	EQUAL? PRSI,YOU \FALSE
	CALL PERFORM,V?TELL-ABOUT,PRSO,WINNER
	RTRUE

	.FUNCT ME-F,OLIT
	EQUAL? PRSA,V?TELL \?L1
	PRINTI "Talking to yourself is a sign that it's getting late."
	CRLF
	CALL STOP >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?LISTEN \?L5
	PRINTR "Yes?"
?L5:	EQUAL? PRSA,V?ALARM \?L8
	ZERO? DREAMING /?L9
	CALL WAKE-UP >STACK
	RSTACK
?L9:	PRINT YOU-ARE
	CRLF
	RTRUE
?L8:	EQUAL? PRSA,V?MUNG,V?KILL,V?TAKE \?L14
	PRINT BASKET-CASE
	CRLF
	EQUAL? PRSA,V?MUNG,V?KILL /?L17
	PUSH 0
	JUMP ?L18
?L17:	PUSH 1
?L18:	CALL PRINT-ID,STR?54,STACK >STACK
	RSTACK
?L14:	EQUAL? PRSA,V?PUT-ON,V?POUR,V?THROW \?L19
	EQUAL? PRSO,WATER \?L19
	MOVE WATER,LOCAL-GLOBALS
	PRINT ALL-WET
	RTRUE
?L19:	EQUAL? PRSA,V?GIVE \?L22
	EQUAL? PRSI,ME \?L22
	CALL PERFORM,V?TAKE,PRSO
	RTRUE
?L22:	EQUAL? PRSA,V?MOVE \?L23
	CALL V-WALK-AROUND >STACK
	RSTACK
?L23:	EQUAL? PRSA,V?SEARCH \?L24
	CALL V-INVENTORY
	RTRUE
?L24:	EQUAL? PRSA,V?WHIP \?L25
	EQUAL? PRSI,WHIP \?L25
	CALL WHIP-HOLD >STACK
	ZERO? STACK \TRUE
	PRINTI "You may feel this mystery has got you whipped, but now it's clear you've  actually beaten yourself."
	CRLF
	CALL PRINT-ID,STR?55
	RTRUE
?L25:	EQUAL? PRSA,V?FIND \?L31
	PRINTR "You're right here!"
?L31:	EQUAL? PRSA,V?FOLLOW \FALSE
	CALL V-WALK-AROUND >STACK
	RSTACK

	.FUNCT GLOBAL-ROOM-F
	EQUAL? PRSA,V?EXAMINE,V?LOOK-INSIDE,V?LOOK \?L1
	CALL V-LOOK
	RTRUE
?L1:	EQUAL? PRSA,V?SEARCH \?L3
	EQUAL? HERE,TAMER-ROOM \?L3
	IN? CROWBAR,LOCAL-GLOBALS \?L3
	CALL PERFORM,V?CLOSE,TAMER-DOOR
	RTRUE
?L3:	EQUAL? PRSA,V?ENTER,V?WALK-TO,V?THROUGH \?L4
	EQUAL? PRSO,RING \?L5
	EQUAL? HERE,WINGS \?L5
	CALL DO-WALK,P?NORTH >STACK
	RSTACK
?L5:	EQUAL? PRSO,MENAGERIE \?L7
	EQUAL? HERE,MIDWEST \?L7
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L7:	EQUAL? PRSO,MIDWAY \?L8
	EQUAL? HERE,CON-AREA \?L8
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L8:	CALL V-WALK-AROUND >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?EXIT,V?LEAVE \?L10
	CALL DO-WALK,P?OUT >STACK
	RSTACK
?L10:	EQUAL? PRSA,V?WALK-AROUND \?L11
	PRINTR "Walking around here reveals nothing new. To move elsewhere, just type the desired direction."
?L11:	EQUAL? PRSA,V?LAMP-ON \FALSE
	CALL PERFORM,V?LAMP-ON,LIGHT
	RTRUE

	.FUNCT VOICES-F
	EQUAL? PRSA,V?LISTEN \FALSE
	EQUAL? HERE,MIDWEST \?L3
	PRINTR "The scratchy recording of a calliope, blaring out from unseen speakers, is drowning out the voices."
?L3:	CALL RUNNING?,I-MEET >STACK
	ZERO? STACK /?L7
	EQUAL? MEET-COUNTER,7,8 /TRUE
	PRINTR "They're too muffled."
?L7:	CALL CANT-SEE,VOICES >STACK
	RSTACK

	.FUNCT HIGH-VOICE-F,ACTOR
	EQUAL? PRSA,V?LISTEN \?L1
	CALL META-LOC,THUMB >STACK
	EQUAL? STACK,HERE \?L3
	CALL PERFORM,V?LISTEN,THUMB
	RTRUE
?L3:	GET P-ADJW,0 >STACK
	ZERO? STACK \?L5
	CALL CANT-SEE,VOICES >STACK
	RSTACK
?L5:	CALL CANT-SEE,0,STR?56 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?TALK-INTO \?L7
	IN? GUARD,HERE \?L8
	CALL ENABLED?,I-HELIUM >STACK
	ZERO? STACK /?L10
	CALL PERFORM,V?HELLO,GUARD
	RTRUE
?L10:	PRINTR "The guard turns his head toward you but seems unmoved by your falsetto performance."
?L8:	CALL FIND-IN,HERE,PERSON >ACTOR
	ZERO? ACTOR /?L15
	PRINTI "Hardly amused, "
	CALL DPRINT,ACTOR
	PRINTR " ignores your performance."
?L15:	CALL FIND-IN,HERE,ACTORBIT >ACTOR
	ZERO? ACTOR /?L18
	CALL PERFORM,V?TELL,ACTOR
	RTRUE
?L18:	CALL PERFORM,V?TELL,ME
	RTRUE
?L7:	CALL DONT-HANDLE?,HIGH-VOICE >STACK
	ZERO? STACK \FALSE
	CALL CANT-SEE,VOICES >STACK
	RSTACK

	.FUNCT GEN-VOICE-F
	RETURN VOICES

	.FUNCT ROAR-F
	EQUAL? PRSA,V?LISTEN \FALSE
	PRINTR """Rrrrr...grrrrr."""

	.FUNCT TALKING-TO?,ACTOR
	CALL ASKING?,ACTOR >STACK
	ZERO? STACK \TRUE
	EQUAL? WINNER,ACTOR /TRUE
	EQUAL? PRSA,V?HELLO,V?TELL-ABOUT,V?TELL /?L5
	EQUAL? PRSA,V?YELL,V?REPLY,V?WAVE-AT /?L5
	EQUAL? PRSA,V?ALARM \FALSE
?L5:	EQUAL? PRSO,ACTOR \FALSE
	RTRUE

	.FUNCT ASKING?,ACTOR
	EQUAL? PRSA,V?ASK-FOR,V?ASK-ABOUT \FALSE
	EQUAL? PRSO,ACTOR \FALSE
	RTRUE

	.FUNCT TOUCHING?,THING
	CALL TOUCHING-VERB? >STACK
	ZERO? STACK /?L1
	EQUAL? PRSO,THING /TRUE
?L1:	CALL HURT?,THING >STACK
	ZERO? STACK \TRUE
	EQUAL? PRSI,THING \FALSE
	EQUAL? PRSA,V?PUT,V?GIVE,V?SHOW /TRUE
	EQUAL? PRSA,V?PUT-ON \FALSE
	RTRUE

	.FUNCT TOUCHING-VERB?
	EQUAL? PRSA,V?TAKE,V?RUB,V?SHAKE /TRUE
	EQUAL? PRSA,V?SPIN,V?CLEAN,V?KISS /TRUE
	EQUAL? PRSA,V?PUSH,V?CLOSE,V?LOOK-UNDER /TRUE
	EQUAL? PRSA,V?MOVE,V?OPEN,V?KNOCK /TRUE
	EQUAL? PRSA,V?SET,V?SHAKE,V?RAISE /TRUE
	EQUAL? PRSA,V?UNLOCK,V?LOCK,V?CLIMB-UP /TRUE
	EQUAL? PRSA,V?CLIMB-FOO,V?CLIMB-DOWN,V?CLIMB-ON /TRUE
	EQUAL? PRSA,V?BOARD,V?THROUGH,V?LAMP-ON /TRUE
	EQUAL? PRSA,V?BITE,V?KICK,V?KILL /TRUE
	EQUAL? PRSA,V?MUNG,V?WHIP,V?PUSH /TRUE
	EQUAL? PRSA,V?LEAP,V?LAMP-OFF,V?PUT /TRUE
	EQUAL? PRSA,V?PUT-ON,V?SEARCH,V?LOOK-INSIDE /TRUE
	EQUAL? PRSA,V?POUR,V?EAT \FALSE
	RTRUE

	.FUNCT DISTURB?,THING
	CALL TOUCHING?,THING >STACK
	ZERO? STACK \TRUE
	CALL TALKING-TO?,THING >STACK
	ZERO? STACK /FALSE
	RTRUE

	.FUNCT HURT?,THING
	EQUAL? PRSA,V?MUNG,V?KICK,V?KILL /?L3
	EQUAL? PRSA,V?KNOCK,V?CUT,V?WHIP /?L3
	EQUAL? PRSA,V?BITE,V?PUSH \FALSE
?L3:	EQUAL? PRSO,THING \FALSE
	RTRUE

	.FUNCT TELL-WITHIN-REACH
	PRINTR "There is nothing within your reach."

	.FUNCT NOT-INTERESTED
	PRINTI "The "
	CALL DPRINT,PRSI
	PRINTI " doesn't seem interested in the "
	CALL DPRINT,PRSO
	PRINTR "."

	.FUNCT TELL-CLOSELY-SPACED,PRSO?=0
	PRINTI "The bars of the "
	ZERO? PRSO? /?L3
	CALL DPRINT,PRSO
	JUMP ?L10
?L3:	ZERO? PRSI /?L7
	CALL DPRINT,PRSI
	JUMP ?L10
?L7:	PRINTI "thing"
?L10:	PRINTR " are too closely spaced."

	.FUNCT CANT-REACH,THING
	PRINTI "You"
	CALL PICK-ONE,REACHES >STACK
	PRINT STACK
	CALL ARTICLE,THING,1
	EQUAL? THING,APE,NIMROD,ELSIE \?L3
	PRINTR ", luckily."
?L3:	EQUAL? THING,FAT-HAND /TRUE
	PRINT PERIOD
	RTRUE

	.FUNCT CANT-SEE,OBJ=0,STRING=0
	PRINTI "[You can't "
	ZERO? OBJ /?L3
	EQUAL? OBJ,VOICES,HIGH-VOICE,ROAR /?L5
	EQUAL? OBJ,MUSIC,WHIMPER \?L3
?L5:	PRINTI "hear"
	JUMP ?L8
?L3:	PRINTI "see"
?L8:	ZERO? OBJ /?L22
	EQUAL? OBJ,PRSO \?L15
	GET P-NAMW,0 >STACK
	CALL NAME?,STACK >STACK
	ZERO? STACK \?L13
?L15:	PRINTI " any"
?L13:	ZERO? OBJ \?L20
?L22:	PRINTI " "
	PRINT STRING
	JUMP ?L25
?L20:	EQUAL? OBJ,PRSI \?L24
	CALL PRSI-PRINT
	JUMP ?L25
?L24:	CALL PRSO-PRINT
?L25:	PRINTI " here.]"
	CRLF
	SET 'P-WON,0
	CALL STOP >STACK
	RSTACK

	.FUNCT YOU-CANT-USE,STRING
	PRINTI "[You can't use "
	PRINT STRING
	PRINTR " that way.]"

	.FUNCT CANT-OPEN
	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	PRINTI "You can't "
	EQUAL? PRSA,V?OPEN \?L5
	PRINTI "open"
	JUMP ?L9
?L5:	PRINTI "close"
?L9:	CALL ARTICLE,PRSO
	PRINT PERIOD
	RTRUE

	.FUNCT CARRIAGE-RETURNS,CNT
?L1:	CRLF
	DEC 'CNT
	ZERO? CNT \?L1
	RTRUE

	.FUNCT OUT-OF-FIRST,VEHICLE
	PRINTI "You'll have to get "
	LOC PROTAGONIST >STACK
	EQUAL? STACK,STAND,SOFA \?L3
	PRINTI "off"
	JUMP ?L7
?L3:	PRINTI "out"
?L7:	PRINTI " of the "
	CALL DPRINT,VEHICLE
	PRINTR " first."

	.FUNCT CRAWL-DIR
	EQUAL? P-PRSA-WORD,W?CRAWL \?L1
	CALL DO-WALK,P-DIRECTION
	RTRUE
?L1:	CALL GLOBAL-IN?,BIGTOP,HERE >STACK
	ZERO? STACK /?L3
	CALL PERFORM,V?CRAWL-UNDER,BIGTOP
	RTRUE
?L3:	CALL GLOBAL-IN?,TENT,HERE >STACK
	ZERO? STACK /?L4
	CALL PERFORM,V?CRAWL-UNDER,TENT
	RTRUE
?L4:	CALL CANT-SEE,TENT
	RTRUE

	.FUNCT TELL-HIT-HEAD
	PRINTI "You hit your head against"
	CALL ARTICLE,PRSO,1
	PRINTI " as you attempt this."
	CRLF
	CALL PRINT-ID,STR?57 >STACK
	RSTACK

	.FUNCT IS-NOUN?,TEST-NOUN
	GET P-NAMW,1 >STACK
	GET P-NAMW,0 >STACK
	EQUAL? TEST-NOUN,STACK,STACK \FALSE
	RTRUE

	.FUNCT IS-ADJ?,TEST-ADJ
	GET P-ADJW,1 >STACK
	GET P-ADJW,0 >STACK
	EQUAL? TEST-ADJ,STACK,STACK \FALSE
	RTRUE

	.FUNCT SPECIFY-MONEY,BET?=0
	SET 'P-CONT,0
	PRINTI "[Specify an amount of money, such as: "
	ZERO? BET? /?L3
	PRINTI "BET "
?L3:	PRINTI "75 CENTS, or "
	ZERO? BET? /?L10
	PRINTI "BET "
?L10:	PRINTI "$1.50.]
"
	RTRUE

	.FUNCT TELL-SEE-MANUAL
	PRINTR "[Please consult your manual for the correct way to talk to characters.]"

	.FUNCT OPEN-CLOSED,THING
	FSET? THING,OPENBIT \?L1
	PRINTI "open"
	RTRUE
?L1:	PRINTI "closed"
	RTRUE

	.FUNCT V-VERBOSE
	SET 'VERBOSITY,2
	PRINTI "Maximum verbosity."
	CRLF
	CRLF
	CALL V-LOOK >STACK
	RSTACK

	.FUNCT V-SAVE
	SAVE \?L1
	PRINTR "Ok."
?L1:	PRINTR "Failed."

	.FUNCT V-RESTORE
	RESTORE \?L1
	PRINTI "Ok."
	CRLF
	CRLF
	CALL V-LOOK >STACK
	RSTACK
?L1:	PRINTR "Failed."

	.FUNCT V-SCORE,ASK?=1
	PRINTI "Your score is "
	PRINTN SCORE
	PRINTI " of a possible 205, in "
	PRINTN MOVES
	PRINTI " turn"
	EQUAL? MOVES,1 /?L3
	PRINTI "s"
?L3:	PRINT PERIOD
	RETURN 2

	.FUNCT V-SCRIPT
	GET 0,8 >STACK
	BOR STACK,1 >STACK
	PUT 0,8,STACK
	CALL CORP-NOTICE,STR?58
	CALL V-VERSION >STACK
	RSTACK

	.FUNCT V-UNSCRIPT
	CALL CORP-NOTICE,STR?59
	CALL V-VERSION
	GET 0,8 >STACK
	BAND STACK,-2 >STACK
	PUT 0,8,STACK
	RTRUE

	.FUNCT CORP-NOTICE,STRING
	PRINTI "Here "
	PRINT STRING
	PRINTR " a transcript with Ballyhoo."

	.FUNCT V-BRIEF
	SET 'VERBOSITY,1
	PRINTR "Brief descriptions."

	.FUNCT V-SUPER-BRIEF
	SET 'VERBOSITY,0
	PRINTR "Super-brief descriptions."

	.FUNCT V-DIAGNOSE
	ZERO? DREAMING \?L1
	GRTR? MEET-COUNTER,7 \?L1
	SET 'AWAITING-REPLY,9
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTR "Are you really so heartless as to think of your own well-being at a time like this?"
?L1:	PRINTI "You're "
	FSET? BANANA,RMUNGBIT \?L8
	PRINTI "still "
?L8:	PRINTR "famished."

	.FUNCT V-INVENTORY
	PRINTI "You have"
	FIRST? PROTAGONIST >STACK /?L3
	PRINTI " "
	ZERO? POCKET-CHANGE \?L7
	PRINTI "naught"
	JUMP ?L11
?L7:	CALL PRINT-AMOUNT,POCKET-CHANGE
	PRINTI " to your name"
?L11:	PRINT PERIOD
	RTRUE
?L3:	CALL DESCRIBE-OBJECTS,PROTAGONIST
	RTRUE

	.FUNCT PRINT-AMOUNT,AMT
	PRINTI "$"
	DIV AMT,100 >STACK
	PRINTN STACK
	PRINTI "."
	MOD AMT,100 >AMT
	ZERO? AMT \?L3
	PRINTI "00"
	RTRUE
?L3:	LESS? AMT,10 \?L7
	PRINTI "0"
	PRINTN AMT
	RTRUE
?L7:	PRINTN AMT
	RTRUE

	.FUNCT V-QUIT
	CALL V-SCORE
	PRINTI "Do you wish to leave the game? (Y is affirmative): "
	CALL YES? >STACK
	ZERO? STACK /?L3
	QUIT
?L3:	PRINTR "Ok."

	.FUNCT V-RESTART
	CALL V-SCORE,1
	PRINTI "Do you wish to restart? (Y is affirmative): "
	CALL YES? >STACK
	ZERO? STACK /FALSE
	PRINTI "Restarting."
	CRLF
	RESTART

	.FUNCT YES?
	PRINTI ">"
	READ P-INBUF,P-LEXV
	GET P-LEXV,1 >STACK
	EQUAL? STACK,W?YES,W?Y \FALSE
	RTRUE

	.FUNCT FINISH,REPEATING=0
	LESS? EGRESS-C,3 \?L1
	CRLF
?L1:	ZERO? REPEATING \?L4
	CALL V-SCORE
	CRLF
?L4:	CALL TELL-FINISH
	READ P-INBUF,P-LEXV
	GET P-LEXV,1 >STACK
	EQUAL? STACK,W?RESTAR \?L7
	RESTART
?L7:	GET P-LEXV,1 >STACK
	EQUAL? STACK,W?RESTOR \?L11
	RESTORE \?L12
	PRINTR "Ok."
?L12:	PRINTI "Failed."
	CRLF
	CALL FINISH,1 >STACK
	RSTACK
?L11:	GET P-LEXV,1 >STACK
	EQUAL? STACK,W?QUIT,W?Q \?L19
	QUIT
?L19:	CALL FINISH,1 >STACK
	RSTACK

	.FUNCT TELL-FINISH
	PRINTI "[EVENT: GAME OVER]Would you like to start over, restore a saved position, or end this session of the game? (Type RESTART, RESTORE, or QUIT):

>"
	RTRUE

	.FUNCT V-VERSION,CNT=17,V
	GET 0,1 >STACK
	BAND STACK,2047 >V
	PRINTI "BALLYHOO
Infocom interactive fiction
Copyright (c) 1986 by Infocom, Inc. All rights reserved.
Release "
	PRINTN V
	PRINTI " / Serial number "
?L3:	IGRTR? 'CNT,23 /?L4
	GETB 0,CNT >STACK
	PRINTC STACK
	JUMP ?L3
?L4:	CRLF
	RTRUE

	.FUNCT V-$0024VERIFY
	EQUAL? PRSO,INTNUM \?L1
	EQUAL? P-NUMBER,963 \?L1
	PRINTN SERIAL
	CRLF
	RTRUE
?L1:	PRINTI "Verifying..."
	CRLF
	VERIFY \?L8
	PRINTR "Good."
?L8:	CRLF
	PRINTR "** Bad **"

	.FUNCT V-ADVANCE
	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-ALARM
	EQUAL? PRSO,ROOMS \?L1
	CALL PERFORM,V?ALARM,ME
	RTRUE
?L1:	PRINTI "But"
	CALL ARTICLE,PRSO,1
	PRINTR " isn't asleep."

	.FUNCT V-ANSWER
	ZERO? AWAITING-REPLY /?L3
	GET P-LEXV,P-CONT >STACK
	EQUAL? STACK,W?YES \?L1
	CALL V-YES
	CALL STOP >STACK
	RSTACK
?L1:	ZERO? AWAITING-REPLY /?L3
	GET P-LEXV,P-CONT >STACK
	EQUAL? STACK,W?NO \?L3
	CALL V-NO
	CALL STOP >STACK
	RSTACK
?L3:	PRINTI "Nobody is awaiting your answer."
	CRLF
	CALL STOP >STACK
	RSTACK

	.FUNCT V-APPLAUD
	FSET? PRSO,PERSON \?L1
	EQUAL? PRSO,JERRY,TEAM,FAT /?L1
	EQUAL? PRSO,DICK,TAFT,CROWD /?L1
	EQUAL? PRSO,HAWKER /?L1
	PRINTI "Gracefully,"
	CALL ARTICLE,PRSO,1
	PRINTR " takes a bow."
?L1:	EQUAL? PRSO,CIRCUS \?L7
	EQUAL? HERE,STANDS-ROOM \?L7
	PRINTR "You're drowned out."
?L7:	PRINTI "Not surprisingly,"
	CALL ARTICLE,PRSO,1
	PRINTR " doesn't react."

	.FUNCT V-ARREST
	PRINTI "Fine. Since you wield zero police power, the only thing that's getting arrested around here is your logical faculty."
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?60,STACK >STACK
	RSTACK

	.FUNCT V-ASK-ABOUT
	EQUAL? PRSO,ME \?L1
	CALL PERFORM,V?TELL,ME
	RTRUE
?L1:	FSET? PRSO,ACTORBIT \?L3
	PRINTI "A long silence tells you that"
	CALL ARTICLE,PRSO,1
	PRINTI " isn't interested in talking about"
	IN? PRSI,ROOMS \?L8
	PRINTI " that"
	JUMP ?L12
?L8:	CALL ARTICLE,PRSI,1
?L12:	PRINT PERIOD
	RTRUE
?L3:	CALL PERFORM,V?TELL,PRSO
	RTRUE

	.FUNCT V-ASK-FOR
	PRINTI "Unsurprisingly,"
	CALL ARTICLE,PRSO,1
	PRINTR " doesn't oblige."

	.FUNCT V-BALANCE
	PRINTR "Your knees wobble a bit."

	.FUNCT V-BET
	PRINTR "You can't bet here."

	.FUNCT V-BITE,?TMP
	CALL IS-PERSON? >?TMP
	ZERO? ?TMP /?L2
	PUSH ?TMP
	JUMP ?L1
?L2:	CALL IS-OBJ-PROP-ANIMAL? >STACK
?L1:	CALL PRINT-ID,STR?61,STACK
	CALL IS-PART-OF-SELF-OR-SELF? >STACK
	CALL PRINT-ID,STR?62,STACK
	CALL HACK-HACK,STR?63 >STACK
	RSTACK

	.FUNCT PRE-BOARD
	LOC PROTAGONIST >STACK
	EQUAL? PRSO,STACK \?L1
	ZERO? IN-FRONT-FLAG \?L1
	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L1:	EQUAL? P-PRSA-WORD,W?CUT \?L5
	SET 'IN-FRONT-FLAG,1
	RFALSE
?L5:	EQUAL? POCKET-CHANGE,1281 \?L6
	EQUAL? PRSO,LONG,SHORT \?L6
	PRINTR "You've lost all patience for waiting in line."
?L6:	CALL HELD?,PRSO >STACK
	ZERO? STACK /FALSE
	EQUAL? PRSO,SUIT /FALSE
	PRINTR "You're holding it!"

	.FUNCT V-BOARD,AV
	LOC PROTAGONIST >AV
	EQUAL? PRSO,LONG,SHORT \?L1
	LOC PROTAGONIST >STACK
	EQUAL? STACK,SHORT,LONG \?L1
	CALL OUT-OF-FIRST,AV
	RTRUE
?L1:	EQUAL? PRSO,SHORT \?L4
	EQUAL? LINE-COUNTER,1 /?L4
	FSET? LONG,RMUNGBIT /?L4
	MOVE PROTAGONIST,LONG
	CALL ENTER-LINE
	RTRUE
?L4:	FSET? PRSO,VEHBIT \?L7
	PRINTI "You are now "
	EQUAL? PRSO,LONG,SHORT \?L11
	PRINT TAIL-END
	JUMP ?L15
?L11:	PRINTI "on"
?L15:	CALL ARTICLE,PRSO,1
	PRINT PERIOD
	MOVE WINNER,PRSO
	GETP PRSO,P?ACTION >STACK
	CALL STACK,M-ENTER >STACK
	RTRUE
?L7:	ZERO? IN-FRONT-FLAG /?L20
	CALL V-DIG >STACK
	RSTACK
?L20:	PRINTI "You can't get onto"
	CALL ARTICLE,PRSO,1
	PRINTR "!"

	.FUNCT V-BRIBE
	ZERO? PRSI \?L1
	CALL PERFORM,V?GIVE,GLOBAL-MONEY,PRSO
	RTRUE
?L1:	CALL PERFORM,V?GIVE,PRSI,PRSO
	RTRUE

	.FUNCT PRE-BUY
	EQUAL? PRSI,0,HAWKER,CON /FALSE
	EQUAL? PRSI,CONCESSIONAIRE /FALSE
	PRINTI "But"
	CALL ARTICLE,PRSI,1
	PRINTR " isn't selling."

	.FUNCT V-BUY
	PRINTI "Sorry,"
	EQUAL? PRSO,TICKET \?L3
	PRINTI " a ticket"
	JUMP ?L7
?L3:	CALL ARTICLE,PRSO,1
?L7:	PRINTR " isn't for sale."

	.FUNCT V-CALL
	EQUAL? HERE,OFFICE \?L1
	CALL PERFORM,V?PHONE,PRSO
	RTRUE
?L1:	CALL META-LOC,PRSO >STACK
	EQUAL? STACK,HERE /?L3
	EQUAL? PRSO,ME /?L3
	CALL GLOBAL-IN?,PRSO,HERE >STACK
	ZERO? STACK \?L3
	CALL CANT-SEE,PRSO >STACK
	RSTACK
?L3:	CALL PERFORM,V?TELL,PRSO
	RTRUE

	.FUNCT V-CATCH-WITH
	CALL PERFORM,V?TAKE-WITH,PRSO,PRSI
	RTRUE

	.FUNCT V-CHASTISE
	EQUAL? PRSO,INTDIR \?L1
	CALL PERFORM,V?LOOK
	RTRUE
?L1:	PRINTR "Use prepositions to indicate precisely what you want to do: LOOK AT the object, LOOK INSIDE it, LOOK UNDER it, etc."

	.FUNCT V-CHEAT
	EQUAL? HERE,BLUE-ROOM \?L6
	ZERO? PRSO /?L3
	EQUAL? PRSO,BLACKJACK,TABLE,DEALER \?L6
?L3:	IN? HERE,THUMB \?L4
	CALL PERFORM,V?BET,GLOBAL-MONEY
	RTRUE
?L4:	PRINTI "You'll need help."
	CRLF
	CALL PRINT-ID,STR?64
	RTRUE
?L6:	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT V-CLAP,ACTOR
	ZERO? PRSO /?L1
	CALL PERFORM,V?RUB,PRSO
	RTRUE
?L1:	ZERO? END-GAME /?L3
	IN? JIM,HERE \?L3
	PRINTI "The "
	CALL DPRINT,JIM
	FSET? JIM,RMUNGBIT \?L6
	FCLEAR JIM,RMUNGBIT
	PRINTR " snaps out of his trance with a shake of his head."
?L6:	FSET JIM,RMUNGBIT
	PRINTR "'s eyes widen and become vacant as some invisible force comes over him. He straightens up out of his usual slouch and appears perfectly rigid."
?L3:	EQUAL? HERE,BACK-YARD \?L13
	IN? THUMB,HERE \?L13
	SET 'PRSO,THUMB
	CALL PERFORM,V?APPLAUD,PRSO
	RTRUE
?L13:	EQUAL? HERE,STANDS-ROOM \?L14
	CALL PERFORM,V?APPLAUD,CIRCUS
	RTRUE
?L14:	CALL FIND-IN,HERE,ACTORBIT >PRSO
	ZERO? PRSO /?L15
	CALL PERFORM,V?APPLAUD,PRSO
	RTRUE
?L15:	EQUAL? PRSO,FAT \?L16
	CALL PERFORM,V?TELL,FAT
	RTRUE
?L16:	PRINTR "Clap!"

	.FUNCT V-CLEAN
	PRINTI "But"
	CALL ARTICLE,PRSO,1
	PRINTR " isn't all that dirty."

	.FUNCT V-CLIMB-DOWN
	EQUAL? PRSO,ROOMS \?L1
	CALL DO-WALK,P?DOWN >STACK
	RSTACK
?L1:	CALL V-COUNT >STACK
	RSTACK

	.FUNCT V-CLIMB-FOO
	EQUAL? PRSO,INTDIR \?L1
	CALL CRAWL-DIR
	RTRUE
?L1:	EQUAL? PRSO,ROOMS \?L3
	EQUAL? HERE,ON-WAGON,PLATFORM-1 \?L4
	CALL DOWN-LADDER >STACK
	RSTACK
?L4:	CALL DO-WALK,P?UP >STACK
	RSTACK
?L3:	EQUAL? PRSO,TAMER-TRAILER,WAGON,CLOWN-TRAILER \?L7
	CALL PERFORM,V?CLIMB-ON,PRSO
	RTRUE
?L7:	CALL V-COUNT >STACK
	RSTACK

	.FUNCT V-CLIMB-ON
	FSET? PRSO,VEHBIT /?L3
	EQUAL? PRSO,LONG,SHORT \?L1
	EQUAL? P-PRSA-WORD,W?GET \?L1
?L3:	CALL PERFORM,V?BOARD,PRSO
	RTRUE
?L1:	EQUAL? PRSO,GRANDSTAND \?L4
	CALL PERFORM,V?SIT
	RTRUE
?L4:	EQUAL? PRSO,STAIRCASE \?L5
	CALL V-DIG >STACK
	RSTACK
?L5:	PRINTI "You can't climb onto"
	CALL ARTICLE,PRSO,1
	PRINT PERIOD
	RTRUE

	.FUNCT V-CLIMB-OVER
	CALL V-COUNT >STACK
	RSTACK

	.FUNCT V-CLIMB-UP
	EQUAL? PRSO,ROOMS \?L1
	CALL DO-WALK,P?UP >STACK
	RSTACK
?L1:	CALL V-INHALE >STACK
	RSTACK

	.FUNCT V-CLOSE
	FSET? PRSO,SURFACEBIT \?L1
	CALL V-COUNT >STACK
	RSTACK
?L1:	FSET? PRSO,ACTORBIT \?L3
	CALL V-COUNT >STACK
	RSTACK
?L3:	FSET? PRSO,DOORBIT /?L5
	FSET? PRSO,CONTBIT \?L4
?L5:	FSET? PRSO,OPENBIT \?L6
	PRINTI "Okay,"
	CALL ARTICLE,PRSO,1
	PRINTI " is now closed."
	CRLF
	FCLEAR PRSO,OPENBIT
	RTRUE
?L6:	PRINT ALREADY-CLOSED
	CRLF
	RTRUE
?L4:	CALL CANT-OPEN >STACK
	RSTACK

	.FUNCT PRE-COMPARE
	ZERO? PRSI \?L4
	GET P-PRSO,0 >STACK
	EQUAL? 1,STACK /?L3
?L4:	GET P-PRSO,0 >STACK
	EQUAL? 2,STACK \FALSE
?L3:	PRINTI "Try typing ""COMPARE IT TO (something)."""
	CRLF
	RETURN 2

	.FUNCT V-COMPARE
	EQUAL? PRSO,PRSI \?L1
	PRINTR "The self-same thing."
?L1:	PRINTI "Like Rimshaw,"
	CALL ARTICLE,PRSO,1
	PRINTR " is incomparable."

	.FUNCT V-COUNT
	CALL PICK-ONE,IMPOSSIBLES >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT V-CRAWL-UNDER
	EQUAL? PRSO,INTDIR \?L1
	CALL CRAWL-DIR
	RTRUE
?L1:	FSET? PRSO,TAKEBIT /?L3
	CALL TELL-HIT-HEAD >STACK
	RSTACK
?L3:	EQUAL? PRSO,STAND \?L4
	CALL V-DIG >STACK
	RSTACK
?L4:	CALL V-COUNT >STACK
	RSTACK

	.FUNCT V-CUT,?TMP
	ZERO? PRSI \?L1
	CALL IS-OBJ-PROP-ANIMAL? >?TMP
	ZERO? ?TMP /?L4
	PUSH ?TMP
	JUMP ?L3
?L4:	CALL IS-PERSON? >STACK
?L3:	CALL PRINT-ID,STR?65,STACK
	CALL IS-PART-OF-SELF-OR-SELF? >STACK
	CALL PRINT-ID,STR?66,STACK
	CALL V-INHALE >STACK
	RSTACK
?L1:	PRINTI "It's doubtful the ""cutting edge"" of"
	CALL ARTICLE,PRSI
	PRINTI " is adequate."
	CRLF
	CALL IS-OBJ-PROP-ANIMAL? >?TMP
	ZERO? ?TMP /?L11
	PUSH ?TMP
	JUMP ?L10
?L11:	CALL IS-PERSON? >STACK
?L10:	CALL PRINT-ID,STR?67,STACK
	CALL IS-PART-OF-SELF-OR-SELF? >STACK
	CALL PRINT-ID,STR?68,STACK >STACK
	RSTACK

	.FUNCT V-DIG
	CALL PICK-ONE,WASTES >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT V-DISEMBARK
	FSET? PRSO,TAKEBIT \?L1
	CALL META-LOC,PRSO >STACK
	EQUAL? STACK,HERE \?L1
	IN? PRSO,HERE /?L1
	IN? PRSO,PROTAGONIST /?L1
	CALL PERFORM,V?TAKE,PRSO
	RTRUE
?L1:	LOC WINNER >STACK
	EQUAL? STACK,PRSO /?L3
	PRINT LOOK-AROUND
	CRLF
	RETURN 2
?L3:	EQUAL? PRSO,LONG,SHORT \?L9
	EQUAL? LINE-COUNTER,0,1 /?L9
	EQUAL? LINE-COUNTER,4,5 /?L11
	EQUAL? LINE-COUNTER,2,3 \?L9
?L11:	EQUAL? LINE-COUNTER,2,3 \?L12
	PRINTR "You hesitate momentarily, as your line has appears to be about to move."
?L12:	SET 'P-CONT,0
	SET 'CLOCK-WAIT,1
	SET 'AWAITING-REPLY,1
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTI "You hear an inner voice whisper, ""Do I really want to forfeit my position in the "
	CALL DPRINT,PRSO
	PRINTR "?"" To which you answer:"
?L9:	PRINTI "You get "
	EQUAL? PRSO,STAND,SOFA \?L22
	PRINTI "off"
	JUMP ?L26
?L22:	PRINTI "out"
?L26:	PRINTI " of the "
	CALL DPRINT,PRSO
	PRINTI "."
	CRLF
	MOVE WINNER,HERE
	RTRUE

	.FUNCT V-DRINK
	PRINTR "You can't drink that!"

	.FUNCT V-DRINK-FROM
	CALL V-COUNT >STACK
	RSTACK

	.FUNCT V-DRIVE
	CALL V-COUNT >STACK
	RSTACK

	.FUNCT PRE-DROP
	CALL IDROP >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT V-DROP
	MOVE PRSO,HERE
	EQUAL? PRSO,FAT-HAND \?L1
	FSET FAT-HAND,NDESCBIT
?L1:	PRINTR "Dropped."

	.FUNCT V-EAT
	PRINTI "Stuffing your face with"
	CALL ARTICLE,PRSO,1
	PRINTI " would do little to help at this point."
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?69,STACK
	CALL IS-ANIMAL? >STACK
	CALL PRINT-ID,STR?70,STACK
	CALL DANGEROUS-FOOD? >STACK
	CALL PRINT-ID,STR?71,STACK >STACK
	RSTACK

	.FUNCT V-EJECT
	CALL V-COUNT >STACK
	RSTACK

	.FUNCT V-EMPTY,OBJ,NXT
	FSET? PRSO,CONTBIT \?L1
	FSET? PRSO,OPENBIT \?L3
	FIRST? PRSO >OBJ /?L28
	JUMP ?L6
?L8:	ZERO? OBJ /TRUE
?L28:	NEXT? OBJ >NXT /?L12
?L12:	FSET? OBJ,NARTICLEBIT /?L13
	PRINTI "The "
?L13:	CALL DPRINT,OBJ
	PRINTI ": "
	CALL PERFORM,V?TAKE,OBJ,PRSO
	SET 'OBJ,NXT
	JUMP ?L8
?L6:	PRINTR "It's already empty!"
?L3:	PRINTR "It's closed."
?L1:	CALL V-COUNT
	RTRUE

	.FUNCT V-ENTER,VEHICLE
	CALL FIND-IN,HERE,VEHBIT >VEHICLE
	EQUAL? VEHICLE,0,STOOL /?L1
	CALL PERFORM,V?BOARD,VEHICLE
	RTRUE
?L1:	CALL DO-WALK,P?IN >STACK
	RSTACK

	.FUNCT V-EXAMINE
	FSET? PRSO,DOORBIT /?L3
	FSET? PRSO,SURFACEBIT \?L1
?L3:	EQUAL? PRSO,TRAP,SOFA /?L1
	CALL V-LOOK-INSIDE >STACK
	RSTACK
?L1:	FSET? PRSO,CONTBIT \?L4
	FSET? PRSO,ACTORBIT /?L4
	EQUAL? PRSO,COAT,COMPARTMENT,TRAP /?L4
	EQUAL? PRSO,SOFA,RADIO /?L4
	FSET? PRSO,OPENBIT \?L5
	CALL V-LOOK-INSIDE >STACK
	RSTACK
?L5:	PRINTR "It's closed."
?L4:	FSET? PRSO,CLEARBIT \?L10
	PRINTR "It's invisible, naturally."
?L10:	EQUAL? PRSO,BACK,HEAD \?L13
	PRINTR "That would involve quite a contortion."
?L13:	PRINTI "You see"
	EQUAL? PRSO,CHANDELIER,SOFA \?L19
	FSET? PRSO,RMUNGBIT \?L19
	PRINTI ", indeed,"
?L19:	PRINTI " nothing "
	CALL PICK-ONE,YAWNS >STACK
	PRINT STACK
	PRINTI " about"
	CALL IS-NOUN?,W?TABLECLOTH >STACK
	ZERO? STACK \?L28
	CALL IS-NOUN?,W?CLOTH >STACK
	ZERO? STACK /?L26
?L28:	PRINTI " the tablecloth"
	JUMP ?L31
?L26:	CALL ARTICLE,PRSO,1
?L31:	EQUAL? PRSO,HYP \?L32
	PRINTI " (contrary to his billing)"
	JUMP ?L36
?L32:	EQUAL? PRSO,THUMB \?L36
	PRINTI " (except that he's about two feet high)"
?L36:	PRINTR "."

	.FUNCT V-EXAMINE-THROUGH
	PRINTR "This reveals nothing new."

	.FUNCT V-EXIT
	ZERO? PRSO /?L1
	FSET? PRSO,VEHBIT \?L1
	CALL PERFORM,V?DISEMBARK,PRSO
	RTRUE
?L1:	CALL DO-WALK,P?OUT >STACK
	RSTACK

	.FUNCT V-FEED,FOOD=0
	EQUAL? PRSO,MOUSE \?L1
	CALL HELD?,CHEESE >STACK
	ZERO? STACK /?L1
	SET 'FOOD,CHEESE
	JUMP ?L6
?L1:	CALL HELD?,MEAT >STACK
	ZERO? STACK /?L3
	SET 'FOOD,MEAT
	JUMP ?L6
?L3:	CALL HELD?,GRANOLA >STACK
	ZERO? STACK /?L4
	SET 'FOOD,GRANOLA
	JUMP ?L6
?L4:	CALL HELD?,BANANA >STACK
	ZERO? STACK /?L5
	SET 'FOOD,BANANA
	JUMP ?L6
?L5:	CALL HELD?,CHEESE >STACK
	ZERO? STACK /?L6
	SET 'FOOD,CHEESE
?L6:	ZERO? FOOD /?L8
	PRINTI "(the "
	CALL DPRINT,FOOD
	PRINTI ")"
	CRLF
	CALL PERFORM,V?GIVE,FOOD,PRSO
	RTRUE
?L8:	PRINTI "You have nothing to feed"
	CALL ARTICLE,PRSO,1
	PRINTR " with."

	.FUNCT V-FILL
	ZERO? PRSI \?L1
	EQUAL? HERE,CON-AREA \?L3
	CALL PERFORM,V?FILL,PRSO,GLOBAL-WATER
	RTRUE
?L3:	FSET? PRSO,CONTBIT \?L5
	GETP PRSO,P?CAPACITY >STACK
	ZERO? STACK /?L5
	PRINTR "There's nothing to fill it with."
?L5:	CALL V-COUNT >STACK
	RSTACK
?L1:	EQUAL? PRSI,GLOBAL-WATER,WATER \?L9
	IN? WATER,PRSO \?L10
	PRINTR "It's already full."
?L10:	EQUAL? HERE,CON-AREA /?L14
	CALL CANT-SEE,WATER >STACK
	RSTACK
?L14:	EQUAL? PRSO,BUCKET /?L15
	CALL V-COUNT >STACK
	RSTACK
?L15:	FIRST? BUCKET >STACK \?L16
	PRINTI "That would get"
	CALL PRINT-CONTENTS,BUCKET,1
	PRINTR " all wet."
?L16:	MOVE WATER,BUCKET
	PRINTI "A good measure of "
	CALL DPRINT,WATER
	PRINTI " gurgles into the "
	CALL DPRINT,BUCKET
	PRINTR "."
?L9:	EQUAL? PRSI,WATER \?L24
	CALL PERFORM,V?POUR,WATER,PRSO
	SET 'P-IT-OBJECT,PRSO
	RTRUE
?L24:	CALL V-COUNT >STACK
	RSTACK

	.FUNCT V-FIND,WHERE=0,L
	LOC PRSO >L
	EQUAL? PRSO,ME \?L1
	PRINTI "You're in"
	CALL ARTICLE,HERE,1
	PRINT PERIOD
	RTRUE
?L1:	IN? PRSO,PROTAGONIST \?L7
	PRINTR "You have it!"
?L7:	EQUAL? PRSO,KEY \?L10
	FSET? KEY,TRYTAKEBIT \?L10
	CALL WHERE-FIND,WHERE >STACK
	RSTACK
?L10:	IN? PRSO,HERE \?L11
	PRINTR "Right in front of you."
?L11:	IN? PRSO,GLOBAL-OBJECTS /?L15
	CALL GLOBAL-IN?,PRSO,HERE >STACK
	ZERO? STACK /?L14
?L15:	PRINTR "You figure it out!"
?L14:	FSET? L,ACTORBIT \?L18
	CALL VISIBLE?,L >STACK
	ZERO? STACK /?L18
	PRINTI "As far as you can tell,"
	CALL ARTICLE,L,1
	PRINTR " has it."
?L18:	FSET? L,CONTBIT \?L23
	CALL VISIBLE?,PRSO >STACK
	ZERO? STACK /?L23
	IN? L,GLOBAL-OBJECTS /?L23
	PRINTI "It's in"
	CALL ARTICLE,L,1
	PRINT PERIOD
	RTRUE
?L23:	CALL WHERE-FIND,WHERE >STACK
	RSTACK

	.FUNCT WHERE-FIND,WHERE=0
	ZERO? WHERE /?L1
	PRINTR "Beats me."
?L1:	PRINTR "You'll have to do that yourself."

	.FUNCT V-FIRST-LOOK
	CALL DESCRIBE-ROOM >STACK
	ZERO? STACK /FALSE
	EQUAL? VERBOSITY,1,2 \FALSE
	CALL DESCRIBE-OBJECTS >STACK
	RSTACK

	.FUNCT V-FOLLOW
	IN? PRSO,HERE /?L3
	EQUAL? PRSO,CROWD \?L1
	EQUAL? HERE,STANDS-ROOM \?L1
?L3:	PRINTI "But"
	CALL ARTICLE,PRSO,1
	PRINTR " is right here!"
?L1:	FSET? PRSO,ACTORBIT /?L8
	CALL V-COUNT >STACK
	RSTACK
?L8:	EQUAL? PRSO,JIM \?L9
	ZERO? END-GAME \?L9
	EQUAL? HERE,WINGS \?L9
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L9:	CALL WHICH-WAY
	CALL WHICH-WAY
	CRLF
	RTRUE

	.FUNCT WHICH-WAY
	PRINTI "Which way did "
	FSET? PRSO,FEMALE \?L3
	PRINTI "s"
?L3:	PRINTI "he go? "
	RTRUE

	.FUNCT I-FOLLOW
	EQUAL? FOLLOW-FLAG,4 \?L1
	EQUAL? HERE,EAST-CAMP \?L1
	PRINTI "The "
	CALL DPRINT,CURTAINS
	PRINTI "s part slightly and are quickly drawn back."
	CRLF
?L1:	SET 'FOLLOW-FLAG,0
	RFALSE

	.FUNCT PRE-GIVE
	EQUAL? PRSA,V?GIVE \?L1
	EQUAL? PRSO,HANDS \?L1
	EQUAL? PRSI,HYP \?L3
	SET 'WINNER,HYP
	CALL PERFORM,V?READ,HANDS
	SET 'WINNER,PROTAGONIST
	RTRUE
?L3:	CALL PERFORM,V?SHAKE-WITH,PRSI
	RTRUE
?L1:	CALL IDROP >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT V-GET-DOWN
	EQUAL? PRSO,ROOMS \?L1
	CALL DO-WALK,P?DOWN >STACK
	RSTACK
?L1:	CALL PERFORM,V?TAKE-OFF,PRSO
	RTRUE

	.FUNCT V-GIVE
	FSET? PRSI,ACTORBIT \?L1
	EQUAL? PRSI,TAFT /?L1
	EQUAL? PRSI,DICK \?L3
	ZERO? DICK-DRUNK /?L3
	PRINTI "Haplessly,"
	JUMP ?L7
?L3:	PRINTI "Briskly,"
?L7:	CALL ARTICLE,PRSI,1
	PRINTR " refuses your offer."
?L1:	PRINTI "You can't give"
	CALL ARTICLE,PRSO
	PRINTI " to"
	CALL ARTICLE,PRSI
	PRINTR "!"

	.FUNCT V-HANG-UP
	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-HELLO
	ZERO? PRSO /?L5
	FSET? PRSO,ACTORBIT \?L1
	PRINTI """Hello."""
	CRLF
	CALL STOP >STACK
	RSTACK
?L1:	ZERO? PRSO /?L5
	CALL PERFORM,V?TELL,PRSO
	RTRUE
?L5:	CALL PERFORM,V?TELL,ME
	RTRUE

	.FUNCT V-HELP
	PRINTR "If you're really stuck, maps and hint booklets are available from your dealer, or via mail order with the form that came in your package."

	.FUNCT V-HIDE
	ZERO? PRSO \?L1
	IN? TAFT,HERE \?L1
	CALL RUNNING?,I-MEET >STACK
	ZERO? STACK /?L1
	CALL PERFORM,V?HIDE-BEHIND,TAFT
	RTRUE
?L1:	EQUAL? HERE,PROP-ROOM \?L4
	EQUAL? PRSO,TAFT \?L4
	PRINTI "There's no need to"
	JUMP ?L8
?L4:	PRINTI "You can't"
?L8:	PRINTI " hide "
	ZERO? PRSO /?L13
	PRINTI "t"
?L13:	PRINTR "here."

	.FUNCT V-HIDE-BEHIND
	ZERO? HIDING /?L1
	PRINT YOU-ARE
	CRLF
	RTRUE
?L1:	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-HYPNOTISE
	CALL ENABLED?,I-HYP >STACK
	ZERO? STACK /?L1
	FSET? MASK,WORNBIT \?L3
	CALL PERFORM,V?TELL,HYP
	RTRUE
?L3:	SET 'WINNER,HYP
	CALL PERFORM,V?HYPNOTISE,PRSO
	SET 'WINNER,PROTAGONIST
	RTRUE
?L1:	EQUAL? PRSO,ME \?L6
	PRINT HOW
	CRLF
	RTRUE
?L6:	FSET? PRSO,ACTORBIT \?L9
	PRINT IT-LOOKS-LIKE
	CALL PRINT-ID,STR?72
	CALL ARTICLE,PRSO,1
	FSET? PRSO,PERSON /?L12
	PRINTI ", though not lacking in animal magnetism,"
?L12:	PRINTR " is not hypnotizable."
?L9:	CALL V-COUNT >STACK
	RSTACK

	.FUNCT V-INHALE
	EQUAL? PRSO,AIR \?L1
	PRINTR "Deep-breathing -- good for the health."
?L1:	CALL V-COUNT >STACK
	RSTACK

	.FUNCT V-KICK
	CALL IS-OBJ-PROP-ANIMAL? >STACK
	CALL PRINT-ID,STR?73,STACK
	CALL IS-PART-OF-SELF-OR-SELF? >STACK
	CALL PRINT-ID,STR?74,STACK
	CALL HACK-HACK,STR?75 >STACK
	RSTACK

	.FUNCT V-KILL
	EQUAL? PRSO,TRAP \?L1
	FSET? TRAP,RMUNGBIT /?L1
	ZERO? PRSI /?L3
	CALL PERFORM,V?TAKE,TRAP
	RTRUE
?L3:	PRINTI """SNAP!"" The "
	CALL DPRINT,TRAP
	PRINTR " does a back flip."
?L1:	FSET? PRSO,ACTORBIT \?L8
	EQUAL? PRSO,FAT,TAFT,THUMB /?L8
	PRINTI "Thinking of your own safety, you refrain."
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?76,STACK
	CALL IS-ANIMAL? >STACK
	CALL PRINT-ID,STR?77,STACK >STACK
	RSTACK
?L8:	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	CALL IS-OBJECT-OR-PROPERTY? >STACK
	CALL PRINT-ID,STR?78,STACK >STACK
	RSTACK

	.FUNCT V-KNOCK
	FSET? PRSO,DOORBIT \?L1
	FSET? PRSO,OPENBIT \?L3
	CALL PERFORM,V?OPEN,PRSO
	RTRUE
?L3:	PRINTR "Silence answers back."
?L1:	CALL HACK-HACK,STR?79 >STACK
	RSTACK

	.FUNCT V-KISS
	FSET? PRSO,PERSON \?L1
	EQUAL? PRSO,TAFT /?L1
	PRINTI "It would be totally out of character for"
	CALL ARTICLE,PRSO,1
	PRINTI " to be smooching with you right now."
	CRLF
	CALL PRINT-ID,STR?80
	RTRUE
?L1:	FSET? PRSO,ACTORBIT \?L7
	FSET? PRSO,PERSON /?L7
	PRINTI "The ASPCA has taken people to court for lesser offences!"
	CRLF
	CALL PRINT-ID,STR?81 >STACK
	RSTACK
?L7:	PRINTR "Kissed."

	.FUNCT V-LAMP-OFF
	PRINTR "You can't turn that off."

	.FUNCT V-LAMP-ON
	PRINTR "You can't turn that on."

	.FUNCT V-LEAP
	ZERO? PRSO /?L3
	IN? PRSO,HERE /?L1
	CALL V-COUNT >STACK
	RSTACK
?L1:	ZERO? PRSO /?L3
	FSET? PRSO,PERSON \?L3
	CALL PERFORM,V?KILL,PRSO
	RTRUE
?L3:	IN? PROTAGONIST,SOFA \?L4
	CALL V-COUNT >STACK
	RSTACK
?L4:	PRINTR "Your feet barely leave the ground."

	.FUNCT V-LEAP-OFF
	FSET? PRSO,VEHBIT \?L1
	CALL PERFORM,V?DISEMBARK,PRSO
	RTRUE
?L1:	CALL PERFORM,V?LEAP,PRSO
	RTRUE

	.FUNCT V-LEAN
	EQUAL? HERE,TIGHTROPE-ROOM \?L1
	CALL RUNNING?,I-TREMBLE >STACK
	ZERO? STACK /?L3
	EQUAL? P-DIRECTION,P?SOUTH,P?NORTH \?L3
	EQUAL? P-DIRECTION,P?SOUTH \?L8
	ZERO? LEAN-NORTH? /?L7
?L8:	EQUAL? P-DIRECTION,P?NORTH \?L5
	ZERO? LEAN-NORTH? /?L5
?L7:	PRINT UNBALANCED
	CALL FLYING
	PRINTI "And you fall ..."
	CALL FALL-DOWN
	RTRUE
?L5:	RANDOM 100 >STACK
	LESS? 40,STACK /?L13
	PRINTI "Overly cautious, you don't put enough of "
	CALL DPRINT,ME
	PRINTI " in that "
	CALL DPRINT,INTDIR
	PRINTR "."
?L13:	PRINTI "You overcompensate, and are now"
	CALL LEANING
	ZERO? LEAN-NORTH? /?L19
	CALL LEAN >STACK
	RSTACK
?L19:	CALL LEAN,1 >STACK
	RSTACK
?L3:	CALL FLYING
	PRINTI "You drop like a quail ..."
	CALL FALL-DOWN
	RTRUE
?L1:	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-LEAVE
	ZERO? PRSO \?L1
	SET 'PRSO,ROOMS
?L1:	EQUAL? PRSO,ROOMS \?L4
	CALL DO-WALK,P?OUT >STACK
	RSTACK
?L4:	FSET? PRSO,VEHBIT /?L7
	EQUAL? PRSO,LONG,SHORT \?L6
?L7:	CALL PERFORM,V?DISEMBARK,PRSO
	RTRUE
?L6:	CALL PERFORM,V?DROP,PRSO
	RTRUE

	.FUNCT V-LIE-DOWN
	PRINTR "There's no time for that."

	.FUNCT V-LISTEN
	PRINTI "At the moment,"
	CALL ARTICLE,PRSO,1
	PRINTR " makes no sound."

	.FUNCT PRE-LOCK
	EQUAL? PRSO,CHAIN,BULL /FALSE
	EQUAL? PRSO,CURTAINS /?L4
	FSET? PRSO,DOORBIT /?L3
	EQUAL? PRSO,KIESTER,BAGGAGE-COMPARTMENT,CAGE /?L3
	EQUAL? PRSO,LION-CAGE,DESK /?L3
?L4:	CALL V-COUNT
	RTRUE
?L3:	EQUAL? HERE,OFFICE \?L6
	EQUAL? PRSO,OFFICE-DOOR \?L5
	ZERO? PRSI /FALSE
?L5:	EQUAL? HERE,OFFICE \?L6
	EQUAL? PRSO,OFFICE-DOOR \?L6
	ZERO? PRSI /?L35
	EQUAL? PRSI,KEY \?L6
	PRINTI "(You don't need the key, which doesn't fit anyway.) "
	CRLF
	CRLF
	RFALSE
?L6:	ZERO? PRSI \?L10
?L35:	CALL HELD?,KEY >STACK
	ZERO? STACK /?L10
	EQUAL? HERE,OFFICE \?L12
	EQUAL? PRSO,OFFICE-DOOR /?L10
?L12:	SET 'PRSI,KEY
	PRINTI "(with the key)"
	CRLF
	RFALSE
?L10:	EQUAL? PRSI,KEY /FALSE
	PRINTI "The "
	CALL DPRINT,PRSO
	PRINTI " cannot be "
	EQUAL? PRSA,V?UNLOCK \?L21
	PRINTI "un"
	CALL IS-OFF-LIMITS-DOOR? >STACK
	CALL PRINT-ID,STR?82,STACK
?L21:	PRINTI "locked with"
	ZERO? PRSI /?L28
	CALL ARTICLE,PRSI,1
	JUMP ?L30
?L28:	PRINTI " "
	CALL DPRINT,HANDS
?L30:	PRINT PERIOD
	RTRUE

	.FUNCT V-LOCK
	FSET? PRSO,DOORBIT /?L3
	EQUAL? PRSO,DESK,BAGGAGE-COMPARTMENT,KIESTER \?L1
?L3:	FSET? PRSO,OPENBIT \?L4
	PRINTI "But the "
	CALL DPRINT,PRSO
	PRINTR " is open."
?L4:	FSET? PRSO,LOCKEDBIT \?L8
	PRINTR "It already is."
?L8:	FSET? PRSO,CAGEBIT /?L11
	EQUAL? HERE,OFFICE /?L11
	CALL CANT-LOCK
	RTRUE
?L11:	FSET PRSO,LOCKEDBIT
	PRINTI "Okay, the "
	CALL DPRINT,PRSO
	PRINTR " is now locked."
?L1:	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT V-LOOK
	CALL DESCRIBE-ROOM,1
	CALL DESCRIBE-OBJECTS >STACK
	RSTACK

	.FUNCT V-LOOK-BEHIND
	FSET? PRSO,DOORBIT \?L1
	CALL PERFORM,V?LOOK-INSIDE,PRSO
	RTRUE
?L1:	PRINTI "There is nothing "
	EQUAL? PRSO,CHUTE \?L6
	PRINTI "on the other side of"
	JUMP ?L10
?L6:	PRINTI "behind"
?L10:	CALL ARTICLE,PRSO,1
	PRINT PERIOD
	RTRUE

	.FUNCT V-LOOK-DOWN
	ZERO? LIT \?L1
	PRINT TOO-DARK
	CRLF
	RTRUE
?L1:	EQUAL? HERE,TIGHTROPE-ROOM,PLATFORM-1,PLATFORM-2 \?L5
	EQUAL? APE-LOC,2,3 \?L6
	PRINTI "Without looking down, you're confident the net is properly positioned under the girl and not "
	CALL DPRINT,ME
	PRINTR ". It's the kind of confidence that makes your knees buckle."
?L6:	PRINTI "First lesson of a wire walker: NEVER look down. "
	IN? NET,RING \?L13
	PRINTI "However, you trust the net is in place."
?L13:	CRLF
	RTRUE
?L5:	EQUAL? PRSO,ROOMS \?L18
	CALL PERFORM,V?EXAMINE,GROUND
	RTRUE
?L18:	CALL PERFORM,V?LOOK-INSIDE,PRSO
	RTRUE

	.FUNCT V-LOOK-INSIDE
	EQUAL? PRSO,DARKNESS,LIGHT \?L1
	CALL PERFORM,V?EXAMINE,PRSO
	RTRUE
?L1:	FSET? PRSO,ACTORBIT \?L3
	PRINTR "There is nothing special to be seen."
?L3:	FSET? PRSO,SURFACEBIT \?L6
	LOC WINNER >STACK
	EQUAL? PRSO,STACK \?L7
	CALL DESCRIBE-VEHICLE
	RTRUE
?L7:	PRINT YOU-SEE
	CALL PRINT-CONTENTS,PRSO
	PRINTI " on"
	CALL ARTICLE,PRSO,1
	PRINT PERIOD
	RTRUE
?L6:	FSET? PRSO,DOORBIT \?L16
	PRINTI "All you can tell is that"
	FSET? PRSO,OPENBIT \?L19
	CALL ARTICLE,PRSO,1
	PRINTR " is open."
?L19:	CALL ARTICLE,PRSO,1
	PRINTR " is closed."
?L16:	FSET? PRSO,CONTBIT \?L26
	EQUAL? PRSO,BALLOON /?L26
	LOC WINNER >STACK
	EQUAL? PRSO,STACK \?L27
	CALL DESCRIBE-VEHICLE
	RTRUE
?L27:	CALL SEE-INSIDE?,PRSO >STACK
	ZERO? STACK /?L29
	FIRST? PRSO >STACK \?L30
	PRINT YOU-SEE
	CALL PRINT-CONTENTS,PRSO
	EQUAL? PRSO,RING \?L34
	PRINTI " on"
	JUMP ?L38
?L34:	PRINTI " in"
?L38:	CALL ARTICLE,PRSO,1
	JUMP ?L41
?L30:	PRINT EMPTY
?L41:	PRINT PERIOD
	RTRUE
?L29:	FSET? PRSO,OPENBIT /?L46
	FIRST? PRSO >STACK \?L46
	CALL PERFORM,V?OPEN,PRSO
	RTRUE
?L46:	PRINTI "It seems that"
	CALL ARTICLE,PRSO,1
	PRINTR " is closed."
?L26:	PRINTR "You can't do that."

	.FUNCT V-LOOK-ON
	FSET? PRSO,SURFACEBIT \?L1
	CALL PERFORM,V?LOOK-INSIDE,PRSO >STACK
	RSTACK
?L1:	CALL PERFORM,V?EXAMINE,PRSO
	RTRUE

	.FUNCT V-LOOK-OUTSIDE
	FSET? PRSO,DOORBIT /?L3
	FSET? PRSO,TRANSBIT /?L3
	EQUAL? PRSO,VEIL \?L1
?L3:	CALL PERFORM,V?LOOK-INSIDE,PRSO
	RTRUE
?L1:	CALL V-LOOK
	RTRUE

	.FUNCT V-LOOK-UNDER
	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L1
	FSET? PRSO,WORNBIT \?L3
	PRINTR "You're wearing it!"
?L3:	PRINTR "You're holding it!"
?L1:	EQUAL? PRSO,STRAW \?L10
	EQUAL? HERE,APE-ROOM \?L10
	FSET? TRAP-DOOR,OPENBIT /?L10
	FCLEAR TRAP-DOOR,INVISIBLE
	PRINTI "Under the coarse layer of "
	CALL DPRINT,STRAW
	PRINTI " the outline of a "
	CALL DPRINT,TRAP-DOOR
	PRINTR " is visible."
?L10:	PRINTI "There's nothing eye-catching under"
	CALL ARTICLE,PRSO,1
	EQUAL? HERE,MEN,NOOK \?L16
	EQUAL? PRSO,STRAW \?L16
	PRINTI " that's within reach"
	JUMP ?L20
?L16:	EQUAL? HERE,APE-ROOM \?L20
	EQUAL? PRSO,STRAW \?L20
	PRINTI " except the "
	CALL OPEN-CLOSED,TRAP-DOOR
	PRINTI " "
	CALL DPRINT,TRAP-DOOR
?L20:	PRINT PERIOD
	RTRUE

	.FUNCT V-LOOK-UP
	ZERO? LIT \?L1
	PRINT TOO-DARK
	CRLF
	RTRUE
?L1:	EQUAL? PRSO,ROOMS \?L5
	FSET? HERE,INDOORSBIT /?L6
	PRINTI "The sky is "
	ZERO? DREAMING /?L10
	PRINTR "deep blue."
?L10:	PRINTR "an inky black."
?L6:	EQUAL? HERE,RING \?L17
	ZERO? END-GAME \?L17
	PRINT YOU-SEE
	PRINTI " the supporting apparatus for the "
	CALL DPRINT,TIGHTROPE-OBJECT
	PRINTR "."
?L17:	EQUAL? HERE,UNDER-STANDS \?L20
	PRINTI "From here the "
	CALL DPRINT,GRANDSTAND
	PRINTR " resembles a huge venetian blind, letting in broad panels of hazy light."
?L20:	EQUAL? HERE,RING,PLATFORM-1,TIGHTROPE-ROOM \?L23
	ZERO? APE-LOC /?L23
	CALL TELL-APE
	CRLF
	RTRUE
?L23:	EQUAL? HERE,PLATFORM-2 \?L24
	FSET? BALLOON,TOUCHBIT /?L24
	GETP BALLOON,P?FDESC >STACK
	PRINT STACK
	CRLF
	RTRUE
?L24:	EQUAL? HERE,BULL-ROOM \?L27
	FSET? BURN-HOLE,INVISIBLE /?L27
	PRINT YOU-SEE
	PRINTI " "
	CALL DPRINT,BURN-HOLE
	PRINTR "s."
?L27:	CALL PERFORM,V?EXAMINE,CEILING
	RTRUE
?L5:	CALL PERFORM,V?LOOK-INSIDE,PRSO
	RTRUE

	.FUNCT V-LOWER
	CALL V-RAISE >STACK
	RSTACK

	.FUNCT V-MAKE
	PRINTI "You can't make"
	CALL ARTICLE,PRSO
	PRINTR "!"

	.FUNCT V-MOVE
	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L1
	PRINTR "Why juggle objects?"
?L1:	CALL LOC-CLOSED >STACK
	ZERO? STACK \TRUE
	FSET? PRSO,TAKEBIT /?L7
	FSET? PRSO,TRYTAKEBIT \?L6
?L7:	PRINTI "Moving"
	CALL ARTICLE,PRSO,1
	PRINTR " reveals nothing."
?L6:	PRINTI "You can't move"
	CALL ARTICLE,PRSO,1
	PRINT PERIOD
	RTRUE

	.FUNCT V-MUNG
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?83,STACK
	CALL IS-OBJ-PROP-ANIMAL? >STACK
	CALL PRINT-ID,STR?84,STACK
	CALL IS-PART-OF-SELF-OR-SELF? >STACK
	CALL PRINT-ID,STR?85,STACK
	CALL HACK-HACK,STR?86 >STACK
	RSTACK

	.FUNCT V-NO
	EQUAL? AWAITING-REPLY,1 \?L1
	CALL PERFORM,V?WAIT
	RTRUE
?L1:	EQUAL? AWAITING-REPLY,2 \?L3
	PRINTI "Contain "
	CALL DPRINT,ME
	PRINTR "."
?L3:	EQUAL? AWAITING-REPLY,3 \?L6
	PRINTR "You should start."
?L6:	EQUAL? AWAITING-REPLY,4 \?L9
	PRINTI "Right. "
	CALL V-YES >STACK
	RSTACK
?L9:	EQUAL? AWAITING-REPLY,5 \?L12
	PRINTR "Then you don't need it."
?L12:	EQUAL? AWAITING-REPLY,6 \?L15
	ZERO? DID-C \?L16
	PRINTI """Of course you did now, didn't you?"""
	JUMP ?L20
?L16:	PRINTI """Did so."""
?L20:	FCLEAR PROTAGONIST,RMUNGBIT
	CRLF
	RTRUE
?L15:	EQUAL? AWAITING-REPLY,7 \?L23
	PRINTI "Quit your "
	CALL DPRINT,GRANDSTAND
	PRINTR "ing."
?L23:	EQUAL? AWAITING-REPLY,8 \?L26
	IN? CON,HERE \?L26
	CALL PERFORM,V?ASK-ABOUT,CON,FLASK
	RTRUE
?L26:	EQUAL? AWAITING-REPLY,9 \?L27
	PRINTR "We didn't think so."
?L27:	EQUAL? AWAITING-REPLY,10 \?L30
	SET 'AWAITING-REPLY,11
	CALL V-YES >STACK
	RSTACK
?L30:	EQUAL? AWAITING-REPLY,11 \?L31
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L31:	EQUAL? AWAITING-REPLY,12 \?L32
	SET 'EGRESS-C,0
	PRINTR "That's the spirit."
?L32:	EQUAL? AWAITING-REPLY,13 \?L35
	PRINTR "Then think of one."
?L35:	PRINTR "You sound rather negative."

	.FUNCT V-OPEN,F,STR
	FSET? PRSO,SURFACEBIT \?L1
	CALL V-COUNT >STACK
	RSTACK
?L1:	FSET? PRSO,ACTORBIT \?L3
	CALL V-COUNT >STACK
	RSTACK
?L3:	EQUAL? PRSO,BAGGAGE-COMPARTMENT \?L6
	FSET? BAGGAGE-COMPARTMENT,LOCKEDBIT \?L5
?L6:	FSET? PRSO,CONTBIT \?L4
	EQUAL? PRSO,KIESTER,BAGGAGE-COMPARTMENT,DESK /?L4
?L5:	FSET? PRSO,OPENBIT \?L7
	PRINT ALREADY-OPEN
	CRLF
	RTRUE
?L7:	FSET PRSO,OPENBIT
	FSET PRSO,TOUCHBIT
	FIRST? PRSO >STACK \?L14
	FSET? PRSO,TRANSBIT \?L12
?L14:	PRINTR "Opened."
?L12:	PRINTI "Opening"
	CALL ARTICLE,PRSO,1
	PRINTI " reveals"
	CALL PRINT-CONTENTS,PRSO
	PRINT PERIOD
	RTRUE
?L4:	FSET? PRSO,DOORBIT /?L25
	EQUAL? PRSO,DESK,BAGGAGE-COMPARTMENT,KIESTER \?L24
?L25:	EQUAL? PRSA,V?OPEN \?L26
	EQUAL? PRSI,KEY \?L26
	CALL PERFORM,V?UNLOCK,PRSO,KEY
	RTRUE
?L26:	FSET? PRSO,LOCKEDBIT /?L28
	FSET? PRSO,OPENBIT /?L29
	FSET PRSO,OPENBIT
	PRINTI "The "
	CALL DPRINT,PRSO
	PRINTI " "
	EQUAL? PRSO,CURTAINS,BLUE-DOOR \?L33
	PRINTI "slides"
	JUMP ?L40
?L33:	EQUAL? PRSO,APE-DOOR,ROUST-DOOR,LION-DOOR \?L37
	PRINTI "creaks slowly"
	JUMP ?L40
?L37:	PRINTI "swings"
?L40:	PRINTR " open."
?L29:	PRINTR "It's already open."
?L28:	PRINTI "The "
	CALL DPRINT,PRSO
	PRINTR " is locked."
?L24:	CALL CANT-OPEN >STACK
	RSTACK

	.FUNCT V-PASS,ACTOR
	EQUAL? P-PRSA-WORD,W?PAY \?L1
	EQUAL? PRSO,INTNUM /?L1
	ZERO? PRSI \?L1
	CALL SPECIFY-MONEY
	RETURN 2
?L1:	FSET? PRSO,TAKEBIT /?L6
	EQUAL? PRSO,INTNUM,GLOBAL-MONEY,DOLLAR \?L5
?L6:	CALL FIND-IN,HERE,ACTORBIT >ACTOR
	ZERO? ACTOR \?L9
	CALL FIND-IN,PROTAGONIST,ACTORBIT >ACTOR
	ZERO? ACTOR /?L7
?L9:	PRINTI "(to"
	CALL ARTICLE,ACTOR,1
	PRINTI ")"
	CRLF
	CALL PERFORM,V?GIVE,PRSO,ACTOR
	RTRUE
?L7:	CALL V-COUNT >STACK
	RSTACK
?L5:	SET 'IN-FRONT-FLAG,1
	CALL PERFORM,V?BOARD,PRSO
	RTRUE

	.FUNCT V-PHONE
	EQUAL? HERE,OFFICE /?L1
	CALL CANT-SEE,0,STR?87 >STACK
	RSTACK
?L1:	EQUAL? PRSO,WPDL,DIAL,RADIO /?L4
	EQUAL? PRSO,INTNUM \?L3
	EQUAL? P-NUMBER,1170 \?L3
?L4:	ZERO? END-GAME /?L5
	FSET? DIAL,RMUNGBIT \?L5
	SET 'CALLED-STATION,1
	PRINTI "After verifying, via computer, your credit card number, home address, social security number, and credit rating, the cheerful voice on the other end of the line takes your pledge and hangs up."
	CRLF
	CALL PRINT-ID,STR?88 >STACK
	RSTACK
?L5:	PRINTR "The line is busy."
?L3:	EQUAL? PRSO,HOME \?L12
	PRINTI "E.T. quit this "
	CALL DPRINT,CIRCUS
	PRINTR " long ago."
?L12:	EQUAL? PRSO,INTNUM \?L15
	ZERO? P-EXCHANGE \?L23
	ZERO? P-NUMBER \?L16
	PRINTR "The operator suggests you dial 411 for information."
?L16:	ZERO? P-EXCHANGE \?L23
	EQUAL? P-NUMBER,411 \?L20
	PRINTR "A recording informs you to consult your directory."
?L20:	ZERO? P-EXCHANGE \?L23
	EQUAL? P-NUMBER,911 \?L23
	CALL PERFORM,V?PHONE,POLICE
	RTRUE
?L23:	PRINT BUSY
	RTRUE
?L15:	PRINT BUSY
	RTRUE

	.FUNCT V-PHONE-WITH
	EQUAL? PRSI,PHONE /?L1
	PRINTI "You can't use"
	CALL ARTICLE,PRSI
	PRINTI " as a "
	CALL DPRINT,PHONE
	PRINTR "."
?L1:	CALL PERFORM,V?PHONE,PRSO
	RTRUE

	.FUNCT V-PICK
	FSET? PRSO,DOORBIT \?L1
	PRINTI "You're no locksmith."
	CRLF
	CALL PRINT-ID,STR?89 >STACK
	RSTACK
?L1:	CALL V-COUNT >STACK
	RSTACK

	.FUNCT V-PICK-UP
	CALL PERFORM,V?TAKE,PRSO,PRSI
	RTRUE

	.FUNCT V-PLAY
	CALL V-COUNT >STACK
	RSTACK

	.FUNCT V-POUR
	CALL V-INHALE >STACK
	RSTACK

	.FUNCT V-PUNCH,?TMP
	CALL IS-OBJ-PROP-ANIMAL? >?TMP
	ZERO? ?TMP /?L2
	PUSH ?TMP
	JUMP ?L1
?L2:	CALL IS-PERSON? >STACK
?L1:	CALL PRINT-ID,STR?90,STACK
	CALL IS-PART-OF-SELF-OR-SELF? >STACK
	CALL PRINT-ID,STR?91,STACK
	CALL PERFORM,V?KILL,PRSO
	RTRUE

	.FUNCT V-PUSH
	EQUAL? PRSO,POLE \?L1
	FSET? POLE,TOUCHBIT /?L1
	CALL PERFORM,V?TAKE,POLE
	RTRUE
?L1:	EQUAL? P-PRSA-WORD,W?PULL \?L3
	CALL HACK-HACK,STR?92 >STACK
	RSTACK
?L3:	CALL HACK-HACK,STR?93 >STACK
	RSTACK

	.FUNCT PRE-PUT
	EQUAL? PRSI,STRAW,SAWDUST,GROUND /?L3
	EQUAL? PRSI,CENTER-POLE \?L1
	CALL IS-NOUN?,W?SAWDUST >STACK
	ZERO? STACK /?L1
?L3:	GETP HERE,P?GROUND-LOC >STACK
	ZERO? STACK /?L4
	CALL PERFORM,V?THROW-OFF,PRSO,CAGE
	RTRUE
?L4:	CALL PERFORM,V?DROP,PRSO
	RTRUE
?L1:	EQUAL? PRSO,KEY \?L7
	FSET? KEY,TRYTAKEBIT \?L7
	CALL PERFORM,V?TAKE-WITH,KEY,PRSI
	RTRUE
?L7:	EQUAL? PRSA,V?PUT \?L8
	EQUAL? HERE,CON-AREA \?L8
	EQUAL? PRSO,GLOBAL-WATER \?L8
	ZERO? PRSI /?L8
	CALL PERFORM,V?FILL,PRSI,GLOBAL-WATER
	RTRUE
?L8:	EQUAL? PRSO,HANDS \?L9
	EQUAL? PRSA,V?PUT \?L10
	CALL PERFORM,V?REACH-IN,PRSI
	RTRUE
?L10:	CALL V-COUNT >STACK
	RSTACK
?L9:	CALL HELD?,PRSI,PRSO >STACK
	ZERO? STACK /?L13
	PRINTI "You can't put"
	CALL ARTICLE,PRSO,1
	PRINTI " in"
	CALL ARTICLE,PRSI,1
	PRINTI " when"
	CALL ARTICLE,PRSI,1
	PRINTI " is already in"
	CALL ARTICLE,PRSO,1
	PRINTR "!"
?L13:	ZERO? IN-FRONT-FLAG /?L24
	CALL V-DIG >STACK
	RSTACK
?L24:	CALL IDROP >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT V-PUT,?TMP
	FSET? PRSI,OPENBIT /?L1
	FSET? PRSI,DOORBIT /?L1
	FSET? PRSI,CONTBIT /?L1
	FSET? PRSI,SURFACEBIT /?L1
	FSET? PRSI,VEHBIT /?L1
	PRINTI "You can't put"
	CALL ARTICLE,PRSO,1
	PRINTI " in"
	CALL ARTICLE,PRSI
	PRINTR "!"
?L1:	FSET? PRSI,ACTORBIT \?L9
	CALL V-COUNT >STACK
	RSTACK
?L9:	EQUAL? PRSI,PRSO /?L11
	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L10
	FSET? PRSO,TAKEBIT /?L10
?L11:	PRINTR "How can you do that?"
?L10:	FSET? PRSI,OPENBIT /?L14
	FSET? PRSI,SURFACEBIT /?L14
	PRINTI "Inspection reveals that"
	CALL ARTICLE,PRSI,1
	PRINTI " isn't open."
	CRLF
	SET 'P-IT-OBJECT,PRSI
	RETURN P-IT-OBJECT
?L14:	IN? PRSO,PRSI \?L19
	PRINTI "But"
	CALL ARTICLE,PRSO,1
	PRINTI " is already in"
	CALL ARTICLE,PRSI,1
	PRINT PERIOD
	RTRUE
?L19:	CALL WEIGHT,PRSI >?TMP
	GETP PRSO,P?SIZE >STACK
	ADD ?TMP,STACK >?TMP
	GETP PRSI,P?SIZE >STACK
	SUB ?TMP,STACK >?TMP
	GETP PRSI,P?CAPACITY >STACK
	GRTR? ?TMP,STACK \?L26
	FSET? PRSI,VEHBIT \?L27
	EQUAL? PRSI,STAND /?L27
	CALL V-DIG >STACK
	RSTACK
?L27:	PRINTI "There's no room "
	FSET? PRSO,SURFACEBIT \?L32
	PRINTI "on"
	JUMP ?L36
?L32:	PRINTI "in"
?L36:	PRINTI " the "
	CALL DPRINT,PRSI
	PRINTI " for"
	CALL ARTICLE,PRSO,1
	PRINT PERIOD
	RTRUE
?L26:	CALL HELD?,PRSO >STACK
	ZERO? STACK \?L43
	CALL ITAKE >STACK
	EQUAL? STACK,M-FATAL,0 /TRUE
?L43:	MOVE PRSO,PRSI
	FSET PRSO,TOUCHBIT
	PRINTR "Done."

	.FUNCT V-PUT-BEHIND
	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-PUT-ON
	EQUAL? PRSI,ME /?L3
	EQUAL? PRSI,HEAD \?L1
	EQUAL? PRSO,MASK \?L1
?L3:	CALL PERFORM,V?WEAR,PRSO
	RTRUE
?L1:	FSET? PRSI,SURFACEBIT \?L4
	CALL V-PUT >STACK
	RSTACK
?L4:	FSET? PRSI,PERSON \?L5
	EQUAL? PRSI,TAFT,DICK,FAT /?L5
	PRINTI "Perturbed,"
	CALL ARTICLE,PRSI,1
	PRINTI " stays your mischievous hand."
	CRLF
	CALL DANGEROUS-TO-PUT-ON? >STACK
	CALL PRINT-ID,STR?94,STACK >STACK
	RSTACK
?L5:	FSET? PRSO,WEARBIT \?L10
	FSET? PRSI,ACTORBIT \?L10
	PRINTI "The "
	CALL DPRINT,PRSO
	PRINTI " isn't"
	CALL ARTICLE,PRSI,1
	PRINTI "'s style."
	CRLF
	EQUAL? PRSI,TAFT /?L15
	PUSH 1
	JUMP ?L16
?L15:	PUSH 0
?L16:	CALL PRINT-ID,STR?95,STACK >STACK
	RSTACK
?L10:	PRINTI "There's no good surface on"
	CALL ARTICLE,PRSI,1
	PRINT PERIOD
	RTRUE

	.FUNCT V-PUT-OUTSIDE
	EQUAL? HERE,DEN \?L1
	EQUAL? PRSI,LION-CAGE \?L1
	CALL PERFORM,V?THROW,PRSO,LION-CAGE
	RTRUE
?L1:	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-PUT-UNDER
	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-RAISE
	CALL HACK-HACK,STR?96 >STACK
	RSTACK

	.FUNCT V-REACH-IN,OBJ
	FIRST? PRSO >OBJ /?L1
?L1:	FSET? PRSO,ACTORBIT /?L4
	FSET? PRSO,SURFACEBIT /?L4
	FSET? PRSO,CONTBIT /?L2
?L4:	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE
?L2:	FSET? PRSO,OPENBIT /?L7
	PRINTR "It's not open."
?L7:	ZERO? OBJ /?L11
	FSET? OBJ,INVISIBLE /?L11
	FSET? OBJ,TAKEBIT /?L10
?L11:	PRINTI "There's nothing in"
	CALL ARTICLE,PRSO,1
	PRINT PERIOD
	RTRUE
?L10:	EQUAL? PRSO,BUCKET \?L16
	IN? WATER,BUCKET \?L16
	PRINT ALL-WET
	RTRUE
?L16:	PRINTI "You reach into"
	CALL ARTICLE,PRSO,1
	PRINTI " and feel something."
	CRLF
	FIRST? PRSO >P-IT-OBJECT /TRUE
	RTRUE

	.FUNCT PRE-READ
	ZERO? LIT \?L1
	PRINT TOO-DARK
	CRLF
	RTRUE
?L1:	EQUAL? PRSO,HEAD \?L5
	CALL PERFORM,V?RUB,HEAD
	RTRUE
?L5:	ZERO? PRSI /FALSE
	FSET? PRSI,TRANSBIT /FALSE
	PRINTI "How does one look through"
	CALL ARTICLE,PRSI
	PRINTR "?"

	.FUNCT V-READ
	PRINTI "How can you read"
	CALL ARTICLE,PRSO
	PRINTR "?"

	.FUNCT V-RECORD
	CALL VISIBLE?,HEADPHONES >STACK
	ZERO? STACK /?L1
	CALL PERFORM,V?RECORD,HEADPHONES
	RTRUE
?L1:	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-RELEASE
	EQUAL? PRSO,ROOMS \?L3
	IN? PROD,PROTAGONIST \?L1
	CALL PERFORM,V?DROP,PROD
	RTRUE
?L1:	EQUAL? PRSO,ROOMS \?L3
	CALL V-COUNT >STACK
	RSTACK
?L3:	CALL PERFORM,V?DROP,PRSO
	RTRUE

	.FUNCT V-REWIND
	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-REMOVE
	FSET? PRSO,WEARBIT \?L1
	CALL PERFORM,V?TAKE-OFF,PRSO
	RTRUE
?L1:	CALL PERFORM,V?TAKE,PRSO
	RTRUE

	.FUNCT V-REPLY
	PRINTI "It is hardly likely that"
	CALL ARTICLE,PRSO,1
	PRINTI " is interested."
	CRLF
	CALL STOP >STACK
	RSTACK

	.FUNCT V-RUB
	CALL LOC-CLOSED >STACK
	ZERO? STACK \TRUE
	EQUAL? PRSO,HEAD \?L3
	PRINTR "You feel the bumps but lack the interpretive skills of the phrenologist."
?L3:	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?97,STACK
	CALL HACK-HACK,STR?98 >STACK
	RSTACK

	.FUNCT V-SAVE-SOMETHING
	CALL RUNNING?,I-BOOST >STACK
	ZERO? STACK /?L1
	IN? THUMB,HERE \?L1
	CALL PERFORM,V?RAISE,THUMB
	RTRUE
?L1:	PRINTI "Sorry, but"
	CALL ARTICLE,PRSO,1
	PRINTR " is beyond help."

	.FUNCT V-SEARCH
	FSET? PRSO,PERSON \?L1
	EQUAL? PRSO,TAFT,CROWD /?L1
	PRINTI "It seems"
	CALL ARTICLE,PRSO,1
	PRINTI " isn't the sort of person who'd allow such a frisking without a search warrant."
	CRLF
	CALL PRINT-ID,STR?99
	RTRUE
?L1:	FSET? PRSO,CONTBIT \?L11
	LOC WINNER >STACK
	EQUAL? PRSO,STACK \?L8
	CALL DESCRIBE-VEHICLE
	RTRUE
?L8:	FSET? PRSO,OPENBIT /?L10
	CALL TELL-OPEN-FIRST
	RTRUE
?L10:	FIRST? PRSO >STACK \?L11
	FIRST? PRSO >STACK /?L12
?L12:	FSET? STACK,NDESCBIT /?L11
	PRINT YOU-SEE
	CALL PRINT-CONTENTS,PRSO
	PRINT PERIOD
	RTRUE
?L11:	PRINTR "You find nothing unusual."

	.FUNCT V-SEARCH-OBJECT-FOR
	FSET? PRSO,PERSON \?L1
	CALL PERFORM,V?SEARCH,PRSO >STACK
	RSTACK
?L1:	FSET? PRSO,CONTBIT \?L3
	FSET? PRSO,OPENBIT /?L3
	CALL TELL-OPEN-FIRST >STACK
	RSTACK
?L3:	IN? PRSI,PRSO /?L5
	IN? PRSI,HERE \?L4
?L5:	PRINTI "Very observant. There "
	FSET? PRSI,FEMALE \?L8
	PUSH STR?100
	JUMP ?L11
?L8:	FSET? PRSI,PERSON \?L10
	PUSH STR?101
	JUMP ?L11
?L10:	PUSH STR?102
?L11:	PRINT STACK
	PRINTR " is."
?L4:	PRINTI "You don't find"
	CALL ARTICLE,PRSI,1
	PRINTR " there."

	.FUNCT TELL-OPEN-FIRST
	PRINTI "You'll have to open"
	CALL ARTICLE,PRSO,1
	PRINTR " first."

	.FUNCT V-SET
	EQUAL? PRSO,ROOMS \?L1
	EQUAL? HERE,TIGHTROPE-ROOM \?L3
	ZERO? HEADING-EAST? /?L5
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L5:	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L3:	CALL PICK-ONE,WASTES >STACK
	PRINT STACK
	CRLF
	RTRUE
?L1:	ZERO? PRSI \?L11
	EQUAL? PRSO,RADIO,DIAL \?L12
	FSET? RADIO,ONBIT \?L12
	PRINTR "Without setting the dial to a specific number, you pick up mostly static, interspersed with even more irritating snippets of talk and music."
?L12:	FSET? PRSO,TAKEBIT \?L17
	CALL HACK-HACK,STR?103 >STACK
	RSTACK
?L17:	PRINT NOT-HOLDING
	CALL ARTICLE,PRSO,1
	PRINT PERIOD
	RTRUE
?L11:	CALL V-COUNT >STACK
	RSTACK

	.FUNCT V-SGIVE
	CALL PERFORM,V?GIVE,PRSI,PRSO
	RTRUE

	.FUNCT V-SHAKE,X
	FSET? PRSO,ACTORBIT \?L1
	PRINTI "Be real."
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?104,STACK >STACK
	RSTACK
?L1:	CALL HACK-HACK,STR?105 >STACK
	RSTACK

	.FUNCT V-SHAKE-WITH
	EQUAL? PRSO,HANDS /?L1
	CALL V-TELL-TIME >STACK
	RSTACK
?L1:	FSET? PRSI,ACTORBIT /?L3
	PRINTI "But"
	CALL ARTICLE,PRSI,1
	PRINTR " doesn't even have hands."
?L3:	CALL PERFORM,V?THANK,PRSI
	RTRUE

	.FUNCT V-SHOW
	PRINTI "It's doubtful"
	CALL ARTICLE,PRSI,1
	PRINTR " is interested."

	.FUNCT V-SIT,VEHICLE
	CALL FIND-IN,HERE,VEHBIT >VEHICLE
	ZERO? VEHICLE /?L1
	EQUAL? VEHICLE,LONG,SHORT \?L3
	CALL V-COUNT >STACK
	RSTACK
?L3:	CALL PERFORM,V?BOARD,VEHICLE
	RTRUE
?L1:	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-SKIP
	PRINTR "Wasn't that fun?"

	.FUNCT V-SLEEP
	PRINTR "Temporary insomnia prevents this."

	.FUNCT V-SMELL
	ZERO? PRSO \?L1
	EQUAL? HERE,CLOWN-ALLEY \?L3
	PRINTR "It's quite bad."
?L3:	EQUAL? HERE,ROUST-ROOM \?L7
	CALL PERFORM,V?SMELL,CAGE
	RTRUE
?L7:	PRINTI "You smell nothing "
	CALL PICK-ONE,YAWNS >STACK
	PRINT STACK
	PRINTR "."
?L1:	PRINTI "It smells just like"
	CALL ARTICLE,PRSO
	PRINT PERIOD
	RTRUE

	.FUNCT V-SMILE
	PRINTR "How nice."

	.FUNCT V-SPIN
	PRINTR "You can't spin that!"

	.FUNCT V-SPUT-ON
	CALL PERFORM,V?PUT-ON,PRSI,PRSO
	RTRUE

	.FUNCT V-SWHIP
	CALL PERFORM,V?WHIP,PRSI,PRSO
	RTRUE

	.FUNCT V-SSHOW
	CALL PERFORM,V?SHOW,PRSI,PRSO
	RTRUE

	.FUNCT V-STAND
	EQUAL? PRSO,0,ROOMS /?L1
	CALL V-DIG >STACK
	RSTACK
?L1:	LOC WINNER >STACK
	EQUAL? STACK,LONG,SHORT /?L3
	LOC WINNER >STACK
	FSET? STACK,VEHBIT \?L3
	LOC WINNER >STACK
	CALL PERFORM,V?DISEMBARK,STACK
	RTRUE
?L3:	ZERO? SIT-IN-STANDS /?L4
	EQUAL? HERE,STANDS-ROOM \?L4
	SET 'SIT-IN-STANDS,0
	PRINTR "As you rise, your row scrunches into the empty space."
?L4:	PRINTR "You are already standing."

	.FUNCT V-STAND-ON
	EQUAL? PRSO,SHORT,LONG,STAND \?L1
	CALL PERFORM,V?BOARD,PRSO
	RTRUE
?L1:	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-STELL
	CALL PERFORM,V?TELL,PRSI
	RTRUE

	.FUNCT V-STOP
	EQUAL? PRSO,RADIO,HEADPHONES \?L1
	CALL PERFORM,V?LAMP-OFF,PRSO
	RTRUE
?L1:	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT PRE-TAKE
	EQUAL? PRSO,PSEUDO-OBJECT /FALSE
	CALL LOC-CLOSED >STACK
	ZERO? STACK \TRUE
	LOC PRSO >STACK
	EQUAL? PRSI,STACK \?L6
	EQUAL? PRSA,V?TAKE-WITH \FALSE
?L6:	EQUAL? PRSO,MONKEY,FLOWER /FALSE
	EQUAL? PRSO,KEY \?L7
	EQUAL? PRSI,KEY /FALSE
?L7:	EQUAL? PRSO,BANANA \?L8
	EQUAL? PRSI,BANANA /FALSE
?L8:	ZERO? PRSI /?L9
	EQUAL? PRSA,V?TAKE \?L9
	EQUAL? PRSI,POLE \?L9
	CALL PERFORM,V?TAKE-WITH,PRSO,POLE
	RTRUE
?L9:	IN? PRSO,PROTAGONIST /?L11
	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L10
	FSET? PRSO,TAKEBIT /?L10
?L11:	FSET? PRSO,WORNBIT \?L12
	PRINTR "You are already wearing it."
?L12:	CALL HAVE-IT >STACK
	RSTACK
?L10:	ZERO? PRSI /?L17
	EQUAL? PRSA,V?TAKE-WITH \?L18
	EQUAL? PRSI,HANDS \?L20
	CALL PERFORM,V?TAKE,PRSO
	RTRUE
?L20:	CALL HELD?,PRSI >STACK
	ZERO? STACK \?L22
	EQUAL? PRSI,GLOBAL-MONEY,DOLLAR /?L22
	PRINT NOT-HOLDING
	CALL ARTICLE,PRSI,1
	PRINT PERIOD
	RTRUE
?L22:	CALL HELD?,PRSO >STACK
	ZERO? STACK /FALSE
	CALL HAVE-IT >STACK
	RSTACK
?L18:	EQUAL? PRSO,ME \?L29
	CALL PERFORM,V?DROP,PRSI
	RTRUE
?L29:	EQUAL? HERE,CON-AREA \?L30
	EQUAL? PRSO,GLOBAL-WATER,WATER /FALSE
?L30:	IN? PRSO,JOEY \?L31
	EQUAL? PRSI,EDDIE /FALSE
?L31:	LOC PRSO >STACK
	EQUAL? PRSI,STACK /?L32
	PRINTI "But"
	CALL ARTICLE,PRSO,1
	PRINTI " isn't "
	FSET? PRSI,ACTORBIT \?L37
	PRINTI "being held by"
	JUMP ?L44
?L37:	FSET? PRSI,SURFACEBIT \?L41
	PRINTI "on"
	JUMP ?L44
?L41:	PRINTI "in"
?L44:	CALL ARTICLE,PRSI,1
	PRINT PERIOD
	RTRUE
?L32:	SET 'PRSI,0
	RFALSE
?L17:	LOC WINNER >STACK
	EQUAL? PRSO,STACK \FALSE
	PRINTR "You are on it!"

	.FUNCT HAVE-IT
	PRINTI "You already have "
	EQUAL? PRSO,THUMB \?L3
	PRINTI "him"
	JUMP ?L10
?L3:	EQUAL? PRSO,GIRL \?L7
	PRINTI "her"
	JUMP ?L10
?L7:	PRINTI "it"
?L10:	PRINT PERIOD
	RTRUE

	.FUNCT V-TAKE
	CALL ITAKE >STACK
	EQUAL? STACK,1 \TRUE
	PRINTI "Taken."
	CRLF
	CALL IS-THEFT? >STACK
	CALL PRINT-ID,STR?106,STACK
	EQUAL? PRSO,RADIO \TRUE
	ZERO? RADIO-POINTS \TRUE
	SET 'RADIO-POINTS,1
	ADD SCORE,10 >SCORE
	RTRUE

	.FUNCT V-TAKE-OFF
	FSET? PRSO,WORNBIT \?L1
	FCLEAR PRSO,WORNBIT
	PRINTI "Okay, you're no longer wearing"
	CALL ARTICLE,PRSO,1
	PRINT PERIOD
	EQUAL? PRSO,MASK \TRUE
	PUTP PROTAGONIST,P?ACTION,PROTAGONIST-F
	RTRUE
?L1:	FSET? PRSO,VEHBIT \?L10
	CALL PERFORM,V?DISEMBARK,PRSO
	RTRUE
?L10:	EQUAL? PRSO,CAGE,WAGON,TENT /?L12
	EQUAL? PRSO,PLATFORM \?L11
?L12:	EQUAL? HERE,ON-CAGE,ON-TENT,PLATFORM \?L13
	CALL DO-WALK,P?DOWN
	RTRUE
?L13:	EQUAL? HERE,ON-WAGON \?L15
	CALL PERFORM,V?CLIMB-DOWN,LADDER
	RTRUE
?L15:	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L11:	FSET? PRSO,WEARBIT \?L19
	PRINTR "You aren't wearing that!"
?L19:	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-TAKE-WITH
	PRINTI "Well,"
	CALL ARTICLE,PRSI,1
	PRINTI " is of little use in obtaining"
	CALL ARTICLE,PRSO,1
	PRINT PERIOD
	RTRUE

	.FUNCT V-TALK-INTO
	CALL V-COUNT >STACK
	RSTACK

	.FUNCT V-TAME
	EQUAL? PRSO,LION-NAME,NIMROD,ELSIE \?L1
	PRINT HOW
	CRLF
	RTRUE
?L1:	PRINTI "But"
	CALL ARTICLE,PRSO,1
	PRINTR " isn't so wild."

	.FUNCT V-TASTE
	FSET? PRSO,EATBIT \?L1
	PRINTR "The taste is quite strong."
?L1:	PRINTI "Yuck!"
	CRLF
	CALL PRINT-ID,STR?107 >STACK
	RSTACK

	.FUNCT V-TELL
	FSET? PRSO,ACTORBIT \?L1
	ZERO? P-CONT /?L3
	SET 'WINNER,PRSO
	LOC WINNER >HERE
	RTRUE
?L3:	PRINTI "Hmmm ..."
	CALL ARTICLE,PRSO,1
	EQUAL? PRSO,GUARD \?L8
	PRINTI " appears willing to listen to you"
	JUMP ?L12
?L8:	PRINTI " looks at you expectantly, as if you seemed to be about to talk"
?L12:	PRINT PERIOD
	RTRUE
?L1:	PRINTI "You can't talk to"
	CALL ARTICLE,PRSO
	PRINTI "!"
	CRLF
	CALL STOP >STACK
	RSTACK

	.FUNCT V-TELL-ABOUT
	EQUAL? PRSO,ME \?L1
	CALL PERFORM,V?WHAT,PRSI
	RTRUE
?L1:	PRINTI "It doesn't look like"
	CALL ARTICLE,PRSO,1
	PRINTR " is interested."

	.FUNCT V-TELL-TIME
	PRINT BAD-SENTENCE
	CRLF
	RTRUE

	.FUNCT V-TELL-NAME
	CALL V-TELL-TIME >STACK
	RSTACK

	.FUNCT V-THANK
	ZERO? PRSO /?L1
	FSET? PRSO,PERSON \?L1
	PRINTR "You're more than welcome."
?L1:	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT V-THROUGH,M
	FSET? PRSO,DOORBIT \?L1
	CALL OTHER-SIDE,PRSO >STACK
	CALL DO-WALK,STACK
	RTRUE
?L1:	FSET? PRSO,VEHBIT /?L4
	EQUAL? PRSO,LONG,SHORT \?L3
?L4:	CALL PERFORM,V?BOARD,PRSO
	RTRUE
?L3:	EQUAL? PRSO,INTDIR \?L5
	CALL PERFORM,V?WALK,PRSO
	RTRUE
?L5:	FSET? PRSO,TAKEBIT /?L6
	CALL TELL-HIT-HEAD >STACK
	RSTACK
?L6:	IN? PRSO,WINNER \?L7
	CALL PERFORM,V?EXAMINE,BACK
	RTRUE
?L7:	CALL V-INHALE >STACK
	RSTACK

	.FUNCT PRE-THROW
	CALL IDROP >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT V-THROW
	ZERO? PRSI /?L5
	FSET? LION-DOOR,OPENBIT \?L1
	EQUAL? PRSI,LION-DOOR \?L1
	PRINTR "That wouldn't do any good."
?L1:	EQUAL? PRSI,0,GROUND /?L5
	MOVE PRSO,HERE
	PRINT BAD-AIM
	PRINTI ";"
	CALL ARTICLE,PRSO,1
	PRINTR " goes sailing by."
?L5:	GETP HERE,P?GROUND-LOC >STACK
	ZERO? STACK /?L10
	CALL PERFORM,V?THROW-OFF,PRSO,CAGE
	RTRUE
?L10:	MOVE PRSO,HERE
	PRINTR "Thrown."

	.FUNCT V-THROW-OFF
	GETP HERE,P?GROUND-LOC >STACK
	ZERO? STACK /?L1
	EQUAL? PRSI,CAGE,TENT,PLATFORM \?L1
	GETP HERE,P?GROUND-LOC >STACK
	MOVE PRSO,STACK
	PRINTR "It falls to the ground below."
?L1:	CALL V-COUNT >STACK
	RSTACK

	.FUNCT V-TIE
	EQUAL? PRSO,RIBBON \?L1
	CALL V-DIG >STACK
	RSTACK
?L1:	PRINTI "You can't tie"
	CALL ARTICLE,PRSO
	ZERO? PRSI /?L6
	PRINTI " to"
	CALL ARTICLE,PRSI
?L6:	PRINT PERIOD
	RTRUE

	.FUNCT V-TUNE
	ZERO? PRSI \?L1
	PRINTI "Unfortunately, "
	CALL HACK-HACK,STR?108 >STACK
	RSTACK
?L1:	CALL PERFORM,V?SET,PRSO,PRSI
	RTRUE

	.FUNCT V-UNLOCK
	FSET? PRSO,DOORBIT /?L3
	EQUAL? PRSO,KIESTER,BAGGAGE-COMPARTMENT,DESK \?L1
?L3:	FSET? PRSO,OPENBIT \?L4
	EQUAL? PRSO,DESK /?L4
	CALL PERFORM,V?LOCK,PRSO,PRSI
	RTRUE
?L4:	FSET? PRSO,CAGEBIT /?L8
	EQUAL? HERE,OFFICE \?L7
?L8:	EQUAL? PRSO,DESK \?L6
?L7:	CALL CANT-LOCK >STACK
	RSTACK
?L6:	FSET? PRSO,LOCKEDBIT \?L9
	FCLEAR PRSO,LOCKEDBIT
	PRINTI "The "
	CALL DPRINT,PRSO
	PRINTR " is now unlocked."
?L9:	PRINTI "But the "
	CALL DPRINT,PRSO
	PRINTR " isn't locked."
?L1:	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT CANT-LOCK
	PRINTI "However many times you flip over the key, jiggle the lock, and cajole the "
	CALL DPRINT,PRSO
	PRINTI ", you can't make the key fit the lock."
	CRLF
	CALL PRINT-ID,STR?109 >STACK
	RSTACK

	.FUNCT V-UNTIE
	EQUAL? PRSO,LADDER \?L1
	EQUAL? HERE,RING,PLATFORM-1 \?L1
	ZERO? END-GAME /?L1
	PRINTR "It's hopelessly balled up."
?L1:	CALL V-INHALE >STACK
	RSTACK

	.FUNCT V-VAULT
	ZERO? PRSI \?L1
	CALL HELD?,POLE >STACK
	ZERO? STACK \?L1
	PRINTR "You have no pole."
?L1:	EQUAL? PRSI,POLE /?L6
	ZERO? PRSI \?L5
	CALL HELD?,POLE >STACK
	ZERO? STACK /?L5
	CALL HELD?,PRSO >STACK
	ZERO? STACK \?L5
	FSET? PRSO,TAKEBIT /?L5
?L6:	PRINTI "You carefully mark off the steps leading up to"
	CALL ARTICLE,PRSO,1
	PRINTI " but, right before the approach, you're psyched out by the image of "
	CALL DPRINT,ME
	PRINTI " in a full body-cast."
	CRLF
	CALL PRINT-ID,STR?110 >STACK
	RSTACK
?L5:	CALL V-COUNT >STACK
	RSTACK

	.FUNCT V-WALK,PT,PTS,STR,OBJ,RM
	ZERO? P-WALK-DIR \?L1
	CALL PERFORM,V?WALK-TO,PRSO
	RTRUE
?L1:	GETPT HERE,PRSO >PT
	ZERO? PT /?L3
	PTSIZE PT >PTS
	EQUAL? PTS,UEXIT \?L4
	GETB PT,REXIT >STACK
	CALL GOTO,STACK >STACK
	RSTACK
?L4:	EQUAL? PTS,NEXIT \?L6
	GET PT,NEXITSTR >STACK
	PRINT STACK
	CRLF
	RETURN 2
?L6:	EQUAL? PTS,FEXIT \?L11
	GET PT,FEXITFCN >STACK
	CALL STACK >RM
	ZERO? RM /?L12
	CALL GOTO,RM >STACK
	RSTACK
?L12:	RETURN 2
?L11:	EQUAL? PTS,CEXIT \?L17
	GETB PT,CEXITFLAG >STACK
	VALUE STACK >STACK
	ZERO? STACK /?L18
	GETB PT,REXIT >STACK
	CALL GOTO,STACK >STACK
	RSTACK
?L18:	GET PT,CEXITSTR >STR
	ZERO? STR /?L20
	PRINT STR
	CRLF
	RETURN 2
?L20:	PRINT CANT-GO
	CRLF
	RETURN 2
?L17:	EQUAL? PTS,DEXIT \FALSE
	GETB PT,DEXITOBJ >OBJ
	FSET? OBJ,OPENBIT \?L31
	GETB PT,REXIT >STACK
	CALL GOTO,STACK >STACK
	RSTACK
?L31:	GET PT,DEXITSTR >STR
	ZERO? STR /?L33
	PRINT STR
	CRLF
	SET 'P-IT-OBJECT,OBJ
	RETURN 2
?L33:	PRINTI "The "
	CALL DPRINT,OBJ
	PRINTI " is closed."
	CRLF
	SET 'P-IT-OBJECT,OBJ
	RETURN 2
?L3:	EQUAL? PRSO,P?IN,P?OUT \?L45
	CALL V-WALK-AROUND
	RETURN 2
?L45:	PRINT CANT-GO
	CRLF
	RETURN 2

	.FUNCT V-WALK-AROUND
	SET 'AWAITING-REPLY,13
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTR "Did you have any particular direction in mind?"

	.FUNCT V-WALK-OVER
	EQUAL? PRSO,CHUTE \?L1
	CALL PERFORM,V?LOOK-BEHIND,CHUTE
	RTRUE
?L1:	CALL PERFORM,V?THROUGH,PRSO
	RTRUE

	.FUNCT V-WALK-TO
	ZERO? PRSO /?L1
	EQUAL? PRSO,INTDIR \?L3
	CALL DO-WALK,P-DIRECTION
	RTRUE
?L3:	CALL V-FOLLOW >STACK
	RSTACK
?L1:	CALL V-WALK-AROUND >STACK
	RSTACK

	.FUNCT V-WAIT,NUM=3
	PRINTI "Time passes..."
	CRLF
?L3:	DLESS? 'NUM,0 /?L4
	CALL CLOCKER >STACK
	ZERO? STACK /?L3
?L4:	SET 'CLOCK-WAIT,1
	RETURN CLOCK-WAIT

	.FUNCT V-WAIT-FOR
	PRINTR "You may be waiting quite a while."

	.FUNCT V-WAIT-IN
	LOC PROTAGONIST >STACK
	EQUAL? STACK,PRSO \?L1
	CALL V-WAIT >STACK
	RSTACK
?L1:	FSET? PRSO,VEHBIT \?L3
	CALL PERFORM,V?BOARD,PRSO
	RTRUE
?L3:	CALL V-COUNT >STACK
	RSTACK

	.FUNCT V-WAVE
	CALL V-INHALE >STACK
	RSTACK

	.FUNCT V-WAVE-AT
	ZERO? PRSO \?L1
	CALL V-SMILE >STACK
	RSTACK
?L1:	PRINTI "Despite your friendly nature,"
	CALL ARTICLE,PRSO,1
	PRINTR " isn't likely to respond."

	.FUNCT PRE-WEAR
	FSET? PRSO,WEARBIT /?L1
	PRINTI "You can't wear"
	CALL ARTICLE,PRSO,1
	PRINT PERIOD
	RTRUE
?L1:	FSET? PRSO,WORNBIT \FALSE
	PRINTI "You're already wearing"
	CALL ARTICLE,PRSO,1
	PRINTR "!"

	.FUNCT V-WEAR
	MOVE PRSO,PROTAGONIST
	FSET PRSO,WORNBIT
	PRINTI "You are now wearing"
	CALL ARTICLE,PRSO,1
	PRINT PERIOD
	RTRUE

	.FUNCT V-WHAT
	ZERO? PRSO \?L1
	PRINTI "That's what."
	CRLF
	JUMP ?L8
?L1:	EQUAL? PRSO,HYP \?L5
	CALL IS-NOUN?,W?PHRENO >STACK
	ZERO? STACK /?L5
	PRINTI "Look it up."
	CRLF
	JUMP ?L8
?L5:	PRINTI "Good question."
	CRLF
?L8:	CALL STOP >STACK
	RSTACK

	.FUNCT V-WHERE
	ZERO? PRSO /?L1
	CALL V-FIND,1 >STACK
	RSTACK
?L1:	PRINTR "Right here."

	.FUNCT V-WHIP
	ZERO? PRSI \?L1
	CALL WHIP-HOLD >STACK
	ZERO? STACK \TRUE
	EQUAL? PRSO,WHIP \?L5
	PRINTR "The quietude is shattered by an earsplitting ""crack!"" The musty scent of rawhide drifts into your nostrils."
?L5:	IN? WHIP,PROTAGONIST \?L8
	CALL PERFORM,V?WHIP,PRSO,WHIP
	RTRUE
?L8:	CALL WHIP-HOLD
	RTRUE
?L1:	EQUAL? PRSI,WHIP \?L10
	CALL WHIP-HOLD >STACK
	ZERO? STACK \TRUE
	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L13
	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE
?L13:	FSET? PRSO,PERSON \?L16
	EQUAL? PRSO,TAFT /?L16
	PRINTI "As"
	CALL ARTICLE,PRSO,1
	PRINTI " sidesteps your attack, the bullwhip shatters the air right next to "
	CALL PRINT-ID,STR?111
	FSET? PRSO,FEMALE \?L21
	PRINTI "her"
	JUMP ?L25
?L21:	PRINTI "him"
?L25:	PRINT PERIOD
	RTRUE
?L16:	FSET? PRSO,WORNBIT \?L30
	CALL PERFORM,V?WHIP,ME,WHIP
	RTRUE
?L30:	PRINTI "The whip strikes"
	CALL ARTICLE,PRSO,1
	PRINTI ", but nothing else happens."
	CRLF
	CALL IS-OBJECT-OR-PROPERTY? >STACK
	CALL PRINT-ID,STR?112,STACK >STACK
	RSTACK
?L10:	PRINTR "Don't ever bother applying for a job as a cowboy."

	.FUNCT V-WHO
	ZERO? PRSO \?L1
	PRINTR "You."
?L1:	FSET? PRSO,ACTORBIT \?L5
	CALL PERFORM,V?WHAT,PRSO
	RTRUE
?L5:	PRINTR "That's not a person!"

	.FUNCT V-WHY
	PRINTR "Why not?"

	.FUNCT V-YELL
	PRINTI "You begin to get a sore throat."
	CRLF
	CALL PRINT-ID,STR?113
	CALL STOP >STACK
	RSTACK

	.FUNCT V-YOU-ARE-OBJECT
	ZERO? PRSO \?L1
	CALL ENABLED?,I-TURNSTILE
	CALL PERFORM,V?TELL,ANDREW
	RTRUE
?L1:	CALL PERFORM,V?TELL,ME
	RTRUE

	.FUNCT I-REPLY
	SET 'AWAITING-REPLY,0
	RFALSE

	.FUNCT V-YES,VEH
	LOC PROTAGONIST >VEH
	EQUAL? AWAITING-REPLY,1 \?L1
	PRINTI "You nonchalantly walk away from the "
	CALL DPRINT,VEH
	PRINTI "."
	CRLF
	MOVE PROTAGONIST,HERE
	RTRUE
?L1:	EQUAL? AWAITING-REPLY,2 \?L5
	PRINTR "A most wholesome decision."
?L5:	EQUAL? AWAITING-REPLY,3 \?L8
	PRINTR "Not surprisingly."
?L8:	EQUAL? AWAITING-REPLY,4 \?L11
	PRINTI "That's really beneath you."
	CRLF
	CALL PRINT-ID,STR?114 >STACK
	RSTACK
?L11:	EQUAL? AWAITING-REPLY,5 \?L14
	PRINTI "Alright, that's the last "
	CALL DPRINT,STRAW
	PRINTI "."
	CRLF
	CALL TELL-FINISH
	READ P-INBUF,P-LEXV
	PRINTR "Well, not quite the LAST straw. Please resume play."
?L14:	EQUAL? AWAITING-REPLY,6 \?L19
	ZERO? DID-C /?L20
	FSET PROTAGONIST,RMUNGBIT
	PRINTR """Did not ... Er, um ... Well, I guess I didn't answer that question before. All I can say is that I haven't seen the kid all evening."""
?L20:	PRINTI """Thought you'd see it my way."""
	CRLF
	SET 'DID-C,0
	CALL INT,I-DID >STACK
	PUT STACK,0,0
	RTRUE
?L19:	EQUAL? AWAITING-REPLY,7 \?L27
	PRINTR "Real brainy of you."
?L27:	EQUAL? AWAITING-REPLY,8 \?L30
	IN? CON,HERE \?L30
	PRINTR """Well then scram."""
?L30:	EQUAL? AWAITING-REPLY,9 \?L33
	PRINTR "For shame."
?L33:	EQUAL? AWAITING-REPLY,10,12 \?L36
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L36:	EQUAL? AWAITING-REPLY,11 \?L37
	SET 'EGRESS-C,0
	PRINTR "Then you'd be helpless against this dangerous beast."
?L37:	EQUAL? AWAITING-REPLY,13 \?L40
	PRINTR "Then supply it."
?L40:	PRINTR "Yes?"

	.FUNCT ITAKE,VB=1,OBJ,?TMP
	FSET? PRSO,TAKEBIT /?L1
	ZERO? VB /?L3
	CALL V-INHALE
?L3:	RETURN 2
?L1:	LOC PRSO >STACK
	IN? STACK,WINNER /?L18
	CALL WEIGHT,PRSO >?TMP
	CALL WEIGHT,WINNER >STACK
	ADD ?TMP,STACK >STACK
	GRTR? STACK,100 \?L9
	ZERO? VB /?L11
	PRINTI "Your load would be too heavy."
	CRLF
	CALL IS-THEFT? >STACK
	CALL PRINT-ID,STR?115,STACK
?L11:	RETURN 2
?L9:	CALL CCOUNT,WINNER >STACK
	GRTR? STACK,9 \?L18
	ZERO? VB /?L19
	PRINTI "You're holding too much already."
	CRLF
	CALL IS-THEFT? >STACK
	CALL PRINT-ID,STR?116,STACK
?L19:	RETURN 2
?L18:	MOVE PRSO,PROTAGONIST
	FSET PRSO,TOUCHBIT
	FCLEAR PRSO,NDESCBIT
	RTRUE

	.FUNCT IDROP
	EQUAL? PRSO,TIGHTROPE-OBJECT \?L1
	EQUAL? HERE,LEFT-HANGING /FALSE
?L1:	EQUAL? PRSA,V?DROP \?L3
	EQUAL? PRSO,ME \?L3
	EQUAL? HERE,LEFT-HANGING \?L3
	CALL PERFORM,V?LEAP
	RTRUE
?L3:	EQUAL? PRSO,DIAL \?L4
	CALL V-COUNT >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?DROP \?L5
	EQUAL? PRSO,PHONE /FALSE
?L5:	EQUAL? PRSO,HELIUM,BACK,HANDS /?L7
	EQUAL? PRSO,HEAD \?L6
?L7:	EQUAL? PRSA,V?GIVE,V?THROW,V?DROP /?L10
	EQUAL? PRSO,HEAD,HELIUM,BACK \FALSE
	EQUAL? PRSA,V?PUT-ON,V?PUT \FALSE
?L10:	CALL V-COUNT >STACK
	RSTACK
?L6:	EQUAL? PRSA,V?THROW,V?DROP,V?GIVE /?L13
	EQUAL? PRSA,V?PUT-ON,V?PUT \?L12
?L13:	EQUAL? PRSO,INTNUM \?L12
	ZERO? P-DOLLAR-FLAG \?L12
	CALL SPECIFY-MONEY
	SET 'CLOCK-WAIT,1
	RETURN 2
?L12:	EQUAL? PRSO,DOLLAR,GLOBAL-MONEY /?L17
	EQUAL? PRSO,INTNUM \?L41
	ZERO? P-DOLLAR-FLAG /?L16
?L17:	EQUAL? PRSA,V?GIVE \?L29
	EQUAL? POCKET-CHANGE,1841 \?L18
	EQUAL? HERE,STANDS-ROOM /FALSE
?L18:	EQUAL? PRSA,V?GIVE \?L29
	EQUAL? PRSI,CROWD,HAWKER \?L20
	EQUAL? HERE,STANDS-ROOM \FALSE
	PRINTR "The hawker doesn't notice your desire to buy."
?L20:	EQUAL? PRSA,V?GIVE \?L29
	EQUAL? PRSI,GUARD \?L26
	PRINTR """Hey, you'd better take better care of your money, especially around here."""
?L26:	EQUAL? PRSA,V?GIVE \?L29
	FSET? PRSI,PERSON \?L29
	EQUAL? PRSI,TAFT /?L29
	PRINTI "Disdainfully,"
	CALL ARTICLE,PRSI,1
	PRINTR " rejects your cash payment."
?L29:	EQUAL? PRSI,SLOT \?L36
	EQUAL? PRSA,V?PUT /FALSE
?L36:	EQUAL? PRSI,TABLE \?L34
	EQUAL? PRSA,V?PUT-ON /FALSE
?L34:	EQUAL? PRSA,V?PUT \?L37
	EQUAL? PRSI,DRESS \?L37
	CALL V-DIG >STACK
	RSTACK
?L37:	PRINTR "You can't afford to."
?L16:	EQUAL? PRSO,INTNUM \?L41
	ZERO? PRSI /?L42
	CALL PERFORM,PRSA,PRSO,GLOBAL-MONEY
	RTRUE
?L42:	CALL PERFORM,PRSA,GLOBAL-MONEY
	RTRUE
?L41:	CALL HELD?,PRSO >STACK
	ZERO? STACK \?L45
	PRINTI "That's easy for you to say since you don't even have"
	CALL ARTICLE,PRSO,1
	PRINT PERIOD
	RTRUE
?L45:	EQUAL? HERE,ON-TENT \?L50
	FSET? PRSO,WORNBIT /?L50
	EQUAL? PRSO,PROD /?L50
	EQUAL? PRSA,V?DROP /?L51
	EQUAL? PRSA,V?PUT-ON \?L50
	EQUAL? PRSI,TENT \?L50
?L51:	RANDOM 100 >STACK
	LESS? 50,STACK /?L52
	MOVE PRSO,ON-CAGE
	JUMP ?L54
?L52:	MOVE PRSO,NOOK
?L54:	PRINTR "It slides off the tent."
?L50:	EQUAL? HERE,TIGHTROPE-ROOM \?L57
	EQUAL? PRSO,WATER,BALLOON /?L57
	EQUAL? PRSI,PLATFORM,BUCKET,DRESS /?L57
	EQUAL? PRSA,V?GIVE /?L57
	FSET? PRSO,WORNBIT /?L57
	MOVE PRSO,RING
	EQUAL? PRSO,BUCKET \?L58
	IN? WATER,BUCKET \?L58
	MOVE WATER,LOCAL-GLOBALS
?L58:	PRINTI "It falls"
	IN? NET,RING /?L65
	IN? NET,MUNRAB \?L63
?L65:	PRINTI ", luckily for the sake of whoever may later dive into the net,"
?L63:	PRINTI " to the "
	CALL DPRINT,GROUND
	PRINTR " below."
?L57:	IN? PRSO,WINNER /?L71
	LOC PRSO >STACK
	FSET? STACK,CONTBIT \?L71
	LOC PRSO >STACK
	FSET? STACK,OPENBIT /?L71
	PRINTI "Impossible because"
	LOC PRSO >STACK
	CALL ARTICLE,STACK,1
	PRINTR " is closed."
?L71:	EQUAL? PRSA,V?PUT-ON \?L76
	EQUAL? PRSI,ME \?L76
	CALL PERFORM,V?WEAR,PRSO
	RTRUE
?L76:	FSET? PRSO,WORNBIT \?L77
	CALL REMOVE-FIRST >STACK
	RSTACK
?L77:	EQUAL? PRSO,MONKEY \FALSE
	EQUAL? PRSA,V?SHOW /FALSE
	PRINT NOT-HOLDING
	PRINTI " the "
	CALL DPRINT,MONKEY
	PRINTR "."

	.FUNCT REMOVE-FIRST,OBJ=0
	PRINTI "You'll have to remove "
	ZERO? OBJ /?L3
	PRINTI "the "
	CALL DPRINT,OBJ
	JUMP ?L7
?L3:	PRINTI "it"
?L7:	PRINTR " first."

	.FUNCT CCOUNT,OBJ,CNT=0,X
	FIRST? OBJ >X \?L4
?L3:	FSET? X,WORNBIT /?L5
	INC 'CNT
?L5:	NEXT? X >X /?L3
?L4:	RETURN CNT

	.FUNCT WEIGHT,OBJ,CONT,WT=0
	FIRST? OBJ >CONT \?L4
?L3:	EQUAL? OBJ,PLAYER \?L8
	FSET? CONT,WORNBIT \?L5
	INC 'WT
	JUMP ?L9
?L5:	EQUAL? OBJ,PLAYER \?L8
	LOC CONT >STACK
	FSET? STACK,WORNBIT \?L7
	INC 'WT
	JUMP ?L9
?L7:	EQUAL? OBJ,PLAYER \?L8
	INC 'WT
	JUMP ?L9
?L8:	CALL WEIGHT,CONT >STACK
	ADD WT,STACK >WT
?L9:	NEXT? CONT >CONT /?L3
?L4:	GETP OBJ,P?SIZE >STACK
	ADD WT,STACK >STACK
	RSTACK

	.FUNCT DESCRIBE-ROOM,LOOK?=0,V?,STR,AV
	SET 'V?,LOOK?
	ZERO? V? \?L4
	EQUAL? VERBOSITY,2 /?L3
	SET 'V?,0
	JUMP ?L4
?L3:	SET 'V?,1
?L4:	ZERO? LIT \?L5
	PRINTI "It is pitch black."
	CRLF
	RFALSE
?L5:	FSET? HERE,TOUCHBIT /?L10
	FSET HERE,TOUCHBIT
	SET 'V?,1
?L10:	IN? HERE,ROOMS \?L20
	EQUAL? HERE,TIGHTROPE-ROOM /?L15
	ZERO? VERBOSITY /?L15
	CALL DPRINT,HERE
?L15:	LOC WINNER >AV
	FSET? AV,VEHBIT /?L20
	ZERO? HIDING \?L20
	EQUAL? HERE,TIGHTROPE-ROOM /?L20
	CRLF
?L20:	ZERO? LOOK? \?L26
	EQUAL? VERBOSITY,1,2 \TRUE
?L26:	ZERO? HIDING /?L27
	PRINTI ", hiding behind the "
	CALL DPRINT,TAFT
	CRLF
	JUMP ?L31
?L27:	FSET? AV,VEHBIT \?L31
	EQUAL? AV,LONG,SHORT \?L32
	PRINTI ", "
	PRINT TAIL-END
	PRINTI " a "
	JUMP ?L39
?L32:	EQUAL? AV,NET \?L36
	PRINTI ", in the "
	JUMP ?L39
?L36:	PRINTI ", on the "
?L39:	CALL DPRINT,AV
	CRLF
?L31:	ZERO? V? /?L47
	GETP HERE,P?ACTION >STACK
	CALL STACK,M-LOOK >STACK
	ZERO? STACK \TRUE
	ZERO? V? /?L47
	GETP HERE,P?LDESC >STR
	ZERO? STR /?L47
	PRINT STR
	CRLF
	JUMP ?L50
?L47:	GETP HERE,P?ACTION >STACK
	CALL STACK,M-FLASH >STACK
?L50:	EQUAL? HERE,AV /TRUE
	FSET? AV,VEHBIT \TRUE
	GETP AV,P?ACTION >STACK
	CALL STACK,M-LOOK >STACK
	RTRUE

	.FUNCT PRINT-CONTENTS,THING,ARTICLE-T?=0,OBJ,NXT,1ST?=1,IT?=0,TWO?=0
	FIRST? THING >OBJ /?L41
	JUMP ?L3
?L1:	ZERO? OBJ /?L3
?L41:	NEXT? OBJ >NXT /?L6
?L6:	FSET? OBJ,INVISIBLE /?L9
	FSET? OBJ,NDESCBIT \?L10
	EQUAL? OBJ,RIBBON \?L9
?L10:	EQUAL? OBJ,WINNER \?L7
?L9:	MOVE OBJ,C-OBJECT
?L7:	SET 'OBJ,NXT
	JUMP ?L1
?L3:	FIRST? THING >OBJ /?L42
	PRINTI " nothing "
	CALL PICK-ONE,YAWNS >STACK
	PRINT STACK
	JUMP ?L20
?L14:	ZERO? OBJ /?L21
?L42:	NEXT? OBJ >NXT /?L23
?L23:	ZERO? 1ST? /?L24
	SET '1ST?,0
	JUMP ?L31
?L24:	ZERO? NXT /?L27
	PRINTI ","
	JUMP ?L31
?L27:	PRINTI " and"
?L31:	CALL ARTICLE,OBJ,ARTICLE-T?
	ZERO? IT? \?L34
	ZERO? TWO? \?L34
	SET 'IT?,OBJ
	JUMP ?L36
?L34:	SET 'TWO?,1
	SET 'IT?,0
?L36:	SET 'OBJ,NXT
	JUMP ?L14
?L21:	ZERO? IT? /?L20
	ZERO? TWO? \?L20
	SET 'P-IT-OBJECT,IT?
?L20:	CALL ROB,C-OBJECT,THING >STACK
	RSTACK

	.FUNCT DESCRIBE-OBJECTS,THING=0,OBJ,NXT,STR,1ST?=1,TWO?=0,IT?=0,ANY?=0
	ZERO? THING \?L1
	SET 'THING,HERE
?L1:	ZERO? LIT \?L4
	PRINT TOO-DARK
	CRLF
	RTRUE
?L4:	FIRST? THING >OBJ /?L146
	RTRUE
?L10:	ZERO? OBJ /?L14
?L146:	NEXT? OBJ >NXT /?L17
?L17:	FSET? OBJ,INVISIBLE /?L20
	FSET? OBJ,NDESCBIT /?L20
	EQUAL? OBJ,WINNER /?L20
	LOC PROTAGONIST >STACK
	EQUAL? OBJ,STACK \?L18
?L20:	MOVE OBJ,DUMMY-OBJECT
?L18:	SET 'OBJ,NXT
	JUMP ?L10
?L14:	FIRST? THING >OBJ /?L147
	JUMP ?L25
?L23:	ZERO? OBJ /?L25
?L147:	EQUAL? THING,HERE \?L25
	NEXT? OBJ >NXT /?L28
?L28:	GETP OBJ,P?FDESC >STR
	ZERO? STR /?L29
	FSET? OBJ,TOUCHBIT /?L29
	CRLF
	PRINT STR
	CRLF
	MOVE OBJ,DUMMY-OBJECT
?L29:	SET 'OBJ,NXT
	JUMP ?L23
?L25:	FIRST? THING >OBJ /?L148
	JUMP ?L37
?L35:	ZERO? OBJ /?L37
?L148:	EQUAL? THING,HERE \?L37
	NEXT? OBJ >NXT /?L40
?L40:	GETP OBJ,P?LDESC >STR
	ZERO? STR /?L41
	CRLF
	PRINT STR
	CRLF
	MOVE OBJ,DUMMY-OBJECT
?L41:	SET 'OBJ,NXT
	JUMP ?L35
?L37:	FIRST? THING >OBJ /?L149
	JUMP ?L49
?L47:	ZERO? OBJ /?L49
?L149:	EQUAL? THING,HERE \?L49
	NEXT? OBJ >NXT /?L52
?L52:	GETP OBJ,P?DESCFCN >STACK
	ZERO? STACK /?L53
	CRLF
	GETP OBJ,P?DESCFCN >STACK
	CALL STACK,M-OBJDESC >STACK
	CRLF
	MOVE OBJ,DUMMY-OBJECT
?L53:	SET 'OBJ,NXT
	JUMP ?L47
?L49:	FIRST? THING >OBJ /?L151
	JUMP ?L61
?L60:	ZERO? OBJ /?L62
?L151:	NEXT? OBJ >NXT /?L64
?L64:	ZERO? 1ST? /?L65
	SET '1ST?,0
	EQUAL? THING,HERE \?L83
	CRLF
	ZERO? NXT /?L69
	PRINT YOU-SEE
	JUMP ?L83
?L69:	PRINTI "There's"
	JUMP ?L83
?L65:	ZERO? NXT \?L80
	EQUAL? THING,PROTAGONIST \?L78
	GRTR? POCKET-CHANGE,0 \?L78
?L80:	PRINTI ","
	JUMP ?L83
?L78:	PRINTI " and"
?L83:	CALL ARTICLE,OBJ
	FSET? OBJ,WORNBIT \?L86
	PRINTI " (being worn)"
?L86:	EQUAL? OBJ,MONKEY \?L91
	CALL HELD?,MONKEY >STACK
	ZERO? STACK /?L91
	PRINTI " on "
	CALL DPRINT,BACK
?L91:	EQUAL? OBJ,BUCKET \?L96
	IN? WATER,BUCKET \?L96
	PRINTI " (filled with "
	CALL DPRINT,WATER
	PRINTI ")"
	JUMP ?L100
?L96:	CALL SEE-INSIDE?,OBJ >STACK
	ZERO? STACK /?L100
	CALL SEE-ANYTHING-IN?,OBJ >STACK
	ZERO? STACK /?L100
	MOVE OBJ,X-OBJECT
?L100:	ZERO? IT? \?L102
	ZERO? TWO? \?L102
	SET 'IT?,OBJ
	JUMP ?L104
?L102:	SET 'TWO?,1
	SET 'IT?,0
?L104:	SET 'OBJ,NXT
	JUMP ?L60
?L62:	ZERO? IT? /?L106
	ZERO? TWO? \?L106
	SET 'P-IT-OBJECT,IT?
?L106:	EQUAL? THING,PROTAGONIST \?L109
	GRTR? POCKET-CHANGE,0 \?L109
	PRINTI " and "
	CALL PRINT-AMOUNT,POCKET-CHANGE
	PRINTI " to your name"
?L109:	EQUAL? THING,HERE \?L116
	PRINTI " here"
?L116:	PRINTI "."
	SET 'ANY?,1
?L61:	FIRST? X-OBJECT >OBJ \?L126
?L127:	FSET? OBJ,SURFACEBIT \?L130
	CRLF
	CRLF
	PRINTI "On"
	JUMP ?L134
?L130:	CRLF
	CRLF
	PRINTI "Inside"
?L134:	CALL ARTICLE,OBJ,1
	PRINTI " you see"
	CALL PRINT-CONTENTS,OBJ
	PRINTI "."
	NEXT? OBJ >OBJ /?L127
?L126:	ZERO? ANY? /?L142
	CRLF
?L142:	CALL ROB,X-OBJECT,THING
	CALL ROB,DUMMY-OBJECT,THING >STACK
	RSTACK

	.FUNCT SEE-ANYTHING-IN?,THING,OBJ,NXT,ANY?=0
	FIRST? THING >OBJ /?L11
	RETURN ANY?
?L11:	FSET? OBJ,INVISIBLE /?L6
	FSET? OBJ,NDESCBIT /?L6
	EQUAL? OBJ,WINNER /?L6
	SET 'ANY?,1
	RETURN ANY?
?L6:	NEXT? OBJ >OBJ /?L11
	RETURN ANY?

	.FUNCT DESCRIBE-VEHICLE
	MOVE PROTAGONIST,ROOMS
	FIRST? PRSO >STACK \?L1
	CALL PRINT-CONTENTS,PRSO
	PRINT PERIOD
	JUMP ?L5
?L1:	PRINT EMPTY
	PRINTI " (not counting you)."
	CRLF
?L5:	MOVE PROTAGONIST,PRSO
	RTRUE

	.FUNCT GOTO,RM,V?=1
	MOVE PROTAGONIST,RM
	SET 'HERE,RM
	CALL LIT?,HERE >LIT
	GETP HERE,P?ACTION >STACK
	CALL STACK,M-ENTER >STACK
	ZERO? V? /TRUE
	EQUAL? HERE,RM \TRUE
	CALL V-FIRST-LOOK
	RTRUE

	.FUNCT JIGS-UP,NUM,DESC
	PRINT DESC
	CALL TELL-DIED
	PRINTI "Well not quite died. The doctors do what they can, but as the debts rise and the prognosis dips you take the only avenue left -- and sell "
	CALL DPRINT,ME
	PRINTI " to the circus.

As ""The Human "
	GET FREAKS,NUM >STACK
	PRINT STACK
	PRINTI ","" you enjoy top billing as a popular midway attraction, garnering fame to rival that of nineteenth century oddity John Merrick.

Still, as the fingers of the Great Unwashed poke at your benumbed hide, you contemplate how this fate might have been thwarted."
	CRLF
	CALL FINISH >STACK
	RSTACK

	.FUNCT TELL-DIED
	CRLF
	CRLF
	PRINTI "[RIDX: 0]"
	CRLF
	CRLF
	RTRUE

	.FUNCT I-DEMISE
	CALL INT,I-DEMISE >STACK
	PUT STACK,0,0
	CRLF
	PRINTR "(The reports of your demise have been grossly exaggerated. You suffer little more than injured pride.)"

	.FUNCT ACCESSIBLE?,OBJ,L
	LOC OBJ >L
	FSET? OBJ,INVISIBLE /FALSE
	EQUAL? OBJ,PSEUDO-OBJECT \?L3
	EQUAL? LAST-PSEUDO-LOC,HERE \FALSE
	RTRUE
?L3:	ZERO? L /FALSE
	EQUAL? L,GLOBAL-OBJECTS /TRUE
	EQUAL? L,LOCAL-GLOBALS \?L9
	CALL GLOBAL-IN?,OBJ,HERE >STACK
	ZERO? STACK \TRUE
?L9:	CALL META-LOC,OBJ >STACK
	EQUAL? STACK,HERE \FALSE
	EQUAL? L,WINNER,HERE /TRUE
	FSET? L,OPENBIT \FALSE
	CALL ACCESSIBLE?,L >STACK
	ZERO? STACK /FALSE
	RTRUE

	.FUNCT VISIBLE?,OBJ,L
	LOC OBJ >L
	CALL ACCESSIBLE?,OBJ >STACK
	ZERO? STACK \TRUE
	CALL SEE-INSIDE?,L >STACK
	ZERO? STACK /FALSE
	CALL VISIBLE?,L >STACK
	ZERO? STACK /FALSE
	RTRUE

	.FUNCT META-LOC,OBJ
?L1:	ZERO? OBJ /FALSE
	IN? OBJ,GLOBAL-OBJECTS \?L5
	RETURN GLOBAL-OBJECTS
?L5:	IN? OBJ,ROOMS \?L7
	RETURN OBJ
?L7:	LOC OBJ >OBJ
	JUMP ?L1

	.FUNCT OTHER-SIDE,DOBJ,P=0,TEE
?L1:	NEXTP HERE,P >P
	LESS? P,P?OUT /FALSE
	GETPT HERE,P >TEE
	PTSIZE TEE >STACK
	EQUAL? STACK,DEXIT \?L1
	GETB TEE,DEXITOBJ >STACK
	EQUAL? STACK,DOBJ \?L1
	RETURN P

	.FUNCT HELD?,OBJ,CONT=0
	ZERO? CONT \?L1
	SET 'CONT,WINNER
?L1:	ZERO? OBJ /FALSE
	IN? OBJ,CONT /TRUE
	IN? OBJ,ROOMS /FALSE
	IN? OBJ,GLOBAL-OBJECTS /FALSE
	LOC OBJ >STACK
	CALL HELD?,STACK,CONT >STACK
	RSTACK

	.FUNCT SEE-INSIDE?,OBJ
	ZERO? OBJ /FALSE
	FSET? OBJ,INVISIBLE /FALSE
	FSET? OBJ,TRANSBIT /TRUE
	FSET? OBJ,OPENBIT /TRUE
	RFALSE

	.FUNCT GLOBAL-IN?,OBJ1,OBJ2,TEE
	GETPT OBJ2,P?GLOBAL >TEE
	ZERO? TEE /FALSE
	PTSIZE TEE >STACK
	DEC 'STACK
	CALL ZMEMQB,OBJ1,TEE,STACK >STACK
	RSTACK

	.FUNCT FIND-IN,WHERE,WHAT,W
	FIRST? WHERE >W \FALSE
?L2:	FSET? W,WHAT \?L7
	RETURN W
?L7:	NEXT? W >W /?L2
	RFALSE

	.FUNCT LOC-CLOSED
	LOC PRSO >STACK
	FSET? STACK,CONTBIT \FALSE
	LOC PRSO >STACK
	FSET? STACK,OPENBIT /FALSE
	FSET? PRSO,TAKEBIT \FALSE
	PRINTI "But"
	LOC PRSO >STACK
	CALL ARTICLE,STACK,1
	PRINTR " is closed!"

	.FUNCT DO-WALK,DIR
	SET 'P-WALK-DIR,DIR
	CALL PERFORM,V?WALK,DIR >STACK
	RSTACK

	.FUNCT STOP
	SET 'P-CONT,0
	SET 'QUOTE-FLAG,0
	RETURN 2

	.FUNCT ROB,WHO,WHERE=0,N,X
	FIRST? WHO >X /?L4
	RTRUE
?L1:	ZERO? X /TRUE
?L4:	NEXT? X >N /?L7
?L7:	EQUAL? WHERE,BIGTOP \?L8
	FSET? X,WORNBIT \?L8
	FSET X,REWEARBIT
?L8:	EQUAL? WHERE,PROTAGONIST \?L11
	FSET? X,REWEARBIT \?L11
	FSET X,WORNBIT
	JUMP ?L13
?L11:	FCLEAR X,WORNBIT
?L13:	MOVE X,WHERE
	SET 'X,N
	JUMP ?L1

	.FUNCT MOVE-TAKEBIT,LOC1,LOC2,OBJ
?L1:	CALL FIND-IN,LOC1,TAKEBIT >OBJ
	ZERO? OBJ /TRUE
	MOVE OBJ,LOC2
	JUMP ?L1

	.FUNCT HACK-HACK,STR
	PRINT STR
	CALL ARTICLE,PRSO,1
	CALL PICK-ONE,HO-HUM >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT ARTICLE,OBJ,THE=0
	ZERO? OBJ \?L1
	SET 'OBJ,NOT-HERE-OBJECT
?L1:	FSET? OBJ,NARTICLEBIT /?L16
	ZERO? THE /?L6
	PRINTI " the"
	JUMP ?L16
?L6:	FSET? OBJ,NOA \?L10
	PRINTI " "
	CALL DPRINT,OBJ
	RTRUE
?L10:	FSET? OBJ,VOWELBIT \?L13
	PRINTI " an"
	JUMP ?L16
?L13:	PRINTI " a"
?L16:	PRINTI " "
	CALL DPRINT,OBJ >STACK
	RSTACK

	.FUNCT PICK-CARD,NUM,TMP
	IGRTR? 'CARD-COUNT,52 \?L1
	PRINTI """I'm shuffling the decks now."""
	CRLF
	CALL SHUFFLE-DECK
?L1:	RANDOM 52 >STACK
	SUB STACK,1 >NUM
	ZERO? FORCED-BET /?L8
	RANDOM 47 >STACK
	ADD 3,STACK >NUM
?L8:	GET CARD-TABLE,NUM >TMP
	ZERO? TMP /?L1
	SUB TMP,1 >STACK
	PUT CARD-TABLE,NUM,STACK
	RETURN NUM

	.FUNCT CARD-VALUE,NUM
	DIV NUM,4 >STACK
	GET CARD-VALUES,STACK >STACK
	RSTACK

	.FUNCT DEAL-HAND,TBL
	CALL PICK-CARD >STACK
	PUT TBL,1,STACK
	PUT TBL,0,1
	CALL PICK-CARD >STACK
	PUT TBL,2,STACK
	PUT TBL,0,2
	RTRUE

	.FUNCT TELL-HAND,TBL,CNT,1ST=1
	GET TBL,0 >CNT
?L1:	ZERO? CNT /TRUE
	ZERO? 1ST /?L6
	SET '1ST,0
	JUMP ?L8
?L6:	PRINTI " and the "
?L8:	GET TBL,CNT >STACK
	CALL TELL-CARD,STACK
	DEC 'CNT
	JUMP ?L1

	.FUNCT TELL-CARD,NUM
	DIV NUM,4 >STACK
	GET CARD-SPOT,STACK >STACK
	PRINT STACK
	PRINTI " of "
	MOD NUM,4 >STACK
	GET CARD-SUIT,STACK >STACK
	PRINT STACK
	RTRUE

	.FUNCT PLAY-HAND,BET,TMP,CNT,DEALER-HOLE,VAL=0,DD=0,?TMP
	PUT DEALER-HAND,0,0
	PUT YOUR-HAND,0,0
	CALL DEAL-HAND,DEALER-HAND
	CALL DEAL-HAND,YOUR-HAND
	PRINTI "The dealer gives you the "
	CALL TELL-HAND,YOUR-HAND
	PRINT PERIOD
	PRINTI "He deals himself the "
	GET DEALER-HAND,1 >STACK
	CALL TELL-CARD,STACK
	PRINTI " and one card down"
	IN? THUMB,HERE \?L9
	PRINTI ", which he peeks at"
?L9:	PRINTI "."
	CRLF
	CRLF
	GET YOUR-HAND,1 >STACK
	CALL CARD-VALUE,STACK >?TMP
	GET YOUR-HAND,2 >STACK
	CALL CARD-VALUE,STACK >STACK
	ADD ?TMP,STACK >YOUR-COUNT
	GET DEALER-HAND,1 >STACK
	CALL CARD-VALUE,STACK >?TMP
	GET DEALER-HAND,2 >STACK
	CALL CARD-VALUE,STACK >STACK
	ADD ?TMP,STACK >DEALER-COUNT
	EQUAL? DEALER-COUNT,21 \?L16
	PRINTI "The dealer turns over his hole card, which is the "
	GET DEALER-HAND,2 >STACK
	CALL TELL-CARD,STACK
	PRINTI ". ""Blackjack!"" he announces"
	EQUAL? YOUR-COUNT,21 \?L22
	PRINTI ". You tie him for a push."
	CRLF
	RFALSE
?L22:	PRINTI ", as he collects your bet."
	CRLF
	MUL BET,-1 >STACK
	RSTACK
?L16:	EQUAL? YOUR-COUNT,21 \?L29
	PRINTI "You show the dealer your blackjack, and he pays you "
	MUL BET,3 >STACK
	DIV STACK,2 >BET
	CALL PRINT-AMOUNT,BET
	PRINT PERIOD
	RETURN BET
?L29:	SET 'FORCED-BET,0
	GET DEALER-HAND,2 >STACK
	CALL CARD-VALUE,STACK >DEALER-HOLE
	IN? THUMB,HERE \?L35
	SET 'THUMB-TAPPED,1
	PRINTI "Inexplicably, you feel "
	EQUAL? DEALER-HOLE,1,11 \?L39
	PRINTI "one tap"
	JUMP ?L43
?L39:	PRINTN DEALER-HOLE
	PRINTI " taps"
?L43:	PRINTI " on your foot."
	CRLF
	CRLF
?L35:	PRINTI "Do you want another card? (Y is affirmative): "
	CALL YES? >STACK
	ZERO? STACK /?L53
	GET YOUR-HAND,0 >STACK
	ADD STACK,1 >CNT
	PUT YOUR-HAND,0,CNT
	SET '?TMP,YOUR-HAND
	CALL PICK-CARD >TMP
	PUT ?TMP,CNT,TMP
	CRLF
	PRINTI "You're dealt the "
	CALL TELL-CARD,TMP
	SET '?TMP,YOUR-COUNT
	CALL CARD-VALUE,TMP >STACK
	ADD ?TMP,STACK >YOUR-COUNT
	GRTR? YOUR-COUNT,21 \?L57
	CALL ACE-CHECK >STACK
	ZERO? STACK \?L57
	PRINTI " which puts you over 21, and the "
	CALL DPRINT,DEALER
	PRINTI " rakes in your bet."
	CRLF
	SUB 0,BET >VAL
	JUMP ?L50
?L57:	PRINT PERIOD
	JUMP ?L35
?L53:	GRTR? YOUR-COUNT,21 \?L50
	CALL ACE-CHECK
?L50:	CRLF
	PRINTI "The dealer turns up his hole card, the "
	GET DEALER-HAND,2 >STACK
	CALL TELL-CARD,STACK
	ZERO? VAL /?L70
	PRINTI ", and smiles."
	CRLF
	RETURN VAL
?L70:	PRINTI "."
	CRLF
?L74:	GRTR? DEALER-COUNT,21 \?L79
	CALL ACE-CHECK,0 >STACK
	ZERO? STACK \?L79
	PRINTI "This gives him "
	PRINTN DEALER-COUNT
	PRINTI ", putting him over. He pays you "
	CALL PRINT-AMOUNT,BET
	PRINT PERIOD
	RETURN BET
?L79:	GRTR? DEALER-COUNT,16 \?L85
	PRINTI "He stops here, with "
	PRINTN DEALER-COUNT
	PRINTI "."
	GRTR? YOUR-COUNT,DEALER-COUNT \?L88
	PRINTI " You beat him and reap the payoff, "
	CALL PRINT-AMOUNT,BET
	PRINT PERIOD
	RETURN BET
?L88:	EQUAL? YOUR-COUNT,DEALER-COUNT \?L94
	PRINTI " Your hand ties his for a push."
	CRLF
	RFALSE
?L94:	PRINTI " He beats you and rakes in your money."
	CRLF
	SUB 0,BET >STACK
	RSTACK
?L85:	GET DEALER-HAND,0 >STACK
	ADD STACK,1 >CNT
	PUT DEALER-HAND,0,CNT
	SET '?TMP,DEALER-HAND
	CALL PICK-CARD >TMP
	PUT ?TMP,CNT,TMP
	SET '?TMP,DEALER-COUNT
	CALL CARD-VALUE,TMP >STACK
	ADD ?TMP,STACK >DEALER-COUNT
	ZERO? DD /?L101
	PRINTI "He draws again"
	JUMP ?L105
?L101:	PRINTI "The dealer draws"
?L105:	PRINTI " and picks up the "
	CALL TELL-CARD,TMP
	PRINT PERIOD
	SET 'DD,1
	JUMP ?L74

	.FUNCT ACE-CHECK,PLAYER?=1,CNT,TMP,HND
	ZERO? PLAYER? /?L1
	SET 'HND,YOUR-HAND
	JUMP ?L3
?L1:	SET 'HND,DEALER-HAND
?L3:	GET HND,0 >CNT
?L4:	ZERO? CNT /FALSE
	GET HND,CNT >TMP
	CALL CARD-VALUE,TMP >STACK
	EQUAL? STACK,11 \?L12
	ADD TMP,52 >STACK
	PUT HND,CNT,STACK
	ZERO? PLAYER? /?L9
	SUB YOUR-COUNT,10 >YOUR-COUNT
	SET 'TMP,YOUR-COUNT
	JUMP ?L11
?L9:	SUB DEALER-COUNT,10 >DEALER-COUNT
	SET 'TMP,DEALER-COUNT
?L11:	LESS? TMP,22 /TRUE
?L12:	DEC 'CNT
	JUMP ?L4

	.FUNCT SHUFFLE-DECK,CNT=52
?L1:	ZERO? CNT /?L2
	DEC 'CNT
	PUT CARD-TABLE,CNT,4
	JUMP ?L1
?L2:	SET 'CARD-COUNT,0
	CALL ALREADY-GONE,DEALER-HAND
	CALL ALREADY-GONE,YOUR-HAND >STACK
	RSTACK

	.FUNCT ALREADY-GONE,HND,CNT,TMP
	GET HND,0 >CNT
?L1:	ZERO? CNT /TRUE
	GET HND,CNT >TMP
	GRTR? TMP,52 /?L8
	EQUAL? TMP,52 \?L6
?L8:	SUB TMP,52 >TMP
?L6:	GET CARD-TABLE,TMP >STACK
	DEC 'STACK
	PUT CARD-TABLE,TMP,STACK
	INC 'CARD-COUNT
	DEC 'CNT
	JUMP ?L1

	.FUNCT MIDWEST-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "To the west is the "
	CALL DPRINT,TURNSTILE
	PRINTI " exit from the midway, which continues east. The side of the "
	CALL DPRINT,BIGTOP
	PRINTI " borders on the north. "
	CALL TELL-BANNER >STACK
	RSTACK
?L1:	EQUAL? RARG,M-ENTER \FALSE
	FSET? MIDWEST,TOUCHBIT /?L6
	CALL QUEUE,I-DRUNK,-1 >STACK
	PUT STACK,0,1
	RTRUE
?L6:	IN? DICK,MIDWEST \FALSE
	FSET? DICK,RMUNGBIT \FALSE
	MOVE FLASK,DICK
	RTRUE

	.FUNCT TELL-FRONT,MID?=0
	PRINTI "Your eyes soak in the lavishly painted sideshow fronts "
	ZERO? MID? /?L3
	PRINTI "-- "
	CALL DPRINT,ANDREW
	PRINTI " "
	CALL DPRINT,JENNY
	PRINTI "'s to the south and Rimshaw's to"
	JUMP ?L7
?L3:	PRINTI "which line the midway along"
?L7:	PRINTR " the north. "

	.FUNCT TELL-BANNER,NORTH?=0
	PRINTI "A soiled, "
	CALL DPRINT,BANNER
	PRINTI " beckons "
	ZERO? NORTH? /?L3
	PRINTI "north"
	JUMP ?L7
?L3:	PRINTI "south"
?L7:	PRINT PERIOD
	RTRUE

	.FUNCT MEN-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "This scrawny patch of dirt offers a square cage on its west side; an open tent giving off a dank, earthy smell on its east side; and a well-worn path along the tent to the southeast. "
	CALL TELL-BANNER,1
	IN? BULL,MEN /FALSE
	CRLF
	CALL TELL-BULL-HOLE >STACK
	RSTACK
?L1:	EQUAL? RARG,M-ENTER \?L8
	EQUAL? P-WALK-DIR,P?EAST,P?OUT \FALSE
	ZERO? END-GAME \FALSE
	MOVE APE,MEN
	RTRUE
?L8:	EQUAL? RARG,M-END \FALSE
	IN? BULL,MEN \FALSE
	CALL ENABLED?,I-BULL >STACK
	ZERO? STACK \FALSE
	EQUAL? PRSA,V?LISTEN /FALSE
	RANDOM 100 >STACK
	LESS? 20,STACK /FALSE
	CALL QUEUE,I-CHAINS,1 >STACK
	PUT STACK,0,1
	RTRUE

	.FUNCT I-CHAINS
	CRLF
	PRINTI "The slow-moving sound of "
	CALL DPRINT,CHAIN
	PRINTI "s from inside the tent is heard."
	CRLF
	RFALSE

	.FUNCT APE-ENTER
	ZERO? END-GAME \?L3
	FSET? APE-DOOR,OPENBIT \?L1
?L3:	EQUAL? HERE,APE-ROOM \?L4
	RETURN MEN
?L4:	RETURN APE-ROOM
?L1:	PRINTI "The "
	CALL DPRINT,APE-DOOR
	PRINTI " is "
	CALL OPEN-CLOSED,APE-DOOR
	PRINT PERIOD
	RFALSE

	.FUNCT BULL-ENTER,FOO=MEN
	EQUAL? HERE,MEN \?L1
	IN? BULL,HERE \?L1
	PRINTI "With upraised tusks and flailing trunk, the "
	CALL DPRINT,BULL
	PRINTI " backs you off."
	CRLF
	RFALSE
?L1:	PRINTI "Mindful of where you step, you walk "
	EQUAL? HERE,MEN \?L8
	SET 'FOO,BULL-ROOM
	PRINTI "in"
	JUMP ?L12
?L8:	PRINTI "out"
?L12:	PRINTI "side the tent."
	CRLF
	CRLF
	RETURN FOO

	.FUNCT FENCE-EXIT
	IN? BULL,MEN /?L1
	EQUAL? HERE,NEAR-WAGON \?L3
	RETURN MEN
?L3:	FSET? LADDER,RMUNGBIT /?L6
	PRINTI "Walking through the damaged fence, y"
	CALL NOTICE-LADDER
?L6:	RETURN NEAR-WAGON
?L1:	PRINTI "A "
	CALL DPRINT,FENCE
	PRINTI " stops you."
	CRLF
	RFALSE

	.FUNCT APE-F
	FSET? APE,RMUNGBIT \?L1
	EQUAL? PRSA,V?EXAMINE /?L3
	CALL TALKING-TO?,APE >STACK
	ZERO? STACK /?L1
?L3:	PRINTI "He seems off in another world with his music."
	CRLF
	CALL STOP >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L6
	CALL DPRINT,APE
	PRINTI " appears as a huge ball of dark fur with a thumping breastplate and a crinkled mug, both high-gloss black. "
	EQUAL? HERE,APE-ROOM \?L9
	PRINTR "He's looking down at you quizzically."
?L9:	IN? GIRL,APE \?L13
	PRINTI "The girl dangles from the ape's grip."
?L13:	CRLF
	RTRUE
?L6:	CALL TALKING-TO?,APE >STACK
	ZERO? STACK /?L17
	EQUAL? HERE,MEN \?L18
	PRINTI "The ape seems wearied by the familiar attention you're paying him."
	CRLF
	JUMP ?L25
?L18:	ZERO? END-GAME \?L22
	CALL DPRINT,APE
	PRINTI " stares at you through his deep-set jaundiced eyes."
	CRLF
	JUMP ?L25
?L22:	PRINTI "You're not close enough for meaningful communication."
	CRLF
?L25:	CALL STOP >STACK
	RSTACK
?L17:	EQUAL? HERE,APE-ROOM /?L28
	CALL TOUCHING?,APE >STACK
	ZERO? STACK /?L28
	CALL CANT-REACH,APE >STACK
	RSTACK
?L28:	EQUAL? PRSA,V?RUB \?L29
	ZERO? PRSI \?L29
	PRINTI "The hair is coarse and bristly against the palm of "
	CALL DPRINT,HANDS
	PRINTI ". The gorilla is too puzzled by your intrusion, however, to enjoy such a creature comfort."
	CRLF
	CALL PRINT-ID,STR?117 >STACK
	RSTACK
?L29:	EQUAL? PRSA,V?PUT-ON \?L32
	EQUAL? PRSO,HEADPHONES \?L32
	CALL PERFORM,V?GIVE,HEADPHONES,APE
	RTRUE
?L32:	EQUAL? PRSA,V?SHOW,V?GIVE \?L33
	CALL IDROP >STACK
	ZERO? STACK \TRUE
	EQUAL? PRSO,WATER,MOUSE /FALSE
	CALL TRAP-SET? >STACK
	ZERO? STACK /?L37
	CALL QUEUE,I-CURSE,-1 >STACK
	PUT STACK,0,1
	PRINT INSTANT
	PRINTI "in many a beast's life between his recognition that someone has caused him great harm and his moment of striking back, during which time his imminent victim usually says ... well, go ahead ..."
	CRLF
	CALL PRINT-ID,STR?118 >STACK
	RSTACK
?L37:	EQUAL? PRSO,RADIO \?L40
	FSET? RADIO,ONBIT \?L40
	SET 'APE-C,4
	CALL DPRINT,APE
	PRINTR " looks expectantly at the device, but as it rests in his hairy clutches the static-emission from the radio quickly grates on his sensitive nerves. He shoves it back to you, then really begins to give you static."
?L40:	EQUAL? PRSO,HEADPHONES \?L43
	CALL RUNNING?,I-RUN >STACK
	ZERO? STACK /?L43
	EQUAL? KNOB-SET,V?PLAY \?L43
	GET TAPE-TABLE,ON-TAPE >STACK
	EQUAL? STACK,2 \?L44
	ADD SCORE,10 >SCORE
	MOVE HEADPHONES,APE
	FSET APE,RMUNGBIT
	CALL QUEUE,I-MOVE-DICK,1 >STACK
	PUT STACK,0,1
	PRINTI "From the looks of him -- an undeniable lowbrow. But now "
	CALL DPRINT,APE
	PRINTI ", true to his name, displays a quite highbrow taste in music. He ushers the headphones over to the "
	CALL DPRINT,CORNER
	PRINTI " of his "
	CALL DPRINT,CAGE
	PRINTR ", his savage breast to soothe."
?L44:	CALL RUNNING?,I-RUN >STACK
	ZERO? STACK /?L48
	CALL DPRINT,APE
	PRINTI " refuses to have anything to do with the headphones."
?L48:	CRLF
	RTRUE
?L43:	EQUAL? PRSO,BALLOON \?L52
	CALL BALLOON-FLIGHT
	CALL DPRINT,APE
	PRINTR " just scratches his head."
?L52:	MOVE PRSO,HERE
	CALL DPRINT,APE
	PRINTI " holds"
	CALL ARTICLE,PRSO,1
	PRINTI " limply in his massive hand for a moment then lets it drop"
	EQUAL? PRSO,MEAT \?L60
	PRINTI ". It doesn't look like part of his normal diet"
?L60:	PRINT PERIOD
	RTRUE
?L33:	CALL HURT?,APE >STACK
	ZERO? STACK /?L67
	PRINTI "In the face of your attack, "
	CALL DPRINT,APE
	PRINTI " simply scrunches his nose in curiosity. This has the effect of withering the fierce expression on your face and botching your follow-through. With the playfulness that is characteristic of the great apes, "
	CALL DPRINT,APE
	CALL PRINT-ID,STR?119
	CALL LUGGAGE
	RTRUE
?L67:	EQUAL? FOLLOW-FLAG,9 \FALSE
	EQUAL? PRSA,V?FOLLOW \FALSE
	CALL DO-WALK,P?NORTH
	RTRUE

	.FUNCT I-APE
	EQUAL? HERE,APE-ROOM /?L4
	FSET? APE,RMUNGBIT \?L3
?L4:	CALL RUNNING?,I-CURSE >STACK
	ZERO? STACK /?L1
?L3:	CALL INT,I-APE >STACK
	PUT STACK,0,0
	SET 'APE-C,0
	RFALSE
?L1:	FSET? APE,RMUNGBIT \?L5
	GET TAPE-TABLE,ON-TAPE >STACK
	EQUAL? STACK,2 \?L8
	CALL RUNNING?,I-RUN >STACK
	ZERO? STACK \FALSE
?L8:	FCLEAR APE,RMUNGBIT
	SET 'APE-C,0
	FSET HEADPHONES,INVISIBLE
	CALL INT,I-RUN >STACK
	PUT STACK,0,0
	EQUAL? HERE,APE-ROOM,MEN \FALSE
	CRLF
	CALL DPRINT,APE
	PRINTI " suddenly lets out a primal, deafening scream that rattles the bars of his cage. You can hear the "
	CALL DPRINT,HEADPHONES
	PRINTI " being reduced to dust in the ape's tense grip. "
	CALL PRINT-ID,STR?120
	EQUAL? HERE,APE-ROOM \?L13
	CALL PRINT-ID,STR?121
	CALL APE-DEATH >STACK
	RSTACK
?L13:	PRINTI "With that volcanic emotional response to the end of his listening pleasure, "
	CALL DPRINT,APE
	PRINTR " settles back down onto the straw."
?L5:	INC 'APE-C
	EQUAL? FOLLOW-FLAG,99 /?L21
	CRLF
?L21:	EQUAL? APE-C,1 \?L24
	MOVE APE,HERE
	CALL DPRINT,APE
	PRINTI " gets up from his doldrums and stares down at you"
	FSET? SUIT,WORNBIT \?L28
	PRINTI ". If apes could laugh, this one would -- at the sight of you standing there expectantly in your hairy suit. Instead the gorilla is bewildered, and starts"
	JUMP ?L32
?L28:	PRINTI ","
?L32:	PRINTR " tilting his head slowly to one side."
?L24:	EQUAL? APE-C,2,3,4 \?L37
	CALL PICK-ONE,APES >STACK
	PRINT STACK
	CRLF
	RTRUE
?L37:	EQUAL? APE-C,5 \?L40
	CALL DPRINT,APE
	PRINTR " bellows out a roar that backs you toward the cage door."
?L40:	EQUAL? APE-C,6 \?L43
	PRINTI "Agitated by your presence, "
	CALL DPRINT,APE
	PRINTR " appears on the verge of attack."
?L43:	EQUAL? APE-C,7 \?L46
	CALL PRINT-ID,STR?122
	CALL APE-DEATH
?L46:	CRLF
	RTRUE

	.FUNCT APE-DEATH
	CALL JIGS-UP,4,STR?123
	RTRUE

	.FUNCT LUGGAGE
	CALL JIGS-UP,1,STR?124
	RTRUE

	.FUNCT APE-ROOM-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "You stand on the straw-covered cage floor, surrounded on four sides by closely spaced iron bars. The "
	FSET? APE-DOOR,OPENBIT \?L5
	PRINTI "open"
	JUMP ?L9
?L5:	PRINTI "closed"
?L9:	PRINTI " "
	CALL DPRINT,APE-DOOR
	PRINTI " is east"
	FSET? TRAP-DOOR,INVISIBLE /?L14
	PRINTI " and a "
	CALL DPRINT,TRAP-DOOR
	PRINTI " here is "
	CALL OPEN-CLOSED,TRAP-DOOR
?L14:	PRINTI "."
	IN? APE,HERE \?L29
	EQUAL? P-WALK-DIR,P?IN,P?WEST /?L29
	CRLF
	CRLF
	CALL DPRINT,APE
	PRINTI " is "
	FSET? APE,RMUNGBIT \?L25
	PRINTI "slumped over in the "
	CALL DPRINT,CORNER
	PRINTI " of his cage listening to the "
	CALL DPRINT,HEADPHONES
	PRINTR "."
?L25:	PRINTI "staring at you with deep-set, jaundiced eyes."
?L29:	CRLF
	RTRUE
?L1:	EQUAL? RARG,M-ENTER \?L33
	ZERO? END-GAME \?L33
	MOVE APE,APE-ROOM
	CALL QUEUE,I-APE,-1 >STACK
	PUT STACK,0,1
	RTRUE
?L33:	EQUAL? RARG,M-END \FALSE
	GET TAPE-TABLE,ON-TAPE >STACK
	EQUAL? STACK,2 \FALSE
	CALL HELD?,HEADPHONES >STACK
	ZERO? STACK /FALSE
	CALL RUNNING?,I-RUN >STACK
	ZERO? STACK /FALSE
	EQUAL? KNOB-SET,V?PLAY \FALSE
	CRLF
	PRINTI "Mahler snatches away the "
	CALL DPRINT,HEADPHONES
	PRINTI "."
	CRLF
	CRLF
	CALL PERFORM,V?GIVE,HEADPHONES,APE
	RTRUE

	.FUNCT COMPARTMENT-F
	EQUAL? HERE,APE-ROOM \?L1
	FSET? TRAP-DOOR,OPENBIT /?L3
	CALL CANT-SEE,COMPARTMENT >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L5
	CALL PERFORM,PRSA,TRAP-DOOR
	RTRUE
?L5:	EQUAL? PRSA,V?SEARCH,V?LOOK-INSIDE \?L6
	PRINTI "There is"
	FSET? RIBBON,TOUCHBIT /?L9
	MOVE RIBBON,COMPARTMENT
?L9:	CALL PRINT-CONTENTS,COMPARTMENT
	PRINTI " in the "
	CALL DPRINT,COMPARTMENT
	PRINTI "."
	CRLF
	FSET? RIBBON,TOUCHBIT /TRUE
	MOVE RIBBON,HERE
	RTRUE
?L6:	EQUAL? PRSA,V?BOARD,V?ENTER,V?THROUGH \?L17
	PRINTR "It's too small for you."
?L17:	EQUAL? PRSA,V?PUT \FALSE
	CALL V-DIG >STACK
	RSTACK
?L1:	EQUAL? HERE,MEN \?L22
	EQUAL? PRSA,V?CLOSE,V?OPEN,V?LOOK-INSIDE /?L25
	EQUAL? PRSA,V?BOARD,V?THROUGH,V?PUT /?L25
	EQUAL? PRSA,V?ENTER \?L23
?L25:	PRINT YOU-SEE
	PRINTI " no openings to the "
	CALL DPRINT,COMPARTMENT
	PRINTR "."
?L23:	EQUAL? PRSA,V?KNOCK \FALSE
	FSET? TRAP-DOOR,RMUNGBIT /FALSE
	PRINTI "You detect a brief sound of movement in return, but can't tell if it's coming from "
	CALL DPRINT,APE
	PRINTI " or from inside the "
	CALL DPRINT,COMPARTMENT
	PRINTR "."
?L22:	EQUAL? HERE,APE-ROOM \FALSE
	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	CALL PERFORM,PRSA,TRAP-DOOR >STACK
	RSTACK

	.FUNCT TRAP-DOOR-F
	EQUAL? PRSA,V?OPEN,V?RAISE \?L1
	FSET? TRAP-DOOR,OPENBIT /?L1
	FSET? APE,RMUNGBIT /?L5
	IN? APE,HERE /?L3
?L5:	FSET TRAP-DOOR,OPENBIT
	FSET TRAP-DOOR,RMUNGBIT
	PRINTI "As the "
	CALL DPRINT,TRAP-DOOR
	PRINTI " hinges upward, you can see a "
	CALL DPRINT,COMPARTMENT
	PRINTI " that is empty"
	FSET? RIBBON,INVISIBLE \?L8
	FSET? RIBBON,TOUCHBIT /?L8
	FCLEAR RIBBON,INVISIBLE
	PRINTI " but for a small red ribbon"
?L8:	PRINT PERIOD
	RTRUE
?L3:	PRINTI "Bulky and difficult to grip, the "
	CALL DPRINT,TRAP-DOOR
	PRINTI " resists the labored attempt of "
	CALL DPRINT,HANDS
	PRINTI "s which are especially sweat-drenched with "
	CALL DPRINT,APE
	PRINTR " hovering over you."
?L1:	EQUAL? PRSA,V?LOWER,V?CLOSE \?L18
	FSET? TRAP-DOOR,OPENBIT \?L18
	FSET? RIBBON,TOUCHBIT /?L19
	FSET RIBBON,INVISIBLE
?L19:	FCLEAR TRAP-DOOR,OPENBIT
	PRINTI "It lowers over the "
	CALL DPRINT,COMPARTMENT
	PRINTR "."
?L18:	EQUAL? PRSA,V?LOOK-INSIDE \FALSE
	FSET? TRAP-DOOR,OPENBIT \FALSE
	CALL PERFORM,V?LOOK-INSIDE,COMPARTMENT
	RTRUE

	.FUNCT RIBBON-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "Though cut from ordinary cloth, the ribbon is a stunning bright red."
?L1:	EQUAL? PRSA,V?TIE \?L5
	EQUAL? PRSI,ME \?L5
	CALL PERFORM,V?WEAR,RIBBON
	RTRUE
?L5:	FSET? RIBBON,WORNBIT \FALSE
	EQUAL? PRSA,V?UNTIE \FALSE
	CALL PERFORM,V?REMOVE,RIBBON
	RTRUE

	.FUNCT CAGE-F
	EQUAL? PRSA,V?EXAMINE \?L5
	EQUAL? HERE,MEN,APE-ROOM \?L1
	ZERO? END-GAME /?L1
	PRINTR "Several of the vertical bars are bent to either side."
?L1:	EQUAL? PRSA,V?EXAMINE \?L5
	EQUAL? HERE,NOOK \?L5
	PRINTI "It's not as high as "
	CALL DPRINT,APE
	PRINTR "'s cage."
?L5:	EQUAL? PRSA,V?PUT-ON \?L8
	EQUAL? PRSI,CAGE \?L8
	EQUAL? HERE,ON-CAGE \?L9
	CALL PERFORM,V?DROP,PRSO
	RTRUE
?L9:	EQUAL? HERE,NOOK \FALSE
	MOVE PRSO,ON-CAGE
	PRINTR "Done."
?L8:	EQUAL? PRSA,V?LOOK-ON \?L15
	EQUAL? HERE,ON-CAGE \?L16
	CALL V-LOOK >STACK
	RSTACK
?L16:	EQUAL? HERE,NOOK \FALSE
	PRINTR "It's too high."
?L15:	EQUAL? PRSA,V?OPEN,V?LOCK,V?UNLOCK /?L23
	EQUAL? PRSA,V?CLOSE \?L22
?L23:	EQUAL? HERE,NOOK,ROUST-ROOM \?L24
	CALL PERFORM,PRSA,ROUST-DOOR,PRSI
	RTRUE
?L24:	CALL PERFORM,PRSA,APE-DOOR,PRSI
	RTRUE
?L22:	EQUAL? PRSA,V?LOOK-INSIDE \?L27
	EQUAL? HERE,ROUST-ROOM,APE-ROOM \?L28
	CALL V-LOOK
	RTRUE
?L28:	EQUAL? HERE,ON-CAGE \?L30
	CALL NO-POSITION >STACK
	RSTACK
?L30:	EQUAL? HERE,MEN \?L32
	PRINTI "Peering into the cage, you observe "
	FSET? APE,RMUNGBIT \?L36
	CALL DPRINT,APE
	PRINTI " hunched in the "
	CALL DPRINT,CORNER
	PRINTI " listening to the "
	CALL DPRINT,HEADPHONES
	JUMP ?L49
?L36:	IN? APE,HERE \?L40
	PRINTI "a gargantuan and thoroughly bored gorilla sitting on a helter-skelter bed of straw"
	JUMP ?L49
?L40:	PRINTI "nothing but straw"
	JUMP ?L49
?L32:	PRINTI "The confines of the cage are so darkly shaded that you cannot distinguish anything inside"
	FSET? KEY,TRYTAKEBIT \?L49
	PRINTI ", except for a hoop key ring hanging against the far "
	CALL DPRINT,WALLS
	PRINTI " which happens to be illuminated by a spot of soft light"
?L49:	PRINT PERIOD
	RTRUE
?L27:	EQUAL? PRSA,V?PUT \?L56
	EQUAL? PRSI,CAGE \?L56
	CALL IDROP >STACK
	ZERO? STACK \?L56
	EQUAL? HERE,ROUST-ROOM,APE-ROOM \?L57
	CALL PERFORM,V?DROP,PRSO
	RTRUE
?L57:	FSET? KEY,TRYTAKEBIT \?L59
	EQUAL? PRSO,POLE \?L59
	CALL PERFORM,V?TAKE-WITH,KEY,POLE
	RTRUE
?L59:	GETP PRSO,P?SIZE >STACK
	GRTR? STACK,25 \?L60
	EQUAL? PRSO,POLE /?L60
	CALL TELL-CLOSELY-SPACED >STACK
	RSTACK
?L60:	EQUAL? HERE,MEN \?L61
	IN? APE,MEN \?L61
	CALL DPRINT,APE
	PRINTI " completely ignores"
	CALL ARTICLE,PRSO,1
	PRINTR ", as he would anything from this distance, so you withdraw it."
?L61:	CALL V-DIG >STACK
	RSTACK
?L56:	EQUAL? PRSA,V?THROUGH,V?BOARD,V?ENTER \?L67
	EQUAL? HERE,APE-ROOM,ROUST-ROOM,ON-CAGE \?L68
	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L68:	EQUAL? HERE,MEN \?L72
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L72:	EQUAL? HERE,NOOK \FALSE
	CALL DO-WALK,P?NORTH >STACK
	RSTACK
?L67:	EQUAL? PRSA,V?DISEMBARK \?L75
	EQUAL? HERE,APE-ROOM,ROUST-ROOM \?L75
	CALL DO-WALK,P?OUT
	RTRUE
?L75:	EQUAL? PRSA,V?LOOK-UNDER \?L76
	EQUAL? HERE,MEN /?L79
	EQUAL? HERE,APE-ROOM \FALSE
	FSET? APE-DOOR,OPENBIT \?L77
?L79:	PRINTI "Below the surface of the cage floor there appears to be a rectangular "
	CALL DPRINT,COMPARTMENT
	PRINTR " of sorts."
?L77:	EQUAL? HERE,APE-ROOM \FALSE
	CALL PERFORM,V?EXAMINE,APE-DOOR
	RTRUE
?L76:	EQUAL? PRSA,V?REACH-IN \?L84
	EQUAL? HERE,APE-ROOM,ROUST-ROOM \?L85
	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L85:	EQUAL? HERE,NOOK \?L89
	FSET? HEADPHONES,TRYTAKEBIT \?L90
	CALL PERFORM,V?TAKE,HEADPHONES
	RTRUE
?L90:	FSET? KEY,TRYTAKEBIT \?L92
	CALL PERFORM,V?TAKE,KEY
	RTRUE
?L92:	CALL TELL-WITHIN-REACH >STACK
	RSTACK
?L89:	EQUAL? HERE,MEN \FALSE
	IN? APE,HERE \FALSE
	CALL PERFORM,V?RUB,APE
	RTRUE
?L84:	EQUAL? PRSA,V?CLIMB-FOO,V?CLIMB-UP,V?CLIMB-ON \?L96
	EQUAL? HERE,ON-CAGE,ROUST-ROOM \?L97
	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L97:	EQUAL? HERE,NOOK \?L101
	CALL DO-WALK,P?UP >STACK
	RSTACK
?L101:	PRINTR "Grabbing hold of the rusted iron bars, you hike one leg up into the air, and then, as would a prisoner, hang your head in despair."
?L96:	EQUAL? PRSA,V?CLIMB-DOWN \FALSE
	EQUAL? HERE,ON-CAGE \?L106
	CALL DO-WALK,P?DOWN >STACK
	RSTACK
?L106:	PRINT LOOK-AROUND
	CRLF
	RTRUE

	.FUNCT NO-POSITION
	PRINTR "You're in no position to do that."

	.FUNCT ON-CAGE-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You're standing in semidarkness on top of a cage next to the elephant tent which rises above. "
	PRINT YOU-SEE
	PRINTR ", faintly, a rope ladder hanging from the top edge of the tent."

	.FUNCT UP-DOWN-CAGE
	CALL CANT-CLIMB? >STACK
	ZERO? STACK /?L1
	PRINTI "Your arms are too full."
	CRLF
	RFALSE
?L1:	PRINTI "You "
	EQUAL? HERE,NOOK \?L8
	PRINTI "hoist "
	CALL DPRINT,ME
	PRINTI " up and onto the "
	CALL DPRINT,CAGE
	PRINTI "."
	CRLF
	CRLF
	RETURN ON-CAGE
?L8:	ZERO? DIED \?L13
	PRINTI "fall awkwardly"
	JUMP ?L17
?L13:	PRINTI "clamber"
?L17:	PRINTI " down from the "
	CALL DPRINT,CAGE
	PRINTI "."
	CRLF
	ZERO? DIED \?L22
	CALL QUEUE,I-DEMISE,2 >STACK
	PUT STACK,0,1
	SET 'DIED,1
	CALL TELL-DIED
	MOVE PROTAGONIST,NOOK
	SET 'HERE,NOOK
	RFALSE
?L22:	CRLF
	RETURN NOOK

	.FUNCT BULL-ROOM-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "The "
	CALL DPRINT,GROUND
	PRINTR " here is covered with matted-down sawdust that emits a strong earthy smell. By all evidence, this tent used to house an elephant."

	.FUNCT CLOSET-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You are standing amid a kaleidoscope of his-and-her garments, a view as if from inside a clothes drier in mid-cycle"
	FSET? DRESS,NDESCBIT /?L7
	FSET? SHAWL,NDESCBIT \?L21
?L7:	PRINTI ". Among the mentionables "
	FSET? DRESS,NDESCBIT \?L10
	FSET? SHAWL,NDESCBIT \?L10
	PRINTI "are a sequin-dress/safari-suit combination, and a knitted-shawl/leather-jacket combo"
	JUMP ?L21
?L10:	PRINTI "is"
	FSET? DRESS,NDESCBIT \?L17
	PRINTI " a "
	CALL DPRINT,DRESS
	JUMP ?L21
?L17:	PRINTI " a "
	CALL DPRINT,SHAWL
?L21:	PRINTI "."
	CRLF
	CRLF
	PRINTR "Stairs against the wall lead upward."

	.FUNCT DRESS-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "The sequins glimmer in the "
	FSET? HERE,INDOORSBIT /?L5
	PRINTI "moon"
?L5:	PRINTR "light. There's a small slit of a pocket on the hip of the dress."
?L1:	EQUAL? PRSA,V?SEARCH,V?LOOK-INSIDE,V?OPEN /?L13
	EQUAL? PRSA,V?REACH-IN \?L12
?L13:	IN? VEIL,LOCAL-GLOBALS \?L14
	MOVE VEIL,DRESS
?L14:	PRINT YOU-SEE
	CALL PRINT-CONTENTS,DRESS
	PRINTR " in the pocket."
?L12:	EQUAL? PRSA,V?CLOSE \?L21
	PRINTR "It's only a slit of a pocket."
?L21:	EQUAL? PRSA,V?WEAR \?L25
	FSET? SUIT,WORNBIT \?L24
	CALL WONT-FIT-OVER,SUIT >STACK
	RSTACK
?L24:	EQUAL? PRSA,V?WEAR \?L25
	FSET? SHAWL,WORNBIT \?L25
	CALL WONT-FIT-OVER,SHAWL >STACK
	RSTACK
?L25:	EQUAL? PRSA,V?REMOVE,V?TAKE-OFF,V?WEAR \FALSE
	FSET? DRESS,WORNBIT \FALSE
	FSET? SHAWL,WORNBIT \?L27
	CALL REMOVE-FIRST,SHAWL
	RTRUE
?L27:	PRINTI "You wriggle "
	EQUAL? PRSA,V?WEAR \?L32
	PRINTI "into"
	MOVE DRESS,PROTAGONIST
	FSET DRESS,WORNBIT
	JUMP ?L36
?L32:	PRINTI "out of"
	FCLEAR DRESS,WORNBIT
?L36:	PRINTI " the "
	CALL DPRINT,DRESS
	PRINTR "."

	.FUNCT VEIL-F
	EQUAL? PRSA,V?LOOK-INSIDE \?L1
	FSET? VEIL,WORNBIT \?L3
	CALL V-LOOK >STACK
	RSTACK
?L3:	CALL PERFORM,V?EXAMINE,VEIL
	RTRUE
?L1:	EQUAL? PRSA,V?WEAR \FALSE
	FSET? MASK,WORNBIT \FALSE
	CALL WONT-FIT-OVER,MASK
	RTRUE

	.FUNCT WONT-FIT-OVER,OBJ
	PRINTI "It won't fit over the "
	CALL DPRINT,OBJ
	PRINTR "."

	.FUNCT SHAWL-F
	EQUAL? PRSA,V?WEAR \FALSE
	FSET? SUIT,WORNBIT \FALSE
	CALL WONT-FIT-OVER,SUIT >STACK
	RSTACK

	.FUNCT ON-TENT-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "You are standing unsteadily on top of a gabled tent. "
	CALL RUNNING?,I-POKE >STACK
	ZERO? STACK \?L5
	PRINTI "On one edge of the tent a rope "
	CALL DPRINT,LADDER
	PRINTI " drops down."
?L5:	CRLF
	RTRUE
?L1:	EQUAL? RARG,M-BEG \?L10
	EQUAL? PRSA,V?WALK \?L11
	EQUAL? P-WALK-DIR,P?DOWN /?L11
	CALL PERFORM,V?WALK-AROUND
	RTRUE
?L11:	EQUAL? PRSA,V?WALK-AROUND \FALSE
	PRINTI "With lousy footing and a lousy sense of "
	CALL DPRINT,INTDIR
	PRINTI " up here, you take a few wobbly steps."
	CRLF
	SET 'NOT-MOVED-C,0
	RTRUE
?L10:	EQUAL? RARG,M-ENTER \FALSE
	CALL RUNNING?,I-CHASE >STACK
	ZERO? STACK /FALSE
	CALL INT,I-CHASE >STACK
	PUT STACK,0,0
	CALL QUEUE,I-POKE,-1 >STACK
	PUT STACK,0,1
	RTRUE

	.FUNCT POKE-EXIT
	CALL RUNNING?,I-POKE >STACK
	ZERO? STACK /?L1
	PRINTI "You can't seem to locate the rope ladder."
	CRLF
	RFALSE
?L1:	CALL DOWN-LADDER >STACK
	RSTACK

	.FUNCT I-POKE
	INC 'NOT-MOVED-C
	INC 'POKE-C
	CRLF
	EQUAL? POKE-C,2,4,7 /?L3
	EQUAL? POKE-C,9,12 \?L1
?L3:	FCLEAR BURN-HOLE,INVISIBLE
	PRINTI "Suddenly, and with a muffled ""pop,"" a sleek metal shaft is thrust upward through the canvas. "
	GRTR? NOT-MOVED-C,3 /?L8
	EQUAL? POKE-C,12 \?L6
?L8:	CALL PRINT-ID,STR?125
	CALL JIGS-UP,3,STR?126
	RTRUE
?L6:	EQUAL? POKE-C,4,9 \?L9
	MOVE PROD,HERE
	PRINTR "It lingers momentarily, its business end sending a wisp of smoke into the night air."
?L9:	CALL TELL-PROD-WITHDRAW
	CRLF
	RTRUE
?L1:	EQUAL? POKE-C,5,10 \?L13
	MOVE PROD,LOCAL-GLOBALS
	CALL TELL-PROD-WITHDRAW
	CRLF
	RTRUE
?L13:	EQUAL? POKE-C,1,3,6 /?L15
	EQUAL? POKE-C,8,11 \?L14
?L15:	PRINTI "You can hear, from inside the tent, what sounds like a ladder being moved across the "
	CALL DPRINT,GROUND
	PRINTR ", then the plod of footsteps coming nearer and louder."
?L14:	EQUAL? POKE-C,17 \?L18
	PRINTR "Still in your death-grip, the prod pivots dangerously close to your forearm, and you feel its electronic heat."
?L18:	EQUAL? POKE-C,18 \?L21
	PRINTI "The "
	CALL DPRINT,PROD
	PRINTR " slips a bit in your sweaty grip."
?L21:	EQUAL? POKE-C,19 \FALSE
	CALL PRINT-ID,STR?127
	CALL JIGS-UP,3,STR?128
	RTRUE

	.FUNCT TELL-PROD-WITHDRAW
	PRINTI "The prod, finding no contact, is withdrawn through its burn hole."
	RTRUE

	.FUNCT PROD-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "The metal shaft is rigged with a crude electronic stunner at its end."
?L1:	EQUAL? PRSA,V?TAKE \?L5
	SET 'POKE-C,15
	MOVE PROD,PROTAGONIST
	PRINTI "You grip the shaft tightly as its owner begins jostling it dangerously."
	RTRUE
?L5:	EQUAL? PRSA,V?THROW,V?MOVE,V?PUSH /?L9
	EQUAL? PRSA,V?SHAKE,V?RAISE \?L8
?L9:	ADD SCORE,10 >SCORE
	MOVE PROD,LOCAL-GLOBALS
	SET 'WON-ON-TENT,1
	CALL INT,I-POKE >STACK
	PUT STACK,0,0
	CALL QUEUE,I-MOVE-DICK,10 >STACK
	PUT STACK,0,1
	PRINTI "Sounds of awkward footwork and cursing come from inside the tent as your opponent struggles with you and finally gets the shaft. There is a shriek of bloodcurdling terror as he takes the "
	CALL DPRINT,PROD
	PRINTI ", which sears loudly through the "
	CALL DPRINT,CANVAS
	PRINTI ", down with him.

Moments later, you hear someone helping the victim, who is groaning in pain, out of the tent. The "
	CALL DPRINT,LADDER
	PRINTI " is also dragged out."
	CRLF
	CALL PRINT-ID,STR?129 >STACK
	RSTACK
?L8:	EQUAL? PRSA,V?PUT,V?GIVE,V?DROP /?L13
	EQUAL? PRSA,V?THROW-OFF,V?THROW,V?PUT-ON /?L13
	CALL TOUCHING?,PROD >STACK
	ZERO? STACK /FALSE
	CALL IS-NOUN?,W?STUNNER >STACK
	ZERO? STACK /FALSE
?L13:	SET 'POKE-C,18
	PRINTR "Blunder!"

	.FUNCT BURN-HOLE-F
	EQUAL? PRSA,V?LOOK-INSIDE \?L1
	PRINTI "You "
	CALL RUNNING?,I-POKE >STACK
	ZERO? STACK /?L5
	PRINTI "glimpse some movement below but are too disoriented to make it out"
	JUMP ?L9
?L5:	PRINTI "can't make anything out"
?L9:	PRINT PERIOD
	RTRUE
?L1:	EQUAL? PRSA,V?BOARD,V?THROUGH,V?ENTER \FALSE
	PRINTR "It's too small."

	.FUNCT I-MOVE-DICK
	CALL QUEUE,I-MOVE-DICK,-1 >STACK
	PUT STACK,0,1
	EQUAL? HERE,MIDWEST /FALSE
	FSET? CLOWN-ALLEY,TOUCHBIT \FALSE
	IN? DICK,MIDWEST /FALSE
	SET 'DICK-DRUNK,1
	MOVE DICK,MIDWEST
	FSET DICK,RMUNGBIT
	MOVE TRADE-CARD,GLOBAL-OBJECTS
	MOVE NOTE,GLOBAL-OBJECTS
	FCLEAR DICK,NDESCBIT
	CALL INT,I-MOVE-DICK >STACK
	PUT STACK,0,0
	RTRUE

	.FUNCT TENT-F
	EQUAL? PRSA,V?CLIMB-FOO,V?CLIMB-UP,V?CLIMB-ON \?L1
	EQUAL? HERE,ON-CAGE \FALSE
	CALL PERFORM,V?CLIMB-UP,LADDER
	RTRUE
?L1:	EQUAL? PRSA,V?WALK-TO,V?THROUGH,V?ENTER /?L7
	EQUAL? PRSA,V?BOARD \?L6
?L7:	EQUAL? HERE,MEN \?L8
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L8:	EQUAL? HERE,BACK-YARD \?L10
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L10:	EQUAL? HERE,WEST-CAMP \?L11
	CALL PERFORM,V?THROUGH,CANVAS
	RTRUE
?L11:	EQUAL? HERE,PROP-ROOM,BULL-ROOM \?L12
	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L12:	CALL V-WALK-AROUND >STACK
	RSTACK
?L6:	EQUAL? PRSA,V?CRAWL-UNDER \?L16
	EQUAL? HERE,PROP-ROOM \?L17
	FSET? CANVAS,RMUNGBIT \?L17
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L17:	EQUAL? HERE,WEST-CAMP \?L19
	CALL PERFORM,V?THROUGH,CANVAS
	RTRUE
?L19:	CALL TENT-BOUND >STACK
	RSTACK
?L16:	EQUAL? PRSA,V?LOOK-INSIDE \?L21
	EQUAL? HERE,BULL-ROOM,PROP-ROOM \?L22
	CALL V-LOOK >STACK
	RSTACK
?L22:	EQUAL? HERE,MEN \?L24
	IN? BULL,HERE \?L25
	CALL PERFORM,V?EXAMINE,BULL >STACK
	RSTACK
?L25:	CALL PERFORM,V?LOOK-INSIDE,ME >STACK
	RSTACK
?L24:	EQUAL? HERE,BACK-YARD \?L28
	PRINTR "You can't see anything past the shadowy entrance."
?L28:	EQUAL? HERE,WEST-CAMP \FALSE
	CALL PERFORM,V?EXAMINE,CANVAS
	RTRUE
?L21:	EQUAL? PRSA,V?LOOK-BEHIND \FALSE
	EQUAL? HERE,NOOK \FALSE
	CALL PERFORM,V?EXAMINE,FRONT
	RTRUE

	.FUNCT BULL-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "Behind two soulful eyes, gleaming white tusks, and lush palm-like ears stands the huge gray elephantine bulk that is Hannibal of the Jungle."
?L1:	CALL TALKING-TO?,BULL >STACK
	ZERO? STACK /?L5
	PRINTI "The "
	CALL DPRINT,BULL
	PRINTI " merely eyes you passively."
	CRLF
	CALL STOP >STACK
	RSTACK
?L5:	EQUAL? PRSA,V?UNLOCK \?L8
	CALL CANT-REACH,CHAIN >STACK
	RSTACK
?L8:	EQUAL? PRSA,V?PUT-UNDER,V?THROW \?L9
	EQUAL? PRSO,DEAD-MOUSE,MOUSE \?L9
	CALL PERFORM,V?GIVE,PRSO,BULL
	RTRUE
?L9:	EQUAL? PRSA,V?CRAWL-UNDER \?L10
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L10:	EQUAL? PRSA,V?PUT \?L13
	EQUAL? PRSI,BULL /?L12
?L13:	EQUAL? PRSA,V?SHOW,V?GIVE \?L11
	EQUAL? PRSI,BULL \?L11
?L12:	CALL IDROP >STACK
	ZERO? STACK \TRUE
	EQUAL? PRSO,BALLOON \?L16
	CALL BALLOON-FLIGHT
	CRLF
	RTRUE
?L16:	EQUAL? PRSO,DEAD-MOUSE \?L17
	FSET? DEAD-MOUSE,RMUNGBIT /?L17
	FSET DEAD-MOUSE,RMUNGBIT
	PRINTI "The old bromide about "
	CALL DPRINT,BULL
	PRINTI "s being afraid of mice is in fact, you suddenly recall, based on the big pachyderms' fear of losing their balance by stepping on little squishy things like people or scampering rodents. (Hence Gloria Golotov's fearlessness tonight while lying under Hannibal's mighty hoof.)

Glumly, you poke the "
	CALL DPRINT,DEAD-MOUSE
	PRINTR "'s cold, soft belly and realize it lacks the pizzazz to get Hannibal to dancing."
?L17:	EQUAL? PRSO,MOUSE \?L20
	IN? MOUSE,PROTAGONIST /?L21
	PRINT NOT-HOLDING
	PRINTI " the "
	CALL DPRINT,MOUSE
	PRINTR "."
?L21:	FSET? BULL,RMUNGBIT \?L25
	MOVE MOUSE,LOCAL-GLOBALS
	CALL QUEUE,I-BULL,2 >STACK
	PUT STACK,0,1
	PRINTI "A humid stream of air from the "
	CALL DPRINT,BULL
	PRINTI "'s trunk blasts your face. The "
	CALL DPRINT,MOUSE
	PRINTI " wriggles from your grip and scurries across the "
	CALL DPRINT,SAWDUST
	PRINTR " under Hannibal."
?L25:	FSET BULL,RMUNGBIT
	PRINTI "The mouse itself is in a fright. It squirms across the back of "
	CALL DPRINT,HANDS
	PRINTI ", and then dangles once again from your grip.

Wide-eyed, the bull "
	CALL DPRINT,BULL
	PRINTI " takes one giant lumbering step backward. Its "
	CALL DPRINT,CHAIN
	PRINTR "s jingle as the bull begins rocking with slow-motion nervousness from side to side."
?L20:	EQUAL? PRSO,WATER /?L32
	EQUAL? PRSO,BUCKET \?L31
	IN? WATER,BUCKET \?L31
?L32:	FSET? BULL,RMUNGBIT \?L33
	CALL PERFORM,V?HELLO,BULL
	RTRUE
?L33:	MOVE WATER,LOCAL-GLOBALS
	CALL QUEUE,I-BULL,2 >STACK
	PUT STACK,0,1
	PRINTI "Hannibal eagerly snakes his thick trunk over to the "
	CALL DPRINT,BUCKET
	PRINTI " and with a quick snort siphons out all of the "
	CALL DPRINT,WATER
	PRINTR "."
?L31:	PRINTI "With its lazy trunk, the bull grasps the "
	CALL DPRINT,PRSO
	CALL TRAP-SET? >STACK
	ZERO? STACK /?L41
	FSET TRAP,RMUNGBIT
	PRINTI " which snaps down hard, barely tickling the thick skin of the pachyderm, who"
	CALL PRINT-ID,STR?130
	JUMP ?L45
?L41:	PRINTI " and"
?L45:	PRINTI " flings it "
	RANDOM 100 >STACK
	LESS? 50,STACK \?L52
	EQUAL? PRSO,TRAP \?L50
?L52:	MOVE PRSO,HERE
	PRINTI "in your "
	CALL DPRINT,INTDIR
	JUMP ?L55
?L50:	MOVE PRSO,BULL-ROOM
	PRINTI "behind itself"
?L55:	PRINT PERIOD
	RTRUE
?L11:	EQUAL? PRSA,V?RUB \?L60
	PRINTI "You can feel the warm, slobbery end of the "
	CALL DPRINT,BULL
	PRINTR "'s trunk against your cheek."
?L60:	EQUAL? PRSA,V?LOOK-BEHIND \?L63
	CALL DO-WALK,P?EAST
	RTRUE
?L63:	EQUAL? PRSA,V?FOLLOW \FALSE
	EQUAL? FOLLOW-FLAG,12 \FALSE
	CALL DO-WALK,P?SW
	RTRUE

	.FUNCT I-BULL
	FSET? BULL,RMUNGBIT \?L1
	ADD SCORE,10 >SCORE
	MOVE BULL,LOCAL-GLOBALS
	EQUAL? HERE,MEN,APE-ROOM \TRUE
	FCLEAR MEN,TOUCHBIT
	FCLEAR NEAR-WAGON,TOUCHBIT
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	SET 'FOLLOW-FLAG,12
	CRLF
	PRINTI "Loudly trumpeting its frustration, Hannibal of the Jungle thunders out of the tent, shearing its "
	CALL DPRINT,CHAIN
	PRINTI " with a dull thud. The raging bull stampedes "
	CALL PRINT-ID,STR?131
	EQUAL? HERE,APE-ROOM \?L7
	PRINTI "past you and "
?L7:	PRINTR "through a fence to the southwest."
?L1:	EQUAL? HERE,MEN \FALSE
	RANDOM 100 >STACK
	LESS? 50,STACK /?L16
	CRLF
	PRINTI "Spouting point-blank from the "
	CALL DPRINT,BULL
	PRINTI "'s trunk, a blast of warm "
	CALL DPRINT,WATER
	PRINTR " sprays you in the face."
?L16:	CRLF
	PRINTI "The "
	CALL DPRINT,BULL
	PRINTI " lazily draws its trunk upward, ejecting the "
	CALL DPRINT,WATER
	PRINTR " across its broad back."

	.FUNCT QUEUE-THUMB?
	ZERO? THUMB-TAPPED /FALSE
	ZERO? HYP-BOX /FALSE
	IN? BULL,MEN /FALSE
	RTRUE

	.FUNCT I-THUMB
	CALL QUEUE,I-THUMB,-1 >STACK
	PUT STACK,0,1
	FSET? THUMB,RMUNGBIT \?L4
	IN? THUMB,HERE \?L3
?L4:	ZERO? HELPED-THUMB \?L1
?L3:	ZERO? WARPED-DOOR-BROKEN \?L5
	MOVE THUMB,CLOWN-ALLEY
?L5:	CALL INT,I-THUMB >STACK
	PUT STACK,0,0
	RFALSE
?L1:	FCLEAR THUMB,NDESCBIT
	FCLEAR BLUE-DOOR,RMUNGBIT
	FSET DEALER,RMUNGBIT
	FSET? THUMB,RMUNGBIT /?L9
	MOVE THUMB,HERE
	FSET THUMB,RMUNGBIT
	CRLF
	PRINTI "For an instant you can hear the treading of light feet on the ground. The figure of "
	CALL DPRINT,THUMB
	PRINTR " appears out of the darkness, flailing his small arms and babbling up at you in his native tongue. He then pauses a moment to think."
?L9:	CALL INT,I-THUMB >STACK
	PUT STACK,0,0
	CRLF
	PRINTI "Suddenly animated again by an idea, the little comrade taps on your foot and points stridently in the direction of the Blue Room. He then looks around with an air of suspicion, backing cautiously away into the night."
	CRLF
	CALL ROB,UPPER,MASK
	CALL ROB,LOWER,MASK
	MOVE THUMB,CLOWN-ALLEY
	SET 'FOLLOW-FLAG,1
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	RTRUE

	.FUNCT CHAIN-F
	CALL IS-NOUN?,W?MENAGERIE >STACK
	ZERO? STACK /?L1
	SET 'PRSO,MENAGERIE
	CALL GLOBAL-ROOM-F >STACK
	RSTACK
?L1:	CALL TOUCHING?,CHAIN >STACK
	ZERO? STACK /?L3
	IN? BULL,HERE \?L3
	CALL CANT-REACH,CHAIN >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?TIE,V?TAKE \FALSE
	PRINTI "You barely manage to budge the "
	CALL DPRINT,CHAIN
	PRINTR "."

	.FUNCT NOOK-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "You are standing outside of the elephant "
	CALL DPRINT,TENT
	PRINTI ". Along its side wall to the north sits a "
	CALL DPRINT,CAGE
	PRINTI " with "
	CALL DPRINT,STRAW
	PRINTR " poking out of it. The menagerie is northwest of here.

Facing you on the east side there is a big old plywood sideshow front, faded beyond recognition. It serves as the barrier wall of an enclosed structure behind the elephant tent."
?L1:	EQUAL? RARG,M-BEG \FALSE
	CALL ENABLED?,I-DEMISE >STACK
	ZERO? STACK /FALSE
	EQUAL? PRSA,V?RESTART,V?QUIT,V?RESTORE \FALSE
	PRINTR "Not so fast."

	.FUNCT NOOK-EXIT
	FSET? BLUE-DOOR,OPENBIT \?L1
	RETURN BLUE-ROOM
?L1:	FSET? ROUST-DOOR,OPENBIT \?L3
	RETURN ROUST-ROOM
?L3:	CALL V-WALK-AROUND
	RFALSE

	.FUNCT BLUE-DOOR-ENTER
	FSET? BLUE-DOOR,INVISIBLE \?L1
	PRINT CANT-GO
	CRLF
	RFALSE
?L1:	FSET? BLUE-DOOR,OPENBIT /?L5
	PRINTI "The "
	CALL DPRINT,BLUE-DOOR
	PRINTI " is closed."
	CRLF
	RFALSE
?L5:	RETURN BLUE-ROOM

	.FUNCT PATH-F
	EQUAL? MEET-COUNTER,10 \?L3
	ZERO? DREAMING /?L1
?L3:	CALL CANT-SEE,PATH >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?WALK-TO,V?TAKE,V?FOLLOW /?L5
	EQUAL? PRSA,V?THROUGH,V?BOARD \FALSE
?L5:	EQUAL? HERE,MEN \?L6
	CALL DO-WALK,P?SE >STACK
	RSTACK
?L6:	EQUAL? HERE,NOOK \?L8
	CALL DO-WALK,P?NW >STACK
	RSTACK
?L8:	EQUAL? HERE,WINGS \?L9
	CALL DO-WALK,P?NE >STACK
	RSTACK
?L9:	EQUAL? HERE,UNDER-STANDS \FALSE
	CALL DO-WALK,P?SW >STACK
	RSTACK

	.FUNCT STRAW-F
	EQUAL? PRSA,V?SEARCH,V?RAISE,V?MOVE /?L3
	EQUAL? PRSA,V?DIG,V?LOOK-INSIDE /?L3
	EQUAL? HERE,APE-ROOM \?L1
	EQUAL? PRSA,V?TAKE \FALSE
?L3:	CALL PERFORM,V?LOOK-UNDER,STRAW
	RTRUE
?L1:	EQUAL? PRSA,V?TAKE \FALSE
	SET 'AWAITING-REPLY,5
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTR "So you're taking up basket-weaving now?"

	.FUNCT GLOBAL-SAWDUST-F
	CALL DONT-HANDLE?,SAWDUST >STACK
	ZERO? STACK \FALSE
	EQUAL? HERE,RING /FALSE
	CALL CANT-SEE,0,STR?132 >STACK
	RSTACK

	.FUNCT ROUST-ROOM-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "This barred rectangular hovel is blanketed with straw and has the look, if not the smell, of a human dwelling. Its southside door "
	FSET? ROUST-DOOR,OPENBIT \?L5
	PRINTI "stands open"
	JUMP ?L9
?L5:	PRINTI "is closed"
?L9:	PRINT PERIOD
	RTRUE

	.FUNCT KEY-F
	CALL IS-NOUN?,W?KEYS >STACK
	ZERO? STACK /?L1
	FSET? KEY,TRYTAKEBIT /?L1
	PRINTI "(It's just one key.)"
	CRLF
	CRLF
?L1:	CALL REAL-KEY-F >STACK
	RSTACK

	.FUNCT REAL-KEY-F
	CALL TAKE-WITH-POLE? >STACK
	ZERO? STACK \TRUE
	CALL TOUCHING?,PRSO >STACK
	ZERO? STACK /?L3
	EQUAL? PRSA,V?PUT /?L3
	FSET? KEY,TRYTAKEBIT \?L3
	EQUAL? PRSI,POLE /FALSE
	CALL CANT-REACH,KEY >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?EXAMINE \?L7
	PRINTI "The "
	CALL DPRINT,KEY
	PRINTR " is attached to a hoop ring."
?L7:	EQUAL? PRSA,V?PUT \?L10
	CALL IDROP >STACK
	ZERO? STACK \?L10
	EQUAL? PRSO,POLE \FALSE
	FSET? KEY,TRYTAKEBIT \FALSE
	CALL PERFORM,V?TAKE-WITH,KEY,POLE
	RTRUE
?L10:	EQUAL? PRSA,V?OPEN,V?REMOVE \?L16
	EQUAL? PRSO,KEY /?L15
?L16:	EQUAL? PRSA,V?TAKE \FALSE
	EQUAL? PRSI,KEY \FALSE
	EQUAL? PRSO,KEY \FALSE
?L15:	PRINTR "The key ring is welded shut."

	.FUNCT TAKE-WITH-POLE?
	FSET? PRSO,TRYTAKEBIT \FALSE
	EQUAL? PRSA,V?KILL,V?MOVE,V?TAKE-WITH \FALSE
	EQUAL? PRSI,POLE \FALSE
	MOVE PRSO,PROTAGONIST
	FCLEAR PRSO,TRYTAKEBIT
	FCLEAR PRSO,NDESCBIT
	EQUAL? PRSO,KEY \?L3
	FSET? KEY,TOUCHBIT /?L3
	ADD SCORE,10 >SCORE
?L3:	FSET PRSO,TOUCHBIT
	PRINTI "Using the "
	CALL DPRINT,POLE
	PRINTI ", you fish the hoop ring off the "
	CALL DPRINT,WALLS
	PRINTI ". It slides down the raised pole and jingles into "
	CALL DPRINT,HANDS
	PRINTR "."

	.FUNCT JIM-F
	EQUAL? JIM,WINNER \?L1
	FSET? JIM,RMUNGBIT \?L3
	EQUAL? PRSA,V?HELLO /?L3
	PRINTI "The "
	CALL DPRINT,JIM
	EQUAL? PRSA,V?WHERE,V?TAKE,V?FIND \?L10
	EQUAL? PRSO,GLOBAL-NET,NET /?L9
?L10:	EQUAL? PRSA,V?PUT-UNDER \?L7
	EQUAL? PRSO,GLOBAL-NET,NET \?L7
	EQUAL? PRSI,TIGHTROPE-OBJECT \?L7
?L9:	SET 'FOLLOW-FLAG,5
	ADD SCORE,10 >SCORE
	SET 'P-IT-OBJECT,JIM-GLOBAL
	CALL QUEUE,I-FOLLOW,3 >STACK
	PUT STACK,0,1
	MOVE JIM,LOCAL-GLOBALS
	CALL QUEUE,I-END-GAME,3 >STACK
	PUT STACK,0,1
	PRINTI " goes tearing out through the wings."
	JUMP ?L13
?L7:	PRINTI ", though he possesses a vocabulary of over 800 words and can comprehend something a bit more complex than a simple two-word command, seems unable to act upon your words, perhaps because this is not one of his usual duties."
?L13:	CRLF
	CALL STOP >STACK
	RSTACK
?L3:	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,JIM,MUNRAB
	SET 'WINNER,JIM
	RTRUE
?L1:	EQUAL? PRSA,V?ASK-ABOUT \?L17
	EQUAL? PRSO,JIM \?L17
	PRINTI "The "
	CALL DPRINT,JIM
	PRINTR ", alas, doesn't relate well to strangers. He ignores you."
?L17:	EQUAL? PRSA,V?EXAMINE \?L20
	FSET? JIM,RMUNGBIT \?L21
	PRINTI "He's standing at attention"
	JUMP ?L25
?L21:	PRINTI "He looks flea-bitten, slack-jawed and hangdog"
?L25:	PRINT PERIOD
	RTRUE
?L20:	EQUAL? PRSA,V?FOLLOW \FALSE
	EQUAL? FOLLOW-FLAG,14,5 \FALSE
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK

	.FUNCT JIM-DESCFCN,X
	PRINTI "A "
	CALL DPRINT,JIM
	PRINTI " stands nearby."
	RTRUE

	.FUNCT JIM-GLOBAL-F
	EQUAL? PRSA,V?FOLLOW \?L1
	EQUAL? FOLLOW-FLAG,14,5 \?L1
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L1:	CALL DONT-HANDLE?,JIM-GLOBAL >STACK
	ZERO? STACK \FALSE
	IN? HEADPHONES,HERE \?L4
	CALL TALKING-TO?,JIM-GLOBAL >STACK
	ZERO? STACK /?L4
	EQUAL? PRSA,V?ALARM,V?WAVE-AT /?L4
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?TALK-INTO,HEADPHONES
	RTRUE
?L4:	CALL CANT-SEE,JIM-GLOBAL
	CALL STOP >STACK
	RSTACK

	.FUNCT DUFFY-F
	EQUAL? PRSI,DUFFY \?L1
	EQUAL? PRSA,V?ASK-FOR,V?TELL-ABOUT,V?ASK-ABOUT /FALSE
?L1:	PRINTR "This isn't his usual beat."

	.FUNCT HEADPHONES-F,NUM
	IN? HEADPHONES,APE \?L1
	EQUAL? PRSA,V?TAKE /?L1
	EQUAL? PRSA,V?PLAY,V?REWIND,V?EXAMINE /?L3
	EQUAL? PRSA,V?RECORD,V?LAMP-OFF,V?ADVANCE /?L3
	EQUAL? PRSA,V?LAMP-ON /?L3
	CALL TOUCHING?,HEADPHONES >STACK
	ZERO? STACK /?L1
?L3:	CALL DPRINT,APE
	PRINTI " has the "
	CALL DPRINT,HEADPHONES
	PRINTR "."
?L1:	EQUAL? PRSA,V?PLAY,V?EJECT,V?LAMP-OFF /?L9
	EQUAL? PRSA,V?ADVANCE,V?REWIND \?L7
?L9:	EQUAL? KNOB-SET,V?RECORD \?L7
	CALL RECORD-TAPE,1
?L7:	EQUAL? PRSA,V?READ,V?EXAMINE \?L11
	MUL ON-TAPE,62 >NUM
	PRINTI "It's a nice "
	CALL DPRINT,HEADPHONES
	PRINTI " with a built-in cassette player which contains a tape, which is now "
	EQUAL? KNOB-SET,V?PLAY \?L15
	PRINTI "playing"
	JUMP ?L28
?L15:	EQUAL? KNOB-SET,V?ADVANCE \?L19
	PRINTI "advancing"
	JUMP ?L28
?L19:	EQUAL? KNOB-SET,V?REWIND \?L22
	PRINTI "rewinding"
	JUMP ?L28
?L22:	EQUAL? KNOB-SET,V?RECORD \?L25
	PRINTI "recording"
	JUMP ?L28
?L25:	PRINTI "not spinning"
?L28:	PRINTI ". The controls allow you to either play, record, advance, rewind or eject the tape. A counter on the player reads ["
	PRINTN NUM
	PRINTR "]."
?L11:	EQUAL? PRSA,KNOB-SET \?L33
	EQUAL? PRSA,V?PLAY,V?LAMP-ON \?L34
	PRINTR "It's already playing."
?L34:	PRINTR "That's what the tape is already doing."
?L33:	EQUAL? PRSA,V?RECORD,V?ADVANCE,V?PLAY \?L43
	EQUAL? ON-TAPE,15 /?L42
?L43:	EQUAL? PRSA,V?REWIND \?L41
	ZERO? ON-TAPE \?L41
?L42:	PRINTI "You're at the very "
	EQUAL? ON-TAPE,15 \?L46
	PRINTI "end"
	JUMP ?L50
?L46:	PRINTI "beginning"
?L50:	PRINTR " of the tape."
?L41:	EQUAL? PRSA,V?RECORD,V?ADVANCE,V?PLAY /?L56
	EQUAL? PRSA,V?REWIND \?L55
?L56:	CALL QUEUE,I-RUN,-1 >STACK
	PUT STACK,0,1
	SET 'KNOB-SET,PRSA
	EQUAL? PRSA,V?RECORD \?L57
	PRINTR "The small mike crackles open."
?L57:	CALL TAPE-PRINT,1
	RTRUE
?L55:	EQUAL? PRSA,V?LAMP-ON \?L62
	CALL PERFORM,V?PLAY,HEADPHONES
	RTRUE
?L62:	EQUAL? PRSA,V?EJECT,V?LAMP-OFF \?L63
	SET 'KNOB-SET,0
	PRINTI "The tape "
	CALL RUNNING?,I-RUN >STACK
	ZERO? STACK /?L66
	PRINTI "stops spinning"
	JUMP ?L70
?L66:	EQUAL? PRSA,V?LAMP-OFF \?L70
	PRINTR "isn't even running."
?L70:	EQUAL? PRSA,V?EJECT \?L79
	CALL RUNNING?,I-RUN >STACK
	ZERO? STACK /?L74
	PRINTI " but "
?L74:	EQUAL? PRSA,V?EJECT \?L79
	PRINTI "simply will not eject"
?L79:	CALL INT,I-RUN >STACK
	PUT STACK,0,0
	PRINT PERIOD
	RTRUE
?L63:	EQUAL? PRSA,V?OPEN \?L86
	PRINTR "The headphones won't open up."
?L86:	EQUAL? PRSA,V?WEAR \?L89
	PRINTR "The headphones, seemingly tailored for a pinhead, fit you like a vise. And since they can be listened to without being worn, you remove them."
?L89:	EQUAL? PRSA,V?TAKE \?L92
	IN? HEADPHONES,APE \?L92
	FSET? APE,RMUNGBIT \?L92
	CALL DPRINT,APE
	PRINTI " has a fit as you snatch away the source of his listening pleasure. "
	CALL PRINT-ID,STR?133
	CALL APE-DEATH >STACK
	RSTACK
?L92:	EQUAL? PRSA,V?LISTEN \?L95
	IN? HEADPHONES,APE \?L96
	PRINTI "It's "
	PRINT CLASSICAL
	RTRUE
?L96:	EQUAL? KNOB-SET,V?PLAY \?L100
	GET TAPE-TABLE,ON-TAPE >STACK
	EQUAL? STACK,2,0 \?L100
	CALL PERFORM,V?LISTEN,MUSIC
	RTRUE
?L100:	EQUAL? KNOB-SET,V?PLAY,V?REWIND,V?ADVANCE \FALSE
	SET 'FOLLOW-FLAG,99
	CALL QUEUE,I-FOLLOW,1 >STACK
	PUT STACK,0,1
	RTRUE
?L95:	EQUAL? PRSA,V?TALK-INTO,V?TELL \FALSE
	PRINTI "It would only fall on deaf ears."
	CRLF
	SET 'CLOCK-WAIT,1
	RTRUE

	.FUNCT RECORD-TAPE,NOT-ADVANCE?=0,?TMP
	EQUAL? PRSA,V?TALK-INTO \?L1
	EQUAL? PRSO,HEADPHONES \?L1
	PUT TAPE-TABLE,ON-TAPE,3
	JUMP ?L5
?L1:	CALL CLASSICAL-PLAYING? >STACK
	ZERO? STACK /?L3
	PUT TAPE-TABLE,ON-TAPE,2
	JUMP ?L5
?L3:	CALL META-LOC,RADIO >STACK
	GETP STACK,P?GROUND-LOC >STACK
	ZERO? STACK /?L4
	CALL META-LOC,RADIO >?TMP
	CALL META-LOC,HEADPHONES >STACK
	EQUAL? ?TMP,STACK \?L4
	FSET? RADIO,ONBIT \?L4
	PUT TAPE-TABLE,ON-TAPE,4
	JUMP ?L5
?L4:	PUT TAPE-TABLE,ON-TAPE,1
?L5:	ZERO? NOT-ADVANCE? \TRUE
	INC 'ON-TAPE
	RTRUE

	.FUNCT TAPE-PRINT,TURN?=0,FF?=0,CR?=1
	EQUAL? FOLLOW-FLAG,99 \?L1
	SET 'CR?,0
?L1:	CALL VISIBLE?,HEADPHONES >STACK
	ZERO? STACK /FALSE
	EQUAL? KNOB-SET,V?ADVANCE,V?REWIND \?L6
	EQUAL? KNOB-SET,V?ADVANCE \?L7
	SET 'FF?,1
?L7:	ZERO? TURN? /?L10
	CALL TELL-TURN-KNOB
	PRINTI "the cassette tape begins to "
	ZERO? FF? /?L14
	PRINTI "advance"
	JUMP ?L18
?L14:	PRINTI "rewind"
?L18:	PRINTI " rapidly"
	JUMP ?L33
?L10:	ZERO? CR? /?L24
	CRLF
?L24:	PRINTI "The tape continues whirring "
	ZERO? FF? /?L29
	PRINTI "forward"
	JUMP ?L33
?L29:	PRINTI "backward"
?L33:	PRINT PERIOD
	JUMP ?L38
?L6:	EQUAL? KNOB-SET,V?PLAY \?L38
	ZERO? TURN? /?L39
	CALL TELL-TURN-KNOB
	PRINTI "you hear from the headphones "
	JUMP ?L43
?L39:	ZERO? CR? /?L44
	CRLF
?L44:	PRINTI "The tape continues to play, emitting "
?L43:	GET TAPE-TABLE,ON-TAPE >STACK
	ZERO? STACK \?L49
	PRINTI "the blare of a Jimi Hendrix guitar solo"
	EQUAL? ON-TAPE,3,4 \?L73
	PRINTI ". You can also hear, in the background, the subliminal low tones of a "
	FSET? HYP,RMUNGBIT \?L57
	PRINTI "voice you recognize as Rimshaw's."
	JUMP ?L61
?L57:	PRINTI "hypnotic voice."
?L61:	PRINTR " He repeats these words over and over again: ""At the clap of my hands you shall obey my every command."""
?L49:	GET TAPE-TABLE,ON-TAPE >STACK
	EQUAL? STACK,2 \?L67
	PRINTI "the sounds of classical music"
	JUMP ?L73
?L67:	GET TAPE-TABLE,ON-TAPE >STACK
	EQUAL? STACK,4 \?L70
	PRINTI "the noise of AM radio"
	JUMP ?L73
?L70:	PRINTI "background hiss"
?L73:	PRINT PERIOD
?L38:	ZERO? TURN? /TRUE
	LESS? ON-TAPE,16 \TRUE
	CALL TELL-COUNTER,1
	RTRUE

	.FUNCT TELL-TURN-KNOB
	PRINTI "You adjust the controls and "
	RTRUE

	.FUNCT I-RUN,NUM
	EQUAL? KNOB-SET,V?PLAY \?L1
	INC 'ON-TAPE
	JUMP ?L4
?L1:	EQUAL? KNOB-SET,V?ADVANCE \?L3
	ADD ON-TAPE,5 >ON-TAPE
	JUMP ?L4
?L3:	EQUAL? KNOB-SET,V?REWIND \?L4
	SUB ON-TAPE,5 >ON-TAPE
?L4:	IN? HEADPHONES,APE /FALSE
	EQUAL? KNOB-SET,V?RECORD \?L9
	CALL RECORD-TAPE
	JUMP ?L11
?L9:	EQUAL? ON-TAPE,16 /?L11
	CALL META-LOC,HEADPHONES >STACK
	EQUAL? STACK,HERE \?L11
	EQUAL? KNOB-SET,V?PLAY,V?ADVANCE,V?REWIND \?L11
	CALL ENABLED?,I-DEMISE >STACK
	ZERO? STACK \?L11
	EQUAL? PRSA,V?LAMP-ON,V?PLAY /?L13
	EQUAL? PRSA,V?ADVANCE,V?REWIND \?L12
?L13:	EQUAL? PRSO,HEADPHONES /?L11
?L12:	CALL TAPE-PRINT
?L11:	GRTR? ON-TAPE,15 /?L17
	LESS? ON-TAPE,1 \?L15
?L17:	EQUAL? KNOB-SET,V?RECORD \?L18
	EQUAL? ON-TAPE,15 \?L18
	CALL RECORD-TAPE,1
?L18:	CALL STOP-TAPE
?L15:	EQUAL? PRSA,V?EXAMINE \?L22
	EQUAL? PRSO,HEADPHONES /TRUE
?L22:	EQUAL? PRSA,V?PLAY,V?REWIND,V?ADVANCE /TRUE
	EQUAL? PRSA,V?LAMP-ON /TRUE
	CALL VISIBLE?,HEADPHONES >STACK
	ZERO? STACK /TRUE
	CALL TELL-COUNTER
	RTRUE

	.FUNCT TELL-COUNTER,TURN-KNOB?=0,TAPE-LOC
	SET 'TAPE-LOC,ON-TAPE
	ZERO? TURN-KNOB? /?L6
	EQUAL? KNOB-SET,V?REWIND \?L3
	SUB ON-TAPE,5 >TAPE-LOC
	JUMP ?L6
?L3:	EQUAL? KNOB-SET,V?PLAY \?L5
	ADD ON-TAPE,1 >TAPE-LOC
	JUMP ?L6
?L5:	EQUAL? KNOB-SET,V?ADVANCE \?L6
	ADD ON-TAPE,5 >TAPE-LOC
?L6:	MUL TAPE-LOC,62 >TAPE-LOC
	GRTR? TAPE-LOC,0 \TRUE
	LESS? TAPE-LOC,931 \TRUE
	PRINTI "The counter reads ["
	PRINTN TAPE-LOC
	PRINTR "]."

	.FUNCT STOP-TAPE
	SET 'KNOB-SET,0
	CALL INT,I-RUN >STACK
	PUT STACK,0,0
	CALL VISIBLE?,HEADPHONES >STACK
	ZERO? STACK /?L1
	PRINTI "The tape suddenly halts."
	CRLF
?L1:	GRTR? ON-TAPE,15 \?L6
	SET 'ON-TAPE,15
	RTRUE
?L6:	SET 'ON-TAPE,0
	RTRUE

	.FUNCT MUSIC-F
	CALL CLASSICAL-PLAYING? >STACK
	ZERO? STACK /?L4
	CALL VISIBLE?,RADIO >STACK
	ZERO? STACK \?L3
?L4:	CALL RUNNING?,I-RUN >STACK
	ZERO? STACK /?L1
	EQUAL? KNOB-SET,V?PLAY \?L1
	GET TAPE-TABLE,ON-TAPE >STACK
	EQUAL? STACK,2,0 \?L1
?L3:	EQUAL? PRSA,V?LISTEN \?L5
	CALL CLASSICAL-PLAYING? >STACK
	ZERO? STACK /?L10
	CALL VISIBLE?,RADIO >STACK
	ZERO? STACK \?L9
?L10:	GET TAPE-TABLE,ON-TAPE >STACK
	EQUAL? STACK,2 \?L7
?L9:	PRINTR "It has a calming effect on you."
?L7:	PRINTR "It's pretty irritating."
?L5:	EQUAL? PRSA,V?RECORD \FALSE
	CALL VISIBLE?,HEADPHONES >STACK
	ZERO? STACK /FALSE
	CALL PERFORM,V?RECORD,HEADPHONES
	RTRUE
?L1:	CALL CANT-SEE,MUSIC >STACK
	RSTACK

	.FUNCT CLASSICAL-PLAYING?,?TMP
	CALL META-LOC,RADIO >STACK
	GETP STACK,P?GROUND-LOC >STACK
	ZERO? STACK /FALSE
	CALL META-LOC,RADIO >?TMP
	CALL META-LOC,HEADPHONES >STACK
	EQUAL? ?TMP,STACK \FALSE
	FSET? RADIO,ONBIT \FALSE
	EQUAL? STATION,1170 \FALSE
	RTRUE

	.FUNCT PARLOR-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTR "The parlor, with its tufted black leather sofa, softly lighted chandelier and darkly varnished paneling strives for a subdued turn-of-the-century motif and is purposefully dimmed -- thus setting the mood for conveyance, for squinting."
?L1:	EQUAL? RARG,M-BEG \FALSE
	IN? HYP,HERE \FALSE
	EQUAL? PRSA,V?EXAMINE \?L6
	EQUAL? PRSO,CHANDELIER,SOFA \?L6
	FSET? PRSO,RMUNGBIT /?L6
	FSET PRSO,RMUNGBIT
	PRINTI "Before you can fix your gaze upon the "
	CALL DPRINT,PRSO
	PRINTI ", "
	CALL DPRINT,HYP
	PRINTI " speaks, ""You are wondering about the "
	CALL DPRINT,PRSO
	PRINTI ". But I can assure you, there is nothing at all "
	CALL PICK-ONE,YAWNS >STACK
	PRINT STACK
	PRINTI " about it. Observe for "
	CALL DPRINT,ME
	PRINTI "."" Rimshaw gestures in a grand manner toward"
	CALL ARTICLE,PRSO,1
	PRINTR ". Amazing."
?L6:	EQUAL? PRSA,V?THROW,V?DROP \FALSE
	FSET? PRSO,TAKEBIT \FALSE
	FSET? PRSO,WORNBIT /FALSE
	EQUAL? PRSO,MOUSE,BALLOON,TICKET /FALSE
	CALL HYP-HAND-BACK >STACK
	RSTACK

	.FUNCT HYP-HAND-BACK
	CALL DPRINT,HYP
	PRINTI " is also Rimshaw the Immaculate. He hands"
	CALL ARTICLE,PRSO,1
	PRINTR " back to you."

	.FUNCT TICKET-F
	EQUAL? PRSA,V?CUT,V?PUNCH,V?PUSH \?L1
	PRINT SPECIFIC
	RTRUE
?L1:	EQUAL? PRSA,V?READ,V?EXAMINE,V?LOOK-INSIDE \?L5
	CALL PERFORM,V?EXAMINE,PINK-BOX
	SET 'P-IT-OBJECT,TICKET
	RTRUE
?L5:	EQUAL? PRSA,V?PUT-UNDER \?L6
	EQUAL? PRSI,FRONT \?L6
	EQUAL? HERE,NOOK \?L6
	CALL PERFORM,V?PUT-UNDER,PRSO,BLUE-DOOR
	RTRUE
?L6:	EQUAL? PRSA,V?TAKE \FALSE
	IN? TICKET,DEALER \FALSE
	PRINTI "The "
	CALL DPRINT,DEALER
	PRINTI " yanks it back."
	CRLF
	CALL PRINT-ID,STR?134 >STACK
	RSTACK

	.FUNCT BOX-F
	EQUAL? PRSA,V?CUT,V?PUNCH,V?PUSH /?L3
	EQUAL? P-PRSA-WORD,W?POKE \?L1
?L3:	IN? TICKET,PROTAGONIST /?L4
	SET 'P-IT-OBJECT,TICKET
	PRINT NOT-HOLDING
	PRINTR " the ticket."
?L4:	FSET? PRSO,RMUNGBIT \?L8
	PRINTR "It already is."
?L8:	EQUAL? PRSO,BLUE-BOX \?L13
	FSET? PINK-BOX,RMUNGBIT /?L12
?L13:	EQUAL? PRSO,PINK-BOX \?L11
	FSET? BLUE-BOX,RMUNGBIT \?L11
?L12:	SET 'AWAITING-REPLY,3
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTR "Were you ever considering a career with the circus?"
?L11:	FSET PRSO,RMUNGBIT
	PRINTI "You perforate the "
	CALL DPRINT,PRSO
	PRINTR "."
?L1:	EQUAL? PRSA,V?PUT,V?THROW,V?DROP /?L20
	EQUAL? PRSA,V?GIVE \?L19
?L20:	EQUAL? PRSO,PINK-BOX,BLUE-BOX \?L19
	CALL PERFORM,PRSA,TICKET,PRSI
	RTRUE
?L19:	EQUAL? PRSA,V?EXAMINE \FALSE
	CALL IN-PACKAGE,TICKET >STACK
	RSTACK

	.FUNCT MAN-OR-WOMAN,MAN,WOMAN
	FSET? BLUE-BOX,RMUNGBIT \?L1
	PRINT MAN
	RTRUE
?L1:	PRINT WOMAN
	RTRUE

	.FUNCT HYP-F
	FSET? HYP,RMUNGBIT /?L3
	EQUAL? PRSA,V?TELL /FALSE
	FSET? HYP,RMUNGBIT /?L3
	EQUAL? PRSA,V?ASK-ABOUT /?L3
	CALL TALKING-TO?,HYP >STACK
	ZERO? STACK \?L4
	EQUAL? PRSA,V?THROW,V?SHOW,V?GIVE \?L3
	EQUAL? PRSO,TICKET \?L3
?L4:	FSET HYP,RMUNGBIT
	PRINTI "Rimshaw steps nearer, speaking in a very spiritual tone, ""I can tell immediately that you "
	CALL DPRINT,ME
	PRINTI " possess great powers of transcendence. It is your eyes which bespeak your affinity with those mysterious energies that choose to remain unseen."
	EQUAL? PRSA,V?THROW,V?SHOW,V?GIVE \?L7
	EQUAL? PRSO,TICKET \?L7
	PRINTI """"
	CRLF
	CRLF
	CALL TELL-WHAT-NOW >STACK
	RSTACK
?L7:	EQUAL? WINNER,HYP \?L11
	EQUAL? PRSA,V?HYPNOTISE \?L11
	EQUAL? PRSO,ME \?L11
	CALL HELD?,TICKET >STACK
	ZERO? STACK /?L11
	CRLF
	CRLF
	CALL TELL-WHAT-NOW,0,1
	CRLF
	CRLF
	CALL PERFORM,V?HYPNOTISE,ME
	RTRUE
?L11:	SET 'P-IT-OBJECT,HYP
	PRINTI " Ticket, please."""
	CRLF
	CALL STOP >STACK
	RSTACK
?L3:	EQUAL? WINNER,HYP \?L15
	EQUAL? PRSA,V?TELL-ABOUT \?L16
	EQUAL? PRSO,ME \?L16
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,HYP,PRSI
	SET 'WINNER,HYP
	RTRUE
?L16:	EQUAL? PRSA,V?HELLO \?L18
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,HYP
	SET 'WINNER,HYP
	RTRUE
?L18:	EQUAL? PRSA,V?HYPNOTISE \?L19
	EQUAL? PRSO,ME \?L19
	CALL TICKET-CHECK?,PARLOR >STACK
	ZERO? STACK \TRUE
	LOC PROTAGONIST >STACK
	EQUAL? STACK,SOFA /?L23
	PRINTI "You settle into the tufted "
	CALL DPRINT,SOFA
	PRINTI " and "
?L23:	CALL DPRINT,HYP
	PRINTI " approaches you purposefully. Poised in front of you, the hypnotist points both of his hands' tension-filled fingers at you and commands, ""RE-LAX!!! Now count backward slowly from 100."""
	CRLF
	CRLF
	SET 'P-CONT,0
	PRINTI "With transcendental calm you begin mouthing the words one hundred, ninety-nine, ninety-eight ..."
	CALL DREAM >STACK
	RSTACK
?L19:	EQUAL? PRSA,V?EXAMINE,V?READ,V?RUB \?L34
	EQUAL? PRSO,HEAD /?L33
?L34:	EQUAL? PRSA,V?TELL-ABOUT \?L32
	EQUAL? PRSO,ME \?L32
	EQUAL? PRSI,HEAD \?L32
?L33:	CALL TICKET-CHECK?,HEAD >STACK
	ZERO? STACK \TRUE
	INC 'DREAM-C
	FSET HEAD,RMUNGBIT
	CALL DPRINT,HYP
	PRINTI " places his fingertips on top of your skull and begins going carefully over its hills and valleys, pausing occasionally for comment. ""Intelligence: I ascertain you play Infocom games. Personally I enjoyed ""Enchanter"" ... Romance: A "
	FSET? PINK-BOX,RMUNGBIT \?L40
	PRINTI "tall handsome stranger"
	JUMP ?L44
?L40:	PRINTI "woman of mysterious beauty"
?L44:	PRINTR " will soon come into your life ... Travel: You will visit the Grand Canyon before the year is out.""

With this, Rimshaw gives a perfunctory slap up the side of your head and says, ""End of Session."""
?L32:	EQUAL? PRSA,V?EXAMINE,V?RUB,V?READ \?L51
	EQUAL? PRSO,HANDS /?L50
?L51:	EQUAL? PRSA,V?EXAMINE,V?READ,V?TELL \?L52
	EQUAL? PRSO,FORTUNE /?L50
?L52:	EQUAL? PRSA,V?TELL-ABOUT \?L49
	EQUAL? PRSO,ME \?L49
	EQUAL? PRSI,HANDS,FORTUNE \?L49
?L50:	CALL TICKET-CHECK?,HANDS >STACK
	ZERO? STACK \TRUE
	FSET HANDS,RMUNGBIT
	INC 'DREAM-C
	CALL DPRINT,HYP
	PRINTI " takes "
	CALL DPRINT,HANDS
	PRINTR " and studies the palm lines with the intensity of a cartographer, finally saying in a dramatic whisper, ""Tonight you have an appointment with destiny."""
?L49:	PRINTI "Rimshaw remains aloof."
	CRLF
	CALL STOP >STACK
	RSTACK
?L15:	EQUAL? PRSA,V?THROW,V?SHOW,V?GIVE \?L61
	EQUAL? PRSO,TICKET \?L62
	ZERO? HYP-BOX /?L64
	ZERO? WON-STANDS /?L68
	LESS? DREAM-C,4 \?L66
?L68:	CALL TELL-WHAT-NOW,1 >STACK
	RSTACK
?L66:	PRINTR """I have done all that I can do. No more."""
?L64:	CALL TELL-WHAT-NOW >STACK
	RSTACK
?L62:	EQUAL? PRSO,HANDS \?L73
	SET 'WINNER,HYP
	CALL PERFORM,V?READ,HANDS
	SET 'WINNER,PROTAGONIST
	RTRUE
?L73:	EQUAL? PRSO,HEADPHONES \?L74
	ZERO? TAPE-SHOW \?L74
	SET 'TAPE-SHOW,1
	CALL DPRINT,HYP
	PRINTI " begins to lose his composure, regains it again quickly, does a slow burn, stomps around the "
	CALL DPRINT,PARLOR-OBJECT
	PRINTR " a bit, then reassumes his previous lordly manner."
?L74:	FSET? MASK,WORNBIT /FALSE
	CALL PERFORM,V?ASK-ABOUT,HYP,PRSO
	RTRUE
?L61:	EQUAL? PRSA,V?ASK-ABOUT \FALSE
	EQUAL? PRSI,FORTUNE,HANDS,HEAD \?L79
	SET 'WINNER,HYP
	CALL PERFORM,V?READ,PRSI
	SET 'WINNER,PROTAGONIST
	RTRUE
?L79:	EQUAL? PRSA,V?ASK-ABOUT \FALSE
	EQUAL? PRSO,HYP \FALSE
	CALL DPRINT,HYP
	PRINTI " draws his hand to his forehead, closes his eyes, meditates a moment, then offers, ""About"
	IN? PRSI,ROOMS /?L85
	EQUAL? PRSI,HYP \?L83
?L85:	PRINTI " that"
	JUMP ?L88
?L83:	CALL ARTICLE,PRSI,1
?L88:	RANDOM 100 >STACK
	LESS? 50,STACK /?L89
	PRINTI " I am unable"
	JUMP ?L93
?L89:	PRINTI " it is impossible for me"
?L93:	PRINTR " to soothsay."""

	.FUNCT HYP-DESC,X
	SET 'P-IT-OBJECT,HYP
	PRINTI "Standing here, attired in an immaculate black tuxedo, is none other than Rimshaw himself."
	RTRUE

	.FUNCT TICKET-CHECK?,OBJ=0
	ZERO? HYP-BOX \?L1
	PRINTR """Ticket, please."""
?L1:	FSET? OBJ,RMUNGBIT /?L7
	EQUAL? PRSA,V?HYPNOTISE \FALSE
	GRTR? DREAM-C,3 /?L7
	ZERO? WON-STANDS /FALSE
?L7:	PRINTR "With the arrogant self-satisfaction common to members of his profession, he responds, ""It's been done."""

	.FUNCT TELL-WHAT-NOW,LOOKS-AT?=0,NO-Q?=0
	SET 'HYP-BOX,1
	CALL QUEUE,I-HYP,2 >STACK
	PUT STACK,0,1
	PRINTI "He "
	ZERO? LOOKS-AT? /?L3
	PRINTI "glances at"
	JUMP ?L7
?L3:	PRINTI "punches"
?L7:	PRINTI " your ticket and hands it back."
	SET 'P-IT-OBJECT,HYP
	ZERO? NO-Q? \TRUE
	PRINTR " ""Whadda you want?"""

	.FUNCT I-HYP
	CALL INT,I-HYP >STACK
	PUT STACK,0,0
	FSET? CANVAS,RMUNGBIT \FALSE
	FCLEAR TRAP,NDESCBIT
	RFALSE

	.FUNCT DREAM
	CALL ROB,PROTAGONIST,BIGTOP
	CALL MOVE-TAKEBIT,WINGS,BANNER
	CALL MOVE-TAKEBIT,CON-AREA,BUTTON
	MOVE LONG,CON-AREA
	MOVE CONCESSIONAIRE,CON-AREA
	MOVE CON-STAND,CON-AREA
	MOVE ROAR,STANDS-ROOM
	MOVE UNIFORM,HAWKER
	SET 'SIT-IN-STANDS,1
	SET 'MONEY-BEFORE-DREAM,POCKET-CHANGE
	SET 'POCKET-CHANGE,1841
	SET 'DREAMING,1
	SET 'STANDS-C,0
	SET 'TLOC,1
	FCLEAR CON-AREA,TOUCHBIT
	FCLEAR STANDS-ROOM,TOUCHBIT
	CALL QUEUE,I-STANDS,1 >STACK
	PUT STACK,0,1
	CRLF
	CRLF
	PRINTI "Your mind begins to drift back, back, back into the most recently forgotten past ..."
	CRLF
	CRLF
	CALL GOTO,STANDS-ROOM >STACK
	RSTACK

	.FUNCT WAKE-UP,FORCED?=0
	CALL ROB,BIGTOP,PROTAGONIST
	CALL ROB,BANNER,WINGS
	CALL ROB,BUTTON,CON-AREA
	FCLEAR LONG,TOUCHBIT
	FCLEAR WINGS,TOUCHBIT
	FCLEAR HAWKER,RMUNGBIT
	FCLEAR MONKEY,RMUNGBIT
	FCLEAR LONG,RMUNGBIT
	FCLEAR JERRY,RMUNGBIT
	FCLEAR TEAM,RMUNGBIT
	FCLEAR BANANA,RMUNGBIT
	MOVE CONCESSIONAIRE,LOCAL-GLOBALS
	MOVE JUNK-FOOD,LOCAL-GLOBALS
	MOVE BANANA,LOCAL-GLOBALS
	MOVE UNIFORM,THUMB
	MOVE MONKEY,DICK
	MOVE LONG,LOCAL-GLOBALS
	MOVE SHORT,LOCAL-GLOBALS
	MOVE HAWKER,LOCAL-GLOBALS
	MOVE CON-STAND,LOCAL-GLOBALS
	SET 'ORDERED-GRANOLA,0
	SET 'POCKET-CHANGE,MONEY-BEFORE-DREAM
	SET 'HERE,PARLOR
	SET 'DREAMING,0
	SET 'LINE-COUNTER,0
	SET 'PLAYER-NUM,1
	CALL INT,I-BAD-LUCK >STACK
	PUT STACK,0,0
	CALL INT,I-STANDS >STACK
	PUT STACK,0,0
	MOVE PROTAGONIST,SOFA
	EQUAL? PRSA,V?ALARM \?L1
	PRINTI "You suddenly drift back to reality ..."
	ZERO? WON-STANDS \?L15
	PRINTI " "
	CALL DPRINT,HYP
	PRINTI " looks disappointed at your limited progress under hypnosis"
	LESS? DREAM-C,4 \?L15
	PRINTI " but he seems willing to try again"
	JUMP ?L15
?L1:	PRINTI "wake up ..."
?L15:	PRINTI "."
	CRLF
	CRLF
	CALL V-LOOK >STACK
	RSTACK

	.FUNCT SOFA-F,RARG=0
	EQUAL? RARG,M-BEG \?L3
	EQUAL? PRSA,V?WALK \?L1
	CALL OUT-OF-FIRST,SOFA >STACK
	RSTACK
?L1:	EQUAL? RARG,M-BEG \?L3
	EQUAL? PRSA,V?THROW,V?DROP \?L3
	CALL HYP-HAND-BACK >STACK
	RSTACK
?L3:	ZERO? RARG \FALSE
	EQUAL? PRSA,V?LIE-DOWN \?L5
	PRINTR "This is hypnotism, not psychoanalysis."
?L5:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L8
	CALL CANT-OPEN >STACK
	RSTACK
?L8:	EQUAL? PRSA,V?PUT-ON \FALSE
	EQUAL? PRSI,SOFA \FALSE
	CALL PERFORM,V?DROP,PRSO
	RTRUE

	.FUNCT TUX-F
	EQUAL? PRSA,V?TAKE,V?REMOVE \FALSE
	CALL PRINT-ID,STR?135
	CALL KIND-OF-PERFORMER,HYP >STACK
	RSTACK

	.FUNCT FORTUNE-F
	EQUAL? PRSA,V?TELL \FALSE
	CALL ENABLED?,I-HYP >STACK
	ZERO? STACK /FALSE
	SET 'WINNER,HYP
	CALL PERFORM,PRSA,PRSO
	SET 'WINNER,PROTAGONIST
	RTRUE

	.FUNCT MID-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "This is about midway along the midway. "
	CALL TELL-FRONT,1
	IN? CROWD,HERE \FALSE
	CRLF
	PRINTR "On the north side of the midway, a crowd is drawn tightly around a sideshow entrance."

	.FUNCT FRONT-F
	EQUAL? PRSA,V?READ,V?EXAMINE \?L1
	PRINTI "The "
	CALL DPRINT,FRONT
	EQUAL? HERE,MIDWEST \?L5
	PRINTI " heralding the charms of Tina is"
	JUMP ?L12
?L5:	EQUAL? HERE,NOOK,MIDEAST \?L9
	PRINTI " is"
	JUMP ?L12
?L9:	PRINTI "s are"
?L12:	EQUAL? HERE,NOOK \?L15
	PRINTR " warped and faded beyond recognition."
?L15:	PRINTI " an eyeful of dazzling, flamboyant artwork similar to that represented in the circus program along with glowing introductions of the performers. "
	EQUAL? HERE,MID \?L22
	PRINTI "Each "
	JUMP ?L26
?L22:	PRINTI "The "
?L26:	PRINTR "front has a small entrance."
?L1:	EQUAL? PRSA,V?LOOK-BEHIND \?L31
	EQUAL? HERE,NOOK \?L31
	PRINTI "You can't. The "
	CALL DPRINT,FRONT
	PRINTR " serves as a barrier to an enclosed area."
?L31:	EQUAL? PRSA,V?WALK-TO,V?ENTER,V?THROUGH \?L34
	EQUAL? HERE,MID \?L35
	PRINTR "North or south?"
?L35:	EQUAL? HERE,MIDEAST \?L39
	CALL DO-WALK,P?NORTH >STACK
	RSTACK
?L39:	EQUAL? HERE,NOOK \FALSE
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L34:	EQUAL? PRSA,V?PUT-UNDER \FALSE
	EQUAL? PRSO,TICKET \FALSE
	EQUAL? HERE,NOOK \FALSE
	EQUAL? CLOWN-COUNTER,7 /?L43
	PRINT TIPPED-OFF
	RTRUE
?L43:	FCLEAR BLUE-DOOR,INVISIBLE
	ZERO? BOUNCE-C \?L48
	FSET? BLUE-ROOM,TOUCHBIT /?L48
	ADD SCORE,10 >SCORE
?L48:	PRINTI "The ticket disappears under the plywood"
	EQUAL? BLUE-ROOM-ENTER-NUMBER,2 \?L53
	FSET? DEALER,RMUNGBIT /?L53
	FSET? BLUE-DOOR,RMUNGBIT \?L55
	MOVE TICKET,LOCAL-GLOBALS
	PRINT PERIOD
	RTRUE
?L55:	FSET BLUE-DOOR,RMUNGBIT
	PRINTI " and then "
	EQUAL? BLUE-ROOM-ENTER-NUMBER,2 \?L62
	FSET? DEALER,RMUNGBIT /?L62
	MOVE TICKET,HERE
	PRINTR "reappears."
?L62:	FCLEAR BLUE-DOOR,RMUNGBIT
	CALL WIN-BLUE-DOOR >STACK
	RSTACK
?L53:	CALL WIN-BLUE-DOOR,1 >STACK
	RSTACK

	.FUNCT I-BLUE-DOOR
	FCLEAR BLUE-DOOR,OPENBIT
	EQUAL? HERE,BLUE-ROOM,NOOK \FALSE
	EQUAL? PRSA,V?CLOSE \?L5
	EQUAL? PRSO,BLUE-DOOR /?L3
?L5:	CRLF
?L3:	PRINTI "The spring-loaded "
	CALL DPRINT,BLUE-DOOR
	PRINTR " slides shut."

	.FUNCT BLUE-DOOR-F
	EQUAL? PRSA,V?PUT-UNDER \?L1
	EQUAL? PRSO,TICKET \?L1
	CALL PERFORM,V?PUT-UNDER,TICKET,FRONT
	RTRUE
?L1:	EQUAL? PRSA,V?BOARD,V?THROUGH,V?WALK-TO \?L3
	EQUAL? HERE,NOOK \?L4
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L4:	EQUAL? HERE,BLUE-ROOM \FALSE
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?OPEN \?L8
	EQUAL? HERE,BLUE-ROOM \?L9
	EQUAL? BLUE-ROOM-ENTER-NUMBER,1 \?L11
	SET 'BLUE-ROOM-ENTER-NUMBER,2
	SET 'FORCED-BET,1
	PRINTI "You decide instead to make "
	ZERO? BET-ONCE /?L15
	PRINTI "one last"
	JUMP ?L19
?L15:	PRINTI "a"
?L19:	PRINTI " bet, and plunk 1 dollar down on the table."
	CRLF
	CRLF
	CALL PRINT-ID,STR?136
	SET 'P-DOLLAR-FLAG,1
	SET 'P-AMOUNT,100
	CALL PERFORM,V?BET,INTNUM
	RTRUE
?L11:	CALL QUEUE,I-BLUE-DOOR,2 >STACK
	PUT STACK,0,1
	RFALSE
?L9:	PRINTR "There's no handle."
?L8:	EQUAL? PRSA,V?CLOSE \FALSE
	FSET? BLUE-DOOR,OPENBIT /TRUE
	RFALSE

	.FUNCT GEN-NOOK-DOOR-F
	EQUAL? PRSA,V?PUT-UNDER \FALSE
	RETURN BLUE-DOOR

	.FUNCT WIN-BLUE-DOOR,AND?=0
	FSET BLUE-DOOR,OPENBIT
	MOVE TICKET,BLUE-ROOM
	CALL QUEUE,I-BLUE-DOOR,3 >STACK
	PUT STACK,0,1
	ZERO? AND? /?L1
	PRINTI " and "
?L1:	PRINTI "moments later a "
	CALL DPRINT,BLUE-DOOR
	PRINTR " in the old sideshow front slides open."

	.FUNCT FAT-ROOM-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	EQUAL? HERE,FAT-WEST \?L3
	PRINTI "Dominating this once spacious room, geographic in her enormity, mountainous in her irreducibility, t"
	JUMP ?L7
?L3:	PRINTI "T"
?L7:	PRINTI "he "
	CALL DPRINT,FAT
	PRINTI " sits (though no chair is visible) breathtakingly to the "
	EQUAL? HERE,FAT-WEST \?L12
	PRINTI "east"
	JUMP ?L16
?L12:	PRINTI "west"
?L16:	PRINTI ". "
	PRINTI "Paths around the attraction lead "
	EQUAL? HERE,FAT-WEST \?L23
	PRINTR "northeast and southeast. The exit is south."
?L23:	PRINTR "northwest and southwest."

	.FUNCT AROUND-FAT
	SET 'HANDOUT,0
	CALL HELD?,FAT-HAND >STACK
	ZERO? STACK /?L1
	PRINTI "Not while you're holding the "
	CALL DPRINT,FAT-HAND
	PRINTI "!"
	CRLF
	RFALSE
?L1:	EQUAL? P-WALK-DIR,P?SOUTH,P?OUT \?L5
	RETURN MIDEAST
?L5:	EQUAL? P-WALK-DIR,P?EAST \?L8
	EQUAL? HERE,FAT-WEST /?L7
?L8:	EQUAL? P-WALK-DIR,P?WEST \?L6
	EQUAL? HERE,FAT-EAST \?L6
?L7:	PRINTI "The "
	CALL DPRINT,FAT
	PRINTI "'s in the way."
	CRLF
	RFALSE
?L6:	PRINTI "It's a long haul, the scenery changing little. Eventually you arrive at ..."
	CRLF
	CRLF
	EQUAL? HERE,FAT-EAST \?L14
	CALL MOVE-FAT,FAT-WEST >STACK
	RSTACK
?L14:	CALL MOVE-FAT,FAT-EAST >STACK
	RSTACK

	.FUNCT MOVE-FAT,PLACE
	IN? RADIO,FAT \?L5
	FSET? RADIO,NDESCBIT \?L3
	FCLEAR RADIO,NDESCBIT
	JUMP ?L5
?L3:	FSET RADIO,NDESCBIT
?L5:	MOVE FAT,PLACE
	MOVE FAT-HAND,PLACE
	RETURN PLACE

	.FUNCT FAT-F
	CALL TALKING-TO?,FAT >STACK
	ZERO? STACK \?L3
	EQUAL? PRSA,V?SHOW,V?GIVE \?L1
	EQUAL? PRSI,FAT \?L1
	FSET? PRSO,EATBIT /?L1
?L3:	IN? RADIO,FAT \?L4
	FSET? RADIO,NDESCBIT /?L4
	PRINTI "She doesn't seem to notice you with that radio in her ear."
	CRLF
	JUMP ?L23
?L4:	FSET? GRANOLA,RMUNGBIT \?L9
	IN? RADIO,FAT \?L9
	PRINTI "She merely sighs wistfully, which creates a gale-force gust"
	ZERO? HANDOUT \?L15
	SET 'HANDOUT,1
	CALL HELD?,FAT-HAND >STACK
	ZERO? STACK \?L15
	PRINTI ", and cranes her wrecking-ball-sized hand over to you"
?L15:	PRINT PERIOD
	JUMP ?L23
?L9:	PRINTI "She appears oblivious"
	FSET? GRANOLA,RMUNGBIT \?L26
	PRINTI ", once again,"
?L26:	PRINTI " to both sight and sound."
	CRLF
?L23:	CALL STOP >STACK
	RSTACK
?L1:	CALL HURT?,FAT >STACK
	ZERO? STACK /?L33
	PRINTI "The "
	CALL DPRINT,FAT
	PRINTI " is unaffected by your malice."
	CRLF
	CALL PRINT-ID,STR?137 >STACK
	RSTACK
?L33:	EQUAL? PRSA,V?CLIMB-UP,V?CLIMB-ON,V?BOARD /?L37
	EQUAL? PRSA,V?CLIMB-FOO \?L36
?L37:	PRINTI "The slope is too steep."
	CRLF
	CALL PRINT-ID,STR?138 >STACK
	RSTACK
?L36:	EQUAL? PRSA,V?SMELL \?L40
	PRINTR "There's no smell."
?L40:	EQUAL? PRSA,V?EXAMINE \?L43
	PRINTI "The "
	CALL DPRINT,FAT
	PRINTI " is wearing a "
	CALL DPRINT,BIGTOP
	PRINTI ", and the expression on her face is sad and distant, almost Rushmorean. "
	FSET? RADIO,NDESCBIT /?L46
	IN? RADIO,FAT \?L46
	PRINTR "She appears to be holding a small radio up to her ear."
?L46:	ZERO? HANDOUT /?L50
	PRINTI "The "
	CALL DPRINT,FAT-HAND
	PRINTI " is reached out."
?L50:	CRLF
	RTRUE
?L43:	EQUAL? PRSA,V?SHOW,V?GIVE \?L54
	EQUAL? PRSI,FAT \?L54
	IN? RADIO,FAT \?L55
	FSET? RADIO,NDESCBIT /?L55
	CALL PERFORM,V?HELLO,FAT
	CALL STOP >STACK
	RSTACK
?L55:	EQUAL? PRSO,GRANOLA \?L57
	MOVE GRANOLA,LOCAL-GLOBALS
	FSET GRANOLA,RMUNGBIT
	PRINTI "Tina is quick to confiscate the "
	CALL DPRINT,GRANOLA
	PRINTI " from "
	CALL DPRINT,HANDS
	PRINTR " and grinds it up without hesitation. Turning her far-away gaze slowly in your direction, she seems to notice you for the first time this evening."
?L57:	FSET? PRSO,EATBIT \FALSE
	PRINTI "The "
	CALL DPRINT,PRSO
	PRINTR " is obviously not part of her usual diet, since she ignores it."
?L54:	EQUAL? PRSA,V?KISS \?L64
	CALL HELD?,FAT-HAND >STACK
	ZERO? STACK /?L65
	CALL PERFORM,V?KISS,FAT-HAND
	RTRUE
?L65:	FSET? BLUE-BOX,RMUNGBIT \FALSE
	PRINTI "The "
	CALL DPRINT,FAT
	PRINTI " is far too distant for your affection."
	CRLF
	CALL PRINT-ID,STR?139 >STACK
	RSTACK
?L64:	EQUAL? PRSA,V?SHAKE-WITH \?L71
	EQUAL? PRSO,HANDS \?L71
	CALL PERFORM,V?TAKE,FAT-HAND
	RTRUE
?L71:	EQUAL? PRSA,V?WALK-AROUND \FALSE
	EQUAL? HERE,FAT-WEST \?L73
	CALL DO-WALK,P?NE
	RTRUE
?L73:	CALL DO-WALK,P?NW
	RTRUE

	.FUNCT FAT-HAND-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "It looks like an enormously over-inflated rubber glove."
?L1:	EQUAL? PRSA,V?TAKE \?L5
	ZERO? HANDOUT /?L6
	MOVE FAT-HAND,PROTAGONIST
	FCLEAR FAT-HAND,NDESCBIT
	SET 'HANDOUT,0
	PRINTI "As you take hold, the "
	CALL DPRINT,FAT-HAND
	PRINTR " becomes relaxed, its full weight now residing in your arms like a sandbag and making your knees buckle."
?L6:	CALL CANT-REACH,FAT-HAND
	PRINTR ". It's too far ... ""inland"" if you will."
?L5:	EQUAL? PRSA,V?DROP \?L13
	MOVE FAT-HAND,HERE
	FSET FAT-HAND,NDESCBIT
	SET 'HANDOUT,0
	PRINTR "The hand is craned away from you."
?L13:	EQUAL? PRSA,V?PUT \?L16
	EQUAL? PRSI,FAT-HAND \?L16
	CALL PERFORM,V?GIVE,PRSO,FAT
	RTRUE
?L16:	EQUAL? PRSA,V?PUT,V?GIVE,V?THROW /?L18
	EQUAL? PRSA,V?PUT-ON \?L17
?L18:	EQUAL? PRSO,FAT-HAND \?L17
	PRINTR "It's too unwieldy."
?L17:	EQUAL? PRSA,V?SHAKE \?L21
	CALL HELD?,FAT-HAND >STACK
	ZERO? STACK /?L22
	PRINTI "Though unable to budge the "
	CALL DPRINT,FAT-HAND
	PRINTI ", your friendly intentions are nevertheless understood. "
	CALL WIN-FAT
	RTRUE
?L22:	ZERO? HANDOUT /?L26
	CALL PERFORM,V?TAKE,FAT-HAND
	IN? FAT-HAND,PROTAGONIST \FALSE
	CRLF
	CALL WIN-FAT
	RTRUE
?L26:	PRINT NOT-HOLDING
	PRINTI " "
	CALL DPRINT,FAT-HAND
	PRINTR "."
?L21:	EQUAL? PRSA,V?KISS \?L33
	CALL HELD?,FAT-HAND >STACK
	ZERO? STACK \?L34
	CALL PERFORM,V?DROP,PRSO
	RTRUE
?L34:	CALL PRINT-ID,STR?140
	CALL WIN-FAT >STACK
	RSTACK
?L33:	EQUAL? PRSA,V?RUB \FALSE
	CALL HELD?,FAT-HAND >STACK
	ZERO? STACK \?L40
	ZERO? HANDOUT /?L38
?L40:	CALL WIN-FAT
	RTRUE
?L38:	CALL PERFORM,V?TAKE,FAT-HAND
	RTRUE

	.FUNCT WIN-FAT
	EQUAL? HERE,FAT-EAST \?L1
	MOVE RADIO,FAT-WEST
	JUMP ?L3
?L1:	MOVE RADIO,FAT-EAST
?L3:	SET 'HANDOUT,0
	FSET RADIO,ONBIT
	FCLEAR RADIO,NDESCBIT
	FSET FAT-HAND,NDESCBIT
	CALL QUEUE,I-RADIO,-1 >STACK
	PUT STACK,0,1
	MOVE FAT-HAND,HERE
	PRINTI "The "
	CALL DPRINT,FAT
	PRINTI " appears quite taken by your kindnesses. She clasps both her hands up to her chins, and stares ahead in teary silence."
	CRLF
	CALL PRINT-ID,STR?141 >STACK
	RSTACK

	.FUNCT RADIO-F
	CALL DONT-HANDLE?,RADIO >STACK
	ZERO? STACK \FALSE
	IN? RADIO,FAT \?L3
	FSET? RADIO,NDESCBIT \?L3
	CALL CANT-SEE,RADIO >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L4
	PRINTR "It's one of those non-opening models."
?L4:	EQUAL? PRSA,V?RECORD \?L7
	CALL PERFORM,V?RECORD
	RTRUE
?L7:	CALL TOUCHING?,RADIO >STACK
	ZERO? STACK /?L8
	IN? RADIO,FAT \?L8
	FSET RADIO,NDESCBIT
	PRINTI "The "
	CALL DPRINT,FAT
	PRINTI " casually passes the "
	CALL DPRINT,RADIO
	PRINTR " over to her opposite hand."
?L8:	EQUAL? PRSA,V?EXAMINE \?L11
	IN? RADIO,FAT /?L11
	PRINTI "The AM dial is "
	FSET? RADIO,ONBIT \?L14
	PRINTI "illuminated and set to "
	PRINTN STATION
	PRINTR "."
?L14:	PRINTR "darkened."
?L11:	EQUAL? PRSA,V?LISTEN \?L21
	IN? RADIO,FAT \?L22
	PRINTR "You're not close enough."
?L22:	FSET? RADIO,ONBIT \FALSE
	CALL VISIBLE?,RADIO >STACK
	ZERO? STACK /FALSE
	RTRUE
?L21:	EQUAL? PRSA,V?SET \?L28
	CALL PERFORM,V?SET,DIAL,PRSI
	RTRUE
?L28:	EQUAL? PRSA,V?LAMP-ON \?L29
	FSET? RADIO,ONBIT /?L30
	FSET RADIO,ONBIT
	CALL QUEUE,I-RADIO,-1 >STACK
	PUT STACK,0,1
	PRINTI "The "
	CALL DPRINT,DIAL
	PRINTR " bursts forth in a circle of light."
?L30:	PRINTR "It is."
?L29:	EQUAL? PRSA,V?LAMP-OFF \FALSE
	FSET? RADIO,ONBIT \?L38
	CALL INT,I-RADIO >STACK
	PUT STACK,0,0
	FCLEAR RADIO,ONBIT
	PRINTI "The "
	CALL DPRINT,DIAL
	PRINTR " flickers and grows dark."
?L38:	PRINTR "It's already off."

	.FUNCT I-RADIO
	CALL VISIBLE?,RADIO >STACK
	ZERO? STACK /FALSE
	FSET? RADIO,ONBIT \FALSE
	CALL ENABLED?,I-DEMISE >STACK
	ZERO? STACK \FALSE
	EQUAL? PRSA,V?LISTEN \?L5
	EQUAL? PRSO,RADIO /?L3
?L5:	CRLF
?L3:	PRINTI "Drifting out from the radio is "
	GETP HERE,P?GROUND-LOC >STACK
	ZERO? STACK /?L9
	EQUAL? STATION,1170 \?L15
	FSET? DIAL,RMUNGBIT \?L11
	ZERO? CALLED-STATION \?L11
	PRINTR "an appeal for cash: The announcer repeats that she will not play a certain piece by Vivaldi until just one more caller phones in a pledge."
?L11:	EQUAL? STATION,1170 \?L15
	PRINT CLASSICAL
	EQUAL? ON-ROPE,3,4 \TRUE
	EQUAL? APE-LOC,3 \TRUE
	FSET? DIAL,RMUNGBIT /TRUE
	FSET DIAL,RMUNGBIT
	CRLF
	PRINTR "There is a sudden break in the music. A female announcer comes on the air and, after reminding her audience that this is Pledge Week for WPDL, in a honeyed voice begins making an appeal for cash."
?L15:	PRINTR "the typical noisy hubbub of AM radio."
?L9:	PRINTR "a jumble of static."

	.FUNCT WPDL-F
	CALL DONT-HANDLE?,WPDL >STACK
	ZERO? STACK \FALSE
	CALL VISIBLE?,RADIO >STACK
	ZERO? STACK \?L3
	EQUAL? HERE,OFFICE /?L3
	CALL CANT-SEE,0,STR?142 >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?LISTEN \?L4
	EQUAL? STATION,1170 \?L4
	CALL PERFORM,V?LISTEN,RADIO
	RTRUE
?L4:	EQUAL? PRSA,V?SET \?L7
	EQUAL? PRSO,DIAL /?L6
?L7:	EQUAL? PRSA,V?LAMP-ON \FALSE
	EQUAL? PRSO,WPDL \FALSE
?L6:	SET 'P-NUMBER,1170
	CALL PERFORM,V?SET,DIAL,INTNUM
	RTRUE

	.FUNCT DIAL-F
	EQUAL? PRSA,V?READ,V?EXAMINE \?L1
	CALL PERFORM,V?EXAMINE,RADIO
	RTRUE
?L1:	EQUAL? PRSA,V?LAMP-ON,V?TUNE,V?SET /?L4
	EQUAL? PRSA,V?LAMP-OFF \?L3
?L4:	IN? RADIO,FAT \?L3
	CALL PERFORM,V?TAKE,RADIO
	RTRUE
?L3:	EQUAL? PRSA,V?SET \FALSE
	EQUAL? PRSI,INTNUM \FALSE
	ZERO? P-DOLLAR-FLAG /?L6
	CALL V-DIG >STACK
	RSTACK
?L6:	FSET? RADIO,ONBIT /?L8
	PRINTR "The dial is darkened and the numbers invisible."
?L8:	EQUAL? P-NUMBER,STATION \?L11
	PRINTR "That's where it's tuned to now!"
?L11:	GRTR? P-NUMBER,1600 /?L15
	LESS? P-NUMBER,550 \?L14
?L15:	PRINTR "That's off the AM scale."
?L14:	SET 'STATION,P-NUMBER
	GETP HERE,P?GROUND-LOC >STACK
	ZERO? STACK /?L19
	EQUAL? P-NUMBER,1170 \?L21
	PRINTI "You "
	FSET? DIAL,RMUNGBIT \?L25
	ZERO? CALLED-STATION \?L25
	PRINTI "should "
?L25:	PRINTR "have found an oasis of nice, soothing music."
?L21:	PRINTI "The very erratic signal is carrying, for the moment, "
	RANDOM 100 >STACK
	LESS? 35,STACK /?L35
	PRINTR "the latest in post-punk."
?L35:	RANDOM 100 >STACK
	LESS? 32,STACK /?L39
	PRINTR "an advertising pitch."
?L39:	PRINTR "a radio call-in debate."
?L19:	CALL SIGNAL,1 >STACK
	RSTACK

	.FUNCT SIGNAL,GROUNDED?=0
	PRINTI "You pick up a faint signal at "
	PRINTN P-NUMBER
	PRINTI " ... then it drifts into static."
	ZERO? GROUNDED? /?L3
	PRINTI " The reception here is horrible."
?L3:	CRLF
	RTRUE

	.FUNCT STAIRCASE-F
	EQUAL? PRSA,V?CLIMB-FOO,V?CLIMB-UP \FALSE
	CALL DO-WALK,P?UP >STACK
	RSTACK

	.FUNCT UP-STAIRS
	IN? ANDREW,HERE \?L1
	CALL DPRINT,ANDREW
	FSET? STAIRCASE,RMUNGBIT /?L5
	PRINTI " goose-steps to a position in front of the "
	CALL DPRINT,STAIRCASE
	PRINTI ", dragging Jenny's high heel across the ground. There "
	CALL DPRINT,ANDREW
	JUMP ?L9
?L5:	FSET STAIRCASE,RMUNGBIT
?L9:	PRINTI " stands blocking your way up. Stiffly, he pats his holster a couple of times and you hear its leather crinkle."
	CRLF
	RFALSE
?L1:	FSET? CLOSET,TOUCHBIT \?L12
	EQUAL? HERE,CLOSET \?L12
	PRINTI "You come out of the closet"
	JUMP ?L15
?L12:	PRINTI "With a bizarre twist, the "
	CALL DPRINT,STAIRCASE
	PRINTI " leads up over the "
	CALL DPRINT,WALLS
	PRINTI " and then down"
?L15:	PRINT PERIOD
	CRLF
	EQUAL? HERE,CLOSET \?L20
	RETURN BOUDOIR
?L20:	RETURN CLOSET

	.FUNCT BOUDOIR-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "This is a cozy little drawing room where guests are received. On the gloomy west side of the room, a "
	CALL DPRINT,STAIRCASE
	PRINTR " leads upward."

	.FUNCT HERM-F
	CALL TALKING-TO?,HERM >STACK
	ZERO? STACK \?L3
	EQUAL? HERM,WINNER /?L3
	EQUAL? PRSA,V?SHOW,V?GIVE \?L1
?L3:	PRINTI "As two distinct personalities, the pair must be addressed individually."
	CRLF
	CALL STOP >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L6
	PRINTI "[You can't use the verb """
	PRINTB P-PRSA-WORD
	EQUAL? P-PRSA-WORD,W?EXAMINE \?L9
	PRINTI "e"
?L9:	PRINTR """ with multiple personalities. Each must be observed individually.]"
?L6:	EQUAL? PRSA,V?FOLLOW \FALSE
	EQUAL? FOLLOW-FLAG,6 \FALSE
	CALL DO-WALK,P?NORTH >STACK
	RSTACK

	.FUNCT HERM-DESC,X
	SET 'P-IT-OBJECT,ANDREW
	PRINTI "Andrew Jenny is the attraction of this sideshow. He appears standoffish, she's looking bored."
	RTRUE

	.FUNCT ANDREW-F
	EQUAL? ANDREW,WINNER \?L1
	EQUAL? PRSA,V?TELL-ABOUT \?L3
	EQUAL? PRSO,ME \?L3
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,ANDREW,PRSI
	SET 'WINNER,ANDREW
	RTRUE
?L3:	EQUAL? PRSA,V?HELLO \?L5
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,ANDREW
	SET 'WINNER,ANDREW
	RTRUE
?L5:	PRINTI "Andrew displays a tight-lipped military reserve, and says nothing."
	CRLF
	CALL STOP >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L9
	CALL QUEUE,I-TURNSTILE,2 >STACK
	PUT STACK,0,1
	CALL DPRINT,ANDREW
	PRINTR "'s wearing an army boot, combat fatigues with a black leather shoulder holster, and a pith helmet. He sneers at you, his handlebar mustache nearly poking his eye. ""What are you staring at!"""
?L9:	CALL SPILL-BEANS? >STACK
	ZERO? STACK /?L12
	RETURN 2
?L12:	EQUAL? PRSA,V?ASK-ABOUT \?L15
	EQUAL? PRSO,ANDREW \?L15
	EQUAL? PRSI,JENNY \FALSE
	CALL DPRINT,ANDREW
	PRINTR " turns sarcastic. ""My 'better' half -- ugh! Well ... can't live with 'er, can't live without 'er."""
?L15:	EQUAL? PRSA,V?FOLLOW \FALSE
	EQUAL? FOLLOW-FLAG,6 \FALSE
	CALL DO-WALK,P?NORTH >STACK
	RSTACK

	.FUNCT ANDREW-CLOTHES-F
	EQUAL? PRSA,V?RUB,V?RAISE,V?TAKE /?L3
	EQUAL? PRSA,V?REMOVE,V?SEARCH,V?PUSH /?L3
	EQUAL? PRSA,V?LOOK-INSIDE \?L1
?L3:	ZERO? END-GAME /?L4
	CALL PRINT-ID,STR?143
	CALL V-DIG
	RTRUE
?L4:	CALL DPRINT,ANDREW
	PRINTI " snaps his half body into a martial arts fighting pose, which puts you off."
	CRLF
	CALL PRINT-ID,STR?144 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "The overall effect of "
	CALL DPRINT,ANDREW-CLOTHES
	PRINTR " is unmistakable: He's dressed to kill."

	.FUNCT GEN-JENNY-F
	RETURN JENNY

	.FUNCT JENNY-F
	EQUAL? JENNY,WINNER \?L1
	EQUAL? PRSA,V?TELL-ABOUT \?L3
	EQUAL? PRSO,ME \?L3
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,JENNY,PRSI
	SET 'WINNER,JENNY
	RTRUE
?L3:	EQUAL? PRSA,V?HELLO \?L5
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,JENNY
	SET 'WINNER,JENNY
	RTRUE
?L5:	PRINTI "Jenny remains aloof."
	CRLF
	CALL STOP >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L9
	PRINTR "She has on a svelte calf-length black evening dress and a pink feather boa draped over her shoulder."
?L9:	CALL SPILL-BEANS? >STACK
	ZERO? STACK /?L12
	RETURN 2
?L12:	EQUAL? PRSA,V?ASK-ABOUT \?L15
	EQUAL? PRSO,JENNY \?L15
	EQUAL? PRSI,ANDREW \FALSE
	PRINTR "She sighs. ""Mr. Tough Guy, huh? Deep down he's not really this mean. Just don't get on his bad side, honey."""
?L15:	EQUAL? PRSA,V?FOLLOW \FALSE
	EQUAL? FOLLOW-FLAG,6 \FALSE
	CALL DO-WALK,P?NORTH >STACK
	RSTACK

	.FUNCT JENNY-CLOTHES-F
	EQUAL? PRSA,V?REMOVE,V?RUB,V?TAKE /?L3
	EQUAL? PRSA,V?PICK,V?SEARCH,V?LOOK-INSIDE \?L1
?L3:	ZERO? END-GAME /?L4
	CALL PRINT-ID,STR?145
	CALL V-DIG
	RTRUE
?L4:	CALL DPRINT,JENNY
	PRINTI " flicks her feather boa into your face, tickling your nose. ""Quit that, honey."""
	CRLF
	CALL PRINT-ID,STR?146 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?LOOK-UNDER,V?RAISE \FALSE
	CALL NOT-PEEP >STACK
	RSTACK

	.FUNCT NOT-PEEP
	PRINTR "This is a sideshow, not a peep show."

	.FUNCT SPILL-BEANS?
	EQUAL? PRSA,V?GIVE,V?SHOW \?L4
	EQUAL? PRSO,CASE \?L4
	FSET? CASE,RMUNGBIT \?L4
	ZERO? GUARD-FELT-CASE \?L6
?L4:	EQUAL? PRSI,LION-CAGE,LION-NAME,STAND /?L5
	EQUAL? PRSI,CASE,NIMROD,GIRL \FALSE
?L5:	EQUAL? PRSA,V?TELL-ABOUT,V?ASK-ABOUT \?L7
	EQUAL? PRSO,HERM,JENNY,ANDREW \?L7
	FSET? CASE,RMUNGBIT /?L6
?L7:	EQUAL? PRSA,V?TELL-ABOUT \FALSE
	ZERO? GUARD-FELT-CASE /FALSE
?L6:	MOVE ANDREW,LOCAL-GLOBALS
	MOVE JENNY,LOCAL-GLOBALS
	MOVE HERM,LOCAL-GLOBALS
	SET 'FOLLOW-FLAG,6
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	ADD SCORE,10 >SCORE
	PRINTI "Jenny looks very pensive for a few moments. As the memory of events in which she unknowingly took part slowly dawns upon the hemisphere of her mind, a tear starts to well up in her eye, loads up with mascara, and spills down her cheek. "
	CALL HELD?,CASE >STACK
	ZERO? STACK /?L10
	MOVE CASE,ANDREW
	FSET CASE,INVISIBLE
	PRINTI "Andrew impulsively snatches the "
	CALL DPRINT,CASE
	PRINTI " from you. "
	CRLF
	CRLF
?L10:	PRINTR """Aha!"" squeals Jenny, as she seems to recollect more details of Andrew's dirty dealings. ""And you're supposed to meet later on with your fellow thugs at Katz's trailer, the big brute. Well you can just forget about it, Andrew!""

There ensues a hurly-burly struggle between the opposing personalities trapped within the one body. Jenny chases Andrew out of the sideshow amid shrieks of rage which echo down the midway."

	.FUNCT CASE-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "It is gilded with gold leaf and shows intricate design work on its face."
?L1:	ZERO? GUARD-FELT-CASE /FALSE
	IN? ANDREW,HERE \FALSE
	FSET? CASE,RMUNGBIT /FALSE
	EQUAL? PRSA,V?GIVE,V?SHOW \?L7
	EQUAL? PRSI,ANDREW,JENNY,HERM /?L6
?L7:	EQUAL? PRSA,V?ASK-ABOUT,V?TELL-ABOUT \FALSE
	EQUAL? PRSI,CASE \FALSE
	EQUAL? PRSO,ANDREW,JENNY,HERM \FALSE
?L6:	FSET CASE,RMUNGBIT
	PRINTI "As "
	CALL DPRINT,ANDREW
	PRINTI " realizes you know him to be the owner of the "
	CALL DPRINT,CASE
	PRINTR ", his eye gets wide, and then, behind his distinguished exterior, he begins to turn shades of purple."

	.FUNCT MIDEAST-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTR "You've reached the far end of the midway. A sideshow front to the north advertises the ""827 Pounds of Feminine Charm"" that is Tina."

	.FUNCT I-DRUNK
	INC 'DRUNK-COUNTER
	FCLEAR VOICES,INVISIBLE
	EQUAL? DRUNK-COUNTER,3 \?L1
	EQUAL? HERE,MIDWEST \?L1
	CRLF
	PRINTI "The "
	CALL DPRINT,DICK
	PRINTI " examines the label of the flask that he's holding then takes a slug."
	CRLF
	JUMP ?L5
?L1:	EQUAL? DRUNK-COUNTER,5 \?L5
	EQUAL? HERE,MIDWEST \?L11
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	SET 'FOLLOW-FLAG,11
	CRLF
	PRINTI "The pitchman gives the "
	CALL DPRINT,DICK
	PRINTI " a final slap on the back and leads him through the "
	CALL DPRINT,TURNSTILE
	PRINTI "."
	CRLF
?L5:	EQUAL? HERE,MIDWEST \?L11
	EQUAL? FOLLOW-FLAG,11 \FALSE
?L11:	MOVE CON,LOCAL-GLOBALS
	MOVE DICK,LOCAL-GLOBALS
	MOVE KIESTER,LOCAL-GLOBALS
	FSET VOICES,INVISIBLE
	CALL INT,I-DRUNK >STACK
	PUT STACK,0,0
	RTRUE

	.FUNCT CON-F
	EQUAL? CON,WINNER \?L1
	EQUAL? PRSA,V?TELL-ABOUT \?L3
	EQUAL? PRSO,ME \?L3
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,CON,PRSI
	SET 'WINNER,CON
	RTRUE
?L3:	EQUAL? PRSA,V?HELLO \?L5
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,CON
	SET 'WINNER,CON
	RTRUE
?L5:	EQUAL? PRSA,V?YES \?L6
	EQUAL? AWAITING-REPLY,8 \?L6
	CALL V-YES >STACK
	RSTACK
?L6:	EQUAL? PRSA,V?NO \?L7
	EQUAL? AWAITING-REPLY,8 \?L7
	CALL V-NO >STACK
	RSTACK
?L7:	PRINTR "He just grins, revealing a gold tooth."
?L1:	EQUAL? PRSA,V?LISTEN \?L11
	EQUAL? HERE,MIDWEST \?L11
	CALL PERFORM,V?LISTEN,VOICES
	RTRUE
?L11:	EQUAL? PRSA,V?EXAMINE \?L12
	EQUAL? HERE,MIDWEST \FALSE
	PRINTI "He's all smiles and solicitude toward the "
	CALL DPRINT,DICK
	PRINTR "."
?L12:	EQUAL? PRSA,V?ASK-ABOUT \?L18
	EQUAL? PRSO,CON \?L18
	EQUAL? PRSI,FLASK \?L19
	PRINTI "He takes a deep breath. ""Well, "
	CALL MAN-OR-WOMAN,STR?148,STR?147
	PRINTR ", step right up -- I don't care what's your sickness, I don't care what's draggin' you down, don't tell me 'cause I don't want to know whether it's pyorrhea, anorexia nervosa, sick headache, goiter, varicose veins, bilious derangements, nervous debility ..."" The pitchman realizes he's getting nowhere with you and turns his attention back to the detective."
?L19:	PRINTI """I don't know much about that,"" he "
	EQUAL? PRSI,GIRL \?L28
	CALL TELL-GRIN
	JUMP ?L30
?L28:	PRINTI "says."
?L30:	SET 'AWAITING-REPLY,8
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTI " ""But have you asked me about "
	CALL DPRINT,FLASK
	PRINTR "?"""
?L18:	EQUAL? PRSA,V?FOLLOW \FALSE
	EQUAL? FOLLOW-FLAG,7,11 \?L36
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L36:	EQUAL? FOLLOW-FLAG,15 \FALSE
	CALL DO-WALK,P?UP >STACK
	RSTACK

	.FUNCT CON-DESC,X
	EQUAL? HERE,MIDWEST \?L1
	PRINTI "Next to the "
	CALL DPRINT,BIGTOP
	PRINTI ", the "
	CALL DPRINT,DICK
	PRINTI " is talking to a pitchman who's carrying an open trunk that's strapped to his upper body."
	RTRUE
?L1:	CALL DPRINT,CON
	PRINTI " is here."
	RTRUE

	.FUNCT TELL-GRIN
	PRINTI "grins, revealing a gold tooth."
	RTRUE

	.FUNCT SMOKE-F
	EQUAL? PRSA,V?WALK-TO,V?THROUGH \FALSE
	CALL PERFORM,V?WALK-TO,POKER
	RTRUE

	.FUNCT BLUE-ROOM-F,RARG,?TMP
	EQUAL? RARG,M-ENTER \?L1
	INC 'BLUE-ROOM-ENTER-NUMBER
	FSET? DEALER,RMUNGBIT \?L3
	MOVE TICKET,DEALER
	CALL QUEUE,I-CHASE,-1 >STACK
	PUT STACK,0,1
?L3:	CALL QUEUE,I-BLUE-DOOR,1 >STACK
	PUT STACK,0,1
	PRINTI "As you enter, a blue haze of smoke stings your eyeballs."
	CRLF
	CRLF
	RTRUE
?L1:	EQUAL? RARG,M-LOOK \?L8
	PRINTI "In the far "
	CALL DPRINT,CORNER
	PRINTI " of this tented enclosure a thick, undulating cloud of smoke hovers over a "
	CALL DPRINT,POKER
	PRINTI ". Straight across from you a tight-jawed dealer stands over a "
	CALL DPRINT,TABLE
	PRINTR " covered with a green floor-length tablecloth."
?L8:	EQUAL? RARG,M-BEG \FALSE
	EQUAL? BLUE-ROOM-ENTER-NUMBER,1 /?L12
	FSET? DEALER,RMUNGBIT /?L12
	INC 'BOUNCE-C
	EQUAL? BOUNCE-C,1 \?L14
	ZERO? HELPED-THUMB /?L14
	FSET THUMB,NDESCBIT
	MOVE THUMB,HERE
	JUMP ?L18
?L14:	GRTR? BOUNCE-C,20 \?L18
	EQUAL? BLUE-ROOM-ENTER-NUMBER,2 \?L18
	CALL QUEUE,KICKED-OUT-FIRST-TIME,1 >STACK
	PUT STACK,0,1
	JUMP ?L18
?L12:	GRTR? CHASE-C,2 \?L18
	CALL TALKING-TO?,DEALER >STACK
	ZERO? STACK \?L19
	CALL TALKING-TO?,CON >STACK
	ZERO? STACK \?L19
	EQUAL? PRSA,V?SHOW,V?GIVE \?L18
	EQUAL? PRSI,CON,DEALER \?L18
?L19:	PRINTI "You get no response from him."
	CRLF
	SET 'P-CONT,0
	RTRUE
?L18:	EQUAL? PRSA,V?BET \FALSE
	FSET? DEALER,RMUNGBIT \?L25
	IN? DEALER,HERE \?L27
	PRINTI "He refuses to deal with you."
	CRLF
	CALL PRINT-ID,STR?149
	SET 'P-IT-OBJECT,DEALER
	RTRUE
?L27:	PRINTI "All bets are off."
	CRLF
	CALL PRINT-ID,STR?150
	RTRUE
?L25:	EQUAL? PRSO,DOLLAR /FALSE
	EQUAL? PRSO,GLOBAL-MONEY /?L37
	ZERO? P-AMOUNT /?L37
	ZERO? P-AMOUNT \?L35
?L37:	CALL SPECIFY-MONEY,1
	RETURN 2
?L35:	EQUAL? PRSO,INTNUM \?L40
	ZERO? P-DOLLAR-FLAG \?L40
	CALL SPECIFY-MONEY,1
	RETURN 2
?L40:	EQUAL? PRSO,INTNUM,DOLLAR /?L43
	PRINTI "You can only bet money."
	CRLF
	CALL PRINT-ID,STR?151
	RTRUE
?L43:	LESS? POCKET-CHANGE,P-AMOUNT \?L46
	PRINTI "You can't bet more than you have."
	CRLF
	CALL PRINT-ID,STR?152
	CALL STOP
	RTRUE
?L46:	GRTR? POCKET-CHANGE,30326 \?L49
	EQUAL? BLUE-ROOM-ENTER-NUMBER,2 \?L49
	PRINTI "The "
	CALL DPRINT,DEALER
	PRINTI " examines your winnings."
	CALL PRINT-ID,STR?153
	CALL EIGHTY-SIX
	RTRUE
?L49:	GRTR? 25,P-AMOUNT \?L52
	PRINTI """The minimum bet is 25 cents."""
	CRLF
	CALL PRINT-ID,STR?154
	CALL STOP
	RTRUE
?L52:	LESS? 200,P-AMOUNT \?L55
	PRINTI """No bets over 2 dollars. House rules."""
	CRLF
	CALL PRINT-ID,STR?155
	RTRUE
?L55:	ZERO? BET-ONCE \?L59
	PRINTI "The "
	CALL DPRINT,DEALER
	PRINTI " shuffles the four decks and breathes a sigh."
	CRLF
?L59:	SET 'BET-ONCE,1
	EQUAL? BLUE-ROOM-ENTER-NUMBER,2 /?L67
	ZERO? HELPED-THUMB /?L64
	GRTR? POCKET-CHANGE,23000 /?L67
	LESS? POCKET-CHANGE,401 \?L64
?L67:	SET 'BLUE-ROOM-ENTER-NUMBER,2
	SET 'FORCED-BET,1
	FSET THUMB,NDESCBIT
	MOVE THUMB,HERE
?L64:	SET '?TMP,POCKET-CHANGE
	CALL PLAY-HAND,P-AMOUNT >STACK
	ADD ?TMP,STACK >POCKET-CHANGE
	RTRUE

	.FUNCT KICKED-OUT-FIRST-TIME
	EQUAL? HERE,BLUE-ROOM \FALSE
	CRLF
	CALL DPRINT,CON
	PRINTI " suddenly emerges from the cloud of smoke in the "
	CALL DPRINT,CORNER
	PRINTI " and whispers something to the "
	CALL DPRINT,DEALER
	PRINTI ". "
	CALL EIGHTY-SIX >STACK
	RSTACK

	.FUNCT EIGHTY-SIX
	SET 'BOUNCE-C,25
	CALL INT,I-CHASE >STACK
	PUT STACK,0,0
	FCLEAR BLUE-DOOR,OPENBIT
	CALL INT,I-BLUE-DOOR >STACK
	PUT STACK,0,0
	PRINTI "The "
	CALL DPRINT,DEALER
	PRINTI " summarily eighty-sixes you from the room."
	CRLF
	CRLF
	CALL GOTO,NOOK >STACK
	RSTACK

	.FUNCT JOKE-TIME?,GLOB
	ZERO? GLOB \FALSE
	FSET? SHAWL,WORNBIT /TRUE
	FSET? DRESS,WORNBIT \FALSE
	RTRUE

	.FUNCT I-CHASE
	LESS? CHASE-C,4 \?L1
	EQUAL? HERE,BLUE-ROOM /?L1
	CALL INT,I-CHASE >STACK
	PUT STACK,0,0
	RFALSE
?L1:	INC 'CHASE-C
	EQUAL? CHASE-C,1 \?L4
	PRINTI "You notice a different dealer standing behind the "
	CALL DPRINT,TABLE
	PRINTI ". He is scrutinizing "
	CALL DPRINT,TICKET
	PRINTI "."
	CALL JOKE-TIME?,DEALER-JOKE >STACK
	ZERO? STACK /?L8
	SET 'DEALER-JOKE,1
	PRINTI " He glances at you and gives off a look that says, ""I've just about seen it all now."""
?L8:	CRLF
	RTRUE
?L4:	EQUAL? CHASE-C,2 \?L13
	MOVE BLACKJACK,LOCAL-GLOBALS
	MOVE DEALER,LOCAL-GLOBALS
	CRLF
	PRINTI "The "
	CALL DPRINT,DEALER
	PRINTI " gathers up the cards and disappears into the "
	CALL DPRINT,SMOKE
	PRINTR "."
?L13:	EQUAL? CHASE-C,3 \?L16
	MOVE CON,HERE
	MOVE DEALER,HERE
	CRLF
	PRINTI "You see the dealer approaching with "
	CALL DPRINT,CON
	PRINTR "."
?L16:	EQUAL? CHASE-C,4 \?L19
	MOVE CON,LOCAL-GLOBALS
	SET 'FOLLOW-FLAG,7
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-BLUE-DOOR,2 >STACK
	PUT STACK,0,1
	CRLF
	PRINTI "The pair of thugs hurry up to confront you. "
	IN? KIESTER,LOCAL-GLOBALS \?L22
	CALL EIGHTY-SIX
	RFALSE
?L22:	CALL HELD?,KIESTER >STACK
	ZERO? STACK /?L24
	MOVE KIESTER,LOCAL-GLOBALS
	PRINTI "Scuffling with you over the "
	CALL DPRINT,KIESTER
	PRINTI ", they manage to wrestle it away. "
	CALL DPRINT,CON
	PRINTI " shouts ""Hey Rube!"" then"
	JUMP ?L27
?L24:	CALL DPRINT,CON
	PRINTI " grabs the "
	CALL DPRINT,KIESTER
	PRINTI ","
	MOVE KIESTER,LOCAL-GLOBALS
?L27:	FSET? BLUE-DOOR,OPENBIT \?L30
	PRINTI " sights the open"
	JUMP ?L34
?L30:	PRINTI " throws open the"
	FSET BLUE-DOOR,OPENBIT
	CALL QUEUE,I-BLUE-DOOR,2 >STACK
	PUT STACK,0,1
?L34:	PRINTI " panel and bolts through the opening as the dealer "
	FSET? PINK-BOX,RMUNGBIT \?L39
	PRINTI "shoves you away"
	JUMP ?L43
?L39:	PRINTI "doubles you over with a punch to your midsection"
	CALL PRINT-ID,STR?156
?L43:	PRINT PERIOD
	RTRUE
?L19:	LESS? CHASE-C,8 \?L48
	EQUAL? HERE,NOOK \?L48
	SET 'CHASE-C,7
	SET 'FOLLOW-FLAG,15
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	CRLF
	PRINTR "You see the silhouette of a man on top of the cage. He throws something bulky onto the tent, then climbs up after it."
?L48:	GRTR? CHASE-C,12 \FALSE
	CALL INT,I-CHASE >STACK
	PUT STACK,0,0
	RTRUE

	.FUNCT DEALER-F
	CALL TALKING-TO?,DEALER >STACK
	ZERO? STACK \?L3
	EQUAL? PRSA,V?GIVE,V?SHOW \?L1
	EQUAL? PRSI,DEALER \?L1
?L3:	FSET? DEALER,RMUNGBIT \?L4
	PRINTI "This dealer is even less friendly than the first. He plain ignores you."
	CRLF
	JUMP ?L8
?L4:	PRINTI "Poker-faced and eagle-eyed, he doesn't "
	EQUAL? PRSA,V?HELLO \?L11
	PRINTI "acknowledge"
	JUMP ?L15
?L11:	PRINTI "respond"
?L15:	PRINTI ", but merely gestures for you to bet."
	CRLF
?L8:	CALL STOP >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?BET \?L20
	CALL PRINT-ID,STR?157
	CALL SPECIFY-MONEY,1 >STACK
	RSTACK
?L20:	CALL HURT?,DEALER >STACK
	ZERO? STACK /?L21
	PRINTI "He's bigger than you."
	CRLF
	CALL PRINT-ID,STR?158 >STACK
	RSTACK
?L21:	EQUAL? PRSA,V?WALK-TO,V?FOLLOW \FALSE
	IN? DEALER,HERE /FALSE
	EQUAL? HERE,BLUE-ROOM \FALSE
	CALL PERFORM,V?WALK-TO,POKER
	RTRUE

	.FUNCT WALK-INTO-CON
	PRINTI "As you approach, "
	CALL DPRINT,CON
	IN? CON,HERE /?L3
	PRINTI " appears and"
?L3:	PRINTI " intercepts you"
	CALL HELD?,KIESTER >STACK
	ZERO? STACK /?L10
	MOVE KIESTER,LOCAL-GLOBALS
	PRINTI ", snatching away the "
	CALL DPRINT,KIESTER
?L10:	PRINTI ". "
	RTRUE

	.FUNCT TABLE-F
	EQUAL? PRSA,V?RAISE,V?MOVE,V?LOOK-UNDER \?L3
	IN? THUMB,HERE \?L1
	CALL PERFORM,V?EXAMINE,THUMB
	RTRUE
?L1:	EQUAL? PRSA,V?RAISE,V?MOVE,V?LOOK-UNDER \?L3
	FSET? DEALER,RMUNGBIT \?L4
	FSET? KIESTER,TRYTAKEBIT \?L4
	MOVE KIESTER,HERE
	FCLEAR KIESTER,OPENBIT
	FSET KIESTER,LOCKEDBIT
	PRINT YOU-SEE
	PRINTI " what appears to be a suitcase under the "
	CALL DPRINT,TABLE
	PRINTR "."
?L4:	CALL V-LOOK-UNDER
	RTRUE
?L3:	EQUAL? PRSA,V?PUT-ON \FALSE
	EQUAL? PRSI,TABLE \FALSE
	EQUAL? PRSO,INTNUM \?L13
	ZERO? P-DOLLAR-FLAG \?L12
?L13:	EQUAL? PRSO,GLOBAL-MONEY \?L10
?L12:	CALL PERFORM,V?BET,PRSO
	RTRUE
?L10:	IN? DEALER,HERE \?L15
	CALL PERFORM,V?TAKE,BLACKJACK
	RTRUE
?L15:	CALL V-DIG >STACK
	RSTACK

	.FUNCT GEN-BLACKJACK-F
	RETURN BLACKJACK

	.FUNCT BLACKJACK-F
	EQUAL? PRSA,V?PLAY \?L1
	CALL PERFORM,V?PUT-ON,GLOBAL-MONEY,TABLE
	RTRUE
?L1:	EQUAL? PRSA,V?COUNT,V?EXAMINE \?L3
	PRINTR "Four decks are being used. They look clean."
?L3:	EQUAL? PRSA,V?TAKE \FALSE
	PRINTI "The dealer stays "
	CALL DPRINT,HANDS
	PRINTI "."
	CRLF
	CALL PRINT-ID,STR?159 >STACK
	RSTACK

	.FUNCT POKER-F
	EQUAL? PRSA,V?THROUGH,V?PLAY,V?WALK-TO \FALSE
	EQUAL? HERE,BLUE-ROOM \FALSE
	IN? DEALER,HERE \?L3
	PRINTI "The "
	CALL DPRINT,DEALER
	PRINTI " bars your way, indicating the "
	CALL DPRINT,POKER
	PRINTI "'s private. Considering the lack of oxygen at the table and the probability of marked cards, you wouldn't have survived long in the "
	CALL DPRINT,POKER
	PRINTI " anyway."
	CRLF
	CALL PRINT-ID,STR?160 >STACK
	RSTACK
?L3:	CALL WALK-INTO-CON
	CALL EIGHTY-SIX >STACK
	RSTACK

	.FUNCT KIESTER-F
	EQUAL? PRSA,V?CLOSE,V?OPEN,V?TAKE /?L3
	EQUAL? PRSA,V?PUT \FALSE
?L3:	IN? KIESTER,CON \?L4
	PRINTI "The "
	CALL DPRINT,JUNK
	PRINTI " klinks together as Billy nonchalantly pushes you away."
	CRLF
	EQUAL? PRSA,V?OPEN,V?TAKE /?L8
	PUSH 0
	JUMP ?L9
?L8:	PUSH 1
?L9:	CALL PRINT-ID,STR?161,STACK >STACK
	RSTACK
?L4:	FSET? KIESTER,TOUCHBIT /FALSE
	EQUAL? PRSA,V?TAKE \FALSE
	FCLEAR KIESTER,TRYTAKEBIT
	FSET KIESTER,TOUCHBIT
	MOVE KIESTER,PROTAGONIST
	PRINTI "As you lift it, you can hear a muffled scream from inside."
	CRLF
	CALL PRINT-ID,STR?162 >STACK
	RSTACK

	.FUNCT JUNK-F
	EQUAL? HERE,MIDWEST \FALSE
	EQUAL? PRSA,V?TAKE,V?BUY \FALSE
	CALL PERFORM,PRSA,FLASK
	RTRUE

	.FUNCT FLASK-F
	EQUAL? PRSA,V?CLOSE,V?OPEN \?L1
	PRINTR "There's no cap."
?L1:	EQUAL? PRSA,V?EXAMINE,V?LOOK-INSIDE \?L5
	PRINTR "It looks like pretty potent stuff."
?L5:	IN? DICK,MIDWEST \?L8
	ZERO? DICK-DRUNK \?L8
	EQUAL? PRSA,V?TAKE,V?DRINK,V?DRINK-FROM /?L11
	EQUAL? PRSA,V?MOVE,V?READ \?L9
?L11:	PRINTI "You're interfering with the hospitality that "
	CALL DPRINT,CON
	PRINTI " is paying the "
	CALL DPRINT,DICK
	PRINTI ". Billy shoves you away, and his "
	CALL DPRINT,JUNK
	PRINTI " clinks together in his "
	CALL DPRINT,KIESTER
	PRINTI "."
	CRLF
	CALL PRINT-ID,STR?163 >STACK
	RSTACK
?L9:	EQUAL? PRSA,V?BUY \FALSE
	PRINTI """I'm sorry, we're fresh out,"" the pitchman "
	CALL TELL-GRIN
	CRLF
	RTRUE
?L8:	EQUAL? PRSA,V?READ \?L18
	PRINTI "It's the usual ballyhoo for "
	CALL DPRINT,FLASK
	PRINTR "."
?L18:	EQUAL? PRSA,V?TAKE,V?DRINK,V?DRINK-FROM /?L22
	EQUAL? PRSA,V?MOVE,V?READ \FALSE
?L22:	IN? FLASK,JOEY \?L23
	CALL TAKE-FLASK-RAG
	RTRUE
?L23:	IN? FLASK,DICK \FALSE
	PRINTI "The "
	CALL DPRINT,DICK
	PRINTR ", being dead drunk, has a rigor mortis grip on it."

	.FUNCT RAG-F
	EQUAL? PRSA,V?TAKE \FALSE
	CALL TAKE-FLASK-RAG
	RTRUE

	.FUNCT TAKE-FLASK-RAG
	PRINTI "Chuckles pulls back"
	EQUAL? PRSA,V?TAKE /?L3
	PUSH 0
	JUMP ?L4
?L3:	PUSH 1
?L4:	CALL PRINT-ID,STR?164,STACK
	CALL ARTICLE,PRSO,1
	PRINTI ". "
	FSET? RAG,RMUNGBIT /?L7
	FSET RAG,RMUNGBIT
	PRINTI """Why do all the towners think they can get away with harassing us poor innocent clowns?"""
?L7:	CRLF
	RTRUE

	.FUNCT CIRCUS-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	EQUAL? HERE,STANDS-ROOM \FALSE
	PRINTR "How the crowd's enjoying a show that's so hard to see is hard to see."

	.FUNCT UNDER-STANDS-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You're standing between the underside of the "
	CALL DPRINT,GRANDSTAND
	PRINTI " and the side wall of the "
	CALL DPRINT,BIGTOP
	PRINTI ". Not unexpectedly, the "
	CALL DPRINT,GROUND
	PRINTI " here is strewn with garbage. The only exit is "
	ZERO? WON-STANDS /?L5
	PRINTI "back under the tent"
	JUMP ?L9
?L5:	PRINTI "southwest"
?L9:	PRINT PERIOD
	RTRUE

	.FUNCT EXIT-UNDER-STANDS
	EQUAL? P-WALK-DIR,P?SW \?L1
	ZERO? WON-STANDS /?L3
	PRINTI "The grandstand"
	PRINT TELL-STANDS
	PRINTI ", blocking the former exit."
	CRLF
	RFALSE
?L3:	RETURN WINGS
?L1:	FSET? BIGTOP,RMUNGBIT \?L12
	CALL PERFORM,V?CRAWL-UNDER,BIGTOP
	RFALSE
?L12:	PRINTI "You bump into the side wall of the "
	CALL DPRINT,BIGTOP
	PRINTI "."
	CRLF
	RFALSE

	.FUNCT NOT-UNDER-STANDS
	PRINTI "You're UNDER the stands, understand?"
	CRLF
	SET 'AWAITING-REPLY,7
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	RFALSE

	.FUNCT GARBAGE-F
	EQUAL? PRSA,V?EXAMINE,V?SEARCH-OBJECT-FOR,V?SEARCH /?L3
	EQUAL? PRSA,V?LOOK-UNDER,V?MOVE,V?DIG /?L3
	EQUAL? PRSA,V?LOOK-INSIDE \?L1
?L3:	IN? TICKET,LOCAL-GLOBALS \?L4
	MOVE TICKET,HERE
	SET 'P-IT-OBJECT,TICKET
	ADD SCORE,10 >SCORE
	PRINTI "Your foray into "
	CALL DPRINT,GARBAGE
	PRINTI " reclamation pays off, as you turn up the unmarked ticket of some luckless circus-goer."
	CRLF
	CALL PRINT-ID,STR?165 >STACK
	RSTACK
?L4:	IN? GRANOLA,LOCAL-GLOBALS \?L8
	FSET? GRANOLA,RMUNGBIT /?L8
	ZERO? WON-STANDS /?L8
	SET 'P-IT-OBJECT,GRANOLA
	MOVE GRANOLA,HERE
	PRINTI "Recalling the precise trajectory of your fallen "
	CALL DPRINT,GRANOLA
	PRINTI ", you uncover it after a brief excavation."
	CRLF
	CALL PRINT-ID,STR?166 >STACK
	RSTACK
?L8:	EQUAL? PRSA,V?EXAMINE /FALSE
	PRINTI "You merely raise a stench."
	CRLF
	CALL PRINT-ID,STR?167 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?CLEAN \?L15
	CALL V-DIG >STACK
	RSTACK
?L15:	EQUAL? PRSA,V?SMELL \FALSE
	PRINTI "It smells vaguely of "
	CALL PICK-ONE,FOODS >STACK
	PRINT STACK
	PRINTI " and "
	CALL PICK-ONE,FOODS >STACK
	PRINT STACK
	PRINTI "."
	CRLF
	CALL PRINT-ID,STR?168 >STACK
	RSTACK

	.FUNCT GRANDSTAND-F
	EQUAL? PRSA,V?EXAMINE \?L1
	EQUAL? HERE,UNDER-STANDS \?L1
	SET 'PRSO,ROOMS
	CALL PERFORM,V?LOOK-UP,PRSO
	RTRUE
?L1:	EQUAL? PRSA,V?THROUGH,V?CLIMB-FOO,V?CLIMB-UP /?L4
	EQUAL? PRSA,V?BOARD \?L3
?L4:	EQUAL? HERE,RING \?L5
	CALL DO-WALK,P?NORTH >STACK
	RSTACK
?L5:	CALL DO-WALK,P?UP >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?CLIMB-DOWN \?L8
	EQUAL? HERE,UNDER-STANDS \?L9
	CALL DO-WALK,P?UP >STACK
	RSTACK
?L9:	EQUAL? HERE,STANDS-ROOM \?L11
	CALL DO-WALK,P?DOWN >STACK
	RSTACK
?L11:	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L8:	EQUAL? PRSA,V?BOARD \FALSE
	EQUAL? HERE,UNDER-STANDS,WINGS \?L16
	CALL DO-WALK,P?UP >STACK
	RSTACK
?L16:	EQUAL? HERE,RING \?L18
	CALL DO-WALK,P?NORTH >STACK
	RSTACK
?L18:	PRINT LOOK-AROUND
	CRLF
	RTRUE

	.FUNCT STANDS-ROOM-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	ZERO? SIT-IN-STANDS /?L3
	PRINTI "You're in the ""blues,"" sitting"
	PRINT HIGH-ABOVE
	PRINTI ". "
?L3:	EQUAL? PRSA,V?WALK /?L8
	EQUAL? TLOC,12 /?L8
	PRINTI "You know the exit from the "
	CALL DPRINT,GRANDSTAND
	PRINTI " to be vaguely eastward and down. "
?L8:	PRINTI "All around you the crowd is in a state of pandemonium"
	ZERO? SIT-IN-STANDS \?L32
	PRINTI ". The paths of least resistance are "
	EQUAL? TLOC,3,9 \?L19
	GET PATHS,1 >STACK
	PRINT STACK
	JUMP ?L32
?L19:	EQUAL? TLOC,11 \?L23
	GET PATHS,5 >STACK
	PRINT STACK
	JUMP ?L32
?L23:	EQUAL? TLOC,8 \?L26
	GET PATHS,2 >STACK
	PRINT STACK
	JUMP ?L32
?L26:	EQUAL? TLOC,12 \?L29
	GET PATHS,6 >STACK
	PRINT STACK
	JUMP ?L32
?L29:	GET PATHS,TLOC >STACK
	PRINT STACK
?L32:	PRINT PERIOD
	RTRUE
?L1:	EQUAL? RARG,M-END \?L38
	FSET? HAWKER,RMUNGBIT \?L39
	EQUAL? TLOC,LOST-MONEY-LOC \?L39
	SET 'WON-STANDS,1
	ADD SCORE,10 >SCORE
	CRLF
	PRINTI "A man in the audience suddenly hails you, tossing the "
	CALL DPRINT,GRANOLA
	PRINTI " in your "
	CALL DPRINT,INTDIR
	PRINTI ". It glances off "
	CALL DPRINT,HEAD
	PRINTI ", falls through the stands and right before it hits the ground, in a cold sweat you "
	CALL WAKE-UP >STACK
	RSTACK
?L39:	EQUAL? TLOC,12 \?L43
	EQUAL? POCKET-CHANGE,1841 \?L43
	CRLF
	PRINTI "Suddenly a hawker appears at the end of the row and you flag him down. "
	MOVE HAWKER,HERE
	CALL HAWKER-GESTURES
	CRLF
	SET 'P-DOLLAR-FLAG,1
	SET 'P-AMOUNT,185
	CALL PERFORM,V?GIVE,INTNUM,HAWKER
	SET 'P-IT-OBJECT,GLOBAL-MONEY
	RTRUE
?L43:	RANDOM 100 >STACK
	LESS? 50,STACK /FALSE
	ZERO? SIT-IN-STANDS \FALSE
	CRLF
	PRINTI "The bank of people above you shouts, in chorus, """
	CALL PICK-ONE,BITCHES >STACK
	PRINT STACK
	PRINTR "!"""
?L38:	EQUAL? RARG,M-BEG \FALSE
	EQUAL? PRSA,V?WALK,V?SIT \?L51
	ZERO? SIT-IN-STANDS /?L51
	PRINTR "But you are seated."
?L51:	EQUAL? PRSA,V?SIT \FALSE
	PRINTI """Oof! Get off of me!"""
	CRLF
	CALL PRINT-ID,STR?169 >STACK
	RSTACK

	.FUNCT HAWKER-GESTURES
	PRINTR "The hawker can barely hear you above the crowd noise. He flashes one finger, then eight fingers, then five fingers at you, and gestures to pass the money through the crowd."

	.FUNCT I-STANDS
	CALL QUEUE,I-STANDS,-1 >STACK
	PUT STACK,0,1
	INC 'STANDS-C
	EQUAL? STANDS-C,12 \?L1
	EQUAL? HERE,STANDS-ROOM \?L1
	EQUAL? POCKET-CHANGE,1656 \?L1
	CRLF
	PRINTR "The audience settles back down to a state of pandemonium."
?L1:	IN? HAWKER,HERE \?L5
	EQUAL? HERE,STANDS-ROOM \?L5
	MOVE HAWKER,LOCAL-GLOBALS
	CRLF
	PRINTI "Trudging "
	RANDOM 100 >STACK
	LESS? 50,STACK /?L8
	PRINTI "down"
	SET 'HAWKER-DIRECTION,P?DOWN
	JUMP ?L12
?L8:	SET 'HAWKER-DIRECTION,P?UP
	PRINTI "up"
?L12:	SET 'FOLLOW-FLAG,17
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	PRINTI "ward, the hawker disappears into the "
	CALL DPRINT,CROWD
	EQUAL? PRSA,V?FOLLOW,V?WALK-TO \?L17
	PRINTI " before you can reach him"
?L17:	PRINT PERIOD
	RTRUE
?L5:	EQUAL? STANDS-C,2,3 \?L24
	CRLF
	PRINTI "You hear a loud "
	EQUAL? STANDS-C,2 \?L27
	PRINTI "growl"
	JUMP ?L31
?L27:	PRINTI "roar"
?L31:	PRINTR " nearby."
?L24:	EQUAL? STANDS-C,4 \?L36
	CRLF
	PRINTR "You realize the noise is your own stomach."
?L36:	EQUAL? STANDS-C,5 /?L40
	GRTR? STANDS-C,5 \FALSE
	RANDOM 100 >STACK
	LESS? 25,STACK /FALSE
	EQUAL? HERE,STANDS-ROOM \FALSE
	EQUAL? STANDS-C,11,12,13 /FALSE
?L40:	FSET HAWKER,NDESCBIT
	MOVE HAWKER,HERE
	CRLF
	PRINTI "A "
	CALL DPRINT,HAWKER
	PRINTI " appears at the "
	EQUAL? TLOC,1,2,3 /?L45
	EQUAL? TLOC,7,8,9 \?L43
?L45:	PRINTI "west"
	JUMP ?L48
?L43:	PRINTI "east"
?L48:	PRINTI " end of your row, calling out in a sing-song manner, ""Get your "
	CALL PICK-ONE,FOODS >STACK
	PRINT STACK
	PRINTI " here. Get your "
	CALL PICK-ONE,FOODS >STACK
	PRINT STACK
	PRINTR " here."""

	.FUNCT JUNK-FOOD-F
	EQUAL? PRSA,V?BUY \?L1
	EQUAL? HERE,STANDS-ROOM \?L5
	IN? HAWKER,HERE \?L3
	CALL PERFORM,V?TELL,HAWKER
	RTRUE
?L3:	EQUAL? HERE,STANDS-ROOM \?L5
	PRINTI "The "
	CALL DPRINT,HAWKER
	PRINTR "'s nowhere in sight."
?L5:	EQUAL? HERE,WINGS \?L8
	IN? HAWKER,HERE \?L8
	FSET? HAWKER,RMUNGBIT \?L9
	PRINTR """Sorry, I'm all sold out. I made a killing up there,"" he says, looking exhausted but happy."
?L9:	CALL PERFORM,V?TELL,HAWKER
	RTRUE
?L8:	EQUAL? HERE,CON-AREA \FALSE
	ZERO? DREAMING /FALSE
	PRINTR "You're not alone in your hunger."
?L1:	CALL DONT-HANDLE?,JUNK-FOOD >STACK
	ZERO? STACK \FALSE
	EQUAL? PRSA,V?ASK-ABOUT,V?ASK-FOR /FALSE
	EQUAL? HERE,WINGS \FALSE
	IN? HAWKER,HERE \FALSE
	PRINTI "The only remnant of the"
	EQUAL? JUNK-FOOD,PRSO \?L23
	CALL PRSO-PRINT
	JUMP ?L25
?L23:	CALL PRSI-PRINT
?L25:	PRINTI " is ground into the "
	CALL DPRINT,HAWKER
	PRINTR "'s uniform."

	.FUNCT HAWKER-F
	CALL PAY-HAWKER? >STACK
	ZERO? STACK /?L1
	EQUAL? FOLLOW-FLAG,99 \TRUE
	RETURN 2
?L1:	EQUAL? PRSA,V?WALK-TO,V?FOLLOW \?L8
	EQUAL? FOLLOW-FLAG,17 \?L8
	CALL DO-WALK,HAWKER-DIRECTION >STACK
	RSTACK
?L8:	EQUAL? PRSA,V?EXAMINE \?L9
	EQUAL? HERE,WINGS \?L9
	PRINTR "Yup, it's the same guy you encountered in the stands. He's empty-handed and his uniform resembles modern art, a besplattered canvas of condiments."
?L9:	EQUAL? PRSA,V?GIVE \?L12
	EQUAL? PRSI,HAWKER \?L12
	CALL PERFORM,V?WAVE-AT,HAWKER
	RTRUE
?L12:	EQUAL? HERE,STANDS-ROOM \?L13
	CALL TOUCHING?,HAWKER >STACK
	ZERO? STACK /?L13
	CALL CANT-REACH,HAWKER >STACK
	RSTACK
?L13:	CALL TALKING-TO?,HAWKER >STACK
	ZERO? STACK /FALSE
	EQUAL? HERE,STANDS-ROOM \?L18
	EQUAL? POCKET-CHANGE,1841 \?L15
	CALL QUEUE,I-STANDS,2 >STACK
	PUT STACK,0,1
	CALL HAWKER-GESTURES
	JUMP ?L31
?L15:	EQUAL? HERE,STANDS-ROOM \?L18
	EQUAL? PRSA,V?WAVE-AT \?L20
	PRINTI "He didn't notice you."
	CRLF
	JUMP ?L31
?L20:	PRINTI "The crowd noise completely drowns you out."
	CRLF
	JUMP ?L31
?L18:	EQUAL? POCKET-CHANGE,1281 \?L28
	FSET? HAWKER,RMUNGBIT \?L27
?L28:	PRINTI "Exhausted, he ignores you."
	CRLF
	JUMP ?L31
?L27:	FSET HAWKER,RMUNGBIT
	PRINTI """Hey, you're the one I passed the granola bar to in the "
	CALL DPRINT,GRANDSTAND
	PRINTI ". "
	ZERO? ORDERED-GRANOLA \?L34
	PRINTI "I know that's not what you ordered, but that's all I had left. "
?L34:	PRINTI "Well, the guy that was sitting next to you is holding the granola for you."""
	CRLF
?L31:	CALL STOP >STACK
	RSTACK

	.FUNCT CROWD-F
	EQUAL? PRSA,V?LISTEN \?L1
	EQUAL? HERE,STANDS-ROOM \?L1
	PRINTR "They're all madly screaming."
?L1:	EQUAL? PRSA,V?FOLLOW \?L5
	EQUAL? HERE,CON-AREA \?L6
	FSET? BESIDE-BIGTOP,TOUCHBIT /?L6
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L6:	EQUAL? HERE,WINGS \FALSE
	FSET? CON-AREA,TOUCHBIT /FALSE
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L5:	EQUAL? HERE,WINGS \?L12
	FSET? CON-AREA,TOUCHBIT \?L11
?L12:	EQUAL? HERE,CON-AREA \?L10
	CALL RUNNING?,I-BOOST >STACK
	ZERO? STACK /?L10
?L11:	CALL CROWD-GONE >STACK
	RSTACK
?L10:	CALL TALKING-TO?,CROWD >STACK
	ZERO? STACK /?L13
	PRINTI "You have neither the voice nor the talent to capture the "
	CALL DPRINT,CROWD
	PRINTI "'s attention."
	CRLF
	CALL STOP >STACK
	RSTACK
?L13:	CALL PAY-HAWKER? >STACK
	ZERO? STACK /?L16
	EQUAL? FOLLOW-FLAG,99 \TRUE
	RETURN 2
?L16:	EQUAL? PRSA,V?THROUGH \?L22
	EQUAL? HERE,MIDWEST \?L23
	CALL DO-WALK,P?NORTH >STACK
	RSTACK
?L23:	CALL V-WALK-AROUND >STACK
	RSTACK
?L22:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "Each member appears to have been born precisely one minute apart from the next."

	.FUNCT CROWD-GONE
	PRINTI "The "
	CALL DPRINT,CROWD
	PRINTI "'s gone "
	EQUAL? HERE,CON-AREA \?L3
	PRINTI "east"
	JUMP ?L7
?L3:	PRINTI "south"
?L7:	PRINT PERIOD
	RTRUE

	.FUNCT PAY-HAWKER?
	EQUAL? POCKET-CHANGE,1841 \FALSE
	IN? HAWKER,HERE \FALSE
	EQUAL? PRSI,HAWKER,CROWD \FALSE
	EQUAL? PRSA,V?GIVE \FALSE
	EQUAL? PRSO,INTNUM \?L3
	ZERO? P-DOLLAR-FLAG /?L3
	GRTR? P-AMOUNT,POCKET-CHANGE \?L5
	PRINT THAT-MUCH
	RTRUE
?L5:	EQUAL? P-AMOUNT,185 \?L20
	SET 'POCKET-CHANGE,1656
	MOVE HAWKER,LOCAL-GLOBALS
	SET 'STANDS-C,10
	SET 'LOST-MONEY-LOC,TLOC
	PRINTR "Your $1.85 is passed from hand to hand all the way down the row. As the hawker pockets your money, he's suddenly engulfed by the crowd, which erupts into a standing ovation. The state of riot panic continues for several anxious moments."
?L20:	ZERO? P-DOLLAR-FLAG /?L12
	PRINTR "The man seemed to indicate $1.85."
?L12:	EQUAL? PRSO,GLOBAL-MONEY,DOLLAR,INTNUM \FALSE
	SET 'FOLLOW-FLAG,99
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	CALL SPECIFY-MONEY
	RTRUE
?L3:	EQUAL? PRSO,GLOBAL-MONEY \FALSE
	SET 'P-DOLLAR-FLAG,1
	SET 'P-AMOUNT,185
	CALL PERFORM,V?GIVE,INTNUM,CROWD
	SET 'P-IT-OBJECT,GLOBAL-MONEY
	RTRUE

	.FUNCT N-OOF
	EQUAL? TLOC,2,4,5 /?L3
	EQUAL? TLOC,7,8,10 /?L3
	EQUAL? TLOC,11 \?L1
?L3:	CALL PLOW-F,1 >STACK
	RSTACK
?L1:	CALL NO-GO,1 >STACK
	RSTACK

	.FUNCT S-OOF
	EQUAL? TLOC,1,3,4 /?L3
	EQUAL? TLOC,6,7,9 /?L3
	EQUAL? TLOC,10,12 \?L1
?L3:	CALL PLOW-F >STACK
	RSTACK
?L1:	CALL NO-GO,2 >STACK
	RSTACK

	.FUNCT E-OOF
	EQUAL? TLOC,1,2,3 /?L3
	EQUAL? TLOC,7,8,9 \?L1
?L3:	CALL SCISSOR-F,1 >STACK
	RSTACK
?L1:	CALL NO-GO,3 >STACK
	RSTACK

	.FUNCT W-OOF
	EQUAL? TLOC,4,5,6 /?L3
	EQUAL? TLOC,10,11,12 \?L1
?L3:	CALL SCISSOR-F >STACK
	RSTACK
?L1:	CALL NO-GO,4 >STACK
	RSTACK

	.FUNCT NO-GO,NUM
	EQUAL? NUM,1,2 \?L1
	PRINTI "You have no "
	EQUAL? NUM,1 \?L5
	PRINTI "up"
	JUMP ?L9
?L5:	PRINTI "down"
?L9:	PRINTI "ward mobility here"
	JUMP ?L21
?L1:	PRINTI "The crowd is impenetrable to the "
	EQUAL? NUM,3 \?L17
	PRINTI "east"
	JUMP ?L21
?L17:	PRINTI "west"
?L21:	PRINT PERIOD
	RFALSE

	.FUNCT SCISSOR-F,EAST?=0
	FCLEAR STANDS-ROOM,TOUCHBIT
	ZERO? EAST? /?L1
	ADD TLOC,3 >TLOC
	JUMP ?L3
?L1:	SUB TLOC,3 >TLOC
?L3:	PRINTI "The row of legs pivots away as you scissor awkwardly past."
	CRLF
	CRLF
	RETURN STANDS-ROOM

	.FUNCT PLOW-F,UP?=0
	FCLEAR STANDS-ROOM,TOUCHBIT
	PRINTI "You plow your way "
	ZERO? UP? /?L3
	PRINTI "up"
	DEC 'TLOC
	JUMP ?L7
?L3:	PRINTI "down"
	INC 'TLOC
?L7:	PRINTI "ward through the crowd"
	EQUAL? TLOC,13 \?L12
	PRINTI " all the way into the wings."
	CRLF
	CRLF
	FSET? MONKEY,RMUNGBIT /?L16
	FSET MONKEY,RMUNGBIT
	FCLEAR WINGS,TOUCHBIT
	MOVE ROAR,LOCAL-GLOBALS
	MOVE HAWKER,LOCAL-GLOBALS
	CALL GOTO,WINGS
	CRLF
	FCLEAR MONKEY,NDESCBIT
	MOVE MONKEY,PROTAGONIST
	PRINTI "As you exhale a sigh of relief, a smallish and hairy animal inexplicably plops down upon you from the upper reaches of the "
	CALL DPRINT,BIGTOP
	PRINTI "."
	CRLF
	RFALSE
?L16:	RETURN WINGS
?L12:	PRINT PERIOD
	CRLF
	RETURN STANDS-ROOM

	.FUNCT BIGTOP-F
	EQUAL? PRSA,V?BOARD,V?CRAWL-UNDER \?L1
	EQUAL? HERE,MIDWEST /?L5
	EQUAL? HERE,UNDER-STANDS \?L3
	FSET? BIGTOP,RMUNGBIT \?L3
?L5:	PRINTI "You creep under the side wall of the "
	CALL DPRINT,BIGTOP
	EQUAL? HERE,UNDER-STANDS \?L8
	PRINTI ", right where you crawled in before"
?L8:	PRINT PERIOD
	CRLF
	FSET BIGTOP,RMUNGBIT
	EQUAL? HERE,UNDER-STANDS \?L15
	CALL GOTO,MIDWEST >STACK
	RSTACK
?L15:	CALL GOTO,UNDER-STANDS >STACK
	RSTACK
?L3:	EQUAL? HERE,FAT-EAST,FAT-WEST \?L18
	SET 'PRSO,FAT
	CALL TELL-HIT-HEAD >STACK
	RSTACK
?L18:	CALL TENT-BOUND >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?THROUGH,V?WALK-TO \?L20
	EQUAL? HERE,CON-AREA,WINGS,MIDWEST /?L23
	EQUAL? HERE,BESIDE-BIGTOP \?L21
?L23:	CALL DO-WALK,P?NORTH >STACK
	RSTACK
?L21:	EQUAL? HERE,WINGS,RING,DEN /?L25
	EQUAL? HERE,STANDS-ROOM,UNDER-STANDS \FALSE
?L25:	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L20:	EQUAL? PRSA,V?DISEMBARK,V?EXIT,V?LEAVE \?L29
	EQUAL? HERE,WINGS,RING \?L30
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L30:	EQUAL? HERE,DEN \?L32
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L32:	EQUAL? HERE,STANDS-ROOM,UNDER-STANDS \?L33
	CALL V-WALK-AROUND >STACK
	RSTACK
?L33:	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L29:	EQUAL? PRSA,V?EXAMINE \?L37
	EQUAL? HERE,FAT-EAST,FAT-WEST /?L50
	PRINTI "Soiled by endless miles of travel and heavily patched in places, the wide blue-and-white stripes nevertheless rise up to"
	FSET? HERE,INDOORSBIT \?L40
	PRINTR " meet at the top of the towering center pole."
?L40:	PRINTR " the black sky above."
?L37:	EQUAL? HERE,FAT-EAST,FAT-WEST \?L47
?L50:	EQUAL? PRSA,V?RAISE,V?LOOK-UNDER \?L47
	CALL NOT-PEEP >STACK
	RSTACK
?L47:	EQUAL? PRSA,V?REMOVE,V?TAKE \FALSE
	EQUAL? HERE,FAT-EAST,FAT-WEST \FALSE
	CALL KIND-OF-PERFORMER >STACK
	RSTACK

	.FUNCT CENTER-POLE-F
	CALL IS-NOUN?,W?SAWDUST >STACK
	ZERO? STACK /?L1
	SET 'PRSO,SAWDUST
	RFALSE
?L1:	CALL TOUCHING?,CENTER-POLE >STACK
	ZERO? STACK /?L3
	EQUAL? HERE,RING /?L3
	CALL CANT-REACH,CENTER-POLE >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?CLIMB-ON,V?CLIMB-UP,V?CLIMB-FOO \FALSE
	PRINTI "You barely get off the "
	CALL DPRINT,GROUND
	PRINTR " before you slide back down."

	.FUNCT RING-OBJECT-F
	CALL IS-NOUN?,W?SECOND >STACK
	ZERO? STACK /?L1
	CALL PERFORM,PRSA,LION-CAGE,PRSI
	RTRUE
?L1:	CALL GLOBAL-ROOM-F >STACK
	RSTACK

	.FUNCT BALLOON-F
	EQUAL? PRSA,V?TAKE \?L1
	FSET BALLOON,TOUCHBIT
	MOVE BALLOON,PROTAGONIST
	PRINTR "You grab the helium-filled balloon at the frill where it is tied. The balloon gives a constant upward tug at your fingertips."
?L1:	EQUAL? PRSA,V?EXAMINE \?L5
	PRINTI "It's a bright red balloon which is "
	FSET? BALLOON,OPENBIT \?L8
	PRINTI "untied"
	JUMP ?L12
?L8:	PRINTI "tied closed"
?L12:	PRINTR " and filled with helium."
?L5:	EQUAL? PRSA,V?PUT,V?THROW,V?DROP /?L18
	EQUAL? P-PRSA-WORD,W?FREE \?L17
?L18:	CALL BALLOON-FLIGHT
	CRLF
	RTRUE
?L17:	EQUAL? PRSA,V?OPEN,V?UNTIE \?L19
	CALL HELD?,BALLOON >STACK
	ZERO? STACK \?L20
	PRINT NOT-HOLDING
	PRINTI " the "
	CALL DPRINT,BALLOON
	PRINTR "."
?L20:	FSET? BALLOON,OPENBIT /?L24
	FSET BALLOON,OPENBIT
	PRINTI "You untie the end of the "
	CALL DPRINT,BALLOON
	PRINTR ", holding it closed."
?L24:	EQUAL? PRSA,V?OPEN \?L27
	FSET? BALLOON,OPENBIT \?L27
	FSET BALLOON,OPENBIT
	CALL BALLOON-FLIGHT
	CRLF
	RTRUE
?L27:	PRINTR "It isn't tied."
?L19:	EQUAL? PRSA,V?CLOSE,V?TIE \?L31
	ZERO? PRSI \?L31
	FSET? BALLOON,OPENBIT \?L32
	FCLEAR BALLOON,OPENBIT
	PRINTI "Okay, the "
	CALL DPRINT,BALLOON
	PRINTR " is once again tied closed."
?L32:	PRINTR "It is."
?L31:	EQUAL? PRSA,V?INHALE \?L39
	PRINTR "It would be safer to inhale what's IN the balloon."
?L39:	CALL HURT?,BALLOON >STACK
	ZERO? STACK /FALSE
	PRINTI "You manage to puncture it. "
	MOVE BALLOON,LOCAL-GLOBALS
	CALL BALLOON-FLIGHT
	CRLF
	RTRUE

	.FUNCT BALLOON-FLIGHT
	FSET BALLOON,TOUCHBIT
	MOVE BALLOON,LOCAL-GLOBALS
	FSET? BALLOON,OPENBIT /?L9
	CALL HURT?,BALLOON >STACK
	ZERO? STACK \?L9
	PRINTI "The "
	CALL DPRINT,BALLOON
	PRINTI " flies up and "
	FSET? HERE,INDOORSBIT /?L5
	PRINTI "disappears into the night sky."
	RTRUE
?L5:	PRINTI "gets punctured on the "
	CALL DPRINT,CEILING
	PRINTI ". "
?L9:	PRINTI "With helium spitting out of it, the fink zips wildly through the air and disappears. "
	RTRUE

	.FUNCT HELIUM-F
	EQUAL? PRSA,V?INHALE \?L1
	FSET? BALLOON,OPENBIT \?L3
	MOVE BALLOON,LOCAL-GLOBALS
	MOVE HELIUM,LOCAL-GLOBALS
	CALL QUEUE,I-HELIUM,2 >STACK
	PUT STACK,0,1
	PRINTI "The "
	CALL DPRINT,BALLOON
	PRINTI " shrinks rapidly before your eyes as your chest expands and tightens ... then it slips from your grasp! "
	CALL BALLOON-FLIGHT
	PRINTI "You manage to momentarily hold the helium in your lungs."
	CRLF
	PUTP PROTAGONIST,P?ACTION,PROTAGONIST-HACK-F
	RTRUE
?L3:	PRINTI "But the "
	CALL DPRINT,BALLOON
	PRINTR " is tied closed."
?L1:	EQUAL? PRSA,V?DROP \FALSE
	CALL V-COUNT >STACK
	RSTACK

	.FUNCT I-HELIUM
	CALL INT,I-HELIUM >STACK
	PUT STACK,0,0
	ZERO? SPEAK-HELIUM \FALSE
	CRLF
	PRINTI "You exhale your lungsful of helium."
	CRLF
	RFALSE

	.FUNCT NET-F,RARG=0
	EQUAL? RARG,M-BEG \?L1
	EQUAL? PRSA,V?WALK \?L5
	EQUAL? P-WALK-DIR,P?DOWN,P?OUT \?L3
	CALL PERFORM,V?DISEMBARK,NET
	RTRUE
?L3:	EQUAL? PRSA,V?WALK \?L5
	CALL OUT-OF-FIRST,NET >STACK
	RSTACK
?L5:	EQUAL? PRSA,V?LEAP \FALSE
	PRINTI "After bouncing about the net a while you appreciate that much more the talent of the "
	CALL DPRINT,BROS
	PRINTR " Brothers."
?L1:	ZERO? RARG \FALSE
	EQUAL? PRSA,V?BOARD \?L11
	IN? NET,MUNRAB \?L11
	PRINT BASKET-CASE
	CRLF
	RTRUE
?L11:	EQUAL? PRSA,V?TAKE \?L14
	IN? NET,MUNRAB \?L14
	CALL DPRINT,MUNRAB
	PRINTI " looks flustered then yanks the coarsely woven net out of "
	CALL DPRINT,HANDS
	PRINTI ". ""I'm in charge here!"""
	CRLF
	CALL PRINT-ID,STR?170 >STACK
	RSTACK
?L14:	CALL TOUCHING?,NET >STACK
	ZERO? STACK /?L17
	IN? NET,GLOBAL-OBJECTS \?L17
	CALL CANT-SEE,NET >STACK
	RSTACK
?L17:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L18
	CALL CANT-OPEN >STACK
	RSTACK
?L18:	EQUAL? PRSA,V?CLIMB-DOWN,V?DISEMBARK \FALSE
	LOC PROTAGONIST >STACK
	EQUAL? STACK,NET \FALSE
	MOVE PROTAGONIST,HERE
	PRINTI "You climb out of the "
	CALL DPRINT,NET
	PRINTR " with a bounce in your step."

	.FUNCT GLOBAL-NET-F
	CALL DONT-HANDLE?,GLOBAL-NET >STACK
	ZERO? STACK \FALSE
	IN? NET,LOCAL-GLOBALS /?L4
	IN? NET,GLOBAL-OBJECTS /?L4
	IN? NET,MUNRAB /?L5
	IN? NET,RING \?L3
?L5:	EQUAL? HERE,TIGHTROPE-ROOM,PLATFORM-1,PLATFORM-2 /?L3
?L4:	CALL CANT-SEE,0,STR?171 >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?EXAMINE,V?LOOK-INSIDE \?L6
	CALL PERFORM,V?LOOK-DOWN
	RTRUE
?L6:	EQUAL? PRSA,V?PUT \?L7
	EQUAL? PRSI,GLOBAL-NET \?L7
	CALL PERFORM,V?DROP,PRSO
	RTRUE
?L7:	EQUAL? PRSA,V?BOARD,V?THROUGH,V?LEAP \?L8
	SET 'HERE,PLATFORM-1
	CALL PERFORM,V?LEAP-OFF,PLATFORM
	RTRUE
?L8:	CALL TOUCHING?,GLOBAL-NET >STACK
	ZERO? STACK /FALSE
	CALL CANT-REACH,NET >STACK
	RSTACK

	.FUNCT GEN-NET
	RETURN GLOBAL-NET

	.FUNCT WINGS-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	EQUAL? POCKET-CHANGE,1281 \?L1
	FSET? LONG,RMUNGBIT \?L1
	ZERO? DREAMING /?L1
	CALL INT,I-STANDS >STACK
	PUT STACK,0,0
	FCLEAR HAWKER,NDESCBIT
	MOVE HAWKER,WINGS
	MOVE JUNK-FOOD,HAWKER
	RTRUE
?L1:	EQUAL? RARG,M-LOOK \?L3
	PRINTI "The "
	CALL DPRINT,BIGTOP
	PRINTI " can be entered to the north and exited to the south. "
	ZERO? WON-STANDS \?L8
	EQUAL? MEET-COUNTER,10 \?L6
	ZERO? DREAMING \?L6
?L8:	CRLF
	CRLF
?L6:	PRINTI "To the northeast, the grandstand"
	ZERO? WON-STANDS /?L12
	PRINT TELL-STANDS
	JUMP ?L19
?L12:	EQUAL? MEET-COUNTER,10 \?L16
	ZERO? DREAMING \?L16
	PRINTI " has been retracted slightly, revealing a passage"
	JUMP ?L19
?L16:	PRINTI " begins its precipitous rise"
?L19:	PRINT PERIOD
	RTRUE
?L3:	EQUAL? RARG,M-BEG \?L24
	EQUAL? PRSA,V?WAIT \?L24
	PRINTI "Very theatrical of you, waiting in the wings. Expect no awards, however. "
	RFALSE
?L24:	EQUAL? RARG,M-END \FALSE
	EQUAL? MEET-COUNTER,10 /?L28
	FSET? POLE,TOUCHBIT \?L27
?L28:	FSET? PLATFORM-2,TOUCHBIT /?L27
	ZERO? DREAMING \?L27
	IN? NET,RING \?L27
	FSET? WEST-CAMP,TOUCHBIT /?L27
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	SET 'FOLLOW-FLAG,14
	SET 'P-IT-OBJECT,JIM
	MOVE NET,LOCAL-GLOBALS
	FCLEAR RING,TOUCHBIT
	CRLF
	PRINTI "A roustabout who is wearing a "
	CALL DPRINT,HEADPHONES
	PRINTI " and carrying a large net over his shoulder passes you and exits the "
	CALL DPRINT,BIGTOP
	PRINTR "."
?L27:	EQUAL? RARG,M-END \FALSE
	CALL MONKEY-ACTS? >STACK
	ZERO? STACK \FALSE
	RFALSE

	.FUNCT RING-ENTER
	ZERO? DREAMING /?L1
	PRINTI "You are immediately driven out of the ring by a rousing chorus of boos."
	CRLF
	RFALSE
?L1:	RETURN RING

	.FUNCT STANDS-ENTER
	EQUAL? MEET-COUNTER,10 \?L1
	ZERO? DREAMING \?L13
	ZERO? WON-STANDS \?L1
	EQUAL? P-WALK-DIR,P?UP \?L3
	CALL WALK-INTO-STANDS
	RFALSE
?L3:	RETURN UNDER-STANDS
?L1:	ZERO? DREAMING /?L6
?L13:	CALL HELD?,MONKEY >STACK
	ZERO? STACK /?L7
	CALL MONKEY-DIRECTION
	RFALSE
?L7:	SET 'TLOC,12
	PRINTI "You forge ahead and up the steps."
	CRLF
	CRLF
	RETURN STANDS-ROOM
?L6:	CALL WALK-INTO-STANDS
	RFALSE

	.FUNCT MONKEY-DIRECTION
	PRINTI "Agitated by your choice of "
	CALL DPRINT,INTDIR
	PRINTI ", the "
	CALL DPRINT,MONKEY
	PRINTR " steers you away from it."

	.FUNCT WALK-INTO-STANDS
	PRINTI "Climbing up into the deserted and littered grandstands produces a disorienting sense of deja vu. You make a headachy descent down the steps."
	CRLF
	RFALSE

	.FUNCT RING-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "This is the arena's oval-shaped performance ring"
	ZERO? END-GAME \?L5
	PRINTI " which "
	IN? NET,RING \?L9
	PRINTI "is occupied by a sagging, rectangular "
	JUMP ?L13
?L9:	PRINTI "appears deathly quiet without its circus atmosphere. Also missing is its "
?L13:	CALL DPRINT,NET
	PRINTI ". A rope ladder dangles to within a foot of the "
	CALL DPRINT,GROUND
	PRINTI "."
	JUMP ?L18
?L5:	PRINTI ". "
	CALL TANGLED-ROPE
?L18:	CRLF
	CRLF
	PRINTI "Just west lies the entrance to a large, round cage that completely encircles the second of the two rings. To the south the "
	CALL DPRINT,BIGTOP
	PRINTI "'s vaulted wing leads out into the open air. The arena's rickety grandstands rise steeply north and east."
	ZERO? END-GAME /?L23
	CALL TELL-APE
?L23:	CRLF
	RTRUE
?L1:	EQUAL? RARG,M-BEG \?L26
	IN? NET,MUNRAB \?L26
	EQUAL? PRSA,V?TELL,V?YELL,V?ASK-ABOUT /?L27
	EQUAL? PRSA,V?REPLY,V?HELLO,V?TELL-ABOUT \?L26
?L27:	SET 'P-CONT,0
	PRINTR "You're hardly recognized above the commotion."
?L26:	EQUAL? RARG,M-ENTER \FALSE
	ZERO? END-GAME /?L31
	MOVE APE,RING
	IN? NET,MUNRAB /FALSE
	MOVE NET,GLOBAL-OBJECTS
	RFALSE
?L31:	EQUAL? P-WALK-DIR,P?EAST,P?OUT \?L37
	IN? ELSIE,CHUTE \?L37
	IN? STAND,DEN \?L37
	MOVE STAND,RING
	FCLEAR STAND,VEHBIT
	FSET STAND,NDESCBIT
?L37:	IN? MEAT,DEN \?L40
	MOVE MEAT,LOCAL-GLOBALS
	CALL MOVE-LIONS,RING
	PRINT EXIT-DEN
	PRINTI "s together finish off the meat and settle back on the "
	CALL DPRINT,SAWDUST
	PRINTI "."
	CRLF
	CRLF
	SET 'ELSIE-COUNTER,0
	RTRUE
?L40:	EQUAL? P-WALK-DIR,P?EAST,P?OUT \FALSE
	IN? ELSIE,DEN \FALSE
	IN? MEAT,DEN /FALSE
	CALL INT,I-LION >STACK
	PUT STACK,0,0
	PRINT EXIT-DEN
	IN? MEAT,CHUTE \?L47
	FSET? GRATE,OPENBIT \?L47
	PRINTI "s slink out through the open grate."
	CALL QUEUE,I-LION,-1 >STACK
	PUT STACK,0,1
	CALL MOVE-LIONS,CHUTE
	JUMP ?L51
?L47:	ZERO? ELSIE-COUNTER \?L52
	PRINTI "s quit"
	JUMP ?L56
?L52:	PRINTI " quits"
?L56:	PRINTI " pacing and hunker"
	GRTR? ELSIE-COUNTER,0 \?L61
	PRINTI "s"
?L61:	PRINTI " back down onto the sawdust."
	SET 'ELSIE-COUNTER,0
	CALL MOVE-LIONS,RING
?L51:	CRLF
	CRLF
	RTRUE

	.FUNCT WING-EXIT
	CALL HELD?,STAND >STACK
	ZERO? STACK /?L1
	PRINTI "The "
	CALL DPRINT,STAND
	PRINTI " is too bulky to be carried that distance."
	CRLF
	RFALSE
?L1:	RETURN WINGS

	.FUNCT TANGLED-ROPE,TOUCHING??1=0
	PRINTI "The rope ladder"
	EQUAL? HERE,RING \?L3
	PRINTI " above "
	CALL DPRINT,HEAD
?L3:	PRINTI " has been tangled around the platform from which it hangs."
	ZERO? TOUCHING??1 /FALSE
	CRLF
	RTRUE

	.FUNCT TELL-APE
	EQUAL? PRSA,V?LOOK-UP /?L1
	CRLF
	CRLF
?L1:	EQUAL? APE-LOC,1 \?L4
	PRINTI "Craning your neck upward, you see "
	CALL DPRINT,APE
	PRINTI " standing on the platform above the rope "
	CALL DPRINT,LADDER
	JUMP ?L11
?L4:	EQUAL? APE-LOC,2 \?L8
	PRINTI "The shadowy form of the great ape is ensconced among the guy wires above the tightrope"
	JUMP ?L11
?L8:	CALL DPRINT,APE
	PRINTI " stands "
	EQUAL? HERE,TIGHTROPE-ROOM,PLATFORM-1 \?L14
	PRINTI "across from you "
?L14:	PRINTI "on the opposite platform, one of his great limbs grasping a guy wire for balance"
?L11:	PRINTI ". He is holding the limp form of a small girl under one arm."
	RTRUE

	.FUNCT STOOL-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "One leg of the "
	CALL DPRINT,STOOL
	PRINTR " is shorter than the other two."
?L1:	EQUAL? PRSA,V?STAND-ON,V?BOARD \?L5
	PRINTR "It's too rickety to support your weight."
?L5:	EQUAL? PRSA,V?TAKE-OFF \FALSE
	CALL PERFORM,V?DISEMBARK,STOOL
	RTRUE

	.FUNCT PLATFORM-1-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	CALL PLATFORM-ROOM-DESC
	ZERO? END-GAME /?L3
	CALL TELL-APE
?L3:	CRLF
	RTRUE
?L1:	EQUAL? RARG,M-ENTER \FALSE
	ZERO? END-GAME /FALSE
	MOVE APE,PLATFORM-1
	RTRUE

	.FUNCT CLIMB-GUY
	CALL PERFORM,V?CLIMB-ON,GUY-WIRES
	RFALSE

	.FUNCT PLATFORM-2-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	CALL PLATFORM-ROOM-DESC
	ZERO? END-GAME /?L3
	CALL TELL-APE
?L3:	CRLF
	RTRUE

	.FUNCT PLATFORM-ROOM-DESC
	PRINTI "You're standing on a small, unstable platform which is suspended"
	PRINT HIGH-ABOVE
	PRINTI " by guy wires converging on it from all directions. "
	EQUAL? HERE,PLATFORM-1 \?L3
	PRINTI "A rope ladder dangles from the platform and t"
	JUMP ?L7
?L3:	PRINTI "T"
?L7:	PRINTI "he tightrope stretches "
	EQUAL? HERE,PLATFORM-1 \?L12
	PRINTI "east"
	JUMP ?L16
?L12:	PRINTI "west"
?L16:	PRINTI " to the opposite platform"
	EQUAL? APE-LOC,3 \?L21
	PRINTI " where the attention of everyone in the "
	CALL DPRINT,BIGTOP
	PRINTI " is focused"
?L21:	PRINTI "."
	RTRUE

	.FUNCT TIGHTROPE-ROOM-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "You are standing, "
	CALL HELD?,POLE >STACK
	ZERO? STACK /?L5
	PRINTI "poised"
	JUMP ?L9
?L5:	PRINTI "perched "
	CALL PICK-ONE,DANGERS >STACK
	PRINT STACK
?L9:	PRINT HIGH-ABOVE
	PRINTI ", "
	GET ROPES,ON-ROPE >STACK
	PRINT STACK
	PRINTI " across the "
	CALL DPRINT,TIGHTROPE-OBJECT
	PRINTI "."
	ZERO? END-GAME /?L14
	CALL TELL-APE
?L14:	CRLF
	RTRUE
?L1:	EQUAL? RARG,M-BEG \?L17
	EQUAL? PRSA,V?WEAR,V?LEAP-OFF,V?LEAP /?L20
	EQUAL? PRSA,V?WALK \?L21
	EQUAL? P-WALK-DIR,P?DOWN /?L20
?L21:	EQUAL? PRSA,V?THROW,V?DROP \FALSE
	EQUAL? PRSO,POLE \FALSE
?L20:	PRINT UNBALANCED
	CALL FLYING
	PRINTI "And you fall ..."
	CALL FALL-DOWN >STACK
	RSTACK
?L17:	EQUAL? RARG,M-ENTER \FALSE
	ZERO? END-GAME /FALSE
	MOVE APE,TIGHTROPE-ROOM
	RTRUE

	.FUNCT TIGHTROPE-OBJECT-F
	EQUAL? HERE,RING \?L1
	CALL TOUCHING?,TIGHTROPE-OBJECT >STACK
	ZERO? STACK /?L1
	CALL CANT-REACH,TIGHTROPE-OBJECT >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?TAKE,V?CLIMB-ON \?L3
	PRINT NO-TALENT
	CRLF
	RTRUE
?L3:	EQUAL? PRSA,V?WALK-TO,V?BOARD,V?THROUGH /?L7
	EQUAL? PRSA,V?CLIMB-ON \FALSE
?L7:	EQUAL? HERE,PLATFORM-1,PLATFORM-2,TIGHTROPE-ROOM \FALSE
	EQUAL? HERE,PLATFORM-1 /?L10
	ZERO? HEADING-EAST? /?L8
?L10:	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L8:	EQUAL? HERE,PLATFORM-2 /?L12
	EQUAL? HERE,TIGHTROPE-ROOM \FALSE
	ZERO? HEADING-EAST? \FALSE
?L12:	CALL DO-WALK,P?WEST >STACK
	RSTACK

	.FUNCT GUY-WIRES-F
	CALL SEE-WIRES? >STACK
	ZERO? STACK \?L1
	CALL CANT-SEE,0,STR?172
	CALL STOP >STACK
	RSTACK
?L1:	EQUAL? HERE,PLATFORM-1,PLATFORM-2 /?L3
	CALL TOUCHING?,GUY-WIRES >STACK
	ZERO? STACK /?L3
	CALL CANT-REACH,GUY-WIRES >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?SHAKE,V?CLIMB-FOO,V?CLIMB-UP /?L5
	EQUAL? PRSA,V?MOVE,V?CLIMB-ON \FALSE
?L5:	EQUAL? APE-LOC,2 \?L6
	SET 'APE-LOC,3
	PRINTI "You're not very good at aping "
	CALL DPRINT,APE
	PRINTI " in this respect, but the vibrations of your attempt serve to flush him from his perch among the guy wires and onto the opposite platform."
	CALL META-LOC,RADIO >STACK
	EQUAL? STACK,PLATFORM-2 \?L10
	PRINTI " ""Crunch!"""
?L10:	CRLF
	RTRUE
?L6:	EQUAL? PRSA,V?MOVE,V?SHAKE /FALSE
	PRINT NO-TALENT
	CRLF
	RTRUE

	.FUNCT SEE-WIRES?
	EQUAL? HERE,PLATFORM-1,PLATFORM-2,TIGHTROPE-ROOM /TRUE
	EQUAL? HERE,RING \FALSE
	RTRUE

	.FUNCT PLATFORM-F
	CALL IS-ADJ?,W?OPPOSITE >STACK
	ZERO? STACK /?L1
	EQUAL? PRSA,V?THROUGH,V?WALK-TO \?L3
	ZERO? HEADING-EAST? \?L7
	EQUAL? HERE,PLATFORM-1 \?L5
?L7:	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L5:	EQUAL? HERE,PLATFORM-2 \FALSE
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L3:	CALL TOUCHING?,PLATFORM >STACK
	ZERO? STACK /FALSE
	CALL CANT-REACH,PLATFORM >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?LOOK-ON \?L12
	EQUAL? HERE,PLATFORM-1,PLATFORM-2 \?L12
	CALL V-LOOK
	RTRUE
?L12:	EQUAL? PRSA,V?PUT-ON \?L13
	EQUAL? HERE,PLATFORM-1,PLATFORM-2 \?L14
	CALL PERFORM,V?DROP,PRSO
	RTRUE
?L14:	CALL CANT-REACH,PLATFORM >STACK
	RSTACK
?L13:	EQUAL? PRSA,V?BOARD,V?WALK-TO,V?THROUGH \?L17
	EQUAL? HERE,PLATFORM-1,PLATFORM-2 \?L18
	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L18:	EQUAL? HERE,TIGHTROPE-ROOM \?L22
	ZERO? HEADING-EAST? /?L23
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L23:	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L22:	CALL CANT-SEE,PLATFORM >STACK
	RSTACK
?L17:	EQUAL? PRSA,V?LEAP-OFF,V?LEAP \FALSE
	EQUAL? HERE,TIGHTROPE-ROOM \?L28
	EQUAL? PRSA,V?LEAP-OFF \?L28
	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L28:	PRINT UNBALANCED
	CALL FLYING
	PRINTI "And you fall ..."
	CALL FALL-DOWN >STACK
	RSTACK

	.FUNCT PLATFORM-EXIT-F
	EQUAL? APE-LOC,2 \?L1
	CALL DPRINT,APE
	PRINTI ", perched above you, is restless enough to make the "
	CALL DPRINT,TIGHTROPE-OBJECT
	PRINTI " too herky-jerky to walk across."
	CRLF
	RFALSE
?L1:	FSET? SUIT,WORNBIT /?L6
	FSET? DRESS,WORNBIT \?L5
?L6:	PRINTI "You're not dressed for wire-walking."
	CRLF
	RFALSE
?L5:	CALL HELD?,POLE >STACK
	ZERO? STACK \?L9
	ZERO? END-GAME \?L9
	RANDOM 3 >STACK
	ADD 2,STACK >STACK
	CALL QUEUE,I-TREMBLE,STACK >STACK
	PUT STACK,0,1
?L9:	EQUAL? P-WALK-DIR,P?EAST \?L11
	SET 'HEADING-EAST?,1
	JUMP ?L13
?L11:	SET 'HEADING-EAST?,0
?L13:	SET 'ON-ROPE,1
	FCLEAR TIGHTROPE-ROOM,TOUCHBIT
	RETURN TIGHTROPE-ROOM

	.FUNCT I-TREMBLE
	INC 'TREMBLE-C
	CALL QUEUE,I-TREMBLE,-1 >STACK
	PUT STACK,0,1
	EQUAL? TREMBLE-C,4 \?L1
	PRINTI "You're really fighting it now, the high wire starts acting like a jump rope. "
	CALL FLYING
	CRLF
	CALL PICK-ONE,FALL-GAG >STACK
	PRINT STACK
	PRINTI " right before you plummet ..."
	CALL FALL-DOWN >STACK
	RSTACK
?L1:	GRTR? TREMBLE-C,1 \?L9
	EQUAL? PRSA,V?LEAN /?L9
	PRINTI "You're still out of balance, "
	CALL PICK-ONE,LEANS >STACK
	PRINT STACK
	PRINTI " now, to the "
	ZERO? LEAN-NORTH? /?L12
	PRINTR "north."
?L12:	PRINTR "south."
?L9:	EQUAL? TREMBLE-C,1 \FALSE
	PRINTI "You find "
	CALL DPRINT,ME
	CALL LEANING
	RANDOM 100 >STACK
	LESS? 50,STACK /?L22
	CALL LEAN,1 >STACK
	RSTACK
?L22:	CALL LEAN >STACK
	RSTACK

	.FUNCT LEANING
	PRINTI " leaning "
	CALL PICK-ONE,LEANS >STACK
	PRINT STACK
	PRINTI " to the"
	RTRUE

	.FUNCT LEAN,NORTH?=0
	ZERO? NORTH? /?L1
	PRINTI " north"
	SET 'LEAN-NORTH?,1
	JUMP ?L5
?L1:	PRINTI " south"
	SET 'LEAN-NORTH?,0
?L5:	PRINT PERIOD
	RTRUE

	.FUNCT FLYING,OBJ
	FIRST? PROTAGONIST >OBJ \FALSE
	NEXT? OBJ >STACK \?L3
	PRINTI "Everything you're holding"
	JUMP ?L7
?L3:	PRINTI "Oops,"
	CALL ARTICLE,OBJ,1
?L7:	PRINTI " goes flying. "
	RTRUE

	.FUNCT FALL-DOWN
	CALL INT,I-TREMBLE >STACK
	PUT STACK,0,0
	SET 'TREMBLE-C,0
	SET 'LEAN-NORTH?,0
	FCLEAR TIGHTROPE-OBJECT,RMUNGBIT
	FCLEAR TIGHTROPE-ROOM,TOUCHBIT
	CALL CARRIAGE-RETURNS,14
	IN? NET,MUNRAB \?L1
	CALL PRINT-ID,STR?173
	CALL JIGS-UP,1,STR?174 >STACK
	RSTACK
?L1:	IN? NET,RING /?L3
	CALL PRINT-ID,STR?175
	CALL JIGS-UP,1,STR?176
	RTRUE
?L3:	SET 'HERE,RING
	CALL ROB,PROTAGONIST,RING
	MOVE PROTAGONIST,NET
	PRINTI "... deeply into the "
	CALL DPRINT,NET
	PRINTR ", which heaves you high into the air ... then  catches you back down."

	.FUNCT ACROSS-ROPE
	EQUAL? P-WALK-DIR,P?WEST \?L4
	ZERO? HEADING-EAST? \?L3
?L4:	EQUAL? P-WALK-DIR,P?EAST \?L1
	ZERO? HEADING-EAST? \?L1
?L3:	ZERO? END-GAME /?L5
	EQUAL? ON-ROPE,1 \?L7
	SET 'ON-ROPE,5
	JUMP ?L11
?L7:	EQUAL? ON-ROPE,2 \?L9
	SET 'ON-ROPE,4
	JUMP ?L11
?L9:	EQUAL? ON-ROPE,4 \?L10
	SET 'ON-ROPE,2
	JUMP ?L11
?L10:	EQUAL? ON-ROPE,5 \?L11
	SET 'ON-ROPE,1
?L11:	ZERO? HEADING-EAST? /?L13
	SET 'HEADING-EAST?,0
	JUMP ?L15
?L13:	SET 'HEADING-EAST?,1
?L15:	PRINTI "A daring turnaround on the tightrope! You regain your balance."
	CRLF
	RFALSE
?L5:	PRINTI "A bold attempt to excite the arena seats! "
	CALL FLYING
	PRINTI "You sink ..."
	CALL FALL-DOWN
	RFALSE
?L1:	CALL RUNNING?,I-TREMBLE >STACK
	ZERO? STACK /?L23
	ZERO? TREMBLE-C \?L24
	PRINTI "A quiver shoots through your leading foot,"
	JUMP ?L31
?L24:	EQUAL? TREMBLE-C,2,3 \?L28
	PRINTI "Your trailing foot begins to quake,"
	JUMP ?L31
?L28:	PRINTI "You're too unstable."
	CRLF
	RFALSE
?L31:	PRINTI " stopping you dead on the wire."
	CRLF
	RFALSE
?L23:	EQUAL? ON-ROPE,5 /?L36
	INC 'ON-ROPE
	PRINTI "You take a couple of tentative steps across the wire"
	EQUAL? ON-ROPE,3 \?L39
	PRINTI ", reaching the halfway point"
?L39:	EQUAL? APE-LOC,3 \?L44
	ZERO? HEADING-EAST? /?L44
	EQUAL? ON-ROPE,2 \?L46
	PRINTI ". "
	CALL DPRINT,APE
	PRINTI " lets out an aggressive scream that echoes throughout the "
	CALL DPRINT,BIGTOP
	PRINTI "."
	JUMP ?L67
?L46:	EQUAL? ON-ROPE,3 \?L50
	PRINTI ". The gorilla raps his knuckles against his mighty chest. You can feel the vibration on your toes."
	JUMP ?L67
?L50:	EQUAL? ON-ROPE,4 \?L53
	CALL HELD?,RADIO >STACK
	ZERO? STACK /?L54
	EQUAL? STATION,1170 \?L54
	FSET? RADIO,ONBIT \?L54
	ZERO? CALLED-STATION /?L54
	PRINTI ". As the heavenly music drifts to within earshot of "
	CALL DPRINT,APE
	PRINTI ", the beast is becalmed, and he loosens his grip on the girl."
	JUMP ?L67
?L54:	PRINTI ". "
	CALL DPRINT,APE
	PRINTI " appears determined to bring down the "
	CALL DPRINT,BIGTOP
	PRINTI " if you take one more step."
	JUMP ?L67
?L53:	EQUAL? ON-ROPE,5 \FALSE
	CALL HELD?,RADIO >STACK
	ZERO? STACK /?L62
	EQUAL? STATION,1170 \?L62
	FSET? RADIO,ONBIT \?L62
	ZERO? CALLED-STATION /?L62
	SET 'APE-LOC,4
	CALL ROB,PROTAGONIST,LOCAL-GLOBALS
	CALL MOVE-TAKEBIT,RING,WINGS
	CALL ROB,RING,LEFT-HANGING
	MOVE GIRL,LEFT-HANGING
	MOVE THUMB,LEFT-HANGING
	MOVE GANG,LEFT-HANGING
	MOVE MUNRAB,LEFT-HANGING
	SET 'END-GAME-C,0
	MOVE TIGHTROPE-OBJECT,LEFT-HANGING
	PRINTI ". You are now almost close enough to reach out and touch "
	CALL DPRINT,APE
	PRINTI ", and the effect of the music is to utterly relax the great ape. He lets loose the girl like a rag doll ... falling ... falling ... falling ... deep into the safety of the net!

The cheers of joy and relief from the group encircling the net interrupt "
	CALL DPRINT,APE
	PRINTI "'s listening pleasure. With a stomp, he bounces you off your perch and on your way down, you catch the wire with "
	CALL DPRINT,HANDS
	PRINTI ", thus saving two lives in the same move. You dangle here as the crowd below continues their self-congratulation and rejoicing."
	CRLF
	CRLF
	FSET MUNRAB,NDESCBIT
	FSET THUMB,NDESCBIT
	SET 'POCKET-CHANGE,0
	ADD SCORE,10 >SCORE
	CALL GOTO,LEFT-HANGING
	RFALSE
?L62:	CALL PRINT-ID,STR?177
	CALL JIGS-UP,1,STR?178
?L67:	CRLF
	RFALSE
?L44:	PRINTI " ..."
	CRLF
	RETURN TIGHTROPE-ROOM
?L36:	CALL PLATFORM-RETURN >STACK
	RSTACK

	.FUNCT LEFT-HANGING-F,RARG
	EQUAL? RARG,M-BEG \FALSE
	EQUAL? PRSA,V?TELL,V?YELL,V?ASK-ABOUT /?L5
	EQUAL? PRSA,V?REPLY,V?HELLO,V?TELL-ABOUT /?L5
	EQUAL? PRSA,V?HELP \?L3
?L5:	SET 'P-CONT,0
	PRINTR "You can't be heard above the commotion below."
?L3:	EQUAL? PRSA,V?LEAP,V?DROP,V?RELEASE /?L9
	EQUAL? PRSA,V?REMOVE,V?APPLAUD,V?CLAP /?L9
	EQUAL? PRSA,V?THROUGH,V?LEAP-OFF \?L8
?L9:	SET 'END-GAME-C,3
	RTRUE
?L8:	EQUAL? PRSA,V?LOOK-DOWN \?L10
	PRINTR "Your neck aches as you attempt it."
?L10:	EQUAL? PRSA,V?WALK \?L15
	EQUAL? P-WALK-DIR,P?EAST,P?WEST /?L14
?L15:	EQUAL? PRSA,V?RAISE \?L13
	EQUAL? PRSO,ME \?L13
?L14:	PRINTR "The strength is lacking."
?L13:	CALL TOUCHING-VERB? >STACK
	ZERO? STACK /FALSE
	EQUAL? PRSO,ME,HANDS,TIGHTROPE-OBJECT /FALSE
	EQUAL? PRSI,ME,HANDS,TIGHTROPE-OBJECT /FALSE
	PRINTR "That's unreachable."

	.FUNCT DOWN-LEFT
	CALL PERFORM,V?LEAP
	RFALSE

	.FUNCT PLATFORM-RETURN,FOO
	ZERO? HEADING-EAST? /?L1
	SET 'FOO,PLATFORM-2
	JUMP ?L3
?L1:	SET 'FOO,PLATFORM-1
?L3:	SET 'ON-ROPE,0
	CALL INT,I-TREMBLE >STACK
	PUT STACK,0,0
	SET 'HEADING-EAST?,0
	EQUAL? FOO,PLATFORM-2 \?L4
	FSET? PLATFORM-2,TOUCHBIT /?L4
	ADD SCORE,10 >SCORE
	PRINTI """Ta Daaaaaaaaaaa."" Those familiar notes from tonight's show reverberate through your body in triumph."
	CRLF
	CRLF
?L4:	RETURN FOO

	.FUNCT DEN-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "Here inside the round cage you stand in a dingy indoor twilight, surrounded by a panorama of closely spaced bars. The "
	CALL DPRINT,LION-DOOR
	PRINTI " that you're still keeping an eye on is to the east.

Built into the southern side of the round cage there is a square grate which "
	FSET? GRATE,OPENBIT \?L5
	PRINTI "is raised, revealing"
	JUMP ?L9
?L5:	PRINTI "is lowered, blocking"
?L9:	PRINTI " some sort of passage."
	CRLF
	IN? STAND,DEN \FALSE
	FSET? STAND,NDESCBIT \FALSE
	CRLF
	FSET? LION-CAGE,RMUNGBIT \?L16
	FSET? CASE,TOUCHBIT /?L16
	PRINTI "The "
	CALL DPRINT,STAND
	PRINTI " is"
	PRINT LION-STAND-MOVED
	CRLF
	RTRUE
?L16:	PRINTI "A "
	CALL DPRINT,STAND
	PRINTR " sits here."
?L1:	EQUAL? RARG,M-ENTER \FALSE
	IN? ELSIE,RING \?L25
	PRINTI "The big cats suddenly spring out of their slumber, and begin moving stealthily around the den"
	FSET? MEAT,RMUNGBIT /?L29
	PRINTI ", as if in preparation for a feeding"
?L29:	PRINT PERIOD
	CRLF
	CALL MOVE-LIONS,DEN
	CALL QUEUE,I-LION,2 >STACK
	PUT STACK,0,1
?L25:	IN? STAND,RING \FALSE
	FSET? STAND,NDESCBIT \FALSE
	FCLEAR STAND,NDESCBIT
	FSET STAND,VEHBIT
	MOVE STAND,DEN
	RTRUE

	.FUNCT GRATE-ENTER
	FSET? GRATE,OPENBIT /?L1
	PRINTI "The "
	CALL DPRINT,GRATE
	PRINTI " is lowered over the passage."
	CRLF
	RFALSE
?L1:	IN? NIMROD,HERE \?L5
	FSET? GRATE,OPENBIT /?L5
	CALL PERFORM,V?OPEN,GRATE
	RFALSE
?L5:	CALL V-DIG
	RFALSE

	.FUNCT I-LION,ELSIE-STOP=0
	IN? ELSIE,CHUTE \?L1
	IGRTR? 'ELSIE-COUNTER,7 \FALSE
	MOVE MEAT,LOCAL-GLOBALS
	CALL INT,I-LION >STACK
	PUT STACK,0,0
	FSET? GRATE,OPENBIT \FALSE
	SET 'ELSIE-COUNTER,0
	EQUAL? HERE,DEN \?L7
	CALL MOVE-LIONS,DEN
	JUMP ?L9
?L7:	CALL MOVE-LIONS,RING
?L9:	EQUAL? HERE,BESIDE-BIGTOP,DEN \?L10
	CRLF
	PRINTI "The lions slink back into their den."
	CRLF
?L10:	EQUAL? HERE,DEN \FALSE
	CALL QUEUE,I-LION,-1 >STACK
	PUT STACK,0,1
	RFALSE
?L1:	EQUAL? HERE,DEN /?L72
	IN? MEAT,CHUTE \?L20
	CALL MOVE-LIONS,CHUTE
	CALL QUEUE,I-LION,-1 >STACK
	PUT STACK,0,1
	EQUAL? HERE,BESIDE-BIGTOP \FALSE
	CRLF
	PRINTI "You see the pair of hungry cats slink into the chute from the "
	CALL DPRINT,BIGTOP
	PRINTI " and pounce on the "
	CALL DPRINT,MEAT
	PRINTR "."
?L20:	EQUAL? HERE,DEN \FALSE
?L72:	CALL QUEUE,I-LION,-1 >STACK
	PUT STACK,0,1
	CRLF
	IN? MEAT,DEN \?L29
	ZERO? ELSIE-COUNTER \?L31
	PRINTI "The lions continue mauling their"
	JUMP ?L35
?L31:	PRINTI "The "
	CALL DPRINT,NIMROD
	PRINTI " keeps mauling his"
?L35:	PRINTR " dinner and watching you."
?L29:	ZERO? ELSIE-COUNTER \?L40
	PRINTI "Both lions continue"
	JUMP ?L43
?L40:	PRINTI "The "
	CALL DPRINT,NIMROD
	PRINTI " keeps"
	SET 'ELSIE-STOP,1
?L43:	PRINTI " pacing nervously back and forth around the den, never letting you out of "
	ZERO? ELSIE-STOP /?L48
	PRINTI "its"
	JUMP ?L52
?L48:	PRINTI "their"
?L52:	PRINTI " sight."
	ZERO? ELSIE-STOP /?L57
	EQUAL? PRSA,V?LOOK \?L57
	PRINTI " The "
	CALL DPRINT,ELSIE
	PRINTI " remains bogged down "
	LESS? ELSIE-COUNTER,3 \?L61
	PRINTI "in front of the grate"
	JUMP ?L65
?L61:	PRINTI "off to one side of the "
	CALL DPRINT,LION-CAGE
?L65:	PRINTI "."
?L57:	CRLF
	RTRUE

	.FUNCT LION-CAGE-F
	EQUAL? PRSA,V?OPEN,V?LOCK,V?UNLOCK /?L3
	EQUAL? PRSA,V?CLOSE \?L1
?L3:	CALL PERFORM,PRSA,LION-DOOR,PRSI
	RTRUE
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \?L4
	EQUAL? HERE,DEN \?L5
	CALL V-LOOK
	RTRUE
?L5:	IN? ELSIE,RING \?L8
	PRINT YOU-SEE
	PRINTI " a pair of sleepyheaded lions resting on their haunches in the sawdust."
	JUMP ?L12
?L8:	PRINTI "The "
	CALL DPRINT,LION-CAGE
	PRINTI " is still, and void of life."
?L12:	FSET? STAND,NDESCBIT \?L26
	PRINTI " There is an enclosed "
	CALL DPRINT,STAND
	PRINTI " in the "
	CALL DPRINT,LION-CAGE
	FSET? MIDWEST,TOUCHBIT /?L62
	FSET LION-CAGE,RMUNGBIT
	FCLEAR DEN,TOUCHBIT
	FSET? MIDWEST,TOUCHBIT \?L22
?L62:	FSET? LION-CAGE,RMUNGBIT \?L22
	IN? ELSIE,CHUTE /?L22
	PRINTI ","
	PRINT LION-STAND-MOVED
	CRLF
	RTRUE
?L22:	PRINTI "."
?L26:	CRLF
	RTRUE
?L4:	EQUAL? PRSA,V?PUT \?L30
	EQUAL? PRSI,LION-CAGE \?L30
	CALL IDROP >STACK
	ZERO? STACK \?L30
	EQUAL? HERE,DEN \?L31
	CALL PERFORM,V?DROP,PRSO
	RTRUE
?L31:	EQUAL? PRSO,MEAT \?L63
	FSET? LION-DOOR,OPENBIT \?L33
	PRINTR "This isn't feeding pigeons in the park here."
?L33:	EQUAL? PRSO,MEAT /?L37
?L63:	GETP PRSO,P?SIZE >STACK
	GRTR? STACK,25 \?L36
	EQUAL? PRSO,POLE /?L36
?L37:	SET 'PRSI,CAGE
	CALL TELL-CLOSELY-SPACED
	SET 'PRSI,LION-CAGE
	RETURN PRSI
?L36:	CALL V-DIG >STACK
	RSTACK
?L30:	EQUAL? PRSA,V?REACH-IN \?L39
	EQUAL? HERE,DEN \?L40
	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L40:	IN? NIMROD,HERE \?L44
	PRINTI "Very unwise."
	CRLF
	CALL PRINT-ID,STR?179 >STACK
	RSTACK
?L44:	CALL TELL-WITHIN-REACH >STACK
	RSTACK
?L39:	EQUAL? PRSA,V?CLIMB-UP,V?CLIMB-FOO,V?CLIMB-ON \?L48
	CALL PERFORM,V?CLIMB-UP,CAGE
	RTRUE
?L48:	EQUAL? PRSA,V?THROUGH,V?ENTER,V?BOARD \?L49
	EQUAL? HERE,RING \?L50
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L50:	PRINT LOOK-AROUND
	RTRUE
?L49:	EQUAL? PRSA,V?DISEMBARK,V?EXIT,V?LEAVE \FALSE
	EQUAL? HERE,DEN \?L56
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L56:	PRINT LOOK-AROUND
	RTRUE

	.FUNCT MOVE-LIONS,PLACE
	MOVE ELSIE,PLACE
	MOVE NIMROD,PLACE
	MOVE LION-NAME,PLACE
	EQUAL? PLACE,DUMMY-OBJECT,CHUTE /FALSE
	EQUAL? PLACE,RING \?L3
	FSET STAND,NDESCBIT
	FCLEAR STAND,VEHBIT
	JUMP ?L4
?L3:	EQUAL? PLACE,DEN \?L4
	FSET STAND,VEHBIT
?L4:	MOVE STAND,PLACE
	RTRUE

	.FUNCT STAND-F,RARG=0
	EQUAL? RARG,M-BEG \?L1
	EQUAL? PRSA,V?WALK \?L1
	EQUAL? P-WALK-DIR,P?UP /?L1
	EQUAL? P-WALK-DIR,P?DOWN \?L3
	CALL PERFORM,V?DISEMBARK,STAND
	RTRUE
?L3:	CALL OUT-OF-FIRST,STAND >STACK
	RSTACK
?L1:	ZERO? RARG \FALSE
	EQUAL? PRSA,V?CLOSE,V?OPEN \?L7
	CALL CANT-OPEN >STACK
	RSTACK
?L7:	EQUAL? PRSA,V?EXAMINE \?L8
	PRINTI "The "
	CALL DPRINT,STAND
	PRINTI " is a red three-foot-high, cylindrical pedestal. "
	FIRST? STAND >STACK \?L11
	CALL PERFORM,V?LOOK-ON,STAND
	RTRUE
?L11:	CRLF
	RTRUE
?L8:	EQUAL? PRSA,V?LOOK-ON \?L14
	FIRST? STAND >STACK \?L15
	PRINTI "There's"
	CALL PRINT-CONTENTS,STAND
	JUMP ?L19
?L15:	PRINTI " nothing"
?L19:	PRINTR " on the stand."
?L14:	EQUAL? HERE,RING \?L24
	FSET? STAND,NDESCBIT \?L24
	CALL TOUCHING?,STAND >STACK
	ZERO? STACK /?L24
	CALL CANT-REACH,STAND >STACK
	RSTACK
?L24:	EQUAL? PRSA,V?CLIMB-FOO \?L25
	CALL PERFORM,V?BOARD,STAND
	RTRUE
?L25:	IN? NIMROD,HERE \?L26
	EQUAL? PRSA,V?BOARD /?L27
	EQUAL? PRSA,V?PUT-ON,V?PUT \?L26
?L27:	CALL PERFORM,V?RAISE,STAND
	RTRUE
?L26:	EQUAL? PRSA,V?TAKE,V?RAISE,V?LOOK-UNDER /?L29
	EQUAL? PRSA,V?LOOK-INSIDE,V?SEARCH,V?MOVE /?L29
	EQUAL? PRSA,V?PUSH \?L28
?L29:	EQUAL? PRSO,STAND \?L28
	IN? CASE,LOCAL-GLOBALS \?L28
	LOC PROTAGONIST >STACK
	EQUAL? STACK,STAND \?L30
	CALL OUT-OF-FIRST,STAND >STACK
	RSTACK
?L30:	IN? NIMROD,HERE \?L32
	PRINTR "Jealous of your attempt to assume its throne, the shaggy king of beasts repels you with a volcanic roar."
?L32:	IN? NIMROD,CHUTE \?L35
	FSET? GRATE,OPENBIT \?L35
	CALL BLIND-SIDE >STACK
	RSTACK
?L35:	FSET CASE,TOUCHBIT
	MOVE CASE,PROTAGONIST
	ADD SCORE,10 >SCORE
	PRINTI "You tilt up the "
	CALL DPRINT,STAND
	PRINTI " and see a "
	CALL DPRINT,CASE
	PRINTR ", which you pick up."
?L28:	EQUAL? PRSA,V?PUT \?L39
	EQUAL? PRSI,STAND \?L39
	CALL V-DIG >STACK
	RSTACK
?L39:	EQUAL? PRSA,V?LOOK-INSIDE \FALSE
	PRINT EMPTY
	PRINT PERIOD
	RTRUE

	.FUNCT WHIP-HOLD
	IN? WHIP,PROTAGONIST /FALSE
	PRINT NOT-HOLDING
	PRINTR " a whip."

	.FUNCT LION-NOT-HERE?,THING
	IN? NIMROD,DEN /FALSE
	CALL TOUCHING?,THING >STACK
	ZERO? STACK /FALSE
	CALL CANT-REACH,THING
	RTRUE

	.FUNCT NIMROD-F
	EQUAL? PRSA,V?GIVE,V?SHOW /?L1
	CALL LION-NOT-HERE?,NIMROD >STACK
	ZERO? STACK \TRUE
?L1:	CALL TALKING-TO?,NIMROD >STACK
	ZERO? STACK /?L3
	CALL TALK-TO-LION
	CALL STOP >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?PUSH,V?RUB,V?SEARCH \?L4
	PRINTI "As "
	CALL DPRINT,HANDS
	PRINTI " approaches, the lion backs you away with a head-bobbing roar."
	CRLF
	CALL PRINT-ID,STR?180 >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?EXAMINE \?L7
	IN? MEAT,DEN /?L10
	EQUAL? HERE,RING /?L10
	IN? NIMROD,CHUTE \?L8
	LESS? ELSIE-COUNTER,7 \?L8
?L10:	PRINTR "The lion appears savage and blond, like a Cosmo cover."
?L8:	PRINTR "The lion wags its salivating tongue in stride, at times giving off a deep-throated purr."
?L7:	EQUAL? PRSA,V?THROW \?L16
	EQUAL? PRSI,NIMROD \?L16
	EQUAL? HERE,RING \?L16
	CALL PERFORM,V?PUT,PRSO,LION-CAGE
	RTRUE
?L16:	EQUAL? PRSA,V?SHOW,V?GIVE \?L17
	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L17
	EQUAL? HERE,RING \?L18
	CALL PERFORM,V?PUT,PRSO,LION-CAGE
	RTRUE
?L18:	EQUAL? PRSO,MEAT \?L20
	CALL FEED-LION,1
	RTRUE
?L20:	EQUAL? PRSO,WATER \?L21
	CALL NOT-INTERESTED >STACK
	RSTACK
?L21:	EQUAL? PRSO,MOUSE /FALSE
	MOVE PRSO,HERE
	PRINTI "As"
	CALL ARTICLE,PRSO,1
	PRINTR " falls to the sawdust, the shaggy beast lets out a gaping yawn. With your open view of its choppers, this is only a little less intimidating than a roar."
?L17:	EQUAL? PRSA,V?WHIP \FALSE
	EQUAL? PRSI,WHIP \FALSE
	CALL WHIP-HOLD >STACK
	ZERO? STACK \TRUE
	PRINTI "Following the whip's backlash, the "
	CALL DPRINT,NIMROD
	CALL PRINT-ID,STR?181
	CALL JIGS-UP,5,STR?182
	RTRUE

	.FUNCT FEED-LION,TO-NIMROD?=0
	MOVE MEAT,DEN
	FSET MEAT,NDESCBIT
	FSET MEAT,RMUNGBIT
	SET 'ELSIE-COUNTER,0
	PRINTI "The "
	ZERO? TO-NIMROD? /?L3
	CALL DPRINT,NIMROD
	JUMP ?L7
?L3:	CALL DPRINT,ELSIE
?L7:	CALL QUEUE,I-LION,2 >STACK
	PUT STACK,0,1
	PRINTR " jaunts over to the meat and pounces on it, and now the other beast joins in on the feast, each lion occasionally peering up at you."

	.FUNCT TALK-TO-LION
	PRINTR "The big cat pays you no heed."

	.FUNCT ELSIE-F
	EQUAL? PRSA,V?SHOW,V?GIVE /?L1
	CALL LION-NOT-HERE?,ELSIE >STACK
	ZERO? STACK \TRUE
?L1:	CALL TALKING-TO?,ELSIE >STACK
	ZERO? STACK /?L3
	CALL TALK-TO-LION
	CALL STOP >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?PUSH,V?SEARCH,V?RUB \?L4
	PRINTI "An ominous, deep-sounding purr from the "
	CALL DPRINT,ELSIE
	PRINTI " keeps you away."
	CRLF
	CALL PRINT-ID,STR?183 >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?EXAMINE \?L7
	ZERO? ELSIE-COUNTER /?L11
	EQUAL? HERE,DEN /?L10
?L11:	EQUAL? HERE,RING \?L8
?L10:	PRINTR "The big cat is stretched out lazily over the sawdust."
?L8:	IN? MEAT,DEN /FALSE
	EQUAL? HERE,RING /FALSE
	IN? ELSIE,CHUTE /?L15
	ZERO? ELSIE-COUNTER \FALSE
?L15:	PRINTR "With each stride the cat's muscle-laden shoulder bones pivot up and down in tandem."
?L7:	EQUAL? PRSA,V?THROW \?L19
	EQUAL? PRSI,ELSIE \?L19
	EQUAL? HERE,RING \?L19
	CALL PERFORM,V?PUT,PRSO,LION-CAGE
	RTRUE
?L19:	EQUAL? PRSA,V?SHOW,V?GIVE \?L20
	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L20
	EQUAL? HERE,RING \?L21
	CALL PERFORM,V?PUT,PRSO,LION-CAGE
	RTRUE
?L21:	EQUAL? PRSO,MOUSE /FALSE
	EQUAL? PRSO,MEAT \?L24
	CALL FEED-LION >STACK
	RSTACK
?L24:	CALL NOT-INTERESTED >STACK
	RSTACK
?L20:	EQUAL? PRSA,V?WHIP \FALSE
	EQUAL? PRSI,WHIP \FALSE
	CALL WHIP-HOLD >STACK
	ZERO? STACK \TRUE
	INC 'ELSIE-COUNTER
	EQUAL? ELSIE-COUNTER,1 \?L30
	PRINTI "As the whip cracks just inches above the "
	CALL DPRINT,ELSIE
	PRINTR "'s hide, the puzzled animal scratches to a halt in front of the grate. Leaning back on its haunches, the lion flexes its forepaws."
?L30:	EQUAL? ELSIE-COUNTER,2 \?L34
	PRINTR """Snap!"" The lion performs an obedient roll-over, flecking its hide with sawdust."
?L34:	EQUAL? ELSIE-COUNTER,3 \?L37
	PRINTI "The "
	CALL DPRINT,ELSIE
	PRINTI " cowers, does a couple of nervous pirouettes, then jaunts off to the side of the "
	CALL DPRINT,LION-CAGE
	PRINTR " where it hunkers down and lets out a huge yawn."
?L37:	CALL BLIND-SIDE >STACK
	RSTACK

	.FUNCT BLIND-SIDE
	CALL PRINT-ID,STR?184
	CALL JIGS-UP,2,STR?185
	RTRUE

	.FUNCT LION-NAME-F
	CALL DONT-HANDLE?,LION-NAME >STACK
	ZERO? STACK \FALSE
	EQUAL? PRSA,V?EXAMINE \?L4
	PRINTI "You glance at each lion and realize that, b"
	JUMP ?L8
?L4:	PRINTI "B"
?L8:	PRINTI "ecause you were outside the "
	CALL DPRINT,BIGTOP
	PRINTI " stuck waiting in line when the lions were introduced, you're not certain who is who. You'll have to refer to each as the "
	CALL DPRINT,NIMROD
	PRINTI " or the "
	CALL DPRINT,ELSIE
	PRINTI "."
	CRLF
	CALL STOP >STACK
	RSTACK

	.FUNCT MEAT-F
	EQUAL? PRSA,V?MOVE,V?TAKE \?L1
	IN? MEAT,DEN \?L1
	PRINTI "You'd"
	CALL TELL-WITHDRAW-STUMP,1
	CALL PRINT-ID,STR?186 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EAT \?L5
	PRINTI "Just looking at the "
	CALL DPRINT,MEAT
	PRINTI " makes you lose your appetite, if not your lunch."
	CRLF
	CALL PRINT-ID,STR?187 >STACK
	RSTACK
?L5:	EQUAL? PRSA,V?THROW,V?DROP \FALSE
	EQUAL? PRSO,MEAT \FALSE
	EQUAL? HERE,DEN \FALSE
	IN? NIMROD,HERE \FALSE
	ZERO? PRSI /?L9
	PRINT BAD-AIM
	PRINTI ". "
?L9:	CALL FEED-LION,1
	RTRUE

	.FUNCT BUCKET-F,FULL?=0,?TMP
	SET 'P-IT-OBJECT,BUCKET
	IN? WATER,BUCKET /?L1
	SET 'FULL?,0
	JUMP ?L2
?L1:	SET 'FULL?,1
?L2:	EQUAL? PRSA,V?TAKE-WITH \?L3
	EQUAL? PRSO,WATER,GLOBAL-WATER \?L3
	CALL PERFORM,V?FILL,BUCKET,GLOBAL-WATER
	RTRUE
?L3:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L5
	CALL V-COUNT >STACK
	RSTACK
?L5:	ZERO? FULL? /?L6
	EQUAL? PRSA,V?THROW \?L6
	CALL PERFORM,V?DROP,WATER
	MOVE BUCKET,HERE
	RTRUE
?L6:	EQUAL? PRSA,V?STAND-ON \?L7
	PRINTR "It wouldn't be a very elevating experience."
?L7:	EQUAL? PRSA,V?EXAMINE \?L10
	PRINTI "It's made of galvanized steel and "
	FIRST? BUCKET >STACK \?L13
	PRINTI "contains"
	CALL PRINT-CONTENTS,BUCKET
	JUMP ?L17
?L13:	PRINTI "there's nothing in it"
?L17:	PRINT PERIOD
	RTRUE
?L10:	EQUAL? PRSA,V?EXAMINE,V?SEARCH,V?LOOK-INSIDE \?L22
	PRINTI "The bucket "
	FIRST? BUCKET >STACK /?L25
	PRINTI "is empty"
	JUMP ?L36
?L25:	PRINTI "contains"
	ZERO? FULL? /?L32
	PRINTI " a limpid pool of "
	CALL DPRINT,WATER
	JUMP ?L36
?L32:	CALL PRINT-CONTENTS,BUCKET
?L36:	PRINT PERIOD
	RTRUE
?L22:	EQUAL? PRSA,V?DRINK-FROM,V?DRINK \?L39
	ZERO? FULL? /?L40
	CALL PERFORM,V?DRINK,WATER
	RTRUE
?L40:	CALL EMPTY-BUCKET
	RTRUE
?L39:	EQUAL? PRSA,V?EMPTY,V?POUR \?L43
	ZERO? FULL? /?L44
	CALL PERFORM,V?POUR,WATER
	RTRUE
?L44:	CALL EMPTY-BUCKET
	RTRUE
?L43:	EQUAL? PRSA,V?PUT \FALSE
	EQUAL? PRSI,BUCKET \?L47
	EQUAL? PRSO,WATER /?L47
	ZERO? FULL? /?L47
	PRINTI "But"
	CALL ARTICLE,PRSO,1
	PRINTR " would get all wet."
?L47:	EQUAL? PRSA,V?PUT \FALSE
	EQUAL? PRSI,BUCKET \?L52
	CALL WEIGHT,PRSI >?TMP
	GETP PRSO,P?SIZE >STACK
	ADD ?TMP,STACK >?TMP
	GETP PRSI,P?SIZE >STACK
	SUB ?TMP,STACK >?TMP
	GETP PRSI,P?CAPACITY >STACK
	GRTR? ?TMP,STACK /FALSE
?L52:	EQUAL? PRSA,V?PUT \FALSE
	EQUAL? PRSO,CHEESE \?L55
	IN? MOUSE,BUCKET /?L54
?L55:	EQUAL? PRSO,MOUSE \FALSE
	IN? CHEESE,BUCKET \FALSE
?L54:	MOVE MOUSE,BUCKET
	PRINTI "Done. "
	CALL FEED-MOUSE
	RTRUE

	.FUNCT EMPTY-BUCKET,OBJ
	FIRST? BUCKET >OBJ \?L1
	EQUAL? PRSA,V?DRINK-FROM \?L3
	CALL PERFORM,V?DRINK,OBJ
	RTRUE
?L3:	NEXT? OBJ >STACK \?L6
	PRINTI "The contents of the "
	CALL DPRINT,BUCKET
	PRINTI " fall"
	JUMP ?L10
?L6:	PRINTI "Okay,"
	CALL ARTICLE,OBJ,1
	PRINTI " falls"
?L10:	PRINTI " out of it."
	CRLF
	EQUAL? HERE,DEN \?L17
	IN? NIMROD,HERE \?L17
	IN? MEAT,BUCKET \?L17
	CALL PERFORM,V?GIVE,MEAT,NIMROD
	JUMP ?L19
?L17:	IN? MOUSE,BUCKET \?L19
	MOVE MOUSE,LOCAL-GLOBALS
	CALL SCAMPER
?L19:	CALL ROB,BUCKET,HERE
	RTRUE
?L1:	PRINT EMPTY
	PRINT PERIOD
	RTRUE

	.FUNCT NOT-HOLDING-WATER?
	IN? WATER,BUCKET /FALSE
	PRINTR "You're not carrying any water."

	.FUNCT WATER-F
	EQUAL? PRSA,V?TASTE,V?DRINK-FROM,V?DRINK \?L1
	CALL NOT-HOLDING-WATER? >STACK
	ZERO? STACK \TRUE
	PRINTR "You take a sip of the cool water."
?L1:	EQUAL? PRSA,V?EMPTY,V?DROP,V?THROW /?L9
	EQUAL? PRSA,V?PUT,V?PUT-ON,V?TAKE /?L9
	EQUAL? PRSA,V?POUR \?L8
?L9:	EQUAL? PRSO,WATER \?L8
	CALL NOT-HOLDING-WATER? >STACK
	ZERO? STACK \TRUE
	MOVE WATER,LOCAL-GLOBALS
	EQUAL? PRSI,0,TAFT /?L20
	FSET? PRSI,ACTORBIT \?L20
	EQUAL? PRSI,FAT \?L15
	PRINTI "Tina stays mostly dry."
	CRLF
	CALL PRINT-ID,STR?188
	RTRUE
?L15:	ZERO? PRSI /?L22
	ZERO? END-GAME /?L22
	EQUAL? PRSI,APE /?L20
?L22:	PRINTI "Deftly,"
	CALL ARTICLE,PRSI,1
	PRINTI " sidesteps your splashing. "
?L20:	PRINTI "The "
	CALL DPRINT,WATER
	PRINTI " explodes into a zillion sparkling droplets that immediately evaporate"
	PRINT PERIOD
	RTRUE
?L8:	EQUAL? PRSA,V?PUT-ON,V?PUT \?L33
	EQUAL? PRSI,WATER \?L33
	IN? WATER,BUCKET \?L33
	CALL PERFORM,V?PUT,PRSO,BUCKET
	RTRUE
?L33:	EQUAL? PRSA,V?GIVE,V?FEED \FALSE
	EQUAL? PRSO,WATER \FALSE
	FSET? PRSI,ACTORBIT \FALSE
	CALL PERFORM,V?POUR,WATER
	RTRUE

	.FUNCT WHIP-F
	EQUAL? PRSA,V?WHIP \FALSE
	EQUAL? PRSI,WHIP \FALSE
	EQUAL? PRSO,WHIP \?L3
	CALL V-COUNT >STACK
	RSTACK
?L3:	EQUAL? PRSO,GROUND \FALSE
	CALL V-DIG >STACK
	RSTACK

	.FUNCT LION-DOOR-F
	EQUAL? PRSA,V?PUT \FALSE
	FSET? LION-DOOR,OPENBIT \FALSE
	EQUAL? PRSO,MEAT \FALSE
	CALL PERFORM,V?PUT,MEAT,LION-CAGE
	RTRUE

	.FUNCT CON-AREA-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "This area of matted-down crabgrass lies between the vaulted "
	CALL DPRINT,BIGTOP
	PRINTI " entrance to the north and the enticements of the midway to the east, where a "
	CALL DPRINT,BANNER
	PRINTI " hangs crookedly above a "
	CALL DPRINT,TURNSTILE
	PRINTI ". There is a "
	CALL DPRINT,FOUNTAIN
	PRINTI " near the side wall of the tent. "
	ZERO? DREAMING \?L5
	PRINTR "You can enter the night to the west and south."
?L5:	CRLF
	CRLF
	PRINTI "Stretching away from a small concession stand "
	IN? SHORT,HERE \?L12
	PRINTI "are a "
	CALL DPRINT,SHORT
	PRINTI " and"
	JUMP ?L16
?L12:	PRINTI "is"
?L16:	PRINTI " a "
	CALL DPRINT,LONG
	PRINTR " of suckers."
?L1:	EQUAL? RARG,M-ENTER \?L21
	EQUAL? P-WALK-DIR,P?SOUTH,P?OUT \?L26
	ZERO? DREAMING \?L26
	PRINTI "You emerge into the warm night air of summer."
	CRLF
	CRLF
	FSET? CON-AREA,TOUCHBIT /?L26
	MOVE CROWD,CON-AREA
	CALL QUEUE,I-BOOST,-1 >STACK
	PUT STACK,0,1
?L26:	CALL QUEUE-THUMB? >STACK
	ZERO? STACK /FALSE
	ZERO? DREAMING \FALSE
	CALL QUEUE,I-THUMB,1 >STACK
	PUT STACK,0,1
	RTRUE
?L21:	ZERO? DREAMING /?L33
	EQUAL? RARG,M-BEG \?L39
	EQUAL? PRSA,V?WALK \?L33
	EQUAL? P-WALK-DIR,P?NORTH /?L33
	CALL HELD?,MONKEY >STACK
	ZERO? STACK /?L34
	CALL MONKEY-DIRECTION
	RTRUE
?L34:	PRINTR "That's not the way you remember it."
?L33:	EQUAL? RARG,M-BEG \?L39
	FSET LONG,VEHBIT
	FSET SHORT,VEHBIT
	FSET? LONG,RMUNGBIT /FALSE
	EQUAL? PRSA,V?BOARD \FALSE
	EQUAL? PRSO,LONG \FALSE
	GRTR? LINE-COUNTER,3 \FALSE
	CALL ENTER-LINE,1 >STACK
	RSTACK
?L39:	EQUAL? RARG,M-END \FALSE
	CALL MONKEY-ACTS? >STACK
	ZERO? STACK \FALSE
	RFALSE

	.FUNCT MONKEY-ACTS?
	IN? MONKEY,PROTAGONIST \FALSE
	RANDOM 100 >STACK
	LESS? 60,STACK /FALSE
	CRLF
	PRINTI "The "
	CALL DPRINT,MONKEY
	PRINTI " on "
	CALL DPRINT,BACK
	PRINTI " "
	CALL PICK-ONE,MONKEYS >STACK
	PRINT STACK
	PRINT PERIOD
	RTRUE

	.FUNCT BANNER-F
	EQUAL? PRSA,V?EXAMINE,V?READ \?L1
	CRLF
	EQUAL? HERE,CON-AREA \?L3
	PRINTI """TO SIDESHOWS"
	JUMP ?L10
?L3:	EQUAL? HERE,MIDWEST \?L7
	PRINTI """TO MENAGERIE"
	JUMP ?L10
?L7:	PRINTI """THIS WAY TO THE EGRESS"
?L10:	PRINTR """"
?L1:	CALL TOUCHING?,BANNER >STACK
	ZERO? STACK /FALSE
	CALL CANT-REACH,BANNER >STACK
	RSTACK

	.FUNCT LONG-F,RARG=0
	EQUAL? RARG,M-ENTER \?L1
	FSET? LONG,TOUCHBIT /FALSE
	FSET LONG,TOUCHBIT
	CALL QUEUE,I-BAD-LUCK,5 >STACK
	PUT STACK,0,1
	RFALSE
?L1:	EQUAL? RARG,M-BEG \?L6
	CALL GET-OUT-OF-LINE?,LONG >STACK
	ZERO? STACK \TRUE
	EQUAL? PRSA,V?WALK \?L9
	CALL OUT-OF-FIRST,LONG >STACK
	RSTACK
?L9:	IN? SHORT,CON-AREA \FALSE
	IN? TEAM,CON-AREA /FALSE
	EQUAL? PRSA,V?WAIT \FALSE
	PRINTI "Time itself, let alone the "
	CALL DPRINT,LONG
	PRINTI ", has "
	CALL DPRINT,GROUND
	PRINTI " to an agonizing halt."
	CRLF
	SET 'CLOCK-WAIT,1
	RTRUE
?L6:	ZERO? RARG \FALSE
	CALL LINES-F >STACK
	RSTACK

	.FUNCT SHORT-F,RARG=0
	EQUAL? RARG,M-BEG \?L1
	CALL GET-OUT-OF-LINE?,SHORT >STACK
	ZERO? STACK \TRUE
	EQUAL? PRSA,V?WALK \FALSE
	CALL OUT-OF-FIRST,SHORT >STACK
	RSTACK
?L1:	ZERO? RARG \FALSE
	CALL LINES-F >STACK
	RSTACK

	.FUNCT LINES-F
	EQUAL? HERE,CON-AREA \FALSE
	EQUAL? PRSA,V?WALK-TO,V?THROUGH,V?BOARD \?L4
	ZERO? IN-FRONT-FLAG \?L3
?L4:	EQUAL? P-PRSA-WORD,W?CUT /?L3
	EQUAL? PRSA,V?WALK-TO,V?THROUGH,V?BOARD \FALSE
	CALL IS-NOUN?,W?FRONT >STACK
	ZERO? STACK /FALSE
?L3:	LOC PROTAGONIST >STACK
	EQUAL? STACK,LONG,SHORT \?L5
	LOC PROTAGONIST >STACK
	CALL OUT-OF-FIRST,STACK
	RTRUE
?L5:	CALL PERFORM,V?WALK-TO,CON-STAND
	RTRUE

	.FUNCT GET-OUT-OF-LINE?,LINE
	EQUAL? PRSA,V?DISEMBARK \FALSE
	EQUAL? P-PRSA-WORD,W?GET \FALSE
	CALL IS-NOUN?,W?LINE >STACK
	ZERO? STACK /FALSE
	GET P-ADJW,0 >STACK
	ZERO? STACK \FALSE
	FSET? SHORT,RMUNGBIT /FALSE
	FSET SHORT,RMUNGBIT
	PRINTI "You begin ranting and raving and throwing a tantrum and all of those things attendant upon someone getting way out of line. You feel better, but it doesn't advance the "
	CALL DPRINT,LINE
	PRINTR "."

	.FUNCT GEN-LINE-F,LINE
	EQUAL? PRSA,V?EXIT,V?DISEMBARK \?L1
	LOC PROTAGONIST >STACK
	EQUAL? STACK,LONG,SHORT \?L1
	LOC PROTAGONIST >STACK
	RSTACK
?L1:	EQUAL? P-NAM,W?SUCKER \?L3
	RETURN ME
?L3:	EQUAL? HERE,CON-AREA /?L4
	RETURN LONG
?L4:	EQUAL? PRSA,V?DISEMBARK \FALSE
	LOC PROTAGONIST >STACK
	EQUAL? STACK,LONG,SHORT /FALSE
	RETURN LONG

	.FUNCT I-BAD-LUCK
	LOC PROTAGONIST >STACK
	EQUAL? STACK,SHORT \?L1
	FCLEAR LONG,VEHBIT
	JUMP ?L3
?L1:	LOC PROTAGONIST >STACK
	EQUAL? STACK,LONG \?L3
	FCLEAR SHORT,VEHBIT
?L3:	ZERO? LINE-COUNTER \?L5
	MOVE SHORT,CON-AREA
	SET 'LINE-COUNTER,1
	CALL QUEUE,I-BAD-LUCK,-1 >STACK
	PUT STACK,0,1
	CRLF
	PRINTI "Right next to the "
	CALL DPRINT,LONG
	PRINTR " a much shorter line begins to form."
?L5:	EQUAL? LINE-COUNTER,1 \?L9
	IN? PROTAGONIST,SHORT \?L9
	SET 'LINE-COUNTER,2
	RETURN LINE-COUNTER
?L9:	EQUAL? LINE-COUNTER,2 \?L10
	IN? PROTAGONIST,SHORT \?L10
	SET 'LINE-COUNTER,3
	MOVE TEAM,CON-AREA
	MOVE JERRY,CON-AREA
	CRLF
	PRINTR "The face of the man ahead of you lights up as he spots something. ""Hey, guys! It's ME, Jerry,"" he yells to a sizable group nearby, and they approach."
?L10:	EQUAL? LINE-COUNTER,3 \?L13
	LOC PROTAGONIST >STACK
	EQUAL? STACK,SHORT \?L13
	SET 'LINE-COUNTER,4
	FSET LONG,VEHBIT
	MOVE PROTAGONIST,LONG
	FCLEAR SHORT,VEHBIT
	CALL PLAYER-NUM-CHECK
	CRLF
	PRINTI """Haven't seen you turkeys in years. Howda hell are you guys?"" They all reintroduce themselves. ""Hey -- you clowns thirsty? Get in here, I'll buy y'all beer.""

""You sure it's not a problem?"" asks the "
	GET PLAYERS,PLAYER-NUM >STACK
	PRINT STACK
	PRINTR ".

""Heck no, just scoot in right here.""

With both your resolve and your heaving bosom firm against the crush of interlopers, you are nevertheless forced to backpedal."
?L13:	EQUAL? LINE-COUNTER,4 \?L16
	IN? PROTAGONIST,LONG \?L16
	CALL PLAYER-NUM-CHECK
	CRLF
	PRINTI "Jerry continues "
	CALL PICK-ONE,GREETINGS >STACK
	PRINT STACK
	PRINTI " the "
	GET PLAYERS,PLAYER-NUM >STACK
	PRINT STACK
	PRINTI "."
	CRLF
	EQUAL? PLAYER-NUM,5 \TRUE
	FSET? CON-STAND,RMUNGBIT /TRUE
	FSET CON-STAND,RMUNGBIT
	CRLF
	PRINTI "Out of the "
	CALL DPRINT,CORNER
	PRINTR " of your eye, you see the line you first entered suddenly kicking into gear and really begin moving."
?L16:	IN? PROTAGONIST,HERE \?L24
	EQUAL? LINE-COUNTER,4 \?L24
	MOVE TEAM,LOCAL-GLOBALS
	MOVE JERRY,LOCAL-GLOBALS
	SET 'LINE-COUNTER,5
	RFALSE
?L24:	LOC PROTAGONIST >STACK
	EQUAL? STACK,LONG \?L25
	EQUAL? LINE-COUNTER,5 \?L25
	SET 'LINE-COUNTER,6
	CRLF
	PRINTR "You notice the woman who had been next to you in the line you first entered walk away from it with an overflowing tray of goodies."
?L25:	LOC PROTAGONIST >STACK
	EQUAL? STACK,LONG \FALSE
	EQUAL? LINE-COUNTER,6 \FALSE
	SET 'LINE-COUNTER,7
	CRLF
	PRINTR "A baby's cry suddenly pierces the air like a siren."

	.FUNCT ENTER-LINE,WIN?=0
	PRINTI "A lot of other people must "
	ZERO? WIN? /?L3
	PRINTI "not "
?L3:	PRINTI "have had the same idea as you, as they "
	CALL PICK-ONE,LINE-MERGE >STACK
	PRINT STACK
	PRINTI " over to "
	ZERO? WIN? /?L10
	CALL INT,I-BAD-LUCK >STACK
	PUT STACK,0,0
	FSET LONG,RMUNGBIT
	MOVE PROTAGONIST,HERE
	MOVE BANANA,PROTAGONIST
	SUB POCKET-CHANGE,375 >POCKET-CHANGE
	PRINTI "the "
	CALL DPRINT,SHORT
	PRINTI ". Steaming to the front of the line, you get a "
	CALL DPRINT,BANANA
	PRINTI " pushed at you and are whisked to the side before you can even count your change."
	CALL PRINT-ID,STR?189
	CRLF
	RTRUE
?L10:	PRINTR "your chosen line, bunching in ahead of you and making it the longer of the two."

	.FUNCT GRANOLA-F
	EQUAL? PRSA,V?CLOSE,V?OPEN \?L1
	PRINTR "There's no wrapper."
?L1:	EQUAL? PRSA,V?BUY \?L5
	EQUAL? HERE,STANDS-ROOM \?L6
	IN? HAWKER,HERE \?L6
	EQUAL? POCKET-CHANGE,1841 \?L6
	CALL PRINT-ID,STR?190
	SET 'ORDERED-GRANOLA,1
?L6:	CALL PERFORM,V?BUY,JUNK-FOOD
	RTRUE
?L5:	EQUAL? PRSA,V?EAT \FALSE
	PRINTI "You abstain, since health foods tend to make you sick."
	CRLF
	CALL PRINT-ID,STR?191 >STACK
	RSTACK

	.FUNCT GEN-BAR
	RETURN GRANOLA

	.FUNCT BANANA-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "The "
	CALL DPRINT,BANANA
	PRINTI " is "
	FSET? BANANA,RMUNGBIT /?L5
	PRINTI "entirely "
?L5:	PRINTR "coated with chocolate."
?L1:	EQUAL? PRSA,V?BUY \?L12
	EQUAL? HERE,CON-AREA \?L12
	ZERO? DREAMING /?L12
	CALL PERFORM,V?BUY,JUNK-FOOD
	RTRUE
?L12:	EQUAL? PRSA,V?TASTE,V?REMOVE,V?MUNG /?L14
	EQUAL? PRSA,V?TAKE \?L13
	ZERO? PRSI /?L13
?L14:	FSET BANANA,RMUNGBIT
	PRINTI "As the "
	CALL DPRINT,MONKEY
	PRINTI " on "
	CALL DPRINT,BACK
	PRINTI " catches a whiff of the tangy fruit beneath the chocolate, you feel its primal heart begin to race and, on the back of your neck, its warm breath quicken."
	CRLF
	CALL PRINT-ID,STR?192
	CALL HELD?,BANANA >STACK
	ZERO? STACK \TRUE
	CRLF
	MOVE BANANA,PROTAGONIST
	CALL PERFORM,V?DROP,BANANA
	RTRUE
?L13:	EQUAL? PRSA,V?BITE,V?EAT \?L20
	FSET? BANANA,RMUNGBIT \?L21
	MOVE BANANA,LOCAL-GLOBALS
	PRINTI "It gives you a brief, but intense, headache."
	CRLF
	CALL PRINT-ID,STR?193 >STACK
	RSTACK
?L21:	CALL PERFORM,V?MUNG,BANANA
	RTRUE
?L20:	EQUAL? PRSA,V?THROW,V?DROP \FALSE
	FSET? BANANA,RMUNGBIT \FALSE
	MOVE MONKEY,LOCAL-GLOBALS
	MOVE BANANA,LOCAL-GLOBALS
	PRINTI "Following its jungle appetite, the "
	CALL DPRINT,MONKEY
	PRINTI " dismounts "
	CALL DPRINT,BACK
	PRINTR ", pounces on the banana, and saunters away with it."

	.FUNCT GEN-FOOD
	RETURN JUNK-FOOD

	.FUNCT JERRY-F
	EQUAL? JERRY,WINNER \?L1
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,JERRY
	SET 'WINNER,JERRY
	RTRUE
?L1:	CALL TALKING-TO?,JERRY >STACK
	ZERO? STACK /?L3
	PRINTI "The team is far too deeply engaged in nostalgia to pay any notice."
	CRLF
	CALL STOP >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?THROUGH,V?BOARD \?L6
	CALL PERFORM,V?KILL,JERRY
	RTRUE
?L6:	CALL HURT?,JERRY >STACK
	ZERO? STACK /FALSE
	CALL FIGHT
	FSET JERRY,RMUNGBIT
	RTRUE

	.FUNCT TEAM-F
	CALL HURT?,TEAM >STACK
	ZERO? STACK /?L1
	CALL FIGHT
	FSET TEAM,RMUNGBIT
	RTRUE
?L1:	CALL TALKING-TO?,TEAM >STACK
	ZERO? STACK /?L3
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,JERRY
	SET 'WINNER,TEAM
	RTRUE
?L3:	EQUAL? PRSA,V?THROUGH,V?BOARD \?L4
	CALL PERFORM,V?KILL,TEAM
	RTRUE
?L4:	EQUAL? PRSA,V?COUNT \FALSE
	PRINTR "Nine players, altogether."

	.FUNCT FIGHT
	FSET? JERRY,RMUNGBIT \?L1
	FSET? TEAM,RMUNGBIT \?L1
	CALL PRINT-ID,STR?194
	CALL JIGS-UP,5,STR?195 >STACK
	RSTACK
?L1:	CALL PLAYER-NUM-CHECK
	PRINTI "The "
	GET PLAYERS,PLAYER-NUM >STACK
	PRINT STACK
	PRINTI " steps in between. ""This "
	CALL MAN-OR-WOMAN,STR?197,STR?196
	PRINTI " giving you trouble"
	EQUAL? PRSO,JERRY \?L8
	PRINTI ", Jerry"
?L8:	RANDOM 8 >PLAYER-NUM
	PRINTI "?"" Then the "
	GET PLAYERS,PLAYER-NUM >STACK
	PRINT STACK
	PRINTI " backs you off with a nasty stare."
	CRLF
	CALL PRINT-ID,STR?198 >STACK
	RSTACK

	.FUNCT PLAYER-NUM-CHECK
	CALL IS-NOUN?,W?FIELDER >STACK
	ZERO? STACK \?L3
	CALL IS-ADJ?,W?LEFT >STACK
	ZERO? STACK \?L3
	CALL IS-ADJ?,W?CENTER >STACK
	ZERO? STACK \?L3
	CALL IS-ADJ?,W?RIGHT >STACK
	ZERO? STACK /?L1
?L3:	RANDOM 4 >STACK
	ADD 3,STACK >PLAYER-NUM
	RETURN PLAYER-NUM
?L1:	CALL IS-NOUN?,W?BASEMAN >STACK
	ZERO? STACK \?L5
	CALL IS-ADJ?,W?FIRST >STACK
	ZERO? STACK \?L5
	CALL IS-ADJ?,W?SECOND >STACK
	ZERO? STACK \?L5
	CALL IS-ADJ?,W?THIRD >STACK
	ZERO? STACK /?L4
?L5:	RANDOM 5 >PLAYER-NUM
	RETURN PLAYER-NUM
?L4:	CALL IS-NOUN?,W?CATCHER >STACK
	ZERO? STACK /?L6
	RANDOM 3 >PLAYER-NUM
	RETURN PLAYER-NUM
?L6:	CALL IS-NOUN?,W?SHORTSTOP >STACK
	ZERO? STACK /?L7
	RANDOM 3 >STACK
	ADD 4,STACK >PLAYER-NUM
	RETURN PLAYER-NUM
?L7:	RANDOM 8 >PLAYER-NUM
	RETURN PLAYER-NUM

	.FUNCT CON-STAND-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "It's just a ramshackle little stand, apparently staffed by ramshackle little people from the looks of the service everyone is getting."
?L1:	EQUAL? PRSA,V?ENTER,V?THROUGH,V?WALK-TO /?L6
	EQUAL? PRSA,V?BOARD \FALSE
?L6:	EQUAL? HERE,CON-AREA \FALSE
	ZERO? DREAMING /FALSE
	LOC PROTAGONIST >STACK
	EQUAL? STACK,LONG,SHORT \?L7
	LOC PROTAGONIST >STACK
	CALL OUT-OF-FIRST,STACK >STACK
	RSTACK
?L7:	PRINTI "You pass through a gauntlet of angry side-glances, outright dirty looks and verbal abuse. The concessionaire -- ""Okay who's next?"" -- serves somebody else and you walk back against a stream of sadistic sneers."
	CRLF
	CALL PRINT-ID,STR?199 >STACK
	RSTACK

	.FUNCT CONCESSIONAIRE-F
	CALL TALKING-TO?,CONCESSIONAIRE >STACK
	ZERO? STACK \?L3
	EQUAL? PRSA,V?BUY \?L1
?L3:	PRINTI "You're not close enough to the "
	CALL DPRINT,CONCESSIONAIRE
	PRINTI "."
	CRLF
	CALL STOP >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?WALK-TO \FALSE
	EQUAL? HERE,CON-AREA \FALSE
	ZERO? DREAMING /FALSE
	CALL PERFORM,V?WALK-TO,CON-STAND
	RTRUE

	.FUNCT FOUNTAIN-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "It's your standard "
	CALL DPRINT,FOUNTAIN
	PRINTR ", with a button next to the spout."
?L1:	EQUAL? PRSA,V?DRINK-FROM \FALSE
	CALL PERFORM,V?PUSH,BUTTON
	RTRUE

	.FUNCT BUTTON-F
	LOC PROTAGONIST >STACK
	EQUAL? STACK,LONG,SHORT \?L1
	CALL TOUCHING?,BUTTON >STACK
	ZERO? STACK /?L1
	LOC PROTAGONIST >STACK
	CALL OUT-OF-FIRST,STACK >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?PUSH \FALSE
	CALL RUNNING?,I-BOOST >STACK
	ZERO? STACK /?L4
	EQUAL? BOOST-COUNTER,3 \?L6
	SET 'HELPED-THUMB,1
	CALL THUMB-DRINKS
	CALL BOOST-EXIT >STACK
	RSTACK
?L6:	PRINTR "Somebody else is ahead of you."
?L4:	RANDOM 100 >STACK
	LESS? 50,STACK /?L11
	PRINTI "A jet of water hits you square in the eye."
	CRLF
	CALL PRINT-ID,STR?200 >STACK
	RSTACK
?L11:	PRINTI "The sip of water is refreshing on this hot night."
	CRLF
	CALL PRINT-ID,STR?201 >STACK
	RSTACK

	.FUNCT GLOBAL-WATER-F
	EQUAL? HERE,CON-AREA \?L1
	EQUAL? PRSA,V?TASTE,V?DRINK,V?TAKE \FALSE
	CALL PERFORM,V?PUSH,BUTTON
	RTRUE
?L1:	CALL CANT-SEE,GLOBAL-WATER >STACK
	RSTACK

	.FUNCT BACK-YARD-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "You're standing in front of the "
	CALL DPRINT,TURNSTILE
	PRINTR " entrance to a fenced-in area, which is south. To the west stands a droopy tent, and the field continues north and east."
?L1:	EQUAL? RARG,M-ENTER \?L5
	ZERO? CLOWN-EXIT-COUNTER \?L5
	CALL RUNNING?,I-BOOST >STACK
	ZERO? STACK \?L5
	FSET? BURNED-CAGE,RMUNGBIT /?L5
	FSET BURNED-CAGE,RMUNGBIT
	MOVE JOEY,BACK-YARD
	MOVE FLOWER,THUMB
	CALL QUEUE,I-CLOWN-EXIT,-1 >STACK
	PUT STACK,0,1
	RTRUE
?L5:	EQUAL? RARG,M-BEG \?L6
	CALL RUNNING?,I-CLOWN-EXIT >STACK
	ZERO? STACK \?L7
	CALL CANT-WALK? >STACK
	ZERO? STACK \TRUE
?L7:	CALL RUNNING?,I-CLOWN-EXIT >STACK
	ZERO? STACK /FALSE
	EQUAL? PRSA,V?WALK \FALSE
	CALL HELD?,THUMB >STACK
	ZERO? STACK /FALSE
	SET 'CLOWN-EXIT-COUNTER,7
	PRINTR "The midget becomes restless in your arms, halting your stroll."
?L6:	EQUAL? RARG,M-END \FALSE
	ZERO? CLOWN-ALLEY-SCENE /?L13
	FSET? BURNED-CAGE,TOUCHBIT /?L13
	FSET BURNED-CAGE,TOUCHBIT
	CRLF
	PRINT GUARD-CALLS
	PRINTR """You're still around kicking sawdust, huh? Let me give a tip: Be careful, there's no telling what, or who, could be lurking around the lot here at night."""
?L13:	EQUAL? RARG,M-END \FALSE
	IN? GIRL,PROTAGONIST \FALSE
	ZERO? GUARD-KNEW \FALSE
	SET 'GUARD-KNEW,1
	CRLF
	PRINT GUARD-CALLS
	PRINTI """Nice going, towner. It just shows you what can be accomplished when you start out the evening with a little "
	CALL DPRINT,HELIUM
	PRINTR ", eh?"

	.FUNCT I-CLOWN-EXIT,NOT-HOLDING?1=0
	CALL HELD?,THUMB >STACK
	ZERO? STACK \?L1
	SET 'NOT-HOLDING?1,1
?L1:	INC 'CLOWN-EXIT-COUNTER
	EQUAL? HERE,BACK-YARD /?L4
	SET 'CLOWN-EXIT-COUNTER,8
?L4:	EQUAL? CLOWN-EXIT-COUNTER,1 \?L7
	MOVE THUMB,BACK-YARD
	RTRUE
?L7:	EQUAL? CLOWN-EXIT-COUNTER,2 \?L9
	MOVE JOEY,CLOWN-ALLEY
	SET 'FOLLOW-FLAG,2
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	ZERO? HELPED-THUMB \?L10
	SET 'CLOWN-EXIT-COUNTER,7
?L10:	CRLF
	PRINTI "The tall clown, whom you now recognize as Chuckles, barks a hello into the cage. You hear an electronic buzz from the "
	CALL DPRINT,TURNSTILE
	PRINTR " and Chuckles passes through."
?L9:	EQUAL? CLOWN-EXIT-COUNTER,3 \?L15
	ZERO? NOT-HOLDING?1 /?L15
	CRLF
	CALL DPRINT,THUMB
	PRINTR " performs an impromptu handstand."
?L15:	EQUAL? CLOWN-EXIT-COUNTER,4 \?L18
	ZERO? NOT-HOLDING?1 /?L18
	CRLF
	CALL DPRINT,THUMB
	PRINTR " belts out a few verses of a Russian folk song in his high-pitched, squeaky voice while standing on his head."
?L18:	EQUAL? CLOWN-EXIT-COUNTER,5 \?L21
	ZERO? NOT-HOLDING?1 /?L21
	CRLF
	PRINTR "The midget performer does several cartwheels in a figure-eight pattern around the grass field."
?L21:	EQUAL? CLOWN-EXIT-COUNTER,6 \?L24
	ZERO? NOT-HOLDING?1 /?L24
	CRLF
	PRINTI "In front of you, "
	CALL DPRINT,THUMB
	PRINTR " terminates his acrobatics on one knee with a grand gesture of his small arms."
?L24:	EQUAL? CLOWN-EXIT-COUNTER,7 \?L27
	ZERO? NOT-HOLDING?1 /?L27
	CRLF
	CALL DPRINT,THUMB
	PRINTR " is pausing to rest."
?L27:	EQUAL? CLOWN-EXIT-COUNTER,8 \FALSE
	CALL INT,I-CLOWN-EXIT >STACK
	PUT STACK,0,0
	EQUAL? HERE,BACK-YARD \?L31
	CALL HELD?,THUMB >STACK
	ZERO? STACK /?L33
	CRLF
	PRINTI "Wriggling out of your hold, "
	JUMP ?L37
?L33:	CRLF
?L37:	CALL DPRINT,THUMB
	PRINTI ", in his squeaky and high-pitched voice, says ""Hello Harry"" toward the "
	CALL DPRINT,BURNED-CAGE
	PRINTI ". You hear a buzzing sound from the "
	CALL DPRINT,TURNSTILE
	PRINTI " as the midget reaches up to its lowest rung and passes through ..."
	CRLF
?L31:	SET 'THUMB-THRU,1
	CALL INT,I-TURNSTILE >STACK
	PUT STACK,0,0
	FCLEAR THUMB,NDESCBIT
	FCLEAR JOEY,NDESCBIT
	SET 'FOLLOW-FLAG,2
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	MOVE FLOWER,LOCAL-GLOBALS
	MOVE THUMB,CLOWN-ALLEY
	MOVE JOEY,CLOWN-ALLEY
	RTRUE

	.FUNCT CHUTE-DESC,X
	PRINTI "About waist-high, a barred passage for wild animals extends several yards out from the "
	CALL DPRINT,BIGTOP
	IN? NIMROD,CHUTE \?L16
	IN? MEAT,CHUTE /?L17
	PRINTI ". The "
	CALL DPRINT,CHUTE
	PRINTI " is being patrolled by two large "
	FSET? GRATE,OPENBIT /?L9
	PRINTI "and bewildered "
?L9:	PRINTI "cats"
	JUMP ?L16
?L17:	PRINTI ". Inside the chute, Nimrod and Elsie are loudly digging their chops into the "
	CALL DPRINT,MEAT
?L16:	PRINTI "."
	RTRUE

	.FUNCT CHUTE-F,RARG=0
	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L1
	CALL IS-NOUN?,W?BAR >STACK
	ZERO? STACK \?L5
	CALL IS-NOUN?,W?BARS >STACK
	ZERO? STACK /?L3
?L5:	EQUAL? PRSA,V?EXAMINE /FALSE
?L3:	IN? ELSIE,CHUTE \FALSE
	PRINTI "Two lions are "
	IN? MEAT,CHUTE \?L9
	PRINTI "chomping on some meat inside"
	JUMP ?L13
?L9:	PRINTI "strolling the length of"
?L13:	PRINTI " the "
	CALL DPRINT,CHUTE
	CALL MOVE-LIONS,DUMMY-OBJECT
	IN? MEAT,CHUTE \?L18
	MOVE MEAT,DUMMY-OBJECT
?L18:	FIRST? CHUTE >STACK \?L21
	PRINTI ", which also contains"
	CALL PRINT-CONTENTS,CHUTE
?L21:	CALL MOVE-LIONS,CHUTE
	IN? MEAT,DUMMY-OBJECT \?L26
	MOVE MEAT,CHUTE
?L26:	PRINT PERIOD
	RTRUE
?L1:	EQUAL? PRSA,V?ENTER,V?THROUGH,V?BOARD \?L32
	CALL TELL-CLOSELY-SPACED,1 >STACK
	RSTACK
?L32:	EQUAL? PRSA,V?FOLLOW \?L33
	PRINTI "It leads right into the "
	CALL DPRINT,BIGTOP
	PRINTR "."
?L33:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L36
	PRINTI "The rusty grate is inside the "
	CALL DPRINT,BIGTOP
	PRINTR "."
?L36:	EQUAL? PRSA,V?WALK-AROUND \?L39
	CALL PERFORM,V?LOOK-BEHIND,CHUTE
	RTRUE
?L39:	EQUAL? PRSA,V?PUT \?L40
	EQUAL? PRSI,CHUTE \?L40
	EQUAL? PRSO,BALLOON,MOUSE /FALSE
	GETP PRSO,P?SIZE >STACK
	GRTR? STACK,20 \?L43
	EQUAL? PRSO,POLE /?L43
	CALL TELL-CLOSELY-SPACED >STACK
	RSTACK
?L43:	EQUAL? PRSO,MEAT \?L45
	FSET? GRATE,OPENBIT \?L45
	CALL QUEUE,I-LION,2 >STACK
	PUT STACK,0,1
?L45:	MOVE PRSO,CHUTE
	PRINTI "You slip"
	CALL ARTICLE,PRSO,1
	PRINTI " into the "
	CALL DPRINT,CHUTE
	PRINTR "."
?L40:	EQUAL? PRSA,V?REACH-IN \FALSE
	IN? NIMROD,CHUTE \FALSE
	PRINTI "You'd"
	CALL TELL-WITHDRAW-STUMP
	CALL PRINT-ID,STR?202 >STACK
	RSTACK

	.FUNCT IN-CHUTE
	EQUAL? PRSA,V?RUB,V?MOVE,V?TAKE \FALSE
	EQUAL? HERE,BESIDE-BIGTOP \FALSE
	IN? ELSIE,CHUTE \?L3
	PRINTI "If you reached into the "
	CALL DPRINT,CHUTE
	PRINTI " you'd"
	CALL TELL-WITHDRAW-STUMP,1
	CALL PRINT-ID,STR?203 >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?TAKE \FALSE
	EQUAL? PRSO,MEAT \FALSE
	FSET? GRATE,OPENBIT \FALSE
	CALL CANT-REACH,MEAT >STACK
	RSTACK

	.FUNCT TELL-WITHDRAW-STUMP,PRSO?=0
	PRINTI " likely withdraw a stump instead of "
	CALL DPRINT,HANDS
	ZERO? PRSO? /?L3
	PRINTI " or"
	CALL ARTICLE,PRSO,1
?L3:	PRINT PERIOD
	RTRUE

	.FUNCT GRATE-F
	EQUAL? PRSA,V?PUT \?L1
	EQUAL? PRSI,GRATE \?L1
	EQUAL? PRSO,BALLOON /FALSE
	FSET? GRATE,OPENBIT \?L5
	MOVE PRSO,CHUTE
	PRINTI "You fling"
	CALL ARTICLE,PRSO,1
	PRINTI " into the darkness of the passage. "
	EQUAL? PRSO,MOUSE \?L10
	MOVE MOUSE,LOCAL-GLOBALS
	CRLF
	RTRUE
?L10:	IN? NIMROD,DEN \?L12
	EQUAL? PRSO,MEAT \?L12
	PRINT LIONS-WAIT
?L12:	CRLF
	RTRUE
?L5:	PRINTI "The "
	CALL DPRINT,GRATE
	PRINTR " is closed."
?L1:	FSET? GRATE,OPENBIT /?L68
	EQUAL? PRSA,V?PUSH,V?RAISE,V?OPEN /?L20
	FSET? GRATE,OPENBIT \?L19
?L68:	EQUAL? PRSA,V?PUSH,V?LOWER,V?CLOSE \?L19
?L20:	IN? ELSIE,CHUTE \?L22
	EQUAL? PRSA,V?RAISE,V?OPEN \?L24
	CALL PRINT-ID,STR?204
	CALL JIGS-UP,2,STR?205 >STACK
	RSTACK
?L24:	CALL OPEN-GRATE >STACK
	RSTACK
?L22:	IN? MEAT,HERE \?L27
	FSET? GRATE,RMUNGBIT \?L28
	CALL OPEN-GRATE >STACK
	RSTACK
?L28:	FSET GRATE,RMUNGBIT
	CALL OPEN-GRATE,1 >STACK
	RSTACK
?L27:	ZERO? ELSIE-COUNTER \?L31
	PRINTR "Like sentries on guard, the pacing lions prevent this."
?L31:	LESS? ELSIE-COUNTER,3 \?L34
	PRINTI "The "
	CALL DPRINT,ELSIE
	PRINTI " is blocking access to the "
	CALL DPRINT,GRATE
	PRINTR "."
?L34:	CALL HELD?,STOOL >STACK
	ZERO? STACK \?L37
	PRINTI "You're unable to get close enough without the "
	CALL DPRINT,NIMROD
	PRINTI " getting too close to you."
	CRLF
	CALL PRINT-ID,STR?206 >STACK
	RSTACK
?L37:	PRINTI "Using the stool as a barrier against the "
	CALL DPRINT,NIMROD
	PRINTI ", you're able to reach it. "
	CALL OPEN-GRATE >STACK
	RSTACK
?L19:	EQUAL? PRSA,V?EXAMINE,V?LOOK-INSIDE \?L43
	PRINTI "The "
	FSET? GRATE,OPENBIT \?L46
	PRINTI "open"
	JUMP ?L50
?L46:	PRINTI "closed"
?L50:	PRINTI " "
	CALL DPRINT,GRATE
	PRINTI " leads to a passage going away from the round cage. "
	PRINT YOU-SEE
	PRINTR " that it is empty up to the point where it extends outside of the big top."
?L43:	CALL TOUCHING?,GRATE >STACK
	ZERO? STACK \?L56
	EQUAL? PRSA,V?THROUGH,V?BOARD,V?WALK-TO \?L55
?L56:	IN? ELSIE,HERE \?L55
	EQUAL? ELSIE-COUNTER,3 /?L55
	IN? MEAT,HERE /?L55
	PRINTR "You can't get over to the grate."
?L55:	EQUAL? PRSA,V?ENTER,V?THROUGH,V?BOARD \FALSE
	FSET? GRATE,OPENBIT \?L60
	PRINTI "That's dangerous and foolhardy."
	CRLF
	CALL PRINT-ID,STR?207
	RTRUE
?L60:	PRINTR "The grate is closed."

	.FUNCT OPEN-GRATE,EATING-MEAT?=0
	ZERO? EATING-MEAT? /?L1
	PRINTI "The "
	ZERO? ELSIE-COUNTER \?L5
	PRINTI "lions rotate"
	JUMP ?L9
?L5:	CALL DPRINT,NIMROD
	PRINTI " rotates"
?L9:	PRINTI " around the lump of meat, continuing to feed while watching you. "
?L1:	PRINTI "The "
	CALL DPRINT,GRATE
	PRINTI " slides "
	EQUAL? PRSA,V?RAISE,V?OPEN \?L17
	FSET GRATE,OPENBIT
	PRINTI "up, jamming into place. "
	IN? MEAT,CHUTE \?L21
	PRINT LIONS-WAIT
?L21:	CRLF
	RTRUE
?L17:	FCLEAR GRATE,OPENBIT
	PRINTI "down to the "
	CALL DPRINT,GROUND
	PRINTR "."

	.FUNCT BESIDE-BIGTOP-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You're standing next to the "
	CALL DPRINT,BIGTOP
	PRINTR ", which is gently flapping in the warm breeze."

	.FUNCT NEAR-WAGON-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "You are standing on a gentle upslope of the grassy field, next to a rather imposing trailer whose door is "
	FSET? OFFICE-DOOR,OPENBIT \?L5
	PRINTI "open"
	JUMP ?L9
?L5:	PRINTI "closed"
?L9:	PRINTI " to the east"
	FSET? LADDER,RMUNGBIT \?L14
	PRINTI ". Attached to the rear of the trailer is a step"
	CALL DPRINT,LADDER
?L14:	PRINTI ". In dark panorama, the field continues north and west -- and south, where a large banner has been erected."
	CRLF
	FSET? LADDER,RMUNGBIT \FALSE
	CRLF
	CALL TELL-BULL-HOLE >STACK
	RSTACK
?L1:	EQUAL? RARG,M-ENTER \?L24
	CALL QUEUE-THUMB? >STACK
	ZERO? STACK /?L25
	CALL QUEUE,I-THUMB,1 >STACK
	PUT STACK,0,1
?L25:	IN? BULL,LOCAL-GLOBALS \FALSE
	FSET? LADDER,RMUNGBIT /FALSE
	PRINTI "Y"
	CALL NOTICE-LADDER >STACK
	RSTACK
?L24:	EQUAL? RARG,M-BEG \FALSE
	IN? MUNRAB,MEN \FALSE
	IN? GIRL,PROTAGONIST \FALSE
	EQUAL? PRSA,V?WALK \FALSE
	EQUAL? P-WALK-DIR,P?NE /FALSE
	CALL DONT-WALK,GIRL >STACK
	RSTACK

	.FUNCT NOTICE-LADDER
	FSET LADDER,RMUNGBIT
	PRINTI "ou come to the "
	CALL DPRINT,WAGON
	PRINTI " and notice a stepladder attached to its rear."
	CRLF
	CRLF
	RTRUE

	.FUNCT EGRESS-EXIT
	INC 'EGRESS-C
	EQUAL? EGRESS-C,1 \?L1
	SET 'AWAITING-REPLY,10
	CALL QUEUE,I-ARGUMENT,2 >STACK
	PUT STACK,0,1
	PRINTI "Are you sure you're mentally and otherwise prepared to meet up with an "
	CALL DPRINT,EGRESS
	PRINTI "?"
	CRLF
	RFALSE
?L1:	EQUAL? EGRESS-C,2 \?L5
	SET 'AWAITING-REPLY,11
	CALL QUEUE,I-ARGUMENT,2 >STACK
	PUT STACK,0,1
	PRINTI "Then you're fully aware of the ferociousness of this rare mammalian species, right?"
	CRLF
	RFALSE
?L5:	EQUAL? EGRESS-C,3 \?L8
	CALL INT,I-ARGUMENT >STACK
	PUT STACK,0,0
	SET 'AWAITING-REPLY,12
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTI "Alright, so you know all about "
	CALL DPRINT,EGRESS
	PRINTI "es. But do you really want to leave the circus in all of its mystery and all of its pageantry behind?"
	CRLF
	RFALSE
?L8:	GRTR? EGRESS-C,3 \FALSE
	CALL INT,I-ARGUMENT >STACK
	PUT STACK,0,0
	SET 'AWAITING-REPLY,0
	CALL FINISH >STACK
	RSTACK

	.FUNCT I-ARGUMENT
	EQUAL? P-WALK-DIR,P?SOUTH /TRUE
	EQUAL? AWAITING-REPLY,10 \?L4
	EQUAL? PRSA,V?YES /TRUE
?L4:	EQUAL? AWAITING-REPLY,11 \?L1
	EQUAL? PRSA,V?NO /TRUE
?L1:	SET 'AWAITING-REPLY,0
	SET 'EGRESS-C,0
	RETURN EGRESS-C

	.FUNCT TELL-BULL-HOLE
	PRINTI "There is an elephant-sized hole in the fence to the "
	EQUAL? HERE,MEN \?L3
	PRINTI "southwest"
	JUMP ?L7
?L3:	PRINTI "northeast"
?L7:	PRINT PERIOD
	RTRUE

	.FUNCT ON-WAGON-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "You are on the wagon, a condition in which you're not likely to find the detective. The aluminum roofing gives way slightly underfoot. You observe a "
	CALL DPRINT,PANEL
	FSET? PANEL,OPENBIT \?L5
	PRINTI ", which is open"
?L5:	PRINTR ", and next to it, a kind of crank."
?L1:	EQUAL? RARG,M-ENTER \?L12
	FCLEAR OFFICE-DOOR,RMUNGBIT
	FSET? ON-WAGON,TOUCHBIT /FALSE
	CALL QUEUE,I-OFFICE,1 >STACK
	PUT STACK,0,1
	RTRUE
?L12:	EQUAL? RARG,M-BEG \FALSE
	IN? MUNRAB,HERE \FALSE
	FSET? PANEL,OPENBIT \FALSE
	EQUAL? PRSA,V?LEAP \?L18
	ZERO? PRSO /?L17
?L18:	EQUAL? PRSA,V?KILL,V?KICK,V?LEAP \FALSE
	EQUAL? PRSO,WAGON \FALSE
?L17:	CALL DPRINT,MUNRAB
	PRINTI " must have pretty bad hearing, since he doesn't seem to notice the noise coming from the roof."
	CRLF
	EQUAL? PRSA,V?KILL,V?KICK /?L21
	PUSH 0
	JUMP ?L22
?L21:	PUSH 1
?L22:	CALL PRINT-ID,STR?208,STACK >STACK
	RSTACK

	.FUNCT IN-PANEL
	FSET? PANEL,OPENBIT /?L1
	PRINTI "The "
	CALL DPRINT,PANEL
	PRINTI " is closed."
	CRLF
	RFALSE
?L1:	IN? MUNRAB,ON-WAGON \?L5
	PRINTI "Aghast by your dropping in on him like this, "
	CALL DPRINT,MUNRAB
	CALL PRINT-ID,STR?209
	CALL JIGS-UP,3,STR?210
	RFALSE
?L5:	PRINTI "You wriggle through the panel opening."
	CRLF
	CRLF
	CALL PRINT-ID,STR?211
	RETURN OFFICE

	.FUNCT WAGON-F
	EQUAL? PRSA,V?READ,V?EXAMINE \?L1
	EQUAL? HERE,NEAR-WAGON \?L1
	PRINTI "The familiar logo for ""The Travelling Circus That Time Forgot, Inc."" is emblazoned across the long side of the "
	CALL DPRINT,WAGON
	CALL IS-NOUN?,W?LOGO >STACK
	ZERO? STACK /?L5
	PRINT PERIOD
	RTRUE
?L5:	PRINTI ". The "
	CALL OPEN-CLOSED,OFFICE-DOOR
	PRINTI " "
	CALL DPRINT,OFFICE-DOOR
	PRINTI " is at the east"
	FSET? LADDER,RMUNGBIT \?L14
	PRINTI ", and there's"
	CALL TELL-LADDER
?L14:	PRINT PERIOD
	RTRUE
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \?L21
	EQUAL? HERE,ON-WAGON \?L21
	CALL PERFORM,V?LOOK-INSIDE,PANEL
	RTRUE
?L21:	EQUAL? PRSA,V?PUT \?L22
	FSET? PANEL,OPENBIT \?L23
	IN? MUNRAB,ON-WAGON \?L23
	CALL STARTLE-MUNRAB >STACK
	RSTACK
?L23:	CALL V-DIG >STACK
	RSTACK
?L22:	EQUAL? PRSA,V?PUT-ON \?L26
	EQUAL? HERE,ON-WAGON \?L27
	CALL PERFORM,V?DROP,PRSO
	RTRUE
?L27:	CALL V-DIG >STACK
	RSTACK
?L26:	EQUAL? PRSA,V?LOOK-BEHIND,V?WALK-AROUND \?L30
	FSET? LADDER,RMUNGBIT \?L31
	PRINTI "You see"
	CALL TELL-LADDER
	JUMP ?L35
?L31:	PRINTI "A "
	CALL DPRINT,FENCE
	PRINTI " prevents this"
?L35:	PRINT PERIOD
	RTRUE
?L30:	EQUAL? PRSA,V?KNOCK \?L40
	CALL PERFORM,V?KNOCK,OFFICE-DOOR
	RTRUE
?L40:	EQUAL? PRSA,V?ENTER,V?THROUGH,V?WALK-TO /?L42
	EQUAL? PRSA,V?BOARD \?L41
?L42:	EQUAL? HERE,ON-WAGON,NEAR-WAGON \?L43
	CALL DO-WALK,P?IN >STACK
	RSTACK
?L43:	EQUAL? HERE,OFFICE \FALSE
	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L41:	EQUAL? PRSA,V?DISEMBARK \?L49
	EQUAL? HERE,ON-WAGON \?L50
	CALL PERFORM,V?CLIMB-DOWN,LADDER
	RTRUE
?L50:	EQUAL? HERE,OFFICE \FALSE
	CALL DO-WALK,P?UP >STACK
	RSTACK
?L49:	EQUAL? PRSA,V?CLIMB-ON,V?CLIMB-FOO,V?CLIMB-UP \?L54
	FSET? LADDER,RMUNGBIT \?L54
	CALL DO-WALK,P?UP >STACK
	RSTACK
?L54:	EQUAL? PRSA,V?LOOK-UNDER \FALSE
	FSET? POLE,TOUCHBIT /FALSE
	IN? POLE,HERE \FALSE
	GETP POLE,P?FDESC >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT TELL-LADDER
	PRINTI " a narrow ladder attached to the back of the wagon"
	RTRUE

	.FUNCT DOWN-WAGON
	FSET? PANEL,OPENBIT \?L1
	PRINTI "[Do you want to climb down the ladder or climb in through the opening? Type CLIMB DOWN LADDER or IN.]"
	CRLF
	SET 'CLOCK-WAIT,1
	RFALSE
?L1:	CALL DOWN-LADDER >STACK
	RSTACK

	.FUNCT CRANK-F
	EQUAL? PRSA,V?SET \FALSE
	ZERO? PRSI \FALSE
	PRINTI "The crank is rotated "
	FSET? PANEL,RMUNGBIT \?L5
	PRINTI "but the "
	CALL DPRINT,PANEL
	PRINTR " doesn't open."
?L5:	PRINTI "and the "
	CALL DPRINT,PANEL
	PRINTI " gradually slides "
	FSET? PANEL,OPENBIT \?L12
	FCLEAR PANEL,OPENBIT
	PRINTR "closed."
?L12:	FSET PANEL,OPENBIT
	PRINTR "open."

	.FUNCT PANEL-F
	EQUAL? PRSA,V?BOARD,V?THROUGH,V?CLIMB-DOWN \?L1
	CALL DO-WALK,P?IN >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \?L3
	FSET? PANEL,OPENBIT \?L6
	EQUAL? HERE,OFFICE \?L4
?L6:	CALL PERFORM,V?EXAMINE,PANEL
	RTRUE
?L4:	PRINT YOU-SEE
	CALL PRINT-ID,STR?212
	IN? MUNRAB,ON-WAGON \?L10
	PRINTI " the top view of "
	CALL DPRINT,MUNRAB
	PRINTR "'s schlock of silvery blow-dried hair. He is busy at his desk."
?L10:	PRINTR " an unoccupied office."
?L3:	EQUAL? PRSA,V?PUT-ON,V?PUT \?L17
	EQUAL? PRSI,PANEL \?L17
	CALL V-DIG >STACK
	RSTACK
?L17:	EQUAL? PRSA,V?OPEN \?L20
	FSET? PANEL,OPENBIT \?L19
?L20:	EQUAL? PRSA,V?CLOSE \FALSE
	FSET? PANEL,OPENBIT \FALSE
?L19:	EQUAL? HERE,OFFICE \?L21
	CALL CANT-SEE,0,STR?213 >STACK
	RSTACK
?L21:	CALL PERFORM,V?SET,CRANK
	RTRUE

	.FUNCT OFFICE-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "This is "
	CALL DPRINT,MUNRAB
	PRINTI "'s plush inner sanctum, containing all the furnishings of the well-appointed, modern office -- including a shiny, expansive "
	CALL DPRINT,DESK
	PRINTI ". Along one "
	CALL DPRINT,WALLS
	PRINTI ", below some framed sheepskin, runs a "
	CALL DPRINT,BOOKS
	PRINTI ".

The "
	FSET? OFFICE-DOOR,OPENBIT \?L5
	PRINTI "open"
	JUMP ?L9
?L5:	PRINTI "closed"
?L9:	PRINTI " "
	CALL DPRINT,OFFICE-DOOR
	PRINTR " on the west wall appears lockable without a key."
?L1:	EQUAL? RARG,M-ENTER \FALSE
	FSET? OFFICE,TOUCHBIT /FALSE
	ADD SCORE,10 >SCORE
	RFALSE

	.FUNCT SHEET-F
	EQUAL? PRSA,V?EXAMINE,V?READ \FALSE
	SET 'SEEN-SHEET,1
	PRINTI "The spreadsheet shows lists of declining numbers which appear to be the salary of one performer named Eddie Smaldone."
	CRLF
	CALL PRINT-ID,STR?214 >STACK
	RSTACK

	.FUNCT PHONE-F
	EQUAL? PRSA,V?REPLY \?L1
	PRINTR "The ringing is only in your ears."
?L1:	EQUAL? PRSA,V?TAKE \?L5
	PRINTR "You hear a dial tone."
?L5:	EQUAL? PRSA,V?DROP,V?HANG-UP \FALSE
	PRINTR "Slam!"

	.FUNCT POLICE-F
	CALL DONT-HANDLE?,POLICE >STACK
	ZERO? STACK \FALSE
	CALL CANT-SEE,POLICE >STACK
	RSTACK

	.FUNCT FENCE-F
	IN? BULL,MEN \?L1
	CALL IS-NOUN?,W?HOLE >STACK
	ZERO? STACK /?L1
	CALL CANT-SEE,0,STR?215 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L3
	IN? BULL,MEN /?L3
	EQUAL? HERE,MEN,NEAR-WAGON \?L3
	CALL TELL-BULL-HOLE >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?CLIMB-ON,V?CLIMB-FOO,V?CLIMB-UP /?L5
	EQUAL? PRSA,V?CLIMB-OVER \?L4
?L5:	PRINTI "Though hastily constructed, the "
	CALL DPRINT,FENCE
	PRINTR " succeeds as a barrier."
?L4:	EQUAL? PRSA,V?ENTER,V?WALK-TO,V?THROUGH \FALSE
	EQUAL? HERE,MEN \?L9
	CALL DO-WALK,P?SW >STACK
	RSTACK
?L9:	EQUAL? HERE,NEAR-WAGON \FALSE
	CALL DO-WALK,P?NE >STACK
	RSTACK

	.FUNCT EDDIE-F
	CALL DONT-HANDLE?,EDDIE >STACK
	ZERO? STACK /?L1
	EQUAL? PRSA,V?FOLLOW /?L39
	RFALSE
?L1:	EQUAL? PRSA,V?FOLLOW \?L3
?L39:	EQUAL? FOLLOW-FLAG,2 \?L4
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L4:	EQUAL? FOLLOW-FLAG,3 \?L6
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L6:	EQUAL? FOLLOW-FLAG,4 \FALSE
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L3:	FSET? EDDIE,RMUNGBIT /?L9
	PRINTI "You don't know anyone here by that name."
	CRLF
	RETURN 2
?L9:	IN? JOEY,HERE /?L14
	CALL CANT-SEE,EDDIE >STACK
	RSTACK
?L14:	CALL TALKING-TO?,EDDIE >STACK
	ZERO? STACK /?L15
	ZERO? JOEY-NAME-KNOWN /?L16
	ZERO? WON-JOEY \?L18
	CALL JOEY-SCARED? >STACK
	ZERO? STACK /?L18
	RETURN 2
?L18:	PRINTI "To your words "
	CALL DPRINT,JOEY
	PRINTI " responds not."
	CRLF
	CALL STOP >STACK
	RSTACK
?L16:	SET 'JOEY-NAME-KNOWN,1
	INC 'SCARE-NUMBER
	ZERO? WON-JOEY \?L26
	CALL JOEY-SCARED? >STACK
	ZERO? STACK /?L26
	RETURN 2
?L26:	CALL DPRINT,JOEY
	PRINTI " snorts at the sound of the name and continues wiping the "
	CALL DPRINT,TAMER-TRAILER
	PRINTI "."
	CRLF
	CALL STOP >STACK
	RSTACK
?L15:	SET 'JOEY-NAME-KNOWN,1
	ZERO? WON-JOEY \?L34
	CALL JOEY-SCARED? >STACK
	ZERO? STACK /?L34
	RETURN 2
?L34:	CALL JOEY-F >STACK
	RSTACK

	.FUNCT DONT-HANDLE?,PERSON?1
	EQUAL? PERSON?1,PRSO \?L1
	EQUAL? PRSA,V?WHAT,V?FOLLOW,V?FIND /TRUE
	EQUAL? PRSA,V?CALL,V?WALK-TO,V?WHERE /TRUE
	EQUAL? PRSA,V?PHONE-WITH,V?PHONE /TRUE
?L1:	EQUAL? PERSON?1,PRSI \FALSE
	EQUAL? PRSA,V?ASK-FOR,V?TELL-ABOUT,V?ASK-ABOUT /TRUE
	RFALSE

	.FUNCT MEMOS-F
	EQUAL? PRSA,V?LOOK-UNDER,V?MOVE,V?SEARCH /?L3
	EQUAL? PRSA,V?PUSH \?L1
?L3:	PRINTR "This reveals nothing new."
?L1:	EQUAL? PRSA,V?EXAMINE,V?READ \?L6
	PRINTI "The handwriting is frantic and mostly illegible. From what you can make out, the memos, all dated before today, contain threats and expressions of rage from "
	CALL DPRINT,MUNRAB
	PRINTR " toward most of his circus employees."
?L6:	EQUAL? PRSA,V?TAKE \FALSE
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	SET 'AWAITING-REPLY,4
	PRINTR "You? Take a memo?"

	.FUNCT I-OFFICE
	FSET? OFFICE-DOOR,RMUNGBIT \?L1
	FCLEAR OFFICE-DOOR,RMUNGBIT
	RFALSE
?L1:	INC 'OFFICE-C
	EQUAL? OFFICE-C,1 \?L4
	CRLF
	PRINTI "Below you, the "
	CALL DPRINT,OFFICE-DOOR
	PRINTR " swings open and then closed."
?L4:	EQUAL? OFFICE-C,4 \?L8
	EQUAL? HERE,OFFICE \?L9
	EQUAL? PRSA,V?OPEN \?L11
	EQUAL? PRSO,OFFICE-DOOR \?L11
	PRINTI "You hesitate as you "
	JUMP ?L15
?L11:	CRLF
	PRINTI "You "
?L15:	PRINTR "hear footsteps and hushed voices approaching the wagon."
?L9:	CALL MUNRAB-ENTERS-OFFICE >STACK
	RSTACK
?L8:	GRTR? OFFICE-C,4 \FALSE
	EQUAL? HERE,OFFICE \?L22
	EQUAL? OFFICE-C,12 /?L26
	FSET? OFFICE-DOOR,LOCKEDBIT /?L24
?L26:	CALL BARGE-OFFICE
	RTRUE
?L24:	EQUAL? OFFICE-C,5,7,9 /?L28
	EQUAL? OFFICE-C,11 \FALSE
?L28:	CRLF
	PRINTI "You can hear someone outside "
	EQUAL? OFFICE-C,5 /?L31
	PRINTI "still "
?L31:	PRINTR "trying to force open the door."
?L22:	CALL MUNRAB-ENTERS-OFFICE
	RTRUE

	.FUNCT MUNRAB-ENTERS-OFFICE,DOWN-LADDER?=0
	CALL INT,I-OFFICE >STACK
	PUT STACK,0,0
	MOVE MUNRAB,OFFICE
	FSET OFFICE-DOOR,LOCKEDBIT
	FCLEAR DESK,RMUNGBIT
	FSET PANEL,RMUNGBIT
	ZERO? DOWN-LADDER? /?L1
	CALL DPRINT,MUNRAB
	PRINTI " reappears out of the darkness and quickly enters the "
	CALL DPRINT,WAGON
	PRINTI " just as you scramble down the ladder."
	CRLF
	CRLF
	FCLEAR PANEL,OPENBIT
	RTRUE
?L1:	CRLF
	PRINTI "You can hear someone, presumably "
	CALL DPRINT,MUNRAB
	PRINTI ", barge into the office"
	FSET? PANEL,OPENBIT \?L8
	PRINTI ". By remote control he slides the "
	CALL DPRINT,PANEL
	PRINTI " closed"
?L8:	FCLEAR PANEL,OPENBIT
	PRINT PERIOD
	RTRUE

	.FUNCT BARGE-OFFICE
	CRLF
	CALL DPRINT,MUNRAB
	PRINTI " suddenly barges into the office; he's shakily gripping a small caliber pistol. "
	CALL PRINT-ID,STR?216
	CALL JIGS-UP,5,STR?217 >STACK
	RSTACK

	.FUNCT OFFICE-DOOR-F
	EQUAL? PRSA,V?EXAMINE \?L1
	EQUAL? HERE,OFFICE \?L1
	PRINTR "It is lockable from this side."
?L1:	EQUAL? PRSA,V?UNLOCK,V?LOCK,V?OPEN \?L5
	EQUAL? HERE,ON-WAGON \?L5
	CALL NO-POSITION
	RTRUE
?L5:	EQUAL? PRSA,V?OPEN \?L6
	FSET? OFFICE-DOOR,LOCKEDBIT /?L6
	EQUAL? HERE,OFFICE \?L6
	CALL RUNNING?,I-OFFICE >STACK
	ZERO? STACK /?L6
	LESS? OFFICE-C,4 \?L6
	SET 'OFFICE-C,3
	RTRUE
?L6:	EQUAL? PRSA,V?KNOCK \FALSE
	FSET? OFFICE,TOUCHBIT /FALSE
	IN? MUNRAB,ON-WAGON \FALSE
	EQUAL? HERE,ON-WAGON \?L11
	FCLEAR OFFICE-DOOR,LOCKEDBIT
	MOVE MUNRAB,LOCAL-GLOBALS
	CALL QUEUE,I-OFFICE,-1 >STACK
	PUT STACK,0,1
	PRINTI "Below you "
	CALL DPRINT,MUNRAB
	PRINTR " very cautiously steps outside and begins poking around, closing the door behind him. He wanders into the darkness."
?L11:	FSET? OFFICE-DOOR,RMUNGBIT /FALSE
	FSET OFFICE-DOOR,RMUNGBIT
	CALL QUEUE,I-OFFICE,4 >STACK
	PUT STACK,0,1
	CALL DPRINT,MUNRAB
	PRINTR " pops his head out of his office, scowls at you for a moment, then withdraws, shutting the door."

	.FUNCT CLIMB-PANEL
	PRINTI "You climb onto the desk, and hoist yourself through the panel opening."
	CRLF
	CRLF
	RTRUE

	.FUNCT UP-OFFICE
	FSET? DESK,RMUNGBIT \?L1
	SET 'OFFICE-C,5
	CALL CLIMB-PANEL
	RETURN ON-WAGON
?L1:	ZERO? END-GAME /?L3
	CALL V-DIG
	RFALSE
?L3:	PRINTI "You're not"
	PRINT NOT-REACH
	PRINTI "."
	CRLF
	RFALSE

	.FUNCT OFFICE-OBJECT-F
	EQUAL? HERE,ON-WAGON \?L1
	FSET? PANEL,OPENBIT /?L1
	CALL PERFORM,V?EXAMINE,PANEL
	RTRUE
?L1:	EQUAL? PRSA,V?OPEN,V?UNLOCK,V?LOCK /?L4
	EQUAL? PRSA,V?CLOSE \?L3
?L4:	EQUAL? PRSO,OFFICE-OBJECT \?L3
	EQUAL? HERE,OFFICE \?L3
	CALL PERFORM,PRSA,OFFICE-DOOR,PRSI
	RTRUE
?L3:	EQUAL? PRSA,V?LOOK-INSIDE \?L5
	EQUAL? HERE,ON-WAGON \?L5
	CALL PERFORM,V?LOOK-INSIDE,PANEL
	RTRUE
?L5:	EQUAL? HERE,OFFICE \FALSE
	EQUAL? PRSA,V?DISEMBARK \?L6
	CALL DO-WALK,P?UP >STACK
	RSTACK
?L6:	EQUAL? HERE,OFFICE \FALSE
	CALL GLOBAL-ROOM-F >STACK
	RSTACK

	.FUNCT DESK-F
	EQUAL? PRSA,V?STAND-ON,V?BOARD,V?CLIMB-ON \?L1
	FSET? DESK,RMUNGBIT \?L3
	CALL CLIMB-PANEL
	CALL GOTO,ON-WAGON >STACK
	RSTACK
?L3:	PRINTI "You would not be"
	PRINT NOT-REACH
	PRINTR " from where the desk is."
?L1:	EQUAL? PRSA,V?CLOSE,V?LOOK-INSIDE,V?OPEN /?L9
	EQUAL? PRSA,V?EXAMINE \?L8
	CALL IS-NOUN?,W?DRAWER >STACK
	ZERO? STACK /?L8
?L9:	PRINTR "The drawers are all locked up."
?L8:	EQUAL? PRSA,V?SEARCH,V?LOOK-ON,V?EXAMINE \?L12
	PRINTI "The desk is blanketed with a flurry of memos, on top of which rest"
	CALL CCOUNT,DESK >STACK
	EQUAL? STACK,1 \?L15
	PRINTI "s"
?L15:	CALL PRINT-CONTENTS,DESK
	PRINT PERIOD
	RTRUE
?L12:	EQUAL? PRSA,V?MOVE,V?PUSH /?L23
	EQUAL? PRSA,V?PUT-UNDER \FALSE
	EQUAL? PRSI,PANEL \FALSE
?L23:	ZERO? END-GAME \?L26
	FSET? DESK,RMUNGBIT \?L24
?L26:	CALL V-DIG >STACK
	RSTACK
?L24:	FSET DESK,RMUNGBIT
	PRINTI "With all your weight behind it, the desk screeches across the floor to a position under the "
	CALL DPRINT,PANEL
	PRINTI "."
	CRLF
	CALL PRINT-ID,STR?218 >STACK
	RSTACK

	.FUNCT CHAIR-F,RARG=0
	ZERO? RARG \FALSE
	EQUAL? PRSA,V?CLOSE,V?OPEN \?L3
	CALL CANT-OPEN >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?PUT-ON \?L4
	EQUAL? PRSI,CHAIR \?L4
	CALL V-DIG >STACK
	RSTACK
?L4:	EQUAL? PRSO,CHAIR \?L7
	EQUAL? PRSA,V?PUSH,V?MOVE /?L6
?L7:	EQUAL? PRSA,V?PUT-UNDER \FALSE
	EQUAL? PRSI,PANEL \FALSE
?L6:	PRINTI "You wouldn't be"
	PRINT NOT-REACH
	PRINTI " from the "
	CALL DPRINT,CHAIR
	PRINTR "."

	.FUNCT DESK-ON-WAGON-F
	FSET? PANEL,OPENBIT /?L1
	CALL CANT-SEE,DESK-ON-WAGON >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?THROW,V?PUT,V?PUT-ON \?L3
	EQUAL? PRSI,DESK-ON-WAGON \?L3
	CALL STARTLE-MUNRAB >STACK
	RSTACK
?L3:	CALL TOUCHING?,DESK-ON-WAGON >STACK
	ZERO? STACK /FALSE
	CALL CANT-REACH,DESK-ON-WAGON >STACK
	RSTACK

	.FUNCT STARTLE-MUNRAB
	PRINTI "You hesitate, fearful of startling a man who's experiencing the kind of pressure that "
	CALL DPRINT,MUNRAB
	PRINTI " is under. "
	CALL PRINT-ID,STR?219
	FSET? DESK-ON-WAGON,RMUNGBIT \?L3
	PRINTI "There must be another way of getting him out from behind his desk and drawing him out of the "
	CALL DPRINT,WAGON
	PRINTI "."
?L3:	CRLF
	FSET DESK-ON-WAGON,RMUNGBIT
	RTRUE

	.FUNCT DEGREE-F
	EQUAL? PRSA,V?READ,V?EXAMINE \FALSE
	PRINTR "It's an MBA from Harvard Business School."

	.FUNCT BOOKS-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "There are biographies on Walt Disney and Benito Mussolini, a treatise by  Machiavelli, and a copy of ""What They Don't Teach You at Harvard Business School."""
?L1:	EQUAL? PRSA,V?TAKE,V?READ,V?OPEN \FALSE
	CALL V-DIG
	EQUAL? PRSA,V?TAKE /?L6
	PUSH 0
	JUMP ?L7
?L6:	PUSH 1
?L7:	CALL PRINT-ID,STR?220,STACK >STACK
	RSTACK

	.FUNCT BURNED-CAGE-F
	EQUAL? PRSA,V?LOOK-INSIDE \?L1
	PRINT YOU-SEE
	PRINTR " the silhouette of a man sitting quietly in semidarkness."
?L1:	EQUAL? PRSA,V?PUT \?L5
	EQUAL? PRSI,BURNED-CAGE \?L5
	PRINTI "The guard hands"
	CALL ARTICLE,PRSO,1
	PRINTR " back to you."
?L5:	EQUAL? PRSA,V?EXAMINE \?L10
	PRINTR "The fire-damaged cage, perhaps once the home of some big jungle cat, has been converted into some kind of vertical booth."
?L10:	EQUAL? PRSA,V?BOARD,V?ENTER,V?OPEN /?L14
	EQUAL? PRSA,V?THROUGH \FALSE
?L14:	PRINTI "Your attempt merely rattles the cage, and the "
	CALL DPRINT,GUARD
	PRINTR " growls at you to back off."

	.FUNCT GUARD-F
	CALL TALKING-TO?,GUARD >STACK
	ZERO? STACK /?L1
	EQUAL? PRSA,V?ALARM,V?WAVE-AT /?L1
	CALL ENABLED?,I-HELIUM >STACK
	ZERO? STACK /?L1
	ADD SCORE,10 >SCORE
	SET 'SPEAK-HELIUM,1
	CALL QUEUE,I-TURNSTILE,2 >STACK
	PUT STACK,0,1
	PRINTI "The sound of your high-pitched, lighter-than-air voice is startling to "
	CALL DPRINT,ME
	PRINTI ", but very familiar to the "
	CALL DPRINT,GUARD
	PRINTI ". You can hear an electromechanical buzzing sound from the "
	CALL DPRINT,TURNSTILE
	PRINTI "."
	CRLF
	CALL STOP >STACK
	RSTACK
?L1:	EQUAL? GUARD,WINNER \?L5
	EQUAL? PRSA,V?TELL-ABOUT \?L6
	EQUAL? PRSO,ME \?L6
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,GUARD,PRSI
	SET 'WINNER,GUARD
	RTRUE
?L6:	EQUAL? PRSA,V?WHAT,V?WHO \?L8
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,GUARD,PRSO
	SET 'WINNER,GUARD
	RTRUE
?L8:	EQUAL? PRSA,V?RUB \?L9
	CALL HELD?,PRSO,PROTAGONIST >STACK
	ZERO? STACK /?L9
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?GIVE,PRSO,GUARD
	SET 'WINNER,GUARD
	RTRUE
?L9:	EQUAL? PRSA,V?WHERE \?L10
	EQUAL? PRSO,GIRL \?L10
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,GUARD,PRSO
	SET 'WINNER,GUARD
	RTRUE
?L10:	EQUAL? PRSA,V?THANK,V?HELLO \?L11
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,PRSA,GUARD
	SET 'WINNER,GUARD
	RTRUE
?L11:	EQUAL? PRSA,V?YES \?L12
	EQUAL? AWAITING-REPLY,6 \?L12
	CALL V-YES >STACK
	RSTACK
?L12:	EQUAL? PRSA,V?NO \?L13
	EQUAL? AWAITING-REPLY,6 \?L13
	CALL V-NO >STACK
	RSTACK
?L13:	PRINTI "The guard just sits quietly in his cage."
	CRLF
	CALL STOP >STACK
	RSTACK
?L5:	EQUAL? PRSA,V?KISS \?L17
	FSET? PINK-BOX,RMUNGBIT \?L17
	PRINTI "Of course, he's your blind date."
	CRLF
	CALL PRINT-ID,STR?221 >STACK
	RSTACK
?L17:	CALL HURT?,GUARD >STACK
	ZERO? STACK /?L20
	CALL PRINT-ID,STR?222
	CALL JIGS-UP,5,STR?223 >STACK
	RSTACK
?L20:	EQUAL? PRSA,V?EXAMINE \?L21
	PRINT YOU-SEE
	PRINTI " the shadowy outline of a man who's wearing a dark "
	CALL DPRINT,SUNGLASSES
	PRINTR "."
?L21:	EQUAL? PRSA,V?GIVE \?L24
	EQUAL? PRSI,GUARD \?L24
	EQUAL? PRSO,WHIP \?L25
	CALL PERFORM,V?ASK-ABOUT,GUARD,WHIP
	RTRUE
?L25:	EQUAL? PRSO,THUMB,GIRL \?L27
	PRINTI "The "
	CALL DPRINT,GUARD
	PRINTI " refuses "
	CALL DPRINT,PRSO
	PRINTR "."
?L27:	CALL TRAP-SET? >STACK
	ZERO? STACK /?L30
	PRINTI "Harry must've smelled a rat, since he rejects your offer out of hand, thereby putting a damper on your sadistic glee."
	CRLF
	CALL PRINT-ID,STR?224 >STACK
	RSTACK
?L30:	PRINTI "While you're still holding"
	CALL ARTICLE,PRSO,1
	PRINTI ", the guard moves his hands gently over it and says, "
	EQUAL? PRSO,CASE \?L38
	SET 'GUARD-FELT-CASE,1
	PRINTI """Oh, that's Andrew's "
	CALL DPRINT,CASE
	PRINTR ". He's one to steal a smoke now and then; behind Jenny's back, of course. She'd kill him if she ever found out."""
?L38:	PRINTI """Feels like"
	EQUAL? PRSO,SHEET \?L45
	PRINTI " paper"
	JUMP ?L52
?L45:	EQUAL? PRSO,TAFT \?L49
	PRINTI " cardboard"
	JUMP ?L52
?L49:	CALL ARTICLE,PRSO
?L52:	PRINTR " to me."""
?L24:	EQUAL? PRSA,V?SHOW \?L55
	EQUAL? PRSO,MUSIC,RADIO,HEADPHONES /?L55
	EQUAL? PRSI,GUARD \?L55
	PRINTI "Not surprisingly, the "
	CALL DPRINT,GUARD
	PRINTI " is oblivious to"
	CALL ARTICLE,PRSO,1
	PRINT PERIOD
	RTRUE
?L55:	EQUAL? PRSA,V?THANK \?L60
	PRINTI "The "
	CALL DPRINT,GUARD
	PRINTR " nods slowly."
?L60:	EQUAL? PRSA,V?HELLO \?L63
	PRINTR """Well, good evening to you."""
?L63:	EQUAL? PRSA,V?ASK-ABOUT \FALSE
	EQUAL? PRSO,GUARD \FALSE
	EQUAL? PRSI,GIRL \?L67
	FSET? PROTAGONIST,RMUNGBIT \?L69
	PRINTI "The "
	CALL DPRINT,GUARD
	PRINTI " remains silent."
	CRLF
	JUMP ?L146
?L69:	CALL QUEUE,I-DID,2 >STACK
	PUT STACK,0,1
	SET 'AWAITING-REPLY,6
	PRINTI """But you already asked me about her, right?"""
	CRLF
	JUMP ?L146
?L67:	EQUAL? PRSI,FAT \?L76
	PRINTI """Well, she's tried various diets, but then "
	CALL DPRINT,MUNRAB
	PRINTI " orders our "
	CALL DPRINT,JIM
	PRINTI " to increase the frequency of her feedings."
	CRLF
	JUMP ?L146
?L76:	EQUAL? PRSI,HYP \?L79
	PRINTI """"
	CALL DPRINT,HYP
	PRINTI "? Harrumph. Don't waste your money."""
	CRLF
	JUMP ?L146
?L79:	EQUAL? PRSI,THUMB \?L82
	PRINTI """A very popular attraction, small but charismatic."""
	CRLF
	JUMP ?L146
?L82:	EQUAL? PRSI,TAMER \?L85
	PRINTI """Nothing but a glory hog, and always just one step ahead of the ASPCA."""
	CRLF
	JUMP ?L146
?L85:	EQUAL? PRSI,JOEY \?L88
	FSET? JOEY,RMUNGBIT /?L88
	FSET JOEY,RMUNGBIT
	PRINTI """A very accomplished performer, takes a lot of pride in his craft. Until..."" The "
	CALL DPRINT,GUARD
	PRINTI " stops himself."
	CRLF
	JUMP ?L146
?L88:	EQUAL? PRSI,MUNRAB,CIRCUS \?L91
	FSET? CIRCUS,RMUNGBIT \?L92
	PRINTI """I've given my opinion."""
	CRLF
	JUMP ?L146
?L92:	FSET CIRCUS,RMUNGBIT
	PRINTI "He suddenly blurts out, ""Well I can tell you this is one circus that's headed for the barn. It's that doggone "
	CALL DPRINT,MUNRAB
	PRINTI " and his vainglorious dreams. They're not panning out for him, and the more he puts the squeeze on all of us, the more dangerous this lot becomes."""
	CRLF
	JUMP ?L146
?L91:	EQUAL? PRSI,JENNY,ANDREW,HERM \?L99
	FSET? HERM,RMUNGBIT /?L100
	FSET HERM,RMUNGBIT
	EQUAL? PRSI,JENNY \?L102
	PRINTI """She"
	JUMP ?L106
?L102:	PRINTI """He"
?L106:	PRINTI " ... er, they ... uh, whatever it is -- bizarre is all I can say. You'd swear they were two different people."""
	CRLF
	JUMP ?L146
?L100:	PRINTI """"
	CALL DPRINT,ANDREW
	PRINTI "'s always considered "
	CALL DPRINT,JENNY
	PRINTI " a thorn in his side. Of course, "
	CALL DPRINT,JENNY
	PRINTI "'s always trying to keep him on the straight and narrow. Which is cherry pie, considering this is the circus life and all."""
	CRLF
	JUMP ?L146
?L99:	EQUAL? PRSI,JIM-GLOBAL,JIM \?L114
	PRINTI """Yea, sad story. Just another guy who fell out the social safety net, if you will, and landed in the circus. And not on his feet either. So "
	CALL DPRINT,MUNRAB
	PRINTI " overworks him, has him living in a cage. That's the life here, that's the circus life for the most."""
	CRLF
	JUMP ?L146
?L114:	EQUAL? PRSI,BURNED-CAGE \?L117
	PRINTI """It's home."""
	CRLF
	JUMP ?L146
?L117:	EQUAL? PRSI,EDDIE \?L120
	ZERO? SEEN-SHEET \?L121
	PRINTI "You don't know anyone by that name."
	CRLF
	JUMP ?L146
?L121:	FSET EDDIE,RMUNGBIT
	PRINTI """That's "
	CALL DPRINT,JOEY
	PRINTI "'s real name."""
	CRLF
	JUMP ?L146
?L120:	EQUAL? PRSI,BULL \?L128
	PRINTI """Very funny. Asking someone in my condition to describe an "
	CALL DPRINT,BULL
	PRINTI "."""
	CRLF
	JUMP ?L146
?L128:	EQUAL? PRSI,APE \?L131
	PRINTI """"
	CALL DPRINT,APE
	PRINTI "? I used to work with him. You know you could practically put him to sleep with soft music. That's how he got his name. Along with his mean streak too, of course. In fact I used to play the violin for him at night after all the towners would go home. That was the old days."""
	CRLF
	JUMP ?L146
?L131:	EQUAL? PRSI,CON \?L134
	PRINTI """He used to sell Amway. Then he joined on here as a Monday Man, which is where he got his name. All that was before Munrab, of course."""
	CRLF
	JUMP ?L146
?L134:	EQUAL? PRSI,NIMROD,ELSIE,LION-NAME /?L138
	EQUAL? PRSI,SUNGLASSES,GUARD,WHIP \?L137
?L138:	FSET? LION-NAME,RMUNGBIT \?L139
	PRINTI """I would rather not talk any further about my past life with the lions."""
	CRLF
	JUMP ?L146
?L139:	FSET LION-NAME,RMUNGBIT
	PRINTI "After a moment of tense silence, the guard impulsively tears off his sunglasses and thrusts his head forward into the light. You flinch at the sight of a slashing scar which engulfs both eye sockets.
  
The guard calms back down. ""Nimrod did this to me. He refuses the whip, unlike Elsie, who is controlled only by the whip."""
	CRLF
	JUMP ?L146
?L137:	PRINTR """I really can't say."""
?L146:	INC 'GUARD-C
	FSET? GUARD,RMUNGBIT /TRUE
	GRTR? GUARD-C,2 \TRUE
	CALL ENABLED?,I-DID >STACK
	ZERO? STACK \TRUE
	EQUAL? PRSI,ELSIE,NIMROD,LION-NAME /TRUE
	FSET GUARD,RMUNGBIT
	CRLF
	PRINTR "The guard breathes a sigh, and continues, ""I don't need eyeballs to size up a First of May like you. Listen to me, if you think you're going to sport around the lot asking a bunch of questions and expect answers, forget it. These people are in no mood for lot loafers."""

	.FUNCT SUNGLASSES-F
	EQUAL? PRSA,V?TAKE \FALSE
	PRINTI "You can't, since that would be blind theft."
	CRLF
	CALL PRINT-ID,STR?225 >STACK
	RSTACK

	.FUNCT TURNSTILE-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "It's the fish skeleton type, with three sets of horizontal ribs extending from a vertical spine."
	EQUAL? HERE,CON-AREA \?L5
	PRINTI " Built into the "
	CALL DPRINT,TURNSTILE
	PRINTI " is a "
	CALL DPRINT,SLOT
	PRINTI "."
?L5:	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?PUT \?L10
	EQUAL? PRSO,TICKET \?L10
	EQUAL? HERE,CON-AREA \?L11
	CALL PERFORM,V?PUT,TICKET,SLOT
	RTRUE
?L11:	CALL CANT-SEE,0,STR?226 >STACK
	RSTACK
?L10:	EQUAL? PRSA,V?CLIMB-UP,V?CLIMB-ON,V?CLIMB-OVER /?L15
	EQUAL? PRSA,V?LEAP,V?CLIMB-FOO \?L14
?L15:	PRINTI "You cannot scale the "
	CALL DPRINT,TURNSTILE
	PRINTR "."
?L14:	EQUAL? PRSA,V?PUSH,V?SET,V?OPEN /?L19
	EQUAL? PRSA,V?MOVE,V?WALK-TO,V?THROUGH \FALSE
?L19:	EQUAL? HERE,EAST-CAMP \?L20
	CALL DO-WALK,P?NORTH >STACK
	RSTACK
?L20:	EQUAL? HERE,BACK-YARD \?L22
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L22:	EQUAL? HERE,CON-AREA \?L23
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L23:	EQUAL? HERE,MIDWEST \FALSE
	CALL DO-WALK,P?WEST >STACK
	RSTACK

	.FUNCT PSEUDO-TURNSTILE-DESC,X
	PRINTI "Adjacent to the turnstile to your south is a vertical cage."
	RTRUE

	.FUNCT SLOT-F
	EQUAL? HERE,MIDWEST \?L1
	PRINTI "The slot's on the other side of the "
	CALL DPRINT,TURNSTILE
	PRINTR "."
?L1:	EQUAL? PRSA,V?PUT \?L5
	EQUAL? PRSI,SLOT \?L5
	EQUAL? PRSO,BLUE-BOX,PINK-BOX /FALSE
	EQUAL? PRSO,TICKET \?L8
	PRINTI "You feed "
	CALL DPRINT,TICKET
	PRINTI " into the slot "
	FSET? BLUE-BOX,RMUNGBIT /?L13
	FSET? PINK-BOX,RMUNGBIT \?L11
?L13:	CALL QUEUE,I-TURNSTILE,2 >STACK
	PUT STACK,0,1
	PRINTI "and hear all kinds of internal computations being made, then the ticket rolls out into "
	CALL DPRINT,HANDS
	PRINTR "."
?L11:	PRINTR "but it's immediately rejected. Perhaps you didn't follow the directions on the ticket."
?L8:	PRINTI "The slot is not configured to accept"
	CALL ARTICLE,PRSO,1
	PRINT PERIOD
	RTRUE
?L5:	EQUAL? PRSA,V?EXAMINE \?L24
	PRINTI "The "
	CALL DPRINT,SLOT
	PRINTR " is a few inches long."
?L24:	EQUAL? PRSA,V?LOOK-INSIDE \?L27
	PRINTR "It's dark."
?L27:	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	CALL V-COUNT >STACK
	RSTACK

	.FUNCT I-TURNSTILE
	CALL INT,I-TURNSTILE >STACK
	PUT STACK,0,0
	EQUAL? HERE,BACK-YARD,CON-AREA \FALSE
	CRLF
	PRINTI "The "
	CALL DPRINT,TURNSTILE
	PRINTI " goes ""click."""
	CRLF
	RFALSE

	.FUNCT TURNSTILE-EXIT
	CALL ENABLED?,I-TURNSTILE >STACK
	ZERO? STACK \?L3
	EQUAL? HERE,EAST-CAMP,MIDWEST \?L1
?L3:	FSET? CANVAS,RMUNGBIT /?L6
	EQUAL? HERE,EAST-CAMP \?L6
	FSET? PSEUDO-TURNSTILE,RMUNGBIT /?L6
	FSET PSEUDO-TURNSTILE,RMUNGBIT
	PRINTI "The image of a burning bridge suddenly pops into your mind as you veer away from the "
	CALL DPRINT,TURNSTILE
	PRINTI "."
	CRLF
	RFALSE
?L6:	CALL TELL-PASS-TURNSTILE
	EQUAL? HERE,BACK-YARD \?L12
	RETURN EAST-CAMP
?L12:	EQUAL? HERE,EAST-CAMP \?L14
	RETURN BACK-YARD
?L14:	EQUAL? HERE,MIDWEST \?L15
	RETURN CON-AREA
?L15:	RETURN MIDWEST
?L1:	PRINTI "The "
	CALL DPRINT,TURNSTILE
	PRINTI " won't budge."
	CRLF
	RFALSE

	.FUNCT TELL-PASS-TURNSTILE
	PRINTI "You pass through the creaky "
	CALL DPRINT,TURNSTILE
	CALL RUNNING?,I-CLOWN-EXIT >STACK
	ZERO? STACK /?L3
	IN? THUMB,CLOWN-ALLEY /?L3
	SET 'CLOWN-EXIT-COUNTER,7
	PRINTI " right behind a scrambling "
	CALL DPRINT,THUMB
?L3:	PRINTI "."
	CRLF
	CRLF
	RTRUE

	.FUNCT PROP-ROOM-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	CALL PRINT-ID,STR?227
	ZERO? MEET-COUNTER \?L3
	CALL QUEUE,I-MEET,1 >STACK
	PUT STACK,0,1
?L3:	FSET? MOUSE,TOUCHBIT /?L6
	FSET? TRAP,TOUCHBIT \?L6
	IN? CHEESE,PROP-ROOM \?L6
	MOVE CHEESE,LOCAL-GLOBALS
	PRINTI "You immediately notice that the "
	CALL DPRINT,CHEESE
	PRINTI " you left here is gone."
	CRLF
	CRLF
	RFALSE
?L6:	IN? TRAP,PROP-ROOM \FALSE
	FSET? TRAP,TOUCHBIT \FALSE
	FSET? MOUSE,TOUCHBIT /FALSE
	MOVE MOUSE,PROP-ROOM
	IN? CHEESE,TRAP /?L11
	MOVE MOUSE,LOCAL-GLOBALS
	RFALSE
?L11:	FSET? TRAP,RMUNGBIT \?L14
	FSET? CHEESE,RMUNGBIT \?L16
	FSET TRAP,NDESCBIT
	RTRUE
?L16:	FSET CHEESE,RMUNGBIT
	RTRUE
?L14:	FSET? CHEESE,RMUNGBIT \?L20
	FSET TRAP,RMUNGBIT
	FCLEAR TRAP,NDESCBIT
	MOVE CHEESE,LOCAL-GLOBALS
	MOVE MOUSE,LOCAL-GLOBALS
	MOVE DEAD-MOUSE,TRAP
	PRINTI "You hear a loud ""SNAP!"" as you enter."
	CRLF
	CRLF
	CALL PRINT-ID,STR?228 >STACK
	RSTACK
?L20:	FSET CHEESE,RMUNGBIT
	RTRUE
?L1:	EQUAL? RARG,M-LOOK \?L26
	PRINTI "This dimly lighted tent houses a ragtag collection of outrageous props and wacky devices, including a midget automobile that's garaged in here."
	FSET? CANVAS,RMUNGBIT \?L29
	PRINTI " To the shadowy south is where you passed through the pleats of the "
	CALL DPRINT,CANVAS
	PRINTI "."
?L29:	CRLF
	RTRUE
?L26:	EQUAL? RARG,M-BEG \FALSE
	ZERO? HIDING /?L35
	CALL RUNNING?,I-MEET >STACK
	ZERO? STACK /?L35
	GRTR? MEET-COUNTER,1 \?L35
	CALL DISTURB?,MUNRAB >STACK
	ZERO? STACK \?L38
	CALL DISTURB?,DICK >STACK
	ZERO? STACK \?L38
	EQUAL? PRSA,V?DISEMBARK,V?STAND,V?WALK /?L38
	EQUAL? PRSA,V?TAKE \?L35
?L38:	CALL END-MEETING >STACK
	RSTACK
?L35:	IN? MUNRAB,HERE \FALSE
	EQUAL? PRSA,V?EXAMINE \FALSE
	EQUAL? PRSO,MUNRAB,DICK \FALSE
	PRINTI "You take a peek ... "
	CRLF
	CRLF
	RFALSE

	.FUNCT PLEAT-EXIT
	CALL RUNNING?,I-MEET >STACK
	ZERO? STACK /?L1
	CALL EXIT-PROP-ROOM
	RFALSE
?L1:	FSET? CANVAS,RMUNGBIT \?L3
	CALL TELL-PASS-CANVAS
	EQUAL? HERE,WEST-CAMP \?L4
	RETURN PROP-ROOM
?L4:	RETURN WEST-CAMP
?L3:	EQUAL? HERE,WEST-CAMP \?L7
	SET 'P-IT-OBJECT,CANVAS
	PRINTI "You encounter a pleated wall of canvas."
	JUMP ?L10
?L7:	PRINT CANT-GO
?L10:	CRLF
	RFALSE

	.FUNCT TELL-PASS-CANVAS
	EQUAL? MEET-COUNTER,10 \?L1
	IN? TRAP,LOCAL-GLOBALS \?L1
	MOVE TRAP,PROP-ROOM
	CALL QUEUE,I-HYP,1 >STACK
	PUT STACK,0,1
	PRINTI "You make your way through the pleats, and just inside the tent you notice a small "
	CALL DPRINT,TRAP
	PRINTI " on the "
	CALL DPRINT,GROUND
	JUMP ?L5
?L1:	PRINTI "The rough-hewn canvas is abrasive as you pass through"
?L5:	PRINTI " ..."
	CRLF
	CRLF
	RTRUE

	.FUNCT EXIT-PROP-ROOM
	LESS? MEET-COUNTER,7 \?L1
	CALL RUNNING?,I-MEET >STACK
	ZERO? STACK \?L5
	EQUAL? MEET-COUNTER,0,1 \FALSE
?L5:	EQUAL? MEET-COUNTER,0,1 \?L6
	PRINTI "Taft's eyes follow your movement, halting you unsettlingly."
	JUMP ?L10
?L6:	PRINTI "Realizing you could be facing trespassing charges, you hesitate."
?L10:	CRLF
	RFALSE
?L1:	RETURN BACK-YARD

	.FUNCT TRAP-F
	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L1
	FSET? TRAP,TOUCHBIT \?L1
	PRINTI "The "
	CALL DPRINT,TRAP
	PRINTI " is"
	FSET? TRAP,RMUNGBIT \?L5
	PRINTI " not"
?L5:	PRINTI " set"
	IN? CHEESE,TRAP \?L12
	PRINTI "; there is a bit of cheese in the trap"
	JUMP ?L16
?L12:	IN? MOUSE,TRAP \?L16
	PRINTI ". A "
	CALL DPRINT,DEAD-MOUSE
	PRINTI " rests under the bar"
?L16:	PRINT PERIOD
	RTRUE
?L1:	EQUAL? PRSA,V?PUT-ON \?L22
	EQUAL? PRSO,BUCKET \?L22
	FSET? TRAP,NDESCBIT \?L23
	IN? MOUSE,HERE \?L23
	CALL PERFORM,V?TAKE-WITH,MOUSE,BUCKET
	RTRUE
?L23:	CALL V-DIG >STACK
	RSTACK
?L22:	CALL TOUCHING?,TRAP >STACK
	ZERO? STACK /?L26
	FSET? TRAP,NDESCBIT \?L26
	PRINTI "Blunder of blunders! "
	CALL PERFORM,V?RUB,MOUSE
	RTRUE
?L26:	EQUAL? PRSA,V?OPEN \?L31
	ZERO? PRSI /?L30
?L31:	EQUAL? PRSA,V?SET \?L29
	ZERO? PRSI \?L29
?L30:	IN? MOUSE,TRAP \?L32
	PRINTI "A "
	CALL DPRINT,DEAD-MOUSE
	PRINTR " is in it!"
?L32:	FSET? TRAP,RMUNGBIT \?L36
	FCLEAR TRAP,RMUNGBIT
	PRINTR "Painstakingly, you set the trap."
?L36:	CALL PRINT-ID,STR?229
	CALL RASH-ACT,1 >STACK
	RSTACK
?L29:	EQUAL? PRSA,V?PUT-ON,V?PUT \?L40
	EQUAL? PRSO,CHEESE \?L40
	FSET? TRAP,RMUNGBIT \?L41
	MOVE CHEESE,TRAP
	PRINTI "The "
	CALL DPRINT,CHEESE
	PRINTR " is now clamped into the trap."
?L41:	CALL RASH-ACT
	CALL PRINT-ID,STR?230
	RTRUE
?L40:	EQUAL? PRSA,V?TAKE \?L46
	FSET? TRAP,TOUCHBIT \?L46
	FSET? TRAP,RMUNGBIT /?L46
	CALL ITAKE >STACK
	EQUAL? STACK,1 \TRUE
	PRINTI "With great care you pick up the loaded "
	CALL DPRINT,TRAP
	PRINTR "."
?L46:	CALL TOUCHING?,TRAP >STACK
	ZERO? STACK /?L52
	FSET? TRAP,RMUNGBIT /?L52
	EQUAL? PRSA,V?PUT-ON /?L52
	PUTP TRAP,P?SDESC,STR?231
	EQUAL? PRSA,V?WHIP /?L53
	ZERO? PRSI /?L55
	EQUAL? PRSI,HANDS \?L53
?L55:	FSET? TRAP,TOUCHBIT \?L56
	CALL PRINT-ID,STR?232
	CALL RASH-ACT
	RTRUE
?L56:	FSET TRAP,RMUNGBIT
	CALL QUEUE,I-CURSE,-1 >STACK
	PUT STACK,0,1
	FSET TRAP,TOUCHBIT
	FCLEAR TRAP,NDESCBIT
	MOVE TRAP,PROTAGONIST
	MOVE CHEESE,TRAP
	PRINT INSTANT
	PRINTI "between the realization that you've caused "
	CALL DPRINT,ME
	PRINTI " excruciating Pain and the actual onslaught of such Pain, during which time most people speak with exclamation points and ... well, say things like ..."
	CRLF
	CALL PRINT-ID,STR?233
	RETURN 2
?L53:	CALL BACKFLIP >STACK
	RSTACK
?L52:	EQUAL? PRSA,V?CLOSE \FALSE
	FSET? TRAP,RMUNGBIT \?L65
	PRINTR "It is."
?L65:	CALL BACKFLIP
	RTRUE

	.FUNCT TRAP-SET?
	EQUAL? PRSO,TRAP \FALSE
	FSET? TRAP,RMUNGBIT /FALSE
	RTRUE

	.FUNCT BACKFLIP
	FSET? TRAP,TOUCHBIT /?L1
	MOVE CHEESE,TRAP
?L1:	FSET TRAP,TOUCHBIT
	FSET TRAP,RMUNGBIT
	PRINTI """Snap!"" The "
	EQUAL? PRSO,TRAP \?L6
	CALL DPRINT,PRSO
	EQUAL? PRSA,V?PUT \?L15
	PRINTI " touches the side of the "
	CALL DPRINT,PRSI
	PRINTI " and"
	JUMP ?L15
?L6:	CALL DPRINT,PRSI
?L15:	PRINTI " does a backflip "
	CALL HELD?,TRAP >STACK
	ZERO? STACK /?L20
	PRINTI "out of "
	CALL DPRINT,HANDS
	PRINTI "s and "
?L20:	PRINTI "into the air."
	CRLF
	MOVE TRAP,HERE
	RTRUE

	.FUNCT RASH-ACT,ALREADY=0
	PRINTI "A rash act, considering the trap is "
	ZERO? ALREADY /?L3
	PRINTI "already "
?L3:	PRINTR "loaded."

	.FUNCT I-CURSE
	RFALSE

	.FUNCT CHEESE-F
	CALL TOUCHING?,CHEESE >STACK
	ZERO? STACK /?L1
	FSET? TRAP,NDESCBIT \?L1
	CALL PERFORM,V?RUB,MOUSE
	RTRUE
?L1:	CALL TOUCHING?,CHEESE >STACK
	ZERO? STACK /?L3
	FSET? TRAP,RMUNGBIT /?L3
	IN? CHEESE,TRAP \?L3
	CALL PRINT-ID,STR?234
	CALL RASH-ACT >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?TAKE \?L4
	IN? CHEESE,TRAP \?L4
	FSET? TRAP,RMUNGBIT /?L4
	CALL ITAKE >STACK
	EQUAL? STACK,1 \?L4
	PRINTR "With great care, you take the cheese."
?L4:	EQUAL? PRSA,V?EAT \?L7
	MOVE CHEESE,LOCAL-GLOBALS
	PRINTI "Your nose twitches as you nibble away the "
	CALL DPRINT,CHEESE
	PRINTR "."
?L7:	EQUAL? PRSA,V?SMELL \FALSE
	PRINTR "Camembert, 1979."

	.FUNCT MOUSE-DESC,X
	FSET? TRAP,NDESCBIT \?L1
	PRINTI "Over in the "
	CALL DPRINT,CORNER
	PRINTI ", a "
	CALL DPRINT,MOUSE
	PRINTI " gnaws timidly at the "
	CALL DPRINT,TRAP
	PRINTI "."
	RTRUE
?L1:	PRINTI "You can hear the faint scurryings of a rodent somewhere in the tent."
	RTRUE

	.FUNCT MOUSE-F,X
	CALL HELD?,MOUSE >STACK
	ZERO? STACK \?L1
	IN? MOUSE,BUCKET /?L1
	EQUAL? PRSA,V?LISTEN /?L1
	FSET? TRAP,NDESCBIT /?L1
	EQUAL? HERE,PROP-ROOM \?L1
	CALL CANT-SEE,MOUSE >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L3
	IN? MOUSE,PROTAGONIST \?L4
	PRINTI "The "
	CALL DPRINT,MOUSE
	PRINTR " calms for a moment, twitches its bewhiskered snout at you, then continues swimming its forepaws silently into the air."
?L4:	IN? MOUSE,BUCKET \FALSE
	ZERO? MOUSE-PISSED /FALSE
	PRINTI "It keeps"
	PRINT TREADMILL
	PRINTR ". That noise is getting to you."
?L3:	EQUAL? PRSA,V?GIVE \?L12
	EQUAL? PRSO,CHEESE \?L12
	IN? MOUSE,PROTAGONIST \?L13
	PRINTR "It's in no position for a feeding."
?L13:	CALL FEED-MOUSE >STACK
	RSTACK
?L12:	EQUAL? PRSA,V?TAKE \?L18
	IN? MOUSE,BUCKET \?L18
	CALL ITAKE >STACK
	EQUAL? STACK,1 \TRUE
	SET 'MOUSE-PISSED,1
	PRINTR "You grasp the slick, narrow tail and lift, feeling the rodent's buzzing metabolism vibrate at your fingertips."
?L18:	FSET? MOUSE,TOUCHBIT /?L24
	EQUAL? PRSA,V?PUT-ON \?L26
	EQUAL? PRSO,BUCKET /?L25
?L26:	EQUAL? PRSA,V?TAKE,V?TAKE-WITH \?L24
	EQUAL? PRSI,BUCKET \?L24
?L25:	IN? WATER,BUCKET \?L27
	CALL PERFORM,V?DROP,WATER
	CRLF
	CALL PERFORM,V?RUB,MOUSE
	RTRUE
?L27:	FIRST? BUCKET >X \?L29
	PRINTI "Tumbling out of your "
	CALL DPRINT,BUCKET
	PRINTI " come"
	NEXT? X >STACK /?L32
	PRINTI "s"
?L32:	CALL PRINT-CONTENTS,BUCKET,1
	PRINT PERIOD
	CALL ROB,BUCKET,HERE
	CRLF
	CALL PERFORM,V?RUB,MOUSE
	RTRUE
?L29:	FCLEAR TRAP,NDESCBIT
	FSET MOUSE,TOUCHBIT
	ADD SCORE,10 >SCORE
	MOVE MOUSE,BUCKET
	PRINTI "You can almost hear the tramplings of the world beating a path to your door as, with a deft swoop of the "
	CALL DPRINT,BUCKET
	PRINTI ", you capture the "
	CALL DPRINT,MOUSE
	PRINTI ". It immediately begins"
	PRINT TREADMILL
	PRINTI "."
	CRLF
	CALL PRINT-ID,STR?235 >STACK
	RSTACK
?L24:	FSET? TRAP,NDESCBIT \?L42
	CALL DISTURB?,MOUSE >STACK
	ZERO? STACK /?L42
	CALL HELD?,MOUSE >STACK
	ZERO? STACK \?L42
	FCLEAR TRAP,NDESCBIT
	MOVE MOUSE,LOCAL-GLOBALS
	PRINTI "By fits and starts the mouse "
	EQUAL? PRSA,V?TAKE \?L45
	PRINTI "eludes "
	CALL DPRINT,HANDS
	PRINTI " and "
?L45:	PRINTR "makes an exit."
?L42:	EQUAL? PRSA,V?PUT,V?THROW,V?DROP /?L53
	EQUAL? PRSA,V?GIVE,V?PUT-ON \?L52
?L53:	EQUAL? PRSO,MOUSE \?L52
	EQUAL? PRSI,BUCKET /?L52
	MOVE MOUSE,LOCAL-GLOBALS
	CALL SCAMPER,1 >STACK
	RSTACK
?L52:	EQUAL? PRSA,V?RUB \FALSE
	PRINTI "It nips at "
	CALL DPRINT,HANDS
	PRINTR "."

	.FUNCT FEED-MOUSE
	MOVE CHEESE,LOCAL-GLOBALS
	SET 'MOUSE-PISSED,0
	PRINTR "The mouse gnaws away at the cheese and peeps softly upon finishing it."

	.FUNCT GEN-MOUSE-F
	RETURN MOUSE

	.FUNCT SCAMPER,HANDED?=0
	PRINTI "The mouse "
	ZERO? HANDED? /?L3
	PRINTI "scampers out of "
	CALL DPRINT,HANDS
	PRINTI ", "
?L3:	PRINTI "hits the "
	CALL DPRINT,GROUND
	PRINTR " running and darts out of sight."

	.FUNCT MASK-F
	SET 'P-IT-OBJECT,MASK
	EQUAL? PRSA,V?EXAMINE \?L1
	FSET? MASK,WORNBIT \?L1
	PRINTR "You're wearing it!"
?L1:	EQUAL? PRSA,V?WEAR \?L5
	FSET? VEIL,WORNBIT \?L6
	CALL WONT-FIT-OVER,VEIL
	RTRUE
?L6:	PUTP PROTAGONIST,P?ACTION,PROTAGONIST-HACK-F
	FSET MASK,WORNBIT
	PRINTI "You put on the "
	CALL DPRINT,MASK
	PRINTR "."
?L5:	EQUAL? PRSA,V?LOOK-INSIDE \FALSE
	FSET? MASK,WORNBIT \FALSE
	PRINT YOU-ARE
	CRLF
	RTRUE

	.FUNCT SUIT-F
	EQUAL? PRSA,V?LOOK-INSIDE \?L3
	FSET? SUIT,WORNBIT \?L1
	CALL PERFORM,V?LOOK-UNDER,SUIT
	RTRUE
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \?L3
	PRINTR "There's nothing in it."
?L3:	EQUAL? PRSA,V?PUT \?L6
	EQUAL? PRSI,SUIT \?L6
	CALL PICK-ONE,WASTES >STACK
	PRINT STACK
	CRLF
	RTRUE
?L6:	FSET? DRESS,WORNBIT \?L9
	EQUAL? PRSA,V?BOARD,V?WEAR \?L9
	CALL WONT-FIT-OVER,DRESS >STACK
	RSTACK
?L9:	FSET? SHAWL,WORNBIT \?L10
	EQUAL? PRSA,V?BOARD,V?WEAR \?L10
	CALL WONT-FIT-OVER,SHAWL >STACK
	RSTACK
?L10:	EQUAL? PRSA,V?REMOVE,V?BOARD,V?WEAR /?L12
	EQUAL? PRSA,V?DISEMBARK,V?TAKE-OFF \?L11
?L12:	FSET? SUIT,WORNBIT \?L11
	PRINTI "You laboriously climb "
	EQUAL? PRSA,V?BOARD,V?WEAR \?L15
	MOVE SUIT,PROTAGONIST
	FSET SUIT,WORNBIT
	PRINTI "into"
	JUMP ?L19
?L15:	FCLEAR SUIT,WORNBIT
	PRINTI "out of"
?L19:	PRINTI " the heavy, itchy "
	CALL DPRINT,SUIT
	PRINTR "."
?L11:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "It's a 3-H "
	CALL DPRINT,SUIT
	PRINTR " -- heavy, hairy and headless."

	.FUNCT CAR-F
	EQUAL? PRSA,V?CLOSE,V?OPEN \?L1
	CALL V-COUNT >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?SMELL,V?EXAMINE \?L3
	EQUAL? P-PRSA-WORD,W?SMELL /?L4
	PRINTI "The tiny car, just a slice of lemon, is in pretty bad shape. "
?L4:	PRINTR "It smells of gasoline and burnt oil."
?L3:	EQUAL? PRSI,CAR \?L11
	EQUAL? PRSA,V?PUT-ON,V?PUT \?L11
	CALL V-DIG >STACK
	RSTACK
?L11:	EQUAL? PRSA,V?LOOK-INSIDE \?L12
	PRINTR "It's a one-seater, sporting only an ignition switch on the dash board."
?L12:	EQUAL? PRSA,V?ENTER,V?THROUGH,V?BOARD /?L16
	EQUAL? PRSA,V?DRIVE,V?CLIMB-ON \?L15
?L16:	FSET? CAR,RMUNGBIT \?L17
	PRINT BASKET-CASE
	CRLF
	RTRUE
?L17:	FSET CAR,RMUNGBIT
	PRINTR "Only a basket case or a child would fit in there."
?L15:	EQUAL? PRSA,V?LAMP-ON \FALSE
	CALL PERFORM,PRSA,SWITCH
	RTRUE

	.FUNCT SWITCH-F
	EQUAL? PRSA,V?PUSH,V?SET,V?LAMP-ON /?L3
	EQUAL? PRSA,V?THROW \FALSE
?L3:	IN? MUNRAB,HERE \?L4
	PRINTR "That surely will get you caught."
?L4:	FSET? SWITCH,RMUNGBIT /?L8
	FSET SWITCH,RMUNGBIT
	PRINTI "The "
	CALL DPRINT,CAR
	PRINTR " chugs violently for a couple of seconds, lets out a big bang, then dies."
?L8:	RANDOM 100 >STACK
	LESS? 35,STACK /?L11
	PRINTI "The "
	CALL DPRINT,CAR
	PRINTR " backfires loudly and comically."
?L11:	PRINTR "Nothing happens."

	.FUNCT I-DID
	CALL QUEUE,I-DID,-1 >STACK
	PUT STACK,0,1
	INC 'DID-C
	EQUAL? PRSA,V?NO,V?YES /FALSE
	FCLEAR PROTAGONIST,RMUNGBIT
	SET 'DID-C,0
	SET 'AWAITING-REPLY,0
	CALL INT,I-DID >STACK
	PUT STACK,0,0
	RTRUE

	.FUNCT TAFT-DESC,X
	PRINTI "President William Howard Taft is here."
	RTRUE

	.FUNCT TAFT-F
	EQUAL? PRSA,V?EXAMINE \?L1
	CALL HELD?,TAFT >STACK
	ZERO? STACK \?L1
	PRINTI "The imposing "
	CALL DPRINT,TAFT
	PRINTR " stands quite still."
?L1:	CALL TALKING-TO?,TAFT >STACK
	ZERO? STACK \?L6
	EQUAL? PRSA,V?WHIP \?L5
?L6:	PRINTI "He remains silent, unimpeachably frozen."
	CRLF
	EQUAL? PRSA,V?WHIP /?L9
	PUSH 0
	JUMP ?L10
?L9:	PUSH 1
?L10:	CALL PRINT-ID,STR?236,STACK
	CALL STOP >STACK
	RSTACK
?L5:	CALL TOUCHING?,TAFT >STACK
	ZERO? STACK \?L12
	EQUAL? PRSA,V?LOOK-BEHIND,V?WALK-AROUND \?L11
?L12:	FSET? TAFT,RMUNGBIT /FALSE
	FSET TAFT,RMUNGBIT
	PRINTR "Taft wobbles slightly, revealing himself to be nothing but a cardboard character, a mere prop."
?L11:	EQUAL? PRSA,V?HIDE-BEHIND \FALSE
	ZERO? HIDING \FALSE
	CALL RUNNING?,I-MEET >STACK
	ZERO? STACK /FALSE
	CALL HIDE-BEHIND-TAFT >STACK
	RSTACK

	.FUNCT HIDE-BEHIND-TAFT,FORCED=0
	ZERO? FORCED /?L1
	PRINTI "Fear motivates you to"
	SET 'MEET-COUNTER,7
	JUMP ?L5
?L1:	PRINTI "You"
	SET 'MEET-COUNTER,6
?L5:	CALL HELD?,TAFT >STACK
	ZERO? STACK /?L8
	MOVE TAFT,HERE
	PRINTI " set Taft down then"
?L8:	SET 'HIDING,1
	FSET TAFT,NDESCBIT
	PRINTR " crouch behind the cardboard character."

	.FUNCT I-MEET
	CALL QUEUE,I-MEET,-1 >STACK
	PUT STACK,0,1
	FCLEAR VOICES,INVISIBLE
	INC 'MEET-COUNTER
	EQUAL? MEET-COUNTER,1,3 /?L3
	EQUAL? MEET-COUNTER,6 \?L1
?L3:	CRLF
	PRINTI "You can hear muffled voices coming from outside"
	EQUAL? MEET-COUNTER,1 /?L13
	PRINTI ", getting louder and nearer"
	EQUAL? MEET-COUNTER,1 \?L11
?L13:	PRINTI " and see two ominous shadows cast against the side wall of the tent"
?L11:	PRINTI "."
	EQUAL? MEET-COUNTER,3 \?L18
	PRINTI " You feel the childish embarrassment of being trapped."
?L18:	CRLF
	RTRUE
?L1:	EQUAL? MEET-COUNTER,5 \?L23
	CRLF
	PRINTR "You hear one voice say, ""Let's duck in here."""
?L23:	EQUAL? MEET-COUNTER,7 \?L26
	MOVE MUNRAB,PROP-ROOM
	MOVE DICK,PROP-ROOM
	ZERO? HIDING \?L27
	CRLF
	CALL HIDE-BEHIND-TAFT,1
?L27:	CRLF
	PRINTI "From behind the "
	CALL DPRINT,TAFT
	PRINTR " you hear footsteps enter the tent, a pause, then hushed conversation."
?L26:	EQUAL? MEET-COUNTER,8 \?L32
	EQUAL? PRSA,V?LISTEN \?L35
	EQUAL? PRSO,VOICES /?L33
?L35:	CRLF
?L33:	PRINTI """So, Munrab, what is it? Why have you called me here?""
  
""Listen, Detective, I've had a terrible day in your lousy little town, so let me be brief. Receipts have been down all month, tonight's "
	CALL DPRINT,CON-STAND
	PRINTI " sales were especially small, the towners were tightfisted, they nearly leveled my grandstand, and on top of that somebody's kidnapped my daughter, Chelsea. That's where you come in. Here's the most recent picture of her -- a pretty good likeness in my opinion.""

"""
	CALL DPRINT,MUNRAB
	PRINTI ", why are we whispering?"""
	CRLF
	CALL PRINT-ID,STR?237 >STACK
	RSTACK
?L32:	EQUAL? MEET-COUNTER,9 \FALSE
	CALL END-MEETING >STACK
	RSTACK

	.FUNCT END-MEETING
	CALL INT,I-MEET >STACK
	PUT STACK,0,0
	FSET VOICES,INVISIBLE
	FCLEAR WINGS,TOUCHBIT
	FCLEAR TAFT,NDESCBIT
	EQUAL? MEET-COUNTER,9 \?L1
	EQUAL? PRSA,V?LISTEN \?L5
	EQUAL? PRSO,VOICES /?L3
?L5:	CRLF
?L3:	PRINTI """I don't know, because it's a mystery I guess. Anyhow, it's not because I suspect any of my own people here on the lot."" There's a pause. ""I've got a pretty loyal crew here. Sure, I work the guys a fair amount, but hey, no one joins the circus expecting a holiday.""

Lacking all passion and professionalism, the detective replies, ""I'll suspect who you want me to suspect. You're paying the bill.""

""Here, see, the language of this ransom note clearly shows that it's not an inside job. Detective, I don't know what kind of crazies are running loose in this town, but I'm afraid harm might come to my daughter if the police were to show up. God knows this circus doesn't need that kind of publicity, anyway. So I'm relying on you and you alone.""

""I'd better hold on to that note, Munrab.""

""Alright, then get going.""

You can hear "
	CALL DPRINT,MUNRAB
	PRINTI " and the "
	CALL DPRINT,DICK
	PRINTI " "
	JUMP ?L9
?L1:	CALL DPRINT,MUNRAB
	PRINTI " and the "
	CALL DPRINT,DICK
	PRINTI " notice you and they "
?L9:	PRINTI "hustle out of the tent"
	MOVE MUNRAB,ON-WAGON
	MOVE DICK,MIDWEST
	MOVE FLASK,DICK
	MOVE TRADE-CARD,LOCAL-GLOBALS
	ZERO? HIDING /?L14
	EQUAL? PRSA,V?STAND /?L14
	PRINTI ". You stand up."
	JUMP ?L18
?L14:	PRINTI "."
?L18:	SET 'P-IT-OBJECT,MUNRAB
	SET 'HIDING,0
	SET 'MEET-COUNTER,10
	SET 'FOLLOW-FLAG,13
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	CRLF
	CALL STOP >STACK
	RSTACK

	.FUNCT MUNRAB-F
	EQUAL? HERE,ON-WAGON,OFFICE \?L1
	FSET? PANEL,OPENBIT /?L3
	CALL TALKING-TO?,MUNRAB >STACK
	ZERO? STACK \?L5
	FSET? PANEL,OPENBIT /?L3
?L5:	CALL CANT-SEE,MUNRAB
	CALL STOP >STACK
	RSTACK
?L3:	CALL DISTURB?,MUNRAB >STACK
	ZERO? STACK \?L8
	EQUAL? PRSA,V?APPLAUD \FALSE
?L8:	CALL STARTLE-MUNRAB
	CALL STOP >STACK
	RSTACK
?L1:	EQUAL? HERE,PROP-ROOM \?L10
	CALL TOUCHING?,MUNRAB >STACK
	ZERO? STACK /?L10
	CALL CANT-REACH,MUNRAB >STACK
	RSTACK
?L10:	EQUAL? PRSA,V?LISTEN \?L11
	EQUAL? HERE,PROP-ROOM \?L11
	CALL PERFORM,V?LISTEN,VOICES
	RTRUE
?L11:	EQUAL? PRSA,V?EXAMINE \?L12
	PRINTR "He gives off the dual expressions of indigestion and indignation."
?L12:	ZERO? END-GAME /?L15
	CALL TALKING-TO?,MUNRAB >STACK
	ZERO? STACK /?L15
	FSET? MUNRAB,RMUNGBIT \?L16
	PRINTI "Completely distraught, "
	CALL DPRINT,MUNRAB
	PRINTI " is now incommunicado."
	CRLF
	JUMP ?L20
?L16:	FSET MUNRAB,RMUNGBIT
	PRINTI """Hey you, you're gonna pay for this! And do you know the replacement cost of a tightrope apparatus!"""
	CRLF
?L20:	CALL STOP >STACK
	RSTACK
?L15:	EQUAL? PRSA,V?FOLLOW \FALSE
	EQUAL? FOLLOW-FLAG,8 \?L24
	CALL DO-WALK,P?NE >STACK
	RSTACK
?L24:	EQUAL? FOLLOW-FLAG,9 \?L26
	CALL DO-WALK,P?NORTH >STACK
	RSTACK
?L26:	EQUAL? FOLLOW-FLAG,13 \FALSE
	CALL DO-WALK,P?EAST >STACK
	RSTACK

	.FUNCT MUNRAB-DESC,X
	IN? NET,MUNRAB \?L1
	EQUAL? HERE,RING \?L1
	PRINTI "The "
	CALL DPRINT,NET
	PRINTI " is being held by the motley circle of "
	CALL DPRINT,MUNRAB
	PRINTI ", the "
	CALL DPRINT,JIM
	PRINTI ", "
	ZERO? GANG-HERE /?L5
	CALL TELL-GROUP
?L5:	PRINTI "and "
	CALL DPRINT,THUMB
	JUMP ?L10
?L1:	CALL DPRINT,MUNRAB
	PRINTI ", pacing pitifully back and forth across the ring, is a complete wreck"
?L10:	PRINTI "."
	RTRUE

	.FUNCT TELL-GROUP
	CALL DPRINT,HERM
	PRINTI ", "
	CALL DPRINT,JOEY
	PRINTI ", "
	CALL DPRINT,HYP
	PRINTI ", "
	CALL DPRINT,CON
	PRINTI ", "
	CALL DPRINT,TAMER
	PRINTI " "
	RTRUE

	.FUNCT GANG-F
	CALL TALKING-TO?,GANG >STACK
	ZERO? STACK /?L1
	CALL PERFORM,V?TELL,CON
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "There's "
	CALL DPRINT,MUNRAB
	PRINTI ", the "
	CALL DPRINT,JIM
	PRINTI ", "
	CALL TELL-GROUP
	PRINTI "and "
	CALL DPRINT,THUMB
	PRINTR "."

	.FUNCT DICK-F
	ZERO? DICK-DRUNK \?L1
	CALL TALKING-TO?,DICK >STACK
	ZERO? STACK /?L1
	EQUAL? HERE,MIDWEST \?L1
	PRINTI "He just gives you a "
	GRTR? DRUNK-COUNTER,2 \?L5
	PRINTI "glassy-eyed"
	JUMP ?L9
?L5:	PRINTI "stern"
?L9:	PRINTI " look and ignores you."
	CRLF
	CALL STOP >STACK
	RSTACK
?L1:	EQUAL? WINNER,DICK \?L14
	FSET? DICK,RMUNGBIT /?L15
	IN? NOTE,GLOBAL-OBJECTS \?L15
	EQUAL? PRSA,V?GIVE \?L17
	EQUAL? PRSO,TRADE-CARD,NOTE \?L17
	EQUAL? PRSI,ME \?L17
	CALL GET-NOTE >STACK
	RSTACK
?L17:	EQUAL? PRSA,V?SGIVE \?L19
	EQUAL? PRSO,ME \?L19
	EQUAL? PRSI,TRADE-CARD,NOTE \?L19
	CALL GET-NOTE >STACK
	RSTACK
?L19:	EQUAL? PRSA,V?WHERE,V?FIND \?L20
	EQUAL? PRSO,TRADE-CARD,NOTE \?L20
	CALL GET-NOTE >STACK
	RSTACK
?L20:	EQUAL? PRSA,V?TELL-ABOUT \?L21
	EQUAL? PRSO,ME \?L21
	EQUAL? PRSI,TRADE-CARD,NOTE \?L21
	CALL GET-NOTE >STACK
	RSTACK
?L21:	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,DICK
	SET 'WINNER,DICK
	RTRUE
?L15:	EQUAL? PRSA,V?WHERE \?L23
	CALL PERFORM,V?ASK-ABOUT,DICK,PRSO
	RTRUE
?L23:	EQUAL? PRSA,V?HELLO /?L25
	EQUAL? PRSA,V?TELL-ABOUT \?L24
	EQUAL? PRSO,ME \?L24
?L25:	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,DICK,APE
	SET 'WINNER,DICK
	RTRUE
?L24:	PRINTI "The "
	CALL DPRINT,DICK
	PRINTR " appears unable to respond."
?L14:	EQUAL? HERE,PROP-ROOM \?L29
	CALL TOUCHING?,DICK >STACK
	ZERO? STACK /?L29
	CALL CANT-REACH,DICK >STACK
	RSTACK
?L29:	ZERO? DICK-UNRESPONSIVE \?L31
	FSET? DICK,RMUNGBIT \?L30
?L31:	EQUAL? PRSA,V?SHOW,V?GIVE \?L30
	EQUAL? PRSI,DICK \?L30
	CALL PERFORM,V?ASK-ABOUT,DICK,COAT
	RTRUE
?L30:	EQUAL? PRSA,V?GIVE,V?SHOW \?L32
	EQUAL? PRSO,CASE,SCRAP,RIBBON \?L32
	PRINTI "Not surprisingly, the "
	CALL DPRINT,PRSO
	PRINTI " doesn't ring a bell for the "
	CALL DPRINT,DICK
	PRINTR "."
?L32:	ZERO? DICK-DRUNK /?L35
	CALL HURT?,DICK >STACK
	ZERO? STACK /?L35
	PRINTI "You're beating a dead-drunk horse."
	CRLF
	CALL PRINT-ID,STR?238 >STACK
	RSTACK
?L35:	EQUAL? PRSA,V?TELL-ABOUT,V?ASK-FOR,V?ASK-ABOUT /?L39
	EQUAL? PRSA,V?HELLO \?L38
?L39:	EQUAL? PRSO,DICK \?L38
	FSET? DICK,RMUNGBIT \?L40
	PRINTI "You're having about as much luck as Rimshaw trying to communicate with the dead, even though the "
	CALL DPRINT,DICK
	PRINTR " still lives on."
?L40:	EQUAL? PRSI,GIRL,NOTE,TRADE-CARD /?L45
	EQUAL? PRSI,CON,MUNRAB \?L44
?L45:	IN? NOTE,GLOBAL-OBJECTS \?L44
	CALL GET-NOTE >STACK
	RSTACK
?L44:	ZERO? DICK-UNRESPONSIVE /?L46
	PRINTI "Just his attempting to think or speak or move is obviously causing the "
	CALL DPRINT,DICK
	PRINTR " great pain."
?L46:	SET 'DICK-UNRESPONSIVE,1
	PRINTI "As his jawbone pivots open for speech, some monstrous pain seems to ricochet off the plates of the "
	CALL DPRINT,DICK
	PRINTI "'s skull. He settles back into the "
	CALL DPRINT,SAWDUST
	PRINTR "."
?L38:	EQUAL? PRSA,V?LISTEN \?L52
	EQUAL? HERE,MIDWEST \?L52
	ZERO? DICK-DRUNK \?L52
	CALL PERFORM,V?LISTEN,VOICES
	RTRUE
?L52:	EQUAL? PRSA,V?SEARCH \?L53
	CALL PERFORM,V?SEARCH,COAT
	RTRUE
?L53:	EQUAL? PRSA,V?SEARCH-OBJECT-FOR \?L54
	CALL PERFORM,V?SEARCH-OBJECT-FOR,COAT,PRSI
	RTRUE
?L54:	EQUAL? PRSA,V?PUT-ON,V?POUR,V?THROW \?L55
	EQUAL? PRSO,WATER \?L55
	FSET? DICK,RMUNGBIT \?L56
	FCLEAR DICK,RMUNGBIT
	MOVE WATER,LOCAL-GLOBALS
	MOVE FLASK,LOCAL-GLOBALS
	PRINTI "The cool wave of water breaks upon the "
	CALL DPRINT,DICK
	PRINTR "'s face with a ""whooosh."" He comes up for air, wide-eyed and woken-up.

Glancing down at the flask of Dr. Nostrum's, he heaves it against the turnstile, and it explodes into a cloud of acrid smoke surrounded by twinkling flying shards of glass. Lucky no one got hurt."
?L56:	ZERO? DICK-DRUNK /FALSE
	PRINTR "He's already soaked."
?L55:	EQUAL? PRSA,V?RAISE,V?SHAKE,V?ALARM \?L64
	ZERO? DICK-DRUNK /?L64
	PRINTI "Making fists around the coat's lapel, you give a yank, but the "
	CALL DPRINT,DICK
	PRINTI "'s "
	FSET? DICK,RMUNGBIT \?L67
	PRINTI "overheated "
?L67:	PRINTR "skull merely falls to his opposite shoulder."
?L64:	EQUAL? PRSA,V?EXAMINE \?L74
	PRINTI "Wearing a "
	CALL DPRINT,COAT
	PRINTI " and "
	ZERO? DICK-DRUNK \?L77
	EQUAL? HERE,MIDWEST \?L77
	PRINTI "cradling a flask of Dr. Nostrum's in his hands,"
	JUMP ?L81
?L77:	EQUAL? HERE,PROP-ROOM \?L81
	PRINTI "looking otherwise disheveled,"
?L81:	EQUAL? HERE,MIDWEST \?L85
	ZERO? DICK-DRUNK /?L85
	IN? FLASK,DICK \?L87
	PRINTI "still clutching the flask"
	JUMP ?L91
?L87:	PRINTI "looking downtrodden"
?L91:	PRINTI ", the "
	CALL DPRINT,DICK
	PRINTI " continues to breathe, but that's about all."
	FSET? DICK,RMUNGBIT \?L101
	PRINTR " His face is damp with fever."
?L85:	PRINTI " he appears to have some kind of "
	CALL DPRINT,MONKEY
	PRINTI " on his back."
?L101:	CRLF
	RTRUE
?L74:	EQUAL? PRSA,V?FOLLOW \FALSE
	EQUAL? FOLLOW-FLAG,9 \?L105
	CALL DO-WALK,P?SW >STACK
	RSTACK
?L105:	EQUAL? FOLLOW-FLAG,11 \?L107
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L107:	EQUAL? FOLLOW-FLAG,13 \FALSE
	CALL DO-WALK,P?EAST >STACK
	RSTACK

	.FUNCT GET-NOTE
	MOVE TRADE-CARD,HERE
	MOVE NOTE,HERE
	SET 'P-IT-OBJECT,TRADE-CARD
	PRINTI "With much pain, slowness, and remorse, the "
	CALL DPRINT,DICK
	PRINTI " retrieves what looks to be a "
	CALL DPRINT,NOTE
	PRINTI " and a "
	CALL DPRINT,TRADE-CARD
	PRINTI " out of the inner lining of his "
	CALL DPRINT,COAT
	PRINTI " and lays them on the "
	CALL DPRINT,SAWDUST
	PRINTR "."

	.FUNCT DICK-DESC,X
	ZERO? DICK-DRUNK /?L1
	PRINTI "Over next to the "
	CALL DPRINT,BIGTOP
	PRINTI ", you can see the rumpled form of the "
	CALL DPRINT,DICK
	PRINTI " lying in the "
	CALL DPRINT,SAWDUST
	PRINTI "."
	RTRUE
?L1:	PRINTI "The "
	CALL DPRINT,DICK
	PRINTI " is here."
	RTRUE

	.FUNCT COAT-F
	EQUAL? PRSA,V?SEARCH-OBJECT-FOR,V?SEARCH,V?LOOK-INSIDE /?L3
	EQUAL? PRSA,V?OPEN \?L1
?L3:	EQUAL? HERE,MIDWEST \?L1
	ZERO? DICK-DRUNK /?L1
	PRINTI "You're unable to search the coat thoroughly, since the "
	CALL DPRINT,DICK
	PRINTI " is wearing it."
	CRLF
	CALL PRINT-ID,STR?239 >STACK
	RSTACK
?L1:	EQUAL? HERE,PROP-ROOM \?L6
	CALL TOUCHING?,COAT >STACK
	ZERO? STACK \?L7
	EQUAL? PRSA,V?LOOK-INSIDE \?L6
?L7:	CALL CANT-REACH,DICK >STACK
	RSTACK
?L6:	EQUAL? HERE,MIDWEST \?L8
	ZERO? DICK-DRUNK \?L8
	EQUAL? PRSA,V?CLOSE,V?OPEN,V?LOOK-INSIDE /?L9
	EQUAL? PRSA,V?PICK,V?SEARCH \?L8
?L9:	CALL PERFORM,V?TAKE,FLASK
	RTRUE
?L8:	EQUAL? PRSA,V?CLOSE \?L10
	CALL V-DIG >STACK
	RSTACK
?L10:	EQUAL? PRSA,V?PUT \?L11
	EQUAL? PRSI,COAT \?L11
	CALL V-DIG >STACK
	RSTACK
?L11:	EQUAL? PRSA,V?OPEN,V?REMOVE,V?TAKE \FALSE
	ZERO? DICK-DRUNK /?L13
	PRINTI "It's harder than trying to husk an ear of corn; you finally give up."
	CRLF
	CALL PRINT-ID,STR?240 >STACK
	RSTACK
?L13:	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	CALL PRINT-ID,STR?241 >STACK
	RSTACK

	.FUNCT TRADE-CARD-F
	CALL DONT-HANDLE?,TRADE-CARD >STACK
	ZERO? STACK \FALSE
	IN? TRADE-CARD,GLOBAL-OBJECTS \?L3
	CALL CANT-SEE,TRADE-CARD >STACK
	RSTACK
?L3:	EQUAL? HERE,PROP-ROOM \?L4
	IN? TRADE-CARD,DICK \?L4
	PRINTR "It's out of your sight."
?L4:	EQUAL? PRSA,V?COMPARE \?L10
	EQUAL? GIRL,PRSO,PRSI \?L7
	PRINTI "The girl depicted on the "
	CALL DPRINT,TRADE-CARD
	PRINTI " indeed appears as an idealized portrait of "
	CALL DPRINT,GIRL
	PRINTR "."
?L7:	EQUAL? PRSA,V?COMPARE \?L10
	EQUAL? RIBBON,PRSO,PRSI \?L10
	PRINTI "It looks like the same "
	CALL DPRINT,RIBBON
	PRINTR "."
?L10:	EQUAL? PRSA,V?EXAMINE \FALSE
	CALL IN-PACKAGE,TRADE-CARD >STACK
	RSTACK

	.FUNCT IN-PACKAGE,OBJ
	PRINTI "[A replica of"
	CALL ARTICLE,OBJ,1
	PRINTR " is included in your Ballyhoo package.]"

	.FUNCT NOTE-F
	CALL DONT-HANDLE?,NOTE >STACK
	ZERO? STACK \FALSE
	IN? NOTE,GLOBAL-OBJECTS \?L3
	CALL CANT-SEE,NOTE >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?EXAMINE,V?READ \FALSE
	CALL FIXED-FONT-ON
	PRINTI "The note is made from letters clipped out of a newspaper. It reads:"
	CRLF
	CRLF
	PRINTI "    thE kId iS sAFe aND sOUnD.

    FOr nOw. DoNT leaVe TowN

    WItHOut HeR -

    staY tuNeD foR deTaILs"
	CRLF
	CALL FIXED-FONT-OFF >STACK
	RSTACK

	.FUNCT WEST-CAMP-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	CALL CAMP-DESC
	CRLF
	PRINTR "At the northern border of the camp there is a pleated canvas wall, on either side of which runs the fence that was meant to keep you out. To the south, you see the long side of a dilapidated trailer, which sits off-kilter."
?L1:	EQUAL? RARG,M-BEG \FALSE
	CALL CANT-WALK? >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT CANT-WALK?
	EQUAL? PRSA,V?WALK \FALSE
	IN? THUMB,PROTAGONIST \?L3
	EQUAL? HERE,WEST-CAMP,EAST-CAMP \?L3
	EQUAL? P-WALK-DIR,P?NORTH \?L3
	CALL DONT-WALK,THUMB >STACK
	RSTACK
?L3:	IN? GIRL,PROTAGONIST \FALSE
	EQUAL? HERE,EAST-CAMP \?L7
	EQUAL? P-WALK-DIR,P?WEST,P?EAST /?L6
?L7:	EQUAL? HERE,BACK-YARD \?L8
	EQUAL? P-WALK-DIR,P?EAST \?L6
?L8:	EQUAL? HERE,NEAR-WAGON \FALSE
	EQUAL? P-WALK-DIR,P?SOUTH /FALSE
?L6:	CALL DONT-WALK,GIRL >STACK
	RSTACK

	.FUNCT DONT-WALK,PERSON?1
	EQUAL? PERSON?1,THUMB \?L1
	CALL DPRINT,THUMB
	PRINTI " gets restless in your arms"
	JUMP ?L5
?L1:	CALL DPRINT,GIRL
	PRINTI " looks afraid"
?L5:	PRINTR " when you start that way so you stop."

	.FUNCT CANVAS-F
	EQUAL? PRSA,V?EXAMINE \?L1
	CALL RUNNING?,I-MEET >STACK
	ZERO? STACK /?L3
	CALL IS-ADJ?,W?SHADOW >STACK
	ZERO? STACK /?L3
	PRINTR "Very ominous."
?L3:	FSET? CANVAS,RMUNGBIT /?L7
	EQUAL? HERE,PROP-ROOM /FALSE
?L7:	PRINTI "The "
	CALL DPRINT,CANVAS
	PRINTR " is deeply shadowed by its many pleats."
?L1:	EQUAL? HERE,WEST-CAMP \?L11
	EQUAL? PRSA,V?RAISE,V?RUB,V?OPEN /?L12
	EQUAL? PRSA,V?MOVE,V?LOOK-INSIDE,V?LOOK-UNDER \?L11
?L12:	PRINTR "One pleat opens up to reveal more darkly shadowed pleats."
?L11:	EQUAL? PRSA,V?THROUGH,V?BOARD,V?WALK-TO /?L16
	EQUAL? PRSA,V?CRAWL-UNDER \FALSE
?L16:	EQUAL? HERE,WEST-CAMP,PROP-ROOM \FALSE
	EQUAL? HERE,WEST-CAMP /?L19
	FSET? CANVAS,RMUNGBIT \?L17
?L19:	FSET? CANVAS,RMUNGBIT /?L20
	ADD SCORE,10 >SCORE
?L20:	CALL TELL-PASS-CANVAS
	FSET CANVAS,RMUNGBIT
	EQUAL? HERE,WEST-CAMP \?L23
	CALL GOTO,PROP-ROOM >STACK
	RSTACK
?L23:	CALL GOTO,WEST-CAMP >STACK
	RSTACK
?L17:	PRINTI "This side of the tent is too dark and shadowy to make out the confines of the "
	CALL DPRINT,CANVAS
	PRINTR "."

	.FUNCT GEN-TENT
	RETURN TENT

	.FUNCT TENT-BOUND
	PRINTI "The "
	CALL DPRINT,PRSO
	PRINTR " appears securely bound here."

	.FUNCT EAST-CAMP-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	CALL CAMP-DESC
	CRLF
	PRINTI "At the eastern end of the camp sits one lone "
	CALL DPRINT,TAMER-TRAILER
	PRINTR "."
?L1:	EQUAL? RARG,M-BEG \?L5
	CALL CANT-WALK? >STACK
	ZERO? STACK \TRUE
	EQUAL? PRSA,V?WAIT \FALSE
	EQUAL? WIPE-C,100 \FALSE
	IN? JENNY,LOCAL-GLOBALS \FALSE
	PRINTR "It doesn't appear the meeting is about to start soon."
?L5:	EQUAL? RARG,M-ENTER \FALSE
	FSET? CASE,TOUCHBIT \FALSE
	FSET? RIBBON,TOUCHBIT \FALSE
	FSET? SHEET,TOUCHBIT \FALSE
	ZERO? WON-JOEY \FALSE
	ZERO? WON-ON-TENT /FALSE
	ZERO? CLOWN-ALLEY-SCENE /FALSE
	SET 'WIPE-C,0
	MOVE FLASK,JOEY
	MOVE RAG,JOEY
	CALL QUEUE,I-JOEY,-1 >STACK
	PUT STACK,0,1
	MOVE JOEY,EAST-CAMP
	RTRUE

	.FUNCT TAMER-F
	CALL TALKING-TO?,TAMER >STACK
	ZERO? STACK /?L1
	PRINTI """Was ist das!"""
	CRLF
	CALL STOP >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?FOLLOW \FALSE
	EQUAL? FOLLOW-FLAG,16 \FALSE
	CALL DO-WALK,P?EAST >STACK
	RSTACK

	.FUNCT TAMER-ROOM-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	CALL STEP-INTO-TRAILER
	CALL RUNNING?,I-TAMER >STACK
	ZERO? STACK /FALSE
	MOVE TAMER,LOCAL-GLOBALS
	CALL QUEUE,I-TAMER,3 >STACK
	PUT STACK,0,1
	RTRUE
?L1:	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "These quarters are furnished in a foreigner's vision of American Rugged Individualism. "
	FSET? MOOSE,NDESCBIT \?L9
	PRINTI "The head of a moose, for example, hangs as a trophy against"
	JUMP ?L13
?L9:	PRINTI "There's an opening to a "
	CALL DPRINT,CRAWL-SPACE
	PRINTI " in"
?L13:	PRINTI " one wall. Against the west wall the door stands "
	CALL OPEN-CLOSED,TAMER-DOOR
	PRINTI " and a gaily decorated "
	CALL DPRINT,CURTAINS
	FSET? CURTAINS,OPENBIT \?L20
	PRINTI " is open at"
	JUMP ?L24
?L20:	PRINTI " covers"
?L24:	PRINTI " the "
	CALL DPRINT,WINDOW
	PRINTR "."

	.FUNCT STEP-INTO-TRAILER
	PRINTI "You step up into the trailer."
	CRLF
	CRLF
	RTRUE

	.FUNCT MOOSE-F
	EQUAL? PRSA,V?TAKE,V?PUSH,V?MOVE /?L3
	EQUAL? PRSA,V?LOOK-BEHIND \?L1
?L3:	FSET? MOOSE,NDESCBIT \?L1
	FCLEAR MOOSE,NDESCBIT
	FCLEAR CRAWL-SPACE,INVISIBLE
	PRINTI "The "
	CALL DPRINT,MOOSE
	PRINTI " drops to the floor with a loud thud, revealing an opening, about one foot square, to a "
	CALL DPRINT,CRAWL-SPACE
	PRINTR "."
?L1:	EQUAL? PRSA,V?PUT-ON,V?PUT \?L6
	EQUAL? PRSI,WALLS \?L6
	EQUAL? HERE,TAMER-ROOM \?L6
	PRINTI "It won't reattach to the "
	CALL DPRINT,WALLS
	PRINTR "."
?L6:	EQUAL? PRSA,V?DRINK \FALSE
	PRINTR "It's very very dry, undrinkably so."

	.FUNCT CRAWL-SPACE-F
	EQUAL? PRSA,V?LOOK-INSIDE \?L1
	PRINTR "It is completely dark inside the opening."
?L1:	EQUAL? PRSA,V?REACH-IN \?L5
	IN? GIRL,HERE \?L6
	CALL PERFORM,V?TAKE,GIRL
	RTRUE
?L6:	CALL TELL-WITHIN-REACH >STACK
	RSTACK
?L5:	EQUAL? PRSA,V?EXAMINE \?L9
	PRINTR "The square hole is about a foot wide."
?L9:	EQUAL? PRSA,V?PUT-ON \?L12
	EQUAL? PRSO,MOOSE \?L12
	CALL PERFORM,V?PUT-ON,MOOSE,WALLS
	RTRUE
?L12:	EQUAL? PRSA,V?PUT \?L13
	EQUAL? PRSO,GIRL /FALSE
	GETP PRSO,P?SIZE >STACK
	LESS? STACK,75 \?L16
	FSET PRSO,INVISIBLE
	MOVE PRSO,CRAWL-SPACE
	EQUAL? PRSO,THUMB \?L17
	CALL QUEUE,I-TAMER,3 >STACK
	PUT STACK,0,1
	PRINTI "A wide-eyed "
	CALL DPRINT,THUMB
	PRINTI " goes easily through the opening and"
	JUMP ?L21
?L17:	PRINTI "As you release"
	CALL ARTICLE,PRSO,1
	PRINTI " it"
?L21:	PRINTI " drops to the floor on the other side of the wall. "
	IN? GIRL,LOCAL-GLOBALS \?L28
	ZERO? GIRL-CRIED \?L28
	CALL TELL-WIMPER
	RTRUE
?L28:	CRLF
	RTRUE
?L16:	PRINTR "It doesn't fit."
?L13:	EQUAL? PRSA,V?THROUGH,V?ENTER,V?BOARD \FALSE
	PRINTR "Despite your writhing and squirming at the opening, it would seem only a contortionist or a Houdini would fit through it."

	.FUNCT WINDOW-F
	EQUAL? PRSA,V?BOARD,V?CLOSE,V?OPEN /?L3
	EQUAL? PRSA,V?THROUGH \?L1
?L3:	PRINTR "It refuses to budge."
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \FALSE
	FSET? CURTAINS,OPENBIT \?L7
	PRINT YOU-SEE
	EQUAL? HERE,EAST-CAMP \?L11
	PRINTR " the inside of the trailer."
?L11:	PRINTR " the performers' camp."
?L7:	PRINTI "The "
	CALL DPRINT,CURTAINS
	PRINTI "s are drawn over the "
	CALL DPRINT,WINDOW
	PRINTR "."

	.FUNCT CURTAINS-F
	CALL TOUCHING?,CURTAINS >STACK
	ZERO? STACK /?L1
	EQUAL? HERE,EAST-CAMP \?L1
	PRINTI "The "
	CALL DPRINT,CURTAINS
	PRINTR "s are inside the trailer, hence unreachable."
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "The "
	FSET? CURTAINS,OPENBIT \?L8
	PRINTI "open "
	JUMP ?L12
?L8:	PRINTI "closed "
?L12:	CALL DPRINT,CURTAINS
	PRINTR " is decorated with little Wild West scenes: cowboys mowing down buffalo, gunfights, and the like."

	.FUNCT TAMER-TRAILER-F
	EQUAL? PRSA,V?EXAMINE \?L1
	EQUAL? HERE,EAST-CAMP \?L3
	PRINTI "The "
	CALL DPRINT,TAMER-TRAILER
	PRINTI " with its chalky aluminum siding has all the charm of a generic beer can. In contrast, a garishly painted sign hangs over both the door, which is"
	FSET? TAMER-DOOR,OPENBIT \?L7
	PRINTI " open"
	JUMP ?L11
?L7:	PRINTI " closed"
?L11:	PRINTI ", and a window. Built into the side of the "
	CALL DPRINT,TAMER-TRAILER
	PRINTI " is "
	FSET? BAGGAGE-COMPARTMENT,OPENBIT \?L16
	PRINTI "an open "
	JUMP ?L20
?L16:	PRINTI "some kind of baggage "
?L20:	CALL DPRINT,BAGGAGE-COMPARTMENT
	PRINTR "."
?L3:	CALL V-LOOK >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?THROUGH,V?BOARD,V?ENTER \?L26
	EQUAL? HERE,TAMER-ROOM \?L27
	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L27:	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L26:	EQUAL? PRSA,V?LOOK-INSIDE \?L32
	EQUAL? HERE,TAMER-ROOM \?L33
	CALL V-LOOK >STACK
	RSTACK
?L33:	CALL PERFORM,V?LOOK-INSIDE,WINDOW
	RTRUE
?L32:	CALL TOUCHING?,TAMER-TRAILER >STACK
	ZERO? STACK /?L36
	IN? JOEY,HERE \?L36
	CALL PERFORM,V?KNOCK,TAMER-DOOR
	RTRUE
?L36:	EQUAL? PRSA,V?UNLOCK,V?CLOSE,V?OPEN /?L38
	EQUAL? PRSA,V?LOCK \FALSE
?L38:	CALL PERFORM,PRSA,TAMER-DOOR,PRSI
	RTRUE

	.FUNCT TAMER-SIGN-F
	EQUAL? PRSA,V?EXAMINE,V?READ \FALSE
	CALL FIXED-FONT-ON
	PRINTI "               Home Of
  "
	CALL DPRINT,TAMER
	PRINTI "

     KATZENJAMMER OF THE BIG CATS
"
	CALL FIXED-FONT-OFF >STACK
	RSTACK

	.FUNCT TAMER-DOOR-F
	CALL TOUCHING?,TAMER-DOOR >STACK
	ZERO? STACK /?L1
	IN? JOEY,HERE \?L1
	CALL DPRINT,JOEY
	PRINTI " shields the "
	CALL DPRINT,TAMER-TRAILER
	PRINTR " from you. ""Keep away. The liquid hasn't dried yet."""
?L1:	EQUAL? PRSA,V?LOOK-BEHIND,V?CLOSE \?L5
	EQUAL? HERE,TAMER-ROOM \?L5
	IN? CROWBAR,LOCAL-GLOBALS \?L5
	FCLEAR TAMER-DOOR,OPENBIT
	MOVE CROWBAR,HERE
	SET 'P-IT-OBJECT,CROWBAR
	PRINTI "As the "
	CALL DPRINT,TAMER-DOOR
	PRINTI " is closed, you notice a "
	CALL DPRINT,CROWBAR
	PRINTR " leaning against the wall, where it looks more like a weapon than a tool."
?L5:	EQUAL? PRSA,V?KNOCK \FALSE
	IN? TAMER,TAMER-ROOM \FALSE
	ZERO? WON-JOEY /FALSE
	PRINT YOU-SEE
	PRINTI " the "
	CALL DPRINT,CURTAINS
	PRINTI "s part slightly and then "
	FSET? VEIL,WORNBIT \?L13
	FSET? DRESS,WORNBIT \?L13
	FSET? SHAWL,WORNBIT \?L13
	FSET CURTAINS,OPENBIT
	FSET TAMER-DOOR,OPENBIT
	FCLEAR TAMER-DOOR,LOCKEDBIT
	FCLEAR TAMER-DOOR,RMUNGBIT
	FSET TAMER,NDESCBIT
	MOVE TAMER,HERE
	CALL QUEUE,I-TAMER,1 >STACK
	PUT STACK,0,1
	PRINTI "you hear through the window a hushed voice with a thick German accent.
  
""Andrew, where is Eddie?! And Willie! We must talk over what to do. I go now and bring back them, and the "
	CALL DPRINT,JIM
	PRINTI " too. You be guarding in here, when I will come back.""

The "
	CALL DPRINT,TAMER-DOOR
	PRINTI " swings inward, and out of the "
	CALL DPRINT,TAMER-TRAILER
	PRINTI " steps the robust personage of the "
	CALL DPRINT,TAMER
	PRINTR "."
?L13:	FSET TAMER-DOOR,RMUNGBIT
	CALL QUEUE,I-TAMER,10 >STACK
	PUT STACK,0,1
	PRINTR "draw closed."

	.FUNCT I-END-GAME
	INC 'END-GAME-C
	EQUAL? HERE,LEFT-HANGING \?L1
	EQUAL? END-GAME-C,2 \?L3
	CRLF
	PRINTI "Down below, oblivious of your plight, all of the circus folk are making noises of mutual forgiveness and reconciliation in the new spirit of togetherness brought on by the dramatic, emotionally charged rescue of "
	CALL DPRINT,MUNRAB
	PRINTR "'s daughter."
?L3:	EQUAL? END-GAME-C,3 \?L7
	CRLF
	PRINTR "You can feel your grip loosen as the crowd below continues its orgy of feeling."
?L7:	EQUAL? END-GAME-C,4 \FALSE
	PRINTI "Your sweaty hands slip off the wire."
	CALL CARRIAGE-RETURNS,14
	PRINTI "The story of your evening's heroic deeds must have just been passed among the circus people below, because you feel the sudden pressure of your shoulders sinking deeply into the "
	CALL DPRINT,NET
	PRINTI " and with a rousing chorus of ""Hip hip hooray!"" you are flung back high into the air, where you view the smiling upturned faces of your circle of boosters.

You float back down and on the second blast-off -- ""Hip hip hooray!"" -- you pass out, not so much from the acceleration as from the sheer exhilaration of having saved The Traveling Circus That Time Forgot, Inc."
	CRLF
	ADD SCORE,5 >SCORE
	CALL FINISH >STACK
	RSTACK
?L1:	IN? JIM,LOCAL-GLOBALS \?L16
	CALL QUEUE,I-END-GAME,-1 >STACK
	PUT STACK,0,1
	MOVE JIM,RING
	MOVE NET,MUNRAB
	MOVE THUMB,RING
	FSET THUMB,NDESCBIT
	FSET JIM,NDESCBIT
	EQUAL? HERE,RING \FALSE
	CRLF
	PRINTI "The "
	CALL DPRINT,JIM
	PRINTI " comes sprinting through the wings with the "
	CALL DPRINT,NET
	PRINTI " slung over his shoulder and the midget "
	CALL DPRINT,THUMB
	PRINTI " in tow. "
	CALL DPRINT,MUNRAB
	PRINTR " and his two employees each grab part of the net, and they try to position it directly under the imperiled little girl."
?L16:	EQUAL? HERE,RING \?L22
	FSET? DIAL,RMUNGBIT \?L22
	ZERO? GANG-HERE \?L22
	MOVE TAMER,HERE
	MOVE ANDREW,HERE
	MOVE JENNY,HERE
	MOVE HERM,HERE
	MOVE JOEY,HERE
	MOVE HYP,HERE
	MOVE CON,HERE
	MOVE GANG,HERE
	SET 'GANG-HERE,1
	FSET HERM,NDESCBIT
	FSET CON,NDESCBIT
	FSET HYP,NDESCBIT
	FSET JOEY,NDESCBIT
	CRLF
	PRINTI "Just now a gaggle of circus performers -- "
	CALL TELL-GROUP
	PRINTR "-- appear through the wings. Quickly assessing the situation, the group seems to suddenly, gut-wrenchingly accept the burden of responsibility for the calamity that has occurred. Their immediate reaction is the instinct to help, and each grabs part of the net."
?L22:	IN? NET,MUNRAB \FALSE
	EQUAL? HERE,RING \FALSE
	CALL QUEUE,I-END-GAME,-1 >STACK
	PUT STACK,0,1
	CRLF
	PRINTI "Munrab & Company, their faces anxiously upturned, are pulling the "
	CALL DPRINT,NET
	PRINTR "  every which way, kicking sawdust from one end of the ring to the other."

	.FUNCT I-TAMER
	FSET? TAMER-DOOR,RMUNGBIT \?L1
	FCLEAR TAMER-DOOR,RMUNGBIT
	RFALSE
?L1:	EQUAL? HERE,TAMER-ROOM \?L3
	IN? THUMB,CRAWL-SPACE \?L3
	IN? GIRL,LOCAL-GLOBALS \?L3
	CALL QUEUE,I-TAMER,-1 >STACK
	PUT STACK,0,1
	SET 'TAMER-C,0
	FSET GIRL,RMUNGBIT
	CRLF
	PRINTI "Coming from the other side of the wall is a scurrying noise. Then "
	CALL TELL-BOOST-GIRL
	RTRUE
?L3:	CALL QUEUE,I-TAMER,-1 >STACK
	PUT STACK,0,1
	INC 'TAMER-C
	IN? GIRL,LOCAL-GLOBALS /?L7
	FSET? GIRL,RMUNGBIT \?L7
	EQUAL? HERE,TAMER-ROOM \?L7
	EQUAL? TAMER-C,1,3 \?L9
	MOVE GIRL,CRAWL-SPACE
	CRLF
	PRINTI "The girl drops out of view"
	EQUAL? TAMER-C,3 \?L13
	PRINTI "; you hear foot-stomping from inside the "
	CALL DPRINT,CRAWL-SPACE
	PRINTI " and then a long silence"
?L13:	PRINT PERIOD
	RTRUE
?L9:	EQUAL? TAMER-C,2 \TRUE
	CALL TELL-BOOST-GIRL,1
	RTRUE
?L7:	EQUAL? TAMER-C,2 \FALSE
	IN? GIRL,LOCAL-GLOBALS \FALSE
	MOVE TAMER,LOCAL-GLOBALS
	EQUAL? HERE,EAST-CAMP \FALSE
	FCLEAR TAMER-DOOR,OPENBIT
	FSET TAMER-DOOR,LOCKEDBIT
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	SET 'FOLLOW-FLAG,16
	FCLEAR CURTAINS,OPENBIT
	CRLF
	CALL DPRINT,TAMER
	PRINTI ", with a confused look on his face, stares at you as if he'd never seen a sideshow freak in his life."
	FSET? VEIL,WORNBIT \?L27
	PRINTI " He peels back your veil,"
	JUMP ?L31
?L27:	PRINTI " He"
?L31:	PRINTI " shoves you to the "
	CALL DPRINT,GROUND
	PRINTI ", and steps up into the "
	CALL DPRINT,TAMER-TRAILER
	PRINTI ". You bring "
	CALL DPRINT,ME
	PRINTR " to your feet."

	.FUNCT TELL-BOOST-GIRL,AGAIN?=0
	MOVE GIRL,HERE
	ZERO? AGAIN? /?L1
	CRLF
	PRINTI "Once again "
?L1:	PRINTI "you can hear the strained voice of "
	CALL DPRINT,THUMB
	PRINTI " cursing in Russian as he gives a boost to his human cargo. "
	ZERO? AGAIN? /?L8
	CRLF
	PRINTR "The girl is held precariously up to the opening."
?L8:	CRLF
	CRLF
	PRINTR "Slowly rising into view through the opening comes the expressionless face of the missing girl, framed by her tousled and ribbonless hair, seeming too tired to be frightened.

She pauses there for an instant, a portrait of innocence within a jagged plywood frame."

	.FUNCT GIRL-F
	EQUAL? PRSA,V?LISTEN \?L1
	IN? GIRL,LOCAL-GLOBALS \?L1
	ZERO? GIRL-CRIED /?L1
	PRINTI "You don't hear the "
	CALL DPRINT,WHIMPER
	PRINTR " now."
?L1:	EQUAL? PRSA,V?EXAMINE \?L5
	PRINTR "She looks exhausted, but also somehow strengthened by her travails this evening."
?L5:	CALL TALKING-TO?,GIRL >STACK
	ZERO? STACK /?L8
	IN? GIRL,APE \?L9
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?TELL,APE
	CALL STOP >STACK
	RSTACK
?L9:	PRINTI "The girl merely looks at you with frightened eyes. She has learned her lesson about not talking to strangers."
	CRLF
	CALL STOP >STACK
	RSTACK
?L8:	EQUAL? PRSA,V?TAKE \?L14
	FSET? GIRL,RMUNGBIT \?L14
	CALL ITAKE >STACK
	EQUAL? STACK,1 \?L14
	CALL INT,I-TAMER >STACK
	PUT STACK,0,0
	CALL QUEUE,I-GIRL,-1 >STACK
	PUT STACK,0,1
	MOVE THUMB,LOCAL-GLOBALS
	ADD SCORE,10 >SCORE
	SET 'FOLLOW-FLAG,10
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	FCLEAR THUMB,INVISIBLE
	FCLEAR GIRL,RMUNGBIT
	FCLEAR APE-DOOR,OPENBIT
	FSET APE-DOOR,LOCKEDBIT
	PRINTI "You hoist the girl from out of the "
	CALL DPRINT,CRAWL-SPACE
	PRINTI ". "
	CALL DPRINT,THUMB
	PRINTI ", exhilarated by the rescue, climbs out of the opening unassisted, and then exits the "
	CALL DPRINT,TAMER-TRAILER
	PRINTR "."
?L14:	EQUAL? PRSA,V?SHOW,V?GIVE \?L17
	EQUAL? PRSO,TRADE-CARD \?L17
	PRINTR """That's me,"" she says."
?L17:	EQUAL? PRSA,V?THROW,V?PUT,V?DROP /?L21
	EQUAL? PRSA,V?GIVE \?L20
?L21:	EQUAL? PRSO,GIRL \?L20
	ZERO? PRSI /?L22
	FSET? PRSI,TAKEBIT \?L22
	PRINTI "She resists"
	JUMP ?L26
?L22:	PRINTI "With fear in her eyes, she resists your abandonment"
?L26:	PRINT PERIOD
	RTRUE
?L20:	EQUAL? PRSA,V?PUT-ON,V?GIVE \?L33
	EQUAL? PRSI,GIRL /?L32
?L33:	EQUAL? PRSA,V?TIE \?L31
	EQUAL? PRSO,RIBBON \?L31
?L32:	PRINTI "Understandably, "
	CALL DPRINT,GIRL
	PRINTI " is reluctant to accept gifts from strangers"
	CALL BAD-TO-GIVE-TO-GIRL? >STACK
	CALL PRINT-ID,STR?242,STACK
	EQUAL? PRSO,RIBBON \?L36
	PRINTI ", even her own "
	CALL DPRINT,RIBBON
?L36:	PRINT PERIOD
	RTRUE
?L31:	CALL TOUCHING?,GIRL >STACK
	ZERO? STACK /?L43
	IN? GIRL,APE \?L43
	CALL CANT-REACH,GIRL >STACK
	RSTACK
?L43:	EQUAL? PRSA,V?SAVE-SOMETHING \?L44
	PRINT HOW
	CRLF
	RTRUE
?L44:	EQUAL? PRSA,V?FOLLOW \FALSE
	EQUAL? FOLLOW-FLAG,9 \FALSE
	CALL DO-WALK,P?NORTH >STACK
	RSTACK

	.FUNCT I-GIRL
	EQUAL? HERE,NEAR-WAGON \?L1
	IN? MUNRAB,OFFICE \?L1
	IN? GIRL,PROTAGONIST \?L1
	FCLEAR OFFICE-DOOR,LOCKEDBIT
	FSET OFFICE-DOOR,OPENBIT
	MOVE MUNRAB,MEN
	FSET MUNRAB,NDESCBIT
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	SET 'P-IT-OBJECT,MUNRAB
	SET 'FOLLOW-FLAG,8
	CRLF
	PRINTI "As you approach the "
	CALL DPRINT,WAGON
	PRINTI ", "
	CALL DPRINT,MUNRAB
	PRINTI " steps down from inside his office and, as his eyes fall upon the figure of you carrying the only bit of preciousness in his life, it's as if he were jolted by an "
	CALL DPRINT,PROD
	PRINTR ". For an instant, his confused mind appears to be sending him strong fight-or-flight messages, for suddenly he dashes off through the hole in the fence."
?L1:	IN? MUNRAB,MEN \FALSE
	EQUAL? HERE,NEAR-WAGON \?L6
	CRLF
	PRINTI "The little girl begins whining at you to follow her father, and off you go."
	CRLF
	CRLF
	CALL GOTO,MEN
?L6:	CALL INT,I-GIRL >STACK
	PUT STACK,0,0
	CALL QUEUE,I-END-GAME,-1 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	SET 'FOLLOW-FLAG,9
	SET 'END-GAME,1
	SET 'APE-LOC,1
	MOVE JIM,RING
	MOVE MUNRAB,RING
	MOVE GIRL,APE
	MOVE DICK,LOCAL-GLOBALS
	MOVE APE,LOCAL-GLOBALS
	FCLEAR MUNRAB,NDESCBIT
	FCLEAR RING,TOUCHBIT
	FCLEAR CLOWN-ALLEY,TOUCHBIT
	FSET GIRL,NDESCBIT
	FSET APE,NDESCBIT
	CRLF
	CALL DPRINT,MUNRAB
	PRINTI ", standing here desperate and alone in the middle of the menagerie, is calling out in every direction for the detective.

The sotted sleuth comes staggering in from the midway, and "
	CALL DPRINT,MUNRAB
	PRINTI ", pointing confidently at you, delivers the order, ""There is the perpetrator. Shoot "
	CALL MAN-OR-WOMAN,STR?244,STR?243
	PRINTI "."" As the "
	CALL DPRINT,DICK
	PRINTI " stumbles toward you, your ears are pierced by "
	CALL DPRINT,GIRL
	PRINTI " screaming at the top of her lungs, and then by the screech of bending metal. Suddenly, you're blindsided by a wall of bristly animal fur which knocks you to the ground. You get up dazed, and see "
	CALL DPRINT,MUNRAB
	PRINTR " chasing a giant ape to the north while the detective slinks away through the hole in the fence."

	.FUNCT WHIMPER-F
	EQUAL? PRSA,V?FIND,V?FOLLOW,V?LISTEN \?L1
	ZERO? GIRL-CRIED /?L1
	CALL PERFORM,V?LISTEN,GIRL
	RTRUE
?L1:	CALL CANT-SEE,WHIMPER >STACK
	RSTACK

	.FUNCT BAGGAGE-COMPARTMENT-F
	CALL TOUCHING?,BAGGAGE-COMPARTMENT >STACK
	ZERO? STACK /FALSE
	IN? JOEY,HERE \FALSE
	CALL PERFORM,V?KNOCK,TAMER-DOOR >STACK
	RSTACK

	.FUNCT CAMP-DESC
	PRINTI "You're in the "
	EQUAL? HERE,WEST-CAMP \?L3
	PRINTI "west"
	JUMP ?L7
?L3:	PRINTI "east"
?L7:	PRINTR " end of the performers' camp. It is unevenly lighted by a number of glaring spotlights which ring the camp, creating a stage-like patchwork of light and dark."

	.FUNCT THUMB-F
	EQUAL? THUMB,WINNER \?L1
	EQUAL? PRSA,V?HELLO \?L3
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,THUMB
	SET 'WINNER,THUMB
	RTRUE
?L3:	EQUAL? PRSA,V?TELL-ABOUT \FALSE
	EQUAL? PRSO,ME \FALSE
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,THUMB,ME
	SET 'WINNER,THUMB
	RTRUE
?L1:	EQUAL? PRSA,V?WAVE-AT,V?HELLO \?L7
	PRINTR "He gives you a slow and dramatic wave, as if to a great audience."
?L7:	CALL TALKING-TO?,THUMB >STACK
	ZERO? STACK /?L10
	CALL RUNNING?,CLOWN-ALLEY >STACK
	ZERO? STACK /?L11
	CALL PERFORM,V?RUB,JOEY
	RTRUE
?L11:	PRINTI "Unable to comprehend what you're saying, he shrugs his shoulders."
	CRLF
	CALL STOP >STACK
	RSTACK
?L10:	EQUAL? PRSA,V?EXAMINE \?L16
	CALL RUNNING?,I-CLOWN-EXIT >STACK
	ZERO? STACK /?L16
	PRINTR "He rolls his eyes back in a theatrical way."
?L16:	EQUAL? PRSA,V?LISTEN \?L19
	EQUAL? CLOWN-EXIT-COUNTER,4 \?L19
	CALL HELD?,THUMB >STACK
	ZERO? STACK \?L19
	PRINTR "It's certainly not the hit parade."
?L19:	EQUAL? PRSA,V?THROW,V?GIVE,V?DROP /?L23
	EQUAL? PRSA,V?PUT \?L22
?L23:	EQUAL? PRSO,THUMB \?L22
	EQUAL? PRSI,CRAWL-SPACE /?L22
	PRINTI "He squirms out of your hold"
	EQUAL? HERE,TAMER-ROOM \?L26
	FSET? TAMER-DOOR,OPENBIT /?L26
	FSET TAMER-DOOR,OPENBIT
	PRINTI ", opens the door,"
?L26:	CALL RUNNING?,I-CLOWN-EXIT >STACK
	ZERO? STACK \?L31
	PRINTI " and flees into the night"
	MOVE THUMB,LOCAL-GLOBALS
	JUMP ?L35
?L31:	SET 'CLOWN-EXIT-COUNTER,7
	MOVE THUMB,HERE
?L35:	PRINT PERIOD
	RTRUE
?L22:	EQUAL? PRSA,V?PICK-UP,V?RAISE \?L40
	ZERO? PRSI /?L39
?L40:	EQUAL? PRSA,V?RAISE \?L38
	EQUAL? PRSI,FOUNTAIN,BUTTON \?L38
?L39:	CALL RUNNING?,I-BOOST >STACK
	ZERO? STACK /?L41
	SET 'HELPED-THUMB,1
	PRINTI "Once elevated, "
	CALL THUMB-DRINKS
	CALL BOOST-EXIT >STACK
	RSTACK
?L41:	CALL PERFORM,V?TAKE,THUMB
	RTRUE
?L38:	EQUAL? HERE,BLUE-ROOM \?L46
	CALL DISTURB?,THUMB >STACK
	ZERO? STACK /?L47
	PRINTI "Curious, the "
	CALL DPRINT,DEALER
	PRINTI " peeks under the "
	CALL DPRINT,TABLE
	PRINTI " and flushes "
	CALL DPRINT,THUMB
	PRINTI ", who sprints through the "
	CALL DPRINT,BLUE-DOOR
	PRINTI ". "
	CALL EIGHTY-SIX >STACK
	RSTACK
?L47:	EQUAL? PRSA,V?EXAMINE \FALSE
	FSET? TABLE,RMUNGBIT \?L52
	EQUAL? HERE,BLUE-ROOM \?L52
	CALL PERFORM,V?RUB,THUMB
	RTRUE
?L52:	CALL RUNNING?,I-CLOWN-ALLEY >STACK
	ZERO? STACK /?L54
	EQUAL? HERE,CLOWN-ALLEY \?L54
	ZERO? HELPED-THUMB /?L54
	PRINTR "He winks at you and flashes a smile."
?L54:	FSET TABLE,RMUNGBIT
	PRINT YOU-SEE
	PRINTR " a trembling midget hand pull the tablecloth back down."
?L46:	EQUAL? PRSA,V?TAKE \?L61
	EQUAL? PRSO,THUMB \?L61
	EQUAL? HERE,RING /?L64
	CALL RUNNING?,I-CLOWN-ALLEY >STACK
	ZERO? STACK /?L62
?L64:	PRINTI "He"
	ZERO? HELPED-THUMB /?L67
	PRINTI "'s had it with the upsy-daisy stuff and"
?L67:	EQUAL? HERE,RING \?L72
	PRINTI " resists furiously"
	JUMP ?L76
?L72:	PRINTI " leans back out of reach"
?L76:	PRINT PERIOD
	RTRUE
?L62:	CALL RUNNING?,I-BOOST >STACK
	ZERO? STACK /?L81
	CALL PERFORM,V?RAISE,THUMB
	RTRUE
?L81:	CALL RUNNING?,I-THUMB >STACK
	ZERO? STACK \?L83
	CALL RUNNING?,I-CLOWN-EXIT >STACK
	ZERO? STACK /?L82
	ZERO? HELPED-THUMB \?L82
?L83:	PRINTI "As you reach down, he scampers between your legs"
	CALL RUNNING?,I-CLOWN-EXIT >STACK
	ZERO? STACK /?L88
	CALL RUNNING?,I-THUMB >STACK
	ZERO? STACK /?L86
?L88:	PRINTI ", giggling in his strangely high-pitched, compressed voice"
?L86:	PRINT PERIOD
	RTRUE
?L82:	CALL RUNNING?,I-CLOWN-EXIT >STACK
	ZERO? STACK /?L94
	CALL ITAKE >STACK
	EQUAL? STACK,1 \?L94
	GRTR? CLOWN-EXIT-COUNTER,3 \?L95
	SET 'CLOWN-EXIT-COUNTER,3
?L95:	MOVE FLOWER,THUMB
	PRINTR "As you put your hands on the midget, for an instant he squirms, then, deciding you mean no harm, relaxes in your grip and you're able to lift him.

You notice him wearing a daisy in the lapel of his uniform."
?L94:	CALL ITAKE >STACK
	EQUAL? STACK,1 \TRUE
	PRINTR "You cradle the little performer in your arms and he allows you to lift him."
?L61:	EQUAL? PRSA,V?MOVE \?L104
	CALL V-DIG >STACK
	RSTACK
?L104:	EQUAL? PRSA,V?FOLLOW \FALSE
	EQUAL? FOLLOW-FLAG,1,10 \?L106
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L106:	EQUAL? FOLLOW-FLAG,2 \FALSE
	EQUAL? HERE,BACK-YARD \?L109
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L109:	CALL DO-WALK,P?WEST >STACK
	RSTACK

	.FUNCT THUMB-DESCFCN,X
	EQUAL? HERE,CLOWN-ALLEY \?L1
	CALL RUNNING?,I-CLOWN-ALLEY >STACK
	ZERO? STACK /?L1
	PRINTI "Sitting on an upper bunk, with his arms folded and legs swinging, is Comrade Thumb."
	RTRUE
?L1:	FSET? CROWBAR,TOUCHBIT \?L5
	PRINTI "Lying perfectly still in the "
	CALL DPRINT,UPPER
	PRINTI ", yet with his eyes wide open, is "
	CALL DPRINT,THUMB
	PRINTI "."
	RTRUE
?L5:	PRINTI "Comrade Thumb is here."
	RTRUE

	.FUNCT THUMB-DRINKS
	CALL DPRINT,THUMB
	PRINTI " slurps his fill of "
	CALL DPRINT,WATER
	PRINTI ". He then plops down, gives you a quick salute,"
	RTRUE

	.FUNCT UNIFORM-F
	IN? UNIFORM,THUMB \FALSE
	EQUAL? PRSA,V?REMOVE,V?TAKE \FALSE
	CALL PRINT-ID,STR?245
	CALL KIND-OF-PERFORMER,THUMB >STACK
	RSTACK

	.FUNCT KIND-OF-PERFORMER,PERSON?1=0
	ZERO? PERSON?1 /?L1
	CALL DPRINT,PERSON?1
	JUMP ?L5
?L1:	PRINTI "Tina"
?L5:	PRINTR " is not that kind of performer."

	.FUNCT FLOWER-F
	EQUAL? PRSA,V?PICK,V?TAKE,V?EXAMINE /?L3
	EQUAL? PRSA,V?SMELL,V?RUB \FALSE
?L3:	FSET? FLOWER,RMUNGBIT \?L4
	PRINTR "You're not going to fall for that trick twice."
?L4:	EQUAL? PRSA,V?SMELL /?L8
	PRINTI "As you reach for it, t"
	JUMP ?L11
?L8:	PRINTI "T"
?L11:	FSET FLOWER,RMUNGBIT
	PRINTI "he daisy spritzes some water in your face, and "
	CALL DPRINT,THUMB
	PRINTR "'s cherubic face lets out a squeal of delight."

	.FUNCT I-BOOST
	INC 'BOOST-COUNTER
	EQUAL? BOOST-COUNTER,7 \?L1
	CALL BOOST-EXIT >STACK
	RSTACK
?L1:	EQUAL? HERE,CON-AREA \FALSE
	CRLF
	EQUAL? BOOST-COUNTER,1 \?L6
	PRINTI "The last of the crowd just now trickles eastward through the "
	CALL DPRINT,TURNSTILE
	PRINTI ".

A midget decked out in a Russian general's uniform is standing before"
	JUMP ?L22
?L6:	EQUAL? BOOST-COUNTER,2 \?L10
	PRINTI "The little general gets up on his tiptoes in front of"
	JUMP ?L22
?L10:	EQUAL? BOOST-COUNTER,3 \?L13
	PRINTI "Attempting to do a pull-up, Comrade Thumb manages to sprawl himself onto"
	JUMP ?L22
?L13:	EQUAL? BOOST-COUNTER,4 \?L16
	PRINTI "Straining his neck to reach the spout, the midget gropes for the button, loses his grip and plops to the "
	CALL DPRINT,GROUND
	PRINTI " before"
	JUMP ?L22
?L16:	EQUAL? BOOST-COUNTER,5 \?L19
	PRINTI "The midget looks up at you sadly, then at"
	JUMP ?L22
?L19:	EQUAL? BOOST-COUNTER,6 \?L22
	PRINTI "Comrade Thumb flaps his little arms once in frustration,"
	CALL BOOST-EXIT
	RFALSE
?L22:	PRINTI " the "
	CALL DPRINT,FOUNTAIN
	PRINTR "."

	.FUNCT BOOST-EXIT
	MOVE THUMB,LOCAL-GLOBALS
	CALL INT,I-BOOST >STACK
	PUT STACK,0,0
	MOVE CROWD,STANDS-ROOM
	EQUAL? HERE,CON-AREA \TRUE
	LESS? BOOST-COUNTER,7 \TRUE
	PRINTI " and waddles off into the darkness."
	CRLF
	SET 'FOLLOW-FLAG,1
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	RTRUE

	.FUNCT JOEY-DESC,X
	CALL RUNNING?,I-CLOWN-ALLEY >STACK
	ZERO? STACK /?L1
	PRINTI "Chuckles the clown is leaning in front of a mirror, removing his makeup."
	RTRUE
?L1:	EQUAL? HERE,BACK-YARD \?L5
	PRINTI "A tall and lanky clown in baggy pants trudges out of the "
	EQUAL? P-WALK-DIR,P?EAST \?L8
	CALL DPRINT,DARKNESS
	JUMP ?L12
?L8:	PRINTI "tent"
?L12:	PRINTI " and toward the "
	CALL DPRINT,TURNSTILE
	PRINTI ". "
	CALL DPRINT,THUMB
	PRINTI " follows behind."
	RTRUE
?L5:	EQUAL? HERE,EAST-CAMP \FALSE
	PRINTI "Chuckles is standing, out of costume, in front of the aluminum trailer."
	ZERO? WIPE-C \FALSE
	PRINTI " As you approach, "
	CALL JOKE-TIME?,JOEY-JOKE >STACK
	ZERO? STACK /?L24
	SET 'JOEY-JOKE,1
	PRINTI "he glances at you and says, ""Pick up an application at the "
	CALL DPRINT,WAGON
	PRINTI ", not here."""
	RTRUE
?L24:	PRINTI "he begins polishing away at it."
	RTRUE

	.FUNCT JOEY-F
	EQUAL? WINNER,JOEY \?L1
	EQUAL? PRSA,V?TELL-ABOUT \?L3
	EQUAL? PRSO,ME \?L3
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,JOEY,PRSI
	SET 'WINNER,JOEY
	RTRUE
?L3:	EQUAL? PRSA,V?HELLO \?L5
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,JOEY
	SET 'WINNER,JOEY
	RTRUE
?L5:	EQUAL? PRSA,V?YOU-ARE-OBJECT \?L6
	EQUAL? PRSO,EDDIE \?L6
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?TELL,EDDIE
	SET 'WINNER,JOEY
	RTRUE
?L6:	PRINT BEAT-IT
	CALL STOP >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?TELL-ABOUT,V?ASK-ABOUT \?L10
	EQUAL? PRSI,EDDIE \?L10
	FSET? EDDIE,RMUNGBIT \?L10
	CALL PERFORM,V?HELLO,EDDIE
	RTRUE
?L10:	CALL TALKING-TO?,JOEY >STACK
	ZERO? STACK /?L11
	CALL RUNNING?,I-CLOWN-ALLEY >STACK
	ZERO? STACK /?L11
	CALL PERFORM,V?RUB,JOEY
	RTRUE
?L11:	CALL TALKING-TO?,JOEY >STACK
	ZERO? STACK /?L12
	EQUAL? PRSA,V?TELL /?L12
	PRINT BEAT-IT
	CALL STOP >STACK
	RSTACK
?L12:	EQUAL? PRSA,V?FOLLOW \?L15
	EQUAL? FOLLOW-FLAG,2 \?L16
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L16:	EQUAL? FOLLOW-FLAG,3 \?L18
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L18:	EQUAL? FOLLOW-FLAG,4 \FALSE
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L15:	EQUAL? PRSA,V?SHOW,V?GIVE \FALSE
	EQUAL? PRSI,EDDIE,JOEY \FALSE
	SET 'P-IT-OBJECT,JOEY
	EQUAL? PRSO,RIBBON \?L22
	FSET? RIBBON,RMUNGBIT /?L22
	INC 'SCARE-NUMBER
	FSET RIBBON,RMUNGBIT
	CALL JOEY-SCARED? >STACK
	ZERO? STACK /?L24
	RETURN 2
?L24:	FSET? TRADE-CARD,RMUNGBIT \?L28
	CALL HATE-TO-SEE
	CALL ELBOW-GREASE >STACK
	RSTACK
?L28:	PRINTR """Never saw it before in my life."""
?L22:	EQUAL? PRSO,TRADE-CARD \?L32
	FSET? TRADE-CARD,RMUNGBIT /?L32
	INC 'SCARE-NUMBER
	FSET TRADE-CARD,RMUNGBIT
	CALL JOEY-SCARED? >STACK
	ZERO? STACK /?L33
	RETURN 2
?L33:	FSET? RIBBON,RMUNGBIT \?L37
	PRINTI """That ribbon in her hair looks like yours."" He pauses. "
	CALL HATE-TO-SEE
	CALL ELBOW-GREASE
	RTRUE
?L37:	PRINTR """Good product. I'd highly recommend it."""
?L32:	EQUAL? PRSO,SCRAP \?L43
	FSET? SCRAP,RMUNGBIT /?L43
	FSET SCRAP,RMUNGBIT
	INC 'SCARE-NUMBER
	CALL DPRINT,JOEY
	PRINTI " looks skeptically at the "
	CALL DPRINT,SCRAP
	PRINTI " while listening to you tell where you found it. "
	CALL JOEY-SCARED?,1 >STACK
	ZERO? STACK /?L46
	RETURN 2
?L46:	FSET? NOTE,RMUNGBIT \?L50
	CALL CHERRY-PIE
	CALL ELBOW-GREASE
	RTRUE
?L50:	CRLF
	CRLF
	PRINTR """Yea, I make paper dolls for the local kids. It's part of my act. So what?"""
?L43:	EQUAL? PRSO,NOTE \?L54
	FSET? NOTE,RMUNGBIT /?L54
	FSET NOTE,RMUNGBIT
	INC 'SCARE-NUMBER
	PRINTI "He reads the "
	CALL DPRINT,NOTE
	PRINTI ", silently mouthing the words. "
	CALL JOEY-SCARED?,1 >STACK
	ZERO? STACK /?L57
	RETURN 2
?L57:	FSET? SCRAP,RMUNGBIT \?L61
	CALL CHERRY-PIE
	CALL ELBOW-GREASE
	RTRUE
?L61:	PRINTI "He deadpans, ""Fascinating. Don't let the "
	CALL DPRINT,DICK
	PRINTR " find you with that."""
?L54:	EQUAL? PRSO,SHEET \?L65
	FSET? SHEET,RMUNGBIT /?L65
	FSET SHEET,RMUNGBIT
	INC 'SCARE-NUMBER
	PRINTI "Chuckles's eyes dart between the various numbers in the multiple columns on the "
	CALL DPRINT,SHEET
	PRINTI ". "
	CALL JOEY-SCARED?,1 >STACK
	ZERO? STACK /?L68
	RETURN 2
?L68:	ZERO? JOEY-NAME-KNOWN /?L72
	PRINTI """So what? It's tough all over. I don't hold any grudge against "
	CALL DPRINT,MUNRAB
	PRINTI ". Hell, I'm just a clown, a happy clown."" "
	CALL ELBOW-GREASE >STACK
	RSTACK
?L72:	PRINTR """I don't know anyone by that name."""
?L65:	EQUAL? PRSO,SCRAP,NOTE,SHEET /?L79
	EQUAL? PRSO,TRADE-CARD,RIBBON \FALSE
?L79:	PRINTR "He ignores it this time."

	.FUNCT HATE-TO-SEE
	PRINTI """I'd hate to be caught red-handed holding that "
	CALL DPRINT,RIBBON
	PRINTI " if I were you."" "
	RTRUE

	.FUNCT I-JOEY
	INC 'WIPE-C
	EQUAL? WIPE-C,8 \?L1
	MOVE JOEY,LOCAL-GLOBALS
	EQUAL? HERE,EAST-CAMP \FALSE
	CALL TELL-SCREWS,STR?246
	SET 'FOLLOW-FLAG,4
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	PRINTI " the "
	CALL DPRINT,TAMER-TRAILER
	PRINTR "."
?L1:	EQUAL? HERE,EAST-CAMP \FALSE
	EQUAL? WIPE-C,2,4,6 \FALSE
	EQUAL? PRSA,V?GIVE,V?SHOW \?L9
	EQUAL? PRSI,JOEY /FALSE
?L9:	CRLF
	CALL DPRINT,JOEY
	PRINTI " dribbles a little Dr. Nostrum's onto his rag and continues wiping away at the "
	CALL DPRINT,TAMER-TRAILER
	PRINTR "."

	.FUNCT ELBOW-GREASE
	CALL DPRINT,JOEY
	EQUAL? SCARE-NUMBER,2 \?L3
	PRINTI ", unable to mask his concern,"
	JUMP ?L10
?L3:	EQUAL? SCARE-NUMBER,3 \?L7
	PRINTI ", looking unclownly and perturbed,"
	JUMP ?L10
?L7:	EQUAL? SCARE-NUMBER,4 \?L10
	PRINTI " does a slow burn as he continues cleaning the "
	CALL DPRINT,TAMER-TRAILER
	PRINTR "."
?L10:	PRINTR " applies extra elbow grease to his cleaning."

	.FUNCT JOEY-SCARED?,CRLF?=0
	ZERO? JOEY-NAME-KNOWN /FALSE
	FSET? NOTE,RMUNGBIT \FALSE
	FSET? SHEET,RMUNGBIT \FALSE
	FSET? SCRAP,RMUNGBIT \FALSE
	FSET? TRADE-CARD,RMUNGBIT \FALSE
	FSET? RIBBON,RMUNGBIT \FALSE
	SET 'WON-JOEY,1
	CALL INT,I-JOEY >STACK
	PUT STACK,0,0
	MOVE JOEY,LOCAL-GLOBALS
	ADD SCORE,10 >SCORE
	ZERO? CRLF? /?L3
	CRLF
	CRLF
?L3:	CALL TELL-SCREWS,STR?247
	SET 'FOLLOW-FLAG,3
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	PRINT PERIOD
	RTRUE

	.FUNCT TELL-SCREWS,STRING
	ZERO? WON-JOEY /?L1
	PRINTI "Looking like a clown with a hotfoot, "
?L1:	CALL DPRINT,JOEY
	PRINTI " suddenly screws the cap onto the flask of Dr. Nostrum's and "
	PRINT STRING
	RTRUE

	.FUNCT CHERRY-PIE
	CRLF
	CRLF
	PRINTI """So you think you've fingered me for this note. Pretty thin stuff, if you ask me. Besides, I've got no gripes against the bossman. Why, here I am doing cherry pie in the middle of the night."" "
	RTRUE

	.FUNCT CLOWN-ALLEY-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "The gut of the trailer exposes the underside of circus life -- grungy costumes strewn about, crooked and cracked mirrors, the musty odor of fresh makeup mingled with clown sweat infusing the air.

Against the wall is a row of cramped-looking bunks, and running from the floor to one "
	CALL DPRINT,UPPER
	PRINTI " is a small ladder. "
	FIRST? UPPER >STACK /?L7
	FIRST? LOWER >STACK \?L12
?L7:	PRINT YOU-SEE
	FIRST? LOWER >STACK \?L10
	CALL PRINT-BUNKS,LOWER,UPPER
	CRLF
	RTRUE
?L10:	CALL PRINT-BUNKS,UPPER,LOWER
?L12:	CRLF
	RTRUE
?L1:	EQUAL? RARG,M-ENTER \?L14
	CALL PRINT-ID,STR?248
	CALL STEP-INTO-TRAILER
	ZERO? CLOWN-ALLEY-SCENE \FALSE
	SET 'CLOWN-ALLEY-SCENE,1
	SET 'CLOWN-COUNTER,0
	CALL QUEUE,I-CLOWN-ALLEY,-1 >STACK
	PUT STACK,0,1
	RTRUE
?L14:	EQUAL? RARG,M-BEG \FALSE
	CALL ENABLED?,I-CLOWN-ALLEY >STACK
	ZERO? STACK /FALSE
	EQUAL? PRSA,V?TAKE-OFF,V?REMOVE \?L22
	EQUAL? PRSO,MASK /?L21
?L22:	FSET? MASK,WORNBIT /?L19
?L21:	FCLEAR MASK,WORNBIT
	PRINTI "Y"
	CALL UNMASK >STACK
	RSTACK
?L19:	CALL DISTURB?,JOEY >STACK
	ZERO? STACK /FALSE
	EQUAL? FOLLOW-FLAG,99 \?L26
	CRLF
?L26:	PRINTI "Chuckles whirls around, strips you of your disguise and y"
	CALL UNMASK >STACK
	RSTACK

	.FUNCT PRINT-BUNKS,B1,B2
	CALL PRINT-CONTENTS,B1
	PRINTI " sitting on the "
	CALL DPRINT,B1
	FIRST? B2 >STACK \?L3
	PRINTI ", and"
	CALL PRINT-CONTENTS,B2
	PRINTI " on the "
	CALL DPRINT,B2
?L3:	PRINTI "."
	RTRUE

	.FUNCT EXIT-CLOWN-ALLEY
	FSET? WARPED-DOOR,OPENBIT /?L1
	PRINTI "The "
	CALL DPRINT,WARPED-DOOR
	PRINTI " is closed."
	CRLF
	RFALSE
?L1:	CALL RUNNING?,I-CLOWN-ALLEY >STACK
	ZERO? STACK /?L5
	CALL HELD?,TRAY >STACK
	ZERO? STACK /?L5
	MOVE TRAY,LOCAL-GLOBALS
	CALL DPRINT,JOEY
	PRINTI " notices a little squirreliness on your part, confronts you, grabs the "
	CALL DPRINT,TRAY
	PRINTI ", and throws you out."
	CRLF
	CRLF
?L5:	RETURN WEST-CAMP

	.FUNCT CLOWN-TRAILER-F
	EQUAL? PRSA,V?EXAMINE \?L1
	EQUAL? HERE,WEST-CAMP \?L3
	PRINTI "It's a vintage model that's seen plenty of bad road. The door, which is "
	FSET? WARPED-DOOR,OPENBIT \?L7
	PRINTI "open"
	JUMP ?L11
?L7:	PRINTI "closed"
?L11:	PRINTR ", appears warped."
?L3:	CALL V-LOOK >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?SMELL \?L17
	EQUAL? HERE,CLOWN-ALLEY \?L17
	CALL PERFORM,V?SMELL
	RTRUE
?L17:	EQUAL? PRSA,V?UNLOCK,V?CLOSE,V?OPEN /?L19
	EQUAL? PRSA,V?LOCK \?L18
?L19:	CALL PERFORM,PRSA,WARPED-DOOR,PRSI
	RTRUE
?L18:	EQUAL? PRSA,V?ENTER,V?THROUGH,V?WALK-TO \FALSE
	EQUAL? HERE,WEST-CAMP \?L21
	CALL DO-WALK,P?IN >STACK
	RSTACK
?L21:	EQUAL? HERE,CLOWN-ALLEY \FALSE
	PRINT LOOK-AROUND
	CRLF
	RTRUE

	.FUNCT I-CLOWN-ALLEY
	FSET? WARPED-DOOR,RMUNGBIT \?L1
	FCLEAR WARPED-DOOR,RMUNGBIT
	RFALSE
?L1:	INC 'CLOWN-COUNTER
	EQUAL? HERE,CLOWN-ALLEY /?L4
	FSET? WARPED-DOOR,OPENBIT \?L4
	CALL INT,I-CLOWN-ALLEY >STACK
	PUT STACK,0,0
	FCLEAR WARPED-DOOR,OPENBIT
	FSET WARPED-DOOR,LOCKEDBIT
	EQUAL? HERE,WEST-CAMP \FALSE
	CRLF
	PRINTI "The "
	CALL DPRINT,WARPED-DOOR
	PRINTR " is slammed shut."
?L4:	EQUAL? CLOWN-COUNTER,2 \?L12
	SET 'P-IT-OBJECT,WARPED-DOOR
	CRLF
	PRINTI "Chuckles speaks, ""Sorry about the door, Malcom, but Johnny Tin Plate's out there nosing around."
	FSET? WARPED-DOOR,OPENBIT \?L16
	PRINTI " Close it, will you?"
?L16:	PRINTR """"
?L12:	EQUAL? CLOWN-COUNTER,3 \?L23
	ZERO? HELPED-THUMB \?L23
	CRLF
	CALL DPRINT,THUMB
	PRINTI " mutters something in Russian to Chuckles."
	CRLF
	CRLF
	CALL PERFORM,V?RUB,JOEY
	RTRUE
?L23:	EQUAL? CLOWN-COUNTER,4 \?L26
	CRLF
	PRINTI """Let's just hope he doesn't find the grift."
	FSET? WARPED-DOOR,OPENBIT \?L29
	PRINTI " Close the door, huh?"
?L29:	PRINTR """"
?L26:	EQUAL? CLOWN-COUNTER,6 \FALSE
	FSET? WARPED-DOOR,OPENBIT \?L37
	SET 'FOLLOW-FLAG,99
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	CALL PERFORM,V?RUB,JOEY
	RTRUE
?L37:	SET 'CLOWN-COUNTER,7
	CRLF
	PRINTI """It'll be okay unless somebody tips him off about shoving Annie Oakley under the old front by the elephant tent --"""
	CRLF
	CRLF
	PRINTI "His voice suddenly halts. "
	CALL PERFORM,V?RUB,JOEY
	RTRUE

	.FUNCT UNMASK
	SET 'UNMASKED?,1
	CALL INT,I-CLOWN-ALLEY >STACK
	PUT STACK,0,0
	FCLEAR WARPED-DOOR,OPENBIT
	FSET WARPED-DOOR,LOCKEDBIT
	PRINTI "ou're suddenly eye-to-eye with a very unhappy clown whose greasepaint red horseshoe smile practically melts off his face. "
	CRLF
	CRLF
	FSET? MASK,WORNBIT \?L5
	CALL HELD?,TRAY >STACK
	ZERO? STACK /?L15
?L5:	PRINTI "Snatching away the "
	FSET? MASK,WORNBIT /?L8
	CALL HELD?,TRAY >STACK
	ZERO? STACK /?L8
	CALL DPRINT,MASK
	PRINTI " and the "
	CALL DPRINT,TRAY
	PRINTI ", "
	JUMP ?L15
?L8:	CALL HELD?,TRAY >STACK
	ZERO? STACK /?L12
	CALL DPRINT,TRAY
	PRINTI ", "
	JUMP ?L15
?L12:	CALL DPRINT,MASK
	PRINTI ", "
?L15:	MOVE TRAY,LOCAL-GLOBALS
	PRINTI "Chuckles seizes you by the scruff of your neck, and the irate clown hustles you out of the "
	CALL DPRINT,CLOWN-TRAILER
	PRINTI "."
	CRLF
	CRLF
	FCLEAR MASK,WORNBIT
	MOVE MASK,LOCAL-GLOBALS
	CALL GOTO,WEST-CAMP >STACK
	RSTACK

	.FUNCT TRAY-F
	EQUAL? PRSA,V?SEARCH,V?EMPTY \?L1
	IN? ASH,TRAY \?L1
	CALL PERFORM,V?MOVE,ASH
	RTRUE
?L1:	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	CALL V-COUNT >STACK
	RSTACK

	.FUNCT ASH-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "The ash, by its jet blackness, does not appear to be the remnant of tobacco."
?L1:	EQUAL? PRSA,V?RUB,V?SEARCH,V?TAKE /?L6
	EQUAL? PRSA,V?MOVE,V?LOOK-UNDER,V?LOOK-INSIDE \?L5
?L6:	FSET? ASH,RMUNGBIT \?L7
	PRINTR "The ashes sift through your fingers."
?L7:	FSET ASH,RMUNGBIT
	MOVE SCRAP,TRAY
	PRINTI "In disturbing the "
	CALL DPRINT,ASH
	PRINTI ", a "
	CALL DPRINT,SCRAP
	PRINTR " is revealed."
?L5:	EQUAL? PRSA,V?POUR,V?DROP,V?EMPTY \FALSE
	MOVE ASH,LOCAL-GLOBALS
	PRINTI "The ashes swirl through the air and disappear"
	FSET? ASH,RMUNGBIT \?L19
	IN? SCRAP,TRAY /?L19
	FSET? ASH,RMUNGBIT /?L17
?L19:	MOVE SCRAP,HERE
	PRINTI " as a tiny "
	CALL DPRINT,SCRAP
	PRINTI " floats down"
?L17:	PRINT PERIOD
	RTRUE

	.FUNCT SCRAP-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "The "
	CALL DPRINT,SCRAP
	PRINTR " is about an inch square."
?L1:	EQUAL? PRSA,V?COMPARE \?L5
	EQUAL? NOTE,PRSO,PRSI \?L5
	PRINTI "The ""M"" on the "
	CALL DPRINT,SCRAP
	PRINTI " looks like it was cut from the the same newspaper as the letters on the "
	CALL DPRINT,NOTE
	PRINTR "."
?L5:	EQUAL? PRSA,V?READ \FALSE
	PRINTR "There's a paragraph of yak trivia on one side, and the letter ""M"" in 48-point type on the other."

	.FUNCT COSTUME-F
	EQUAL? PRSA,V?TAKE \FALSE
	PRINTI "Nope, too repulsive."
	CRLF
	CALL PRINT-ID,STR?249 >STACK
	RSTACK

	.FUNCT MIRROR-F
	EQUAL? PRSA,V?LOOK-INSIDE \FALSE
	FSET? MASK,WORNBIT \?L3
	PRINT YOU-SEE
	PRINTI " your beady eyes through the "
	CALL DPRINT,MASK
	PRINTR "."
?L3:	CALL PERFORM,V?EXAMINE,ME
	RTRUE

	.FUNCT BUNK-F
	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L1
	EQUAL? PRSO,UPPER \?L1
	IN? THUMB,HERE \?L1
	CALL DPRINT,THUMB
	PRINTI " is there. "
	FIRST? UPPER >STACK /FALSE
	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?CLIMB-FOO,V?CLIMB-ON,V?BOARD /?L9
	EQUAL? PRSA,V?THROUGH \FALSE
?L9:	EQUAL? PRSO,UPPER \?L10
	SET 'PRSO,CEILING
	FSET UPPER,RMUNGBIT
	JUMP ?L12
?L10:	SET 'PRSO,UPPER
	FSET LOWER,RMUNGBIT
?L12:	SET 'CLOCK-WAIT,1
	CALL TELL-HIT-HEAD
	FSET? UPPER,RMUNGBIT \TRUE
	FSET? LOWER,RMUNGBIT \TRUE
	PRINTI "Hadn't you really ought to stop trying to sleep around like this?"
	CRLF
	SET 'AWAITING-REPLY,2
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	SET 'CLOCK-WAIT,1
	RTRUE

	.FUNCT WARPED-DOOR-F
	EQUAL? PRSA,V?PICK,V?OPEN \?L12
	FSET? WARPED-DOOR,OPENBIT /?L1
	ZERO? PRSI /?L1
	EQUAL? PRSI,CROWBAR \?L3
	SET 'WARPED-DOOR-BROKEN,1
	FSET WARPED-DOOR,OPENBIT
	FCLEAR WARPED-DOOR,LOCKEDBIT
	FCLEAR CLOWN-ALLEY,TOUCHBIT
	PRINTI "You wedge the "
	CALL DPRINT,CROWBAR
	PRINTI " between the frame and the door then give it a yank. The "
	CALL DPRINT,WARPED-DOOR
	PRINTI " pops open."
	CRLF
	CALL PRINT-ID,STR?250 >STACK
	RSTACK
?L3:	PRINT IT-LOOKS-LIKE
	CALL ARTICLE,PRSI,1
	PRINTI " is unequal to the task."
	CRLF
	CALL PRINT-ID,STR?251 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?PICK,V?OPEN \?L12
	ZERO? WARPED-DOOR-BROKEN \?L12
	ZERO? PRSI \?L12
	CALL HELD?,CROWBAR >STACK
	ZERO? STACK /?L12
	PRINTI "(with the "
	CALL DPRINT,CROWBAR
	PRINTI ")"
	CRLF
	CALL PERFORM,V?OPEN,WARPED-DOOR,CROWBAR
	RTRUE
?L12:	EQUAL? PRSA,V?CLOSE \?L18
	ZERO? WARPED-DOOR-BROKEN /?L15
	PRINTR "The damaged door creaks back open."
?L15:	EQUAL? PRSA,V?CLOSE \?L18
	EQUAL? HERE,WEST-CAMP \?L18
	IN? JOEY,CLOWN-ALLEY \?L18
	FSET? CLOWN-ALLEY,TOUCHBIT /?L18
	FSET WARPED-DOOR,LOCKEDBIT
	RFALSE
?L18:	EQUAL? PRSA,V?EXAMINE \?L19
	PRINT YOU-SEE
	PRINTR " that the door is warped slightly along its edge."
?L19:	EQUAL? PRSA,V?KNOCK \FALSE
	ZERO? UNMASKED? \FALSE
	FSET? WARPED-DOOR,RMUNGBIT /FALSE
	EQUAL? HERE,CLOWN-ALLEY /FALSE
	EQUAL? CLOWN-COUNTER,25 \FALSE
	PRINTI "Chuckles pops his head out from behind the "
	CALL DPRINT,WARPED-DOOR
	PRINTI " and "
	FSET? MASK,WORNBIT \?L29
	FSET? SHAWL,WORNBIT /?L29
	FSET? DRESS,WORNBIT /?L29
	ADD SCORE,10 >SCORE
	SET 'CLOWN-COUNTER,0
	CALL QUEUE,I-CLOWN-ALLEY,3 >STACK
	PUT STACK,0,1
	FSET WARPED-DOOR,OPENBIT
	FCLEAR WARPED-DOOR,LOCKEDBIT
	PRINTR "squints at you through a layer of cold cream, then flings the door open. He withdraws into the trailer."
?L29:	FSET WARPED-DOOR,RMUNGBIT
	CALL QUEUE,I-CLOWN-ALLEY,5 >STACK
	PUT STACK,0,1
	PRINTR "shades his eyes to look at you. ""Beat it, lotlice,"" he says, withdrawing into the trailer and closing the door."

	.INSERT "annotated_games/ballyhoo/ballyhoo_str"
	.END
