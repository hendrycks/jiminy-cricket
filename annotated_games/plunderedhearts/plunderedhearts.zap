	.INSERT "plunderedhearts/plunderedhearts_freq"
	.INSERT "plunderedhearts/plunderedhearts_data"

	.FUNCT PRINT-DESC1,OBJ
	ZERO? OBJ /FALSE
	PRINTD OBJ
	RTRUE

	.FUNCT PRINT-ID,ID,CONDITION=1
	ZERO? CONDITION /FALSE
	PRINTI "[ID: "
	PRINT ID
	PRINTI ", PRSO: "
	CALL PRINT-DESC1,PRSO
	PRINTI ", PRSI: "
	CALL PRINT-DESC1,PRSI
	PRINTI "]"
	RTRUE

	.FUNCT PRINT-DEBUG,TEXT,CONDITION=1
	ZERO? CONDITION /FALSE
	PRINTI "DEBUG FLAG: "
	PRINT TEXT
	RTRUE

	.FUNCT IS-THEFT?
	EQUAL? PRSA,V?TAKE \FALSE
	EQUAL? PRSO,BLUE-GLASS,BOOKCASE,BOTTLE /TRUE
	EQUAL? PRSO,CABIN-BED,CANNON,CASK /TRUE
	EQUAL? PRSO,CHAIR,CHANDELIER,COFFER /TRUE
	EQUAL? PRSO,CURTAIN,DAGGER,DEBRIS /TRUE
	EQUAL? PRSO,DESK,DIVAN,DRAPES /TRUE
	EQUAL? PRSO,FLAGON,FLOWER,FOLLY-OBJECT /TRUE
	EQUAL? PRSO,FRONT-GATE,FUSE,GALLEY-OBJECT /TRUE
	EQUAL? PRSO,GARTER,GLOBE,GREEN-GLASS /TRUE
	EQUAL? PRSO,HAT,HATCH,HORN /TRUE
	EQUAL? PRSO,HRING,JEWEL,KEG /TRUE
	EQUAL? PRSO,KNOB,LADDER,LARGE-KEY /TRUE
	EQUAL? PRSO,LAUD,LEVER,LINE /TRUE
	EQUAL? PRSO,LRING,MANACLES,MIRROR /TRUE
	EQUAL? PRSO,MOONBEAM,OARS,PAIR /TRUE
	EQUAL? PRSO,PANTS,PILE-OF-CLOTHES,PINCH /TRUE
	EQUAL? PRSO,PISTOL,PORK,PORTRAIT /TRUE
	EQUAL? PRSO,POWDER,POWER,PSEUD-SKIFF /TRUE
	EQUAL? PRSO,PYRAMID,RAG,RAPIER /TRUE
	EQUAL? PRSO,ROPE,RUM,RUM-BARREL /TRUE
	EQUAL? PRSO,SHIP,SHIRT,SHUTTERS /TRUE
	EQUAL? PRSO,SIGN,SKIFF,SLAT /TRUE
	EQUAL? PRSO,SUPPLIES,TORCH,VINE /TRUE
	EQUAL? PRSO,WATER-BARREL,WHEEL,WHIP /TRUE
	EQUAL? PRSO,WINCH,WINE \FALSE
	RTRUE

	.FUNCT IS-OBJECT-OR-PROPERTY?
	EQUAL? PRSO,ANCHOR,BANKNOTE,BENCH /TRUE
	EQUAL? PRSO,BLUE-GLASS,BOOKCASE,BOOKS-GLOBAL /TRUE
	EQUAL? PRSO,BOTTLE,BUSHES,CABIN-BED /TRUE
	EQUAL? PRSO,CANNON,CAPT-BED,CASK /TRUE
	EQUAL? PRSO,CEILING,CELL-OBJ,CHAIN /TRUE
	EQUAL? PRSO,CHAIR,CHANDELIER,CHICKEN /TRUE
	EQUAL? PRSO,COFFER,COT,CUPBOARD-OBJECT /TRUE
	EQUAL? PRSO,CURTAIN,DAGGER,DEBRIS /TRUE
	EQUAL? PRSO,DESK,DIVAN,DOOR /TRUE
	EQUAL? PRSO,DRAPES,FENCE,FLAGON /TRUE
	EQUAL? PRSO,FLOWER,FOLLY-OBJECT,FRONT-GATE /TRUE
	EQUAL? PRSO,FUSE,GALLEY-OBJECT,GARTER /TRUE
	EQUAL? PRSO,GATE,GLOBE,GOWN /TRUE
	EQUAL? PRSO,GRATE,GREEN-GLASS,GUEST-BED /TRUE
	EQUAL? PRSO,HAT,HATCH,HEDGE /TRUE
	EQUAL? PRSO,HORN,HOUSE,HRING /TRUE
	EQUAL? PRSO,INVITE,IRON-CELL-DOOR,ISLAND /TRUE
	EQUAL? PRSO,JEWEL,KEG,KNOB /TRUE
	EQUAL? PRSO,LADDER,LAFS-BED,LARGE-KEY /TRUE
	EQUAL? PRSO,LAUD,LDOOR,LEDGE /TRUE
	EQUAL? PRSO,LEVER,LIB-WINDOW,LINE /TRUE
	EQUAL? PRSO,LONG-TABLE,LRING,MANACLES /TRUE
	EQUAL? PRSO,MESS,MIRROR,MOONBEAM /TRUE
	EQUAL? PRSO,OARS,OBJ-QUARTERS,PAIR /TRUE
	EQUAL? PRSO,PANTS,PILE-OF-CLOTHES,PINCH /TRUE
	EQUAL? PRSO,PISTOL,PORK,PORTRAIT /TRUE
	EQUAL? PRSO,POWDER,POWER,PSEUD-SKIFF /TRUE
	EQUAL? PRSO,PYRAMID,RAG,RAILING /TRUE
	EQUAL? PRSO,RAPIER,REEFS,RIGGING-OBJECT /TRUE
	EQUAL? PRSO,ROPE,RUM,RUM-BARREL /TRUE
	EQUAL? PRSO,SHIP,SHIRT,SHUTTERS /TRUE
	EQUAL? PRSO,SIGN,SKIFF,SLAT /TRUE
	EQUAL? PRSO,SPICES,STAIRS,STONE /TRUE
	EQUAL? PRSO,STUB,SUPPLIES,TABLE /TRUE
	EQUAL? PRSO,TORCH,TRAP,TRAY /TRUE
	EQUAL? PRSO,TREE,VER-DOOR,VEROBJ /TRUE
	EQUAL? PRSO,VINE,WALLS,WATER-BARREL /TRUE
	EQUAL? PRSO,WELL,WHEEL,WHIP /TRUE
	EQUAL? PRSO,WINCH,WINDOW,WINE /TRUE
	EQUAL? PRSO,WOOD-CELL-DOOR \FALSE
	RTRUE

	.FUNCT IS-PERSON?
	FSET? PRSO,ACTORBIT /?L2
	EQUAL? PRSO,HER,HIM,MAN /?L2
	EQUAL? PRSO,PROTAGONIST \FALSE
?L2:	CALL IS-ANIMAL? >STACK
	ZERO? STACK /TRUE
	RFALSE

	.FUNCT IS-ANIMAL?
	EQUAL? PRSO,CROC \FALSE
	RTRUE

	.FUNCT IS-SELF?
	EQUAL? PRSO,ME,HEAD \FALSE
	RTRUE

	.FUNCT IS-PART-OF-SELF?
	EQUAL? PRSO,EYES,HANDS,HEAD /TRUE
	EQUAL? PRSO,MOUTH \FALSE
	RTRUE

	.FUNCT IS-SELF-OR-PART-OF-SELF?,?TMP
	CALL IS-SELF? >?TMP
	ZERO? ?TMP /?L2
	RETURN ?TMP
?L2:	CALL IS-PART-OF-SELF? >STACK
	RSTACK

	.FUNCT IS-YOUR-PROPERTY?
	EQUAL? PRSO,CHEMISE,DRESS,SHOES /TRUE
	EQUAL? PRSO,RETICULE,BANKNOTE,LETTER /TRUE
	EQUAL? PRSO,SALTS,GOWN \FALSE
	RTRUE

	.FUNCT DANGEROUS-DRINK?
	EQUAL? PRSO,POOL,SEA \FALSE
	RTRUE

	.FUNCT DANGEROUS-FOOD?
	CALL IS-PART-OF-SELF? >STACK
	ZERO? STACK \?L2
	CALL IS-OBJECT-OR-PROPERTY? >STACK
	ZERO? STACK /FALSE
?L2:	EQUAL? PRSO,CHICKEN,PORK \TRUE
	RFALSE

	.FUNCT IS-OBJ-PROP-ANIMAL?,?TMP
	CALL IS-OBJECT-OR-PROPERTY? >?TMP
	ZERO? ?TMP /?L2
	RETURN ?TMP
?L2:	CALL IS-ANIMAL? >STACK
	RSTACK

	.FUNCT PICK-ONE,TBL,LENGTH,CNT,RND,MSG,RFROB
	GET TBL,0 >LENGTH
	GET TBL,1 >CNT
	DEC 'LENGTH
	ADD TBL,2 >TBL
	MUL CNT,2 >STACK
	ADD TBL,STACK >RFROB
	SUB LENGTH,CNT >STACK
	RANDOM STACK >RND
	GET RFROB,RND >MSG
	GET RFROB,1 >STACK
	PUT RFROB,RND,STACK
	PUT RFROB,1,MSG
	INC 'CNT
	EQUAL? CNT,LENGTH \?L1
	SET 'CNT,0
?L1:	PUT TBL,0,CNT
	RETURN MSG

	.FUNCT APRINT,OBJ
	FSET? OBJ,NARTICLEBIT /?L3
	EQUAL? OBJ,PANTS,RUM,SALTS \?L1
?L3:	PRINTI " "
	JUMP ?L5
?L1:	FSET? OBJ,VOWELBIT \?L4
	PRINTI " an "
	JUMP ?L5
?L4:	PRINTI " a "
?L5:	PRINTD OBJ
	RTRUE

	.FUNCT TPRINT,OBJ
	FSET? OBJ,NARTICLEBIT \?L1
	PRINTI " "
	JUMP ?L3
?L1:	PRINTI " the "
?L3:	PRINTD OBJ
	RTRUE

	.FUNCT CTPRINT,OBJ
	PRINTI "The "
	PRINTD OBJ
	RTRUE

	.FUNCT TPRINT-PRSO
	CALL TPRINT,PRSO >STACK
	RSTACK

	.FUNCT TPRINT-PRSI
	CALL TPRINT,PRSI >STACK
	RSTACK

	.FUNCT ARPRINT,OBJ
	CALL APRINT,OBJ
	PRINT PCR
	RTRUE

	.FUNCT TRPRINT,OBJ
	CALL TPRINT,OBJ
	PRINT PCR
	RTRUE

	.FUNCT GO
START::
?L0:	PRINTI ">SHOOT THE PIRATE
Trembling, you fire the heavy arquebus. You hear its loud report over the roaring wind, yet the dark figure still approaches. The gun falls from your nerveless hands.
   ""You won't kill me,"" he says, stepping over the weapon. ""Not when I am the only protection you have from Jean Lafond.""
   "
	PRINT NUTBROWN
	PRINTI "Lips curving,"
	PRINT EYES-RAKE
	PRINTI ". You are intensely aware of the strength of his hard seaworn body, of the deep sea blue of his eyes. And then his mouth is on yours, lips parted, demanding, and you arch into his kiss...
   He presses you against him, head bent. ""But who, my dear,"" he whispers into your hair, ""will protect you from me?""
"
	CRLF
	PRINT HIT-RETURN
	PRINTI "begin.]"
	CRLF
	READ P-INBUF,P-LEXV
	USL
	CALL CLEAR-SCREEN,11
	SET 'HERE,CABIN
	USL
	CALL V-VERSION
	CRLF
	PRINTI "LATE ONE SPRING NIGHT IN THE WEST INDIES...

   A crash overhead! Pirates are boarding the Lafond Deux! The first mate hurries you into Captain Davis's cabin.
   ""Good, you brought the girl,"" Davis smirks. ""She'll keep the pirates busy. She was only a tool of Lafond's, anyway. Let me just find that cof--"" A man on deck screams in agony and Davis starts. ""Let's go."" The captain thrusts you on the bed and walks out, locking the door.
   His laugh echoes. ""Best get comfortable, girl. You're likely to be there for the rest of your life."""
	CRLF
	CRLF
	CALL V-LOOK
	CALL MAIN-LOOP
	JUMP ?L0

	.FUNCT CLEAR-SCREEN,CNT=24
?L1:	CRLF
	DEC 'CNT
	ZERO? CNT \?L1
	RTRUE

	.FUNCT MAIN-LOOP,TRASH
?L1:	CALL MAIN-LOOP-1 >TRASH
	JUMP ?L1

	.FUNCT MAIN-LOOP-1,ICNT,OCNT,NUM,CNT=0,OBJ=0,TBL,V,PTBL=1,OBJ1,TMP,ONUM
	CALL PARSER >P-WON
	ZERO? P-WON /?L1
	GETB P-PRSI,P-MATCHLEN >ICNT
	GETB P-PRSO,P-MATCHLEN >OCNT
	ZERO? P-IT-OBJECT /?L3
	CALL ACCESSIBLE?,P-IT-OBJECT >STACK
	ZERO? STACK /?L3
	SET 'TMP,0
?L5:	IGRTR? 'CNT,ICNT /?L6
	GETB P-PRSI,CNT >STACK
	EQUAL? STACK,IT \?L5
	CALL TOO-DARK-FOR-IT? >STACK
	ZERO? STACK \TRUE
	PUTB P-PRSI,CNT,P-IT-OBJECT
	SET 'TMP,1
?L6:	ZERO? TMP \?L19
	SET 'CNT,0
?L18:	IGRTR? 'CNT,OCNT /?L19
	GETB P-PRSO,CNT >STACK
	EQUAL? STACK,IT \?L18
	CALL TOO-DARK-FOR-IT? >STACK
	ZERO? STACK \TRUE
	PUTB P-PRSO,CNT,P-IT-OBJECT
?L19:	SET 'CNT,0
?L3:	GETB P-SYNTAX,P-SBITS >STACK
	BAND STACK,P-SONUMS >ONUM
	ZERO? OCNT /?L33
	ZERO? ICNT \?L31
	EQUAL? ONUM,2 \?L31
?L33:	SET 'NUM,0
	JUMP ?L39
?L31:	GRTR? OCNT,1 \?L34
	SET 'TBL,P-PRSO
	ZERO? ICNT \?L35
	SET 'OBJ,0
	JUMP ?L37
?L35:	GETB P-PRSI,1 >OBJ
?L37:	SET 'NUM,OCNT
	JUMP ?L39
?L34:	GRTR? ICNT,1 \?L38
	SET 'PTBL,0
	SET 'TBL,P-PRSI
	GETB P-PRSO,1 >OBJ
	SET 'NUM,ICNT
	JUMP ?L39
?L38:	SET 'NUM,1
?L39:	ZERO? OBJ \?L40
	EQUAL? ICNT,1 \?L40
	GETB P-PRSI,1 >OBJ
?L40:	EQUAL? PRSA,V?WALK \?L43
	CALL PERFORM-PRSA,PRSO >V
	JUMP ?L59
?L43:	ZERO? NUM \?L45
	GETB P-SYNTAX,P-SBITS >STACK
	BAND STACK,P-SONUMS >STACK
	ZERO? STACK \?L46
	CALL PERFORM-PRSA >V
	SET 'PRSO,0
	JUMP ?L59
?L46:	PRINTI "There isn't anything to "
	GET P-ITBL,P-VERBN >TMP
	EQUAL? PRSA,V?TELL \?L49
	PRINTI "talk to"
	JUMP ?L53
?L49:	ZERO? P-OFLAG \?L52
	ZERO? P-MERGED /?L51
?L52:	GET TMP,0 >STACK
	PRINTB STACK
	JUMP ?L53
?L51:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
?L53:	PRINTI "!"
	CRLF
	SET 'V,0
	CALL STOP
	JUMP ?L59
?L45:	SET 'P-NOT-HERE,0
	SET 'P-MULT,0
	GRTR? NUM,1 \?L55
	SET 'P-MULT,1
?L55:	SET 'TMP,0
?L58:	IGRTR? 'CNT,NUM \?L60
	GRTR? P-NOT-HERE,0 \?L62
	PRINTI "[The "
	EQUAL? P-NOT-HERE,NUM /?L64
	PRINTI "other "
?L64:	PRINTI "object"
	EQUAL? P-NOT-HERE,1 /?L67
	PRINTI "s"
?L67:	PRINTI " that you mentioned "
	EQUAL? P-NOT-HERE,1 /?L70
	PRINTI "are"
	JUMP ?L72
?L70:	PRINTI "is"
?L72:	PRINTI "n't here.]"
	CRLF
	JUMP ?L59
?L62:	ZERO? TMP \?L59
	CALL REFERRING
	JUMP ?L59
?L60:	ZERO? PTBL /?L76
	GETB P-PRSO,CNT >OBJ1
	JUMP ?L78
?L76:	GETB P-PRSI,CNT >OBJ1
?L78:	ZERO? PTBL /?L79
	SET 'PRSO,OBJ1
	JUMP ?L81
?L79:	SET 'PRSO,OBJ
?L81:	ZERO? PTBL /?L82
	SET 'PRSI,OBJ
	JUMP ?L84
?L82:	SET 'PRSI,OBJ1
?L84:	GRTR? NUM,1 /?L87
	GET P-ITBL,P-NC1 >STACK
	GET STACK,0 >STACK
	EQUAL? STACK,W?ALL,W?EVERYT \?L90
?L87:	CALL DONT-ALL,OBJ1 >STACK
	ZERO? STACK \?L58
	EQUAL? OBJ1,IT \?L91
	PRINTD P-IT-OBJECT
	JUMP ?L95
?L91:	EQUAL? OBJ1,HIM \?L93
	PRINTD P-HIM-OBJECT
	JUMP ?L95
?L93:	EQUAL? OBJ1,HER \?L94
	PRINTD P-HER-OBJECT
	JUMP ?L95
?L94:	PRINTD OBJ1
?L95:	PRINTI ": "
?L90:	SET 'TMP,1
	CALL PERFORM-PRSA,PRSO,PRSI >V
	EQUAL? V,M-FATAL \?L58
?L59:	EQUAL? V,M-FATAL \?L100
	SET 'P-CONT,0
?L100:	CALL CLOCKER-VERB? >STACK
	ZERO? STACK /?L106
	EQUAL? PRSA,V?TELL /?L106
	ZERO? P-WON /FALSE
	GETP HERE,P?ACTION >STACK
	CALL STACK,M-END >V
	JUMP ?L106
?L1:	SET 'P-CONT,0
?L106:	ZERO? P-WON /FALSE
	CALL CLOCKER-VERB? >STACK
	ZERO? STACK /?L109
	CALL CLOCKER >V
?L109:	SET 'PRSA,0
	SET 'PRSO,0
	SET 'PRSI,0
	RETURN PRSI

	.FUNCT TOO-DARK-FOR-IT?
	ZERO? LIT \FALSE
	CALL HELD?,P-IT-OBJECT,WINNER >STACK
	ZERO? STACK \FALSE
	IN? WINNER,P-IT-OBJECT /FALSE
	PRINT TOO-DARK
	CRLF
	RTRUE

	.FUNCT DONT-ALL,OBJ1,L
	LOC OBJ1 >L
	EQUAL? OBJ1,NOT-HERE-OBJECT \?L1
	INC 'P-NOT-HERE
	RTRUE
?L1:	EQUAL? PRSA,V?TAKE \?L3
	ZERO? PRSI /?L3
	IN? PRSO,PRSI \TRUE
?L3:	CALL ACCESSIBLE?,OBJ1 >STACK
	ZERO? STACK /TRUE
	EQUAL? P-GETFLAGS,P-ALL \FALSE
	ZERO? PRSI /?L6
	EQUAL? PRSO,PRSI /TRUE
?L6:	EQUAL? PRSA,V?TAKE \?L8
	FSET? OBJ1,TAKEBIT /?L9
	FSET? OBJ1,TRYTAKEBIT \TRUE
?L9:	EQUAL? L,WINNER,HERE,PRSI /?L11
	LOC WINNER >STACK
	EQUAL? L,STACK /?L11
	FSET? L,SURFACEBIT \TRUE
	FSET? L,TAKEBIT /TRUE
	RFALSE
?L11:	EQUAL? OBJ1,BOOKS-GLOBAL,POWER /TRUE
	ZERO? PRSI \FALSE
	CALL HELD?,PRSO >STACK
	ZERO? STACK /FALSE
	RTRUE
?L8:	EQUAL? PRSA,V?PUT-ON,V?PUT,V?DROP /?L19
	EQUAL? PRSA,V?SGIVE,V?GIVE \?L18
?L19:	IN? OBJ1,WINNER \TRUE
?L18:	EQUAL? PRSA,V?PUT-ON,V?PUT \FALSE
	IN? PRSO,WINNER /FALSE
	CALL HELD?,PRSO,PRSI >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT CLOCKER-VERB?
	EQUAL? PRSA,V?$0024RECORD,V?HELP,V?VERSION /FALSE
	EQUAL? PRSA,V?$0024RANDOM,V?$0024COMMAND,V?$0024UNRECORD /FALSE
	EQUAL? PRSA,V?RESTART,V?RESTORE,V?SAVE /FALSE
	EQUAL? PRSA,V?UNSCRIPT,V?SCRIPT,V?QUIT /FALSE
	EQUAL? PRSA,V?VERBOSE,V?SUPER-BRIEF,V?BRIEF /FALSE
	EQUAL? PRSA,V?SCORE \TRUE
	RFALSE

	.FUNCT FAKE-ORPHAN,IT-WAS-USED=0,TMP
	CALL ORPHAN,P-SYNTAX,0
	GET P-OTBL,P-VERBN >TMP
	PRINTI "[Be specific: Wh"
	ZERO? IT-WAS-USED /?L1
	PRINTI "at object"
	JUMP ?L3
?L1:	PRINTI "o"
?L3:	PRINT DO-YOU-WANT
	ZERO? TMP \?L4
	PRINTI "tell"
	JUMP ?L7
?L4:	GETB P-VTBL,2 >STACK
	ZERO? STACK \?L6
	GET TMP,0 >STACK
	PRINTB STACK
	JUMP ?L7
?L6:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
	PUTB P-VTBL,2,0
?L7:	SET 'P-OFLAG,1
	SET 'P-WON,0
	GETB P-SYNTAX,P-SPREP1 >STACK
	CALL PREP-PRINT,STACK
	PRINTR "?]"

	.FUNCT PERFORM-PRSA,O=0,I=0
	CALL PERFORM,PRSA,O,I
	RTRUE

	.FUNCT PERFORM,A,O=0,I=0,V,OA,OO,OI
	SET 'OA,PRSA
	SET 'OO,PRSO
	SET 'OI,PRSI
	SET 'PRSA,A
	EQUAL? IT,O,I \?L8
	EQUAL? A,V?WALK /?L8
	CALL VISIBLE?,P-IT-OBJECT >STACK
	ZERO? STACK /?L3
	EQUAL? IT,O \?L5
	SET 'O,P-IT-OBJECT
	JUMP ?L8
?L5:	SET 'I,P-IT-OBJECT
	JUMP ?L8
?L3:	ZERO? I \?L9
	CALL FAKE-ORPHAN,1
	RETURN 8
?L9:	CALL REFERRING
	RETURN 8
?L8:	EQUAL? HIM,O,I \?L22
	EQUAL? A,V?WALK /?L22
	CALL VISIBLE?,P-HIM-OBJECT >STACK
	ZERO? STACK /?L17
	EQUAL? HIM,O \?L19
	SET 'O,P-HIM-OBJECT
	JUMP ?L22
?L19:	SET 'I,P-HIM-OBJECT
	JUMP ?L22
?L17:	ZERO? I \?L23
	CALL FAKE-ORPHAN
	RETURN 8
?L23:	CALL REFERRING,1
	RETURN 8
?L22:	EQUAL? HER,O,I \?L36
	EQUAL? A,V?WALK /?L36
	CALL VISIBLE?,P-HER-OBJECT >STACK
	ZERO? STACK /?L31
	EQUAL? HER,O \?L33
	SET 'O,P-HER-OBJECT
	JUMP ?L36
?L33:	SET 'I,P-HER-OBJECT
	JUMP ?L36
?L31:	ZERO? I \?L37
	CALL FAKE-ORPHAN
	RETURN 8
?L37:	CALL REFERRING,1
	RETURN 8
?L36:	SET 'PRSO,O
	SET 'PRSI,I
	EQUAL? A,V?WALK /?L43
	EQUAL? NOT-HERE-OBJECT,PRSO,PRSI \?L43
	CALL D-APPLY,STR?97,NOT-HERE-OBJECT-F >V
	ZERO? V /?L43
	SET 'P-WON,0
	JUMP ?L52
?L43:	SET 'O,PRSO
	SET 'I,PRSI
	CALL THIS-IS-IT,PRSI
	CALL THIS-IS-IT,PRSO
	GETP WINNER,P?ACTION >STACK
	CALL D-APPLY,STR?98,STACK >V
	ZERO? V \?L52
	LOC WINNER >STACK
	GETP STACK,P?ACTION >STACK
	CALL D-APPLY,STR?99,STACK,M-BEG >V
	ZERO? V \?L52
	GET PREACTIONS,A >STACK
	CALL D-APPLY,STR?100,STACK >V
	ZERO? V \?L52
	ZERO? I /?L50
	GETP I,P?ACTION >STACK
	CALL D-APPLY,STR?101,STACK >V
	ZERO? V \?L52
?L50:	ZERO? O /?L51
	EQUAL? A,V?WALK /?L51
	GETP O,P?ACTION >STACK
	CALL D-APPLY,STR?102,STACK >V
	ZERO? V \?L52
?L51:	GET ACTIONS,A >STACK
	CALL D-APPLY,0,STACK >V
	ZERO? V /?L52
?L52:	SET 'PRSA,OA
	SET 'PRSO,OO
	SET 'PRSI,OI
	RETURN V

	.FUNCT D-APPLY,STR,FCN,FOO=0,RES
	ZERO? FCN /FALSE
	ZERO? FOO /?L4
	CALL FCN,FOO >RES
	RETURN RES
?L4:	CALL FCN >RES
	RETURN RES

	.FUNCT DEQUEUE,RTN
	CALL QUEUED?,RTN >RTN
	ZERO? RTN /FALSE
	PUT RTN,C-RTN,0
	RTRUE

	.FUNCT QUEUED?,RTN,C,E
	ADD C-TABLE,C-TABLELEN >E
	ADD C-TABLE,C-INTS >C
?L1:	EQUAL? C,E /FALSE
	GET C,C-RTN >STACK
	EQUAL? STACK,RTN \?L8
	GET C,C-TICK >STACK
	ZERO? STACK /FALSE
	RETURN C
?L8:	ADD C,C-INTLEN >C
	JUMP ?L1

	.FUNCT RUNNING?,RTN,C
	CALL QUEUED?,RTN >C
	ZERO? C /FALSE
	GET C,C-TICK >STACK
	GRTR? STACK,1 \TRUE
	RFALSE

	.FUNCT QUEUE,RTN,TICK,C,E,INT=0
	ADD C-TABLE,C-TABLELEN >E
	ADD C-TABLE,C-INTS >C
?L1:	EQUAL? C,E \?L3
	ZERO? INT /?L5
	SET 'C,INT
	JUMP ?L7
?L5:	LESS? C-INTS,C-INTLEN \?L8
	PRINTI "**Too many ints!**"
	CRLF
?L8:	SUB C-INTS,C-INTLEN >C-INTS
	LESS? C-INTS,C-MAXINTS \?L11
	SET 'C-MAXINTS,C-INTS
?L11:	ADD C-TABLE,C-INTS >INT
?L7:	PUT INT,C-RTN,RTN
	JUMP ?L2
?L3:	GET C,C-RTN >STACK
	EQUAL? STACK,RTN \?L14
	SET 'INT,C
	JUMP ?L2
?L14:	GET C,C-RTN >STACK
	ZERO? STACK \?L15
	SET 'INT,C
?L15:	ADD C,C-INTLEN >C
	JUMP ?L1
?L2:	ZERO? CLOCK-HAND /?L17
	GRTR? INT,CLOCK-HAND \?L17
	ADD TICK,3 >STACK
	SUB 0,STACK >TICK
?L17:	PUT INT,C-TICK,TICK
	RETURN INT

	.FUNCT CLOCKER,E,TICK,RTN,FLG=0,Q?=0,OWINNER
	ZERO? CLOCK-WAIT /?L1
	SET 'CLOCK-WAIT,0
	RFALSE
?L1:	ADD C-TABLE,C-INTS >CLOCK-HAND
	ADD C-TABLE,C-TABLELEN >E
	SET 'OWINNER,WINNER
	SET 'WINNER,PROTAGONIST
?L4:	EQUAL? CLOCK-HAND,E \?L6
	SET 'CLOCK-HAND,E
	INC 'MOVES
	SET 'WINNER,OWINNER
	RETURN FLG
?L6:	GET CLOCK-HAND,C-RTN >STACK
	ZERO? STACK /?L26
	GET CLOCK-HAND,C-TICK >TICK
	LESS? TICK,-1 \?L9
	SUB 0,TICK >STACK
	SUB STACK,3 >STACK
	PUT CLOCK-HAND,C-TICK,STACK
	SET 'Q?,CLOCK-HAND
	JUMP ?L26
?L9:	ZERO? TICK /?L26
	GRTR? TICK,0 \?L12
	DEC 'TICK
	PUT CLOCK-HAND,C-TICK,TICK
?L12:	ZERO? TICK /?L15
	SET 'Q?,CLOCK-HAND
?L15:	GRTR? TICK,0 /?L26
	GET CLOCK-HAND,C-RTN >RTN
	ZERO? TICK \?L20
	PUT CLOCK-HAND,C-RTN,0
?L20:	CALL RTN >STACK
	ZERO? STACK /?L23
	SET 'FLG,1
?L23:	ZERO? Q? \?L26
	GET CLOCK-HAND,C-RTN >STACK
	ZERO? STACK /?L26
	SET 'Q?,1
?L26:	ADD CLOCK-HAND,C-INTLEN >CLOCK-HAND
	ZERO? Q? \?L4
	ADD C-INTS,C-INTLEN >C-INTS
	JUMP ?L4

	.FUNCT THIS-IS-IT,OBJ
	ZERO? OBJ /TRUE
	EQUAL? PRSA,V?WALK \?L4
	EQUAL? PRSO,OBJ /TRUE
?L4:	EQUAL? OBJ,PROTAGONIST,NOT-HERE-OBJECT,ME /TRUE
	EQUAL? OBJ,GLOBAL-ROOM /TRUE
	FSET? OBJ,FEMALEBIT \?L5
	SET 'P-HER-OBJECT,OBJ
	RETURN P-HER-OBJECT
?L5:	FSET? OBJ,ACTORBIT \?L6
	SET 'P-HIM-OBJECT,OBJ
	RETURN P-HIM-OBJECT
?L6:	SET 'P-IT-OBJECT,OBJ
	RETURN P-IT-OBJECT

	.FUNCT OOPS-WARNING,STR
	PRINTI "[Warning: there are too many "
	PRINT STR
	PRINTR " after OOPS.]"

	.FUNCT PARSER,PTR=P-LEXSTART,WRD,VAL=0,VERB=0,OMERGED,OWINNER,OLEN,LEN,DIR=0,NW=0,LW=0,CNT=-1
?L1:	IGRTR? 'CNT,P-ITBLLEN /?L2
	ZERO? P-OFLAG \?L6
	GET P-ITBL,CNT >STACK
	PUT P-OTBL,CNT,STACK
?L6:	PUT P-ITBL,CNT,0
	JUMP ?L1
?L2:	SET 'OMERGED,P-MERGED
	SET 'OWINNER,WINNER
	SET 'P-ADVERB,0
	SET 'P-MERGED,0
	SET 'P-END-ON-PREP,0
	PUTB P-PRSO,P-MATCHLEN,0
	PUTB P-PRSI,P-MATCHLEN,0
	PUTB P-BUTS,P-MATCHLEN,0
	ZERO? QUOTE-FLAG \?L9
	EQUAL? WINNER,PROTAGONIST /?L9
	SET 'WINNER,PROTAGONIST
	LOC WINNER >STACK
	FSET? STACK,VEHBIT /?L11
	LOC WINNER >HERE
?L11:	CALL LIT?,HERE >LIT
?L9:	ZERO? RESERVE-PTR /?L15
	SET 'PTR,RESERVE-PTR
	CALL STUFF,P-LEXV,RESERVE-LEXV
	CALL INBUF-STUFF,P-INBUF,RESERVE-INBUF
	ZERO? VERBOSITY /?L17
	EQUAL? PROTAGONIST,WINNER \?L17
	CRLF
?L17:	SET 'RESERVE-PTR,0
	SET 'P-CONT,0
	JUMP ?L24
?L15:	ZERO? P-CONT /?L20
	SET 'PTR,P-CONT
	ZERO? VERBOSITY /?L21
	EQUAL? PROTAGONIST,WINNER \?L21
	CRLF
?L21:	SET 'P-CONT,0
	JUMP ?L24
?L20:	SET 'WINNER,PROTAGONIST
	SET 'QUOTE-FLAG,0
	LOC WINNER >STACK
	FSET? STACK,VEHBIT /?L25
	LOC WINNER >HERE
?L25:	CALL LIT?,HERE >LIT
	ZERO? VERBOSITY /?L28
	CRLF
?L28:	PRINTI ">"
	READ P-INBUF,P-LEXV
	GETB P-LEXV,P-LEXWORDS >OLEN
?L24:	GETB P-LEXV,P-LEXWORDS >P-LEN
	ZERO? P-LEN \?L31
	PRINTI "[Prithee, pardon?]"
	CRLF
	RFALSE
?L31:	GET P-LEXV,PTR >STACK
	EQUAL? STACK,W?OOPS \?L33
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?$PERIOD,W?$COMMA \?L34
	ADD PTR,P-LEXELEN >PTR
	DEC 'P-LEN
?L34:	GRTR? P-LEN,1 /?L37
	CALL CANT-USE-THAT-WAY,STR?103
	RFALSE
?L37:	GET OOPS-TABLE,O-PTR >VAL
	ZERO? VAL /?L39
	GETB AGAIN-LEXV,0 >STACK
	MUL 2,STACK >LEN
	SUB P-LEN,2 >CNT
	MUL P-LEXELEN,CNT >STACK
	ADD VAL,STACK >STACK
	LESS? LEN,STACK \?L40
	SUB LEN,VAL >STACK
	DIV STACK,P-LEXELEN >CNT
	CALL OOPS-WARNING,STR?104
?L40:	ZERO? CNT /?L46
	GETB AGAIN-LEXV,P-LEXWORDS >LEN
	ADD LEN,CNT >STACK
	PUTB AGAIN-LEXV,P-LEXWORDS,STACK
	MUL P-LEXELEN,CNT >CNT
	MUL P-LEXELEN,LEN >LEN
?L45:	GET AGAIN-LEXV,LEN >STACK
	ADD CNT,LEN >STACK
	PUT AGAIN-LEXV,STACK,STACK
	DLESS? 'LEN,VAL \?L45
?L46:	SET 'CNT,P-LEN
?L51:	DLESS? 'CNT,1 /?L52
	ADD PTR,P-LEXELEN >PTR
	GET P-LEXV,PTR >STACK
	PUT AGAIN-LEXV,VAL,STACK
	MUL PTR,P-LEXELEN >STACK
	ADD STACK,2 >WRD
	MUL VAL,P-LEXELEN >STACK
	ADD STACK,3 >STACK
	ADD WRD,1 >STACK
	GETB P-LEXV,STACK >STACK
	GETB P-LEXV,WRD >STACK
	CALL INBUF-ADD,STACK,STACK,STACK >STACK
	ZERO? STACK \?L56
	CALL OOPS-WARNING,STR?105
	JUMP ?L52
?L56:	ADD VAL,P-LEXELEN >VAL
	JUMP ?L51
?L52:	SET 'WINNER,OWINNER
	CALL STUFF,P-LEXV,AGAIN-LEXV
	GETB P-LEXV,P-LEXWORDS >P-LEN
	GET OOPS-TABLE,O-START >PTR
	CALL INBUF-STUFF,P-INBUF,OOPS-INBUF
	JUMP ?L60
?L39:	PUT OOPS-TABLE,O-END,0
	PRINTI "[There was no word to replace!]"
	CRLF
	RFALSE
?L33:	PUT OOPS-TABLE,O-END,0
?L60:	GET P-LEXV,PTR >STACK
	EQUAL? STACK,W?AGAIN,W?G \?L61
	ZERO? P-OFLAG /?L63
	CALL CANT-USE-THAT-WAY,STR?106
	RFALSE
?L63:	ZERO? P-WON \?L65
	PRINTI "[That would just repeat a mistake!]"
	CRLF
	RFALSE
?L65:	EQUAL? OWINNER,PROTAGONIST /?L66
	CALL VISIBLE?,OWINNER >STACK
	ZERO? STACK \?L66
	PRINTI "["
	PRINT YOU-CANT
	PRINTI "see "
	PRINTD OWINNER
	PRINTI " any more.]"
	CRLF
	RFALSE
?L66:	GRTR? P-LEN,1 \?L67
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?$PERIOD,W?$COMMA,W?THEN /?L70
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?AND \?L68
?L70:	ADD PTR,4 >PTR
	GETB P-LEXV,P-LEXWORDS >STACK
	SUB STACK,2 >STACK
	PUTB P-LEXV,P-LEXWORDS,STACK
	JUMP ?L72
?L68:	CALL RECOGNIZE
	RFALSE
?L67:	ADD PTR,P-LEXELEN >PTR
	GETB P-LEXV,P-LEXWORDS >STACK
	DEC 'STACK
	PUTB P-LEXV,P-LEXWORDS,STACK
?L72:	GETB P-LEXV,P-LEXWORDS >STACK
	GRTR? STACK,0 \?L73
	CALL STUFF,RESERVE-LEXV,P-LEXV
	CALL INBUF-STUFF,RESERVE-INBUF,P-INBUF
	SET 'RESERVE-PTR,PTR
	JUMP ?L75
?L73:	SET 'RESERVE-PTR,0
?L75:	SET 'WINNER,OWINNER
	SET 'P-MERGED,OMERGED
	CALL INBUF-STUFF,P-INBUF,OOPS-INBUF
	CALL STUFF,P-LEXV,AGAIN-LEXV
	SET 'CNT,-1
	SET 'DIR,AGAIN-DIR
?L76:	IGRTR? 'CNT,P-ITBLLEN /?L83
	GET P-OTBL,CNT >STACK
	PUT P-ITBL,CNT,STACK
	JUMP ?L76
?L61:	CALL STUFF,AGAIN-LEXV,P-LEXV
	CALL INBUF-STUFF,OOPS-INBUF,P-INBUF
	PUT OOPS-TABLE,O-START,PTR
	MUL 4,P-LEN >STACK
	PUT OOPS-TABLE,O-LENGTH,STACK
	GETB P-LEXV,P-LEXWORDS >STACK
	MUL P-LEXELEN,STACK >STACK
	ADD PTR,STACK >STACK
	MUL 2,STACK >LEN
	SUB LEN,2 >STACK
	GETB P-LEXV,STACK >STACK
	SUB LEN,1 >STACK
	GETB P-LEXV,STACK >STACK
	ADD STACK,STACK >STACK
	PUT OOPS-TABLE,O-END,STACK
	SET 'RESERVE-PTR,0
	SET 'LEN,P-LEN
	SET 'P-NCN,0
	SET 'P-GETFLAGS,0
?L82:	DLESS? 'P-LEN,0 \?L84
	SET 'QUOTE-FLAG,0
	JUMP ?L83
?L84:	GET P-LEXV,PTR >WRD
	ZERO? WRD \?L87
	CALL NUMBER?,PTR >WRD
	ZERO? WRD /?L86
?L87:	CALL NEXT-WORD,PTR >NW
	EQUAL? WRD,W?TO \?L88
	EQUAL? VERB,ACT?TELL,ACT?ASK \?L88
	CALL WT?,NW,PS?VERB,P1?VERB >STACK
	ZERO? STACK /?L88
	PUT P-ITBL,P-VERB,ACT?TELL
	SET 'WRD,W?$QUOTE
	JUMP ?L91
?L88:	EQUAL? WRD,W?THEN \?L90
	GRTR? P-LEN,0 \?L90
	ZERO? VERB \?L90
	ZERO? QUOTE-FLAG \?L90
	PUT P-ITBL,P-VERB,ACT?TELL
	PUT P-ITBL,P-VERBN,0
	SET 'WRD,W?$QUOTE
	JUMP ?L91
?L90:	EQUAL? WRD,W?$PERIOD \?L91
	EQUAL? LW,W?ST \?L91
	DEC 'P-NCN
	CALL CHANGE-LEXV,PTR,LW,1
	SET 'WRD,LW
	SET 'LW,0
?L91:	EQUAL? WRD,W?THEN,W?$PERIOD /?L95
	EQUAL? WRD,W?$QUOTE \?L93
?L95:	EQUAL? WRD,W?$QUOTE \?L100
	ZERO? QUOTE-FLAG /?L98
	SET 'QUOTE-FLAG,0
	JUMP ?L100
?L98:	SET 'QUOTE-FLAG,1
?L100:	ZERO? P-LEN /?L102
	ADD PTR,P-LEXELEN >P-CONT
?L102:	PUTB P-LEXV,P-LEXWORDS,P-LEN
	JUMP ?L83
?L93:	CALL WT?,WRD,PS?DIRECTION,P1?DIRECTION >VAL
	ZERO? VAL /?L104
	EQUAL? VERB,0,ACT?WALK,ACT?GO \?L104
	EQUAL? LEN,1 /?L105
	EQUAL? LEN,2 \?L106
	EQUAL? VERB,ACT?WALK,ACT?GO /?L105
?L106:	EQUAL? NW,W?THEN,W?$PERIOD,W?$QUOTE \?L107
	LESS? LEN,2 \?L105
?L107:	ZERO? QUOTE-FLAG /?L108
	EQUAL? LEN,2 \?L108
	EQUAL? NW,W?$QUOTE /?L105
?L108:	GRTR? LEN,2 \?L104
	EQUAL? NW,W?$COMMA,W?AND \?L104
?L105:	SET 'DIR,VAL
	EQUAL? NW,W?$COMMA,W?AND \?L109
	ADD PTR,P-LEXELEN >STACK
	CALL CHANGE-LEXV,STACK,W?THEN
?L109:	GRTR? LEN,2 /?L135
	SET 'QUOTE-FLAG,0
	JUMP ?L83
?L104:	CALL WT?,WRD,PS?VERB,P1?VERB >VAL
	ZERO? VAL /?L115
	ZERO? VERB \?L115
	SET 'P-PRSA-WORD,WRD
	SET 'VERB,VAL
	PUT P-ITBL,P-VERB,VAL
	PUT P-ITBL,P-VERBN,P-VTBL
	PUT P-VTBL,0,WRD
	MUL PTR,2 >STACK
	ADD STACK,2 >CNT
	GETB P-LEXV,CNT >STACK
	PUTB P-VTBL,2,STACK
	ADD CNT,1 >STACK
	GETB P-LEXV,STACK >STACK
	PUTB P-VTBL,3,STACK
	JUMP ?L135
?L115:	CALL WT?,WRD,PS?PREPOSITION,0 >VAL
	ZERO? VAL \?L117
	EQUAL? WRD,W?ALL,W?ONE,W?BOTH /?L117
	EQUAL? WRD,W?EVERYT /?L117
	CALL WT?,WRD,PS?ADJECTIVE >STACK
	ZERO? STACK \?L117
	CALL WT?,WRD,PS?OBJECT >STACK
	ZERO? STACK /?L116
?L117:	GRTR? P-LEN,0 \?L118
	EQUAL? NW,W?OF \?L118
	ZERO? VAL \?L145
	EQUAL? WRD,W?ALL,W?ONE,W?A /?L118
	EQUAL? WRD,W?BOTH,W?EVERYT \?L135
?L118:	ZERO? VAL /?L120
?L145:	ZERO? P-LEN /?L121
	EQUAL? NW,W?THEN,W?$PERIOD \?L120
?L121:	SET 'P-END-ON-PREP,1
	LESS? P-NCN,2 \?L135
	PUT P-ITBL,P-PREP1,VAL
	PUT P-ITBL,P-PREP1N,WRD
	JUMP ?L135
?L120:	EQUAL? P-NCN,2 \?L125
	PRINTI "[There were too many nouns in that sentence.]"
	CRLF
	RFALSE
?L125:	INC 'P-NCN
	CALL CLAUSE,PTR,VAL,WRD >PTR
	ZERO? PTR /FALSE
	LESS? PTR,0 \?L135
	SET 'QUOTE-FLAG,0
	JUMP ?L83
?L116:	CALL WT?,WRD,PS?BUZZ-WORD >STACK
	ZERO? STACK \?L135
	EQUAL? VERB,ACT?TELL \?L133
	CALL WT?,WRD,PS?VERB,P1?VERB >STACK
	ZERO? STACK /?L133
	EQUAL? WINNER,PROTAGONIST \?L133
	CALL SEE-MANUAL,STR?107
	RFALSE
?L133:	CALL CANT-USE,PTR
	RFALSE
?L86:	CALL UNKNOWN-WORD,PTR
	RFALSE
?L135:	SET 'LW,WRD
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L82
?L83:	PUT OOPS-TABLE,O-PTR,0
	ZERO? DIR /?L136
	SET 'PRSA,V?WALK
	SET 'P-PRSA-WORD,0
	SET 'PRSO,DIR
	SET 'P-OFLAG,0
	SET 'P-WALK-DIR,DIR
	SET 'AGAIN-DIR,DIR
	RTRUE
?L136:	SET 'P-WALK-DIR,0
	SET 'AGAIN-DIR,0
	ZERO? P-OFLAG /?L139
	CALL ORPHAN-MERGE
?L139:	CALL SYNTAX-CHECK >STACK
	ZERO? STACK /FALSE
	CALL SNARF-OBJECTS >STACK
	ZERO? STACK /FALSE
	CALL MANY-CHECK >STACK
	ZERO? STACK /FALSE
	CALL TAKE-CHECK >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT CHANGE-LEXV,PTR,WRD,PTRS?=0,X,Y,Z
	ZERO? PTRS? /?L1
	SUB PTR,P-LEXELEN >STACK
	MUL 2,STACK >STACK
	ADD 2,STACK >X
	GETB P-LEXV,X >Y
	MUL 2,PTR >STACK
	ADD 2,STACK >Z
	PUTB P-LEXV,Z,Y
	PUTB AGAIN-LEXV,Z,Y
	ADD 1,X >STACK
	GETB P-LEXV,STACK >Y
	MUL 2,PTR >STACK
	ADD 3,STACK >Z
	PUTB P-LEXV,Z,Y
	PUTB AGAIN-LEXV,Z,Y
?L1:	PUT P-LEXV,PTR,WRD
	PUT AGAIN-LEXV,PTR,WRD
	RTRUE

	.FUNCT STUFF,DEST,SRC,MAX=29,PTR=P-LEXSTART,CTR=1,BPTR
	GETB SRC,0 >STACK
	PUTB DEST,0,STACK
	GETB SRC,1 >STACK
	PUTB DEST,1,STACK
?L1:	GET SRC,PTR >STACK
	PUT DEST,PTR,STACK
	MUL PTR,2 >STACK
	ADD STACK,2 >BPTR
	GETB SRC,BPTR >STACK
	PUTB DEST,BPTR,STACK
	MUL PTR,2 >STACK
	ADD STACK,3 >BPTR
	GETB SRC,BPTR >STACK
	PUTB DEST,BPTR,STACK
	ADD PTR,P-LEXELEN >PTR
	IGRTR? 'CTR,MAX \?L1
	RTRUE

	.FUNCT INBUF-STUFF,DEST,SRC,CNT=-1
?L1:	IGRTR? 'CNT,P-INBUF-LENGTH /TRUE
	GETB SRC,CNT >STACK
	PUTB DEST,CNT,STACK
	JUMP ?L1

	.FUNCT INBUF-ADD,LEN,BEG,SLOT,DBEG,CTR=0,TMP,?TMP
	GET OOPS-TABLE,O-END >TMP
	ZERO? TMP /?L1
	SET 'DBEG,TMP
	JUMP ?L3
?L1:	GET OOPS-TABLE,O-LENGTH >TMP
	GETB AGAIN-LEXV,TMP >?TMP
	ADD TMP,1 >STACK
	GETB AGAIN-LEXV,STACK >STACK
	ADD ?TMP,STACK >DBEG
?L3:	ADD DBEG,LEN >STACK
	PUT OOPS-TABLE,O-END,STACK
?L4:	ADD BEG,CTR >STACK
	GETB P-INBUF,STACK >STACK
	ADD DBEG,CTR >STACK
	PUTB OOPS-INBUF,STACK,STACK
	INC 'CTR
	EQUAL? CTR,LEN \?L4
	PUTB AGAIN-LEXV,SLOT,DBEG
	SUB SLOT,1 >STACK
	PUTB AGAIN-LEXV,STACK,LEN
	RTRUE

	.FUNCT WT?,PTR,BIT,B1=5,OFFS=P-P1OFF,TYP
	GETB PTR,P-PSOFF >TYP
	BTST TYP,BIT \FALSE
	GRTR? B1,4 /TRUE
	EQUAL? BIT,PS?OBJECT /TRUE
	BAND TYP,P-P1BITS >TYP
	EQUAL? TYP,B1 /?L7
	INC 'OFFS
?L7:	GETB PTR,OFFS >STACK
	RSTACK

	.FUNCT NEXT-WORD,PTR,NW
	ZERO? P-LEN /FALSE
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >NW
	ZERO? NW /?L3
	RETURN NW
?L3:	ADD PTR,P-LEXELEN >STACK
	CALL NUMBER?,STACK >STACK
	RSTACK

	.FUNCT CLAUSE,PTR,VAL,WRD,OFF,NUM,ANDFLG=0,FIRST??=1,NW,LW=0
	SUB P-NCN,1 >STACK
	MUL STACK,2 >OFF
	ZERO? VAL /?L1
	ADD P-PREP1,OFF >NUM
	PUT P-ITBL,NUM,VAL
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,WRD
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L3
?L1:	INC 'P-LEN
?L3:	ZERO? P-LEN \?L4
	DEC 'P-NCN
	RETURN -1
?L4:	ADD P-NC1,OFF >NUM
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	PUT P-ITBL,NUM,STACK
?L7:	DLESS? 'P-LEN,0 \?L9
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,STACK
	RETURN -1
?L9:	GET P-LEXV,PTR >WRD
	ZERO? WRD \?L14
	CALL NUMBER?,PTR >WRD
	ZERO? WRD /?L12
?L14:	CALL NEXT-WORD,PTR >NW
	ZERO? FIRST?? /?L15
	EQUAL? WRD,W?THE,W?A,W?AN /?L17
	ZERO? VAL /?L15
	CALL WT?,WRD,PS?PREPOSITION >STACK
	ZERO? STACK /?L15
	CALL WT?,WRD,PS?ADJECTIVE >STACK
	ZERO? STACK \?L15
?L17:	GET P-ITBL,NUM >STACK
	ADD STACK,4 >STACK
	PUT P-ITBL,NUM,STACK
	JUMP ?L39
?L15:	EQUAL? WRD,W?$PERIOD \?L18
	EQUAL? LW,W?ST \?L18
	SET 'LW,0
	JUMP ?L39
?L18:	EQUAL? WRD,W?AND,W?$COMMA \?L19
	SET 'ANDFLG,1
	JUMP ?L39
?L19:	EQUAL? WRD,W?ALL,W?ONE,W?BOTH /?L21
	EQUAL? WRD,W?EVERYT \?L20
?L21:	EQUAL? NW,W?OF \?L39
	DEC 'P-LEN
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L39
?L20:	EQUAL? WRD,W?THEN,W?$PERIOD /?L26
	CALL WT?,WRD,PS?PREPOSITION >STACK
	ZERO? STACK /?L25
	GET P-ITBL,P-VERB >STACK
	ZERO? STACK /?L25
	ZERO? FIRST?? \?L25
?L26:	INC 'P-LEN
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,STACK
	SUB PTR,P-LEXELEN >STACK
	RSTACK
?L25:	ZERO? ANDFLG /?L27
	GET P-ITBL,P-VERB >STACK
	ZERO? STACK \?L27
	SUB PTR,4 >PTR
	ADD PTR,2 >STACK
	CALL CHANGE-LEXV,STACK,W?THEN
	ADD P-LEN,2 >P-LEN
	JUMP ?L39
?L27:	CALL WT?,WRD,PS?OBJECT >STACK
	ZERO? STACK /?L28
	GRTR? P-LEN,0 \?L29
	EQUAL? NW,W?OF \?L29
	EQUAL? WRD,W?ALL,W?EVERYT,W?ONE \?L39
?L29:	CALL WT?,WRD,PS?ADJECTIVE >STACK
	ZERO? STACK /?L31
	ZERO? NW /?L31
	CALL WT?,NW,PS?OBJECT >STACK
	ZERO? STACK \?L39
	CALL WT?,NW,PS?ADJECTIVE >STACK
	ZERO? STACK \?L39
?L31:	ZERO? ANDFLG \?L33
	EQUAL? NW,W?BUT,W?EXCEPT,W?AND /?L33
	EQUAL? NW,W?$COMMA /?L33
	ADD PTR,2 >STACK
	MUL STACK,2 >STACK
	ADD P-LEXV,STACK >STACK
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,STACK
	RETURN PTR
?L33:	SET 'ANDFLG,0
	JUMP ?L39
?L28:	CALL WT?,WRD,PS?ADJECTIVE >STACK
	ZERO? STACK \?L39
	CALL WT?,WRD,PS?BUZZ-WORD >STACK
	ZERO? STACK \?L39
	CALL WT?,WRD,PS?PREPOSITION >STACK
	ZERO? STACK \?L39
	CALL CANT-USE,PTR
	RFALSE
?L12:	CALL UNKNOWN-WORD,PTR
	RFALSE
?L39:	SET 'LW,WRD
	SET 'FIRST??,0
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L7

	.FUNCT NUMBER?,PTR,CNT,BPTR,CHR,SUM=0,CCTR,TMP,XPTR
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	GETB STACK,2 >CNT
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	GETB STACK,3 >BPTR
?L1:	GRTR? SUM,10000 /FALSE
	DLESS? 'CNT,0 /?L2
	GETB P-INBUF,BPTR >CHR
	LESS? CHR,58 \?L7
	GRTR? CHR,47 \?L7
	SUB CHR,48 >STACK
	MUL SUM,10 >STACK
	ADD STACK,STACK >SUM
	JUMP ?L9
?L7:	EQUAL? CHR,35 \FALSE
?L9:	INC 'BPTR
	JUMP ?L1
?L2:	CALL CHANGE-LEXV,PTR,W?NUMBER
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?$COMMA \?L13
	GRTR? P-LEN,1 \?L13
	ADD PTR,4 >XPTR
	CALL AFTER-COMMA-CHECK,XPTR >TMP
	ZERO? TMP /?L13
	MUL PTR,2 >STACK
	ADD STACK,2 >STACK
	GETB P-LEXV,STACK >CCTR
	MUL XPTR,2 >STACK
	ADD STACK,2 >STACK
	GETB P-LEXV,STACK >STACK
	ADD CCTR,STACK >CCTR
	INC 'CCTR
	MUL PTR,2 >STACK
	ADD STACK,2 >STACK
	PUTB P-LEXV,STACK,CCTR
	EQUAL? TMP,1000 \?L15
	SET 'TMP,0
?L15:	MUL 1000,SUM >STACK
	ADD STACK,TMP >SUM
	SUB P-LEN,2 >CCTR
?L18:	DLESS? 'CCTR,0 /?L19
	ADD PTR,P-LEXELEN >PTR
	ADD PTR,4 >XPTR
	GET P-LEXV,XPTR >STACK
	CALL CHANGE-LEXV,PTR,STACK
	MUL XPTR,2 >STACK
	ADD STACK,2 >STACK
	GETB P-LEXV,STACK >STACK
	MUL PTR,2 >STACK
	ADD STACK,2 >STACK
	PUTB P-LEXV,STACK,STACK
	MUL XPTR,2 >STACK
	ADD STACK,3 >STACK
	GETB P-LEXV,STACK >STACK
	MUL PTR,2 >STACK
	ADD STACK,3 >STACK
	PUTB P-LEXV,STACK,STACK
	JUMP ?L18
?L19:	SUB P-LEN,2 >P-LEN
	GETB P-LEXV,P-LEXWORDS >STACK
	SUB STACK,2 >STACK
	PUTB P-LEXV,P-LEXWORDS,STACK
?L13:	GRTR? SUM,10000 /FALSE
	SET 'P-NUMBER,SUM
	RETURN W?NUMBER

	.FUNCT AFTER-COMMA-CHECK,PTR,CNT,BPTR,CCTR=0,CHR,SUM=0
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	GETB STACK,2 >CNT
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	GETB STACK,3 >BPTR
?L1:	DLESS? 'CNT,0 /?L2
	GETB P-INBUF,BPTR >CHR
	IGRTR? 'CCTR,3 /?L2
	LESS? CHR,58 \FALSE
	GRTR? CHR,47 \FALSE
	SUB CHR,48 >STACK
	MUL SUM,10 >STACK
	ADD STACK,STACK >SUM
	INC 'BPTR
	JUMP ?L1
?L2:	EQUAL? CCTR,3 \FALSE
	ZERO? SUM \?L12
	RETURN 1000
?L12:	RETURN SUM

	.FUNCT ORPHAN-MERGE,CNT=-1,TEMP,VERB,BEG,END,ADJ=0,WRD,?TMP
	SET 'P-OFLAG,0
	GET P-ITBL,P-VERBN >STACK
	GET STACK,0 >WRD
	CALL WT?,WRD,PS?VERB,P1?VERB >?TMP
	GET P-OTBL,P-VERB >STACK
	EQUAL? ?TMP,STACK /?L3
	CALL WT?,WRD,PS?ADJECTIVE >STACK
	ZERO? STACK /?L1
?L3:	SET 'ADJ,1
	JUMP ?L4
?L1:	CALL WT?,WRD,PS?OBJECT,P1?OBJECT >STACK
	ZERO? STACK /?L4
	ZERO? P-NCN \?L4
	PUT P-ITBL,P-VERB,0
	PUT P-ITBL,P-VERBN,0
	ADD P-LEXV,2 >STACK
	PUT P-ITBL,P-NC1,STACK
	ADD P-LEXV,6 >STACK
	PUT P-ITBL,P-NC1L,STACK
	SET 'P-NCN,1
?L4:	GET P-ITBL,P-VERB >VERB
	ZERO? VERB /?L6
	ZERO? ADJ \?L6
	GET P-OTBL,P-VERB >STACK
	EQUAL? VERB,STACK \FALSE
?L6:	EQUAL? P-NCN,2 /FALSE
	GET P-OTBL,P-NC1 >STACK
	EQUAL? STACK,1 \?L9
	GET P-ITBL,P-PREP1 >TEMP
	GET P-OTBL,P-PREP1 >STACK
	EQUAL? TEMP,STACK /?L12
	ZERO? TEMP \FALSE
?L12:	ZERO? ADJ /?L13
	ADD P-LEXV,2 >STACK
	PUT P-OTBL,P-NC1,STACK
	GET P-ITBL,P-NC1L >STACK
	ZERO? STACK \?L15
	ADD P-LEXV,6 >STACK
	PUT P-ITBL,P-NC1L,STACK
?L15:	ZERO? P-NCN \?L21
	SET 'P-NCN,1
	JUMP ?L21
?L13:	GET P-ITBL,P-NC1 >STACK
	PUT P-OTBL,P-NC1,STACK
?L21:	GET P-ITBL,P-NC1L >STACK
	PUT P-OTBL,P-NC1L,STACK
	JUMP ?L42
?L9:	GET P-OTBL,P-NC2 >STACK
	EQUAL? STACK,1 \?L23
	GET P-ITBL,P-PREP1 >TEMP
	GET P-OTBL,P-PREP2 >STACK
	EQUAL? TEMP,STACK /?L26
	ZERO? TEMP \FALSE
?L26:	ZERO? ADJ /?L29
	ADD P-LEXV,2 >STACK
	PUT P-ITBL,P-NC1,STACK
	GET P-ITBL,P-NC1L >STACK
	ZERO? STACK \?L29
	ADD P-LEXV,6 >STACK
	PUT P-ITBL,P-NC1L,STACK
?L29:	GET P-ITBL,P-NC1 >STACK
	PUT P-OTBL,P-NC2,STACK
	GET P-ITBL,P-NC1L >STACK
	PUT P-OTBL,P-NC2L,STACK
	SET 'P-NCN,2
	JUMP ?L42
?L23:	ZERO? P-ACLAUSE /?L42
	EQUAL? P-NCN,1 /?L35
	ZERO? ADJ \?L35
	SET 'P-ACLAUSE,0
	RFALSE
?L35:	GET P-ITBL,P-NC1 >BEG
	ZERO? ADJ /?L38
	ADD P-LEXV,2 >BEG
	SET 'ADJ,0
?L38:	GET P-ITBL,P-NC1L >END
?L41:	GET BEG,0 >WRD
	EQUAL? BEG,END \?L43
	ZERO? ADJ /?L45
	CALL CLAUSE-WIN,ADJ
	JUMP ?L42
?L45:	SET 'P-ACLAUSE,0
	RFALSE
?L43:	EQUAL? WRD,W?ALL,W?EVERYT,W?ONE /?L49
	GETB WRD,P-PSOFF >STACK
	BTST STACK,PS?ADJECTIVE \?L48
	CALL ADJ-CHECK,WRD,ADJ,ADJ >STACK
	ZERO? STACK /?L48
?L49:	SET 'ADJ,WRD
	JUMP ?L51
?L48:	EQUAL? WRD,W?ONE \?L50
	CALL CLAUSE-WIN,ADJ
	JUMP ?L42
?L50:	GETB WRD,P-PSOFF >STACK
	BTST STACK,PS?OBJECT \?L51
	EQUAL? WRD,P-ANAM \?L52
	CALL CLAUSE-WIN,ADJ
	JUMP ?L42
?L52:	CALL CLAUSE-WIN
	JUMP ?L42
?L51:	ADD BEG,P-WORDLEN >BEG
	ZERO? END \?L41
	SET 'END,BEG
	SET 'P-NCN,1
	SUB BEG,4 >STACK
	PUT P-ITBL,P-NC1,STACK
	PUT P-ITBL,P-NC1L,BEG
	JUMP ?L41
?L42:	GET P-OVTBL,0 >STACK
	PUT P-VTBL,0,STACK
	GETB P-OVTBL,2 >STACK
	PUTB P-VTBL,2,STACK
	GETB P-OVTBL,3 >STACK
	PUTB P-VTBL,3,STACK
	PUT P-OTBL,P-VERBN,P-VTBL
	PUTB P-VTBL,2,0
?L60:	IGRTR? 'CNT,P-ITBLLEN \?L62
	SET 'P-MERGED,1
	RTRUE
?L62:	GET P-OTBL,CNT >STACK
	PUT P-ITBL,CNT,STACK
	JUMP ?L60

	.FUNCT CLAUSE-WIN,ADJ=0
	ZERO? ADJ /?L1
	GET P-OTBL,P-VERB >STACK
	PUT P-ITBL,P-VERB,STACK
	JUMP ?L3
?L1:	SET 'ADJ,1
?L3:	PUT P-CCTBL,CC-SBPTR,P-ACLAUSE
	ADD P-ACLAUSE,1 >STACK
	PUT P-CCTBL,CC-SEPTR,STACK
	EQUAL? P-ACLAUSE,P-NC1 \?L4
	PUT P-CCTBL,CC-OCLAUSE,P-OCL1
	JUMP ?L6
?L4:	PUT P-CCTBL,CC-OCLAUSE,P-OCL2
?L6:	CALL CLAUSE-COPY,P-OTBL,P-OTBL,ADJ
	GET P-OTBL,P-NC2 >STACK
	ZERO? STACK /?L7
	SET 'P-NCN,2
?L7:	SET 'P-ACLAUSE,0
	RTRUE

	.FUNCT WORD-PRINT,CNT,BUF
?L1:	DLESS? 'CNT,0 /TRUE
	GETB P-INBUF,BUF >STACK
	PRINTC STACK
	INC 'BUF
	JUMP ?L1

	.FUNCT UNKNOWN-WORD,PTR,BUF,?TMP
	PUT OOPS-TABLE,O-PTR,PTR
	PRINTI "[I don't know the word """
	MUL PTR,2 >BUF
	ADD P-LEXV,BUF >STACK
	GETB STACK,2 >?TMP
	ADD P-LEXV,BUF >STACK
	GETB STACK,3 >STACK
	CALL WORD-PRINT,?TMP,STACK
	PRINTI ".""]"
	CRLF
	SET 'QUOTE-FLAG,0
	SET 'P-OFLAG,0
	RETURN P-OFLAG

	.FUNCT CANT-USE,PTR,FOR-EACH-OTHER=0,BUF,?TMP
	PRINTI "[You used the word """
	ZERO? FOR-EACH-OTHER \?L3
	MUL PTR,2 >BUF
	ADD P-LEXV,BUF >STACK
	GETB STACK,2 >?TMP
	ADD P-LEXV,BUF >STACK
	GETB STACK,3 >STACK
	CALL WORD-PRINT,?TMP,STACK
?L3:	PRINTI """ in a way that I don't understand.]"
	CRLF
	CALL STOP >STACK
	RSTACK

	.FUNCT SYNTAX-CHECK,SYN,LEN,NUM,OBJ,DRIVE1=0,DRIVE2=0,PREP,VERB
	GET P-ITBL,P-VERB >VERB
	ZERO? VERB \?L1
	PRINT NO-VERB
	RFALSE
?L1:	SUB 255,VERB >STACK
	GET VERBS,STACK >SYN
	GETB SYN,0 >LEN
	INC 'SYN
?L4:	GETB SYN,P-SBITS >STACK
	BAND STACK,P-SONUMS >NUM
	GRTR? P-NCN,NUM /?L13
	LESS? NUM,1 /?L8
	ZERO? P-NCN \?L8
	GET P-ITBL,P-PREP1 >PREP
	ZERO? PREP /?L9
	GETB SYN,P-SPREP1 >STACK
	EQUAL? PREP,STACK \?L8
?L9:	SET 'DRIVE1,SYN
	JUMP ?L13
?L8:	GET P-ITBL,P-PREP1 >STACK
	GETB SYN,P-SPREP1 >STACK
	EQUAL? STACK,STACK \?L13
	EQUAL? NUM,2 \?L11
	EQUAL? P-NCN,1 \?L11
	SET 'DRIVE2,SYN
	JUMP ?L13
?L11:	GET P-ITBL,P-PREP2 >STACK
	GETB SYN,P-SPREP2 >STACK
	EQUAL? STACK,STACK \?L13
	CALL SYNTAX-FOUND,SYN
	RTRUE
?L13:	DLESS? 'LEN,1 \?L16
	ZERO? DRIVE1 \?L48
	ZERO? DRIVE2 \?L5
	CALL RECOGNIZE
	RFALSE
?L16:	ADD SYN,P-SYNLEN >SYN
	JUMP ?L4
?L5:	ZERO? DRIVE1 /?L23
?L48:	GETB DRIVE1,P-SPREP1 >STACK
	GETB DRIVE1,P-SLOC1 >STACK
	GETB DRIVE1,P-SFWIM1 >STACK
	CALL GWIM,STACK,STACK,STACK >OBJ
	ZERO? OBJ /?L23
	PUTB P-PRSO,P-MATCHLEN,1
	PUTB P-PRSO,1,OBJ
	CALL SYNTAX-FOUND,DRIVE1 >STACK
	RSTACK
?L23:	ZERO? DRIVE2 /?L25
	GETB DRIVE2,P-SPREP2 >STACK
	GETB DRIVE2,P-SLOC2 >STACK
	GETB DRIVE2,P-SFWIM2 >STACK
	CALL GWIM,STACK,STACK,STACK >OBJ
	ZERO? OBJ /?L25
	PUTB P-PRSI,P-MATCHLEN,1
	PUTB P-PRSI,1,OBJ
	CALL SYNTAX-FOUND,DRIVE2 >STACK
	RSTACK
?L25:	EQUAL? WINNER,PROTAGONIST \?L27
	CALL ORPHAN,DRIVE1,DRIVE2
	PRINTI "[Wh"
	JUMP ?L29
?L27:	PRINTI "[Your command was not complete. Next time, type wh"
?L29:	EQUAL? VERB,ACT?WALK,ACT?GO \?L30
	PRINTI "ere"
	JUMP ?L35
?L30:	ZERO? DRIVE1 /?L34
	GETB DRIVE1,P-SFWIM1 >STACK
	EQUAL? STACK,ACTORBIT /?L33
?L34:	ZERO? DRIVE2 /?L32
	GETB DRIVE2,P-SFWIM2 >STACK
	EQUAL? STACK,ACTORBIT \?L32
?L33:	PRINTI "om"
	JUMP ?L35
?L32:	PRINTI "at"
?L35:	EQUAL? WINNER,PROTAGONIST \?L36
	PRINT DO-YOU-WANT
	JUMP ?L38
?L36:	PRINTI " you want"
	CALL TPRINT,WINNER
	PRINTI " to "
?L38:	CALL VERB-PRINT
	SET 'P-OFLAG,0
	ZERO? DRIVE2 /?L39
	SET 'PREP,P-MERGED
	SET 'P-MERGED,0
	CALL CLAUSE-PRINT,P-NC1,P-NC1L
	SET 'P-MERGED,PREP
?L39:	ZERO? DRIVE1 /?L42
	GETB DRIVE1,P-SPREP1 >STACK
	JUMP ?L44
?L42:	GETB DRIVE2,P-SPREP2 >STACK
?L44:	CALL PREP-PRINT,STACK
	EQUAL? WINNER,PROTAGONIST \?L45
	SET 'P-OFLAG,1
	PRINTI "?]"
	CRLF
	RFALSE
?L45:	SET 'P-OFLAG,0
	PRINTI ".]"
	CRLF
	RFALSE

	.FUNCT VERB-PRINT,TMP
	GET P-ITBL,P-VERBN >TMP
	ZERO? TMP \?L1
	PRINTI "tell"
	RTRUE
?L1:	EQUAL? TMP,W?ZZMGCK \?L3
	PRINTI "answer"
	RTRUE
?L3:	GETB TMP,2 >STACK
	ZERO? STACK \?L4
	GET TMP,0 >STACK
	PRINTB STACK
	RTRUE
?L4:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
	PUTB TMP,2,0
	RTRUE

	.FUNCT CANT-ORPHAN
	PRINTI """I don't understand! What are you referring to?"""
	CRLF
	RFALSE

	.FUNCT ORPHAN,D1,D2,CNT=-1
	ZERO? P-MERGED \?L1
	PUT P-OCL1,P-MATCHLEN,0
	PUT P-OCL2,P-MATCHLEN,0
?L1:	GET P-VTBL,0 >STACK
	PUT P-OVTBL,0,STACK
	GETB P-VTBL,2 >STACK
	PUTB P-OVTBL,2,STACK
	GETB P-VTBL,3 >STACK
	PUTB P-OVTBL,3,STACK
?L4:	IGRTR? 'CNT,P-ITBLLEN /?L5
	GET P-ITBL,CNT >STACK
	PUT P-OTBL,CNT,STACK
	JUMP ?L4
?L5:	EQUAL? P-NCN,2 \?L9
	PUT P-CCTBL,CC-SBPTR,P-NC2
	PUT P-CCTBL,CC-SEPTR,P-NC2L
	PUT P-CCTBL,CC-OCLAUSE,P-OCL2
	CALL CLAUSE-COPY,P-ITBL,P-OTBL
?L9:	LESS? P-NCN,1 /?L12
	PUT P-CCTBL,CC-SBPTR,P-NC1
	PUT P-CCTBL,CC-SEPTR,P-NC1L
	PUT P-CCTBL,CC-OCLAUSE,P-OCL1
	CALL CLAUSE-COPY,P-ITBL,P-OTBL
?L12:	ZERO? D1 /?L15
	GETB D1,P-SPREP1 >STACK
	PUT P-OTBL,P-PREP1,STACK
	PUT P-OTBL,P-NC1,1
	RTRUE
?L15:	ZERO? D2 /FALSE
	GETB D2,P-SPREP2 >STACK
	PUT P-OTBL,P-PREP2,STACK
	PUT P-OTBL,P-NC2,1
	RTRUE

	.FUNCT CLAUSE-PRINT,BPTR,EPTR,THE?=1
	GET P-ITBL,EPTR >STACK
	GET P-ITBL,BPTR >STACK
	CALL BUFFER-PRINT,STACK,STACK,THE? >STACK
	RSTACK

	.FUNCT BUFFER-PRINT,BEG,END,CP,NOSP=0,WRD,FIRST??=1,PN=0
?L1:	EQUAL? BEG,END /TRUE
	ZERO? NOSP /?L6
	SET 'NOSP,0
	JUMP ?L8
?L6:	PRINTI " "
?L8:	GET BEG,0 >WRD
	EQUAL? WRD,W?$PERIOD /?L11
	ZERO? FIRST?? /?L9
	EQUAL? WRD,W?OF \?L9
?L11:	SET 'NOSP,1
	JUMP ?L14
?L9:	EQUAL? WRD,W?ME,W?MYSELF \?L12
	PRINTD ME
	SET 'PN,1
	JUMP ?L14
?L12:	CALL NAME?,WRD >STACK
	ZERO? STACK /?L13
	CALL CAPITALIZE,BEG
	SET 'PN,1
	JUMP ?L14
?L13:	ZERO? FIRST?? /?L15
	ZERO? PN \?L15
	ZERO? CP /?L15
	EQUAL? WRD,W?MY,W?HER /?L15
	PRINTI "the "
?L15:	ZERO? P-OFLAG \?L20
	ZERO? P-MERGED /?L18
?L20:	PRINTB WRD
	JUMP ?L24
?L18:	EQUAL? WRD,W?IT,W?THEM \?L21
	CALL ACCESSIBLE?,P-IT-OBJECT >STACK
	ZERO? STACK /?L21
	PRINTD P-IT-OBJECT
	JUMP ?L24
?L21:	EQUAL? WRD,W?HIM,W?HIMSELF \?L22
	CALL ACCESSIBLE?,P-HIM-OBJECT >STACK
	ZERO? STACK /?L22
	PRINTD P-HIM-OBJECT
	JUMP ?L24
?L22:	EQUAL? WRD,W?HER,W?HERSELF \?L23
	CALL ACCESSIBLE?,P-HER-OBJECT >STACK
	ZERO? STACK /?L23
	PRINTD P-HER-OBJECT
	JUMP ?L24
?L23:	GETB BEG,3 >STACK
	GETB BEG,2 >STACK
	CALL WORD-PRINT,STACK,STACK
?L24:	SET 'FIRST??,0
?L14:	ADD BEG,P-WORDLEN >BEG
	JUMP ?L1

	.FUNCT NAME?,WRD
	EQUAL? WRD,W?DAD,W?PAPA,W?FATHER /TRUE
	EQUAL? WRD,W?DIMSFORD,W?CRULLEY,W?LUCY /TRUE
	EQUAL? WRD,W?LAFOND,W?GOVERNOR,W?JAMISON /TRUE
	EQUAL? WRD,W?COOKIE,W?QUICK,W?RODNEY /TRUE
	EQUAL? WRD,W?LOUISE,W?DAVIS,W?SINISTRA /TRUE
	EQUAL? WRD,W?LATIN,W?NICK,W?NICHOLAS /TRUE
	EQUAL? WRD,W?FALCON,W?HELENA,W?JEAN /TRUE
	EQUAL? WRD,W?ANDY,W?ANDREW,W?ST /TRUE
	EQUAL? WRD,W?ERNEST,W?RYALL,W?RODNEY \FALSE
	RTRUE

	.FUNCT ADJNAME?,ADJ
	EQUAL? ADJ,A?NICK,A?NICHOLAS,A?FALCON /TRUE
	EQUAL? ADJ,A?HELENA,A?JEAN,A?ANDY /TRUE
	EQUAL? ADJ,A?ANDREW,A?ST /TRUE
	EQUAL? ADJ,A?ERNEST,A?RYALL,A?RODNEY \FALSE
	RTRUE

	.FUNCT CAPITALIZE,PTR
	ZERO? P-OFLAG \?L3
	ZERO? P-MERGED /?L1
?L3:	GET PTR,0 >STACK
	PRINTB STACK
	RTRUE
?L1:	GETB PTR,3 >STACK
	GETB P-INBUF,STACK >STACK
	SUB STACK,32 >STACK
	PRINTC STACK
	GETB PTR,3 >STACK
	INC 'STACK
	GETB PTR,2 >STACK
	DEC 'STACK
	CALL WORD-PRINT,STACK,STACK >STACK
	RSTACK

	.FUNCT PREP-PRINT,PREP,WRD
	ZERO? PREP /FALSE
	PRINTI " "
	EQUAL? PREP,PR?THROUGH \?L3
	PRINTI "through"
	RTRUE
?L3:	CALL PREP-FIND,PREP >WRD
	PRINTB WRD
	RTRUE

	.FUNCT CLAUSE-COPY,SRC,DEST,INSRT=0,OCL,BEG,END,BB,EE,OBEG,CNT,B,E
	GET P-CCTBL,CC-SBPTR >BB
	GET P-CCTBL,CC-SEPTR >EE
	GET P-CCTBL,CC-OCLAUSE >OCL
	GET SRC,BB >BEG
	GET SRC,EE >END
	GET OCL,P-MATCHLEN >OBEG
?L1:	EQUAL? BEG,END /?L2
	ZERO? INSRT /?L6
	GET BEG,0 >STACK
	EQUAL? P-ANAM,STACK \?L6
	EQUAL? INSRT,1 \?L8
	GET P-ITBL,P-NC1 >B
	GET P-ITBL,P-NC1L >E
?L10:	EQUAL? B,E /?L17
	GET B,0 >STACK
	CALL CLAUSE-ADD,STACK
	ADD B,P-WORDLEN >B
	JUMP ?L10
?L8:	GET OCL,1 >STACK
	EQUAL? INSRT,STACK /?L17
	CALL CLAUSE-ADD,INSRT
	GET BEG,0 >STACK
	CALL CLAUSE-ADD,STACK
	JUMP ?L17
?L6:	GET BEG,0 >STACK
	CALL CLAUSE-ADD,STACK
?L17:	ADD BEG,P-WORDLEN >BEG
	JUMP ?L1
?L2:	EQUAL? SRC,DEST \?L18
	GRTR? OBEG,0 \?L18
	GET OCL,P-MATCHLEN >STACK
	SUB STACK,OBEG >CNT
	PUT OCL,P-MATCHLEN,0
	INC 'OBEG
?L20:	GET OCL,OBEG >STACK
	CALL CLAUSE-ADD,STACK
	SUB CNT,2 >CNT
	ZERO? CNT /?L21
	ADD OBEG,2 >OBEG
	JUMP ?L20
?L21:	SET 'OBEG,0
?L18:	MUL OBEG,P-LEXELEN >STACK
	ADD STACK,2 >STACK
	ADD OCL,STACK >STACK
	PUT DEST,BB,STACK
	GET OCL,P-MATCHLEN >STACK
	MUL STACK,P-LEXELEN >STACK
	ADD STACK,2 >STACK
	ADD OCL,STACK >STACK
	PUT DEST,EE,STACK
	RTRUE

	.FUNCT CLAUSE-ADD,WRD,OCL,PTR
	GET P-CCTBL,CC-OCLAUSE >OCL
	GET OCL,P-MATCHLEN >STACK
	ADD STACK,2 >PTR
	SUB PTR,1 >STACK
	PUT OCL,STACK,WRD
	PUT OCL,PTR,0
	PUT OCL,P-MATCHLEN,PTR
	RTRUE

	.FUNCT PREP-FIND,PREP,CNT=0,SIZE
	GET PREPOSITIONS,0 >STACK
	MUL STACK,2 >SIZE
?L1:	IGRTR? 'CNT,SIZE /FALSE
	GET PREPOSITIONS,CNT >STACK
	EQUAL? STACK,PREP \?L1
	SUB CNT,1 >STACK
	GET PREPOSITIONS,STACK >STACK
	RSTACK

	.FUNCT SYNTAX-FOUND,SYN
	SET 'P-SYNTAX,SYN
	GETB SYN,P-SACTION >PRSA
	RETURN PRSA

	.FUNCT GWIM,GBIT,LBIT,PREP,OBJ
	EQUAL? GBIT,RLANDBIT \?L1
	RETURN ROOMS
?L1:	SET 'P-GWIMBIT,GBIT
	SET 'P-SLOCBITS,LBIT
	PUTB P-MERGE,P-MATCHLEN,0
	CALL GET-OBJECT,P-MERGE,0 >STACK
	ZERO? STACK /?L4
	SET 'P-GWIMBIT,0
	GETB P-MERGE,P-MATCHLEN >STACK
	EQUAL? STACK,1 \FALSE
	GETB P-MERGE,1 >OBJ
	PRINTI "["
	ZERO? PREP /?L15
	ZERO? P-END-ON-PREP \?L15
	CALL PREP-FIND,PREP >PREP
	PRINTB PREP
	EQUAL? PREP,W?OUT \?L10
	PRINTI " of"
?L10:	FSET? OBJ,NARTICLEBIT /?L13
	PRINTI " the "
	JUMP ?L15
?L13:	PRINTI " "
?L15:	PRINTD OBJ
	PRINTI "]"
	CRLF
	RETURN OBJ
?L4:	SET 'P-GWIMBIT,0
	RFALSE

	.FUNCT SNARF-OBJECTS,PTR
	GET P-ITBL,P-NC1 >PTR
	ZERO? PTR /?L5
	SET 'P-PHR,0
	GETB P-SYNTAX,P-SLOC1 >P-SLOCBITS
	GET P-ITBL,P-NC1L >STACK
	CALL SNARFEM,PTR,STACK,P-PRSO >STACK
	ZERO? STACK /FALSE
	GETB P-BUTS,P-MATCHLEN >STACK
	ZERO? STACK /?L5
	CALL BUT-MERGE,P-PRSO >P-PRSO
?L5:	GET P-ITBL,P-NC2 >PTR
	ZERO? PTR /TRUE
	SET 'P-PHR,1
	GETB P-SYNTAX,P-SLOC2 >P-SLOCBITS
	GET P-ITBL,P-NC2L >STACK
	CALL SNARFEM,PTR,STACK,P-PRSI >STACK
	ZERO? STACK /FALSE
	GETB P-BUTS,P-MATCHLEN >STACK
	ZERO? STACK /TRUE
	GETB P-PRSI,P-MATCHLEN >STACK
	EQUAL? STACK,1 \?L14
	CALL BUT-MERGE,P-PRSO >P-PRSO
	RTRUE
?L14:	CALL BUT-MERGE,P-PRSI >P-PRSI
	RTRUE

	.FUNCT BUT-MERGE,TBL,LEN,BUTLEN,CNT=1,MATCHES=0,OBJ,NTBL
	GETB TBL,P-MATCHLEN >LEN
	PUTB P-MERGE,P-MATCHLEN,0
?L1:	DLESS? 'LEN,0 /?L2
	GETB TBL,CNT >OBJ
	CALL ZMEMQB,OBJ,P-BUTS >STACK
	ZERO? STACK \?L5
	INC 'MATCHES
	PUTB P-MERGE,MATCHES,OBJ
?L5:	INC 'CNT
	JUMP ?L1
?L2:	PUTB P-MERGE,P-MATCHLEN,MATCHES
	SET 'NTBL,P-MERGE
	SET 'P-MERGE,TBL
	RETURN NTBL

	.FUNCT SNARFEM,PTR,EPTR,TBL,BUT=0,LEN,WV,WRD,NW,WAS-ALL=0
	SET 'P-AND,0
	EQUAL? P-GETFLAGS,P-ALL \?L1
	SET 'WAS-ALL,1
?L1:	SET 'P-GETFLAGS,0
	PUTB P-BUTS,P-MATCHLEN,0
	PUTB TBL,P-MATCHLEN,0
	GET PTR,0 >WRD
?L4:	EQUAL? PTR,EPTR \?L6
?L60:	ZERO? BUT /?L9
	PUSH BUT
	JUMP ?L8
?L9:	PUSH TBL
?L8:	CALL GET-OBJECT,STACK >WV
	ZERO? WAS-ALL /?L10
	SET 'P-GETFLAGS,P-ALL
?L10:	RETURN WV
?L6:	ADD PTR,P-WORDLEN >STACK
	EQUAL? EPTR,STACK \?L14
	SET 'NW,0
	JUMP ?L16
?L14:	GET PTR,P-LEXELEN >NW
?L16:	EQUAL? WRD,W?ALL,W?BOTH,W?EVERYT \?L17
	CALL MANY-CHECK,P-PHR >STACK
	ZERO? STACK /FALSE
	SET 'P-GETFLAGS,P-ALL
	EQUAL? NW,W?OF \?L55
	ADD PTR,P-WORDLEN >PTR
	JUMP ?L55
?L17:	EQUAL? WRD,W?BUT,W?EXCEPT \?L25
	ZERO? BUT /?L29
	PUSH BUT
	JUMP ?L28
?L29:	PUSH TBL
?L28:	CALL GET-OBJECT,STACK >STACK
	ZERO? STACK /FALSE
	SET 'BUT,P-BUTS
	PUTB BUT,P-MATCHLEN,0
	JUMP ?L55
?L25:	EQUAL? WRD,W?A,W?ONE \?L30
	ZERO? P-ADJ \?L31
	SET 'P-GETFLAGS,P-ONE
	EQUAL? NW,W?OF \?L55
	ADD PTR,P-WORDLEN >PTR
	JUMP ?L55
?L31:	SET 'P-NAM,P-ONEOBJ
	ZERO? BUT /?L40
	PUSH BUT
	JUMP ?L39
?L40:	PUSH TBL
?L39:	CALL GET-OBJECT,STACK >STACK
	ZERO? STACK /FALSE
	ZERO? NW /TRUE
	JUMP ?L55
?L30:	EQUAL? WRD,W?AND,W?$COMMA \?L43
	EQUAL? NW,W?AND,W?$COMMA /?L43
	SET 'P-AND,1
	ZERO? BUT /?L47
	PUSH BUT
	JUMP ?L46
?L47:	PUSH TBL
?L46:	CALL GET-OBJECT,STACK >STACK
	ZERO? STACK /FALSE
	JUMP ?L55
?L43:	CALL WT?,WRD,PS?BUZZ-WORD >STACK
	ZERO? STACK \?L55
	EQUAL? WRD,W?AND,W?$COMMA /?L55
	EQUAL? WRD,W?OF \?L50
	ZERO? P-GETFLAGS \?L55
	SET 'P-GETFLAGS,P-INHIBIT
	JUMP ?L55
?L50:	CALL WT?,WRD,PS?ADJECTIVE,P1?ADJECTIVE >WV
	ZERO? WV /?L54
	CALL ADJ-CHECK,WRD,P-ADJ,P-ADJN >STACK
	ZERO? STACK /?L54
	EQUAL? NW,W?OF /?L54
	SET 'P-ADJ,WV
	SET 'P-ADJN,WRD
	JUMP ?L55
?L54:	CALL WT?,WRD,PS?OBJECT,P1?OBJECT >STACK
	ZERO? STACK /?L55
	SET 'P-NAM,WRD
	SET 'P-ONEOBJ,WRD
?L55:	EQUAL? PTR,EPTR /?L60
	ADD PTR,P-WORDLEN >PTR
	SET 'WRD,NW
	JUMP ?L4

	.FUNCT ADJ-CHECK,WRD,ADJ,ADJN
	ZERO? ADJ \FALSE
	RTRUE

	.FUNCT GET-OBJECT,TBL,VRB=1,BITS,LEN,XBITS,TLEN,GCHECK=0,OLEN=0,OBJ
	SET 'XBITS,P-SLOCBITS
	GETB TBL,P-MATCHLEN >TLEN
	BTST P-GETFLAGS,P-INHIBIT /TRUE
	ZERO? P-NAM \?L11
	ZERO? P-ADJ /?L8
	CALL WT?,P-ADJN,PS?OBJECT,P1?OBJECT >STACK
	ZERO? STACK /?L6
	SET 'P-NAM,P-ADJN
	SET 'P-ADJ,0
	SET 'P-ADJN,0
	JUMP ?L8
?L6:	CALL WT?,P-ADJN,PS?DIRECTION,P1?DIRECTION >BITS
	ZERO? BITS /?L8
	SET 'P-DIRECTION,BITS
?L8:	ZERO? P-NAM \?L11
	ZERO? P-ADJ \?L11
	EQUAL? P-GETFLAGS,P-ALL /?L63
	ZERO? P-GWIMBIT \?L11
	ZERO? VRB /FALSE
	PRINT NOUN-MISSING
	RFALSE
?L11:	EQUAL? P-GETFLAGS,P-ALL \?L19
?L63:	ZERO? P-SLOCBITS \?L17
?L19:	SET 'P-SLOCBITS,-1
?L17:	SET 'P-TABLE,TBL
?L21:	ZERO? GCHECK /?L23
	CALL GLOBAL-CHECK,TBL
	JUMP ?L25
?L23:	ZERO? LIT \?L28
	EQUAL? PRSA,V?TELL \?L26
?L28:	FCLEAR PROTAGONIST,TRANSBIT
	CALL DO-SL,HERE,SOG,SIR
	FSET PROTAGONIST,TRANSBIT
	JUMP ?L29
?L26:	LOC PROTAGONIST >STACK
	FSET? STACK,VEHBIT \?L29
	LOC PROTAGONIST >STACK
	CALL THIS-IT?,STACK >STACK
	ZERO? STACK /?L29
	LOC PROTAGONIST >STACK
	CALL OBJ-FOUND,STACK,TBL
?L29:	CALL DO-SL,PROTAGONIST,SH,SC
?L25:	GETB TBL,P-MATCHLEN >STACK
	SUB STACK,TLEN >LEN
	BTST P-GETFLAGS,P-ALL /?L61
	EQUAL? P-GETFLAGS,P-ALL /?L33
	GRTR? LEN,1 /?L34
	ZERO? LEN \?L61
	EQUAL? P-SLOCBITS,-1 /?L33
?L34:	EQUAL? P-SLOCBITS,-1 \?L35
	SET 'P-SLOCBITS,XBITS
	SET 'OLEN,LEN
	GETB TBL,P-MATCHLEN >STACK
	SUB STACK,LEN >STACK
	PUTB TBL,P-MATCHLEN,STACK
	JUMP ?L21
?L35:	CALL PUT-ADJ-NAM
	ZERO? LEN \?L38
	SET 'LEN,OLEN
?L38:	ZERO? P-NAM /?L41
	ADD TLEN,1 >STACK
	GETB TBL,STACK >OBJ
	ZERO? OBJ /?L41
	GETP OBJ,P?GENERIC >STACK
	CALL STACK >OBJ
	ZERO? OBJ /?L41
	EQUAL? OBJ,NOT-HERE-OBJECT /FALSE
	PUTB TBL,1,OBJ
	PUTB TBL,P-MATCHLEN,1
	SET 'P-NAM,0
	SET 'P-ADJ,0
	RTRUE
?L41:	ZERO? VRB /?L51
	EQUAL? WINNER,PROTAGONIST /?L46
	CALL CANT-ORPHAN
	SET 'P-NAM,0
	SET 'P-ADJ,0
	RFALSE
?L46:	ZERO? VRB /?L51
	ZERO? P-NAM /?L47
	CALL WHICH-PRINT,TLEN,LEN,TBL
	EQUAL? TBL,P-PRSO \?L48
	SET 'P-ACLAUSE,P-NC1
	JUMP ?L50
?L48:	SET 'P-ACLAUSE,P-NC2
?L50:	SET 'P-AADJ,P-ADJ
	SET 'P-ANAM,P-NAM
	CALL ORPHAN,0,0
	SET 'P-OFLAG,1
	JUMP ?L51
?L47:	ZERO? VRB /?L51
	PRINT NOUN-MISSING
?L51:	SET 'P-NAM,0
	SET 'P-ADJ,0
	RFALSE
?L33:	ZERO? LEN \?L61
	ZERO? GCHECK /?L53
	CALL PUT-ADJ-NAM
	ZERO? VRB /?L59
	SET 'P-SLOCBITS,XBITS
	ZERO? LIT \?L58
	EQUAL? PRSA,V?TELL,V?OPEN /?L58
	EQUAL? PRSA,V?WHERE,V?WHAT \?L56
?L58:	CALL OBJ-FOUND,NOT-HERE-OBJECT,TBL
	SET 'P-XNAM,P-NAM
	SET 'P-XADJ,P-ADJ
	SET 'P-XADJN,P-ADJN
	SET 'P-NAM,0
	SET 'P-ADJ,0
	SET 'P-ADJN,0
	RTRUE
?L56:	PRINT TOO-DARK
	CRLF
?L59:	SET 'P-NAM,0
	SET 'P-ADJ,0
	RFALSE
?L53:	ZERO? LEN \?L61
	SET 'GCHECK,1
	JUMP ?L21
?L61:	SET 'P-SLOCBITS,XBITS
	CALL PUT-ADJ-NAM
	SET 'P-NAM,0
	SET 'P-ADJ,0
	RTRUE

	.FUNCT PUT-ADJ-NAM
	EQUAL? P-NAM,W?IT /FALSE
	PUT P-NAMW,P-PHR,P-NAM
	PUT P-ADJW,P-PHR,P-ADJ
	RTRUE

	.FUNCT MOBY-FIND,TBL,OBJ=1,LEN,FOO,NAM,ADJ
	SET 'NAM,P-NAM
	SET 'ADJ,P-ADJ
	SET 'P-NAM,P-XNAM
	SET 'P-ADJ,P-XADJ
	PUTB TBL,P-MATCHLEN,0
?L1:	CALL THIS-IT?,OBJ >FOO
	ZERO? FOO /?L5
	CALL OBJ-FOUND,OBJ,TBL >FOO
?L5:	IGRTR? 'OBJ,LAST-OBJECT \?L1
	GETB TBL,P-MATCHLEN >LEN
	EQUAL? LEN,1 \?L11
	GETB TBL,1 >P-MOBY-FOUND
?L11:	SET 'P-NAM,NAM
	SET 'P-ADJ,ADJ
	RETURN LEN

	.FUNCT WHICH-PRINT,TLEN,LEN,TBL,OBJ,RLEN
	SET 'RLEN,LEN
	PRINTI "[Which"
	ZERO? P-OFLAG \?L3
	ZERO? P-MERGED \?L3
	ZERO? P-AND /?L1
?L3:	PRINTI " "
	PRINTB P-NAM
	JUMP ?L5
?L1:	EQUAL? TBL,P-PRSO \?L4
	CALL CLAUSE-PRINT,P-NC1,P-NC1L,0
	JUMP ?L5
?L4:	CALL CLAUSE-PRINT,P-NC2,P-NC2L,0
?L5:	PRINTI " dost thou mean, "
?L6:	INC 'TLEN
	GETB TBL,TLEN >OBJ
	FSET? OBJ,NARTICLEBIT /?L8
	PRINTI "the "
?L8:	PRINTD OBJ
	EQUAL? LEN,2 \?L11
	EQUAL? RLEN,2 /?L13
	PRINTI ","
?L13:	PRINTI " or "
	JUMP ?L16
?L11:	GRTR? LEN,2 \?L16
	PRINTI ", "
?L16:	DLESS? 'LEN,1 \?L6
	PRINTR "?]"

	.FUNCT GLOBAL-CHECK,TBL,LEN,RMG,RMGL,CNT=0,OBJ,OBITS,FOO
	GETB TBL,P-MATCHLEN >LEN
	SET 'OBITS,P-SLOCBITS
	GETPT HERE,P?GLOBAL >RMG
	ZERO? RMG /?L4
	PTSIZE RMG >STACK
	SUB STACK,1 >RMGL
?L3:	GETB RMG,CNT >OBJ
	CALL THIS-IT?,OBJ >STACK
	ZERO? STACK /?L5
	CALL OBJ-FOUND,OBJ,TBL
?L5:	IGRTR? 'CNT,RMGL \?L3
?L4:	GETB TBL,P-MATCHLEN >STACK
	EQUAL? STACK,LEN \FALSE
	SET 'P-SLOCBITS,-1
	SET 'P-TABLE,TBL
	CALL DO-SL,GLOBAL-OBJECTS,1,1
	SET 'P-SLOCBITS,OBITS
	RETURN P-SLOCBITS

	.FUNCT DO-SL,OBJ,BIT1,BIT2,BTS
	ADD BIT1,BIT2 >STACK
	BTST P-SLOCBITS,STACK \?L1
	CALL SEARCH-LIST,OBJ,P-TABLE,P-SRCALL >STACK
	RSTACK
?L1:	BTST P-SLOCBITS,BIT1 \?L4
	CALL SEARCH-LIST,OBJ,P-TABLE,P-SRCTOP >STACK
	RSTACK
?L4:	BTST P-SLOCBITS,BIT2 \TRUE
	CALL SEARCH-LIST,OBJ,P-TABLE,P-SRCBOT >STACK
	RSTACK

	.FUNCT SEARCH-LIST,OBJ,TBL,LVL,FLS,NOBJ
	FIRST? OBJ >OBJ \FALSE
?L3:	EQUAL? LVL,P-SRCBOT /?L5
	GETPT OBJ,P?SYNONYM >STACK
	ZERO? STACK /?L5
	CALL THIS-IT?,OBJ >STACK
	ZERO? STACK /?L5
	CALL OBJ-FOUND,OBJ,TBL
?L5:	EQUAL? LVL,P-SRCTOP \?L10
	FSET? OBJ,SEARCHBIT /?L10
	FSET? OBJ,SURFACEBIT \?L11
?L10:	FIRST? OBJ >NOBJ \?L11
	FSET? OBJ,OPENBIT /?L13
	FSET? OBJ,TRANSBIT /?L13
	ZERO? P-MOBY-FLAG /?L11
?L13:	FSET? OBJ,SURFACEBIT \?L14
	PUSH P-SRCALL
	JUMP ?L17
?L14:	FSET? OBJ,SEARCHBIT \?L16
	PUSH P-SRCALL
	JUMP ?L17
?L16:	PUSH P-SRCTOP
?L17:	CALL SEARCH-LIST,OBJ,TBL,STACK >FLS
?L11:	NEXT? OBJ >OBJ /?L3
	RTRUE

	.FUNCT OBJ-FOUND,OBJ,TBL,PTR
	GETB TBL,P-MATCHLEN >PTR
	ADD PTR,1 >STACK
	PUTB TBL,STACK,OBJ
	ADD PTR,1 >STACK
	PUTB TBL,P-MATCHLEN,STACK
	RTRUE

	.FUNCT TAKE-CHECK
	GETB P-SYNTAX,P-SLOC1 >STACK
	CALL ITAKE-CHECK,P-PRSO,STACK >STACK
	ZERO? STACK /FALSE
	GETB P-SYNTAX,P-SLOC2 >STACK
	CALL ITAKE-CHECK,P-PRSI,STACK >STACK
	RSTACK

	.FUNCT ITAKE-CHECK,TBL,IBITS,PTR,OBJ,TAKEN
	GETB TBL,P-MATCHLEN >PTR
	ZERO? PTR /TRUE
	BTST IBITS,SHAVE /?L3
	BTST IBITS,STAKE \TRUE
?L3:	DLESS? 'PTR,0 /TRUE
	ADD PTR,1 >STACK
	GETB TBL,STACK >OBJ
	EQUAL? OBJ,IT \?L9
	CALL VISIBLE?,P-IT-OBJECT >STACK
	ZERO? STACK \?L11
	CALL REFERRING
	RFALSE
?L11:	SET 'OBJ,P-IT-OBJECT
	JUMP ?L21
?L9:	EQUAL? OBJ,HIM \?L14
	CALL VISIBLE?,P-HIM-OBJECT >STACK
	ZERO? STACK \?L15
	CALL REFERRING,1
	RFALSE
?L15:	SET 'OBJ,P-HIM-OBJECT
	JUMP ?L21
?L14:	EQUAL? OBJ,HER \?L21
	CALL VISIBLE?,P-HER-OBJECT >STACK
	ZERO? STACK \?L19
	CALL REFERRING,1
	RFALSE
?L19:	SET 'OBJ,P-HER-OBJECT
?L21:	CALL HELD?,OBJ >STACK
	ZERO? STACK \?L3
	EQUAL? OBJ,HANDS /?L3
	EQUAL? PRSA,V?TAKE-WITH \?L26
	EQUAL? OBJ,MAN /?L3
?L26:	SET 'PRSO,OBJ
	FSET? OBJ,TRYTAKEBIT \?L28
	SET 'TAKEN,1
	JUMP ?L36
?L28:	CALL UNTOUCHABLE?,OBJ >STACK
	ZERO? STACK /?L30
	SET 'TAKEN,1
	JUMP ?L36
?L30:	EQUAL? OBJ,WINE \?L31
	CALL HELD?,BLUE-GLASS >STACK
	ZERO? STACK \?L32
	CALL HELD?,GREEN-GLASS >STACK
	ZERO? STACK /?L31
?L32:	SET 'TAKEN,0
	JUMP ?L36
?L31:	EQUAL? HERE,ON-LADDER \?L33
	EQUAL? OBJ,LADDER \?L33
	SET 'TAKEN,0
	JUMP ?L36
?L33:	EQUAL? WINNER,PROTAGONIST /?L34
	SET 'TAKEN,0
	JUMP ?L36
?L34:	BTST IBITS,STAKE \?L35
	CALL ITAKE,0 >STACK
	EQUAL? STACK,1 \?L35
	SET 'TAKEN,0
	JUMP ?L36
?L35:	SET 'TAKEN,1
?L36:	ZERO? TAKEN /?L49
	BTST IBITS,SHAVE \?L37
	GETB TBL,P-MATCHLEN >STACK
	LESS? 1,STACK \?L39
	PRINT YNH
	PRINTI " those things!"
	CRLF
	RFALSE
?L39:	EQUAL? OBJ,NOT-HERE-OBJECT \?L41
	PRINT YOU-CANT
	PRINTI "see that here!"
	CRLF
	RFALSE
?L41:	EQUAL? WINNER,PROTAGONIST \?L43
	PRINT YNH
	JUMP ?L45
?L43:	PRINT DOESNT-LOOK
	CALL TPRINT,WINNER
	PRINTI " has"
?L45:	CALL THIS-IS-IT,OBJ
	CALL TRPRINT,OBJ
	RFALSE
?L37:	ZERO? TAKEN \?L3
?L49:	IN? PROTAGONIST,OBJ /?L3
	EQUAL? WINNER,PROTAGONIST \?L3
	PRINTI "[taking"
	CALL TPRINT,OBJ
	PRINTI " first]"
	CRLF
	JUMP ?L3

	.FUNCT MANY-CHECK,PHR=2,LOSS=0,TMP
	ZERO? PHR \?L1
	GETB P-SYNTAX,P-SLOC1 >STACK
	BTST STACK,SMANY /?L1
	SET 'LOSS,1
	JUMP ?L5
?L1:	EQUAL? PHR,1 \?L3
	GETB P-SYNTAX,P-SLOC2 >STACK
	BTST STACK,SMANY /?L3
	SET 'LOSS,2
	JUMP ?L5
?L3:	EQUAL? PHR,2 \?L5
	GETB P-PRSO,P-MATCHLEN >STACK
	GRTR? STACK,1 \?L4
	GETB P-SYNTAX,P-SLOC1 >STACK
	BTST STACK,SMANY /?L4
	SET 'LOSS,1
	JUMP ?L5
?L4:	EQUAL? PHR,2 \?L5
	GETB P-PRSI,P-MATCHLEN >STACK
	GRTR? STACK,1 \?L5
	GETB P-SYNTAX,P-SLOC2 >STACK
	BTST STACK,SMANY /?L5
	SET 'LOSS,2
?L5:	ZERO? LOSS /TRUE
	PRINTI "["
	PRINT YOU-CANT
	PRINTI "use multiple "
	EQUAL? LOSS,2 \?L9
	PRINTI "in"
?L9:	PRINTI "direct objects with """
	GET P-ITBL,P-VERBN >TMP
	ZERO? TMP \?L12
	PRINTI "tell"
	JUMP ?L16
?L12:	ZERO? P-OFLAG \?L15
	ZERO? P-MERGED /?L14
?L15:	GET TMP,0 >STACK
	PRINTB STACK
	JUMP ?L16
?L14:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
?L16:	PRINTI """.]"
	CRLF
	RFALSE

	.FUNCT ZMEMQ,ITM,TBL,SIZE=-1,CNT=1
	ZERO? TBL /FALSE
	LESS? SIZE,0 /?L4
	SET 'CNT,0
	JUMP ?L6
?L4:	GET TBL,0 >SIZE
?L6:	GET TBL,CNT >STACK
	EQUAL? ITM,STACK /TRUE
	IGRTR? 'CNT,SIZE \?L6
	RFALSE

	.FUNCT ZMEMQB,ITM,TBL,SIZE=-1,CNT=1
	LESS? SIZE,0 /?L1
	SET 'CNT,0
	JUMP ?L3
?L1:	GETB TBL,0 >SIZE
?L3:	GETB TBL,CNT >STACK
	EQUAL? ITM,STACK /TRUE
	IGRTR? 'CNT,SIZE \?L3
	RFALSE

	.FUNCT LIT?,RM,RMBIT=1,OHERE,LIT?1=0
	SET 'P-GWIMBIT,ONBIT
	SET 'OHERE,HERE
	SET 'HERE,RM
	ZERO? RMBIT /?L1
	FSET? RM,ONBIT \?L1
	SET 'LIT?1,1
	JUMP ?L10
?L1:	PUTB P-MERGE,P-MATCHLEN,0
	SET 'P-TABLE,P-MERGE
	SET 'P-SLOCBITS,-1
	EQUAL? OHERE,RM \?L6
	CALL DO-SL,WINNER,1,1
	EQUAL? WINNER,PROTAGONIST /?L6
	IN? PROTAGONIST,RM \?L6
	CALL DO-SL,PROTAGONIST,1,1
?L6:	CALL DO-SL,RM,1,1
	GET P-TABLE,P-MATCHLEN >STACK
	GRTR? STACK,0 \?L10
	SET 'LIT?1,1
?L10:	SET 'HERE,OHERE
	SET 'P-GWIMBIT,0
	RETURN LIT?1

	.FUNCT PRSO-PRINT,PTR
	ZERO? P-MERGED \?L3
	GET P-ITBL,P-NC1 >PTR
	GET PTR,0 >STACK
	EQUAL? STACK,W?IT \?L1
?L3:	PRINTI " "
	PRINTD PRSO
	RTRUE
?L1:	GET P-ITBL,P-NC1L >STACK
	CALL BUFFER-PRINT,PTR,STACK,0 >STACK
	RSTACK

	.FUNCT PRSI-PRINT,PTR
	ZERO? P-MERGED \?L3
	GET P-ITBL,P-NC2 >PTR
	GET PTR,0 >STACK
	EQUAL? STACK,W?IT \?L1
?L3:	PRINTI " "
	PRINTD PRSI
	RTRUE
?L1:	GET P-ITBL,P-NC2L >STACK
	CALL BUFFER-PRINT,PTR,STACK,0 >STACK
	RSTACK

	.FUNCT THIS-IT?,OBJ,SYNS
	FSET? OBJ,INVISIBLE /FALSE
	ZERO? P-NAM /?L3
	GETPT OBJ,P?SYNONYM >SYNS
	PTSIZE SYNS >STACK
	DIV STACK,2 >STACK
	DEC 'STACK
	CALL ZMEMQ,P-NAM,SYNS,STACK >STACK
	ZERO? STACK /FALSE
?L3:	ZERO? P-ADJ /?L4
	GETPT OBJ,P?ADJECTIVE >SYNS
	ZERO? SYNS /FALSE
	PTSIZE SYNS >STACK
	DEC 'STACK
	CALL ZMEMQB,P-ADJ,SYNS,STACK >STACK
	ZERO? STACK /FALSE
?L4:	ZERO? P-GWIMBIT /TRUE
	FSET? OBJ,P-GWIMBIT /TRUE
	RFALSE

	.FUNCT V-VERBOSE
	SET 'VERBOSITY,2
	PRINTI "Maximum verbosity."
	CRLF
	CRLF
	CALL V-LOOK >STACK
	RSTACK

	.FUNCT V-BRIEF
	SET 'VERBOSITY,1
	PRINTI "B"
	PRINT RIEF-DESC
	RTRUE

	.FUNCT V-SUPER-BRIEF
	SET 'VERBOSITY,0
	PRINTI "Superb"
	PRINT RIEF-DESC
	RTRUE

	.FUNCT V-SAVE
	SET 'P-CONT,0
	SET 'QUOTE-FLAG,0
	SAVE \?L1
	PRINT OK
	RTRUE
?L1:	PRINT FAILED
	RTRUE

	.FUNCT V-RESTORE
	RESTORE \?L1
	PRINT OK
	RTRUE
?L1:	PRINT FAILED
	RTRUE

	.FUNCT V-SCRIPT
	GET 0,8 >STACK
	BOR STACK,1 >STACK
	PUT 0,8,STACK
	CALL CORP-NOTICE,STR?108
	CALL V-VERSION >STACK
	RSTACK

	.FUNCT V-UNSCRIPT
	CALL CORP-NOTICE,STR?109
	CALL V-VERSION
	GET 0,8 >STACK
	BAND STACK,-2 >STACK
	PUT 0,8,STACK
	RTRUE

	.FUNCT CORP-NOTICE,STRING
	PRINTI "Here "
	PRINT STRING
	PRINTR " a transcript of interaction with"

	.FUNCT V-INVENTORY
	CALL RUNNING?,I-LSED >STACK
	ZERO? STACK /?L1
	GRTR? LAFOND-CTR,HORNY \?L1
	CALL HELD?,PINCH >STACK
	ZERO? STACK /?L3
	CALL CTPRINT,PINCH
	PRINTI " is not enough to cover"
	JUMP ?L5
?L3:	PRINTI "You blush to look at"
?L5:	PRINTR " your naked body."
?L1:	SUB 0,WORNBIT >D-BIT
	CALL DESCRIBE-CONTENTS,WINNER,0,3
	SET 'D-BIT,WORNBIT
	CALL DESCRIBE-CONTENTS,WINNER,0,3
	SET 'D-BIT,0
	CRLF
	RTRUE

	.FUNCT V-QUIT
	CALL V-SCORE
	CALL DO-YOU-WISH,STR?110
	CALL YES? >STACK
	ZERO? STACK /?L1
	QUIT
?L1:	PRINT OK
	RTRUE

	.FUNCT V-RESTART
	CALL V-SCORE
	CALL DO-YOU-WISH,STR?111
	CALL YES? >STACK
	ZERO? STACK /FALSE
	PRINTI "Restarting."
	CRLF
	RESTART

	.FUNCT DO-YOU-WISH,STRING
	PRINT INDENT
	PRINTI "Do you wish to "
	PRINT STRING
	PRINTI "? (Y is affirmative): "
	RTRUE

	.FUNCT YES?
?L0:	PRINTI ">"
	READ P-INBUF,P-LEXV
	GET P-LEXV,1 >STACK
	CALL YES-WORD,STACK >STACK
	ZERO? STACK \TRUE
	GET P-LEXV,1 >STACK
	CALL NO-WORD,STACK >STACK
	ZERO? STACK \FALSE
	GET P-LEXV,1 >STACK
	EQUAL? STACK,W?N /FALSE
	PRINTI "This is important: please answer YES or NO. "
	JUMP ?L0

	.FUNCT FINISH,REPEATING=0,CNT=0
?L1:	CRLF
	ZERO? REPEATING \?L3
	SET 'REPEATING,1
	PRINT INDENT
	CALL V-SCORE
?L3:	GRTR? SCORE,24 \?L6
	PRINT INDENT
	PRINTI "Thus you have finished the story of "
	PRINT GAME-CAPS
	PRINTI ", earning the title, """
	GET WINNING-RANKS,FINAL-RANK >STACK
	PRINT STACK
	PRINTI "."""
	LESS? FINAL-RANK,4 \?L8
	PRINTI " There are other, perhaps more satisfying, conclusions."
?L8:	CRLF
?L6:	PRINT INDENT
	PRINTI "[EVENT: GAME OVER]You may start over, restore a saved position, or end this session of the game. (Type RESTART, RESTORE, or QUIT):
>"
	PUTB P-LEXV,0,10
	READ P-INBUF,P-LEXV
	PUTB P-LEXV,0,60
	INC 'CNT
	GET P-LEXV,1 >STACK
	EQUAL? STACK,W?RESTAR \?L12
	RESTART
?L12:	GET P-LEXV,1 >STACK
	EQUAL? STACK,W?RESTOR \?L14
	RESTORE /?L14
	PRINT FAILED
	JUMP ?L1
?L14:	GET P-LEXV,1 >STACK
	EQUAL? STACK,W?QUIT,W?Q /?L16
	GRTR? CNT,10 \?L1
?L16:	QUIT

	.FUNCT V-VERSION,CNT=17,V
	GET 0,1 >STACK
	BAND STACK,2047 >V
	PRINT GAME-CAPS
	CRLF
	PRINTI "Infocom interactive fiction
Copyright (c) 1987 by Infocom, Inc. All rights reserved.
"
	PRINT GAME-CAPS
	PRINTI " is a trademark of Infocom, Inc.
Release "
	PRINTN V
	PRINTI " / Serial number "
?L1:	IGRTR? 'CNT,23 /?L2
	GETB 0,CNT >STACK
	PRINTC STACK
	JUMP ?L1
?L2:	CRLF
	RTRUE

	.FUNCT V-$0024COMMAND
	DIRIN 1
	RTRUE

	.FUNCT V-$0024RANDOM
	EQUAL? PRSO,INTNUM /?L1
	PRINTR "ILLEGAL."
?L1:	SUB 0,P-NUMBER >STACK
	RANDOM STACK >STACK
	RTRUE

	.FUNCT V-$0024RECORD
	DIROUT D-RECORD-ON
	RTRUE

	.FUNCT V-$0024UNRECORD
	DIROUT D-RECORD-OFF
	RTRUE

	.FUNCT V-$0024VERIFY
	EQUAL? PRSO,INTNUM \?L1
	EQUAL? P-NUMBER,25 \?L1
	PRINTN SERIAL
	CRLF
	RTRUE
?L1:	PRINTI "Verifying."
	CRLF
	VERIFY \?L4
	PRINT OK
	RTRUE
?L4:	CRLF
	PRINTR "** Bad **"

	.FUNCT V-ALARM
	EQUAL? PRSO,ROOMS \?L1
	CALL PERFORM-PRSA,ME
	RTRUE
?L1:	EQUAL? PRSO,ME \?L3
	PRINTI "You pinch yourself. "
	PRINT YOU-ARENT
	PRINTI " dreaming"
	PRINT PCR
	RTRUE
?L3:	FSET? PRSO,DEADBIT /?L4
	FSET? PRSO,ACTORBIT /?L5
	EQUAL? PRSO,CROC \?L4
?L5:	CALL PRONOUN
	PRINTR " isn't asleep."
?L4:	CALL IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-ANSWER-KLUDGE
	CALL NOUN-USED,W?I,ME >STACK
	ZERO? STACK /?L1
	CALL V-INVENTORY >STACK
	RSTACK
?L1:	SET 'P-WON,0
	PRINT NO-VERB
	CALL STOP >STACK
	RSTACK

	.FUNCT V-APPLAUD
	PRINTR "Clap."

	.FUNCT V-ASK-ABOUT,OWINNER
	EQUAL? PRSO,ME \?L1
	CALL PERFORM,V?TELL,ME
	RTRUE
?L1:	FSET? PRSO,ACTORBIT \?L3
	SET 'OWINNER,WINNER
	SET 'WINNER,PRSO
	CALL PERFORM,V?TELL-ABOUT,ME,PRSI
	SET 'WINNER,OWINNER
	CALL THIS-IS-IT,PRSI
	CALL THIS-IS-IT,PRSO
	RTRUE
?L3:	CALL PERFORM,V?TELL,PRSO
	RTRUE

	.FUNCT V-ASK-FOR
	PRINTI "Naturally,"
	CALL TPRINT-PRSO
	PRINTR " doesn't oblige."

	.FUNCT V-ASK-NO-ONE-FOR,ACTOR
	CALL FIND-IN,HERE,ACTORBIT >ACTOR
	ZERO? ACTOR /?L1
	CALL PERFORM,V?ASK-FOR,ACTOR,PRSO
	RTRUE
?L1:	CALL NO-ONE-HERE,STR?112 >STACK
	RSTACK

	.FUNCT V-BITE
	CALL HACK-HACK,STR?113 >STACK
	RSTACK

	.FUNCT V-BLOW
	CALL CANT-VERB-A-PRSO,STR?114 >STACK
	RSTACK

	.FUNCT PRE-BOARD
	IN? PROTAGONIST,PRSO \?L1
	PRINT LOOK-AROUND
	RTRUE
?L1:	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L3
	PRINT HOLDING-IT
	RTRUE
?L3:	CALL UNTOUCHABLE?,PRSO >STACK
	ZERO? STACK /FALSE
	CALL CANT-REACH,PRSO >STACK
	RSTACK

	.FUNCT V-BOARD,AV
	LOC PROTAGONIST >AV
	FSET? PRSO,VEHBIT \?L1
	MOVE PROTAGONIST,PRSO
	PRINTI "You are now "
	FSET? PRSO,INBIT \?L3
	PRINTI "i"
	JUMP ?L5
?L3:	PRINTI "o"
?L5:	PRINTI "n"
	CALL TPRINT-PRSO
	PRINTI "."
	LOC PROTAGONIST >STACK
	GETP STACK,P?ACTION >STACK
	CALL STACK,M-ENTER >STACK
	CRLF
	RTRUE
?L1:	FSET? PRSO,ACTORBIT \?L6
	PRINT POLITE-SOCIETY
	RTRUE
?L6:	GET P-ITBL,P-PREP1 >STACK
	EQUAL? STACK,PR?IN \?L7
	CALL CANT-VERB-A-PRSO,STR?115 >STACK
	RSTACK
?L7:	CALL CANT-VERB-A-PRSO,STR?116 >STACK
	RSTACK

	.FUNCT V-BRIBE
	ZERO? PRSI \?L1
	CALL HELD?,BANKNOTE >STACK
	ZERO? STACK /?L3
	CALL PERFORM,V?GIVE,BANKNOTE,PRSO
	RTRUE
?L3:	PRINTI "A lady bribes only with money"
	PRINT PCR
	RTRUE
?L1:	CALL PERFORM,V?GIVE,PRSI,PRSO
	RTRUE

	.FUNCT V-BURN
	ZERO? PRSI \?L1
	CALL GLOBAL-IN?,FIRE,HERE >STACK
	ZERO? STACK \?L1
	CALL GLOBAL-IN?,TORCH,HERE >STACK
	ZERO? STACK \?L1
	PRINTI "You have no source of fire."
	CRLF
	JUMP ?L3
?L1:	PRINTI "Ladies do not play with fire."
	CRLF
	CALL PRINT-ID,STR?117
	RTRUE
?L3:	FSET? PRSO,WORNBIT \?L4
	PRINTI "Unless you relish a fiery death, you had best remove"
	CALL TRPRINT,PRSO
	CALL PRINT-ID,STR?118 >STACK
	RSTACK
?L4:	EQUAL? PRSO,POWDER \?L6
	PRINTI "Papa says never put "
	PRINTD POWDER
	PRINTI " near a flame."
	CRLF
	CALL PRINT-ID,STR?119 >STACK
	RSTACK
?L6:	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L7
	CALL DO-FIRST,STR?120,PRSO >STACK
	RSTACK
?L7:	FSET? PRSO,ACTORBIT \?L8
	PRINT UNLADY
	RTRUE
?L8:	FSET? PRSO,BURNBIT \?L9
	REMOVE PRSO
	PRINTI "In an instant,"
	CALL TPRINT-PRSO
	PRINTI " is consumed by fire."
	CRLF
	CALL PRINT-ID,STR?121 >STACK
	RSTACK
?L9:	CALL PRINT-ID,STR?122
	CALL CANT-VERB-A-PRSO,STR?123 >STACK
	RSTACK

	.FUNCT V-CHASTISE
	EQUAL? PRSO,INTDIR \?L1
	PRINT YOULL-HAVE-TO
	PRINTI "go in that "
	PRINTD INTDIR
	PRINTR " to see what's there."
?L1:	ZERO? CHASTISED? \?L4
	PRINTI "You may use prepositions to indicate precisely what you want to do: LOOK AT the object, LOOK INSIDE it, LOOK UNDER it, etc. In this case I'll take you to mean LOOK AT the object."
	CRLF
	PRINT INDENT
	SET 'CHASTISED?,1
?L4:	EQUAL? PRSO,ROOMS \?L7
	CALL PERFORM,V?LOOK
	RTRUE
?L7:	CALL PERFORM,V?EXAMINE,PRSO
	RTRUE

	.FUNCT V-CLEAN
	SET 'AWAITING-REPLY,2
	CALL QUEUE,I-REPLY,2
	PRINTR "Do you also do windows?"

	.FUNCT V-CLIMB
	EQUAL? PRSO,INTDIR \?L1
	EQUAL? P-PRSA-WORD,W?CRAWL \?L1
	CALL DO-WALK,P-DIRECTION
	RTRUE
?L1:	EQUAL? PRSO,ROOMS \?L3
	CALL DO-WALK,P?UP >STACK
	RSTACK
?L3:	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L4
	PRINT HOLDING-IT
	RTRUE
?L4:	CALL IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-CLIMB-DOWN
	EQUAL? PRSO,ROOMS \?L1
	CALL DO-WALK,P?DOWN >STACK
	RSTACK
?L1:	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L3
	PRINT HOLDING-IT
	RTRUE
?L3:	CALL IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-CLIMB-ON
	FSET? PRSO,VEHBIT /?L3
	FSET? PRSO,ACTORBIT \?L1
?L3:	CALL PERFORM,V?BOARD,PRSO
	RTRUE
?L1:	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L4
	PRINT HOLDING-IT
	RTRUE
?L4:	GET P-ITBL,P-PREP1 >STACK
	EQUAL? STACK,PR?IN \?L5
	CALL CANT-VERB-A-PRSO,STR?124 >STACK
	RSTACK
?L5:	CALL CANT-VERB-A-PRSO,STR?125 >STACK
	RSTACK

	.FUNCT V-CLIMB-OVER
	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L1
	PRINT HOLDING-IT
	RTRUE
?L1:	CALL IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-CLOSE
	FSET? PRSO,DOORBIT /?L3
	FSET? PRSO,CONTBIT \?L1
?L3:	FSET? PRSO,SURFACEBIT /?L1
	FSET? PRSO,ACTORBIT /?L1
	EQUAL? PRSO,RIGGING-OBJECT,GARTER,CROC /?L1
	CALL OPEN-CLOSE,PRSO >STACK
	RSTACK
?L1:	CALL CANT-VERB-A-PRSO,STR?126 >STACK
	RSTACK

	.FUNCT V-CRAWL-UNDER
	FSET? PRSO,TAKEBIT /?L1
	CALL TELL-HIT-HEAD >STACK
	RSTACK
?L1:	CALL IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-CRY
	CALL NO-TIME-FOR,STR?127 >STACK
	RSTACK

	.FUNCT V-CUT
	ZERO? PRSI /?L3
	EQUAL? PRSI,ROOMS \?L1
?L3:	CALL HELD?,DAGGER >STACK
	ZERO? STACK /?L4
	CALL PERFORM,V?CUT,PRSO,DAGGER
	RTRUE
?L4:	FSET? PRSO,ACTORBIT \?L6
	CALL PERFORM,V?KILL,PRSO
	RTRUE
?L6:	PRINTI "Your fingernails aren't that sharp!"
	CRLF
	CALL IS-OBJECT-OR-PROPERTY? >STACK
	CALL PRINT-ID,STR?128,STACK
	CALL IS-SELF-OR-PART-OF-SELF? >STACK
	CALL PRINT-ID,STR?129,STACK >STACK
	RSTACK
?L1:	PRINTI "To put it bluntly, neither"
	CALL TPRINT-PRSI
	PRINTI " nor you are very sharp"
	PRINT PCR
	CALL IS-OBJECT-OR-PROPERTY? >STACK
	CALL PRINT-ID,STR?130,STACK
	CALL IS-SELF-OR-PART-OF-SELF? >STACK
	CALL PRINT-ID,STR?131,STACK >STACK
	RSTACK

	.FUNCT V-DANCE,OW
	EQUAL? WINNER,PROTAGONIST /?L1
	EQUAL? PRSO,0,ME,PROTAGONIST \?L1
	SET 'OW,WINNER
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?DANCE,OW
	SET 'WINNER,OW
	RTRUE
?L1:	FSET? PRSO,ACTORBIT \?L3
	EQUAL? HERE,BALLROOM,ORCHESTRA /?L4
	PRINTI "This isn't a good place to dance"
	PRINT PCR
	RTRUE
?L4:	PRINTI "It is unlikely"
	CALL TPRINT-PRSO
	PRINTR " would want to dance just now."
?L3:	EQUAL? PRSO,ROOMS,ME \?L7
	ZERO? PARTNER /?L8
	PRINT PACE
	RTRUE
?L8:	PRINTR "One cannot dance the minuet alone."
?L7:	PRINTI "Dancing with"
	CALL APRINT,PRSO
	PRINTR " is an early symptom of the plague."

	.FUNCT V-DISEMBARK
	ZERO? PRSO \?L1
	IN? PROTAGONIST,HERE /?L3
	LOC PROTAGONIST >STACK
	CALL PERFORM-PRSA,STACK
	RTRUE
?L3:	PRINT LOOK-AROUND
	RTRUE
?L1:	EQUAL? P-PRSA-WORD,W?TAKE \?L6
	CALL PERFORM,V?TAKE,PRSO
	RTRUE
?L6:	EQUAL? PRSO,LEDGE \?L7
	EQUAL? HERE,CABIN \?L7
	CALL PERFORM,V?CLIMB-ON,PRSO
	RTRUE
?L7:	IN? PROTAGONIST,PRSO /?L8
	PRINT LOOK-AROUND
	RETURN 8
?L8:	EQUAL? HERE,BY-SHIP,LAGOON \?L11
	CALL V-SWIM >STACK
	RSTACK
?L11:	MOVE PROTAGONIST,HERE
	PRINTI "You"
	IN? HERO,PRSO \?L13
	MOVE HERO,HERE
	PRINTI " and "
	PRINTD HERO
?L13:	PRINTI " get o"
	CALL OFF-VEHICLE?,PRSO >STACK
	ZERO? STACK /?L16
	PRINTI "ff"
	JUMP ?L18
?L16:	PRINTI "ut of"
?L18:	CALL TPRINT-PRSO
	PRINTR "."

	.FUNCT V-DRESS
	ZERO? PRSO /?L1
	FSET? PRSO,ACTORBIT \?L3
	PRINTR "There's no need for that."
?L3:	CALL IMPOSSIBLES >STACK
	RSTACK
?L1:	SET 'PRSO,ROOMS
	CALL V-GET-DRESSED >STACK
	RSTACK

	.FUNCT V-DRINK
	CALL CANT-VERB-A-PRSO,STR?132 >STACK
	RSTACK

	.FUNCT V-DRINK-FROM
	CALL CANT-VERB-A-PRSO,STR?133 >STACK
	RSTACK

	.FUNCT V-DROP
	CALL SPECIAL-DROP >STACK
	ZERO? STACK \FALSE
	LOC PROTAGONIST >STACK
	EQUAL? STACK,SKIFF,CASK \?L3
	LOC PROTAGONIST >STACK
	MOVE PRSO,STACK
	JUMP ?L5
?L3:	MOVE PRSO,HERE
?L5:	PRINTR "Dropped."

	.FUNCT SPECIAL-DROP
	EQUAL? HERE,BOWSPRIT,ON-LADDER \?L1
	REMOVE PRSO
	PRINTI "With a splash,"
	CALL TPRINT-PRSO
	PRINTR " is lost forever."
?L1:	LOC PROTAGONIST >STACK
	EQUAL? STACK,SHALLOWS \?L3
	REMOVE PRSO
	PRINTI "With a plop,"
	CALL TPRINT-PRSO
	PRINTR " is dragged out by a wave."
?L3:	EQUAL? HERE,RIGGING-ROOM /?L5
	EQUAL? HERE,CROWS-NEST \FALSE
	EQUAL? PRSA,V?THROW \FALSE
?L5:	FSET? PRSO,WEARBIT \?L6
	FSET? PRSO,WORNBIT /?L6
	MOVE PRSO,HERE
	PRINTI "Billowing out,"
	CALL TPRINT-PRSO
	PRINTI " catch"
	FSET? PRSO,PLURALBIT /?L8
	PRINTI "es"
?L8:	PRINTI " in"
	CALL TPRINT,RIGGING-OBJECT
	PRINTR " nearby."
?L6:	MOVE PRSO,WHICH-MAST?
	CALL CTPRINT,PRSO
	PRINTR " falls to the deck below."

	.FUNCT V-EAT
	PRINTI "A lady is trained to eat anything, but this is absurd"
	PRINT PCR
	CALL DANGEROUS-FOOD? >STACK
	CALL PRINT-ID,STR?134,STACK >STACK
	RSTACK

	.FUNCT V-EMBRACE
	CALL TOUCHING?,PRSO >STACK
	ZERO? STACK /?L1
	PRINTI "You give"
	CALL TPRINT-PRSO
	PRINTI " a brief embrace"
	FSET? PRSO,ACTORBIT /?L3
	PRINTI " and are not surprised when it doesn't respond"
?L3:	PRINT PCR
	RTRUE
?L1:	IN? PRSO,GLOBAL-OBJECTS \?L6
	CALL IMPOSSIBLES >STACK
	RSTACK
?L6:	CALL CANT-REACH,PRSO >STACK
	RSTACK

	.FUNCT V-EMPTY,OBJ,NXT
	ZERO? PRSI \?L1
	SET 'PRSI,GROUND
?L1:	FSET? PRSO,CONTBIT /?L4
	PRINT HUH
	RTRUE
?L4:	FSET? PRSO,OPENBIT /?L6
	PRINTI "But"
	CALL TPRINT-PRSO
	PRINTR " isn't open."
?L6:	FIRST? PRSO >STACK /?L9
	PRINTI "But"
	CALL TPRINT-PRSO
	PRINTR " is already empty!"
?L9:	EQUAL? PRSI,STACK \?L8
	NEXT? PRSI >STACK /?L8
	PRINT THERES-NOTHING
	PRINTI "in"
	CALL TPRINT-PRSO
	PRINTI " but"
	CALL TRPRINT,PRSI
	RTRUE
?L8:	FIRST? PRSO >OBJ /?L11
?L11:	NEXT? OBJ >NXT /?L14
?L14:	EQUAL? OBJ,PROTAGONIST /?L24
	PRINTD OBJ
	PRINTI ": "
	FSET? OBJ,TAKEBIT \?L17
	MOVE OBJ,PROTAGONIST
	EQUAL? PRSI,HANDS \?L19
	PRINTI "Taken."
	CRLF
	JUMP ?L24
?L19:	EQUAL? PRSI,GROUND \?L21
	CALL PERFORM,V?DROP,OBJ
	JUMP ?L24
?L21:	FSET? PRSI,SURFACEBIT \?L22
	CALL PERFORM,V?PUT-ON,OBJ,PRSI
	JUMP ?L24
?L22:	CALL PERFORM,V?PUT,OBJ,PRSI
	JUMP ?L24
?L17:	CALL WASTES
?L24:	ZERO? NXT /TRUE
	SET 'OBJ,NXT
	JUMP ?L11

	.FUNCT V-EMPTY-FROM
	IN? PRSO,PRSI \?L1
	FSET? PRSO,TAKEBIT \?L3
	MOVE PRSO,PROTAGONIST
	CALL PERFORM,V?DROP,PRSO
	RTRUE
?L3:	CALL WASTES >STACK
	RSTACK
?L1:	CALL NOT-IN >STACK
	RSTACK

	.FUNCT V-ENTER
	FSET? PRSO,DOORBIT \?L1
	CALL OTHER-SIDE,PRSO >STACK
	CALL DO-WALK,STACK
	RTRUE
?L1:	FSET? PRSO,VEHBIT \?L3
	CALL PERFORM,V?BOARD,PRSO
	RTRUE
?L3:	FSET? PRSO,ACTORBIT \?L4
	CALL PERFORM,V?BOARD,PRSO
	RTRUE
?L4:	IN? PRSO,LOCAL-GLOBALS \?L5
	CALL IMPOSSIBLES >STACK
	RSTACK
?L5:	FSET? PRSO,TAKEBIT /?L6
	CALL TELL-HIT-HEAD >STACK
	RSTACK
?L6:	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L7
	PRINT HOLDING-IT
	RTRUE
?L7:	CALL IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-EXAMINE
	FSET? PRSO,ACTORBIT \?L1
	FIRST? PRSO >STACK \?L3
	CALL PERFORM,V?LOOK-INSIDE,PRSO
	RTRUE
?L3:	CALL NOTHING-INTERESTING
	PRINTI "about"
	CALL TRPRINT,PRSO
	RTRUE
?L1:	FSET? PRSO,DOORBIT /?L7
	FSET? PRSO,SURFACEBIT \?L6
?L7:	CALL V-LOOK-INSIDE >STACK
	RSTACK
?L6:	FSET? PRSO,CONTBIT \?L8
	FSET? PRSO,OPENBIT \?L9
	CALL V-LOOK-INSIDE >STACK
	RSTACK
?L9:	PRINTI "It"
	PRINT IS-CLOSED
	PRINT PCR
	RTRUE
?L8:	FSET? PRSO,LIGHTBIT \?L12
	PRINTI "It's o"
	FSET? PRSO,ONBIT \?L13
	PRINTI "n"
	JUMP ?L15
?L13:	PRINTI "ff"
?L15:	PRINT PCR
	RTRUE
?L12:	FSET? PRSO,NARTICLEBIT \?L16
	CALL SENSE-OBJECT,STR?135 >STACK
	RSTACK
?L16:	RANDOM 100 >STACK
	LESS? 25,STACK \?L18
	EQUAL? PRSO,PSEUDO-OBJECT \?L17
?L18:	PRINT COMMON-LOOKING
	PRINTD PRSO
	PRINT PCR
	RTRUE
?L17:	RANDOM 100 >STACK
	LESS? 60,STACK /?L19
	CALL NOTHING-INTERESTING
	PRINTI "about"
	CALL TRPRINT,PRSO
	RTRUE
?L19:	CALL PRONOUN
	PRINTI " look"
	FSET? PRSO,PLURALBIT /?L21
	EQUAL? PRSO,ME /?L21
	PRINTI "s"
?L21:	PRINTI " like every other "
	PRINTD PRSO
	PRINTR " you've ever seen."

	.FUNCT NOTHING-INTERESTING
	PRINT THERES-NOTHING
	RANDOM 100 >STACK
	LESS? 25,STACK /?L1
	PRINTI "unusual"
	JUMP ?L5
?L1:	RANDOM 100 >STACK
	LESS? 33,STACK /?L3
	PRINTI "noteworthy"
	JUMP ?L5
?L3:	RANDOM 100 >STACK
	LESS? 50,STACK /?L4
	PRINTI "extraordinary"
	JUMP ?L5
?L4:	PRINTI "special"
?L5:	PRINTI " "
	RTRUE

	.FUNCT V-EXIT
	ZERO? PRSO /?L1
	FSET? PRSO,VEHBIT \?L1
	CALL PERFORM,V?DISEMBARK,PRSO
	RTRUE
?L1:	CALL IN-EXITABLE-VEHICLE? >STACK
	ZERO? STACK \FALSE
	CALL DO-WALK,P?OUT >STACK
	RSTACK

	.FUNCT IN-EXITABLE-VEHICLE?,AV
	LOC PROTAGONIST >AV
	EQUAL? AV,CASK,SKIFF,LEDGE /?L3
	EQUAL? AV,LAFS-BED,CAPT-BED,COT /?L3
	EQUAL? AV,CABIN-BED \FALSE
?L3:	LOC PROTAGONIST >STACK
	CALL PERFORM,V?DISEMBARK,STACK
	RTRUE

	.FUNCT V-FEED
	CALL MORE-SPECIFIC >STACK
	RSTACK

	.FUNCT V-FIDDLE
	CALL HACK-HACK,STR?136 >STACK
	RSTACK

	.FUNCT V-FILL
	ZERO? PRSI \?L1
	PRINT THERES-NOTHING
	PRINTR "to fill it with."
?L1:	CALL IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-SFILL
	CALL PERFORM,V?FILL,PRSI,PRSO
	RTRUE

	.FUNCT V-FIND,WHERE=0,L
	LOC PRSO >L
	ZERO? L \?L1
	CALL PRONOUN
	PRINTR " could be anywhere!"
?L1:	IN? PRSO,PROTAGONIST \?L3
	PRINTR "You have it!"
?L3:	IN? PRSO,HERE \?L4
	PRINTR "Right in front of you."
?L4:	IN? PRSO,GLOBAL-OBJECTS /?L6
	CALL GLOBAL-IN?,PRSO,HERE >STACK
	ZERO? STACK \?L6
	EQUAL? PRSO,PSEUDO-OBJECT \?L5
?L6:	CALL FIGURE-IT-OUT >STACK
	RSTACK
?L5:	FSET? L,ACTORBIT \?L7
	CALL VISIBLE?,L >STACK
	ZERO? STACK /?L7
	PRINTI "Looks as if"
	CALL TPRINT,L
	PRINTR " has it."
?L7:	FSET? L,CONTBIT \?L8
	CALL VISIBLE?,PRSO >STACK
	ZERO? STACK /?L8
	IN? L,GLOBAL-OBJECTS /?L8
	FSET? L,SURFACEBIT \?L9
	PRINTI "O"
	JUMP ?L12
?L9:	FSET? L,VEHBIT \?L11
	FSET? L,INBIT /?L11
	PRINTI "O"
	JUMP ?L12
?L11:	PRINTI "I"
?L12:	PRINTI "n"
	CALL TRPRINT,L
	RTRUE
?L8:	ZERO? WHERE /?L13
	PRINTR "Beats me."
?L13:	CALL FIGURE-IT-OUT >STACK
	RSTACK

	.FUNCT V-FOLLOW
	CALL VISIBLE?,PRSO >STACK
	ZERO? STACK /?L1
	PRINTI "But"
	CALL TPRINT-PRSO
	PRINTR " is right here!"
?L1:	FSET? PRSO,ACTORBIT /?L3
	CALL IMPOSSIBLES >STACK
	RSTACK
?L3:	PRINTI "You have no idea where"
	CALL TPRINT-PRSO
	PRINTR " is."

	.FUNCT PRE-GIVE,GLASS=0
	FSET? PRSO,DEADBIT \?L1
	EQUAL? PRSI,SALTS /?L1
	PRINTI "It's unlikely"
	CALL TPRINT-PRSO
	PRINTR " will want that."
?L1:	EQUAL? PRSA,V?GIVE \?L3
	EQUAL? PRSO,HANDS \?L3
	CALL PERFORM,V?SHAKE-WITH,PRSI
	RTRUE
?L3:	EQUAL? PRSO,WINE \?L4
	CALL HELD?,BLUE-GLASS >STACK
	ZERO? STACK \?L5
	CALL HELD?,GREEN-GLASS >STACK
	ZERO? STACK /?L4
?L5:	CALL HELD?,BLUE-GLASS >STACK
	ZERO? STACK /?L6
	SET 'GLASS,BLUE-GLASS
	JUMP ?L8
?L6:	CALL HELD?,GREEN-GLASS >STACK
	ZERO? STACK /?L8
	SET 'GLASS,GREEN-GLASS
?L8:	CALL PERFORM-PRSA,GLASS,PRSI
	RTRUE
?L4:	CALL IDROP >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT V-GET-DRESSED
	EQUAL? PRSO,ROOMS \?L1
	CALL MORE-SPECIFIC >STACK
	RSTACK
?L1:	CALL RECOGNIZE >STACK
	RSTACK

	.FUNCT V-GET-DRUNK
	EQUAL? PRSO,ROOMS /?L1
	CALL RECOGNIZE >STACK
	RSTACK
?L1:	SET 'AWAITING-REPLY,2
	CALL QUEUE,I-REPLY,2
	PRINTR "Here?"

	.FUNCT V-GET-UNDRESSED
	EQUAL? PRSO,ROOMS \?L1
	CALL REMOVE-CLOTHES,1 >STACK
	RSTACK
?L1:	CALL RECOGNIZE >STACK
	RSTACK

	.FUNCT REMOVE-CLOTHES,CALLED-BY-GET-UNDRESSED=0,X,N
	ZERO? CALLED-BY-GET-UNDRESSED /?L8
	CALL LAF-DOFF-CHECK >STACK
	ZERO? STACK \TRUE
	PRINTI "You"
	FSET? CHEMISE,EVERYBIT /?L6
	FSET? PANTS,WORNBIT /?L6
	FSET? SHIRT,WORNBIT /?L6
	PRINTR "'re already stripped!"
?L6:	PRINTI " strip down to your chemise"
	PRINT PCR
?L8:	FIRST? PROTAGONIST >X /?L13
	JUMP ?L12
?L10:	ZERO? X /?L12
?L13:	FSET? X,WORNBIT \?L15
	FCLEAR X,WORNBIT
?L15:	NEXT? X >N /?L17
?L17:	SET 'X,N
	JUMP ?L10
?L12:	MOVE RETICULE,PROTAGONIST
	FSET SHOES,WORNBIT
	FSET CHEMISE,WORNBIT
	FCLEAR CHEMISE,EVERYBIT
	SET 'BOY-DRESS?,0
	RTRUE

	.FUNCT V-UNDRESS
	ZERO? PRSO /?L1
	EQUAL? PRSO,DAD \?L3
	SET 'AWAITING-REPLY,2
	CALL QUEUE,I-REPLY,2
	PRINTR "Undress your father?!"
?L3:	EQUAL? PRSO,ME \?L5
	CALL PERFORM,V?GET-UNDRESSED,ROOMS
	RTRUE
?L5:	FSET? PRSO,ACTORBIT \?L6
	FSET? PRSO,FEMALEBIT /?L6
	PRINT MOTHER
	CALL PRINT-ID,STR?137 >STACK
	RSTACK
?L6:	CALL IMPOSSIBLES >STACK
	RSTACK
?L1:	SET 'PRSO,ROOMS
	CALL V-GET-UNDRESSED >STACK
	RSTACK

	.FUNCT V-GIVE
	FSET? PRSI,ACTORBIT \?L1
	FSET? PRSI,DEADBIT \?L3
	PRINT DOESNT-RESPOND
	RTRUE
?L3:	PRINTI "Briskly,"
	CALL TPRINT-PRSI
	PRINTR " refuses your offer."
?L1:	PRINT YOU-CANT
	PRINTI "give"
	CALL APRINT,PRSO
	PRINTI " to"
	CALL APRINT,PRSI
	PRINTR "!"

	.FUNCT V-HELLO
	ZERO? PRSO /?L1
	EQUAL? PRSO,W?SAILOR \?L3
	PRINTI "Nothing happens"
	PRINT PCR
	RTRUE
?L3:	PRINTR "[The proper way to talk to characters in the story is PERSON, HELLO.]"
?L1:	EQUAL? HERE,CABIN \?L6
	IN? HERO,HERE \?L6
	CALL PERFORM,V?HELLO,HERO
	RTRUE
?L6:	CALL PERFORM,V?TELL,ME
	RTRUE

	.FUNCT V-HALT
	EQUAL? PRSO,ROOMS \?L1
	PRINTI "You haven't started"
	PRINT PCR
	RTRUE
?L1:	CALL PROPOSE >STACK
	RSTACK

	.FUNCT V-HELP
	PRINTI "If you're feeling pillaged, maps and hint booklets are available from your dealer, or via mail order with the form"
	CALL IN-PACKAGE >STACK
	RSTACK

	.FUNCT V-HIDE
	PRINT YOU-CANT
	PRINTI "hide "
	ZERO? PRSO /?L1
	PRINTI "t"
?L1:	PRINTR "here."

	.FUNCT V-I-LOVE-YOU
	EQUAL? P-PRSA-WORD,W?I \?L1
	PRINTR "[Why... I'm speechless! Thank you.]"
?L1:	CALL RECOGNIZE >STACK
	RSTACK

	.FUNCT V-IN,VEHICLE
	CALL DO-WALK,P?IN >STACK
	RSTACK

	.FUNCT V-KICK
	FSET? PRSO,ACTORBIT \?L1
	FSET? PRSO,DEADBIT \?L3
	PRINT DOESNT-RESPOND
	CALL PRINT-ID,STR?138 >STACK
	RSTACK
?L3:	PRINTI """Hey! Cut that out!"""
	CRLF
	CALL PRINT-ID,STR?139 >STACK
	RSTACK
?L1:	CALL HACK-HACK,STR?140 >STACK
	RSTACK

	.FUNCT V-KILL
	PRINTI "Relax."
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?141,STACK
	CALL IS-OBJ-PROP-ANIMAL? >STACK
	CALL PRINT-ID,STR?142,STACK
	CALL IS-SELF? >STACK
	CALL PRINT-ID,STR?143,STACK >STACK
	RSTACK

	.FUNCT V-KISS
	PRINTR """Smooch!"""

	.FUNCT V-CURTSEY
	PRINTR "You curtsey gracefully."

	.FUNCT V-KNOCK
	CALL HACK-HACK,STR?144 >STACK
	RSTACK

	.FUNCT V-LAUGH
	PRINTR """Ha-ha."""

	.FUNCT V-LAUNCH
	PRINTR "Your brain is out to launch."

	.FUNCT V-LEAP
	ZERO? PRSO /?L3
	EQUAL? PRSO,ROOMS \?L1
?L3:	EQUAL? HERE,DUNGEON \?L4
	FSET? TRAP,OPENBIT \?L4
	CALL PERFORM,V?ENTER,TRAP
	RTRUE
?L4:	EQUAL? HERE,RIGGING-ROOM,CROWS-NEST,BOWSPRIT \?L6
	PRINT SUICIDE
	RTRUE
?L6:	CALL WHEE >STACK
	RSTACK
?L1:	IN? PRSO,HERE /?L8
	CALL IMPOSSIBLES >STACK
	RSTACK
?L8:	CALL WHEE >STACK
	RSTACK

	.FUNCT V-LEAP-OFF
	FSET? PRSO,VEHBIT \?L1
	CALL PERFORM,V?DISEMBARK,PRSO
	RTRUE
?L1:	CALL SHIP-BOARD,HERE >STACK
	ZERO? STACK /?L3
	PRINT SUICIDE
	CALL PRINT-ID,STR?145 >STACK
	RSTACK
?L3:	CALL PERFORM,V?LEAP,PRSO
	RTRUE

	.FUNCT V-LEAP-OVERBOARD
	CALL SHIP-BOARD,HERE >STACK
	ZERO? STACK /?L1
	PRINT SUICIDE
	CALL PRINT-ID,STR?146 >STACK
	RSTACK
?L1:	CALL IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-LEAVE
	ZERO? PRSO \?L1
	SET 'PRSO,ROOMS
?L1:	EQUAL? PRSO,ROOMS \?L4
	CALL DO-WALK,P?OUT >STACK
	RSTACK
?L4:	IN? PROTAGONIST,PRSO \?L6
	CALL PERFORM,V?DISEMBARK,PRSO
	RTRUE
?L6:	CALL PERFORM,V?DROP,PRSO
	RTRUE

	.FUNCT V-LIE-DOWN
	FSET? PRSO,VEHBIT /?L3
	FSET? PRSO,ACTORBIT \?L1
?L3:	CALL PERFORM,V?BOARD,PRSO
	RTRUE
?L1:	CALL WASTES >STACK
	RSTACK

	.FUNCT V-LISTEN
	CALL RUNNING?,I-LUCY >STACK
	ZERO? STACK /?L1
	CALL PERFORM,V?LISTEN,LUCY
	RTRUE
?L1:	IN? HERO,HERE /?L4
	IN? DAD,HERE /?L4
	IN? LAFOND,HERE /?L4
	IN? COOKIE,HERE \?L3
?L4:	PRINTI "You listen intently"
	PRINT PCR
	RTRUE
?L3:	EQUAL? PRSO,PATROL \?L5
	CALL CTPRINT,PATROL
	PRINTR " confers quietly."
?L5:	CALL RUNNING?,I-PIRATE-RESCUE >STACK
	ZERO? STACK /?L6
	PRINT THE-BALLROOM
	PRINTR "tumult of screams."
?L6:	EQUAL? HERE,ORCHESTRA,BALLROOM,SUPPER-ROOM \?L7
	ZERO? ENDGAME \?L7
	PRINTR "The orchestra plays a sprightly dance tune."
?L7:	ZERO? PRSO /?L8
	CALL SENSE-OBJECT,STR?147 >STACK
	RSTACK
?L8:	PRINTR "You hear nothing of interest."

	.FUNCT PRE-LOCK
	EQUAL? HERE,QUARTERDECK,LANDING \?L1
	EQUAL? P-PRSA-WORD,W?UNBAR /FALSE
?L1:	EQUAL? PRSO,FLOWER \?L3
	EQUAL? PRSA,V?PICK \?L3
	CALL PERFORM,V?TAKE,FLOWER
	RTRUE
?L3:	EQUAL? PRSO,HERO \?L4
	EQUAL? HERE,DUNGEON \?L4
	ZERO? PRSI /?L5
	CALL PERFORM,V?UNLOCK,MANACLES,PRSI
	RTRUE
?L5:	CALL PROPOSE >STACK
	RSTACK
?L4:	FSET? PRSO,LOCKEDBIT /?L20
	EQUAL? PRSA,V?PICK,V?UNLOCK /?L9
	FSET? PRSO,LOCKEDBIT \?L8
?L20:	EQUAL? PRSA,V?LOCK \?L8
?L9:	EQUAL? PRSO,MANACLES \?L11
	PRINT ALREADY-ARE
	RTRUE
?L11:	PRINT ALREADY-IS
	RTRUE
?L8:	ZERO? PRSI \FALSE
	EQUAL? PRSA,V?PICK \?L15
	CALL HELD?,JEWEL >STACK
	ZERO? STACK /?L15
	PRINTI "[with"
	CALL TPRINT,JEWEL
	PRINTI "]"
	CRLF
	CALL PERFORM-PRSA,PRSO,JEWEL >STACK
	RSTACK
?L15:	CALL HELD?,LARGE-KEY >STACK
	ZERO? STACK /?L17
	PRINTI "[with"
	CALL TPRINT,LARGE-KEY
	PRINTI "]"
	CRLF
	CALL PERFORM-PRSA,PRSO,LARGE-KEY >STACK
	RSTACK
?L17:	CALL PROPOSE
	RTRUE

	.FUNCT V-LOOK
	CALL DESCRIBE-ROOM,1 >STACK
	ZERO? STACK /TRUE
	CALL DESCRIBE-OBJECTS
	RTRUE

	.FUNCT V-LOOK-BEHIND
	FSET? PRSO,DOORBIT \?L1
	CALL PERFORM,V?LOOK-INSIDE,PRSO
	RTRUE
?L1:	PRINTI "There is nothing behind"
	CALL TRPRINT,PRSO
	RTRUE

	.FUNCT V-LOOK-DOWN
	EQUAL? PRSO,ROOMS \?L1
	CALL PERFORM,V?EXAMINE,GROUND
	RTRUE
?L1:	CALL PERFORM,V?LOOK-INSIDE,PRSO
	RTRUE

	.FUNCT V-LOOK-INSIDE
	FSET? PRSO,ACTORBIT \?L1
	PRINT IT-SEEMS-THAT
	FSET? PRSO,FEMALEBIT \?L3
	PRINTI " sh"
	JUMP ?L5
?L3:	PRINTI " h"
?L5:	PRINTI "e has"
	CALL DESCRIBE-NOTHING >STACK
	ZERO? STACK \TRUE
	PRINT PCR
	RTRUE
?L1:	IN? PROTAGONIST,PRSO \?L9
	CALL DESCRIBE-VEHICLE >STACK
	RSTACK
?L9:	FSET? PRSO,SURFACEBIT \?L10
	PRINT YOU-SEE
	CALL DESCRIBE-NOTHING >STACK
	ZERO? STACK \TRUE
	PRINTI " on"
	CALL TRPRINT,PRSO
	RTRUE
?L10:	FSET? PRSO,DOORBIT \?L14
	PRINTI "You can only tell that"
	CALL TPRINT-PRSO
	PRINTI " is"
	CALL TELL-OPEN$002fCLOSED,PRSO
	PRINTI ".
"
	RTRUE
?L14:	FSET? PRSO,CONTBIT \?L15
	CALL SEE-INSIDE?,PRSO >STACK
	ZERO? STACK /?L16
	PRINT YOU-SEE
	CALL DESCRIBE-NOTHING >STACK
	ZERO? STACK \TRUE
	PRINTI " in"
	CALL TRPRINT,PRSO
	RTRUE
?L16:	FSET? PRSO,OPENBIT /?L21
	FIRST? PRSO >STACK \?L21
	CALL PRE-TOUCH >STACK
	ZERO? STACK \TRUE
	CALL PERFORM,V?OPEN,PRSO
	RTRUE
?L21:	CALL DO-FIRST,STR?148,PRSO >STACK
	RSTACK
?L15:	GET P-ITBL,P-PREP1 >STACK
	EQUAL? STACK,PR?IN \?L26
	CALL CANT-VERB-A-PRSO,STR?149 >STACK
	RSTACK
?L26:	PRINTI "Even if Queen Augusta commanded it, you couldn't see through that"
	PRINT PCR
	RTRUE

	.FUNCT V-LOOK-UNDER
	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L1
	FSET? PRSO,WORNBIT \?L3
	PRINTR "You're wearing it!"
?L3:	PRINT HOLDING-IT
	RTRUE
?L1:	FSET? PRSO,DOORBIT \?L6
	PRINTR "The space is too narrow to see anything."
?L6:	CALL NOTHING-INTERESTING
	PRINTI "under"
	CALL TRPRINT,PRSO
	RTRUE

	.FUNCT V-LOOK-UP
	EQUAL? PRSO,ROOMS \?L1
	EQUAL? HERE,RIGGING-ROOM,CROWS-NEST \?L3
	PRINT YOU-SEE
	PRINTR " a mess of sails and rope."
?L3:	FSET? HERE,INDOORSBIT \?L5
	CALL PERFORM,V?EXAMINE,CEILING
	RTRUE
?L5:	PRINTR "The midnight sky is clear of all but a full moon."
?L1:	CALL PERFORM,V?LOOK-INSIDE,PRSO
	RTRUE

	.FUNCT V-MAKE-OUT,KISSEE
	EQUAL? PRSO,ROOMS /?L1
	SET 'KISSEE,PRSO
	JUMP ?L3
?L1:	CALL FIND-IN,HERE,ACTORBIT,STR?150 >KISSEE
	ZERO? KISSEE \?L3
	SET 'KISSEE,ME
?L3:	CALL PERFORM,V?KISS,KISSEE
	RTRUE

	.FUNCT V-MARRY
	EQUAL? PRSO,COOKIE,CRULLEY,LAFOND \?L1
	PRINTI "I doubt that"
	CALL TPRINT-PRSO
	PRINTR " is the marrying type."
?L1:	EQUAL? PRSO,DAD \?L3
	PRINTI "Don't be absurd."
	CRLF
	CALL PRINT-ID,STR?151 >STACK
	RSTACK
?L3:	EQUAL? PRSO,HERO \?L4
	CALL LADY-MUST,STR?152 >STACK
	RSTACK
?L4:	CALL WASTES >STACK
	RSTACK

	.FUNCT V-MOVE
	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L1
	CALL WASTES >STACK
	RSTACK
?L1:	CALL LOC-CLOSED >STACK
	ZERO? STACK \TRUE
	FSET? PRSO,TAKEBIT \?L4
	PRINTI "Moving"
	CALL TPRINT-PRSO
	PRINTR " reveals nothing."
?L4:	EQUAL? P-PRSA-WORD,W?PULL \?L5
	CALL HACK-HACK,STR?153 >STACK
	RSTACK
?L5:	CALL CANT-VERB-A-PRSO,STR?154 >STACK
	RSTACK

	.FUNCT V-MUNG
	CALL PRINT-ID,STR?155
	CALL HACK-HACK,STR?156 >STACK
	RSTACK

	.FUNCT V-MUZZLE
	CALL HACK-HACK,STR?157 >STACK
	RSTACK

	.FUNCT V-NO
	EQUAL? AWAITING-REPLY,1,2 \?L1
	CALL V-YES >STACK
	RSTACK
?L1:	EQUAL? AWAITING-REPLY,3 \?L3
	PRINTI "One should hope not! Lafond is too respectable to harbour such secrets"
	PRINT PCR
	RTRUE
?L3:	EQUAL? AWAITING-REPLY,4 \?L4
	PRINTI """Foolish of me to have thought you were serious,"" he smiles, relieved"
	PRINT PCR
	RTRUE
?L4:	EQUAL? AWAITING-REPLY,5 \?L5
	PRINTI """No!"" you say pertly"
	PRINT PCR
	RTRUE
?L5:	EQUAL? AWAITING-REPLY,6 \?L6
	PRINTR "Papa clucks. ""Pity. I'll introduce you to Lucy after we're out of this mess."""
?L6:	EQUAL? AWAITING-REPLY,9 \?L7
	PRINT SHAKE-HEAD
	PRINTR " firmly, ""No."""
?L7:	EQUAL? AWAITING-REPLY,10 \?L8
	PRINT SHAKE-HEAD
	PRINT PCR
	RTRUE
?L8:	EQUAL? AWAITING-REPLY,11 \?L9
	PRINTI """No,"" you say, chin trembling"
	PRINT PCR
	RTRUE
?L9:	EQUAL? AWAITING-REPLY,12 \?L10
	PRINT SHAKE-HEAD
	PRINTR ", teeth clenched."
?L10:	EQUAL? AWAITING-REPLY,13 \?L11
	PRINTR """God's blood! We'll have to find some other way."""
?L11:	EQUAL? AWAITING-REPLY,14 \?L12
	PRINTI """Sorry, but I'm enjoying this dance too much to just let you go."" Jamison tightens his grip on "
	PRINTD HANDS
	PRINTI " as you circle each other"
	PRINT PCR
	RTRUE
?L12:	EQUAL? AWAITING-REPLY,15 \?L13
	PRINT SHAKE-HEAD
	PRINTR " breathlessly."
?L13:	EQUAL? AWAITING-REPLY,16 \?L14
	PRINTR """'Tis a pity. I was hoping..."""
?L14:	EQUAL? AWAITING-REPLY,17 \?L15
	PRINTR """I'll do the hittin' 'ere."""
?L15:	CALL YOU-SOUND,STR?158 >STACK
	RSTACK

	.FUNCT NO-WORD,WRD
	EQUAL? WRD,W?NO,W?NOPE /TRUE
	EQUAL? WRD,W?NAY,W?NEVER \FALSE
	RTRUE

	.FUNCT V-OFF
	FSET? PRSO,LIGHTBIT \?L1
	FSET? PRSO,ONBIT \?L3
	FCLEAR PRSO,ONBIT
	PRINTI "Okay,"
	CALL TPRINT-PRSO
	PRINTR " is now off."
?L3:	PRINTR "It isn't on!"
?L1:	CALL CANT-VERB-A-PRSO,STR?159 >STACK
	RSTACK

	.FUNCT V-ON
	FSET? PRSO,ACTORBIT \?L1
	PRINT HUH
	RTRUE
?L1:	FSET? PRSO,LIGHTBIT \?L3
	FSET? PRSO,ONBIT \?L4
	PRINT ALREADY-IS
	RTRUE
?L4:	FSET PRSO,ONBIT
	PRINTI "Okay,"
	CALL TPRINT-PRSO
	PRINTR " is now on."
?L3:	CALL CANT-VERB-A-PRSO,STR?160 >STACK
	RSTACK

	.FUNCT V-OPEN
	FSET? PRSO,LOCKEDBIT \?L1
	PRINTR "It's quite locked."
?L1:	FSET? PRSO,DOORBIT /?L4
	FSET? PRSO,CONTBIT \?L3
?L4:	FSET? PRSO,SURFACEBIT /?L3
	FSET? PRSO,ACTORBIT /?L3
	CALL OPEN-CLOSE,PRSO >STACK
	RSTACK
?L3:	CALL CANT-VERB-A-PRSO,STR?148 >STACK
	RSTACK

	.FUNCT V-PICK
	FSET? PRSO,DOORBIT \?L1
	CALL HELD?,JEWEL >STACK
	ZERO? STACK /?L1
	PRINTI "That doesn't work here"
	PRINT PCR
	RTRUE
?L1:	CALL CANT-VERB-A-PRSO,STR?161 >STACK
	RSTACK

	.FUNCT V-POINT
	PRINTR "That would be pointless."

	.FUNCT V-SPOINT
	CALL PERFORM,V?POINT,PRSI,PRSO
	RTRUE

	.FUNCT SPECIFY-WHAT,ACTION-STRING,OBJ
	PRINT YOULL-HAVE-TO
	PRINTI "specify what you want to "
	PRINT ACTION-STRING
	CALL TPRINT,OBJ
	PRINTI " in"
	PRINT PCR
	RTRUE

	.FUNCT PRE-POUR
	EQUAL? PRSO,WINE \?L1
	ZERO? PRSI \?L1
	EQUAL? P-PRSA-WORD,W?SPILL /?L1
	CALL SPECIFY-WHAT,STR?162,PRSO >STACK
	RSTACK
?L1:	EQUAL? PRSO,LAUD,BOTTLE \FALSE
	CALL HELD?,PRSO >STACK
	ZERO? STACK \?L4
	PRINT YNH
	CALL TRPRINT,BOTTLE
	RTRUE
?L4:	ZERO? LAUD-LEFT \?L6
	PRINTI "There's no "
	PRINTD LAUD
	PRINTR " left."
?L6:	ZERO? PRSI \?L7
	MOVE BOTTLE,PROTAGONIST
	PRINTI "A bubble of "
	PRINTD LAUD
	PRINTI " forms on the tip of"
	CALL TPRINT,BOTTLE
	PRINTR " then slurps back in."
?L7:	EQUAL? PRSI,WINE \?L8
	PRINT YOULL-HAVE-TO
	PRINTI "specify which glass you want to put"
	CALL TPRINT,LAUD
	PRINTR " into."
?L8:	GETP PRSI,P?CONTENTS >STACK
	EQUAL? STACK,POISONED,W-P \FALSE
	PRINT YOU-HAVE-ALREADY
	PRINTI " dosed"
	CALL TPRINT-PRSI
	PRINTI ". Any more might be dangerous"
	PRINT PCR
	RTRUE

	.FUNCT V-PUSH
	CALL HACK-HACK,STR?163 >STACK
	RSTACK

	.FUNCT V-PUSH-DIR
	EQUAL? PRSI,INTDIR \?L1
	CALL V-PUSH >STACK
	RSTACK
?L1:	CALL RECOGNIZE >STACK
	RSTACK

	.FUNCT PRE-PUT
	EQUAL? PRSI,GROUND \?L1
	CALL PERFORM,V?DROP,PRSO
	RTRUE
?L1:	EQUAL? PRSO,LAUD,WINE \?L3
	CALL PERFORM,V?POUR,PRSO,PRSI
	RTRUE
?L3:	EQUAL? PRSO,HANDS \?L4
	EQUAL? PRSA,V?PUT \?L5
	CALL PERFORM,V?REACH-IN,PRSI
	RTRUE
?L5:	CALL WASTES >STACK
	RSTACK
?L4:	EQUAL? PRSI,SEA \?L8
	EQUAL? HERE,RIGGING-ROOM,CROWS-NEST,BOWSPRIT /?L9
	EQUAL? HERE,POOP,QUARTERDECK,MAIN-DECK /?L9
	EQUAL? HERE,FOCSLE \?L8
?L9:	EQUAL? PRSA,V?PUT-ON,V?DROP,V?THROW /FALSE
	EQUAL? PRSA,V?PUT /FALSE
?L8:	FSET? PRSI,ACTORBIT \?L11
	EQUAL? PRSA,V?PUT-ON /?L11
	CALL WASTES >STACK
	RSTACK
?L11:	CALL HELD?,PRSI,PRSO >STACK
	ZERO? STACK /?L12
	PRINT YOU-CANT
	PRINTI "put"
	CALL TPRINT-PRSO
	GET P-ITBL,P-PREP2 >STACK
	EQUAL? STACK,PR?ON \?L13
	PRINTI " on"
	JUMP ?L15
?L13:	PRINTI " in"
?L15:	CALL TPRINT-PRSI
	PRINTI " when"
	CALL TPRINT-PRSI
	PRINTI " is already "
	FSET? PRSO,SURFACEBIT \?L16
	PRINTI "on"
	JUMP ?L18
?L16:	PRINTI "in"
?L18:	CALL TPRINT-PRSO
	PRINTR "!"
?L12:	CALL HELD?,PRSO >STACK
	ZERO? STACK \?L19
	EQUAL? PRSO,MANACLES /?L19
	PRINT YNH
	CALL TRPRINT,PRSO
	RTRUE
?L19:	CALL UNTOUCHABLE?,PRSI >STACK
	ZERO? STACK /?L20
	CALL CANT-REACH,PRSI >STACK
	RSTACK
?L20:	CALL IDROP >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT V-PUT,?TMP
	FSET? PRSI,OPENBIT /?L1
	FSET? PRSI,CONTBIT /?L1
	FSET? PRSI,SURFACEBIT /?L1
	FSET? PRSI,VEHBIT /?L1
	PRINT YOU-CANT
	PRINTI "put"
	CALL TPRINT-PRSO
	PRINTI " in"
	CALL APRINT,PRSI
	PRINTR "!"
?L1:	EQUAL? PRSI,PRSO /?L4
	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L3
	FSET? PRSO,TAKEBIT /?L3
?L4:	CALL WASTES >STACK
	RSTACK
?L3:	FSET? PRSI,DOORBIT \?L5
	PRINT CANT-FROM-HERE
	RTRUE
?L5:	FSET? PRSI,OPENBIT /?L6
	FSET? PRSI,SURFACEBIT /?L6
	CALL THIS-IS-IT,PRSI
	CALL DO-FIRST,STR?148,PRSI >STACK
	RSTACK
?L6:	IN? PRSO,PRSI \?L7
	PRINTI "But"
	CALL TPRINT-PRSO
	PRINTI " is already in"
	CALL TRPRINT,PRSI
	RTRUE
?L7:	CALL WEIGHT,PRSI >?TMP
	CALL WEIGHT,PRSO >STACK
	ADD ?TMP,STACK >?TMP
	GETP PRSI,P?SIZE >STACK
	SUB ?TMP,STACK >?TMP
	GETP PRSI,P?CAPACITY >STACK
	GRTR? ?TMP,STACK \?L8
	CALL HELD?,PRSO,PRSI >STACK
	ZERO? STACK \?L8
	PRINTI "There's no room "
	FSET? PRSI,SURFACEBIT \?L9
	PRINTI "on"
	JUMP ?L11
?L9:	PRINTI "in"
?L11:	CALL TPRINT-PRSI
	PRINTI " for"
	CALL TRPRINT,PRSO
	RTRUE
?L8:	CALL HELD?,PRSO >STACK
	ZERO? STACK \?L12
	CALL ITAKE,0 >STACK
	EQUAL? STACK,M-FATAL,0 /TRUE
?L12:	MOVE PRSO,PRSI
	FSET PRSO,TOUCHBIT
	PRINTR "Done."

	.FUNCT V-PUT-ON
	EQUAL? PRSI,ME \?L1
	CALL PERFORM,V?WEAR,PRSO
	RTRUE
?L1:	FSET? PRSI,SURFACEBIT \?L3
	CALL V-PUT >STACK
	RSTACK
?L3:	PRINTI "There's no good surface on"
	CALL TRPRINT,PRSI
	RTRUE

	.FUNCT V-PUT-THROUGH
	FSET? PRSI,DOORBIT \?L1
	FSET? PRSI,OPENBIT \?L3
	CALL V-THROW >STACK
	RSTACK
?L3:	CALL DO-FIRST,STR?148,PRSI >STACK
	RSTACK
?L1:	LOC PROTAGONIST >STACK
	EQUAL? PRSI,STACK \?L6
	EQUAL? P-PRSA-WORD,W?THROW,W?TOSS,W?HURL \?L6
	SET 'PRSI,0
	CALL V-THROW >STACK
	RSTACK
?L6:	CALL IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-RAISE
	CALL HACK-HACK,STR?164 >STACK
	RSTACK

	.FUNCT V-RAPE
	PRINT UNLADY
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?165,STACK
	CALL IS-ANIMAL? >STACK
	CALL PRINT-ID,STR?166,STACK >STACK
	RSTACK

	.FUNCT V-REACH-IN,OBJ
	FIRST? PRSO >OBJ /?L1
?L1:	FSET? PRSO,ACTORBIT /?L4
	FSET? PRSO,SURFACEBIT /?L4
	FSET? PRSO,CONTBIT /?L2
?L4:	CALL WASTES >STACK
	RSTACK
?L2:	FSET? PRSO,OPENBIT /?L5
	CALL DO-FIRST,STR?148,PRSO >STACK
	RSTACK
?L5:	ZERO? OBJ /?L7
	FSET? OBJ,INVISIBLE /?L7
	FSET? OBJ,TAKEBIT /?L6
?L7:	PRINT THERES-NOTHING
	PRINTI "in"
	CALL TRPRINT,PRSO
	RTRUE
?L6:	PRINTI "You feel something inside"
	CALL TRPRINT,PRSO
	RTRUE

	.FUNCT V-READ
	CALL CANT-VERB-A-PRSO,STR?167 >STACK
	RSTACK

	.FUNCT V-REFLECT
	EQUAL? PRSO,MOONBEAM \?L1
	EQUAL? PRSI,TRAY,MIRROR \?L1
	EQUAL? HERE,LAFS-ROOM \?L1
	CALL PERFORM,V?SPOINT,SHIP,PRSI
	RTRUE
?L1:	CALL WASTES >STACK
	RSTACK

	.FUNCT V-REMOVE
	FSET? PRSO,WEARBIT \?L1
	IN? PRSO,PROTAGONIST \?L1
	FSET? PRSO,WORNBIT /?L3
	PRINT YOU-ARENT
	PRINTR "wearing that!"
?L3:	CALL LAF-DOFF-CHECK >STACK
	ZERO? STACK \FALSE
	FCLEAR PRSO,WORNBIT
	PRINTI "You remove"
	CALL TRPRINT,PRSO
	RTRUE
?L1:	CALL PERFORM,V?TAKE,PRSO
	RTRUE

	.FUNCT LAF-DOFF-CHECK
	EQUAL? HERE,LAFS-ROOM \FALSE
	IN? LAFOND,HERE \FALSE
	GRTR? LAFOND-CTR,HORNY \?L3
	PRINT THERES-NOTHING
	PRINTR "to remove!"
?L3:	PRINTD LAFOND
	PRINTI " chuckles. ""No, ma cherie, "
	LESS? LAFOND-CTR,3 \?L6
	PRINTR "have some wine first."""
?L6:	PRINTI "I'll do that."""
	CRLF
	SET 'LAFOND-CTR,HORNY
	CALL QUEUE,I-LSED,-1
	RTRUE

	.FUNCT V-RETURN,ACTOR
	ZERO? PRSI \?L1
	CALL FIND-IN,HERE,ACTORBIT,STR?168 >ACTOR
	ZERO? ACTOR /?L3
	CALL PERFORM,V?GIVE,PRSO,ACTOR
	RTRUE
?L3:	CALL NO-ONE-HERE,STR?169 >STACK
	RSTACK
?L1:	FSET? PRSI,ACTORBIT \?L6
	CALL PERFORM,V?GIVE,PRSO,PRSI
	RTRUE
?L6:	CALL PERFORM,V?PUT,PRSO,PRSI
	RTRUE

	.FUNCT V-RIP,?TMP
	EQUAL? PRSO,LETTER,INVITE \?L1
	PRINTI "There's no reason to be so destructive"
	PRINT PCR
	CALL PRINT-ID,STR?170 >STACK
	RSTACK
?L1:	PRINTI "It doesn't tear."
	CRLF
	CALL IS-OBJ-PROP-ANIMAL? >?TMP
	ZERO? ?TMP /?L5
	PUSH ?TMP
	JUMP ?L4
?L5:	CALL IS-PERSON? >STACK
?L4:	CALL PRINT-ID,STR?171,STACK >STACK
	RSTACK

	.FUNCT V-ROLL
	EQUAL? PRSO,EYES \?L1
	PRINTR "You ARE exasperated."
?L1:	CALL UNTOUCHABLE?,PRSO >STACK
	ZERO? STACK /?L3
	CALL CANT-REACH,PRSO >STACK
	RSTACK
?L3:	EQUAL? P-PRSA-WORD,W?TIP \?L4
	EQUAL? PRSO,HEAD \?L5
	CALL V-YES >STACK
	RSTACK
?L5:	CALL PRONOUN
	PRINTR " can't take tips!"
?L4:	PRINTI "A rolling "
	PRINTD PRSO
	PRINTR " gathers no moss."

	.FUNCT V-ROW
	PRINTR "You haven't any oars!"

	.FUNCT V-ROW-DIR
	EQUAL? PRSI,INTDIR \?L1
	CALL V-ROW >STACK
	RSTACK
?L1:	CALL RECOGNIZE >STACK
	RSTACK

	.FUNCT V-ROW-TO
	EQUAL? PRSO,ISLAND /?L3
	EQUAL? PRSO,SKIFF \?L1
	EQUAL? PRSI,ISLAND \?L1
?L3:	SET 'P-DIRECTION,P?WEST
	CALL PERFORM,V?ROW-DIR,SKIFF,INTDIR
	RTRUE
?L1:	EQUAL? PRSO,REEFS,SHIP /?L5
	EQUAL? PRSO,SKIFF \?L4
	EQUAL? PRSI,REEFS,SHIP \?L4
?L5:	SET 'P-DIRECTION,P?EAST
	CALL PERFORM,V?ROW-DIR,SKIFF,INTDIR
	RTRUE
?L4:	LOC PROTAGONIST >STACK
	EQUAL? STACK,SKIFF \?L7
	CALL WASTES >STACK
	RSTACK
?L7:	CALL DO-FIRST,STR?172,SKIFF >STACK
	RSTACK

	.FUNCT V-SAVE-SOMETHING
	CALL PROPOSE >STACK
	RSTACK

	.FUNCT V-SCORE
	PRINTI "In "
	PRINTN MOVES
	PRINTI " turn"
	EQUAL? MOVES,1 /?L1
	PRINTI "s"
?L1:	PRINTI ", you have achieved a score of "
	PRINTN SCORE
	PRINTI " out of 25 points"
	LESS? SCORE,25 \?L11
	PRINTI ". This gives you the rank of "
	LESS? SCORE,5 \?L6
	PRINTI "Damsel in Distress"
	JUMP ?L11
?L6:	LESS? SCORE,10 \?L8
	PRINTI "Missish Minx"
	JUMP ?L11
?L8:	LESS? SCORE,15 \?L9
	PRINTI "Plucky Lass"
	JUMP ?L11
?L9:	LESS? SCORE,20 \?L10
	PRINTI "Daring Demoiselle"
	JUMP ?L11
?L10:	LESS? SCORE,25 \?L11
	PRINTI "Lady Leman"
?L11:	PRINT PCR
	RTRUE

	.FUNCT V-SEARCH
	FSET? PRSO,ACTORBIT \?L1
	CALL V-SHAKE >STACK
	RSTACK
?L1:	IN? PROTAGONIST,PRSO \?L3
	CALL DESCRIBE-VEHICLE >STACK
	RSTACK
?L3:	FSET? PRSO,CONTBIT \?L5
	FSET? PRSO,OPENBIT /?L4
	CALL DO-FIRST,STR?148,PRSO >STACK
	RSTACK
?L4:	FSET? PRSO,CONTBIT \?L5
	PRINTI "You find"
	CALL DESCRIBE-NOTHING >STACK
	ZERO? STACK \TRUE
	PRINT PCR
	RTRUE
?L5:	CALL CANT-VERB-A-PRSO,STR?173 >STACK
	RSTACK

	.FUNCT V-SET
	EQUAL? PRSO,ROOMS \?L1
	CALL WHEE >STACK
	RSTACK
?L1:	ZERO? PRSI \?L3
	FSET? PRSO,TAKEBIT \?L4
	CALL HACK-HACK,STR?174 >STACK
	RSTACK
?L4:	PRINT YNH
	CALL TRPRINT,PRSO
	RTRUE
?L3:	CALL IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-SGIVE
	CALL PERFORM,V?GIVE,PRSI,PRSO
	RTRUE

	.FUNCT V-SHAKE
	FSET? PRSO,ACTORBIT \?L1
	PRINT POLITE
	CALL PRINT-ID,STR?175 >STACK
	RSTACK
?L1:	CALL HACK-HACK,STR?176 >STACK
	RSTACK

	.FUNCT V-SHAKE-WITH
	EQUAL? PRSO,HANDS /?L1
	CALL RECOGNIZE >STACK
	RSTACK
?L1:	FSET? PRSI,ACTORBIT /?L3
	PRINTI "I don't think"
	CALL TPRINT-PRSI
	PRINTR " even has hands."
?L3:	CALL PERFORM,V?THANK,PRSI
	RTRUE

	.FUNCT V-SHOOT
	ZERO? PRSI \?L1
	CALL HELD?,PISTOL >STACK
	ZERO? STACK /?L3
	CALL PERFORM,V?SHOOT,PRSO,PISTOL
	RTRUE
?L3:	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?177,STACK
	CALL IS-OBJ-PROP-ANIMAL? >STACK
	CALL PRINT-ID,STR?178,STACK
	CALL IS-SELF? >STACK
	CALL PRINT-ID,STR?179,STACK
	CALL PROPOSE >STACK
	RSTACK
?L1:	PRINTI "Don't ever bother applying for a job as a gunswoman."
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?180,STACK
	CALL IS-OBJ-PROP-ANIMAL? >STACK
	CALL PRINT-ID,STR?181,STACK
	CALL IS-SELF? >STACK
	CALL PRINT-ID,STR?182,STACK >STACK
	RSTACK

	.FUNCT PRE-SSHOOT
	EQUAL? PRSO,CANNON /FALSE
	CALL HELD?,PRSO >STACK
	ZERO? STACK \FALSE
	ZERO? PRSI \?L4
	CALL HELD?,PISTOL >STACK
	ZERO? STACK \?L5
	CALL PROPOSE >STACK
	RSTACK
?L5:	CALL PERFORM,V?SHOOT,PRSO
	RTRUE
?L4:	PRINT YNH
	CALL TRPRINT,PRSO
	RTRUE

	.FUNCT V-SSHOOT
	CALL PERFORM,V?SHOOT,PRSI,PRSO
	RTRUE

	.FUNCT V-SHOW
	PRINT DOESNT-LOOK
	CALL TPRINT-PRSI
	PRINTR " is interested."

	.FUNCT V-SHUT-UP
	EQUAL? PRSO,ROOMS \?L1
	PRINTR "[I hope you're not addressing me...]"
?L1:	CALL PERFORM,V?CLOSE,PRSO
	RTRUE

	.FUNCT V-SIGH
	PRINTR "You sigh contentedly, smiling."

	.FUNCT V-SIT,VEHICLE
	CALL FIND-IN,HERE,VEHBIT >VEHICLE
	ZERO? VEHICLE /?L1
	CALL PERFORM,V?BOARD,VEHICLE
	RTRUE
?L1:	CALL WASTES >STACK
	RSTACK

	.FUNCT V-SLEEP
	CALL QUEUED?,I-SLEEP >STACK
	ZERO? STACK /?L1
	CALL I-SLEEP >STACK
	RSTACK
?L1:	PRINTR "You're not tired."

	.FUNCT V-SMELL
	ZERO? PRSO /?L1
	PRINTI "Smells like any other "
	PRINTD PRSO
	PRINT PCR
	RTRUE
?L1:	LOC PROTAGONIST >STACK
	EQUAL? STACK,CASK \?L3
	PRINTI "You recoil from the taint of rancid meat"
	PRINT PCR
	CALL PRINT-ID,STR?183 >STACK
	RSTACK
?L3:	EQUAL? HERE,FOCSLE,GALLEY \?L4
	PRINTR "The odor of old grease and char does not improve your appetite."
?L4:	EQUAL? HERE,CABIN \?L5
	PRINTI "The odors of charred wood, sea salt and blood burn your nose"
	PRINT PCR
	RTRUE
?L5:	EQUAL? HERE,CREWS-QUARTERS \?L6
	PRINTR "Close quarters, indeed."
?L6:	PRINTI "Nothing smells unusual"
	PRINT PCR
	RTRUE

	.FUNCT V-SOAK
	ZERO? PRSI \?L1
	CALL SPECIFY-WHAT,STR?184,PRSO >STACK
	RSTACK
?L1:	CALL IMPOSSIBLES >STACK
	RSTACK

	.FUNCT SENSE-OBJECT,STRING
	CALL PRONOUN
	PRINTI " "
	PRINT STRING
	FSET? PRSO,PLURALBIT /?L1
	EQUAL? PRSO,ME /?L1
	PRINTI "s"
?L1:	PRINTI " just like"
	CALL ARPRINT,PRSO
	RTRUE

	.FUNCT V-SPUT-ON
	CALL PERFORM,V?PUT-ON,PRSI,PRSO
	RTRUE

	.FUNCT V-SSHOW
	CALL PERFORM,V?SHOW,PRSI,PRSO
	RTRUE

	.FUNCT V-STAND
	EQUAL? P-PRSA-WORD,W?HOLD \?L1
	CALL WASTES >STACK
	RSTACK
?L1:	LOC PROTAGONIST >STACK
	FSET? STACK,VEHBIT \?L3
	LOC PROTAGONIST >STACK
	CALL PERFORM,V?DISEMBARK,STACK
	RTRUE
?L3:	ZERO? PRSO /?L4
	FSET? PRSO,TAKEBIT \?L4
	CALL WASTES >STACK
	RSTACK
?L4:	EQUAL? HERE,IN-HEDGE,BY-HOUSE,SLEEPING-CUPBOARD \?L5
	PRINTR "There's not enough room for even your petite frame to stand straight."
?L5:	PRINT YOU-ARE-ALREADY
	PRINTR "standing."

	.FUNCT V-STELL
	CALL PERFORM,V?TELL,PRSI
	RTRUE

	.FUNCT V-STHROW
	CALL PERFORM,V?THROW-TO,PRSI,PRSO
	RTRUE

	.FUNCT V-FIX
	EQUAL? PRSO,DAGGER \?L1
	CALL REPERTOIRE,STR?185 >STACK
	RSTACK
?L1:	PRINTI "But"
	CALL TPRINT-PRSO
	PRINTI " isn't "
	EQUAL? P-PRSA-WORD,W?SHARPEN,W?WHET \?L4
	PRINTI "dull"
	JUMP ?L6
?L4:	PRINTI "broken"
?L6:	PRINTR "!"

	.FUNCT V-SWIM
	EQUAL? PRSO,SEA /?L3
	ZERO? PRSO \?L1
	CALL GLOBAL-IN?,SEA,HERE >STACK
	ZERO? STACK /?L1
?L3:	CALL REPERTOIRE,STR?186 >STACK
	RSTACK
?L1:	PRINTR "Your head must be swimming."

	.FUNCT V-SWING
	ZERO? PRSI /?L1
	CALL PERFORM,V?KILL,PRSI,PRSO
	RTRUE
?L1:	EQUAL? PRSO,ROOMS \?L3
	EQUAL? HERE,GALLERY \?L3
	CALL PERFORM,V?SWING,ROPE
	RTRUE
?L3:	CALL WHEE >STACK
	RSTACK

	.FUNCT V-SWOON
	PRINTI "You've never been missish enough to faint on demand"
	PRINT PCR
	RTRUE

	.FUNCT V-SWRAP
	CALL PERFORM,V?WRAP,PRSI,PRSO
	RTRUE

	.FUNCT PRE-TAKE
	CALL LOC-CLOSED >STACK
	ZERO? STACK \TRUE
	IN? PROTAGONIST,PRSO \?L3
	PRINTI "You're "
	FSET? PRSO,INBIT \?L4
	PRINTI "i"
	JUMP ?L6
?L4:	PRINTI "o"
?L6:	PRINTR "n it!"
?L3:	GRTR? LAFOND-CTR,HORNY \?L7
	EQUAL? HERE,LAFS-ROOM \?L7
	IN? HERE,LAFOND /FALSE
?L7:	IN? PRSO,PROTAGONIST /?L9
	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L8
	FSET? PRSO,TAKEBIT /?L8
?L9:	FSET? PRSO,WORNBIT \?L10
	PRINT YOU-ARE-ALREADY
	PRINTI "wearing"
	JUMP ?L12
?L10:	PRINT YOU-HAVE-ALREADY
?L12:	CALL TRPRINT,PRSO
	RTRUE
?L8:	EQUAL? PRSO,LAUD \?L13
	EQUAL? PRSI,BOTTLE /?L13
	CALL WASTES >STACK
	RSTACK
?L13:	ZERO? PRSI /FALSE
	IN? PRSO,PRSI /FALSE
	CALL NOT-IN >STACK
	RSTACK

	.FUNCT V-TAKE
	CALL ITAKE >STACK
	EQUAL? STACK,1 \FALSE
	PRINTI "Taken."
	CRLF
	CALL IS-THEFT? >STACK
	CALL PRINT-ID,STR?187,STACK >STACK
	RSTACK

	.FUNCT V-TAKE-OFF
	FSET? PRSO,WORNBIT \?L1
	CALL PERFORM,V?REMOVE,PRSO
	RTRUE
?L1:	FSET? PRSO,VEHBIT \?L3
	CALL PERFORM,V?DISEMBARK,PRSO
	RTRUE
?L3:	PRINT YOU-ARENT
	PRINTI "wearing"
	CALL TRPRINT,PRSO
	RTRUE

	.FUNCT V-TAKE-WITH
	PRINTI "Sorry,"
	CALL TPRINT-PRSI
	PRINTI " is no help in getting"
	CALL TRPRINT,PRSO
	RTRUE

	.FUNCT V-TELL
	FSET? PRSO,ACTORBIT \?L1
	EQUAL? PRSO,CROC /?L1
	FSET? PRSO,DEADBIT \?L3
	PRINT DOESNT-RESPOND
	CALL STOP >STACK
	RSTACK
?L3:	ZERO? P-CONT /?L5
	SET 'WINNER,PRSO
	SET 'CLOCK-WAIT,1
	RTRUE
?L5:	PRINTI "Hmmm ..."
	CALL TPRINT-PRSO
	PRINTR " looks at you expectantly, as if you seemed to be about to talk."
?L1:	CALL CANT-VERB-A-PRSO,STR?188
	CALL STOP >STACK
	RSTACK

	.FUNCT V-TELL-ABOUT
	EQUAL? PRSO,ME \?L1
	CALL PERFORM,V?WHAT,PRSI
	RTRUE
?L1:	CALL PERFORM,V?SHOW,PRSI,PRSO
	RTRUE

	.FUNCT V-THANK
	ZERO? PRSO \?L1
	PRINTR "[Just doing my job.]"
?L1:	FSET? PRSO,ACTORBIT \?L3
	PRINTR """You're welcome."""
?L3:	CALL IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-THROW-AT
	CALL PERFORM,V?MUNG,PRSI,PRSO
	RTRUE

	.FUNCT V-THROW
	CALL SPECIAL-DROP >STACK
	ZERO? STACK \FALSE
	EQUAL? HERE,LAGOON,BY-SHIP,SHALLOWS \?L3
	CALL PERFORM,V?PUT,PRSO,SEA
	RTRUE
?L3:	ZERO? PRSI /?L5
	MOVE PRSO,HERE
	PRINTR "You missed."
?L5:	MOVE PRSO,HERE
	PRINTR "Thrown."

	.FUNCT V-THROW-OVER
	MOVE PRSO,HERE
	PRINTR "You missed."

	.FUNCT V-THROW-OVERBOARD
	EQUAL? HERE,LAGOON,SHALLOWS /?L3
	CALL SHIP-BOARD,HERE >STACK
	ZERO? STACK /?L1
?L3:	CALL PERFORM,V?PUT,PRSO,SEA
	RTRUE
?L1:	PRINTR "One normally tries this on a boat."

	.FUNCT V-THROW-TO
	FSET? PRSI,ACTORBIT \?L1
	CALL PERFORM,V?GIVE,PRSO,PRSI
	RTRUE
?L1:	CALL PERFORM,V?THROW,PRSO,PRSI
	RTRUE

	.FUNCT V-TIE-WITH
	CALL PERFORM,V?TIE,PRSI,PRSO
	RTRUE

	.FUNCT PRE-TOUCH
	EQUAL? PRSA,V?LOWER,V?RAISE \?L1
	EQUAL? PRSI,0,ROOMS /?L1
	CALL RECOGNIZE >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?TOUCH \?L3
	EQUAL? PRSO,COOKIE \?L3
	EQUAL? PRSI,DAGGER \?L3
	PRINT UNLADY
	RTRUE
?L3:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L4
	EQUAL? PRSO,CABIN-BED,COT,DIVAN /?L5
	EQUAL? PRSO,GUEST-BED,LAFS-BED,CAPT-BED \?L4
?L5:	CALL CANT-VERB-A-PRSO,STR?189 >STACK
	RSTACK
?L4:	EQUAL? PRSO,LINE \?L6
	EQUAL? PRSA,V?TOUCH \?L6
	LOC PROTAGONIST >STACK
	EQUAL? STACK,CASK \?L6
	PRINTI "Your fingers just brush"
	CALL TRPRINT,LINE
	RTRUE
?L6:	CALL UNTOUCHABLE?,PRSO >STACK
	ZERO? STACK /?L7
	CALL CANT-REACH,PRSO >STACK
	RSTACK
?L7:	EQUAL? PRSA,V?EMPTY \?L8
	EQUAL? PRSO,RUM-BARREL,WATER-BARREL /FALSE
	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L12
	CALL TAKE-CHECK >STACK
	ZERO? STACK \FALSE
?L12:	PRINT YNH
	CALL TRPRINT,PRSO
	RETURN 8
?L8:	EQUAL? PRSA,V?EMPTY-FROM \FALSE
	EQUAL? PRSI,RUM-BARREL,WATER-BARREL /FALSE
	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L17
	CALL TAKE-CHECK >STACK
	ZERO? STACK \FALSE
?L17:	PRINT YNH
	CALL TRPRINT,PRSO
	RETURN 8

	.FUNCT V-TOUCH
	CALL LOC-CLOSED >STACK
	ZERO? STACK \TRUE
	CALL HACK-HACK,STR?190 >STACK
	RSTACK

	.FUNCT V-STOUCH
	CALL PERFORM,V?TOUCH,PRSI,PRSO
	RTRUE

	.FUNCT V-UNLOCK
	ZERO? PRSI /?L1
	CALL IMPOSSIBLES >STACK
	RSTACK
?L1:	FSET? PRSO,LOCKEDBIT \?L3
	SET 'AWAITING-REPLY,2
	CALL QUEUE,I-REPLY,2
	PRINTR "Your nose is key-shaped, I suppose?"
?L3:	FSET? PRSO,DOORBIT \?L4
	PRINTI "But"
	CALL TPRINT-PRSO
	PRINTR " isn't locked."
?L4:	CALL WASTES >STACK
	RSTACK

	.FUNCT V-WALK,AV,VEHICLE,PT,PTS,STR,OBJ,RM
	LOC PROTAGONIST >AV
	ZERO? P-WALK-DIR \?L1
	CALL PERFORM,V?WALK-TO,PRSO
	RTRUE
?L1:	EQUAL? PRSO,P?OUT \?L3
	CALL IN-EXITABLE-VEHICLE? >STACK
	ZERO? STACK \TRUE
?L3:	EQUAL? PRSO,P?IN \?L4
	GETPT HERE,P?IN >STACK
	ZERO? STACK \?L4
	CALL FIND-IN,HERE,VEHBIT >VEHICLE
	ZERO? VEHICLE /?L4
	CALL HELD?,VEHICLE >STACK
	ZERO? STACK \?L4
	CALL PERFORM,V?BOARD,VEHICLE
	RTRUE
?L4:	GETPT HERE,PRSO >PT
	ZERO? PT /?L5
	PTSIZE PT >PTS
	EQUAL? PTS,UEXIT \?L6
	GETB PT,REXIT >STACK
	CALL GOTO,STACK >STACK
	RSTACK
?L6:	EQUAL? PTS,NEXIT \?L8
	GET PT,NEXITSTR >STACK
	PRINT STACK
	CRLF
	RETURN 8
?L8:	EQUAL? PTS,FEXIT \?L11
	GET PT,FEXITFCN >STACK
	CALL STACK >RM
	ZERO? RM /?L12
	EQUAL? RM,ROOMS /TRUE
	CALL GOTO,RM >STACK
	RSTACK
?L12:	RETURN 8
?L11:	EQUAL? PTS,CEXIT \?L20
	GETB PT,CEXITFLAG >STACK
	VALUE STACK >STACK
	ZERO? STACK /?L21
	GETB PT,REXIT >STACK
	CALL GOTO,STACK >STACK
	RSTACK
?L21:	GET PT,CEXITSTR >STR
	ZERO? STR /?L23
	PRINT STR
	CRLF
	RETURN 8
?L23:	PRINT CANT-GO
	RETURN 8
?L20:	EQUAL? PTS,DEXIT \FALSE
	GETB PT,DEXITOBJ >OBJ
	FSET? OBJ,OPENBIT \?L30
	GETB PT,REXIT >STACK
	CALL GOTO,STACK >STACK
	RSTACK
?L30:	GET PT,DEXITSTR >STR
	ZERO? STR /?L32
	CALL THIS-IS-IT,OBJ
	PRINT STR
	CRLF
	RETURN 8
?L32:	CALL THIS-IS-IT,OBJ
	CALL DO-FIRST,STR?148,OBJ
	RETURN 8
?L5:	EQUAL? PRSO,P?IN,P?OUT \?L40
	CALL V-WALK-AROUND
	RETURN 8
?L40:	PRINT CANT-GO
	RETURN 8

	.FUNCT V-WAVE,AT-OBJ=0
	PRINTI "You wave"
	ZERO? AT-OBJ \?L1
	CALL PRSO-PRINT
	PRINTI " in the air"
	PRINT PCR
	RTRUE
?L1:	PRINTI " cheerfully at"
	CALL TRPRINT,PRSO
	RTRUE

	.FUNCT V-WAVE-AT
	CALL V-WAVE,1
	RTRUE

	.FUNCT V-WRING
	ZERO? PRSI \?L1
	EQUAL? PRSO,DRESS \?L6
	ZERO? WET-DRESS \?L5
?L6:	EQUAL? PRSO,RAG \?L3
	ZERO? WET-RAG /?L3
?L5:	PRINTR "You don't have time to dry it."
?L3:	EQUAL? P-PRSA-WORD,W?DRY \?L7
	PRINTR "That isn't wet!"
?L7:	CALL WASTES >STACK
	RSTACK
?L1:	EQUAL? PRSI,RAG,DRESS \?L9
	CALL PERFORM,V?WRING,PRSI
	RTRUE
?L9:	CALL WASTES >STACK
	RSTACK

	.FUNCT V-WALK-AROUND
	SET 'AWAITING-REPLY,2
	CALL QUEUE,I-REPLY,2
	PRINTI "Did you have any particular "
	PRINTD INTDIR
	PRINTR " in mind?"

	.FUNCT V-WALK-TO
	EQUAL? PRSO,INTDIR \?L1
	CALL DO-WALK,P-DIRECTION >STACK
	RSTACK
?L1:	CALL V-WALK-AROUND >STACK
	RSTACK

	.FUNCT V-WAIT,NUM=3
	PRINTI "Time passes..."
	CRLF
?L1:	DLESS? 'NUM,0 /?L2
	CALL CLOCKER >STACK
	ZERO? STACK /?L1
?L2:	SET 'CLOCK-WAIT,1
	RETURN CLOCK-WAIT

	.FUNCT PRE-DOFF
	CALL NOUN-USED,W?DECK,GROUND >STACK
	ZERO? STACK /?L1
	EQUAL? HERE,DEUX-DECK /?L3
	CALL SHIP-BOARD,HERE >STACK
	ZERO? STACK /?L1
?L3:	CALL V-WALK-AROUND
	RTRUE
?L1:	ZERO? PRSO /?L4
	EQUAL? PRSA,V?UNDRESS /FALSE
?L4:	CALL CHECK-STRIP >STACK
	ZERO? STACK \TRUE
	EQUAL? HERE,LAFS-ROOM /FALSE
	EQUAL? HERE,ANTEROOM \?L6
	IN? DAD,HERE \FALSE
?L6:	CALL FIND-IN,HERE,ACTORBIT,STR?191 >STACK
	ZERO? STACK \?L9
	EQUAL? HERE,ORCHESTRA,SUPPER-ROOM,BALLROOM \?L8
?L9:	PRINT POLITE-SOCIETY
	RTRUE
?L8:	EQUAL? HERE,ANTEROOM \?L10
	LOC COOKIE >STACK
	LOC DAD >STACK
	EQUAL? HERE,STACK,STACK \FALSE
?L10:	EQUAL? PRSO,0,RETICULE /FALSE
	FSET? PRSO,WORNBIT /FALSE
	FSET? PRSO,WEARBIT \FALSE
	FSET? PRSO,WORNBIT /FALSE
	PRINTI "You're not wearing"
	CALL TPRINT-PRSO
	PRINTR "!"

	.FUNCT PRE-WEAR
	FSET? PRSO,WEARBIT /?L1
	CALL CANT-VERB-A-PRSO,STR?192 >STACK
	RSTACK
?L1:	FSET? PRSO,WORNBIT \?L3
	PRINT YOU-ARE-ALREADY
	PRINTI "wearing"
	CALL TPRINT-PRSO
	PRINTR "!"
?L3:	CALL CHECK-STRIP >STACK
	ZERO? STACK \TRUE
	CALL RUNNING?,I-LSED >STACK
	ZERO? STACK /?L5
	LOC LAFOND >STACK
	EQUAL? STACK,HERE \?L5
	PRINTD LAFOND
	PRINTR " prevents you."
?L5:	ZERO? ENDGAME \FALSE
	EQUAL? HERE,FOYER,BALLROOM,SUPPER-ROOM /?L7
	EQUAL? HERE,ORCHESTRA \FALSE
?L7:	PRINTR "People might notice."

	.FUNCT CHECK-STRIP
	EQUAL? HERE,CABIN \?L1
	PRINTI "With pirates attacking?! "
	PRINT MOTHER
	RTRUE
?L1:	EQUAL? HERE,ON-LADDER,RIGGING-ROOM \?L3
	PRINT YOU-CANT
	PRINTI "manage the fastenings while whipping to and fro "
	EQUAL? HERE,ON-LADDER \?L4
	PRINTI "on"
	CALL ARPRINT,LADDER
	RTRUE
?L4:	PRINTI "in"
	CALL TRPRINT,RIGGING-OBJECT
	RTRUE
?L3:	EQUAL? HERE,IN-HEDGE,BY-HOUSE \FALSE
	PRINT YOU-CANT
	PRINTR "even stand straight, much less change clothes!"

	.FUNCT V-WEAR
	MOVE PRSO,PROTAGONIST
	FSET PRSO,WORNBIT
	PRINTI "You're now wearing"
	CALL TRPRINT,PRSO
	RTRUE

	.FUNCT V-WHAT
	PRINTR "Good question."

	.FUNCT V-WHERE
	CALL V-FIND,1 >STACK
	RSTACK

	.FUNCT V-YELL
	EQUAL? HERE,GALLERY,DEUX-DECK \?L1
	PRINTI "Although your voice is quite piercing, no one notices you."
	CRLF
	JUMP ?L4
?L1:	EQUAL? HERE,CABIN \?L3
	PRINT HELP-SCREAM
	CRLF
	JUMP ?L4
?L3:	PRINTI "Papa always says, ""Action, not reaction, girl!"""
	CRLF
?L4:	CALL STOP >STACK
	RSTACK

	.FUNCT I-REPLY
	SET 'AWAITING-REPLY,0
	RFALSE

	.FUNCT V-YES
	EQUAL? AWAITING-REPLY,1 \?L1
	PRINTI "That wasn't a yes or no question"
	PRINT PCR
	RTRUE
?L1:	EQUAL? AWAITING-REPLY,2 \?L3
	PRINTR "That was just a rhetorical question."
?L3:	EQUAL? AWAITING-REPLY,3 \?L4
	PRINTR "Whither goes a will, goes a way."
?L4:	EQUAL? AWAITING-REPLY,4 \?L5
	REMOVE HERO
	CALL STOP-QUEUES
	PRINTR "Silently he drops your arm and retreats. You are alone."
?L5:	EQUAL? AWAITING-REPLY,5 \?L6
	PRINTR "You nod tentatively."
?L6:	EQUAL? AWAITING-REPLY,6 \?L7
	PRINTI """Quite a girl, isn't she? You two will be great friends,"" he says"
	PRINT PCR
	RTRUE
?L7:	EQUAL? AWAITING-REPLY,9 \?L8
	PRINTI "You have no breath to speak. You nod once, never taking "
	PRINTD EYES
	PRINTI " off Nicholas Jamison"
	PRINT PCR
	RTRUE
?L8:	EQUAL? AWAITING-REPLY,10 \?L9
	PRINTR "You nod eagerly."
?L9:	EQUAL? AWAITING-REPLY,11 \?L10
	PRINTR "You summon a gracious smile, ""Why yes, I'd love to."""
?L10:	EQUAL? AWAITING-REPLY,12 \?L11
	PRINTI "You nod"
	PRINT PCR
	RTRUE
?L11:	EQUAL? AWAITING-REPLY,13 \?L12
	PRINTI "Nicholas pulls forward a fettered wrist"
	PRINT PCR
	RTRUE
?L12:	EQUAL? AWAITING-REPLY,14 \?L13
	PRINTI "Jamison grins at you"
	PRINT PCR
	RTRUE
?L13:	EQUAL? AWAITING-REPLY,15 \?L14
	PRINTI "Breathless, eager, you lean into him"
	PRINT PCR
	RTRUE
?L14:	EQUAL? AWAITING-REPLY,16 \?L15
	PRINTR "Your father twinkles, ""Good! He's of good family, you know."""
?L15:	EQUAL? AWAITING-REPLY,17 \?L16
	PRINTR """Har, just you try!"""
?L16:	CALL YOU-SOUND,STR?193 >STACK
	RSTACK

	.FUNCT YOU-SOUND,STRING
	PRINTI "You sound rather "
	PRINT STRING
	PRINTR "tive."

	.FUNCT YES-WORD,WRD
	EQUAL? WRD,W?YES,W?Y,W?YUP /TRUE
	EQUAL? WRD,W?OK,W?OKAY,W?SURE \FALSE
	RTRUE

	.FUNCT ITAKE,VB=1,OBJ,?TMP
	FSET? PRSO,TAKEBIT /?L1
	ZERO? VB /?L3
	CALL WASTES
?L3:	RETURN 8
?L1:	CALL PRE-TOUCH >STACK
	ZERO? STACK /?L8
	RETURN 8
?L8:	CALL HELD?,PRSO >STACK
	ZERO? STACK \?L11
	CALL WEIGHT,PRSO >?TMP
	CALL WEIGHT,PROTAGONIST >STACK
	ADD ?TMP,STACK >STACK
	GRTR? STACK,110 \?L11
	ZERO? VB /?L12
	PRINTI "It's too heavy, considering your current load."
	CRLF
?L12:	RETURN 8
?L11:	CALL CCOUNT,PROTAGONIST >STACK
	GRTR? STACK,12 \?L17
	ZERO? VB /?L18
	PRINT YOU-ARE-ALREADY
	PRINTI "juggling as many items as you can possibly carry."
	CRLF
?L18:	RETURN 8
?L17:	FSET PRSO,TOUCHBIT
	FCLEAR PRSO,NDESCBIT
	IN? PROTAGONIST,PRSO /FALSE
	MOVE PRSO,PROTAGONIST
	RTRUE

	.FUNCT IDROP
	EQUAL? PRSO,HANDS \?L1
	EQUAL? PRSA,V?GIVE,V?THROW,V?DROP \FALSE
	CALL IMPOSSIBLES >STACK
	RSTACK
?L1:	EQUAL? PRSO,RETICULE \?L6
	EQUAL? PRSA,V?GIVE,V?THROW,V?DROP \FALSE
	PRINTR "A lady is never without her reticule."
?L6:	EQUAL? PRSO,ME \?L10
	EQUAL? PRSA,V?PUT \?L10
	FSET? PRSI,ACTORBIT \?L10
	CALL PERFORM,V?BOARD,PRSI
	RTRUE
?L10:	EQUAL? PRSI,ME \?L11
	EQUAL? PRSA,V?PUT \?L11
	FSET? PRSO,ACTORBIT \?L11
	CALL PERFORM,V?BOARD,PRSO
	RTRUE
?L11:	EQUAL? PRSO,SPICES /?L13
	EQUAL? PRSO,PINCH \?L12
?L13:	CALL HELD?,PINCH >STACK
	ZERO? STACK \FALSE
?L12:	CALL HELD?,PRSO >STACK
	ZERO? STACK \?L14
	EQUAL? PRSO,ME /?L17
	FSET? PRSO,BODYBIT \?L15
?L17:	CALL IMPOSSIBLES
	RETURN 8
?L15:	PRINT YNH
	CALL TRPRINT,PRSO
	RETURN 8
?L14:	IN? PRSO,PROTAGONIST /?L21
	LOC PRSO >STACK
	FSET? STACK,CONTBIT \?L21
	LOC PRSO >STACK
	FSET? STACK,OPENBIT /?L21
	LOC PRSO >STACK
	CALL DO-FIRST,STR?148,STACK >STACK
	RSTACK
?L21:	FSET? PRSO,WORNBIT \FALSE
	CALL DO-FIRST,STR?194,PRSO >STACK
	RSTACK

	.FUNCT CCOUNT,OBJ,CNT=0,X
	FIRST? OBJ >X \?L4
?L3:	FSET? X,WORNBIT /?L5
	INC 'CNT
?L5:	NEXT? X >X /?L3
?L4:	RETURN CNT

	.FUNCT WEIGHT,OBJ,CONT,WT=0
	FIRST? OBJ >CONT \?L4
?L3:	CALL WEIGHT,CONT >STACK
	ADD WT,STACK >WT
	NEXT? CONT >CONT /?L3
?L4:	GETP OBJ,P?SIZE >STACK
	ADD WT,STACK >STACK
	RSTACK

	.FUNCT DESCRIBE-ROOM,VERB-IS-LOOK=0,FIRST-VISIT=0,NUM=0
	ZERO? LIT \?L1
	PRINT TOO-DARK
	CRLF
	RFALSE
?L1:	FSET? HERE,TOUCHBIT /?L4
	FSET HERE,TOUCHBIT
	SET 'FIRST-VISIT,1
?L4:	PRINTD HERE
	LOC PROTAGONIST >STACK
	FSET? STACK,VEHBIT \?L7
	PRINTI ", "
	LOC PROTAGONIST >STACK
	FSET? STACK,INBIT \?L9
	PRINTI "i"
	JUMP ?L11
?L9:	PRINTI "o"
?L11:	PRINTI "n"
	LOC PROTAGONIST >STACK
	CALL TPRINT,STACK
?L7:	CRLF
	ZERO? VERB-IS-LOOK \?L15
	EQUAL? VERBOSITY,2 /?L15
	ZERO? FIRST-VISIT /TRUE
	EQUAL? VERBOSITY,1 \TRUE
?L15:	PRINT INDENT
	GETP HERE,P?ACTION >STACK
	CALL STACK,M-LOOK >STACK
	ZERO? STACK \?L16
	GETP HERE,P?LDESC >STACK
	PRINT STACK
?L16:	CRLF
	RTRUE

	.FUNCT DESCRIBE-OBJECTS,O,STR,1ST?=1,AV
	LOC WINNER >AV
	FIRST? HERE >O \FALSE
?L7:	CALL DESCRIBABLE?,O >STACK
	ZERO? STACK /?L9
	FSET? O,TOUCHBIT /?L9
	GETP O,P?FDESC >STR
	ZERO? STR /?L9
	PRINT INDENT
	PRINT STR
	FSET? O,CONTBIT \?L10
	CALL DESCRIBE-CONTENTS,O,1,3
?L10:	CRLF
?L9:	NEXT? O >O /?L7
	FIRST? HERE >O /?L15
?L15:	SET '1ST?,1
	ZERO? O /?L17
?L18:	CALL DESCRIBABLE?,O >STACK
	ZERO? STACK /?L26
	GETP O,P?FDESC >STACK
	ZERO? STACK /?L20
	FSET? O,TOUCHBIT \?L26
?L20:	GETP O,P?DESCFCN >STR
	ZERO? STR /?L22
	CALL STR,M-OBJDESC >STR
	ZERO? STR /?L22
	FSET? O,CONTBIT \?L23
	EQUAL? STR,M-FATAL /?L23
	CALL DESCRIBE-CONTENTS,O,1,3
?L23:	CRLF
	JUMP ?L26
?L22:	GETP O,P?LDESC >STR
	ZERO? STR /?L26
	PRINT INDENT
	PRINT STR
	FSET? O,CONTBIT \?L27
	CALL DESCRIBE-CONTENTS,O,1,3
?L27:	CRLF
?L26:	NEXT? O >O /?L18
?L17:	CALL DESCRIBE-CONTENTS,HERE,0,0
	ZERO? AV /FALSE
	EQUAL? HERE,AV /FALSE
	CALL DESCRIBE-CONTENTS,AV,0,0 >STACK
	RSTACK

	.FUNCT DESCRIBE-CONTENTS,OBJ,LEVEL=-1,ALL?=D-ALL?,F=0,N,1ST?=1,IT?=0,TWO?=0,START?=0,PARA?=0,DB
	EQUAL? LEVEL,2 \?L1
	SET 'LEVEL,1
	SET 'PARA?,1
	SET 'START?,1
	JUMP ?L3
?L1:	BTST ALL?,D-PARA? \?L3
	SET 'PARA?,1
?L3:	FIRST? OBJ >N /?L5
?L5:	ZERO? START? \?L10
	IN? OBJ,ROOMS /?L10
	FSET? OBJ,ACTORBIT /?L10
	ZERO? N /FALSE
	FSET? OBJ,CONTBIT \FALSE
	FSET? OBJ,OPENBIT /?L9
	FSET? OBJ,TRANSBIT \FALSE
?L9:	EQUAL? LEVEL,-1 /?L10
	FSET? OBJ,SEARCHBIT \FALSE
?L10:	ZERO? N /?L16
?L89:	CALL DESCRIBABLE?,N >STACK
	ZERO? STACK /?L13
	BTST ALL?,D-ALL? /?L16
	CALL SIMPLE-DESC?,N >STACK
	ZERO? STACK /?L13
?L16:	ZERO? F /?L43
	ZERO? 1ST? /?L19
	SET '1ST?,0
	EQUAL? LEVEL,0,1 \?L21
	ZERO? START? \?L36
	ZERO? PARA? \?L25
	EQUAL? OBJ,PROTAGONIST /?L27
	PRINT INDENT
?L27:	SET 'PARA?,1
	JUMP ?L30
?L25:	EQUAL? LEVEL,1 \?L30
	PRINTI " "
?L30:	CALL DESCRIBE-START,OBJ
	JUMP ?L36
?L21:	EQUAL? LEVEL,-1 /?L36
	PRINT LEVEL
	JUMP ?L36
?L19:	ZERO? N /?L35
	PRINTI ","
	JUMP ?L36
?L35:	PRINTI " and"
?L36:	CALL APRINT,F
	FSET? F,ONBIT \?L37
	PRINTI " (providing light)"
	JUMP ?L39
?L37:	EQUAL? F,RETICULE \?L39
	PRINTI " (hanging from your wrist)"
?L39:	ZERO? IT? \?L41
	ZERO? TWO? \?L41
	SET 'IT?,F
	JUMP ?L43
?L41:	SET 'TWO?,1
	SET 'IT?,0
?L43:	SET 'F,N
?L13:	ZERO? N /?L48
	NEXT? N >N /?L48
?L48:	ZERO? F \?L10
	ZERO? N \?L89
	ZERO? IT? /?L52
	ZERO? TWO? \?L52
	CALL THIS-IS-IT,IT?
?L52:	ZERO? 1ST? /?L87
	ZERO? START? /?L55
	PRINTI " nothing"
	RFALSE
?L55:	ZERO? 1ST? \?L12
?L87:	EQUAL? LEVEL,0,1 \?L67
	EQUAL? OBJ,HERE \?L58
	PRINTI " here"
?L58:	PRINTI "."
?L12:	EQUAL? LEVEL,0,1 \?L67
	FIRST? OBJ >F \?L67
?L68:	FSET? F,CONTBIT \?L70
	CALL DESCRIBABLE?,F,1 >STACK
	ZERO? STACK /?L70
	BTST ALL?,D-ALL? /?L71
	CALL SIMPLE-DESC?,F >STACK
	ZERO? STACK /?L70
?L71:	SET 'DB,D-BIT
	SET 'D-BIT,0
	ZERO? PARA? /?L74
	PUSH 3
	JUMP ?L76
?L74:	PUSH D-ALL?
?L76:	CALL DESCRIBE-CONTENTS,F,1,STACK >STACK
	ZERO? STACK /?L72
	SET '1ST?,0
	SET 'PARA?,1
?L72:	SET 'D-BIT,DB
?L70:	NEXT? F >F /?L68
?L67:	ZERO? 1ST? \FALSE
	EQUAL? LEVEL,0,1 \?L81
	LOC WINNER >STACK
	EQUAL? OBJ,HERE,STACK \?L81
	CRLF
?L81:	ZERO? 1ST? \FALSE
	RTRUE

	.FUNCT DESCRIBE-START,OBJ
	EQUAL? OBJ,HERE \?L1
	PRINT YOU-SEE
	RTRUE
?L1:	EQUAL? OBJ,PROTAGONIST \?L3
	EQUAL? D-BIT,WORNBIT \?L4
	PRINTI " You are wearing"
	RTRUE
?L4:	PRINTI "You have"
	RTRUE
?L3:	FSET? OBJ,SURFACEBIT \?L7
	PRINTI "Sitting on"
	CALL TPRINT,OBJ
	PRINTI " is"
	RTRUE
?L7:	FSET? OBJ,ACTORBIT \?L8
	EQUAL? OBJ,CROC /?L8
	EQUAL? OBJ,LUCY \?L9
	PRINTI "Sh"
	JUMP ?L11
?L9:	PRINTI "H"
?L11:	PRINTI "e has"
	RTRUE
?L8:	EQUAL? OBJ,FENCE,BOTTLE,HORN /TRUE
	PRINT IT-SEEMS-THAT
	CALL TPRINT,OBJ
	PRINTI " contains"
	RTRUE

	.FUNCT DESCRIBABLE?,OBJ,CONT?=0
	FSET? OBJ,INVISIBLE /FALSE
	EQUAL? OBJ,WINNER /FALSE
	LOC WINNER >STACK
	EQUAL? OBJ,STACK \?L4
	LOC WINNER >STACK
	EQUAL? HERE,STACK \FALSE
?L4:	ZERO? CONT? \?L5
	FSET? OBJ,NDESCBIT /FALSE
?L5:	ZERO? D-BIT /TRUE
	GRTR? D-BIT,0 \?L7
	FSET? OBJ,D-BIT \FALSE
	RTRUE
?L7:	SUB 0,D-BIT >STACK
	FSET? OBJ,STACK /FALSE
	RTRUE

	.FUNCT SIMPLE-DESC?,OBJ,STR
	GETP OBJ,P?FDESC >STACK
	ZERO? STACK /?L1
	FSET? OBJ,TOUCHBIT \FALSE
?L1:	GETP OBJ,P?DESCFCN >STR
	ZERO? STR /?L3
	CALL STR,M-DESC? >STACK
	ZERO? STACK \FALSE
?L3:	GETP OBJ,P?LDESC >STACK
	ZERO? STACK /TRUE
	RFALSE

	.FUNCT DESCRIBE-VEHICLE
	PRINTI "Other than "
	PRINTD ME
	PRINTI ", you can see"
	CALL DESCRIBE-NOTHING >STACK
	ZERO? STACK \TRUE
	FSET? PRSO,INBIT \?L3
	PRINTI " in"
	JUMP ?L5
?L3:	PRINTI " on"
?L5:	CALL TRPRINT,PRSO
	RTRUE

	.FUNCT DESCRIBE-NOTHING
	CALL DESCRIBE-CONTENTS,PRSO,2 >STACK
	ZERO? STACK /FALSE
	IN? PROTAGONIST,PRSO /TRUE
	CRLF
	RTRUE

	.FUNCT GOTO,NEW-LOC,DONT-DESCRIBE-DAD=0,OLD-HERE
	SET 'OLD-HERE,HERE
	MOVE PROTAGONIST,NEW-LOC
	IN? NEW-LOC,ROOMS \?L1
	SET 'HERE,NEW-LOC
	JUMP ?L3
?L1:	LOC NEW-LOC >HERE
?L3:	CALL LIT?,HERE >LIT
	EQUAL? OLD-HERE,LIBRARY \?L4
	CALL HELD?,HAT >STACK
	ZERO? STACK /?L4
	EQUAL? HERE,BY-HOUSE,HALL-E \?L4
	CALL SAFETY-SAKE
	CRLF
?L4:	GETP HERE,P?ACTION >STACK
	CALL STACK,M-ENTER >STACK
	EQUAL? HERE,PASSAGE-4 \?L7
	IN? DAD,HERE \?L7
	PRINTI """What a brave tot! You've inherited all your mother's spirit."" Your father beams with pride"
	PRINT PCR
	CRLF
	JUMP ?L13
?L7:	EQUAL? HERE,BOTTOM-STAIRS \?L9
	IN? COOKIE,ANTEROOM \?L9
	SET 'COOKIE-FIGHTING-CROC,0
	FCLEAR CROC,NDESCBIT
	PRINTI """I ain't goin' to fight this beast if you're headin' back upstairs."""
	CALL TPRINT,COOKIE
	IN? RAPIER,PROTAGONIST \?L10
	MOVE RAPIER,COOKIE
	PRINTI " eyes"
	CALL TPRINT,RAPIER
	PRINTI " in"
	CALL TPRINT,HANDS
	PRINTI ". ""Not a proper thing fer a lady,"" he grumbles, taking it from you. He"
?L10:	PRINTI " follows you"
	PRINT PCR
	CRLF
	JUMP ?L13
?L9:	EQUAL? HERE,LAGOON /TRUE
?L13:	CALL DESCRIBE-ROOM >STACK
	ZERO? STACK /?L15
	ZERO? VERBOSITY /?L15
	CALL DESCRIBE-OBJECTS
?L15:	IN? DAD,OLD-HERE \?L18
	IN? PROTAGONIST,HERE \?L18
	ZERO? DONT-DESCRIBE-DAD \?L18
	ZERO? ENDGAME \?L18
	CALL DAD-FOLLOWS-YOU
?L18:	IN? HERO,OLD-HERE \?L26
	IN? PROTAGONIST,HERE \?L26
	ZERO? ENDGAME \?L38
	EQUAL? HERE,BALLROOM \?L23
	EQUAL? PARTNER,HERO \?L23
	MOVE HERO,HERE
	PRINTD HERO
	PRINTI " smiles and follows you, pulling you onto"
	PRINT DANCE-FLOOR
	PRINT PCR
	JUMP ?L26
?L23:	EQUAL? OLD-HERE,BALLROOM \?L25
	MOVE HERO,HERE
	RTRUE
?L25:	CALL STOP-QUEUES
	REMOVE HERO
	PRINT INDENT
	PRINTI """No, wait -- !"" Jamison cries. He "
	EQUAL? HERE,LAWN \?L27
	PRINTI "slips past you into the forest"
	JUMP ?L29
?L27:	PRINTI "hesitates and turns away"
?L29:	PRINT PCR
?L26:	ZERO? ENDGAME /TRUE
?L38:	IN? COOKIE,OLD-HERE \TRUE
	IN? PROTAGONIST,HERE \TRUE
	ZERO? COOKIE-FIGHTING-CROC \TRUE
	CALL RUNNING?,I-ENDGAME >STACK
	ZERO? STACK \TRUE
	CALL RUNNING?,I-DUEL >STACK
	ZERO? STACK /?L33
	EQUAL? OLD-HERE,GALLERY,STAIRTOP /TRUE
?L33:	EQUAL? HERE,BEACH /TRUE
	MOVE COOKIE,HERE
	PRINT INDENT
	PRINTD COOKIE
	PRINTI " pegs after you"
	PRINT PCR
	RTRUE

	.FUNCT SAFETY-SAKE
	MOVE HAT,LIBRARY
	FCLEAR HAT,WORNBIT
	FSET HAT,EVERYBIT
	FCLEAR KNOB,EVERYBIT
	FSET KNOB,DEADBIT
	PRINTI "For safety's sake, you leave"
	CALL TPRINT,HAT
	PRINTI " on its knob. Best not to show that you've been wandering"
	PRINT PCR
	RTRUE

	.FUNCT DAD-FOLLOWS-YOU
	EQUAL? HERE,CELL-4 \?L1
	PRINTR "Your father chuckles in the darkness of the passageway, ""No dear, I'm not going in there again!"""
?L1:	LOC PROTAGONIST >STACK
	MOVE DAD,STACK
	PRINT INDENT
	PRINTI "Papa "
	CALL PICK-ONE,FOLLOWS >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT JIGS-UP,DESC
	PRINT DESC
	PRINT YOU-DIED
	CALL FINISH >STACK
	RSTACK

	.FUNCT H-JIGS-UP,DESC,DAD-DEAD=0
	PRINT DESC
	PRINT YOU-DIED
	PRINT INDENT
	ZERO? DAD-DEAD /?L1
	PRINTI "Troubled by Papa's death, caused by your own unthinking pride, your life loses meaning. You die by your own hand, in grief and shame."
	JUMP ?L3
?L1:	PRINTI "Rather, your flesh is intact, but your spirit has flown with the death of your heart's love. The years pass, unnoticed, twisting you into an old and ugly spinster, that dies alone, loved by no one."
?L3:	CRLF
	CALL FINISH >STACK
	RSTACK

	.FUNCT FWTD,DESC
	PRINT DESC
	CRLF
	CRLF
	PRINTI "  ***     You have suffered
       a fate worse than death  ***"
	CRLF
	CALL FINISH >STACK
	RSTACK

	.FUNCT ACCESSIBLE?,OBJ,L
	ZERO? OBJ /FALSE
	LOC OBJ >L
	FSET? OBJ,INVISIBLE /FALSE
	EQUAL? OBJ,PSEUDO-OBJECT \?L6
	EQUAL? LAST-PSEUDO-LOC,HERE \FALSE
	RTRUE
?L6:	ZERO? L /FALSE
	EQUAL? L,GLOBAL-OBJECTS /TRUE
	EQUAL? L,LOCAL-GLOBALS \?L12
	CALL GLOBAL-IN?,OBJ,HERE >STACK
	ZERO? STACK \TRUE
?L12:	CALL META-LOC,OBJ >STACK
	EQUAL? STACK,HERE \FALSE
	EQUAL? L,WINNER,HERE /TRUE
	FSET? L,OPENBIT \FALSE
	CALL ACCESSIBLE?,L >STACK
	ZERO? STACK /FALSE
	RTRUE

	.FUNCT VISIBLE?,OBJ,L
	ZERO? OBJ /FALSE
	LOC OBJ >L
	CALL ACCESSIBLE?,OBJ >STACK
	ZERO? STACK \TRUE
	CALL SEE-INSIDE?,L >STACK
	ZERO? STACK /FALSE
	CALL VISIBLE?,L >STACK
	ZERO? STACK /FALSE
	RTRUE

	.FUNCT UNTOUCHABLE?,OBJ
	ZERO? OBJ /FALSE
	EQUAL? OBJ,SEA \?L3
	EQUAL? HERE,LAGOON,SHALLOWS,MAIN-DECK /FALSE
	EQUAL? HERE,BEACH \TRUE
	RFALSE
?L3:	EQUAL? OBJ,LADDER \?L8
	LOC PROTAGONIST >STACK
	EQUAL? STACK,LEDGE /FALSE
?L8:	IN? PROTAGONIST,HERE /FALSE
	LOC PROTAGONIST >STACK
	CALL HELD?,OBJ,STACK >STACK
	ZERO? STACK \FALSE
	LOC PROTAGONIST >STACK
	EQUAL? OBJ,STACK /FALSE
	IN? OBJ,GLOBAL-OBJECTS \TRUE
	RFALSE

	.FUNCT META-LOC,OBJ
?L1:	ZERO? OBJ /FALSE
	IN? OBJ,GLOBAL-OBJECTS \?L5
	RETURN GLOBAL-OBJECTS
?L5:	IN? OBJ,ROOMS \?L7
	RETURN OBJ
?L7:	LOC OBJ >OBJ
	JUMP ?L1

	.FUNCT OTHER-SIDE,DOBJ,P=0,TEE
?L1:	NEXTP HERE,P >P
	LESS? P,P?OUT /FALSE
	GETPT HERE,P >TEE
	PTSIZE TEE >STACK
	EQUAL? STACK,DEXIT \?L1
	GETB TEE,DEXITOBJ >STACK
	EQUAL? STACK,DOBJ \?L1
	RETURN P

	.FUNCT HELD?,OBJ,CONT=0
	ZERO? CONT \?L1
	SET 'CONT,WINNER
?L1:	ZERO? OBJ /FALSE
	IN? OBJ,CONT /TRUE
	IN? OBJ,ROOMS /FALSE
	LOC OBJ >STACK
	CALL HELD?,STACK,CONT >STACK
	RSTACK

	.FUNCT SEE-INSIDE?,OBJ
	ZERO? OBJ /FALSE
	FSET? OBJ,INVISIBLE /FALSE
	FSET? OBJ,TRANSBIT /TRUE
	FSET? OBJ,OPENBIT /TRUE
	RFALSE

	.FUNCT GLOBAL-IN?,OBJ1,OBJ2,TEE
	GETPT OBJ2,P?GLOBAL >TEE
	ZERO? TEE /FALSE
	PTSIZE TEE >STACK
	DEC 'STACK
	CALL ZMEMQB,OBJ1,TEE,STACK >STACK
	RSTACK

	.FUNCT FIND-IN,WHERE,FLAG-IN-QUESTION,STRING=0,OBJ,RECURSIVE-OBJ
	FIRST? WHERE >OBJ \FALSE
?L2:	FSET? OBJ,FLAG-IN-QUESTION \?L7
	FSET? OBJ,INVISIBLE /?L7
	ZERO? STRING /?L9
	PRINTI "["
	PRINT STRING
	CALL TPRINT,OBJ
	PRINTI "]"
	CRLF
?L9:	RETURN OBJ
?L7:	CALL FIND-IN,OBJ,FLAG-IN-QUESTION >RECURSIVE-OBJ
	ZERO? RECURSIVE-OBJ /?L12
	RETURN RECURSIVE-OBJ
?L12:	NEXT? OBJ >OBJ /?L2
	RFALSE

	.FUNCT LOC-CLOSED,L
	LOC PRSO >L
	FSET? L,CONTBIT \FALSE
	FSET? L,OPENBIT /FALSE
	FSET? PRSO,TAKEBIT \FALSE
	CALL DO-FIRST,STR?148,L >STACK
	RSTACK

	.FUNCT DO-WALK,DIR
	SET 'P-WALK-DIR,DIR
	CALL PERFORM,V?WALK,DIR >STACK
	RSTACK

	.FUNCT STOP
	SET 'P-CONT,0
	SET 'QUOTE-FLAG,0
	RETURN 8

	.FUNCT ANYTHING-HELD,SOMETHING-HELD=0,N,X
	FIRST? PROTAGONIST >X /?L4
	RETURN SOMETHING-HELD
?L1:	ZERO? X /?L3
?L4:	FSET? X,WORNBIT /?L7
	EQUAL? X,RETICULE /?L7
	SET 'SOMETHING-HELD,1
?L7:	NEXT? X >N /?L10
?L10:	SET 'X,N
	JUMP ?L1
?L3:	RETURN SOMETHING-HELD

	.FUNCT ROB,WHO,WHERE=0,N,X
	FIRST? WHO >X /?L4
	JUMP ?L3
?L1:	ZERO? X /?L3
?L4:	NEXT? X >N /?L7
?L7:	FSET? X,WORNBIT /?L12
	EQUAL? X,PINCH /?L12
	ZERO? WHERE /?L10
	MOVE X,WHERE
	JUMP ?L12
?L10:	REMOVE X
?L12:	SET 'X,N
	JUMP ?L1
?L3:	MOVE RETICULE,PROTAGONIST
	RTRUE

	.FUNCT HACK-HACK,STR
	PRINT STR
	CALL TPRINT-PRSO
	CALL HO-HUM >STACK
	RSTACK

	.FUNCT HO-HUM
	CALL PICK-ONE,HO-HUM-LIST >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT IMPOSSIBLES
	CALL PICK-ONE,IMPOSSIBLE-LIST >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT WASTES
	CALL PICK-ONE,WASTE-LIST >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT INTDIR-F
	EQUAL? PRSA,V?ROW-TO,V?ROW,V?ROW-DIR \FALSE
	IN? PROTAGONIST,SKIFF \FALSE
	EQUAL? P-DIRECTION,P?EAST \?L3
	EQUAL? HERE,BY-SHIP \?L5
	PRINTI "That would take you past"
	CALL TPRINT,SHIP
	PRINTR " into the open sea!"
?L5:	SET 'ROWING,ROWEAST
	PRINT DIPPING-OARS
	PRINTD SKIFF
	PRINTI " plows through the lagoon."
	EQUAL? HERE,SHALLOWS \?L8
	CALL QUEUE,I-CURRENT,-1
	SET 'ROWING,1
	MOVE SKIFF,LAGOON
	CRLF
	CALL GOTO,SKIFF >STACK
	RSTACK
?L8:	ADD SHIP-LOC,1 >STACK
	ADD SKIFF-LOC,ROWING >STACK
	EQUAL? STACK,SHIP-LOC,STACK \?L10
	FSET? SHIP,MUNGBIT \?L11
	CALL PRINT-ID,STR?195
	CALL JIGS-UP,STR?196 >STACK
	RSTACK
?L11:	PRINTI " You glide into the shadow of"
	CALL TRPRINT,SHIP
	CRLF
	SET 'SKIFF-LOC,SHIP-LOC
	SET 'ROWING,0
	MOVE SKIFF,BY-SHIP
	CALL GOTO,SKIFF >STACK
	RSTACK
?L10:	CRLF
	RTRUE
?L3:	EQUAL? P-DIRECTION,P?WEST \?L15
	SET 'ROWING,ROWWEST
	EQUAL? HERE,SHALLOWS \?L16
	PRINTI "You can row"
	CALL TPRINT,SKIFF
	PRINTI " no farther west"
	PRINT PCR
	RTRUE
?L16:	ADD SKIFF-LOC,ROWING >STACK
	LESS? STACK,2 \?L18
	PRINT DIPPING-OARS
	PRINTD SKIFF
	PRINTI " noses into the sand of the shallows. You get out"
	PRINT PCR
	CRLF
	CALL DEQUEUE,I-CURRENT
	SET 'SKIFF-LOC,1
	MOVE SKIFF,SHALLOWS
	CALL GOTO,SHALLOWS
	RTRUE
?L18:	PRINT DIPPING-OARS
	PRINTD SKIFF
	PRINTI " shoots over the waves"
	PRINT PCR
	EQUAL? HERE,BY-SHIP \TRUE
	MOVE SKIFF,LAGOON
	CALL GOTO,SKIFF
	RTRUE
?L15:	EQUAL? P-DIRECTION,P?NORTH,P?NW,P?NE /?L24
	EQUAL? P-DIRECTION,P?SOUTH,P?SW,P?SE \FALSE
?L24:	PRINTR "You can barely row back and forth, much less side to side!"

	.FUNCT MAN-F,PERSON
	EQUAL? PRSO,ME \?L1
	EQUAL? PRSA,V?TAKE-WITH \?L1
	CALL RECOGNIZE >STACK
	RSTACK
?L1:	CALL NOUN-USED,W?SAILOR,MAN >STACK
	ZERO? STACK /?L3
	EQUAL? PRSA,V?HELLO \?L3
	CALL GLOBAL-IN?,CREW,HERE >STACK
	ZERO? STACK /?L4
	CALL PERFORM,V?HELLO,CREW
	RTRUE
?L4:	PRINTR "Nothing happens here."
?L3:	GET P-NAMW,0 >STACK
	EQUAL? STACK,W?MAN \?L7
	EQUAL? PRSO,MAN \?L7
	CALL ADJ-USED,A?BEWIGGED >STACK
	ZERO? STACK /?L8
	CALL PERFORM-PRSA,LAFOND,PRSI >STACK
	RSTACK
?L8:	CALL NOUN-USED,W?MEN,MAN >STACK
	ZERO? STACK /?L10
	EQUAL? HERE,BALLROOM,ORCHESTRA,SUPPER-ROOM /?L10
	CALL MORE-SPECIFIC >STACK
	RSTACK
?L10:	CALL FIND-MAN >PERSON
	ZERO? PERSON /?L11
	CALL PERFORM-PRSA,PERSON,PRSI
	RTRUE
?L11:	CALL CANT-SEE,MAN >STACK
	RSTACK
?L7:	GET P-NAMW,1 >STACK
	EQUAL? STACK,W?MAN \FALSE
	EQUAL? PRSI,MAN \FALSE
	CALL ADJ-USED,A?BEWIGGED >STACK
	ZERO? STACK /?L14
	CALL PERFORM-PRSA,PRSO,LAFOND >STACK
	RSTACK
?L14:	CALL NOUN-USED,W?MEN,MAN >STACK
	ZERO? STACK /?L16
	EQUAL? HERE,BALLROOM,ORCHESTRA,SUPPER-ROOM /?L16
	CALL MORE-SPECIFIC >STACK
	RSTACK
?L16:	CALL FIND-MAN >PERSON
	ZERO? PERSON /?L17
	CALL PERFORM-PRSA,PRSO,PERSON
	RTRUE
?L17:	CALL CANT-SEE,MAN >STACK
	RSTACK

	.FUNCT FIND-MAN
	IN? HERO,HERE \?L1
	RETURN HERO
?L1:	IN? LAFOND,HERE \?L3
	RETURN LAFOND
?L3:	IN? DAD,HERE \?L4
	RETURN DAD
?L4:	IN? CRULLEY,HERE \?L5
	RETURN CRULLEY
?L5:	IN? COOKIE,HERE \?L6
	RETURN COOKIE
?L6:	IN? BUTLER,HERE \?L7
	RETURN BUTLER
?L7:	CALL GLOBAL-IN?,DANCERS,HERE >STACK
	ZERO? STACK /?L8
	RETURN DANCERS
?L8:	CALL GLOBAL-IN?,CREW,HERE >STACK
	ZERO? STACK /?L9
	RETURN CREW
?L9:	IN? CROC,HERE \FALSE
	RETURN CROC

	.FUNCT NOT-HERE-OBJECT-F,TBL,PRSO?=1,OBJ,X=0
	EQUAL? PRSO,NOT-HERE-OBJECT \?L1
	EQUAL? PRSI,NOT-HERE-OBJECT \?L1
	PRINTR "Those things aren't here!"
?L1:	EQUAL? P-XNAM,W?MOUTH,W?EYES \?L3
	EQUAL? P-XADJN,W?LAFOND,0 \?L3
	EQUAL? PRSO,NOT-HERE-OBJECT \?L4
	SET 'PRSO,LAFOND
	RFALSE
?L4:	SET 'PRSI,LAFOND
	RFALSE
?L3:	EQUAL? P-XADJN,W?POWDER \?L7
	CALL HELD?,HORN >STACK
	ZERO? STACK /?L7
	EQUAL? PRSO,NOT-HERE-OBJECT \?L8
	SET 'PRSO,POWDER
	JUMP ?L15
?L8:	SET 'PRSI,POWDER
	JUMP ?L15
?L7:	EQUAL? P-XNAM,W?HANDS,W?HAND,W?FINGER /?L12
	EQUAL? P-XNAM,W?EYE,W?EYES,W?HEAD /?L12
	EQUAL? P-XNAM,W?JAMISON /?L12
	EQUAL? P-XNAM,W?LIP,W?LIPS,W?MOUTH \?L11
?L12:	EQUAL? P-XADJN,W?NICK,W?NICHOLAS,W?CROC$0027S /?L13
	EQUAL? P-XADJN,W?DAD,W?FATHER,W?PAPA /?L13
	EQUAL? P-XADJN,W?WOMAN,W?LUCY /?L13
	EQUAL? P-XADJN,W?JEAN,W?LAFOND \?L11
?L13:	PRINTR "[Sadly, we haven't the space to handle everything. Try to refer only to characters in the story, not individual body parts or possessions. For example, you can EXAMINE PIRATE but you can't EXAMINE PIRATE'S EYEPATCH.]"
?L11:	EQUAL? PRSO,NOT-HERE-OBJECT \?L14
	SET 'TBL,P-PRSO
	JUMP ?L15
?L14:	SET 'TBL,P-PRSI
	SET 'PRSO?,0
?L15:	ZERO? PRSO? /?L44
	CALL PRSO-MOBY-VERB? >STACK
	ZERO? STACK /?L16
	SET 'X,1
	JUMP ?L18
?L16:	ZERO? PRSO? \?L18
?L44:	CALL PRSI-MOBY-VERB? >STACK
	ZERO? STACK /?L18
	SET 'X,1
?L18:	ZERO? X /?L20
	CALL FIND-NOT-HERE,TBL,PRSO? >OBJ
	ZERO? OBJ /FALSE
	EQUAL? OBJ,NOT-HERE-OBJECT \TRUE
	EQUAL? PRSA,V?FOLLOW,V?WALK-TO \?L28
	CALL V-WALK-AROUND
	JUMP ?L31
?L28:	CALL MORE-SPECIFIC
	JUMP ?L31
?L20:	EQUAL? WINNER,PROTAGONIST \?L32
	PRINTI "You"
	JUMP ?L37
?L32:	FSET? WINNER,DEADBIT \?L34
	PRINT DOESNT-RESPOND
	RETURN 8
?L34:	PRINTI "Looking confused,"
	CALL TPRINT,WINNER
	PRINTI " says, ""I"
?L37:	PRINTI " can't see"
	CALL ADJNAME?,P-XADJ >STACK
	ZERO? STACK \?L38
	CALL NAME?,P-XNAM >STACK
	ZERO? STACK \?L38
	PRINTI " any"
?L38:	CALL NOT-HERE-PRINT,PRSO?
	PRINTI " here!"
	EQUAL? WINNER,PROTAGONIST /?L41
	PRINTI """"
?L41:	CRLF
?L31:	CALL STOP >STACK
	RSTACK

	.FUNCT PRSO-MOBY-VERB?
	EQUAL? PRSA,V?WHAT,V?WHERE,V?SHOOT /TRUE
	EQUAL? PRSA,V?SSHOOT,V?WALK-TO,V?I-LOVE-YOU /TRUE
	EQUAL? PRSA,V?FIND,V?FOLLOW,V?SAVE-SOMETHING /TRUE
	EQUAL? PRSA,V?ANSWER-KLUDGE \FALSE
	RTRUE

	.FUNCT PRSI-MOBY-VERB?
	EQUAL? PRSA,V?ASK-ABOUT,V?ASK-FOR,V?TELL-ABOUT /TRUE
	EQUAL? PRSA,V?I-LOVE-YOU \FALSE
	RTRUE

	.FUNCT FIND-NOT-HERE,TBL,PRSO?,M-F,OBJ
	CALL MOBY-FIND,TBL >M-F
	EQUAL? 1,M-F \?L1
	ZERO? PRSO? /?L3
	SET 'PRSO,P-MOBY-FOUND
	CALL THIS-IS-IT,PRSO
	RFALSE
?L3:	SET 'PRSI,P-MOBY-FOUND
	RFALSE
?L1:	LESS? 1,M-F \?L6
	GETB TBL,1 >OBJ
	GETP OBJ,P?GENERIC >STACK
	CALL STACK >OBJ
	ZERO? OBJ /?L6
	EQUAL? OBJ,NOT-HERE-OBJECT /TRUE
	ZERO? PRSO? /?L9
	SET 'PRSO,OBJ
	CALL THIS-IS-IT,PRSO
	RFALSE
?L9:	SET 'PRSI,OBJ
	RFALSE
?L6:	RETURN NOT-HERE-OBJECT

	.FUNCT NOT-HERE-PRINT,PRSO?
	ZERO? P-OFLAG /?L1
	ZERO? P-XADJ /?L3
	PRINTI " "
	PRINTB P-XADJN
?L3:	ZERO? P-XNAM /FALSE
	PRINTI " "
	PRINTB P-XNAM
	RTRUE
?L1:	ZERO? PRSO? /?L9
	GET P-ITBL,P-NC1L >STACK
	GET P-ITBL,P-NC1 >STACK
	CALL BUFFER-PRINT,STACK,STACK,0 >STACK
	RSTACK
?L9:	GET P-ITBL,P-NC2L >STACK
	GET P-ITBL,P-NC2 >STACK
	CALL BUFFER-PRINT,STACK,STACK,0 >STACK
	RSTACK

	.FUNCT LADDER-F
	ZERO? LADDER-HANGING \?L1
	CALL CANT-SEE,LADDER >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?BOARD,V?CLIMB,V?TAKE \?L3
	LOC PROTAGONIST >STACK
	EQUAL? STACK,CAPT-QUARTERS \?L4
	FSET? LEDGE,MUNGBIT \?L6
	PRINTI "You lean over"
	CALL TPRINT,LEDGE
	PRINTI ", but"
	CALL TPRINT,LADDER
	PRINTI " is too far out to reach"
	PRINT PCR
	RTRUE
?L6:	PRINTI "It's on the other side of the window"
	PRINT PCR
	RTRUE
?L4:	LOC PROTAGONIST >STACK
	EQUAL? STACK,LEDGE \?L9
	PRINTI "You "
	CALL ANYTHING-HELD >STACK
	ZERO? STACK /?L10
	CALL ROB,PROTAGONIST,RETICULE
	PRINTI "put everything in"
	CALL TPRINT,RETICULE
	PRINTI " and "
?L10:	FSET? POOP,TOUCHBIT \?L13
	PRINTI "hop out, catching the"
	JUMP ?L15
?L13:	CALL QUEUE,I-LADDER-BLOWS,-1
	PRINTI "reach out for"
	CALL TPRINT,LADDER
	PRINTI " and over-balance, tumbling from your perch. Your hand closes on a slimy hemp rung as you fly out over the waves, clinging tenuously, feet free, to the"
?L15:	CALL PRSO-PRINT
	PRINT PCR
	CRLF
	CALL GOTO,ON-LADDER >STACK
	RSTACK
?L9:	EQUAL? HERE,ON-LADDER \?L16
	EQUAL? PRSA,V?TAKE \?L16
	PRINT HOLDING-IT
	RTRUE
?L16:	LOC PROTAGONIST >STACK
	EQUAL? STACK,SKIFF \?L17
	CALL DEBARK-SKIFF >STACK
	RSTACK
?L17:	EQUAL? HERE,POOP \?L18
	PRINTI "If you wish to climb down"
	CALL TPRINT,LADDER
	PRINTI ", say so"
	PRINT PCR
	RTRUE
?L18:	CALL DO-WALK,P?UP >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?CUT \?L20
	CALL HELD?,DAGGER >STACK
	ZERO? STACK /?L21
	CALL CTPRINT,DAGGER
	PRINTI " isn't sharp enough to cut through"
	CALL TRPRINT,LADDER
	RTRUE
?L21:	CALL PROPOSE >STACK
	RSTACK
?L20:	EQUAL? PRSA,V?UNTIE \?L24
	CALL CTPRINT,ROPE
	PRINTI " is tied in too complex a knot"
	PRINT PCR
	RTRUE
?L24:	EQUAL? PRSA,V?CLIMB-DOWN \?L25
	EQUAL? HERE,CAPT-QUARTERS \?L26
	CALL DO-FIRST,STR?197,LADDER >STACK
	RSTACK
?L26:	CALL DO-WALK,P?DOWN
	RTRUE
?L25:	EQUAL? PRSA,V?EXAMINE \FALSE
	EQUAL? HERE,CAPT-QUARTERS,ON-LADDER,POOP \FALSE
	PRINT COMMON-LOOKING
	PRINTI "rope "
	PRINTD LADDER
	PRINT PCR
	RTRUE

	.FUNCT I-END-PROLOGUE
	PRINT INDENT
	PRINTI "Davis leaps across the deck to your side, ""Free me or she dies!"" he yells, jabbing a knife up to your throat. In one smooth motion,"
	CALL TPRINT,HERO
	PRINTI " draws his rapier, pulls you free and stabs. Davis slumps into a bloody heap.
   Swooning, you fall into the Falcon's arms. You are dimly aware of being carried to the other ship, down a short flight of stairs, and laid gently on a soft bed. When you gather strength to look around, the Falcon has left you in peace.
   You remain confined to this room, a large cupboard blocking the door. Meals are brought by a peg-legged old man and eaten in silence. Of your handsome rescuer you see nothing. Slowly the days pass.
"
	CRLF
	PRINT HIT-RETURN
	PRINTI "continue.]"
	CRLF
	READ P-INBUF,P-LEXV
	CALL CLEAR-SCREEN,10
	CALL GOTO,CAPT-QUARTERS
	FCLEAR CRULLEY,DEADBIT
	FCLEAR DOOR,MUNGBIT
	MOVE HERO,CAPT-QUARTERS
	FCLEAR HERO,NDESCBIT
	REMOVE COFFER
	FSET COFFER,MUNGBIT
	FCLEAR COFFER,LOCKEDBIT
	FSET RAPIER,NDESCBIT
	FCLEAR DOOR,OPENBIT
	RTRUE

	.FUNCT GLOBAL-SLEEP-F
	EQUAL? PRSA,V?TAKE,V?WALK-TO \FALSE
	CALL PERFORM,V?SLEEP
	RTRUE

	.FUNCT GROUND-F
	EQUAL? PRSA,V?EXAMINE \?L1
	EQUAL? HERE,RIGGING-ROOM,CROWS-NEST \?L3
	PRINTI "Looking down at the distant deck is a mistake. Your stomach flips over"
	JUMP ?L12
?L3:	CALL SHIP-BOARD,HERE >STACK
	ZERO? STACK /?L5
	PRINTI "Well scrubbed and smoothed floorboards make up the deck"
	JUMP ?L12
?L5:	EQUAL? HERE,BY-SHIP,LAGOON,SHALLOWS \?L6
	PRINTI "A sandy bottom shifts under the waves"
	JUMP ?L12
?L6:	EQUAL? HERE,CELL-1,CELL-4 \?L7
	PRINTI "Like the walls and ceiling, rock"
	JUMP ?L12
?L7:	EQUAL? HERE,CELL-2 \?L8
	PRINTI "The floor is ankle deep in mud"
	JUMP ?L12
?L8:	CALL NOTHING-INTERESTING
	PRINTI "about "
	FSET? HERE,INDOORSBIT \?L10
	PRINTI "the floor"
	JUMP ?L12
?L10:	CALL TPRINT,GROUND
?L12:	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?BOARD,V?CLIMB,V?CLIMB-ON \?L13
	CALL WASTES >STACK
	RSTACK
?L13:	EQUAL? PRSA,V?LOOK-UNDER \?L14
	CALL IMPOSSIBLES >STACK
	RSTACK
?L14:	EQUAL? PRSA,V?LEAVE \?L15
	CALL DO-WALK,P?UP >STACK
	RSTACK
?L15:	EQUAL? PRSA,V?WALK-TO \FALSE
	CALL NOUN-USED,W?DECK,GROUND >STACK
	ZERO? STACK /FALSE
	EQUAL? HERE,CABIN,LANDING,HOLD /?L19
	EQUAL? HERE,GALLEY \?L17
?L19:	CALL DO-WALK,P?OUT >STACK
	RSTACK
?L17:	EQUAL? HERE,DEUX-DECK,POOP,QUARTERDECK /?L21
	EQUAL? HERE,MAIN-DECK,FOCSLE \?L20
?L21:	PRINT LOOK-AROUND
	RTRUE
?L20:	EQUAL? HERE,CROWS-NEST,RIGGING-ROOM \?L22
	CALL DO-WALK,P?DOWN >STACK
	RSTACK
?L22:	CALL SHIP-BOARD,HERE >STACK
	ZERO? STACK /?L23
	CALL V-WALK-AROUND >STACK
	RSTACK
?L23:	CALL WASTES >STACK
	RSTACK

	.FUNCT KEY-F
	EQUAL? PRSA,V?TAKE \FALSE
	FSET? LARGE-KEY,TRYTAKEBIT \FALSE
	MOVE LARGE-KEY,PROTAGONIST
	FCLEAR LARGE-KEY,TRYTAKEBIT
	INC 'SCORE
	PRINTI "Taken."
	CRLF
	CALL IS-THEFT? >STACK
	CALL PRINT-ID,STR?198,STACK >STACK
	RSTACK

	.FUNCT GEN-LOCK
	FSET? COFFER,NDESCBIT /FALSE
	RETURN DOOR

	.FUNCT DOOR-F
	EQUAL? HERE,CAPT-QUARTERS \?L1
	CALL PERFORM-PRSA,CURTAIN
	RTRUE
?L1:	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L3
	CALL NOUN-USED,W?LOCK,LDOOR >STACK
	ZERO? STACK /?L4
	PRINTI "Ladies do not look through keyholes!"
	CRLF
	JUMP ?L10
?L4:	FSET? PRSO,OPENBIT \?L6
	PRINTI "It is open"
	JUMP ?L10
?L6:	PRINTI "It"
	PRINT IS-CLOSED
	EQUAL? HERE,QUARTERDECK \?L8
	PRINTI " and barred"
	JUMP ?L10
?L8:	FSET? DOOR,MUNGBIT \?L10
	PRINTI ". Or, what remains of it is"
?L10:	CALL THIS-IS-IT,PRSO
	PRINT PCR
	RTRUE
?L3:	EQUAL? PRSA,V?PICK \?L12
	EQUAL? PRSO,LDOOR \?L12
	PRINTR "The mechanism is too complex to pick."
?L12:	EQUAL? PRSA,V?UNLOCK \?L13
	EQUAL? HERE,UPPER-HALL-E \?L14
	PRINTI "Only one man has the key to this room: Jean Lafond"
	PRINT PCR
	RTRUE
?L14:	EQUAL? HERE,QUARTERDECK \?L16
	CALL PERFORM,V?OPEN,DOOR
	RTRUE
?L16:	EQUAL? PRSO,WOOD-CELL-DOOR \?L17
	PRINTI "But"
	CALL TPRINT,DOOR
	PRINTI " isn't locked"
	PRINT PCR
	RTRUE
?L17:	EQUAL? PRSI,LARGE-KEY \?L18
	EQUAL? PRSO,IRON-CELL-DOOR \?L19
	FCLEAR PRSO,LOCKEDBIT
	PRINTI "Unlocked"
	PRINT PCR
	RTRUE
?L19:	PRINTI "That key does not unlock this door"
	PRINT PCR
	RTRUE
?L18:	PRINTI "You are unable to unlock"
	CALL TRPRINT,DOOR
	RTRUE
?L13:	EQUAL? PRSA,V?LOCK \?L23
	EQUAL? PRSO,IRON-CELL-DOOR \?L24
	EQUAL? PRSI,LARGE-KEY \?L29
	FSET PRSO,LOCKEDBIT
	PRINTI "You "
	FSET? PRSO,OPENBIT \?L26
	FCLEAR PRSO,OPENBIT
	PRINTI "close and "
?L26:	PRINTI "lock"
	CALL TRPRINT,DOOR
	RTRUE
?L24:	EQUAL? PRSI,LARGE-KEY \?L29
	PRINTI "That key won't work here"
	PRINT PCR
	RTRUE
?L29:	EQUAL? PRSO,VER-DOOR \?L30
	PRINT YOU-CANT
	PRINTI "lock that"
	PRINT PCR
	RTRUE
?L30:	CALL PROPOSE >STACK
	RSTACK
?L23:	EQUAL? PRSA,V?KNOCK \?L32
	EQUAL? HERE,UPPER-HALL-E \?L33
	FSET? LDOOR,LOCKEDBIT /?L33
	IN? LAFOND,LAFS-ROOM \?L33
	PRINTD LAFOND
	PRINTR " calls, ""Come."""
?L33:	PRINTR "Silence answers back."
?L32:	EQUAL? PRSA,V?OPEN \FALSE
	EQUAL? HERE,CABIN \?L37
	PRINTR "It appears to be locked."
?L37:	EQUAL? HERE,LANDING \?L39
	CALL CTPRINT,DOOR
	PRINTI " won't open"
	PRINT PCR
	RTRUE
?L39:	EQUAL? HERE,QUARTERDECK \?L40
	PRINTI "Someone yells from ahead, ""Cap'n 'll have your hide if you go down there!"" You haven't the strength to lift the bar anyway"
	PRINT PCR
	RTRUE
?L40:	EQUAL? HERE,VERANDA \FALSE
	FSET? DOOR,OPENBIT /FALSE
	PRINT YOU-CANT-SEE-ANY
	PRINT WAY-TO-DO-THAT
	RTRUE

	.FUNCT CEILING-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	EQUAL? HERE,CREWS-QUARTERS \?L3
	PRINT YOU-SEE
	PRINTI " a sail rippling against the night sky through"
	CALL TRPRINT,GRATE
	RTRUE
?L3:	FSET? HERE,INDOORSBIT /FALSE
	CALL CANT-SEE,CEILING >STACK
	RSTACK

	.FUNCT WATER-F
	EQUAL? HERE,LAFS-ROOM,RIGGING-ROOM /?L3
	EQUAL? HERE,BOWSPRIT,CROWS-NEST \?L1
?L3:	EQUAL? PRSA,V?PUT-ON,V?PUT,V?THROW /?L1
	EQUAL? PRSA,V?ENTER \?L4
	PRINT SUICIDE
	RTRUE
?L4:	CALL CANT-REACH,SEA >STACK
	RSTACK
?L1:	CALL GLOBAL-IN?,SEA,HERE >STACK
	ZERO? STACK \?L7
	CALL HELD?,WATER,HERE >STACK
	ZERO? STACK \?L7
	PRINTR "There's no water here."
?L7:	EQUAL? PRSA,V?EXAMINE,V?LOOK-UNDER,V?LOOK-INSIDE \?L8
	PRINTI "The water is sparkling clear"
	PRINT PCR
	RTRUE
?L8:	EQUAL? PRSA,V?REACH-IN \?L9
	PRINTI "Water"
	PRINT DRIPS-OFF
	RTRUE
?L9:	EQUAL? PRSA,V?DRINK-FROM,V?DRINK \?L10
	EQUAL? PRSO,WATER \?L11
	PRINTI "You take a long draft. It is quite refreshing"
	PRINT PCR
	RTRUE
?L11:	PRINTI "This water is much too salty to drink"
	PRINT PCR
	CALL PRINT-ID,STR?199 >STACK
	RSTACK
?L10:	EQUAL? PRSA,V?PUT-ON \?L14
	EQUAL? PRSI,SEA \?L14
	CALL PERFORM,V?PUT,PRSO,SEA
	RTRUE
?L14:	EQUAL? PRSA,V?THROW \?L15
	EQUAL? HERE,CAPT-QUARTERS \?L16
	FSET? LEDGE,MUNGBIT /?L16
	PRINTI "But"
	CALL TPRINT,WINDOW
	PRINT IS-CLOSED
	PRINTR "!"
?L16:	REMOVE PRSO
	PRINTI "You toss"
	CALL TPRINT-PRSO
	PRINTI " into"
	CALL TRPRINT,SEA
	RTRUE
?L15:	EQUAL? PRSA,V?SOAK,V?PUT \?L19
	EQUAL? PRSO,LETTER,INVITE \?L20
	REMOVE PRSO
	PRINTI "It disintegrates quickly into nothing"
	PRINT PCR
	CALL PRINT-ID,STR?200 >STACK
	RSTACK
?L20:	EQUAL? HERE,POOP,QUARTERDECK,FOCSLE /?L23
	EQUAL? HERE,BOWSPRIT,CAPT-QUARTERS \?L22
?L23:	CALL PERFORM,V?THROW,PRSO,SEA
	RTRUE
?L22:	EQUAL? HERE,MAIN-DECK \?L24
	EQUAL? PRSI,SEA \?L25
	CALL PERFORM,V?THROW,PRSO,SEA
	RTRUE
?L25:	CALL PERFORM,V?PUT,PRSO,WATER-BARREL
	RTRUE
?L24:	EQUAL? HERE,BEACH,SHALLOWS,LAGOON /?L29
	EQUAL? HERE,BY-SHIP \?L28
?L29:	EQUAL? PRSO,RAG,DRESS \?L30
	CALL DIP-DRESS >STACK
	RSTACK
?L30:	PRINTI "You dip"
	CALL TPRINT-PRSO
	PRINTI " into the water"
	PRINT PCR
	RTRUE
?L28:	PRINT YOU-CANT
	PRINTI "reach any water"
	PRINT PCR
	RTRUE
?L19:	EQUAL? PRSA,V?SWIM,V?ENTER,V?BOARD \?L34
	EQUAL? HERE,BEACH \?L35
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L35:	CALL V-SWIM >STACK
	RSTACK
?L34:	CALL TOUCHING?,SEA >STACK
	ZERO? STACK /FALSE
	PRINTI "The cool water runs through your fingers"
	PRINT PCR
	RTRUE

	.FUNCT SKY-F
	FSET? HERE,INDOORSBIT \FALSE
	CALL CANT-SEE,SKY >STACK
	RSTACK

	.FUNCT MOON-F
	FSET? HERE,INDOORSBIT \?L1
	EQUAL? HERE,CREWS-QUARTERS,CAPT-QUARTERS,BEDROOM /?L1
	EQUAL? HERE,LAFS-ROOM /?L1
	EQUAL? PRSA,V?TELL-ABOUT,V?ASK-ABOUT /?L1
	PRINT YOU-CANT
	PRINTI "see the moon from here"
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "A dusty moonbeam swirls down from the sky."

	.FUNCT HANDS-F,ACTOR
	EQUAL? PRSA,V?APPLAUD \?L1
	SET 'PRSO,0
	CALL V-APPLAUD >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?SHAKE \?L3
	CALL FIND-IN,HERE,ACTORBIT,STR?150 >ACTOR
	ZERO? ACTOR /?L4
	CALL PERFORM,V?SHAKE-WITH,HANDS,ACTOR
	RTRUE
?L4:	PRINTR "Pleased to meet you."
?L3:	EQUAL? PRSA,V?CLEAN \?L7
	PRINTR "Done."
?L7:	EQUAL? PRSA,V?TAKE-WITH \FALSE
	EQUAL? PRSI,HANDS \FALSE
	CALL PERFORM,V?TAKE,PRSO
	RTRUE

	.FUNCT EYES-F
	EQUAL? PRSA,V?CLOSE \?L1
	PRINTI "You blink"
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?OPEN \?L3
	PRINTR "They are open!"
?L3:	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \FALSE
	CALL ADJ-USED,A?HIS >STACK
	ZERO? STACK /FALSE
	IN? HERO,HERE \FALSE
	GET MANNERISMS,3 >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT MOUTH-F
	EQUAL? PRSA,V?OPEN,V?ENTER,V?PUT-ON /?L3
	EQUAL? PRSA,V?EXAMINE,V?POUR,V?WRING /?L3
	EQUAL? PRSA,V?PUT \?L1
?L3:	CALL ADJ-USED,A?CROC$0027S >STACK
	ZERO? STACK \?L6
	CALL ADJ-USED,A?CROCOD >STACK
	ZERO? STACK \?L6
	CALL NOUN-USED,W?SNOUT,MOUTH >STACK
	ZERO? STACK /?L4
?L6:	CALL PERFORM-PRSA,PRSO,CROC
	RTRUE
?L4:	CALL ADJ-USED,A?LAFOND >STACK
	ZERO? STACK /?L7
	CALL PERFORM-PRSA,PRSO,LAFOND >STACK
	RSTACK
?L7:	EQUAL? PRSI,MOUTH \FALSE
	CALL PERFORM,V?EAT,PRSO
	RTRUE
?L1:	EQUAL? PRSA,V?OPEN \FALSE
	CALL RUNNING?,I-HFOLLY >STACK
	ZERO? STACK /?L11
	PRINTR "Jamison will do that for you."
?L11:	PRINTR "You fail to stifle a yawn."

	.FUNCT PROTAGONIST-F
	ZERO? QUESTIONER /FALSE
	CALL GAME-COMMANDS >STACK
	ZERO? STACK \FALSE
	EQUAL? PRSA,V?NO /?L6
	CALL NEGATIVE-ANSWER >STACK
	ZERO? STACK /?L5
	EQUAL? QUESTIONER,PRSO,PRSI \?L5
?L6:	SET 'REACTION,REACTION-NEGATIVE
	JUMP ?L9
?L5:	EQUAL? PRSA,V?YES /?L8
	CALL AFFIRMATIVE-ANSWER >STACK
	ZERO? STACK /?L7
?L8:	SET 'REACTION,REACTION-POSITIVE
	JUMP ?L9
?L7:	SET 'REACTION,REACTION-NEUTRAL
?L9:	SET 'QUESTIONER,0
	RFALSE

	.FUNCT AFFIRMATIVE-ANSWER
	EQUAL? PRSA,V?CLIMB-ON,V?APPLAUD,V?GIVE /TRUE
	EQUAL? PRSA,V?FOLLOW,V?DANCE,V?SGIVE /TRUE
	EQUAL? PRSA,V?CURTSEY,V?KISS,V?HELLO /TRUE
	EQUAL? PRSA,V?LAUGH,V?MARRY,V?I-LOVE-YOU /TRUE
	EQUAL? PRSA,V?EMBRACE,V?TOUCH,V?SAVE-SOMETHING /TRUE
	EQUAL? PRSA,V?WALK-TO,V?THANK,V?SSHOW /TRUE
	EQUAL? PRSA,V?SHOW,V?MAKE-OUT,V?MAKE-LOVE /TRUE
	EQUAL? PRSA,V?TELL \FALSE
	GET P-LEXV,P-CONT >STACK
	CALL YES-WORD,STACK >STACK
	ZERO? STACK /FALSE
	RTRUE

	.FUNCT NEGATIVE-ANSWER
	EQUAL? PRSA,V?BURN,V?BITE,V?KILL /TRUE
	EQUAL? PRSA,V?RAPE,V?KICK,V?MUNG /TRUE
	EQUAL? PRSA,V?YELL,V?SWING,V?SHAKE /TRUE
	EQUAL? PRSA,V?TELL \FALSE
	GET P-LEXV,P-CONT >STACK
	CALL NO-WORD,STACK >STACK
	ZERO? STACK /FALSE
	RTRUE

	.FUNCT GAME-COMMANDS
	EQUAL? PRSA,V?QUIT,V?RESTORE,V?SAVE /TRUE
	EQUAL? PRSA,V?SUPER-BRIEF,V?BRIEF,V?VERBOSE /TRUE
	EQUAL? PRSA,V?VERSION,V?UNSCRIPT,V?SCRIPT /TRUE
	EQUAL? PRSA,V?$0024RECORD,V?$0024COMMAND,V?$0024RANDOM /TRUE
	EQUAL? PRSA,V?$0024UNRECORD,V?$0024VERIFY /TRUE
	EQUAL? PRSA,V?SCORE,V?HELP \FALSE
	RTRUE

	.FUNCT ME-F
	EQUAL? PRSA,V?TELL \?L1
	PRINTI "You'll end up in Bedlam, talking to "
	PRINTD ME
	PRINTI " that way."
	CRLF
	CALL STOP >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?GIVE \?L3
	EQUAL? PRSI,ME \?L3
	CALL PERFORM,V?TAKE,PRSO
	RTRUE
?L3:	EQUAL? PRSA,V?TAKE-WITH \?L4
	EQUAL? PRSI,MAN \?L4
	CALL RECOGNIZE >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?SHOW \?L5
	EQUAL? PRSI,ME \?L5
	CALL PERFORM,V?EXAMINE,PRSO
	RTRUE
?L5:	EQUAL? PRSA,V?MOVE \?L6
	CALL V-WALK-AROUND >STACK
	RSTACK
?L6:	EQUAL? PRSA,V?SEARCH \?L7
	CALL V-INVENTORY
	RTRUE
?L7:	EQUAL? PRSA,V?ALARM \?L8
	CALL HELD?,SALTS >STACK
	ZERO? STACK /?L8
	CALL PERFORM,V?SMELL,SALTS
	RTRUE
?L8:	EQUAL? PRSA,V?DRESS \?L9
	CALL PERFORM,V?GET-DRESSED,ROOMS
	RTRUE
?L9:	EQUAL? PRSA,V?EXAMINE \?L10
	CALL RUNNING?,I-LSED >STACK
	ZERO? STACK /?L11
	GRTR? LAFOND-CTR,HORNY \?L11
	CALL V-INVENTORY >STACK
	RSTACK
?L11:	PRINTI "You are wearing"
	ZERO? BOY-DRESS? /?L14
	CALL APRINT,SHIRT
	PRINTI " and "
	PRINTD PANTS
	PRINTR ". Mama herself would think you a plump boy."
?L14:	FSET? DRESS,WORNBIT \?L16
	CALL APRINT,DRESS
	PRINTR ", very pretty, if a tad outmoded for today's fashions."
?L16:	FSET? GOWN,WORNBIT \?L17
	CALL APRINT,GOWN
	PRINTR " of creamy watered silk."
?L17:	FSET? SHIRT,WORNBIT \?L18
	CALL APRINT,SHIRT
	PRINT BROTHEL
	RTRUE
?L18:	FSET? PANTS,WORNBIT \?L19
	CALL APRINT,PANTS
	PRINT BROTHEL
	RTRUE
?L19:	FSET? CHEMISE,EVERYBIT /FALSE
	PRINTI " absolutely nothing besides"
	CALL APRINT,CHEMISE
	PRINTI ", "
	PRINTD SHOES
	PRINTI " and a few layers of "
	PRINTD UNMENTIONABLES
	PRINTI ". "
	PRINT MOTHER
	RTRUE
?L10:	EQUAL? PRSA,V?SHOOT,V?MUNG,V?KILL /?L23
	EQUAL? PRSA,V?SSHOOT \?L22
?L23:	PRINT SUICIDE
	EQUAL? PRSA,V?SSHOOT,V?SHOOT,V?KILL /?L24
	PUSH 0
	JUMP ?L25
?L24:	PUSH 1
?L25:	CALL PRINT-ID,STR?201,STACK
	EQUAL? PRSA,V?MUNG /?L26
	PUSH 0
	JUMP ?L27
?L26:	PUSH 1
?L27:	CALL PRINT-ID,STR?202,STACK >STACK
	RSTACK
?L22:	EQUAL? PRSA,V?WHERE,V?FIND \?L28
	PRINTI "You're in"
	CALL TRPRINT,HERE
	RTRUE
?L28:	EQUAL? PRSA,V?FOLLOW \?L29
	PRINTR "Next time, please specify who you wish to follow."
?L29:	EQUAL? PRSA,V?EMBRACE,V?KISS \FALSE
	PRINTI "Mama warned you of the dangers of onanism"
	PRINT PCR
	RTRUE

	.FUNCT GLOBAL-ROOM-F
	EQUAL? PRSA,V?EXAMINE,V?LOOK-INSIDE,V?LOOK \?L1
	CALL V-LOOK >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?WALK-TO,V?ENTER \?L3
	CALL V-WALK-AROUND >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?DISEMBARK,V?EXIT,V?LEAVE \?L4
	CALL DO-WALK,P?OUT >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?SEARCH \?L5
	EQUAL? HERE,CABIN \?L6
	CALL RUNNING?,I-COFFER >STACK
	ZERO? STACK \?L6
	CALL HELD?,COFFER >STACK
	ZERO? STACK \?L6
	CALL PERFORM,V?LOOK-UNDER,CABIN-BED
	RTRUE
?L6:	PRINT NOTHING-NEW
	RTRUE
?L5:	EQUAL? PRSA,V?PUT \FALSE
	EQUAL? PRSI,GLOBAL-ROOM \FALSE
	EQUAL? P-PRSA-WORD,W?THROW \?L10
	CALL PERFORM,V?THROW,PRSO
	RTRUE
?L10:	CALL PERFORM,V?DROP,PRSO
	RTRUE

	.FUNCT HOUSE-F
	EQUAL? PRSA,V?BOARD,V?WALK-TO,V?ENTER \?L1
	EQUAL? HERE,MAIN-ENTRANCE \?L3
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L3:	EQUAL? HERE,TRADE-ENTRANCE \?L5
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L5:	EQUAL? HERE,VERANDA,LAWN \?L6
	CALL DO-WALK,P?NORTH >STACK
	RSTACK
?L6:	EQUAL? HERE,BY-HOUSE \?L7
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L7:	PRINT YOU-CANT
	PRINTR "do that from here."
?L1:	EQUAL? PRSA,V?DISEMBARK,V?LEAVE,V?EXIT \?L9
	EQUAL? HERE,KITCHEN \?L10
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L10:	EQUAL? HERE,FOYER \?L12
	CALL DO-WALK,P?NORTH >STACK
	RSTACK
?L12:	EQUAL? HERE,BALLROOM \?L13
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L13:	EQUAL? HERE,LIBRARY \?L14
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L14:	EQUAL? HERE,BEDROOM \?L15
	CALL DO-WALK,P?DOWN >STACK
	RSTACK
?L15:	PRINT LOOK-AROUND
	RTRUE
?L9:	EQUAL? PRSA,V?LOOK-INSIDE \?L17
	EQUAL? HERE,MAIN-ENTRANCE,TRADE-ENTRANCE,LAWN /?L20
	EQUAL? HERE,BY-HOUSE \?L18
?L20:	PRINT CANT-FROM-HERE
	RTRUE
?L18:	CALL V-LOOK >STACK
	RSTACK
?L17:	EQUAL? PRSA,V?EXAMINE \FALSE
	EQUAL? HERE,CREWS-QUARTERS \?L23
	PRINTI "Bathed in moonbeams and candlelight, the house squats at the crest of a cliff. The upstairs window is dark"
	PRINT PCR
	RTRUE
?L23:	CALL SHIP-BOARD,HERE >STACK
	ZERO? STACK /?L27
	CALL INNER-DECK,HERE >STACK
	ZERO? STACK /?L26
?L27:	EQUAL? HERE,BEACH \?L25
?L26:	PRINT YOU-CANT
	PRINTI "make out much of the house from this angle"
	PRINT PCR
	RTRUE
?L25:	CALL INNER-DECK,HERE >STACK
	ZERO? STACK \?L29
	CALL BELOW-GROUND,HERE >STACK
	ZERO? STACK \?L29
	EQUAL? HERE,FOREST,FOLLY,IN-HEDGE \?L28
?L29:	PRINT YOU-CANT-SEE-ANY
	PRINTI "house here"
	PRINT PCR
	RTRUE
?L28:	EQUAL? HERE,FRONT-DRIVE,MAIN-ENTRANCE,LAWN /?L31
	EQUAL? HERE,TRADE-ENTRANCE,CLEARING,VERANDA \?L30
?L31:	PRINTI "An entrance to"
	CALL TPRINT,HOUSE
	PRINTI " is nearby"
	PRINT PCR
	RTRUE
?L30:	CALL V-LOOK >STACK
	RSTACK

	.FUNCT CLIMBING
	FSET? DRESS,WORNBIT /?L3
	FSET? GOWN,WORNBIT \?L1
?L3:	SET 'AWAITING-REPLY,2
	CALL QUEUE,I-REPLY,2
	PRINTI "In these clothes? You jest"
	PRINT PCR
	RFALSE
?L1:	EQUAL? P-WALK-DIR,P?UP \?L4
	EQUAL? HERE,CLEARING \?L5
	PRINTI "You take a firm grasp on a particularly thick tendril, jerk once to secure it, and scamper up the wall like some huge tropical spider. It is easy to climb through the window"
	PRINT PCR
	CRLF
	RETURN BEDROOM
?L5:	EQUAL? HERE,CAPT-QUARTERS \?L7
	ZERO? LADDER-HANGING \?L8
	PRINT CANT-GO
	RFALSE
?L8:	FSET? POOP,TOUCHBIT /?L10
	LOC PROTAGONIST >STACK
	EQUAL? STACK,LEDGE \?L11
	CALL DO-FIRST,STR?203,LADDER
	RFALSE
?L11:	CALL DO-FIRST,STR?197,LEDGE
	RFALSE
?L10:	PRINTI "You dash up"
	CALL TRPRINT,LADDER
	CRLF
	RETURN POOP
?L7:	EQUAL? HERE,MAIN-DECK,FOCSLE \?L15
	SET 'WHICH-MAST?,HERE
	LOC DAGGER >STACK
	EQUAL? STACK,PROTAGONIST \?L16
	PRINTI "You bite down on"
	CALL TPRINT,DAGGER
	PRINTI ", freeing "
	PRINTD HANDS
	PRINTI "s to climb. When you stop, you take it back again. "
?L16:	PRINTI "The wind, a mere breeze on the deck, blows more fiercely"
	PRINT PCR
	CRLF
	RETURN RIGGING-ROOM
?L15:	EQUAL? RIGGING-ROOM,HERE \?L19
	EQUAL? WHICH-MAST?,FOCSLE \?L20
	PRINTI "You clamber up"
	CALL TRPRINT,RIGGING-OBJECT
	CRLF
	RETURN CROWS-NEST
?L20:	PRINTI "Above you there only appears to be more of the same, except higher, and you can not vouch for the effects on your stomach"
	PRINT PCR
	RFALSE
?L19:	EQUAL? HERE,ON-LADDER \?L23
	FSET? POOP,TOUCHBIT /?L24
	INC 'UP-CTR
	EQUAL? UP-CTR,4 /?L26
	PRINTI "You climb up"
	CALL TPRINT,LADDER
	EQUAL? UP-CTR,2 \?L28
	PRINTI ", passing the halfway point"
?L28:	PRINT PCR
	RFALSE
?L26:	PRINTI "You heave "
	PRINTD ME
	PRINTI " over the stern rail and sink breathless to the deck of"
	CALL TRPRINT,SHIP
	CRLF
	CALL DEQUEUE,I-LADDER-BLOWS
	RETURN POOP
?L24:	PRINTI "You dash up"
	CALL TRPRINT,LADDER
	CRLF
	RETURN POOP
?L23:	EQUAL? HERE,BY-SHIP \FALSE
	CALL DEBARK-SKIFF
	RFALSE
?L4:	EQUAL? P-WALK-DIR,P?DOWN \FALSE
	EQUAL? HERE,BEDROOM \?L36
	PRINTI "Absently, you slide down"
	CALL TPRINT,VINE
	PRINTI ". You're getting quite adept at clambering about"
	PRINT PCR
	CRLF
	RETURN CLEARING
?L36:	EQUAL? HERE,CROWS-NEST,RIGGING-ROOM \?L38
	PRINTI "You half-climb, half-fall, down to the deck"
	PRINT PCR
	CRLF
	RETURN WHICH-MAST?
?L38:	EQUAL? HERE,POOP \?L39
	PRINTI "You climb down to opposite"
	CALL TRPRINT,LEDGE
	CRLF
	RETURN ON-LADDER
?L39:	EQUAL? HERE,ON-LADDER \FALSE
	ZERO? SKIFF-TIED /?L41
	SET 'SKIFF-TIED,0
	PRINTI "Freeing your feet from the rungs, you slide down the wet rope to the skiff, and quickly untie it from the ship"
	PRINT PCR
	CRLF
	RETURN BY-SHIP
?L41:	PRINTI "A watery grave awaits you that way."
	CRLF
	RFALSE

	.FUNCT FIRE-F
	EQUAL? PRSA,V?OFF \?L1
	CALL IMPOSSIBLES >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?PUT-ON,V?PUT,V?ON /?L4
	EQUAL? PRSA,V?THROW \?L3
?L4:	CALL PERFORM,V?BURN,PRSO,FIRE
	RTRUE
?L3:	EQUAL? PRSA,V?TELL-ABOUT /FALSE
	CALL UNIMPORTANT-THING >STACK
	RSTACK

	.FUNCT STAIRS-F
	EQUAL? PRSA,V?CLIMB \?L1
	EQUAL? HERE,MAIN-DECK \?L3
	CALL DO-WALK,P?NORTH >STACK
	RSTACK
?L3:	CALL DO-WALK,P?UP >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?CLIMB-DOWN \?L6
	CALL DO-WALK,P?DOWN >STACK
	RSTACK
?L6:	EQUAL? PRSA,V?THROW \?L7
	EQUAL? PRSI,STAIRS \?L7
	CALL WASTES >STACK
	RSTACK
?L7:	EQUAL? PRSA,V?EXAMINE \FALSE
	EQUAL? HERE,HOLD \?L9
	PRINTI "Steep stairs mount up to"
	CALL TRPRINT,HATCH
	RTRUE
?L9:	EQUAL? HERE,MAIN-DECK \FALSE
	FSET? HATCH,OPENBIT \?L12
	PRINT STEEP-STAIRS
	PRINTI "down from "
	CALL TPRINT,HATCH
	PRINTI ". Another leads"
	JUMP ?L14
?L12:	CALL CTPRINT,STAIRS
	PRINTI " lead"
?L14:	PRINTI " to the foredeck"
	PRINT PCR
	RTRUE

	.FUNCT BED-F,VARG=0,THIS-BED
	ZERO? VARG /?L1
	EQUAL? VARG,M-BEG \FALSE
	EQUAL? PRSA,V?WALK /?L5
	ZERO? PRSO /FALSE
	EQUAL? PRSA,V?TAKE \FALSE
	EQUAL? PRSO,LRING,HRING /FALSE
	IN? PRSO,GLOBAL-OBJECTS /FALSE
	LOC PRSO >STACK
	LOC PROTAGONIST >STACK
	EQUAL? STACK,STACK /FALSE
?L5:	CALL DO-FIRST,STR?204
	RETURN 8
?L1:	EQUAL? PRSA,V?STAND,V?DISEMBARK \?L9
	IN? LAFOND,LAFS-BED \?L9
	PRINTI "Lafond slams you back into the feather mattress"
	PRINT PCR
	RTRUE
?L9:	EQUAL? PRSA,V?BOARD,V?ENTER \?L10
	LOC PROTAGONIST >STACK
	EQUAL? STACK,LAFS-ROOM \?L10
	IN? LAFOND,HERE \?L10
	PRINTD LAFOND
	PRINTR " stops you. ""I'll tell you when to do that."""
?L10:	EQUAL? PRSA,V?EXAMINE \?L11
	EQUAL? HERE,CABIN \?L14
	SET 'THIS-BED,CABIN-BED
	JUMP ?L15
?L14:	EQUAL? HERE,CAPT-QUARTERS \?L16
	SET 'THIS-BED,CAPT-BED
	JUMP ?L15
?L16:	SET 'THIS-BED,0
?L15:	ZERO? THIS-BED /?L12
	FIRST? THIS-BED >STACK /?L12
	PRINTI "Someone appears to have tumbled out of it in a hurry"
	JUMP ?L20
?L12:	EQUAL? HERE,LAFS-ROOM \?L18
	PRINTI "You gaze at the purple and gold bed, fearing it is your destiny"
	JUMP ?L20
?L18:	EQUAL? HERE,CELL-1 \FALSE
	PRINTI "It is an uncomfortable canvas cot, old and torn"
?L20:	PRINT PCR
	RTRUE
?L11:	EQUAL? PRSA,V?LOOK-UNDER \?L21
	CALL QUEUED?,I-COFFER >STACK
	ZERO? STACK /?L22
	PRINT YOU-SEE
	CALL APRINT,COFFER
	PRINTI " "
	FCLEAR COFFER,NDESCBIT
	FSET COFFER,TOUCHBIT
	JUMP ?L24
?L22:	PRINT THERES-NOTHING
?L24:	PRINTI "under"
	CALL TRPRINT,PRSO
	RTRUE
?L21:	EQUAL? PRSA,V?PUSH,V?MOVE \?L25
	PRINTI "It is nailed to the floor"
	PRINT PCR
	RTRUE
?L25:	EQUAL? PRSA,V?PUT-UNDER \FALSE
	EQUAL? HERE,CAPT-QUARTERS,CABIN \FALSE
	EQUAL? PRSO,ME \?L27
	CALL PERFORM,V?CRAWL-UNDER,CABIN-BED
	RTRUE
?L27:	EQUAL? PRSO,RETICULE /FALSE
	PRINTI "You do so, but the ship rolls to one side and"
	CALL TPRINT-PRSO
	PRINTI " rolls out"
	PRINT PCR
	MOVE PRSO,HERE
	RTRUE

	.FUNCT CURTAIN-F
	EQUAL? PRSA,V?FIDDLE,V?MOVE,V?OPEN /?L3
	EQUAL? PRSA,V?LOOK-BEHIND \?L1
?L3:	PRINT PULL-FABRIC
	PRINTI " Behind it,"
	CALL APRINT,CUPBOARD-OBJECT
	PRINTR " mostly blocks the doorway."
?L1:	EQUAL? PRSA,V?CLOSE \?L4
	PRINT ALREADY-IS
	RTRUE
?L4:	EQUAL? PRSA,V?WALK-TO,V?WALK \FALSE
	PRINTI "Please indicate a "
	PRINTD INTDIR
	PRINT PCR
	RTRUE

	.FUNCT WINDOW-F
	EQUAL? PRSA,V?OPEN \?L1
	FSET? WINDOW,OPENBIT /?L3
	EQUAL? HERE,CABIN \?L5
	PRINTI "This isn't the opening kind of porthole"
	PRINT PCR
	RTRUE
?L5:	EQUAL? HERE,CAPT-QUARTERS \?L7
	PRINTI "These windows don't open"
	PRINT PCR
	RTRUE
?L7:	EQUAL? HERE,LIBRARY,BY-HOUSE \?L8
	CALL OPEN-CLOSE,LIB-WINDOW >STACK
	RSTACK
?L8:	PRINTI "That's not necessary"
	PRINT PCR
	RTRUE
?L3:	PRINTI "It's already open"
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?CLOSE \?L11
	EQUAL? HERE,LIBRARY,BY-HOUSE \?L12
	CALL OPEN-CLOSE,LIB-WINDOW >STACK
	RSTACK
?L12:	PRINT BEAUTIFUL-NIGHT
	RTRUE
?L11:	EQUAL? PRSA,V?EXAMINE \?L15
	EQUAL? HERE,CABIN \?L16
	PRINTI "Through the porthole you see the bow of the pirate ship bucking in the high seas, lit by the fires burning on deck. It is called the """
	PRINTD SHIP
	PRINTI "."" Odd, that was your mother's name"
	PRINT PCR
	RTRUE
?L16:	EQUAL? HERE,CAPT-QUARTERS \?L18
	CALL PERFORM,V?EXAMINE,LEDGE
	RTRUE
?L18:	EQUAL? HERE,LIBRARY,BY-HOUSE \FALSE
	PRINT YOU-SEE
	PRINT DARKNESS
	CALL TRPRINT,WINDOW
	RTRUE
?L15:	EQUAL? PRSA,V?LOOK-INSIDE \?L21
	EQUAL? CABIN,HERE \?L22
	CALL PERFORM,V?EXAMINE,WINDOW
	RTRUE
?L22:	EQUAL? HERE,CAPT-QUARTERS \?L24
	ZERO? LADDER-HANGING /?L25
	CALL QUEUE,I-SEE-LADDER,2
	PRINTI "A rope "
	PRINTD LADDER
	PRINTI " twists by in the breeze, and the"
	JUMP ?L27
?L25:	PRINTI "The"
?L27:	PRINTI " moon beckons across the lagoon to "
	PRINTD ISLAND
	ZERO? SKIFF-TIED /?L28
	PRINTI ". Moored to the stern is"
	CALL APRINT,SKIFF
?L28:	PRINTI "."
	CALL I-LOOK-SEA,0
	CRLF
	RTRUE
?L24:	EQUAL? HERE,LIBRARY,BY-HOUSE \?L31
	CALL PERFORM,V?EXAMINE,LIB-WINDOW
	RTRUE
?L31:	EQUAL? HERE,BEDROOM \?L32
	PRINTI "It has a lovely view of grey-green palm trees extending for miles"
	PRINT PCR
	RTRUE
?L32:	PRINT YOU-SEE
	PRINT DARKNESS
	CALL TRPRINT,WINDOW
	RTRUE
?L21:	EQUAL? PRSA,V?MUNG \?L34
	ZERO? PRSI \?L35
	CALL PROPOSE >STACK
	RSTACK
?L35:	EQUAL? PRSI,COFFER \?L37
	CALL PERFORM,V?PUT-THROUGH,COFFER,WINDOW
	RTRUE
?L37:	EQUAL? HERE,CAPT-QUARTERS \?L38
	PRINT YOULL-HAVE-TO
	PRINTI "find something else to break"
	CALL TPRINT,WINDOW
	PRINTI " with"
	PRINT PCR
	CALL PRINT-ID,STR?205 >STACK
	RSTACK
?L38:	PRINTR "Then again, a lady would just open it."
?L34:	EQUAL? PRSA,V?KILL \?L40
	ZERO? PRSI \?L41
	PRINTI "You haven't the strength to damage"
	CALL TRPRINT,WINDOW
	RTRUE
?L41:	CALL PERFORM,V?MUNG,PRSO,PRSI
	RTRUE
?L40:	EQUAL? PRSA,V?PUT,V?PUT-THROUGH,V?THROW \?L44
	EQUAL? HERE,CABIN \?L45
	EQUAL? PRSA,V?THROW \?L47
	CALL V-THROW >STACK
	RSTACK
?L47:	PRINTI "It doesn't fit through the porthole"
	PRINT PCR
	RTRUE
?L45:	EQUAL? PRSO,COFFER \?L50
	IN? HERO,HERE \?L51
	PRINTR "Jamison stops you, ""Nay, lady, glass is expensive."""
?L51:	REMOVE PRSO
	FSET LEDGE,MUNGBIT
	INC 'SCORE
	PRINTI "You hurl"
	CALL TPRINT,COFFER
	PRINTI " through"
	CALL TPRINT,WINDOW
	PRINTI ", sending it and a shower of glass into the sea. "
	CALL CTPRINT,LEDGE
	PRINTI " now looks deep enough to sit upon"
	PRINT PCR
	CALL PRINT-ID,STR?206 >STACK
	RSTACK
?L50:	FSET? LEDGE,MUNGBIT /?L54
	EQUAL? HERE,CAPT-QUARTERS \?L54
	CALL CTPRINT,WINDOW
	PRINTI " isn't open"
	PRINT PCR
	RTRUE
?L54:	EQUAL? PRSO,HANDS \?L55
	PRINT HUH
	RTRUE
?L55:	CALL PUT-OBJ-THRU-WINDOW >STACK
	RSTACK
?L44:	EQUAL? PRSA,V?DISEMBARK,V?EXIT,V?ENTER /?L58
	EQUAL? PRSA,V?BOARD,V?LEAP-OFF \FALSE
?L58:	EQUAL? HERE,CABIN \?L59
	CALL IMPOSSIBLES >STACK
	RSTACK
?L59:	LOC PROTAGONIST >STACK
	EQUAL? STACK,CAPT-QUARTERS \?L61
	CALL PERFORM-PRSA,LEDGE
	RTRUE
?L61:	EQUAL? HERE,LIBRARY \?L62
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L62:	EQUAL? HERE,BY-HOUSE \?L63
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L63:	EQUAL? HERE,BEDROOM \?L64
	CALL DO-WALK,P?DOWN >STACK
	RSTACK
?L64:	CALL WASTES >STACK
	RSTACK

	.FUNCT PUT-OBJ-THRU-WINDOW
	EQUAL? HERE,CAPT-QUARTERS \?L1
	FSET? LEDGE,MUNGBIT /?L1
	PRINTI "The window isn't open"
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSO,RETICULE /FALSE
	CALL PRONOUN
	PRINTI " fall"
	FSET? PRSO,PLURALBIT /?L5
	PRINTI "s"
?L5:	EQUAL? HERE,CAPT-QUARTERS \?L8
	REMOVE PRSO
	PRINTI " into the seas below"
	JUMP ?L12
?L8:	EQUAL? HERE,BEDROOM \?L10
	MOVE PRSO,CLEARING
	PRINTI " onto the forest floor"
	JUMP ?L12
?L10:	EQUAL? HERE,LIBRARY,LAFS-ROOM \?L11
	MOVE PRSO,BY-HOUSE
	PRINTI " into the darkness of the hedge"
	JUMP ?L12
?L11:	EQUAL? HERE,BY-HOUSE \?L12
	MOVE PRSO,LIBRARY
	PRINTI " with a thunk over"
	PRINT THE-EDGE
	CALL TPRINT,LIB-WINDOW
?L12:	PRINT PCR
	RTRUE

	.FUNCT OPEN-CLOSE,OBJ,OPETELL=0,CLOSETELL=0
	EQUAL? PRSA,V?MOVE,V?RAISE,V?OPEN \?L1
	FSET? OBJ,OPENBIT \?L3
	FSET? OBJ,PLURALBIT \?L5
	PRINTI "They are"
	JUMP ?L7
?L5:	PRINTI "It is"
?L7:	PRINTR " already open."
?L3:	FSET OBJ,OPENBIT
	FSET OBJ,TOUCHBIT
	ZERO? OPETELL /?L9
	PRINT OPETELL
	PRINTR "."
?L9:	EQUAL? OBJ,CUPBOARD-OBJECT \?L11
	EQUAL? HERE,SLEEPING-CUPBOARD /?L11
	PRINTI "Opened. "
	CALL PERFORM,V?LOOK-INSIDE,CUPBOARD-OBJECT
	RTRUE
?L11:	FIRST? OBJ >STACK \?L13
	FSET? OBJ,TRANSBIT /?L13
	FSET? OBJ,DOORBIT \?L12
?L13:	PRINTR "Opened."
?L12:	PRINTI "Opening"
	CALL TPRINT,OBJ
	PRINTI " reveals"
	CALL DESCRIBE-NOTHING >STACK
	ZERO? STACK \TRUE
	PRINTI "."
	RTRUE
?L1:	EQUAL? PRSA,V?CLOSE \FALSE
	FSET? OBJ,OPENBIT /?L19
	FSET? OBJ,PLURALBIT \?L21
	PRINTI "They are"
	JUMP ?L23
?L21:	PRINTI "It is"
?L23:	PRINTI " already closed"
	PRINT PCR
	RTRUE
?L19:	FCLEAR OBJ,OPENBIT
	EQUAL? OBJ,MANACLES \?L25
	FSET OBJ,LOCKEDBIT
?L25:	ZERO? CLOSETELL /?L28
	PRINT CLOSETELL
	PRINTR "."
?L28:	PRINTI "Shut."
	EQUAL? PRSO,CUPBOARD-OBJECT \?L33
	EQUAL? SLEEPING-CUPBOARD,HERE \?L33
	PRINTI " You imagine Jamison being lulled to sleep by the waves lapping against the ship."
?L33:	CRLF
	RTRUE

	.FUNCT TREE-F
	EQUAL? PRSA,V?CLIMB \FALSE
	PRINTR "The trees are all unclimbable."

	.FUNCT TOUCHING?,THING
	EQUAL? PRSO,THING \?L1
	EQUAL? PRSA,V?ALARM,V?BITE,V?BOARD /TRUE
	EQUAL? PRSA,V?CLEAN,V?CLIMB-OVER,V?CRAWL-UNDER /TRUE
	EQUAL? PRSA,V?CLIMB,V?CLIMB-DOWN,V?CLIMB-ON /TRUE
	EQUAL? PRSA,V?CUT,V?DANCE,V?EMBRACE /TRUE
	EQUAL? PRSA,V?ENTER,V?FIDDLE,V?KICK /TRUE
	EQUAL? PRSA,V?KILL,V?KISS,V?KNOCK /TRUE
	EQUAL? PRSA,V?LOOK-UNDER,V?LOOK-INSIDE,V?MOVE /TRUE
	EQUAL? PRSA,V?MUNG,V?WRING,V?ON /TRUE
	EQUAL? PRSA,V?OFF,V?OPEN,V?CLOSE /TRUE
	EQUAL? PRSA,V?PICK,V?PUSH,V?RAISE /TRUE
	EQUAL? PRSA,V?SET,V?STAND-ON,V?SWIM /TRUE
	EQUAL? PRSA,V?TIE,V?THROW,V?RAPE /TRUE
	EQUAL? PRSA,V?TAKE,V?TOUCH,V?SHAKE /TRUE
	EQUAL? PRSA,V?UNLOCK,V?LOCK,V?UNTIE /TRUE
?L1:	EQUAL? PRSI,THING \FALSE
	EQUAL? PRSA,V?PUT-ON,V?PUT,V?GIVE /TRUE
	EQUAL? PRSA,V?PUT-UNDER \FALSE
	RTRUE

	.FUNCT CANT-SEE,OBJ,WRD=0
	EQUAL? PRSO,OBJ \?L1
	PUSH 0
	JUMP ?L3
?L1:	PUSH 1
?L3:	GET P-NAMW,STACK >WRD
	ZERO? WRD \?L4
	EQUAL? PRSO,OBJ \?L6
	PUSH 0
	JUMP ?L8
?L6:	PUSH 1
?L8:	GET P-ADJW,STACK >WRD
?L4:	SET 'P-WON,0
	PRINT YOU-CANT
	PRINTI "see"
	ZERO? OBJ /?L10
	CALL NAME?,WRD >STACK
	ZERO? STACK \?L10
	PRINTI " any"
?L10:	EQUAL? OBJ,PRSI \?L13
	CALL PRSI-PRINT
	JUMP ?L15
?L13:	CALL PRSO-PRINT
?L15:	PRINTI " here."
	CRLF
	CALL STOP >STACK
	RSTACK

	.FUNCT CANT-VERB-A-PRSO,STRING
	PRINT YOU-CANT
	PRINT STRING
	CALL APRINT,PRSO
	PRINTR "!"

	.FUNCT TELL-HIT-HEAD
	PRINTI "You knock your brow against"
	CALL TPRINT-PRSO
	PRINTR " as you attempt this."

	.FUNCT NOUN-USED,TEST-NOUN,OBJ
	EQUAL? PRSO,OBJ \?L1
	GET P-NAMW,0 >STACK
	EQUAL? STACK,TEST-NOUN /TRUE
?L1:	EQUAL? PRSI,OBJ \FALSE
	GET P-NAMW,1 >STACK
	EQUAL? STACK,TEST-NOUN \FALSE
	RTRUE

	.FUNCT ADJ-USED,TEST-ADJ
	GET P-ADJW,1 >STACK
	GET P-ADJW,0 >STACK
	EQUAL? TEST-ADJ,STACK,STACK \FALSE
	RTRUE

	.FUNCT OFF-VEHICLE?,OBJ
	EQUAL? OBJ,LEDGE /TRUE
	EQUAL? OBJ,BENCH \FALSE
	RTRUE

	.FUNCT TELL-OPEN$002fCLOSED,OBJ,AN?=0
	FSET? OBJ,OPENBIT \?L1
	ZERO? AN? /?L3
	PRINTI "n"
?L3:	PRINTI " open"
	RTRUE
?L1:	PRINTI " closed"
	RTRUE

	.FUNCT WHEE
	SET 'AWAITING-REPLY,2
	CALL QUEUE,I-REPLY,2
	PRINTR "Wasn't that fun?"

	.FUNCT IN-PACKAGE
	PRINTI " that came in your game package.
"
	RTRUE

	.FUNCT CANT-REACH,OBJ
	PRINT YOU-CANT
	PRINTI "reach"
	CALL TPRINT,OBJ
	IN? PROTAGONIST,HERE /?L1
	PRINTI " from"
	LOC PROTAGONIST >STACK
	CALL TPRINT,STACK
?L1:	PRINT PCR
	RTRUE

	.FUNCT DO-FIRST,STRING,OBJ=0
	PRINT YOULL-HAVE-TO
	PRINT STRING
	ZERO? OBJ /?L1
	CALL TPRINT,OBJ
?L1:	PRINTR " first."

	.FUNCT NOT-IN
	PRINTI "But"
	CALL TPRINT-PRSO
	PRINTI " isn't "
	FSET? PRSI,ACTORBIT \?L1
	PRINTI "being held by"
	JUMP ?L4
?L1:	FSET? PRSI,SURFACEBIT \?L3
	PRINTI "on"
	JUMP ?L4
?L3:	PRINTI "in"
?L4:	CALL TRPRINT,PRSI
	RTRUE

	.FUNCT SORE,STRING
	PRINTI "You begin to get a sore "
	PRINT STRING
	PRINT PCR
	RTRUE

	.FUNCT CANT-USE-THAT-WAY,STRING
	PRINTI "["
	PRINT YOU-CANT
	PRINTI "use "
	PRINT STRING
	PRINTR " that way.]"

	.FUNCT RECOGNIZE
	SET 'P-WON,0
	PRINTI "[That sentence isn't one I recognize.]
"
	RTRUE

	.FUNCT PRONOUN
	EQUAL? PRSO,ME \?L1
	PRINTI "You"
	RTRUE
?L1:	FSET? PRSO,PLURALBIT \?L3
	PRINTI "They"
	RTRUE
?L3:	EQUAL? PRSO,LUCY \?L4
	PRINTI "She"
	RTRUE
?L4:	FSET? PRSO,ACTORBIT \?L5
	PRINTI "He"
	RTRUE
?L5:	PRINTI "It"
	RTRUE

	.FUNCT REFERRING,HIM-HER=0
	PRINTI "I don't see wh"
	ZERO? HIM-HER /?L1
	PRINTI "o"
	JUMP ?L3
?L1:	PRINTI "at"
?L3:	PRINTR " you're referring to."

	.FUNCT NO-ONE-HERE,STRING
	PRINTI "There's no one here to "
	PRINT STRING
	PRINT PCR
	RTRUE

	.FUNCT SEE-MANUAL,STRING
	PRINTI "[See the instruction manual section entitled ""Communicating With Infocom's Interactive Fiction."" to properly "
	PRINT STRING
	PRINTR "]"

	.FUNCT UNIMPORTANT-THING
	PRINTR "You have no need for that, milady."

	.FUNCT PROPOSE
	SET 'AWAITING-REPLY,1
	CALL QUEUE,I-REPLY,2
	PRINTR "And how do you propose to do that?"

	.FUNCT STOP-QUEUES
	CALL RUNNING?,I-HDANCE >STACK
	ZERO? STACK /?L1
	SET 'PARTNER,0
	CALL DEQUEUE,I-HDANCE >STACK
	RSTACK
?L1:	CALL RUNNING?,I-HFOLLY >STACK
	ZERO? STACK /FALSE
	CALL DEQUEUE,I-HFOLLY >STACK
	RSTACK

	.FUNCT REPERTOIRE,ACT
	PRINT ACT
	PRINTR " is not in the repertoire of well-bred young ladies."

	.FUNCT MAN-IS-DOWN
	PRINT THOROUGHLY-UNLADYLIKE
	PRINTR "hit a man when he's down!"

	.FUNCT NO-TIME-FOR,STR
	PRINTI "This is no time to "
	PRINT STR
	PRINTI "!
"
	RTRUE

	.FUNCT MORE-SPECIFIC
	PRINT YOULL-HAVE-TO
	PRINTR "be more specific."

	.FUNCT CANT-HURT,STR
	PRINTI "Your "
	PRINT STR
	PRINTI " could not hurt"
	CALL TRPRINT,CRULLEY
	RTRUE

	.FUNCT SAILOR-DEATH
	PRINT INDENT
	PRINTI "A sailor notices "
	FSET? PANTS,WORNBIT \?L1
	PRINTI "the roundness of your body through the lace of your chemise"
	JUMP ?L3
?L1:	PRINTI "the ""swish"" of your petticoats"
?L3:	PRINTI ". ""A woman,"" he gasps, ""free, aboard this ship!"""
	CRLF
	CALL PRINT-ID,STR?207
	CALL JIGS-UP,STR?208 >STACK
	RSTACK

	.FUNCT LADY-MUST,STRING
	PRINTI "A lady must obtain her father's permission before "
	PRINT STRING
	PRINTR " anyone."

	.FUNCT FIGURE-IT-OUT
	PRINT YOULL-HAVE-TO
	PRINTI "figure that out "
	PRINTD ME
	PRINT PCR
	RTRUE

	.FUNCT KICKED-OUT
	PRINT INDENT
	EQUAL? HERE,HALL-E \?L1
	PRINTI "A black-garbed "
	PRINTD BUTLER
	JUMP ?L3
?L1:	CALL CTPRINT,BUTLER
?L3:	PRINTI " marches up to you, ""It was made clear at the whippings that villagers are not admitted in this house."" He grasps you by the scruff of the neck and propels you headfirst out the front door"
	PRINT PCR
	CRLF
	CALL GOTO,MAIN-ENTRANCE >STACK
	RSTACK

	.FUNCT NICK-RUNS-OFF
	CALL RUNNING?,I-CCLIMBS-UP >STACK
	ZERO? STACK /?L1
	EQUAL? CRULLEY-CTR,10 \?L1
	CALL QUEUE,I-CCLIMBS-UP,2
?L1:	MOVE HERO,GALLERY
	MOVE LAFOND,GALLERY
	MOVE DAD,GALLERY
	MOVE LUCY,GALLERY
	SET 'HERO-CTR,1
	CALL QUEUE,I-DUEL,-1
	FSET RAPIER,NDESCBIT
	FCLEAR BALLROOM,EVERYBIT
	PRINT INDENT
	PRINTI "Nick kisses you briefly, a butterfly touching your lips,"
	CALL META-LOC,RAPIER >STACK
	EQUAL? STACK,HERE,PASSAGE-4,CELL-4 \?L4
	MOVE RAPIER,HERO
	PRINTI " then seizes his rapier"
?L4:	PRINTI " and runs off to the north. Cookie calls a breathless ""Hullo, Cap'n"" to him as he races past"
	PRINT PCR
	RTRUE

	.FUNCT SHIP-F
	EQUAL? PRSA,V?EXAMINE \?L1
	CALL SHIP-BOARD,HERE >STACK
	ZERO? STACK /?L3
	CALL V-LOOK >STACK
	RSTACK
?L3:	EQUAL? HERE,CABIN,DEUX-DECK \?L5
	CALL ADJ-USED,A?HELENA >STACK
	ZERO? STACK \?L8
	CALL NOUN-USED,W?LOUISE,SHIP >STACK
	ZERO? STACK /?L6
?L8:	CALL PERFORM,V?LOOK-INSIDE,WINDOW
	RTRUE
?L6:	CALL V-LOOK >STACK
	RSTACK
?L5:	EQUAL? HERE,CELL-1,CELL-2,LAFS-ROOM /?L12
	EQUAL? HERE,BEACH,LAGOON /?L12
	EQUAL? HERE,SHALLOWS \?L10
?L12:	FSET? SHIP,MUNGBIT \?L13
	PRINT YOU-CANT
	PRINTI "see"
	CALL TPRINT,SHIP
	PRINTI " anywhere, but a lot of debris floats in the lagoon"
	PRINT PCR
	RTRUE
?L13:	CALL CTPRINT,SHIP
	PRINTI " floats, silent and serene, some distance out in the lagoon"
	PRINT PCR
	RTRUE
?L10:	PRINT YOU-CANT
	PRINTI "see"
	CALL TPRINT,SHIP
	PRINTR " from here."
?L1:	EQUAL? PRSA,V?POINT \?L17
	ZERO? PRSI \FALSE
	CALL PROPOSE >STACK
	RSTACK
?L17:	EQUAL? PRSA,V?PUT \FALSE
	EQUAL? PRSO,MIRROR,TRAY \FALSE
	CALL IMPOSSIBLES >STACK
	RSTACK

	.FUNCT GEN-BOAT
	CALL GLOBAL-IN?,OBJ-QUARTERS,HERE >STACK
	ZERO? STACK /?L1
	RETURN OBJ-QUARTERS
?L1:	LOC SKIFF >STACK
	EQUAL? STACK,HERE \?L3
	RETURN SKIFF
?L3:	RETURN SHIP

	.FUNCT DEBRIS-F
	FSET? SHIP,MUNGBIT /?L1
	PRINT YOU-CANT-SEE-ANY
	PRINTD DEBRIS
	PRINTR " here!"
?L1:	EQUAL? PRSA,V?LOOK-INSIDE,V?SEARCH,V?EXAMINE \?L3
	PRINT INDENT
	CALL PICK-ONE,DEBRIS-BITS >STACK
	PRINT STACK
	EQUAL? HERE,BEACH,SHALLOWS \?L4
	PRINTR "bobs briefly in the waves."
?L4:	PRINTR "floats by you."
?L3:	EQUAL? PRSA,V?TAKE \FALSE
	PRINTI "You reconsider, thinking of"
	CALL TPRINT,SHIP
	PRINTR " as it was, whole and proud."

	.FUNCT SHIP-BOARD,RM
	EQUAL? RM,CAPT-QUARTERS,LANDING,SLEEPING-CUPBOARD /TRUE
	EQUAL? RM,AFT-HOLD,HOLD,CREWS-QUARTERS /TRUE
	EQUAL? RM,POOP,QUARTERDECK,MAIN-DECK /TRUE
	EQUAL? RM,FOCSLE,GALLEY,BOWSPRIT /TRUE
	EQUAL? RM,CROWS-NEST /TRUE
	EQUAL? RM,BY-SHIP,ON-LADDER,RIGGING-ROOM \FALSE
	RTRUE

	.FUNCT INNER-DECK,RM
	EQUAL? RM,SLEEPING-CUPBOARD,LANDING,AFT-HOLD /TRUE
	EQUAL? RM,HOLD,CREWS-QUARTERS,GALLEY \FALSE
	RTRUE

	.FUNCT CABIN-EXIT
	IN? HERO,HERE \?L1
	GRTR? HERO-CTR,3 \?L3
	CALL DEQUEUE,I-MEET-HERO
	CALL DEQUEUE,I-PIRATE-ATTACK
	PRINT CTHE-PIRATE-CAPTAIN
	PRINTI "follows you through"
	CALL TRPRINT,DOOR
	CRLF
	RETURN DEUX-DECK
?L3:	PRINT SINEWY-ARM
	CRLF
	RFALSE
?L1:	IN? HERO,DEUX-DECK \?L6
	RETURN DEUX-DECK
?L6:	IN? CRULLEY,HERE \?L7
	PRINTI """Not that way, me pretty,"" says"
	CALL TPRINT,CRULLEY
	PRINTI ", blocking your way"
	PRINT PCR
	RFALSE
?L7:	CALL CTPRINT,DOOR
	PRINT IS-CLOSED
	PRINT PCR
	CALL THIS-IS-IT,DOOR
	RFALSE

	.FUNCT DEUX-DECK-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	MOVE HERO,HERE
	PRINTI "The deck is an avalanche of noise and blood. Lit by roaring fires, silhouetted forms crash swords, dancing around the screaming wounded."
	RTRUE
?L1:	EQUAL? RARG,M-ENTER \FALSE
	CALL QUEUE,I-END-PROLOGUE,1 >STACK
	RSTACK

	.FUNCT COFFER-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "It is a small heavy chest, with a "
	FSET? COFFER,MUNGBIT \?L3
	PRINTI "smashed "
?L3:	PRINTI "lock. It is"
	CALL TELL-OPEN$002fCLOSED,PRSO
	PRINTI ".
"
	RTRUE
?L1:	EQUAL? PRSA,V?TAKE \?L6
	EQUAL? PRSO,COFFER \FALSE
	FSET? COFFER,NDESCBIT /?L9
	FSET COFFER,TAKEBIT
	CALL DEQUEUE,I-COFFER
	MOVE COFFER,PROTAGONIST
	FCLEAR COFFER,NDESCBIT
	PRINTI "Taken."
	CRLF
	CALL IS-THEFT? >STACK
	CALL PRINT-ID,STR?209,STACK >STACK
	RSTACK
?L9:	PRINT HUH
	RTRUE
?L6:	EQUAL? PRSA,V?MUNG \?L13
	EQUAL? PRSO,WINDOW \?L13
	CALL PERFORM,V?PUT-THROUGH,COFFER,WINDOW
	RTRUE
?L13:	EQUAL? PRSA,V?STAND-ON,V?BOARD \?L14
	CALL CTPRINT,COFFER
	PRINTR " is too small to stand on."
?L14:	EQUAL? PRSA,V?SHAKE \FALSE
	FSET? COFFER,LOCKEDBIT \FALSE
	PRINTI "It seems to be full of small, heavy objects"
	PRINT PCR
	RTRUE

	.FUNCT LETTER-F
	EQUAL? PRSA,V?EXAMINE,V?READ \FALSE
	CALL CTPRINT,LETTER
	PRINTI " is in dear Papa's handwriting:

""Dearest child,
   You are in gravest danger! Lafond is a viper with the smile of a saint, my most particular enemy. I have only now learned the depth of his deception. Should Lafond get you in his power... It is unspeakable!
   I have sided with Nicholas Jamison, a sea captain and a gentleman, whose circumstances have driven him to extreme measures, even branding him a pirate. Nevertheless, I trust him and so may you.
   You will be safe -- but there is another for whom I fear! My horse is waiting and I ride to her rescue. Jamison will deliver this to you. Should anything happen to me, you must rely on him. I remain, with love,"
	CALL TPRINT,DAD
	PRINTI "."""
	CRLF
	CRLF
	RTRUE

	.FUNCT INVITE-F
	EQUAL? PRSA,V?EXAMINE,V?READ \?L1
	CALL CTPRINT,INVITE
	PRINTI " is addressed to ""Davis"":

       In Honor of Jean Lafond,
         recently proclaimed
       Governor of "
	PRINTD ISLAND
	PRINTI "
        A Dance at his Mansion
      Ananas Road, "
	PRINTD ISLAND
	PRINTI "
Formal Dress and Invitation Required"
	PRINT PCR
	CRLF
	FSET? INVITE,MUNGBIT /FALSE
	FSET INVITE,MUNGBIT
	PRINT INDENT
	PRINTR "A ball! You haven't been to a ball in months!"
?L1:	EQUAL? PRSA,V?SGIVE,V?SSHOW \FALSE
	EQUAL? PRSO,BUTLER \FALSE
	CALL PERFORM,V?GIVE,INVITE,BUTLER
	RTRUE

	.FUNCT I-COFFER
	CALL HELD?,COFFER >STACK
	ZERO? STACK \FALSE
	FCLEAR COFFER,NDESCBIT
	FSET COFFER,TAKEBIT
	CALL THIS-IS-IT,COFFER
	PRINT INDENT
	PRINTI "Suddenly, the ship lurches to one side, throwing you "
	LOC PROTAGONIST >STACK
	EQUAL? STACK,CABIN-BED \?L3
	MOVE PROTAGONIST,HERE
	PRINTI "out of the bed. "
	CALL PRINT-ID,STR?210
	JUMP ?L5
?L3:	PRINTI "off balance. "
?L5:	FSET? COFFER,TOUCHBIT \?L6
	CALL CTPRINT,COFFER
	JUMP ?L8
?L6:	PRINTI "A "
	PRINTD COFFER
	PRINTI " slides from under the bed and"
?L8:	PRINTR " bumps against your foot."

	.FUNCT CAPT-QUARTERS-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	IN? LEDGE,ON-LADDER \?L3
	MOVE LEDGE,CAPT-QUARTERS
	RTRUE
?L3:	FSET? CAPT-QUARTERS,TOUCHBIT /FALSE
	MOVE PROTAGONIST,CAPT-BED
	SET 'HERO-CTR,0
	CALL QUEUE,I-HSHIP,2
	PRINTI "TWO DAYS LATER"
	PRINT ELLIPSIS
	PRINT INDENT
	PRINTI "You blear awake from a bored nap, focusing on something shiny. You discern it to be"
	CALL APRINT,HRING
	PRINTI ", on a strong hand in the act of tying a ribbon onto"
	CALL ARPRINT,RAPIER
	PRINT INDENT
	PRINTI "The man with"
	CALL TPRINT,RAPIER
	PRINTI " and the ring turns, ""Sorry, I tried not to wake you."" You sit up as if the bed had caught fire, for this is the Falcon, changed from his rags to a finery all red velvet and white lace -- and in your presence!"
	CRLF
	CRLF
	RTRUE
?L1:	EQUAL? RARG,M-LOOK \FALSE
	FSET? HERE,MUNGBIT /?L8
	FSET HERE,MUNGBIT
	PRINTI "You are in the captain's "
	PRINTD OBJ-QUARTERS
	PRINTI " of the "
	PRINTD SHIP
	PRINTI ", where you have been trapped these past days since your ""rescue"" from the Lafond Deux. "
?L8:	PRINTI "The room has a masculine air, with ebony panelling, a large messy table, and a rumpled bed"
	LOC PROTAGONIST >STACK
	EQUAL? STACK,CAPT-BED \?L11
	PRINTI " (upon which you lie)"
?L11:	PRINTI ". A curtain masks the forward exit and "
	FSET? LEDGE,MUNGBIT \?L14
	PRINTI "air breezes in over the ledge"
	JUMP ?L16
?L14:	PRINTI "gilded woodwork decorates the sill of the tall window looking"
?L16:	PRINTI " aft."
	RTRUE

	.FUNCT I-HERO-TO-ISLAND
	EQUAL? HERE,CAPT-QUARTERS \?L1
	PRINT INDENT
	PRINTI "Men clomp about overhead and a rope ladder unfurls itself past the window. Jamison climbs down it, entering"
	CALL TPRINT,SKIFF
	PRINTI " that awaits him below. He rows to the island as the men above "
	PRINTD HEAD
	PRINTI " disperse, calling farewells to their captain"
	PRINT PCR
?L1:	SET 'SKIFF-LOC,1
	SET 'SKIFF-TIED,0
	REMOVE HERO
	SET 'LADDER-HANGING,1
	CALL QUEUE,I-SEE-LADDER,-1 >STACK
	RSTACK

	.FUNCT I-SEE-LADDER
	EQUAL? HERE,CAPT-QUARTERS \?L1
	CALL QUEUE,I-SEE-LADDER,-1
	RANDOM 100 >STACK
	LESS? 40,STACK /FALSE
	PRINT INDENT
	PRINTI "The end of a rope ladder blows "
	LOC PROTAGONIST >STACK
	EQUAL? STACK,CAPT-BED,CAPT-QUARTERS \?L5
	PRINTR "past the window."
?L5:	PRINTR "by."
?L1:	CALL DEQUEUE,I-SEE-LADDER >STACK
	RSTACK

	.FUNCT PAPERS-F
	CALL UNIMPORTANT-THING >STACK
	RSTACK

	.FUNCT ON-LADDER-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	MOVE LEDGE,HERE
	CALL DEQUEUE,I-SEE-LADDER >STACK
	RSTACK
?L1:	EQUAL? RARG,M-BEG \?L3
	EQUAL? PRSA,V?LEAP-OFF,V?LEAP /?L4
	EQUAL? PRSA,V?DROP \?L3
	EQUAL? PRSO,LADDER \?L3
?L4:	CALL DO-WALK,P?DOWN >STACK
	RSTACK
?L3:	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You are clinging to a slimy ladder, tied to a rail of the poop deck above you. Not far from your feet,"
	ZERO? SKIFF-TIED /?L6
	CALL APRINT,SKIFF
	PRINTI " bobs in the water"
	JUMP ?L8
?L6:	PRINTI " waves kiss the stern of the ship"
?L8:	FSET? ON-LADDER,TOUCHBIT /?L9
	PRINTI ". The ladder twists under your weight"
?L9:	PRINTI "."
	RTRUE

	.FUNCT OBJ-QUARTERS-F
	EQUAL? PRSA,V?EXAMINE \?L1
	CALL NOUN-USED,W?QUARTE,OBJ-QUARTERS >STACK
	ZERO? STACK /?L3
	EQUAL? HERE,POOP,LANDING \?L3
	PRINTR "Why don't you go there and look?"
?L3:	CALL V-LOOK >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?ENTER,V?CLIMB,V?BOARD \FALSE
	EQUAL? HERE,DEUX-DECK,ON-LADDER \FALSE
	CALL DO-WALK,P?IN >STACK
	RSTACK

	.FUNCT I-LADDER-BLOWS
	INC 'BLOWING-LADDER-C
	LESS? BLOWING-LADDER-C,2 /TRUE
	PRINT INDENT
	EQUAL? BLOWING-LADDER-C,2,5 \?L4
	PRINTI "All air is driven out of you as"
	CALL TPRINT,LADDER
	PRINTI " slams into the stern."
	CRLF
	CALL PRINT-ID,STR?211 >STACK
	RSTACK
?L4:	EQUAL? BLOWING-LADDER-C,3,6 \?L6
	PRINTI "Rebounding,"
	CALL TPRINT,LADDER
	PRINTI " twists you around to face"
	CALL TRPRINT,SHIP
	RTRUE
?L6:	EQUAL? BLOWING-LADDER-C,4 \?L7
	PRINTI "The ladder swings back towards"
	CALL TRPRINT,SHIP
	RTRUE
?L7:	EQUAL? BLOWING-LADDER-C,7 \FALSE
	CALL PRINT-ID,STR?212
	CALL JIGS-UP,STR?213 >STACK
	RSTACK

	.FUNCT LADDER-EXIT,CRUFTY-KLUDGE=0
	CALL DEQUEUE,I-LADDER-BLOWS
	PRINTI "You pull "
	PRINTD ME
	PRINTI " over"
	CALL TPRINT,LEDGE
	PRINTI ", tumbling head over heels into Jamison's "
	PRINTD OBJ-QUARTERS
	PRINT PCR
	CRLF
	ZERO? CRUFTY-KLUDGE /?L1
	CALL GOTO,CAPT-QUARTERS >STACK
	RSTACK
?L1:	RETURN CAPT-QUARTERS

	.FUNCT CURTAIN-EXIT
	IN? HERO,HERE \?L1
	PRINT SINEWY-ARM
	CRLF
	RFALSE
?L1:	LOC PROTAGONIST >STACK
	EQUAL? STACK,LEDGE \?L3
	RETURN CAPT-QUARTERS
?L3:	FSET? LANDING,TOUCHBIT /?L5
	CALL CTPRINT,CUPBOARD-OBJECT
	PRINT ISNT-FLUSH
?L5:	PRINTI "You"
	PRINT SQUEEZE-THRU
	PRINT PCR
	CRLF
	EQUAL? P-WALK-DIR,P?SOUTH \?L8
	ZERO? LADDER-HANGING /?L10
	CALL QUEUE,I-SEE-LADDER,-1
?L10:	FSET PILE-OF-CLOTHES,NDESCBIT
	MOVE CUPBOARD-OBJECT,CAPT-QUARTERS
	RETURN CAPT-QUARTERS
?L8:	FCLEAR PILE-OF-CLOTHES,NDESCBIT
	MOVE CUPBOARD-OBJECT,LANDING
	CALL DEQUEUE,I-SEE-LADDER
	RETURN LANDING

	.FUNCT WINDOW-EXIT
	CALL PERFORM,V?BOARD,LEDGE
	RFALSE

	.FUNCT LEDGE-F,VARG=0
	EQUAL? VARG,M-BEG \?L1
	EQUAL? PRSA,V?TAKE-OFF,V?CLIMB-DOWN,V?DISEMBARK \?L3
	EQUAL? PRSO,DRESS,LADDER /?L3
	MOVE PROTAGONIST,HERE
	FSET LADDER,TRYTAKEBIT
	PRINTR "You clamber off the sill to safety."
?L3:	EQUAL? PRSA,V?LEAP-OFF,V?LEAP /?L6
	EQUAL? PRSA,V?ENTER \?L5
	EQUAL? PRSO,SEA \?L5
?L6:	PRINT SUICIDE
	CALL PRINT-ID,STR?214 >STACK
	RSTACK
?L5:	EQUAL? PRSA,V?WALK \FALSE
	EQUAL? P-WALK-DIR,P?NORTH \?L8
	CALL PERFORM,V?DISEMBARK,LEDGE
	RTRUE
?L8:	EQUAL? P-WALK-DIR,P?UP /FALSE
	CALL DO-FIRST,STR?215,LEDGE >STACK
	RSTACK
?L1:	ZERO? VARG \FALSE
	EQUAL? PRSA,V?EXAMINE \?L14
	FSET? LEDGE,MUNGBIT \?L15
	PRINTI "Glass shards decorate"
	CALL TRPRINT,LEDGE
	RTRUE
?L15:	PRINTI "Tall panes of glass are inset into"
	CALL TRPRINT,LEDGE
	RTRUE
?L14:	EQUAL? PRSA,V?MUNG \?L18
	ZERO? PRSI \?L18
	CALL PRINT-ID,STR?216
	CALL PROPOSE >STACK
	RSTACK
?L18:	EQUAL? PRSA,V?LEAP-OFF \?L19
	FSET? LEDGE,MUNGBIT \?L20
	CALL DO-FIRST,STR?125,LEDGE >STACK
	RSTACK
?L20:	PRINT SUICIDE
	CALL PRINT-ID,STR?217 >STACK
	RSTACK
?L19:	EQUAL? PRSA,V?DISEMBARK,V?CLIMB-ON,V?BOARD /?L24
	EQUAL? PRSA,V?ENTER,V?STAND-ON \FALSE
?L24:	EQUAL? HERE,CAPT-QUARTERS \?L25
	FSET? LEDGE,MUNGBIT /?L27
	PRINTI "The available ledge on this side of the window is hardly deep enough to sit on"
	PRINT PCR
	RTRUE
?L27:	PRINTI "You climb onto the ledge. "
	FSET? POOP,TOUCHBIT /?L30
	FSET LADDER,TAKEBIT
?L30:	ZERO? LADDER-HANGING /?L33
	CALL QUEUE,I-SEE-LADDER,2
	CALL CTPRINT,LADDER
	PRINTI " drifts within reach."
?L33:	CRLF
	MOVE PROTAGONIST,LEDGE
	RTRUE
?L25:	EQUAL? HERE,ON-LADDER \FALSE
	CALL LADDER-EXIT,1
	RTRUE

	.FUNCT GEN-BED
	RETURN CAPT-BED

	.FUNCT LANDING-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You are on the landing of a steep stairway heading up and down. A "
	PRINTD CUPBOARD-OBJECT
	PRINTI " against the aft wall blocks the doorway to the captain's "
	PRINTD OBJ-QUARTERS
	PRINTI "."
	RTRUE

	.FUNCT SLEEPING-CUPBOARD-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "The bed is softer than it looks, plumped up with fresh straw. A soft, if somewhat cramped, bunk for the tall bulk of Jamison. The cupboard opens to the fore."
	RTRUE
?L1:	EQUAL? RARG,M-BEG \FALSE
	EQUAL? PRSA,V?DISEMBARK \FALSE
	EQUAL? PRSO,CUPBOARD-OBJECT \FALSE
	CALL DO-WALK,P?OUT >STACK
	RSTACK

	.FUNCT CUPBOARD-EXIT
	FSET? CUPBOARD-OBJECT,OPENBIT /?L1
	EQUAL? P-WALK-DIR,P?IN \?L3
	CALL DO-FIRST,STR?148,CUPBOARD-OBJECT
	RFALSE
?L3:	FSET CUPBOARD-OBJECT,OPENBIT
	PRINTI "You open"
	CALL TPRINT,CUPBOARD-OBJECT
	PRINTI " and clamber out"
	PRINT PCR
	CRLF
	MOVE CUPBOARD-OBJECT,LANDING
	RETURN LANDING
?L1:	EQUAL? P-WALK-DIR,P?IN \?L7
	IN? PILE-OF-CLOTHES,CUPBOARD-OBJECT \?L9
	MOVE PILE-OF-CLOTHES,SLEEPING-CUPBOARD
?L9:	MOVE CUPBOARD-OBJECT,SLEEPING-CUPBOARD
	RETURN SLEEPING-CUPBOARD
?L7:	IN? PILE-OF-CLOTHES,SLEEPING-CUPBOARD \?L13
	MOVE PILE-OF-CLOTHES,CUPBOARD-OBJECT
?L13:	MOVE CUPBOARD-OBJECT,LANDING
	RETURN LANDING

	.FUNCT CUPBOARD-OBJECT-F
	EQUAL? PRSA,V?MOVE,V?PUSH \?L1
	CALL CTPRINT,CUPBOARD-OBJECT
	PRINT ISNT-FLUSH
	PRINT SQUEEZE-AROUND
	RTRUE
?L1:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L3
	EQUAL? HERE,CAPT-QUARTERS \?L3
	CALL CTPRINT,DOOR
	PRINTI " is on the other side of"
	CALL TRPRINT,CUPBOARD-OBJECT
	RTRUE
?L3:	EQUAL? PRSA,V?SEARCH,V?LOOK-INSIDE,V?EXAMINE \?L4
	EQUAL? HERE,SLEEPING-CUPBOARD \?L5
	CALL V-LOOK >STACK
	RSTACK
?L5:	EQUAL? HERE,CAPT-QUARTERS \?L7
	PRINT YOU-SEE
	PRINT THE-BACK
	CALL TPRINT,CUPBOARD-OBJECT
	PRINTI ". "
	PRINT SQUEEZE-AROUND
	RTRUE
?L7:	FSET? CUPBOARD-OBJECT,OPENBIT \?L8
	PRINTI "It is a dark messy bed, set entirely within and filling"
	CALL TPRINT,CUPBOARD-OBJECT
	PRINTI ". A cabin boy must sleep here when Jamison isn't using it."
	FSET? PILE-OF-CLOTHES,TOUCHBIT /?L9
	PRINTI " "
	GETP PILE-OF-CLOTHES,P?FDESC >STACK
	PRINT STACK
?L9:	CRLF
	RTRUE
?L8:	PRINTI "It"
	PRINT IS-CLOSED
	PRINT PCR
	RTRUE
?L4:	EQUAL? PRSA,V?BOARD,V?ENTER \?L13
	EQUAL? HERE,SLEEPING-CUPBOARD \?L14
	PRINT LOOK-AROUND
	RTRUE
?L14:	EQUAL? HERE,CAPT-QUARTERS \?L16
	PRINT YOU-CANT-SEE-ANY
	PRINT WAY-TO-DO-THAT
	RTRUE
?L16:	CALL DO-WALK,P?IN >STACK
	RSTACK
?L13:	EQUAL? PRSA,V?PUT \FALSE
	PRINT YOULL-HAVE-TO
	PRINTI "get in the "
	PRINTD CUPBOARD-OBJECT
	PRINTI " to do that"
	PRINT PCR
	RTRUE

	.FUNCT HOLD-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	FSET? HERE,TOUCHBIT /?L1
	FSET? POOP,TOUCHBIT /?L1
	PRINTI "You hear a scuffling noise ahead, and scraping up near the ceiling. You would think it was caused by rats, but for the definite curse you heard before all the movement"
	PRINT PCR
	CRLF
	RTRUE
?L1:	EQUAL? RARG,M-END \?L3
	ZERO? FUSE-LIT /?L3
	FSET? FUSE,TOUCHBIT /?L3
	CALL DEQUEUE,I-SMELL-SMOKE
	CALL I-SMELL-SMOKE
	RFALSE
?L3:	EQUAL? RARG,M-LOOK \FALSE
	CALL HATCH-DESC
	PRINTI " above. Rats' scratchings counterpoint the lullaby of bilge water sloshing in the bulkheads, punctuated by footsteps slapping the deck overhead. You may move fore or aft.
   Behind a high fence, decorated by a sign, are stacked"
	CALL TPRINT,SUPPLIES
	PRINTI "; casks of rum, water, flour and salt meat interspersed with kegs of gunpowder and shot. A closed gate is the only way in."
	RTRUE

	.FUNCT HATCH-F
	EQUAL? PRSA,V?EXAMINE \?L1
	EQUAL? HERE,HOLD \?L3
	CALL HATCH-DESC
	PRINT PCR
	RTRUE
?L3:	FSET? HATCH,OPENBIT \?L6
	PRINT STEEP-STAIRS
	PRINTR "into murky darkness."
?L6:	PRINTI "Canvas stretches across"
	CALL TRPRINT,HATCH
	RTRUE
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \?L9
	FSET? HATCH,OPENBIT \?L10
	CALL PERFORM,V?EXAMINE,HATCH
	RTRUE
?L10:	CALL CTPRINT,HATCH
	PRINT IS-CLOSED
	PRINT PCR
	RTRUE
?L9:	EQUAL? PRSA,V?OPEN \FALSE
	FSET? HATCH,OPENBIT /FALSE
	EQUAL? HERE,MAIN-DECK \?L14
	FSET HATCH,OPENBIT
	PRINTI "You pull a corner of canvas out of the frame. "
	CALL PERFORM,V?EXAMINE,HATCH
	RTRUE
?L14:	PRINT YOU-CANT-SEE-ANY
	PRINT WAY-TO-DO-THAT
	RTRUE

	.FUNCT HATCH-DESC
	FSET? HATCH,OPENBIT \?L1
	PRINTI "Moonlight shines down the stairs through an open corner of the canvas hatch"
	RTRUE
?L1:	PRINTI "Steep stairs lead up in the dimness to a canvas hatch"
	RTRUE

	.FUNCT FENCE-F
	EQUAL? PRSA,V?LOOK-INSIDE,V?LOOK-BEHIND \?L1
	CALL CTPRINT,SUPPLIES
	PRINTI " are kept locked behind the fence. "
	ZERO? FUSE-LIT /?L3
	CALL PERFORM,V?EXAMINE,FUSE
	RTRUE
?L3:	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \?L6
	CALL CTPRINT,FENCE
	PRINTR " is made of thick, finely woven wire mesh, uncuttable and unclimbable. Except for a gap of about 6 inches over the closed gate, the cage is secure from ceiling to damp floorboards."
?L6:	EQUAL? PRSA,V?THROW-OVER \?L7
	PRINTI "You'd best throw"
	CALL TPRINT-PRSO
	PRINTI " over"
	CALL TRPRINT,GATE
	RTRUE
?L7:	EQUAL? PRSA,V?CLIMB \?L8
	PRINTI "You can't get a toehold in"
	CALL TRPRINT,FENCE
	RTRUE
?L8:	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	PRINT YOULL-HAVE-TO
	PRINTI "do that to the gate in"
	CALL TRPRINT,FENCE
	RTRUE

	.FUNCT GATE-MADE-SAME,STR
	PRINTI "The gate is made of the same "
	PRINT STR
	PRINTI " wire as"
	CALL TPRINT,FENCE
	RTRUE

	.FUNCT GATE-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "It has a huge iron lock. Between"
	CALL TPRINT,GATE
	PRINTR " and the ceiling, however, is a gap of about 6 inches."
?L1:	EQUAL? PRSA,V?ENTER \?L3
	CALL NOUN-USED,W?GAP,GATE >STACK
	ZERO? STACK /?L3
	CALL PERFORM,V?CLIMB,GATE
	RTRUE
?L3:	EQUAL? PRSA,V?EXIT,V?CLIMB-OVER,V?CLIMB \?L4
	CALL GATE-MADE-SAME,STR?218
	PRINTI ", and you cannot get a foothold"
	PRINT PCR
	RTRUE
?L4:	EQUAL? PRSA,V?CUT \?L5
	CALL GATE-MADE-SAME,STR?219
	PRINT PCR
	RTRUE
?L5:	EQUAL? PRSA,V?LOOK-BEHIND \?L6
	CALL PERFORM-PRSA,FENCE >STACK
	RSTACK
?L6:	EQUAL? PRSA,V?THROW-OVER \?L7
	PRINTI "You throw"
	EQUAL? PRSO,RAG \?L8
	REMOVE RAG
	FCLEAR RAG,TOUCHBIT
	CALL TPRINT,RAG
	PRINTI " over the gate. "
	ZERO? FUSE-LIT \?L10
	PRINTI "It falls to the floor amongst the food supplies"
	PRINT PCR
	RTRUE
?L10:	ZERO? WET-RAG \?L12
	PRINTI "It flaps haplessly in the air, settling to the floor not far from the burning fuse"
	PRINT PCR
	RTRUE
?L12:	PRINTI "Luckily, it lands directly on the burning end of the fuse. "
	EQUAL? WET-RAG,RUM \?L14
	CALL QUEUE,I-SHIP-EXPLODES,9
	CALL DEQUEUE,I-TEAR-RAG
	PRINTI "Unluckily, it is soaked with flammable rum, and flares up, making the fuse burn much faster. You have perhaps 3 minutes to live."
	CRLF
	CALL PRINT-ID,STR?220
	JUMP ?L16
?L14:	EQUAL? WET-RAG,WATER \?L16
	CALL DEQUEUE,I-SHIP-EXPLODES
	CALL DEQUEUE,I-TEAR-RAG
	SET 'FUSE-LIT,0
	FSET FUSE,NDESCBIT
	INC 'SCORE
	PRINTI "With a sputter and a sigh, the flame dies."
	CRLF
	CALL PRINT-ID,STR?221
?L16:	SET 'WET-RAG,0
	RTRUE
?L8:	EQUAL? PRSO,DRESS \?L18
	CALL TPRINT,DRESS
	PRINTI " up, "
	ZERO? WET-DRESS /?L19
	MOVE DRESS,HOLD
	PRINTI "its soaked skirt slapping "
	PRINTD HEAD
	PRINTI ". Too heavy and bulky to make it over the gate, it squelches to the floor nearby. A cold tear of "
	PRINTD WET-DRESS
	PRINTI " dribbles down the back of your neck"
	PRINT PCR
	RTRUE
?L19:	MOVE DRESS,HERE
	PRINTI "but it billows out and catches on the top of the gate. It floats to the floor near you"
	PRINT PCR
	RTRUE
?L18:	REMOVE PRSO
	CALL TPRINT-PRSO
	PRINTI " into the ammunition area. It skids into the darkness"
	ZERO? FUSE-LIT /?L23
	PRINTI ", over the burning end of the fuse. The fuse falters, spits and resumes burning"
?L23:	PRINT PCR
	RTRUE
?L7:	EQUAL? PRSA,V?THROW,V?PUT-THROUGH,V?PUT \FALSE
	CALL NOUN-USED,W?GAP,GATE >STACK
	ZERO? STACK /FALSE
	CALL PERFORM,V?THROW-OVER,PRSO,GATE
	RTRUE

	.FUNCT KEG-F
	CALL TOUCHING?,KEG >STACK
	ZERO? STACK \?L3
	CALL TOUCHING?,SUPPLIES >STACK
	ZERO? STACK /FALSE
?L3:	CALL CANT-REACH,SUPPLIES >STACK
	RSTACK

	.FUNCT SIGN-F
	EQUAL? PRSA,V?EXAMINE,V?READ \FALSE
	PRINTR "The sign proclaims ""Thieves be keel-hauled"" in uncertain lettering."

	.FUNCT I-SMELL-SMOKE
	CALL QUEUED?,I-SHIP-EXPLODES >STACK
	ZERO? STACK \?L1
	SET 'FUSE-LIT,1
	FCLEAR FUSE,NDESCBIT
	CALL QUEUE,I-TEAR-RAG,85
?L1:	FSET? FUSE,TOUCHBIT /FALSE
	EQUAL? HERE,MAIN-DECK \?L7
	FSET? HATCH,OPENBIT /?L6
?L7:	EQUAL? HERE,HOLD \FALSE
?L6:	FSET FUSE,TOUCHBIT
	FCLEAR FUSE,INVISIBLE
	PRINT INDENT
	PRINTI "You gradually notice a familiar, worrying smell, sniff, and identify it as smoke. "
	EQUAL? HERE,MAIN-DECK \?L8
	PRINTI "It appears to come from below decks."
	CRLF
	RFALSE
?L8:	EQUAL? HERE,HOLD \FALSE
	PRINT TINY-GLOW
	PRINT PCR
	RFALSE

	.FUNCT I-TEAR-RAG
	CALL QUEUE,I-SHIP-EXPLODES,15
	LOC RAG >STACK
	ZERO? STACK \FALSE
	ZERO? FUSE-LIT /FALSE
	FSET? DRESS,WORNBIT /?L5
	IN? DRESS,PROTAGONIST \?L3
?L5:	ZERO? WET-DRESS /?L6
	SET 'WET-RAG,1
?L6:	FSET DRESS,MUNGBIT
	PRINT INDENT
	PRINTI "Your frock"
	JUMP ?L11
?L3:	IN? SHIRT,PROTAGONIST \?L9
	FSET SHIRT,MUNGBIT
	PRINT INDENT
	PRINTI "The tail of your shirt"
	JUMP ?L11
?L9:	FSET? CHEMISE,EVERYBIT /TRUE
	FSET CHEMISE,MUNGBIT
	PRINT INDENT
	PRINTI "Your chemise"
?L11:	LOC PROTAGONIST >STACK
	MOVE RAG,STACK
	PRINTI " suddenly catches on something, tearing the fabric. A large scrap flutters to your feet."
	CRLF
	CALL PRINT-ID,STR?222 >STACK
	RSTACK

	.FUNCT I-SHIP-EXPLODES
	ZERO? FUSE-LIT /FALSE
	FSET SHIP,MUNGBIT
	SET 'SHIP-LOC,10
	CALL DEQUEUE,I-SHIP-EXPLODES
	CALL DEQUEUE,I-TEAR-RAG
	CALL SHIP-BOARD,HERE >STACK
	ZERO? STACK \?L5
	EQUAL? HERE,BY-SHIP \?L3
?L5:	CALL PRINT-ID,STR?223
	CALL JIGS-UP,STR?224 >STACK
	RSTACK
?L3:	LOC PROTAGONIST >STACK
	EQUAL? STACK,SKIFF,CASK,BEACH \?L6
	PRINT INDENT
	PRINTI "A huge wave "
	EQUAL? HERE,BEACH \?L7
	PRINTI "rolls up the beach"
	JUMP ?L9
?L7:	PRINTI "rocks"
	LOC PROTAGONIST >STACK
	CALL TPRINT,STACK
?L9:	PRINTI " as"
	CALL TPRINT,SHIP
	PRINTI " explodes into flames across the lagoon"
	PRINT PCR
	CALL PRINT-ID,STR?225 >STACK
	RSTACK
?L6:	PRINT INDENT
	PRINTI "You hear a noise like a huge explosion in the distance, and the ground shakes beneath your feet. There should be good beachcombing tomorrow"
	PRINT PCR
	CALL PRINT-ID,STR?226 >STACK
	RSTACK

	.FUNCT FUSE-F,OARG=0,C=0,X=0
	ZERO? OARG /?L1
	EQUAL? OARG,M-DESC? /TRUE
	PRINT INDENT
	PRINT TINY-GLOW
	PRINTI "."
	RTRUE
?L1:	EQUAL? PRSA,V?PUT-ON,V?POUR \?L6
	EQUAL? PRSO,DRESS,RAG \?L6
	CALL PROPOSE >STACK
	RSTACK
?L6:	EQUAL? PRSA,V?TAKE,V?MOVE \?L7
	CALL CANT-REACH,FUSE >STACK
	RSTACK
?L7:	EQUAL? PRSA,V?POUR,V?OFF,V?ON /?L9
	EQUAL? PRSA,V?CUT,V?PUT-ON /?L9
	CALL TOUCHING?,FUSE >STACK
	ZERO? STACK /?L8
?L9:	PRINT YOU-ARENT
	PRINTI "anywhere near"
	CALL TPRINT,FUSE
	PRINTR "!"
?L8:	EQUAL? PRSA,V?EXAMINE \?L10
	ZERO? FUSE-LIT /?L11
	PRINTI "The burning fuse is "
	CALL QUEUED?,I-SHIP-EXPLODES >C
	ZERO? C /?L13
	GET C,C-TICK >STACK
	SUB 15,STACK >X
	GRTR? X,12 \?L15
	PRINTI "boring a hole through the largest powder keg"
	PRINT PCR
	RTRUE
?L15:	GRTR? X,7 \?L17
	PRINTI "mere inches"
	JUMP ?L24
?L17:	PRINTI "only a foot"
	JUMP ?L24
?L13:	CALL QUEUED?,I-TEAR-RAG >C
	GET C,C-TICK >STACK
	SUB 85,STACK >X
	GRTR? X,70 \?L20
	PRINTI "a few feet"
	JUMP ?L24
?L20:	GRTR? X,60 \?L22
	PRINTI "several feet"
	JUMP ?L24
?L22:	GRTR? X,45 \?L23
	PRINTI "a few yards"
	JUMP ?L24
?L23:	PRINTI "quite near the fence, several yards"
?L24:	PRINTI " from the pile of gunpowder kegs opposite"
	CALL TRPRINT,GATE
	RTRUE
?L11:	PRINT YOU-SEE
	PRINT DARKNESS
	CALL TRPRINT,FENCE
	RTRUE
?L10:	EQUAL? PRSA,V?THROW-AT,V?THROW-OVER,V?THROW \FALSE
	EQUAL? PRSO,DRESS,RAG \FALSE
	CALL PERFORM,V?THROW-OVER,PRSO,GATE
	RTRUE

	.FUNCT CREWS-QUARTERS-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	ZERO? HEARD-CRULLEY \?L1
	CALL QUEUE,I-OVERHEAR-CRULLEY,2 >STACK
	RSTACK
?L1:	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "The crew sleeps, in shifts, in this cramped space under the forecastle. A breeze blows in on a moonbeam through a grate in the ceiling. A low doorsill is abaft.
"
	PRINT INDENT
	FSET? MESS,TOUCHBIT /?L4
	FSET MESS,TOUCHBIT
	PRINTI "This area must also serve as sickroom. "
?L4:	PRINTI "Strewn about the floor are various powders and spills of malodorous potions. In one corner, a large blood stain indicates an amputation; in another is the smear of a leech, dropped off a bloodletting."
	RTRUE

	.FUNCT GRATE-F
	EQUAL? PRSA,V?LOOK-INSIDE \FALSE
	EQUAL? HERE,CREWS-QUARTERS \?L3
	CALL PERFORM,V?EXAMINE,CEILING
	RTRUE
?L3:	PRINT YOU-SEE
	PRINT DARKNESS
	CALL TRPRINT,GRATE
	RTRUE

	.FUNCT MIRROR-F
	EQUAL? PRSA,V?LOOK-INSIDE \?L1
	PRINTI "You are aglow with excitement"
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?POINT,V?PUT \?L3
	EQUAL? PRSI,MOONBEAM,SHUTTERS,SHIP /?L4
	EQUAL? PRSI,WINDOW \?L3
?L4:	CALL SIGNAL-SHIP,MIRROR
	RTRUE
?L3:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "Probably a remnant of a pirated lady's boudoir,"
	CALL TPRINT,MIRROR
	PRINTI "'s edges are dulled from use"
	PRINT PCR
	RTRUE

	.FUNCT SIGNAL-SHIP,THING
	FSET? HERE,INDOORSBIT \?L1
	CALL GLOBAL-IN?,HERE,WINDOW >STACK
	ZERO? STACK \?L1
	EQUAL? HERE,LAFS-ROOM,CAPT-QUARTERS /?L1
	PRINT YOU-CANT-SEE-ANY
	PRINT WAY-TO-DO-THAT
	RTRUE
?L1:	MOVE THING,PROTAGONIST
	IN? CHICKEN,THING \?L4
	REMOVE CHICKEN
	REMOVE SPICES
	PRINTI "You scrape everything off"
	CALL TPRINT,TRAY
	PRINTI " into the bushes below. "
?L4:	EQUAL? HERE,BEDROOM \?L7
	PRINT YOU-CANT
	PRINTI "quite catch the moon, just peeking over the house, in the little mirror"
	PRINT PCR
	RTRUE
?L7:	PRINTI "You roll"
	CALL TPRINT,THING
	PRINTI " around in the beam of moonlight till it glows silver-white. "
	EQUAL? HERE,LAFS-ROOM \?L10
	FSET? SHIP,MUNGBIT \?L12
	PRINTI "The breeze picks up, howling off"
	CALL TRPRINT,SEA
	RTRUE
?L12:	CALL QUEUED?,I-PIRATE-RESCUE >STACK
	ZERO? STACK \?L10
	ZERO? ENDGAME \?L10
	INC 'SCORE
	IN? LAFOND,HERE \?L15
	CALL QUEUE,I-PIRATE-RESCUE,14
	JUMP ?L17
?L15:	CALL QUEUE,I-PIRATE-RESCUE,6
?L17:	PRINTI "After a moment, a flash of light responds from"
	CALL TRPRINT,SHIP
	RTRUE
?L10:	CRLF
	RTRUE

	.FUNCT I-PIRATE-RESCUE
	SET 'ENDGAME,1
	SET 'COOKIE-LOOKING,1
	FSET LUCY,NDESCBIT
	FSET DAD,NDESCBIT
	MOVE CRULLEY,DUNGEON
	FCLEAR COOKIE,NDESCBIT
	FSET BALLROOM,EVERYBIT
	FSET SKIFF,NDESCBIT
	PRINT INDENT
	EQUAL? HERE,LAWN,VERANDA,FOREST /?L3
	EQUAL? HERE,TRADE-ENTRANCE \?L1
?L3:	PRINTI "Silently, a dozen ragged men creep in from the beach. Small groups move in all "
	PRINTD INTDIR
	PRINTI "s, surrounding the mansion, until, with a hair-raising cry, they attack the house. Screams of terror come from the ballroom"
	PRINT PCR
	RTRUE
?L1:	EQUAL? HERE,LAFS-ROOM \?L5
	IN? LAFOND,HERE \?L4
	PRINT BATTLE-CRY
	PRINTI ", and Lafond whirls around, every sinew taut. ""Damnation! Jamison somehow called his men!"" Holding a knife to your throat, Lafond drags you downstairs and away from rescue, as Cookie and the crew watch helpless."
	CALL PRINT-ID,STR?227
	CALL JIGS-UP,STR?228 >STACK
	RSTACK
?L4:	EQUAL? HERE,LAFS-ROOM \?L5
	FSET? BUTLER,DEADBIT /?L5
	PRINT BATTLE-CRY
	PRINTI ", as Jamison's men respond to your signal. "
	CALL CTPRINT,BUTLER
	PRINTI ", looking scared, grabs you and runs downstairs and out to the front drive."
	CALL PRINT-ID,STR?229
	CALL JIGS-UP,STR?230 >STACK
	RSTACK
?L5:	EQUAL? HERE,GALLERY,STAIRTOP,FOYER /?L7
	EQUAL? HERE,BALLROOM,ORCHESTRA,SUPPER-ROOM \?L6
?L7:	PRINT BATTLE-CRY
	PRINTI ", and Jamison's men stream in from all "
	PRINTD INTDIR
	PRINTI "s, huddling the dancers in the middle of the ballroom"
	PRINT PCR
	RTRUE
?L6:	PRINT BATTLE-CRY
	PRINTI ". It is drowned out a few minutes later by screams of terror from the dancers in the ballroom"
	PRINT PCR
	EQUAL? HERE,FRONT-DRIVE \FALSE
	PRINT INDENT
	PRINTR "The dragoons look alarmed, and confer among themselves."

	.FUNCT DAGGER-F
	EQUAL? PRSA,V?EXAMINE \?L1
	CALL CTPRINT,DAGGER
	PRINTI " is quite dull"
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?CUT \FALSE
	FSET? PRSO,WEARBIT \?L4
	CALL PERFORM,V?RIP,PRSO
	RTRUE
?L4:	EQUAL? PRSO,LINE /FALSE
	EQUAL? PRSO,DAGGER \?L7
	CALL IMPOSSIBLES >STACK
	RSTACK
?L7:	CALL CTPRINT,DAGGER
	PRINTI " is much too dull to cut"
	CALL TRPRINT,PRSO
	RTRUE

	.FUNCT POOP-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	FSET? POOP,TOUCHBIT /?L1
	ZERO? HEARD-CRULLEY \?L3
	SET 'HEARD-CRULLEY,1
	FSET ANCHOR,MUNGBIT
	FSET LEVER,MUNGBIT
	CALL QUEUE,I-SEE-CRULLEY-ESCAPE,2
	CALL QUEUE,I-LOOK-SEA,10
?L3:	INC 'SCORE
	RETURN SCORE
?L1:	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "From this platform deck you can see the whole of the two-masted ship, shadowy forms moving about here and there. A railing protects you from stepping off the deck in any "
	PRINTD INTDIR
	PRINTI " but to the fore."
	ZERO? LADDER-HANGING /?L7
	PRINTI " A rope ladder is tied to the railing at the stern of the ship."
?L7:	CALL I-LOOK-SEA,0 >STACK
	RSTACK

	.FUNCT QUARTERDECK-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "No torches are lit, or needed on this moonlit night, except in the deep shadows cast by the huge navigation wheel. Men move about to the fore, talking quietly. Under the stairs aft to the poop is a barred door."
	CALL I-LOOK-SEA,0 >STACK
	RSTACK
?L1:	EQUAL? RARG,M-END \FALSE
	ZERO? BOY-DRESS? \FALSE
	CALL SAILOR-DEATH >STACK
	RSTACK

	.FUNCT WHEEL-F
	CALL TOUCHING?,WHEEL >STACK
	ZERO? STACK /FALSE
	PRINTI "From the grumbling emitted as you near"
	CALL TPRINT,WHEEL
	PRINTR ", you gather that the sailors close by would not appreciate your action."

	.FUNCT CANNON-F
	CALL TOUCHING?,CANNON >STACK
	ZERO? STACK /?L1
	PRINTR "A crewman growls angrily, ""Boy! Get away from me guns -- they've killed better men than thee by just rollin' backwards."""
?L1:	EQUAL? PRSA,V?EXAMINE \?L3
	PRINTI "Huge, old and blackened, these cannon have seen many battles"
	PRINT PCR
	RTRUE
?L3:	EQUAL? PRSA,V?SSHOOT,V?SHOOT \FALSE
	CALL PRINT-ID,STR?231
	CALL REPERTOIRE,STR?232 >STACK
	RSTACK

	.FUNCT CASK-F,VARG=0
	ZERO? VARG /?L1
	EQUAL? VARG,M-BEG \?L3
	EQUAL? PRSA,V?ROW-TO,V?ROW-DIR,V?ROW \?L5
	CALL V-ROW >STACK
	RSTACK
?L5:	EQUAL? PRSA,V?WALK \?L9
	EQUAL? PRSO,P?OUT \?L8
?L9:	CALL TOUCHING?,PYRAMID >STACK
	ZERO? STACK /FALSE
?L8:	CALL DO-FIRST,STR?233,CASK >STACK
	RSTACK
?L3:	EQUAL? VARG,M-DESC? /TRUE
	EQUAL? VARG,M-OBJDESC \FALSE
	EQUAL? HERE,SHALLOWS,LAGOON \FALSE
	PRINT INDENT
	PRINTI "Waves lap at"
	CALL TPRINT,CASK
	PRINTI "."
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \?L14
	PRINTI "This large, empty cask smells of salt and rancid meat. The head of"
	CALL TPRINT,CASK
	PRINTI " is missing"
	PRINT PCR
	RTRUE
?L14:	EQUAL? PRSA,V?ENTER,V?BOARD \?L15
	MOVE PROTAGONIST,CASK
	PRINTI "You crawl into"
	CALL TPRINT,CASK
	FSET? PORK,TOUCHBIT /?L16
	PRINTI ", feeling a slab of something stuck on the bottom"
?L16:	EQUAL? HERE,QUARTERDECK \?L19
	PRINTI ". From this close, you can see"
	CALL TPRINT,LINE
	PRINTI " is getting frayed where it rubs against"
	CALL TRPRINT,CASK
	RTRUE
?L19:	PRINT PCR
	RTRUE
?L15:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L22
	PRINTI "One end of"
	CALL TPRINT,CASK
	PRINTI " is missing, so it can't be opened or closed"
	PRINT PCR
	RTRUE
?L22:	EQUAL? PRSA,V?LAUNCH \?L23
	EQUAL? HERE,QUARTERDECK \?L24
	PRINT HUH
	RTRUE
?L24:	PRINT ALREADY-IS
	RTRUE
?L23:	EQUAL? PRSA,V?DISEMBARK \FALSE
	EQUAL? HERE,LAGOON \?L28
	PRINT TOO-DEEP
	RTRUE
?L28:	EQUAL? HERE,SHALLOWS \FALSE
	MOVE PROTAGONIST,HERE
	REMOVE CASK
	PRINTI "Free of your weight,"
	CALL TPRINT,CASK
	PRINTI " bobs and spins in the current, pulled out into the lagoon. You splash after it, but it is gone"
	PRINT PCR
	RTRUE

	.FUNCT PORK-F
	EQUAL? PRSA,V?EXAMINE \?L1
	CALL CTPRINT,PORK
	PRINTR ", caked white with salt, is rock-hard."
?L1:	EQUAL? PRSA,V?EAT \?L3
	CALL CTPRINT,PORK
	PRINTR " is too salty to eat."
?L3:	EQUAL? PRSA,V?TAKE \FALSE
	IN? PORK,CASK \FALSE
	FSET? PORK,TAKEBIT /FALSE
	IN? PROTAGONIST,CASK \?L5
	FSET PORK,TAKEBIT
	MOVE PORK,PROTAGONIST
	PRINTI "You peel it off"
	CALL TRPRINT,CASK
	RTRUE
?L5:	CALL CTPRINT,PORK
	PRINTI " is beyond your reach at the bottom of"
	CALL TRPRINT,CASK
	RTRUE

	.FUNCT LINE-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "Heavy-duty, hand-twisted rope is pulled taut around"
	CALL TPRINT,PYRAMID
	PRINTI ". "
	FSET? LINE,MUNGBIT /?L3
	PRINTI "It runs directly over the open-ended cask. "
?L3:	PRINTI "A seaman calls over, ""Boy, take care"
	FSET? LINE,MUNGBIT \?L6
	PRINTI " -- or I'll see you flogged"
	JUMP ?L8
?L6:	PRINTI ". Them casks ain't safe, they could push ye overboard"
?L8:	PRINTR "!"""
?L1:	EQUAL? PRSA,V?CUT \?L9
	ZERO? PRSI \?L10
	CALL HELD?,DAGGER >STACK
	ZERO? STACK /?L10
	PRINTI "[with the dagger]"
	CRLF
	CALL PERFORM,V?CUT,LINE,DAGGER
	RTRUE
?L10:	EQUAL? PRSI,DAGGER \FALSE
	ZERO? FUSE-LIT /?L13
	IN? PROTAGONIST,CASK \?L13
	FSET? LINE,EVERYBIT /?L13
	FSET LINE,EVERYBIT
	PRINTI "You hesitate, thinking of the fates of those left aboard this ship."
	CRLF
	CALL PRINT-ID,STR?234
	RTRUE
?L13:	CALL CTPRINT,LINE
	PRINTI " snaps, and the pyramid collapses into dozens of tumbling casks. "
	LOC PROTAGONIST >STACK
	EQUAL? STACK,CASK \?L16
	FCLEAR CASK,NDESCBIT
	FSET LINE,MUNGBIT
	CALL PRINT-ID,STR?235
	REMOVE DAGGER
	SUB SHIP-LOC,2 >CASK-LOC
	INC 'SCORE
	PRINTI "Your cask is thrust into the sea,"
	CALL TPRINT,DAGGER
	PRINTI " flying from "
	PRINTD HANDS
	PRINT PCR
	FSET? ANCHOR,MUNGBIT \?L18
	CALL PRINT-ID,STR?236
	CALL FWTD,STR?237
	JUMP ?L20
?L18:	PRINT INDENT
	PRINTI "Sputtering mouthfuls of salt water, you first look around several minutes later"
	PRINT PCR
	CRLF
	CALL PRINT-ID,STR?238
?L20:	FCLEAR DOOR,OPENBIT
	FSET DOOR,LOCKEDBIT
	CALL QUEUE,I-CURRENT,-1
	MOVE CASK,LAGOON
	CALL GOTO,CASK
	CALL V-LOOK >STACK
	RSTACK
?L16:	LOC PROTAGONIST >STACK
	EQUAL? STACK,QUARTERDECK \FALSE
	CALL PRINT-ID,STR?239
	CALL JIGS-UP,STR?240 >STACK
	RSTACK
?L9:	EQUAL? PRSA,V?REMOVE,V?UNTIE \FALSE
	PRINT YOU-CANT-SEE-ANY
	PRINTI "knots to untie, just line"
	PRINT PCR
	RTRUE

	.FUNCT GEN-CASK
	IN? CASK,HERE \?L1
	RETURN CASK
?L1:	RETURN PYRAMID

	.FUNCT PYRAMID-F,OARG=0
	ZERO? OARG /?L1
	EQUAL? OARG,M-DESC? /TRUE
	PRINT INDENT
	PRINTI "Abaft the wheel sits a "
	FSET? LINE,MUNGBIT \?L6
	PRINTI "small, hastily constructed"
	JUMP ?L8
?L6:	PRINTI "large"
?L8:	PRINTI " pyramid of casks, held in place by a heavy rope."
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \?L9
	PRINTI "Lying on their sides, the casks are stacked in a rather shaky pyramid: perhaps that's why someone has tied the rope about them"
	FSET? LINE,MUNGBIT /?L10
	PRINTI ". A cask on one corner has lost its lid"
?L10:	PRINT GET-AWAY
	CRLF
	RTRUE
?L9:	EQUAL? PRSA,V?LOOK-INSIDE \?L13
	PRINTI "All of the casks seem empty"
	FSET? LINE,MUNGBIT /?L16
	PRINTI ", but the only one you can actually look in is the open-ended cask."
	IN? PORK,CASK \?L16
	PRINTI " There appears to be"
	CALL APRINT,PORK
	PRINTI " dried to the bottom of that one."
?L16:	CRLF
	RTRUE
?L13:	CALL TOUCHING?,PYRAMID >STACK
	ZERO? STACK /FALSE
	FSET? LINE,MUNGBIT \?L21
	PRINTI "A sailor swoops down on you from nowhere, whapping your backside painfully. ""Boy!"" he booms, ""get away from those! We already had to clean up after you once. Cap'n'll hear of this, I tell you."""
	CRLF
	CALL PRINT-ID,STR?241 >STACK
	RSTACK
?L21:	INC 'PYRAMID-CTR
	PRINTI "The pyramid wobbles"
	EQUAL? PYRAMID-CTR,3 \?L24
	CALL PRINT-ID,STR?242
	CALL JIGS-UP,STR?243
	RTRUE
?L24:	PRINT GET-AWAY
	CRLF
	RTRUE

	.FUNCT MAIN-DECK-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "It is a deceptively quiet evening on the ship, the pirates singing low shanties as they repair cannon, twist ropes and sharpen daggers. The mainmast casts an inky shadow over the "
	FSET? HATCH,OPENBIT \?L3
	PRINTI "open hatch and stairs leading down to the hold."
	JUMP ?L5
?L3:	PRINTI "canvas screening the hatch."
?L5:	PRINT TANGLED-RIGGING
	CALL I-LOOK-SEA,0
	CRLF
	PRINT INDENT
	PRINTI "Two large barrels stand near the stair to the foredeck."
	RTRUE
?L1:	EQUAL? RARG,M-ENTER \?L6
	ZERO? FUSE-LIT /?L6
	FSET? FUSE,TOUCHBIT /?L6
	CALL DEQUEUE,I-SMELL-SMOKE
	CALL I-SMELL-SMOKE >STACK
	RSTACK
?L6:	EQUAL? RARG,M-END \FALSE
	ZERO? BOY-DRESS? \FALSE
	CALL SAILOR-DEATH >STACK
	RSTACK

	.FUNCT HATCH-ENTRANCE
	FSET? HATCH,OPENBIT /?L1
	CALL CTPRINT,HATCH
	PRINT IS-CLOSED
	PRINT PCR
	RFALSE
?L1:	EQUAL? HERE,MAIN-DECK \?L3
	PRINTI "You glance around to see that no one is watching, and duck through the open corner of"
	CALL TRPRINT,HATCH
	CRLF
	RETURN HOLD
?L3:	PRINTI "You slip lithely through"
	CALL TRPRINT,HATCH
	CRLF
	RETURN MAIN-DECK

	.FUNCT RUM-F
	EQUAL? PRSA,V?SOAK,V?PUT \?L1
	CALL PERFORM,V?PUT,PRSO,RUM-BARREL
	RTRUE
?L1:	EQUAL? PRSA,V?LOOK-UNDER,V?LOOK-INSIDE,V?EXAMINE \?L3
	PRINTI "The rum is a dark brown color"
	PRINT PCR
	RTRUE
?L3:	EQUAL? PRSA,V?REACH-IN \?L4
	PRINTI "Rum"
	PRINT DRIPS-OFF
	RTRUE
?L4:	EQUAL? PRSA,V?DRINK \FALSE
	PRINTI "You take a sip and spit it out, coughing. This is much stronger than ratafia!"
	CRLF
	CALL PRINT-ID,STR?244 >STACK
	RSTACK

	.FUNCT GEN-BARREL
	EQUAL? PRSA,V?EXAMINE \FALSE
	RETURN WATER-BARREL

	.FUNCT BARREL-F
	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L1
	EQUAL? PRSO,WATER-BARREL \?L3
	CALL ADJ-USED,A?WATER >STACK
	ZERO? STACK \?L7
	CALL ADJ-USED,A?FRESH >STACK
	ZERO? STACK /?L5
?L7:	PRINTR "This large barrel is full of fresh water for the long sea voyage."
?L5:	PRINTI "The two open barrels contain rum and water, you can tell by the smell of each. They are identical but for the dark stains around the mouth of"
	CALL TRPRINT,RUM-BARREL
	RTRUE
?L3:	EQUAL? PRSO,RUM-BARREL \FALSE
	PRINTI "Stained around the mouth by the spills of over-eager sailors,"
	CALL TPRINT,RUM-BARREL
	PRINTR " is nearly full."
?L1:	EQUAL? PRSA,V?DRINK-FROM \?L11
	EQUAL? PRSI,RUM-BARREL \?L12
	CALL PERFORM,V?DRINK,RUM
	RTRUE
?L12:	EQUAL? PRSI,WATER-BARREL \FALSE
	CALL PERFORM,V?DRINK,WATER
	RTRUE
?L11:	EQUAL? PRSA,V?PUSH-DIR,V?PUSH,V?ROLL \?L16
	EQUAL? P-PRSA-WORD,W?TIP \?L17
	PRINTR "You notice a scrawl on the side, ""No tipping, please."""
?L17:	PRINTR "The barrel is secured to the deck."
?L16:	EQUAL? PRSA,V?EMPTY-FROM,V?EMPTY \?L20
	CALL PROPOSE >STACK
	RSTACK
?L20:	EQUAL? PRSA,V?REACH-IN \?L21
	EQUAL? PRSO,RUM-BARREL \?L22
	PRINTI "Rum"
	JUMP ?L24
?L22:	PRINTI "Water"
?L24:	PRINT DRIPS-OFF
	RTRUE
?L21:	EQUAL? PRSA,V?CLOSE \?L25
	PRINTR "There is no lid."
?L25:	EQUAL? PRSA,V?SOAK,V?PUT \?L26
	EQUAL? PRSO,LAUD \?L27
	PRINTR "The few drops left would be too diluted to affect anyone."
?L27:	FSET? PRSI,OPENBIT /?L29
	CALL CTPRINT,PRSI
	PRINT IS-CLOSED
	PRINT PCR
	RTRUE
?L29:	EQUAL? PRSO,LETTER,INVITE \?L30
	CALL PERFORM,V?PUT,PRSO,SEA
	RTRUE
?L30:	EQUAL? PRSO,RAG,DRESS \?L31
	CALL DIP-DRESS >STACK
	RSTACK
?L31:	CALL PRINT-ID,STR?245
	REMOVE PRSO
	PRINTI "You drop"
	CALL TPRINT-PRSO
	PRINTI " into"
	CALL TPRINT-PRSI
	PRINTI ". It sinks from sight"
	PRINT PCR
	RTRUE
?L26:	EQUAL? PRSA,V?DRINK \FALSE
	GET P-NAMW,0 >STACK
	ZERO? STACK \FALSE
	CALL ADJ-USED,A?WATER >STACK
	ZERO? STACK /?L36
	CALL PERFORM,V?DRINK,WATER
	RTRUE
?L36:	CALL ADJ-USED,A?RUM >STACK
	ZERO? STACK /FALSE
	CALL PERFORM,V?DRINK,RUM
	RTRUE

	.FUNCT DIP-DRESS,LIQUID=0
	ZERO? PRSI \?L1
	CALL V-SOAK
	RTRUE
?L1:	EQUAL? PRSI,RUM-BARREL,RUM \?L3
	SET 'LIQUID,RUM
	JUMP ?L4
?L3:	EQUAL? PRSI,WATER-BARREL,WATER,SEA /?L6
	EQUAL? PRSI,POOL /?L6
	EQUAL? HERE,BY-SHIP,LAGOON,SHALLOWS /?L6
	EQUAL? HERE,BEACH \?L4
?L6:	SET 'LIQUID,WATER
?L4:	ZERO? WET-DRESS /?L11
	EQUAL? PRSO,DRESS /?L10
?L11:	ZERO? WET-RAG /?L8
	EQUAL? PRSO,RAG \?L8
?L10:	PRINTR "That's already wet enough."
?L8:	PRINTI "Keeping hold on"
	CALL TPRINT-PRSO
	PRINTI ", you soak it with "
	EQUAL? PRSO,DRESS \?L13
	LOC PROTAGONIST >STACK
	MOVE DRESS,STACK
	PUTP DRESS,P?SIZE,10
	SET 'WET-DRESS,LIQUID
	PRINTD LIQUID
	PRINTI ". It becomes so heavy, however, that you drop it, with a loud squelch"
	JUMP ?L15
?L13:	EQUAL? PRSO,RAG \?L15
	SET 'WET-RAG,LIQUID
	PRINTD LIQUID
?L15:	PRINT PCR
	RTRUE

	.FUNCT FOCSLE-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "Higher than all but the poop deck, this end of the ship commands a good view of the island; the ""crow's nest,"" swinging above in the heights of the foremast, would command a better."
	PRINT TANGLED-RIGGING
	CRLF
	PRINTI "   Imbedded in the deck is a grated air hole to the crew's "
	PRINTD OBJ-QUARTERS
	PRINTI " below. You can go aft, or forward through a break in the ubiquitous railing.
   Odors of old grease and char waft from a little shack perched behind the mast."
	CALL I-LOOK-SEA,0 >STACK
	RSTACK
?L1:	EQUAL? RARG,M-END \FALSE
	ZERO? BOY-DRESS? \FALSE
	CALL SAILOR-DEATH >STACK
	RSTACK

	.FUNCT WINCH-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "Made of an old barrel turning on a pole,"
	CALL TPRINT,WINCH
	PRINTI " is used to coil in the anchor chain. A pair of metal teeth bite the links to prevent it from dragging out; a lever is connected to the teeth. Something is written on the lever"
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?SET \?L3
	FSET? LEVER,MUNGBIT \?L4
	PRINTI "The teeth are closed, so you can't move the chain"
	PRINT PCR
	RTRUE
?L4:	PRINT NO-STRENGTH
	RTRUE
?L3:	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	CALL PROPOSE >STACK
	RSTACK

	.FUNCT LEVER-F
	EQUAL? PRSA,V?EXAMINE,V?READ \?L1
	PRINTR "On the lever is written ""Open Up, Close Down."" You notice the lever is pointed down."
?L1:	EQUAL? PRSA,V?RAISE \?L3
	FSET? ANCHOR,MUNGBIT \?L4
	INC 'SCORE
	FCLEAR ANCHOR,MUNGBIT
	REMOVE ANCHOR
	CALL DEQUEUE,I-LOOK-SEA
	CALL QUEUE,I-TIDES-TURN,3
	PRINTI "The metal teeth open as you raise up"
	CALL TPRINT,LEVER
	PRINTI ". The anchor, released, splashes down into the sea, dragging its clanking chain. After a moment, you feel the ship pull slightly against the current. You lower the lever to prevent any more chain from spooling out"
	PRINT PCR
	RTRUE
?L4:	PRINTI "Raising"
	CALL TPRINT,LEVER
	PRINTI " would release more chain and you might "
	CALL QUEUED?,I-TIDES-TURN >STACK
	ZERO? STACK /?L7
	PRINTI "cast"
	CALL TPRINT,SHIP
	PRINTR " against the reefs!"
?L7:	PRINTI "ground"
	CALL TRPRINT,SHIP
	RTRUE
?L3:	EQUAL? PRSA,V?LOWER \?L10
	PRINT ALREADY-IS
	RTRUE
?L10:	EQUAL? PRSA,V?PUSH,V?MOVE \FALSE
	PRINT YOULL-HAVE-TO
	PRINTI "specify which way you want to move it"
	PRINT PCR
	RTRUE

	.FUNCT I-TIDES-TURN
	PRINT INDENT
	PRINTI "With a heave and creak of timbers,"
	CALL TPRINT,SHIP
	PRINTR " drifts a little way back towards the island. The tide has turned."

	.FUNCT GALLEY-F,RARG
	EQUAL? RARG,M-END \?L1
	FSET? COOKIE,TOUCHBIT /?L1
	FSET COOKIE,TOUCHBIT
	PRINT INDENT
	PRINTI "The man looks you over sharply,"
	ZERO? BOY-DRESS? /?L3
	PRINTI " then winks an eye. ""Hullo, boy -- Sam, I'll call you. N"
	JUMP ?L5
?L3:	PRINTI "frowning. ""Tut, lass, you don't foller orders, do ye? 'Tain't safe to go about dressed like that. Mayhap ye're n"
?L5:	PRINTI "ervous about Cap'n? He'll come to no harm. And if there is trouble, he only has to signal from that seaward winder of the house -- ye can see it from the crow's nest -- and we'll be there in a jiffy. Me and my peg are to stay aboard and guard y"
	ZERO? BOY-DRESS? /?L6
	PRINTI "--, the Cap'n's"
	JUMP ?L8
?L6:	PRINTI "ou,"
?L8:	PRINTR " young lady."""
?L1:	EQUAL? RARG,M-ENTER \FALSE
	CALL THIS-IS-IT,COOKIE
	CALL THIS-IS-IT,DAGGER >STACK
	RSTACK

	.FUNCT GALLEY-OBJECT-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "It's a tiny charred wooden shack"
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?SEARCH,V?LOOK-INSIDE \?L3
	CALL PERFORM-PRSA,GALLEY
	RTRUE
?L3:	EQUAL? PRSA,V?ENTER \FALSE
	CALL GOTO,GALLEY >STACK
	RSTACK

	.FUNCT BOWSPRIT-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "Hanging on the bowsprit, your arms and legs wrapped tightly around the narrow spar, you can't see much beside an upside-down view of the figurehead of the "
	PRINTD SHIP
	PRINTI ", "
	FSET? ANCHOR,MUNGBIT \?L3
	PRINTI "the barnacle encrusted main anchor dripping from its chain, and the nauseous"
	JUMP ?L5
?L3:	PRINTI "and"
	CALL TPRINT,ANCHOR
	PRINTI " chain descending into the"
?L5:	PRINTI " swelling and breaking waves over (under?) "
	PRINTD HEAD
	PRINTI "."
	RTRUE

	.FUNCT BOWSPRIT-EXIT
	EQUAL? HERE,FOCSLE \?L1
	PRINTI "You"
	CALL ANYTHING-HELD >STACK
	ZERO? STACK /?L3
	CALL ROB,PROTAGONIST,HERE
	PRINTI " drop all you are carrying and"
?L3:	PRINTI " creep out over the waves"
	PRINT PCR
	CRLF
	RETURN BOWSPRIT
?L1:	PRINTI "You inch back down to"
	PRINT ELLIPSIS
	RETURN FOCSLE

	.FUNCT STUB-F,OARG=0
	ZERO? OARG /?L1
	EQUAL? OARG,M-DESC? /TRUE
	PRINT INDENT
	PRINTI "A "
	PRINTD STUB
	PRINTI ", roughly cut, swings rudely over the waves."
	FSET? ANCHOR,MUNGBIT \TRUE
	PRINTI " The line holding the sea anchor has been cut!"
	RTRUE
?L1:	CALL TOUCHING?,STUB >STACK
	ZERO? STACK /FALSE
	PRINT YOU-CANT
	PRINTR "quite reach it."

	.FUNCT ANCHOR-F
	EQUAL? PRSA,V?RAISE \FALSE
	PRINT NO-STRENGTH
	RTRUE

	.FUNCT RIGGING-ROOM-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "The deck swings far below as you cling to"
	CALL TPRINT,RIGGING-OBJECT
	PRINTI " in the wind."
	PRINT TANGLED-RIGGING
	EQUAL? WHICH-MAST?,FOCSLE \TRUE
	PRINTI " Farther up"
	CALL TPRINT,RIGGING-OBJECT
	PRINTI " is a small platform."
	RTRUE

	.FUNCT RIGGING-OBJECT-F
	EQUAL? PRSA,V?TAKE \?L1
	PRINTR "The only thing rigging is good for is climbing."
?L1:	EQUAL? PRSA,V?CLIMB \?L3
	CALL DO-WALK,P?UP
	RTRUE
?L3:	EQUAL? PRSA,V?CLIMB-DOWN \?L4
	CALL DO-WALK,P?DOWN
	RTRUE
?L4:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "The mast stands tall and powerful, shrouded in"
	CALL TRPRINT,RIGGING-OBJECT
	RTRUE

	.FUNCT I-PIRATE-ATTACK
	RANDOM 100 >STACK
	LESS? 40,STACK /FALSE
	PRINT INDENT
	CALL PICK-ONE,PIRATE-NOISES >STACK
	PRINT STACK
	PRINT PCR
	RFALSE

	.FUNCT I-LOOK-SEA,CALLED-BY-INTERRUPT=1,CANT-SEE-REEFS
	CALL INNER-DECK,HERE >STACK
	ZERO? STACK /?L1
	SET 'CANT-SEE-REEFS,1
?L1:	ZERO? CALLED-BY-INTERRUPT /?L4
	CALL QUEUE,I-LOOK-SEA,15
	INC 'SHIP-LOC
	EQUAL? SHIP-LOC,10 \?L6
	PRINT INDENT
	GET REEF-DESC,SHIP-LOC >STACK
	PRINT STACK
	CALL PRINT-ID,STR?246
	CALL FWTD,STR?247 >STACK
	RSTACK
?L6:	ZERO? CANT-SEE-REEFS /?L8
	EQUAL? SHIP-LOC,8 \FALSE
	PRINT INDENT
	PRINTR "The crash of surf is increasing in volume. You'd best find out what's going on!"
?L8:	PRINT INDENT
	GET REEF-DESC,SHIP-LOC >STACK
	PRINT STACK
	PRINT PCR
	RTRUE
?L4:	FSET? ANCHOR,MUNGBIT \TRUE
	CALL RUNNING?,I-LOOK-SEA >STACK
	ZERO? STACK /?L14
	CALL QUEUE,I-LOOK-SEA,2
	CALL I-LOOK-SEA,0 >STACK
	RSTACK
?L14:	CRLF
	PRINT INDENT
	GET REEF-DESC,SHIP-LOC >STACK
	PRINT STACK
	PRINTI "."
	RTRUE

	.FUNCT I-CURRENT,VENUE=0
	IN? PROTAGONIST,CASK \?L1
	ADD CASK-LOC,ROWING >VENUE
	JUMP ?L2
?L1:	IN? PROTAGONIST,SKIFF \?L3
	ADD SKIFF-LOC,ROWING >VENUE
	JUMP ?L2
?L3:	SET 'VENUE,0
?L2:	EQUAL? ROWING,-1 \?L18
	PRINT INDENT
	PRINTI "The current pulls you in towards the island."
	EQUAL? HERE,BY-SHIP \?L7
	CRLF
	CRLF
	MOVE SKIFF,LAGOON
	CALL GOTO,SKIFF
	CALL V-LOOK
	JUMP ?L18
?L7:	LESS? VENUE,2 \?L9
	EQUAL? HERE,SHALLOWS /?L9
	SET 'VENUE,1
	CALL DEQUEUE,I-CURRENT
	PRINTI " With a scrape,"
	LOC PROTAGONIST >STACK
	CALL TPRINT,STACK
	PRINTI " lodges in the sand"
	PRINT PCR
	CRLF
	IN? PROTAGONIST,CASK \?L10
	MOVE CASK,SHALLOWS
	CALL GOTO,CASK
	JUMP ?L18
?L10:	IN? PROTAGONIST,SKIFF \?L18
	MOVE SKIFF,SHALLOWS
	CALL GOTO,SKIFF
	JUMP ?L18
?L9:	EQUAL? HERE,LAGOON \TRUE
	CRLF
	ZERO? LOOKED-LAGOON? \?L15
	CALL V-LOOK
	JUMP ?L18
?L15:	SET 'LOOKED-LAGOON?,0
?L18:	SET 'ROWING,-1
	IN? PROTAGONIST,CASK \?L20
	SET 'CASK-LOC,VENUE
	RTRUE
?L20:	IN? PROTAGONIST,SKIFF \TRUE
	SET 'SKIFF-LOC,VENUE
	RTRUE

	.FUNCT SKIFF-F,VARG=0,STR=0
	ZERO? VARG /?L1
	EQUAL? VARG,M-DESC? /TRUE
	EQUAL? VARG,M-OBJDESC \FALSE
	PRINT INDENT
	FSET? SKIFF,TOUCHBIT \?L6
	CALL CTPRINT,SKIFF
	JUMP ?L8
?L6:	FSET SKIFF,TOUCHBIT
	PRINTI "A "
	PRINTD SKIFF
?L8:	PRINTI " nods in the waves, its oars jerking around in the current."
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \?L10
	CALL CTPRINT,SKIFF
	PRINTI " is large enough to carry several men, but light enough that you feel able to row it"
	PRINT PCR
	RTRUE
?L10:	EQUAL? PRSA,V?LOOK-INSIDE \?L11
	FCLEAR OARS,NDESCBIT
	IN? PROTAGONIST,SKIFF \?L12
	CALL DESCRIBE-VEHICLE
	JUMP ?L14
?L12:	PRINTI "In"
	CALL TPRINT,SKIFF
	PRINTI " is"
	CALL DESCRIBE-CONTENTS,SKIFF
	PRINT PCR
?L14:	FSET OARS,NDESCBIT
	RTRUE
?L11:	EQUAL? PRSA,V?LAUNCH /?L16
	EQUAL? PRSA,V?PUSH \?L15
	EQUAL? PRSI,SEA \?L15
?L16:	PRINT ALREADY-IS
	RTRUE
?L15:	EQUAL? PRSA,V?TIE \?L17
	EQUAL? HERE,BY-SHIP \?L18
	CALL DEBARK-SKIFF >STACK
	RSTACK
?L18:	PRINT THERES-NOTHING
	PRINTR "to moor it to!"
?L17:	EQUAL? PRSA,V?ROW \?L21
	LOC PROTAGONIST >STACK
	EQUAL? STACK,SKIFF \?L22
	EQUAL? HERE,BEACH \?L24
	CALL DO-FIRST,STR?248,SKIFF >STACK
	RSTACK
?L24:	PRINT YOULL-HAVE-TO
	PRINTI "specify a "
	PRINTD INTDIR
	PRINT PCR
	RTRUE
?L22:	CALL DO-FIRST,STR?172,SKIFF >STACK
	RSTACK
?L21:	EQUAL? PRSA,V?DISEMBARK \?L28
	EQUAL? HERE,LAGOON \?L29
	PRINT TOO-DEEP
	RTRUE
?L29:	EQUAL? HERE,BY-SHIP \FALSE
	CALL DEBARK-SKIFF >STACK
	RSTACK
?L28:	EQUAL? PRSA,V?PUT-ON \FALSE
	EQUAL? PRSI,SKIFF \FALSE
	CALL PERFORM,V?PUT,PRSO,SKIFF
	RTRUE

	.FUNCT OARS-F
	EQUAL? PRSA,V?REMOVE,V?TAKE \FALSE
	PRINTI "They are fastened to"
	CALL TPRINT,SKIFF
	PRINTI " with metal oarlocks"
	PRINT PCR
	RTRUE

	.FUNCT DEBARK-SKIFF
	CALL DEQUEUE,I-CURRENT
	SET 'SKIFF-TIED,1
	PRINTI "You tie"
	CALL TPRINT,SKIFF
	PRINTI " to the end of"
	CALL TPRINT,LADDER
	PRINTI ", then climb partway up it"
	PRINT PCR
	CRLF
	MOVE PROTAGONIST,HERE
	MOVE SKIFF,BY-SHIP
	CALL GOTO,ON-LADDER >STACK
	RSTACK

	.FUNCT BY-SHIP-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	MOVE PROTAGONIST,SKIFF
	RTRUE
?L1:	EQUAL? RARG,M-LOOK \?L3
	PRINTI "You are floating in a small skiff "
	GRTR? SHIP-LOC,4 \?L4
	LESS? SHIP-LOC,9 \?L4
	PRINTI "at the stern of"
	CALL TPRINT,SHIP
	PRINTI ", "
	EQUAL? SHIP-LOC,7,8 \?L6
	PRINTI "at the far edge of"
	JUMP ?L10
?L6:	EQUAL? SHIP-LOC,5,6 \?L10
	PRINTI "in the middle of"
	JUMP ?L10
?L4:	PRINTI "in"
?L10:	PRINTI " the lagoon."
	ZERO? LADDER-HANGING /TRUE
	PRINTI " A rope ladder, frayed ends dripping water, hangs down from the poop deck."
	RTRUE
?L3:	EQUAL? RARG,M-END \FALSE
	CALL RUNNING?,I-CURRENT >STACK
	ZERO? STACK \FALSE
	SET 'ROWING,0
	CALL QUEUE,I-CURRENT,-1 >STACK
	RSTACK

	.FUNCT LAGOON-F,RARG,VENUE=0
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "You are "
	LOC PROTAGONIST >STACK
	EQUAL? STACK,CASK \?L3
	PRINTI "crouched in a cask"
	SET 'VENUE,CASK-LOC
	JUMP ?L5
?L3:	PRINTI "sitting in a skiff"
	SET 'VENUE,SKIFF-LOC
?L5:	PRINTI " on the lagoon of "
	PRINTD ISLAND
	SUB SHIP-LOC,VENUE >STACK
	LESS? STACK,2 \?L6
	PRINTI ". You are quite near"
	FSET? SHIP,MUNGBIT \?L8
	CALL TPRINT,REEFS
	JUMP ?L13
?L8:	CALL TPRINT,SHIP
	JUMP ?L13
?L6:	SUB 10,VENUE >STACK
	LESS? STACK,5 \?L11
	PRINTI ". The crash of surf hitting"
	CALL TPRINT,REEFS
	PRINTI " is quite loud"
	JUMP ?L13
?L11:	LESS? VENUE,3 \?L12
	PRINTI ". Music floats down to the water, mingling with the distant roar of the sea"
	JUMP ?L13
?L12:	PRINTI ". The jungle looms gray-green in the light of the full moon"
?L13:	PRINTI "."
	RTRUE
?L1:	EQUAL? RARG,M-END \FALSE
	EQUAL? PRSA,V?LOOK /FALSE
	SET 'LOOKED-LAGOON?,1
	RFALSE

	.FUNCT STONE-F
	EQUAL? PRSA,V?SHOOT \?L1
	ZERO? PRSI \?L3
	REMOVE STONE
	CALL CTPRINT,STONE
	PRINTI ", unaimed, flies into the air, arcing up and into the sea"
	PRINT PCR
	RTRUE
?L3:	EQUAL? PRSO,GARTER \?L5
	CALL WASTES >STACK
	RSTACK
?L5:	GETP PRSO,P?SIZE >STACK
	LESS? STACK,5 \?L6
	PRINTI "You don't trust your aim to hit something that small"
	PRINT PCR
	RTRUE
?L6:	IN? STONE,GARTER /?L7
	PRINT YOULL-HAVE-TO
	PRINTI "put"
	CALL TPRINT,STONE
	PRINTI " into"
	CALL TRPRINT,GARTER
	RTRUE
?L7:	FSET? PRSO,DEADBIT \?L9
	CALL PRINT-ID,STR?249
	CALL MAN-IS-DOWN >STACK
	RSTACK
?L9:	EQUAL? PRSO,ME \?L11
	PRINT SUICIDE
	CALL PRINT-ID,STR?250 >STACK
	RSTACK
?L11:	EQUAL? PRSO,LUCY \?L12
	PRINT UNLADY
	CALL PRINT-ID,STR?251 >STACK
	RSTACK
?L12:	EQUAL? PRSO,PISTOL \?L13
	CALL PERFORM-PRSA,CRULLEY,PRSI
	RTRUE
?L13:	EQUAL? PRSO,HOUSE,SHIP \?L14
	PRINTI "That is too far away."
	CRLF
	CALL PRINT-ID,STR?252 >STACK
	RSTACK
?L14:	EQUAL? PRSO,HERO \?L15
	MOVE GARTER,HERE
	PRINTI "You falter, dropping the makeshift sling. Your heart rules too well"
	PRINT PCR
	CALL PRINT-ID,STR?253 >STACK
	RSTACK
?L15:	PRINTI "You pull"
	CALL TPRINT,GARTER
	PRINTI " taut, aim, and let fly"
	CALL TPRINT,STONE
	PRINTI ". "
	FSET STONE,TRYTAKEBIT
	MOVE STONE,HERE
	EQUAL? PRSO,LAFOND \?L20
	LESS? LAFOND-CTR,FIGHTING /?L19
?L20:	EQUAL? PRSO,CRULLEY \?L17
	LESS? LAFOND-CTR,DEAD \?L17
?L19:	PRINTI "It clatters onto the rocks, short of the mark"
	PRINT PCR
	RTRUE
?L17:	FSET? PRSO,ACTORBIT \?L21
	CRLF
	PRINT INDENT
	PRINTI "He ducks as it whirs past his ear"
	CALL PRINT-ID,STR?254
	EQUAL? PRSO,CRULLEY \?L22
	FSET DAD,DEADBIT
	INC 'SCORE
	PRINTI ". Papa, creeping unnoticed up the stairs, leaps and wrests the gun from his grip, toppling all three, father, pirate and gun, off the cliff. Lucy screams as the struggling pair fall to the rocks below.
   You run to Nicholas. You have lost"
	CALL TPRINT,DAD
	PRINTI ", but Nicholas's embrace remains, comforting, shielding, a world of love"
	PRINT PCR
	CALL PRINT-ID,STR?255
	CALL FINALE >STACK
	RSTACK
?L22:	PRINTI " to disappear with a quiet thud into the sand"
	EQUAL? PRSO,DAD \?L25
	PRINTI ". He looks a bit surprised, but nods encouragingly"
?L25:	PRINT PCR
	RTRUE
?L21:	PRINTI "It bounces off"
	CALL TRPRINT,PRSO
	RTRUE
?L1:	EQUAL? PRSA,V?TAKE \?L29
	FSET? STONE,TRYTAKEBIT \?L29
	CALL CANT-REACH,STONE >STACK
	RSTACK
?L29:	EQUAL? PRSA,V?THROW-AT,V?THROW \?L30
	EQUAL? PRSO,STONE \?L30
	ZERO? PRSI \?L31
	CALL PERFORM,V?SHOOT,STONE
	RTRUE
?L31:	CALL HELD?,PRSI >STACK
	ZERO? STACK /?L33
	CALL WASTES >STACK
	RSTACK
?L33:	FSET? PRSI,DEADBIT \?L35
	CALL PRINT-ID,STR?256
	CALL MAN-IS-DOWN
	RTRUE
?L35:	MOVE STONE,HERE
	PRINTI "You hurl"
	CALL TPRINT,STONE
	PRINTI ", but it falls far short of"
	CALL TRPRINT,PRSI
	RTRUE
?L30:	EQUAL? PRSA,V?KILL \?L38
	IN? STONE,GARTER /?L39
	CALL PROPOSE >STACK
	RSTACK
?L39:	CALL PERFORM,V?SHOOT,PRSO,STONE
	RTRUE
?L38:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "It is a pretty little stone"
	PRINT PCR
	RTRUE

	.FUNCT SHALLOWS-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "You are "
	LOC PROTAGONIST >STACK
	EQUAL? STACK,HERE \?L3
	ZERO? BOY-DRESS? /?L5
	PRINTI "soaking your shoes and stockings in"
	JUMP ?L9
?L5:	FSET? CHEMISE,EVERYBIT /?L7
	PRINTI "soaking the hem of your chemise in"
	JUMP ?L9
?L7:	PRINTI "holding your skirts high over"
	JUMP ?L9
?L3:	LOC PROTAGONIST >STACK
	EQUAL? STACK,CASK \?L10
	PRINTI "crouched in"
	CALL TPRINT,CASK
	JUMP ?L12
?L10:	PRINTI "sitting in"
	CALL TPRINT,SKIFF
?L12:	PRINTI " in"
?L9:	PRINTI " the warm, lapping waves of the shallows. A white sand beach is west of you."
	RTRUE
?L1:	EQUAL? RARG,M-BEG \FALSE
	EQUAL? PRSA,V?SSHOOT,V?SHOOT \FALSE
	CALL META-LOC,PRSO >STACK
	EQUAL? STACK,HERE,GLOBAL-OBJECTS \?L14
	CALL META-LOC,PRSI >STACK
	EQUAL? STACK,HERE,GLOBAL-OBJECTS /FALSE
?L14:	PRINTR "Your aim is too unsure from this distance. Go to the beach."

	.FUNCT FLOATING
	EQUAL? HERE,SHALLOWS \?L1
	IN? PROTAGONIST,SKIFF \?L3
	EQUAL? P-WALK-DIR,P?WEST \?L5
	CALL DO-FIRST,STR?233,SKIFF
	RFALSE
?L5:	EQUAL? P-WALK-DIR,P?EAST \FALSE
	PRINT YOULL-HAVE-TO
	PRINTI "row that way"
	PRINT PCR
	RFALSE
?L3:	EQUAL? P-WALK-DIR,P?WEST \?L10
	RETURN BEACH
?L10:	PRINTI "You wade in the shallow water, unable to swim"
	PRINT PCR
	RFALSE
?L1:	EQUAL? P-WALK-DIR,P?WEST \?L13
	PRINTI "You're going that way anyway"
	PRINT PCR
	RFALSE
?L13:	PRINT YOULL-HAVE-TO
	PRINTI "row that way"
	PRINT PCR
	RFALSE

	.FUNCT REEFS-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	CALL INNER-DECK,HERE >STACK
	ZERO? STACK /?L3
	PRINT YOU-CANT-SEE-ANY
	PRINTD REEFS
	PRINTI " from here"
	PRINT PCR
	RTRUE
?L3:	PRINTI "A line of reefs separates the lagoon from the sea beyond"
	PRINT PCR
	RTRUE

	.FUNCT HERO-F,OARG=0
	ZERO? OARG /?L1
	EQUAL? OARG,M-DESC? /TRUE
	EQUAL? HERE,FOLLY /?L6
	PRINT INDENT
?L6:	EQUAL? HERE,CABIN \?L9
	PRINT CTHE-PIRATE-CAPTAIN
	PRINTI "is studying you"
	JUMP ?L22
?L9:	EQUAL? HERE,DEUX-DECK \?L11
	PRINT CTHE-PIRATE-CAPTAIN
	PRINTI "stands protectively a few steps behind you"
	JUMP ?L22
?L11:	EQUAL? HERE,CAPT-QUARTERS \?L12
	PRINTD HERO
	PRINTI " is adjusting his clothes"
	JUMP ?L22
?L12:	CALL RUNNING?,I-DUEL >STACK
	ZERO? STACK /?L13
	PRINTI "Battered and bruised, Nicholas can hardly stand"
	JUMP ?L22
?L13:	FSET? HERO,DEADBIT \?L14
	PRINT HERO-EYES-CLOSED
	JUMP ?L22
?L14:	EQUAL? HERE,BEACH \?L15
	PRINTI "Nicholas "
	FSET? LAFOND,DEADBIT \?L16
	PRINTI "walks toward you, smiling wearily"
	JUMP ?L22
?L16:	GRTR? LAFOND-CTR,4 \?L18
	PRINTI "and Lafond are fighting"
	JUMP ?L22
?L18:	PRINTI "stands alone at one edge of the beach"
	JUMP ?L22
?L15:	CALL QUEUED?,I-ENDGAME >STACK
	ZERO? STACK /?L20
	PRINTI "Nicholas stands, half-supported by Lucy and"
	CALL TPRINT,DAD
	JUMP ?L22
?L20:	EQUAL? HERE,BALLROOM \FALSE
	PRINTI "Nicholas looks quite rakish, in red velvet and white, his rapier flashing in the light of the "
	PRINTD CHANDELIER
?L22:	PRINTI "."
	RTRUE
?L1:	EQUAL? HERO,WINNER \?L23
	CALL RUNNING?,I-DUEL >STACK
	ZERO? STACK /?L24
	EQUAL? HERE,GALLERY,STAIRTOP \?L24
	PRINT SPEECHLESS
	RTRUE
?L24:	EQUAL? HERE,BEACH \?L26
	CALL RUNNING?,I-ENDGAME >STACK
	ZERO? STACK /?L26
	FSET? LAFOND,DEADBIT /?L27
	GRTR? LAFOND-CTR,4 \?L27
	PRINT SPEECHLESS
	RTRUE
?L27:	EQUAL? PRSA,V?WALK,V?LOOK-INSIDE,V?HALT /?L30
	EQUAL? PRSA,V?CLIMB-DOWN \?L29
?L30:	CALL PRINT-ID,STR?257
	CALL H-JIGS-UP,STR?258 >STACK
	RSTACK
?L29:	CALL FAILS-TO-NOTICE >STACK
	RSTACK
?L26:	FSET? HERO,DEADBIT \?L32
	PRINT DOESNT-RESPOND
	RTRUE
?L32:	EQUAL? PRSA,V?FOLLOW \?L33
	EQUAL? PRSO,ME \?L33
	CALL RUNNING?,I-HDANCE >STACK
	ZERO? STACK /?L33
	FSET? DAD,TOUCHBIT \?L33
	SET 'HDAD-SPEECH,1
	PRINTR """I will follow you anywhere you please, but first I must kill Lafond."""
?L33:	EQUAL? PRSA,V?I-LOVE-YOU \?L34
	EQUAL? PRSO,HERO,MAN \?L35
	PRINTR "He smiles at you warmly, his eyes full of passion."
?L35:	EQUAL? PRSO,LAFOND \?L37
	CALL RUNNING?,I-HFOLLY >STACK
	ZERO? STACK \?L40
	CALL RUNNING?,I-HDANCE >STACK
	ZERO? STACK /?L38
?L40:	REMOVE HERO
	CALL STOP-QUEUES
	PRINTR "He looks at you in disgust and walks away."
?L38:	PRINTR """Don't jest,"" he says."
?L37:	PRINTR "He isn't all that interested."
?L34:	EQUAL? PRSA,V?LEAVE \?L43
	FSET? BEACH,TOUCHBIT \?L44
	SET 'AWAITING-REPLY,4
	CALL QUEUE,I-REPLY,2
	PRINTR "He catches your arm, ""Nay, can you mean that?"""
?L44:	PRINTR """I have business to attend to here, and have no intention of leaving."""
?L43:	EQUAL? PRSA,V?READ \?L47
	EQUAL? PRSO,LETTER \?L47
	CALL PERFORM,V?TELL-ABOUT,ME,LETTER
	RTRUE
?L47:	EQUAL? PRSA,V?TELL-ABOUT \?L48
	EQUAL? PRSO,ME \?L48
	EQUAL? PRSI,LETTER \?L49
	PRINTI """Your father wrote it for you."""
	CRLF
	JUMP ?L58
?L49:	EQUAL? PRSI,HRING \?L51
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?TAKE,HRING
	RTRUE
?L51:	EQUAL? PRSI,LAFOND \?L52
	PRINTI """I abhor the fiend."" He clenches a fist."
	CRLF
	JUMP ?L58
?L52:	EQUAL? PRSI,DAD \?L53
	CALL RUNNING?,I-HDANCE >STACK
	ZERO? STACK /?L54
	SET 'HDAD-SPEECH,1
	GET HERO-SPEECHES,0 >STACK
	PRINT STACK
	PRINT PCR
	JUMP ?L58
?L54:	CALL RUNNING?,I-HFOLLY >STACK
	ZERO? STACK /?L56
	PRINTI """Let's not discuss"
	CALL TPRINT,DAD
	PRINTI " just now,"" he says, kissing your neck"
	PRINT PCR
	CALL PRINT-ID,STR?259
	JUMP ?L58
?L56:	PRINTI """I admire and respect your father greatly."""
	CRLF
	JUMP ?L58
?L53:	CALL FAILS-TO-NOTICE
?L58:	CALL STOP >STACK
	RSTACK
?L48:	EQUAL? PRSA,V?TAKE \?L59
	EQUAL? PRSO,FLOWER \?L59
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?GIVE,FLOWER,HERO
	SET 'WINNER,HERO
	RTRUE
?L59:	CALL COM-CHECK,HERO >OARG
	ZERO? OARG /FALSE
	EQUAL? OARG,M-FATAL \TRUE
	RFALSE
?L23:	EQUAL? PRSA,V?EXAMINE \?L65
	FSET? HERO,DEADBIT \?L66
	CALL RUNNING?,I-DUEL >STACK
	ZERO? STACK /?L68
	PRINTR "He lies in a pool of blood."
?L68:	PRINT HERO-EYES-CLOSED
	RTRUE
?L66:	EQUAL? HERE,CAPT-QUARTERS,BALLROOM,FOLLY \?L71
	ZERO? ENDGAME \?L71
	PRINTI "Jamison is finely dressed, in red velvet coat and full breeches, with a long gold embroidered vest and waterfalls of white lace at his neck, wrists and boottops. His rapier is bedecked with a fringed gold ribbon. He wears no wig, his unpowdered hair tied neatly at the back of his neck"
	PRINT PCR
	RTRUE
?L71:	PRINTI "Jamison carries an aura of power unusual in men so slim and tall, the strength of a willow in his hard seaworn body, straight shouldered and resilient. "
	PRINT NUTBROWN
	PRINTI "A jagged scar etches one cheek, harsh against the warmth of his limpid blue eyes"
	PRINT PCR
	RTRUE
?L65:	EQUAL? PRSA,V?ROLL,V?SAVE-SOMETHING \?L73
	CALL RUNNING?,I-ENDGAME >STACK
	ZERO? STACK /?L73
	SET 'WINNER,HERO
	CALL PERFORM,V?HALT,ROOMS
	SET 'WINNER,PROTAGONIST
	RTRUE
?L73:	FSET? HERO,DEADBIT \?L74
	EQUAL? PRSA,V?GIVE \?L75
	EQUAL? PRSO,SALTS \?L75
	CALL REVIVE-HERO >STACK
	RSTACK
?L75:	EQUAL? PRSA,V?THROW-AT,V?PUT-ON,V?BLOW \?L77
	EQUAL? PRSO,SPICES \?L77
	PRINTR "He sneezes involuntarily, unconscious."
?L77:	EQUAL? PRSA,V?MUNG,V?KICK,V?KILL \?L78
	EQUAL? PRSA,V?MUNG,V?KILL /?L79
	PUSH 0
	JUMP ?L80
?L79:	PUSH 1
?L80:	CALL PRINT-ID,STR?260,STACK
	EQUAL? PRSA,V?KICK /?L81
	PUSH 0
	JUMP ?L82
?L81:	PUSH 1
?L82:	CALL PRINT-ID,STR?261,STACK
	CALL MAN-IS-DOWN >STACK
	RSTACK
?L78:	EQUAL? PRSA,V?MOVE \?L83
	PRINTR "He's too heavy."
?L83:	EQUAL? PRSA,V?EMBRACE,V?KISS \?L84
	PRINTI "You press your lips to his cold mouth. "
	PRINT DOESNT-RESPOND
	RTRUE
?L84:	EQUAL? PRSA,V?ASK-ABOUT,V?TELL-ABOUT,V?TELL \?L87
	EQUAL? PRSO,HERO \?L86
?L87:	CALL TOUCHING?,HERO >STACK
	ZERO? STACK /FALSE
?L86:	PRINT DOESNT-RESPOND
	RTRUE
?L74:	EQUAL? PRSA,V?GIVE \?L89
	EQUAL? PRSO,SALTS \?L90
	CALL REVIVE-HERO >STACK
	RSTACK
?L90:	EQUAL? PRSO,BANKNOTE \?L92
	PRINTD HERO
	PRINTI " returns"
	CALL TPRINT,BANKNOTE
	PRINTI " to you"
	PRINT PCR
	RTRUE
?L92:	EQUAL? PRSO,FLOWER \?L93
	PRINTR "He prevents you, smiling. ""It looks much too pretty against your hair. Keep it."""
?L93:	EQUAL? PRSO,COFFER \FALSE
	CALL FAILS-TO-NOTICE >STACK
	RSTACK
?L89:	EQUAL? PRSA,V?ALARM \?L96
	EQUAL? PRSI,SALTS /?L97
	PRINT YOU-CANT
	PRINTR "revive him with that!"
?L97:	CALL HELD?,SALTS >STACK
	ZERO? STACK /?L99
	CALL REVIVE-HERO >STACK
	RSTACK
?L99:	PRINTD HERO
	PRINTI " is not asleep"
	PRINT PCR
	RTRUE
?L96:	EQUAL? PRSA,V?UNTIE \?L101
	EQUAL? P-PRSA-WORD,W?FREE \?L101
	IN? HERO,MANACLES \?L102
	SET 'AWAITING-REPLY,2
	CALL QUEUE,I-REPLY,2
	PRINTR "You have the key, maybe?"
?L102:	PRINTI "Jamison is free enough as it is"
	PRINT PCR
	RTRUE
?L101:	EQUAL? PRSA,V?MUNG,V?KICK,V?KILL \?L105
	PRINTI """Please, I'm not trying to hurt you,"""
	CALL PRINT-ID,STR?262
	EQUAL? HERE,CABIN \?L106
	PRINTI " the stranger"
	JUMP ?L108
?L106:	CALL TPRINT,HERO
?L108:	PRINTI " says, casually deflecting the blow"
	PRINT PCR
	RTRUE
?L105:	EQUAL? PRSA,V?KISS \?L109
	EQUAL? WINNER,PROTAGONIST \?L109
	EQUAL? HERE,CABIN,DEUX-DECK \?L110
	PRINTR "You are not so pert as to kiss a stranger, and a pirate, at that!"
?L110:	CALL SHIP-BOARD,HERE >STACK
	ZERO? STACK /?L112
	PRINTI "That thought has occurred to you before, but now does not seem appropriate"
	PRINT PCR
	RTRUE
?L112:	EQUAL? HERE,FOLLY \?L113
	SET 'REACTION,REACTION-POSITIVE
	PRINTI "You lean into his arms, face lifted"
	PRINT PCR
	RTRUE
?L113:	CALL RUNNING?,I-DUEL >STACK
	ZERO? STACK \?L115
	CALL RUNNING?,I-ENDGAME >STACK
	ZERO? STACK /?L114
?L115:	PRINTI "You would only distract"
	CALL TRPRINT,HERO
	RTRUE
?L114:	CALL RUNNING?,I-HDANCE >STACK
	ZERO? STACK /?L116
	PRINTI "In view of all"
	CALL TPRINT,DANCERS
	PRINTI "s, you exchange only a peck on the cheek"
	PRINT PCR
	RTRUE
?L116:	PRINTI "He kisses you back"
	PRINT PCR
	RTRUE
?L109:	EQUAL? PRSA,V?TELL-ABOUT \?L118
	CALL NOUN-USED,W?LIBRARY,HOUSE >STACK
	ZERO? STACK \?L121
	CALL NOUN-USED,W?CELL,CELL-4 >STACK
	ZERO? STACK \?L121
	EQUAL? PRSI,DUNGEON,PORTRAIT \?L119
?L121:	PRINTR "He nods. ""That area is guarded well."""
?L119:	EQUAL? PRSI,DAD \?L122
	IN? DAD,CELL-4 \?L123
	PRINTR "He smiles fondly at your reminiscing. ""I never knew my father -- he died when I was a boy."""
?L123:	SET 'HDAD-SPEECH,1
	PRINTR """Such bravery joined with such beauty!"""
?L122:	EQUAL? PRSI,CRULLEY \FALSE
	FSET? BEACH,TOUCHBIT \FALSE
	PRINTR """Crulley?! God's blood!"""
?L118:	EQUAL? PRSA,V?TOUCH,V?EMBRACE \?L128
	EQUAL? HERE,FOLLY \?L128
	CALL PERFORM,V?KISS,HERO
	RTRUE
?L128:	EQUAL? PRSA,V?DANCE \?L129
	EQUAL? HERE,BALLROOM \?L130
	EQUAL? PARTNER,HERO \?L130
	PRINT PACE
	RTRUE
?L130:	CALL RUNNING?,I-HDANCE >STACK
	ZERO? STACK /FALSE
	MOVE PROTAGONIST,BALLROOM
	MOVE HERO,BALLROOM
	SET 'PARTNER,HERO
	PRINTI "You whirl back out to"
	PRINT DANCE-FLOOR
	PRINT PCR
	RTRUE
?L129:	EQUAL? PRSA,V?SHOW \FALSE
	EQUAL? PRSO,JEWEL \FALSE
	IN? HERO,MANACLES \FALSE
	PRINTR "Nick smiles dazzlingly, ""Of course! Now pick the locks."""

	.FUNCT GEN-PIRATE
	ZERO? ENDGAME /?L1
	EQUAL? HERE,BALLROOM \?L1
	RETURN CREW
?L1:	FSET? CAPT-QUARTERS,TOUCHBIT \FALSE
	RETURN CRULLEY

	.FUNCT I-MEET-HERO
	SET 'AWAITING-REPLY,5
	CALL QUEUE,I-REPLY,1
	SET 'QUESTIONER,HERO
	PRINT INDENT
	EQUAL? HERO-CTR,1 \?L1
	MOVE HERO,HERE
	CALL QUEUE,I-MEET-HERO,-1
	LESS? ATTACK-C,2 \?L3
	CALL DEQUEUE,I-CRULLEY
	FSET CRULLEY,DEADBIT
	PRINTD CRULLEY
	PRINTI " drags you, despite your resistance, to"
	LOC PROTAGONIST >STACK
	EQUAL? STACK,CABIN-BED \?L5
	MOVE PROTAGONIST,HERE
	PRINTI " your feet"
	JUMP ?L7
?L5:	PRINTI "wards him"
?L7:	PRINTI ". Then suddenly he grunts, stiffens and slumps into your arms. "
	PRINT STUNNED-THE-SAILOR
	PRINTI ".
   A tall form blocks the shattered door, one fist still raised from striking your attacker"
	JUMP ?L8
?L3:	CALL CTPRINT,DOOR
	PRINTI " creaks slightly as a tall form bends through its smashed remains. ""You seem to have this situation well in hand,"" timbers a well-bred voice"
?L8:	PRINTI ". You catch a glimpse of the hard masculinity of his broad shoulders, the implied power in the scar that etches the stranger's jaw, and feel tremors course through your veins. Then you realize how ragged are his shirt, patched breeches and high boots. Intuitively, you understand -- he is the dreaded Falcon, scourge of the sea! Alas, your fate is sealed. Resigned, you meet his sea-blue eyes."
	CRLF
	JUMP ?L17
?L1:	EQUAL? HERO-CTR,2 \?L9
	MOVE LETTER,PROTAGONIST
	CALL THIS-IS-IT,LETTER
	PRINT SURPRISE
	PRINTI "the stranger bows. ""Well met, my lady."" His accent is cultured, his smile vibrant. ""I am Captain Nicholas Jamison, known in these waters as 'The Falcon'. Your father has sent me."" He chuckles at your glare of distrust. ""Yes, you are like your sire. You needn't believe me untried -- I carry this."" He hands you"
	CALL ARPRINT,LETTER
	JUMP ?L17
?L9:	EQUAL? HERO-CTR,3 \?L10
	FSET DOOR,OPENBIT
	PRINT CTHE-PIRATE-CAPTAIN
	PRINTI "glances around the empty room, then notices the coffer"
	IN? COFFER,PROTAGONIST \?L11
	PRINTI " in your arms"
?L11:	MOVE COFFER,HERO
	PRINTI ". ""Davis's safety box -- my men were hoping I'd find it."" He takes it and nudges the unconscious man on the floor, ""I wonder how "
	PRINTD CRULLEY
	PRINTI " knew you were here? Just his bad luck? He'll be flogged when he wakes.""
   The pirate bows. ""My lady, may I offer my protection and my ship until your father is free?"""
	CRLF
	JUMP ?L17
?L10:	EQUAL? HERO-CTR,4,5 \?L17
	EQUAL? HERO-CTR,4 \?L15
	EQUAL? REACTION,REACTION-NEUTRAL \?L15
	SET 'QUESTIONER,HERO
	PRINTI """We haven't time to waste. Will you come willingly or not?"" says"
	CALL TRPRINT,HERO
	JUMP ?L17
?L15:	CALL DEQUEUE,I-MEET-HERO
	CALL DEQUEUE,I-PIRATE-ATTACK
	EQUAL? REACTION,REACTION-POSITIVE \?L18
	PRINTI "He chuckles. ""Brave lady, to trust a stranger -- and a pirate. Who knows, perhaps I forged your father's signature? Keep by my side as we go to my ship -- few sailors respect a lady's dignity."" He helps you through"
	CALL TRPRINT,DOOR
	CRLF
	JUMP ?L20
?L18:	PRINTI "He sighs, ""You share"
	CALL TPRINT,DAD
	PRINTI "'s stubborn streak. I wished not to do this."" He leaps to your side, hauling you up onto his shoulder, and carries you out of the room."
	CALL TPRINT,HERO
	PRINTI " sets you on your feet again on the horror of the deck"
	PRINT PCR
	CRLF
?L20:	FSET HERO,NDESCBIT
	MOVE HERO,DEUX-DECK
	CALL GOTO,DEUX-DECK
?L17:	INC 'HERO-CTR
	RETURN HERO-CTR

	.FUNCT I-HSHIP
	PRINT INDENT
	GET HERO-SHIP-SPEECHES,HERO-CTR >STACK
	PRINT STACK
	CRLF
	EQUAL? HERO-CTR,2 \?L1
	REMOVE HERO
	CALL QUEUE,I-HSECOND-BYE,8
	JUMP ?L3
?L1:	CALL QUEUE,I-HSHIP,1
?L3:	INC 'HERO-CTR
	RETURN HERO-CTR

	.FUNCT I-HSECOND-BYE
	CALL RUNNING?,I-OVERHEAR-CRULLEY >STACK
	ZERO? STACK \?L3
	EQUAL? HERE,SLEEPING-CUPBOARD \?L1
?L3:	CALL QUEUE,I-HSECOND-BYE,2 >STACK
	RSTACK
?L1:	MOVE JEWEL,PROTAGONIST
	PRINT INDENT
	PRINTI "You hear"
	EQUAL? HERE,CAPT-QUARTERS \?L5
	CALL TPRINT,CUPBOARD-OBJECT
	PRINTI " scrape"
	JUMP ?L8
?L5:	EQUAL? HERE,LANDING \?L7
	CALL TPRINT,DOOR
	PRINTI " being unbarred"
	JUMP ?L8
?L7:	PRINTI " a footstep"
?L8:	PRINTI ", "
	FSET? CHEMISE,EVERYBIT /?L9
	PRINTI "turn, and cover "
	PRINTD ME
	PRINTI " as best you can with what you are holding, for Jamison stands there, his eyes burning through your lightweight chemise. He chuckles, ""I am not sorry in the least that I surprised you."
	JUMP ?L12
?L9:	ZERO? BOY-DRESS? /?L11
	PRINTI "and"
	CALL TPRINT,HERO
	PRINTI "'s startled laugh. ""For a moment I thought you were Matthew, the boy who used to sleep in the cupboard. He ran off last port."
	JUMP ?L12
?L11:	PRINTI "and turn to see"
	CALL TPRINT,HERO
	PRINTI ". ""Hello!"
?L12:	EQUAL? HERE,CAPT-QUARTERS /?L13
	PRINTI " How did you escape? Don't stutter, I won't lock you up again -- you are safe as long as you remain below-decks."
?L13:	PRINTI " I came down to give you this -- my allotment from"
	CALL TPRINT,COFFER
	PRINTI "."" He nods at the box in his arms.
   Jamison starts to pin"
	CALL APRINT,JEWEL
	PRINTI " on your clothes, but, ""Devil take it, the clasp is broken. I'll have it repaired."" He folds the pretty thing into "
	PRINTD HANDS
	PRINTI ". ""And I meant to reassure you that if the men suddenly abandon ship, they are off to help me. Rodney will stay behind with you."" He "
	EQUAL? HERE,CAPT-QUARTERS \?L16
	MOVE COFFER,HERE
	PRINTI "drops"
	CALL TPRINT,COFFER
	PRINTI " on the floor, smiling in farewell,"
	JUMP ?L18
?L16:	MOVE COFFER,PROTAGONIST
	PRINTI "hands"
	CALL TPRINT,COFFER
	PRINTI " to you. ""Please return this to my quarters for me, will you?"""
?L18:	PRINTI " and walks swiftly "
	EQUAL? HERE,LANDING \?L19
	PRINTI "up the stairs to the deck, barring the door a moment later"
	JUMP ?L21
?L19:	PRINTI "away"
?L21:	PRINT PCR
	CALL QUEUE,I-SMELL-SMOKE,3
	CALL QUEUE,I-HERO-TO-ISLAND,5
	RETURN 8

	.FUNCT I-HDANCE
	EQUAL? HERO-CTR,1 \?L1
	EQUAL? BALLROOM,HERE \?L1
	MOVE HERO,HERE
	SET 'LAFOND-CTR,1
	CALL QUEUE,I-LDANCE,7
	SET 'PARTNER,HERO
	SET 'QUESTIONER,HERO
	SET 'AWAITING-REPLY,14
	CALL QUEUE,I-REPLY,2
	SET 'DANCED-WITH,HERO
	PRINT INDENT
	PRINTD HERO
	PRINTI " moves up to you, saying, ""May I have this dance?"" He doesn't await an answer, sweeping you out onto"
	PRINT DANCE-FLOOR
	PRINT PCR
	JUMP ?L25
?L1:	EQUAL? HERO-CTR,2 \?L3
	SET 'QUESTIONER,HERO
	ZERO? MET-ALREADY \?L4
	SET 'MET-ALREADY,1
	PRINT INDENT
	PRINTI """"
	PRINT FIRST-SIGHTING
	PRINTI "smiles suddenly. ""Why should I complain? You are quite safe, since no one expects you here. And you are looking lovely."""
	CRLF
	JUMP ?L6
?L4:	CALL HERO-TALKS
?L6:	EQUAL? HERE,BALLROOM \?L25
	PRINT INDENT
	PRINTI "The steps of the dance separate you a moment, as you twirl around and curtsey to another dancer. You glide back into the captain's arms"
	PRINT PCR
	JUMP ?L25
?L3:	EQUAL? HERO-CTR,3 \?L10
	SET 'QUESTIONER,HERO
	CALL HERO-TALKS
	EQUAL? HERE,BALLROOM \?L25
	PRINT INDENT
	PRINTI "Your hands linked tightly with his and held high over "
	PRINTD HEAD
	PRINTI "s, a line of dancers files between you and Jamison"
	PRINT PCR
	JUMP ?L25
?L10:	EQUAL? HERO-CTR,4 \?L14
	SET 'QUESTIONER,HERO
	CALL HERO-TALKS
	EQUAL? HERE,BALLROOM \?L25
	PRINT INDENT
	PRINTI "Together you whirl around the ballroom, his arm snug around your waist, leading you gracefully, masterfully.
    Nicholas's grip tenses as he nods to a bewigged man staring at you. You turn, and the man moves on"
	PRINT PCR
	JUMP ?L25
?L14:	EQUAL? HERO-CTR,5 \FALSE
	REMOVE HERO
	SET 'PARTNER,0
	CALL DEQUEUE,I-HDANCE
	CALL HERO-TALKS
	PRINT INDENT
	PRINTI "The music ends with a flourish"
	EQUAL? HERE,BALLROOM \?L19
	PRINTI " and you pirouette once more before curtseying to Jamison. As you move"
	JUMP ?L21
?L19:	PRINTI ". As he guides you back"
?L21:	PRINTI " to the side of"
	PRINT DANCE-FLOOR
	PRINTI ", Nick adds, ""We should separate -- I'm sure I am being watched. You would be safer aboard"
	CALL TPRINT,SHIP
	PRINTI ". If you slip out the veranda doors, no one will notice you leaving."" He touches "
	PRINTD HANDS
	PRINTI " and dissolves into the crowd"
	PRINT PCR
	EQUAL? HERE,BALLROOM /?L25
	CALL GOTO,BALLROOM
?L25:	INC 'HERO-CTR
	RETURN HERO-CTR

	.FUNCT I-HARRESTED,FROM-LDANCE=0
	SET 'HERO-ARRESTED,1
	PRINT INDENT
	PRINTI "There is a commotion from the west. A woman screams and a man yells, ""Stop, Pirate!"" "
	ZERO? FROM-LDANCE \?L1
	EQUAL? HERE,FOYER /?L1
	CALL HELD?,HAT >STACK
	ZERO? STACK /?L3
	FCLEAR HAT,WORNBIT
	MOVE HAT,LIBRARY
?L3:	PRINTI "You run to the foyer in time to see two dragoons dragging out the battered frame of"
	CALL TPRINT,HERO
	JUMP ?L6
?L1:	PRINTI "and Jamison is dragged out of the ballroom by two burly dragoons"
?L6:	PRINT PCR
	PRINTI "   An officer quiets the guests, ""This is the buccaneer who has been pirating our ships. He had the audacity to come here tonight intending to assassinate our dear governor. Do not worry, ladies, he was arrogant enough to come alone."" The officer marches after his men. "
	CALL CTPRINT,DANCERS
	PRINTI "s return to their banal conversations"
	PRINT PCR
	ZERO? FROM-LDANCE \?L7
	CRLF
	CALL GOTO,FOYER >STACK
	RSTACK
?L7:	CALL QUEUE,I-LDANCE,1
	SET 'PARTNER,LAFOND
	PRINT INDENT
	PRINTI "Only the painful grip"
	CALL TPRINT,LAFOND
	PRINTR " has on your arm prevents you from swooning away. ""Ah, so that's the way of it,"" he purrs, noticing your sudden pallor. ""All the better for me."" He pulls you unresisting into a dance."

	.FUNCT I-HFOLLY,CALLED-BY-HERO-F=0
	EQUAL? HERE,FOLLY \FALSE
	SET 'QUESTIONER,HERO
	ZERO? CALLED-BY-HERO-F \?L4
	PRINT INDENT
?L4:	EQUAL? HERO-CTR,1 \?L7
	CALL QUEUE,I-HFOLLY,-1
	MOVE HERO,FOLLY
	PRINTD HERO
	PRINTI " enters"
	CALL TPRINT,FOLLY-OBJECT
	PRINTI ", stooping to avoid the flowers dangling over the door. ""I thought I heard someone."
	ZERO? MET-ALREADY \?L9
	SET 'MET-ALREADY,1
	PRINTI " "
	PRINT FIRST-SIGHTING
	JUMP ?L11
?L9:	PRINTI """ Jamison "
?L11:	PRINTI "sighs. ""What an astonishing girl you are, my dear. "
	FSET? CHEMISE,EVERYBIT /?L12
	PRINTI "If --"""
	PRINT EYES-RAKE
	PRINTI ", ""somewhat underdressed"
	JUMP ?L15
?L12:	ZERO? BOY-DRESS? /?L14
	PRINTI "And so ingeniously dressed"
	JUMP ?L15
?L14:	PRINTI "And looking more lovely than ever"
?L15:	PRINTI "."" He plucks"
	CALL APRINT,FLOWER
	PRINTI " from the tangle above the door, and sets it in your hair. ""The beauty of this blossom is nothing to yours."""
	CRLF
	MOVE FLOWER,PROTAGONIST
	FCLEAR FLOWER,NDESCBIT
	FSET FLOWER,TAKEBIT
	JUMP ?L24
?L7:	EQUAL? REACTION,REACTION-NEGATIVE /?L17
	EQUAL? HERO-CTR,6 \?L16
?L17:	IN? HERO,HERE \?L16
	CALL DEQUEUE,I-HFOLLY
	SET 'QUESTIONER,0
	REMOVE HERO
	PRINTI "Jamison backs away from you, smiling wistfully"
	PRINTI "."
	PRINT HERO-LEAVES-FOLLY
	JUMP ?L24
?L16:	EQUAL? HERO-CTR,2 \?L18
	PRINTI "Catching his breath, Jamison pulls you against him, his hands circling your waist"
	IN? FLOWER,PROTAGONIST \?L19
	PRINTI ", crushing"
	CALL TPRINT,FLOWER
	PRINTI " between you"
?L19:	PRINTI ". ""Darling,"" he whispers, leaning over you, ""oh, my angel ..."""
	CRLF
	JUMP ?L24
?L18:	EQUAL? HERO-CTR,3 \?L22
	SET 'AWAITING-REPLY,15
	CALL QUEUE,I-REPLY,2
	PRINTI """My lovely,"" Jamison says huskily. His eyes burn intently, their blue like the sea on a summer day. A shiver of warmth flows through you, and you tremble at his touch. The pirate's hands, warm and exciting, caress you, searing through the thin linen of your chemise. His lips near yours, his breath softly scented. ""May I kiss you?"""
	CRLF
	JUMP ?L24
?L22:	EQUAL? HERO-CTR,4 \?L23
	PRINTI "Tender is his kiss, soft his lips as his body presses hard against you. You drown in the tide of your passion, swept like the sea against the rocks of the shore."
	CRLF
	CALL PRINT-ID,STR?263
	JUMP ?L24
?L23:	EQUAL? HERO-CTR,5 \?L24
	REMOVE HERO
	PRINTI "With a pent-up sigh, Nicholas forces himself away from you. ""Now is not the time or the place to advance my suit,"" he says, wistfully. ""But the night is still young and you are so beautiful! I must be gone, lest I lose my soul in you."""
	PRINT HERO-LEAVES-FOLLY
?L24:	INC 'HERO-CTR
	RETURN HERO-CTR

	.FUNCT HERO-TALKS
	PRINT INDENT
	RANDOM 100 >STACK
	LESS? 65,STACK /?L1
	LESS? WHAT-HERO-SAYS,3 \?L1
	ZERO? WHAT-HERO-SAYS \?L3
	ZERO? HDAD-SPEECH /?L3
	CALL PICK-ONE,MANNERISMS >STACK
	PRINT STACK
	PRINT PCR
	RTRUE
?L3:	GET HERO-SPEECHES,WHAT-HERO-SAYS >STACK
	PRINT STACK
	PRINT PCR
	INC 'WHAT-HERO-SAYS
	RETURN WHAT-HERO-SAYS
?L1:	CALL PICK-ONE,MANNERISMS >STACK
	PRINT STACK
	PRINT PCR
	RTRUE

	.FUNCT RAPIER-F,OARG=0
	ZERO? OARG /?L1
	EQUAL? HERE,DUNGEON \FALSE
	EQUAL? OARG,M-DESC? /TRUE
	PRINT INDENT
	PRINTI "A rapier lies in the half-dark of a corner."
	RTRUE
?L1:	EQUAL? PRSA,V?TAKE \?L9
	FSET? HERO,DEADBIT /?L10
	IN? HERO,HERE \?L10
	PRINTI "Jamison prevents you, ""This is not a weapon for ladies."""
	CRLF
	CALL PRINT-ID,STR?264 >STACK
	RSTACK
?L10:	EQUAL? HERE,DUNGEON \?L12
	IN? CRULLEY,DUNGEON \?L12
	FSET? RAPIER,TOUCHBIT /?L12
	CALL ITAKE,0 >STACK
	EQUAL? STACK,M-FATAL,0 /?L12
	PRINTI "Taken. "
	PRINTD CRULLEY
	PRINTR " snorts, ""Be careful, you might hurt yer dearie."""
?L12:	IN? RAPIER,COOKIE \FALSE
	PRINTD COOKIE
	PRINTR " objects. ""It ain't fer a lady."""
?L9:	EQUAL? PRSA,V?PUT-THROUGH,V?PUT,V?THROW \?L15
	EQUAL? PRSI,TRAP /?L16
	EQUAL? PRSI,CRULLEY \?L15
	FSET? CRULLEY,MUNGBIT \?L15
?L16:	PRINTR "But you might need it later!"
?L15:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "Jamison's rapier is a dangerous looking sword with a narrow pointed blade"
	EQUAL? HERE,CABIN,DEUX-DECK /?L18
	PRINTI ". It is decorated with a big floppy ribbon"
?L18:	PRINT PCR
	RTRUE

	.FUNCT ISLAND-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	EQUAL? HERE,LIBRARY \?L3
	CALL PERFORM,V?EXAMINE,GLOBE >STACK
	RSTACK
?L3:	CALL INNER-DECK,HERE >STACK
	ZERO? STACK /?L5
	PRINT YOU-CANT
	PRINTI "see it from here"
	PRINT PCR
	RTRUE
?L5:	CALL SHIP-BOARD,HERE >STACK
	ZERO? STACK \?L8
	EQUAL? HERE,SHALLOWS,LAGOON,BY-SHIP /?L8
	EQUAL? HERE,ON-LADDER \?L6
?L8:	PRINTI "St. Sinistra is blessed with lush tropical beauty, jungle besieging the mansion atop the southern cliffs"
	PRINT PCR
	RTRUE
?L6:	CALL PERFORM,V?LOOK
	RTRUE

	.FUNCT BELOW-GROUND,RM
	EQUAL? RM,STAIRWELL,BOTTOM-STAIRS,ANTEROOM /TRUE
	EQUAL? RM,DUNGEON,PASSAGE-1,PASSAGE-2 /TRUE
	EQUAL? RM,PASSAGE-4 /TRUE
	EQUAL? RM,CELL-1,CELL-2,CELL-4 \FALSE
	RTRUE

	.FUNCT BEACH-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "This is a tiny beach, at the base of vine-covered cliffs. To the east,"
	FSET? SHIP,MUNGBIT \?L3
	PRINTI " across the debris-ridden lagoon, black reefs speckle the blue endless sea"
	JUMP ?L5
?L3:	CALL TPRINT,SHIP
	PRINTI " floats serenely on the lagoon"
?L5:	ZERO? ENDGAME /?L6
	PRINTI ". Halfway out to the ship is a skiff crowded with men; another skiff sits on the sand"
?L6:	PRINT PCR
	PRINT INDENT
	PRINTI "Immediately north of you, a rocky staircase is hewn into the cliff. "
	CALL RUNNING?,I-ENDGAME >STACK
	ZERO? STACK /TRUE
	PRINTI "A sizable number of dragoons huddle at the top."
	RTRUE
?L1:	EQUAL? RARG,M-END \?L12
	ZERO? ENDGAME /?L12
	FSET? STONE,TOUCHBIT /?L12
	CALL QUEUED?,I-ENDGAME >STACK
	ZERO? STACK /?L12
	MOVE STONE,BEACH
	FSET STONE,TOUCHBIT
	PRINT INDENT
	PRINTI "You splash into the rising surf and pain needles up your leg. Blood swirls out from your shoe in the shallow water, flowing over a small pointed stone"
	PRINT PCR
	CALL PRINT-ID,STR?265 >STACK
	RSTACK
?L12:	EQUAL? RARG,M-BEG \?L13
	EQUAL? PRSA,V?ENTER \?L13
	EQUAL? PRSO,SHALLOWS \?L13
	CALL DO-WALK,P?EAST
	RTRUE
?L13:	EQUAL? RARG,M-ENTER \FALSE
	IN? COOKIE,LAWN \FALSE
	PRINTR """I know 'e ain't down there!"" Cookie cries."

	.FUNCT BEACH-EXIT
	CALL RUNNING?,I-ENDGAME >STACK
	ZERO? STACK /?L1
	PRINTI "You would be safer aboard"
	CALL TRPRINT,SHIP
	RFALSE
?L1:	RETURN LAWN

	.FUNCT P-SKIFF-F
	EQUAL? HERE,BEACH \?L1
	CALL CTPRINT,SKIFF
	PRINTI " is out of reach. Wade into the shallows"
	PRINT PCR
	RTRUE
?L1:	EQUAL? HERE,ON-LADDER \FALSE
	ZERO? SKIFF-TIED \?L4
	PRINT YOU-CANT-SEE-ANY
	PRINTD SKIFF
	PRINTI " here."
	CRLF
	RETURN 8
?L4:	EQUAL? PRSA,V?BOARD,V?ENTER \FALSE
	CALL DO-WALK,P?DOWN >STACK
	RSTACK

	.FUNCT LAWN-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "Jungle looms around this clipped lawn, a path meandering westward into the dense undergrowth. To the east is a folly entangled in blooming jasmine. The way to the beach is obscure, but visible to the southeast. Behind the folly a thorny hedge blocks the cliff view of the sea."
	ZERO? ENDGAME \TRUE
	CRLF
	PRINT INDENT
	PRINTI "Music and voices float from the veranda to the north."
	RTRUE
?L1:	EQUAL? RARG,M-END \FALSE
	FSET? HERE,ACTORBIT /?L7
	FSET HERE,ACTORBIT
	PRINT INDENT
	PRINTR "Two men stand whispering in the shadows. You catch an occasional word, ""Davis dead... girl... Falcon on Sinistra."" The men separate, the well-dressed one going into the ballroom as the other slinks into the bushes. You see his face. Crulley!"
?L7:	ZERO? COOKIE-LOOKING /TRUE
	CALL I-COOKIE,1 >STACK
	RSTACK

	.FUNCT GEN-FLOWER
	EQUAL? HERE,FOLLY \FALSE
	RETURN FLOWER

	.FUNCT FLOWER-F
	EQUAL? PRSA,V?PICK,V?TAKE \?L1
	FSET? FLOWER,TAKEBIT /?L1
	PRINTI "You can't bear to pick"
	CALL TRPRINT,FLOWER
	RTRUE
?L1:	EQUAL? PRSA,V?SMELL \FALSE
	PRINTI "Ah, jasmine! Mama grew this in her garden"
	PRINT PCR
	RTRUE

	.FUNCT FOLLY-F,RARG
	EQUAL? RARG,M-ENTER \FALSE
	FSET? FOLLY,TOUCHBIT /FALSE
	FSET? LAFS-ROOM,TOUCHBIT /FALSE
	IN? DAD,CELL-4 \FALSE
	SET 'HERO-CTR,1
	CALL QUEUE,I-HFOLLY,2 >STACK
	RSTACK

	.FUNCT FOLLY-OBJ-F
	EQUAL? PRSA,V?ENTER \?L1
	EQUAL? HERE,IN-HEDGE \?L3
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L3:	EQUAL? HERE,LAWN \?L5
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L5:	PRINT LOOK-AROUND
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	EQUAL? HERE,IN-HEDGE \?L8
	CALL CTPRINT,FOLLY-OBJECT
	PRINTI " is invisible beyond the leaves to the west"
	PRINT PCR
	RTRUE
?L8:	EQUAL? HERE,FOLLY \?L10
	CALL V-LOOK
	RTRUE
?L10:	CALL CTPRINT,FOLLY-OBJECT
	PRINTI " is obscured by tangled vines"
	PRINT PCR
	RTRUE

	.FUNCT SLAT-F
	EQUAL? PRSA,V?TAKE \?L1
	ZERO? SLAT-OPEN \?L1
	PRINTI "Only the bottom of the slat is loose. The rest is tightly woven into the frame of the folly"
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?REMOVE,V?UNTIE \?L3
	CALL IMPOSSIBLES >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?PUSH,V?FIDDLE,V?MOVE \?L4
	ZERO? SLAT-OPEN /?L5
	PRINT YOU-HAVE-ALREADY
	PRINTR " done that."
?L5:	SET 'SLAT-OPEN,1
	FCLEAR HOLE,INVISIBLE
	FSET SLAT,NDESCBIT
	PRINTI "You twist aside the "
	PRINTD SLAT
	PRINTI ", wedging the end into the woven wall. The remaining hole, just above the bench, looks big enough to snake "
	PRINTD ME
	PRINTI " through"
	PRINT PCR
	RTRUE
?L4:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "The bamboo slat at the back of the folly "
	FSET? SLAT,NDESCBIT \?L9
	PRINTI "has been pulled aside, making a hole in the wall"
	PRINT PCR
	RTRUE
?L9:	PRINTI "appears to be loose"
	PRINT PCR
	RTRUE

	.FUNCT HOLE-F
	EQUAL? PRSA,V?ENTER \?L1
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?PUT,V?PUT-THROUGH,V?THROW \?L3
	EQUAL? PRSO,HANDS \?L4
	PRINT HUH
	RTRUE
?L4:	EQUAL? PRSO,RETICULE /FALSE
	CALL PRONOUN
	PRINTI " fall"
	FSET? PRSO,PLURALBIT /?L8
	PRINTI "s"
?L8:	PRINTI " through the hole"
	MOVE PRSO,IN-HEDGE
	PRINT PCR
	RTRUE
?L3:	EQUAL? PRSA,V?LOOK-INSIDE \FALSE
	PRINT YOU-SEE
	PRINTI " a few leaves near to you, more fading into green obscurity"
	PRINT PCR
	RTRUE

	.FUNCT FOLLY-EXIT
	ZERO? SLAT-OPEN /?L1
	FSET? GOWN,WORNBIT \?L3
	PRINTI "You might rip"
	CALL TRPRINT,GOWN
	RFALSE
?L3:	RETURN IN-HEDGE
?L1:	PRINT CANT-GO
	RFALSE

	.FUNCT BY-HOUSE-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You crouch in"
	CALL TPRINT,HEDGE
	PRINTI " by the house, twigs poking into you, the cliff crumbling away to the east. "
	CALL CTPRINT,HEDGE
	PRINTI " seems less dense to the south. A"
	CALL PRINT-ID,STR?266
	CALL TELL-OPEN$002fCLOSED,LIB-WINDOW,1
	PRINTI " window is directly west of you."
	RTRUE

	.FUNCT VERANDA-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "Steps lead south from this white marble veranda to a clipped lawn. To the north"
	CALL QUEUED?,I-ENDGAME >STACK
	ZERO? STACK /?L3
	PRINTI " the wreckage left by the duel is visible in the ballroom."
	RTRUE
?L3:	FSET? VER-DOOR,OPENBIT /?L5
	PRINTI ", beyond a closed glass door,"
?L5:	ZERO? ENDGAME /?L7
	PRINTI " is"
	JUMP ?L9
?L7:	PRINTI " a line of people blocks your view of"
?L9:	PRINTI " the ballroom."
	RTRUE
?L1:	EQUAL? RARG,M-END \FALSE
	ZERO? COOKIE-LOOKING /FALSE
	CALL I-COOKIE,1 >STACK
	RSTACK

	.FUNCT AROUND-HOUSE
	PRINTI "The gravel path is just wide enough for a cart to pass. It bends around the west wing of the house, leading you to"
	PRINT ELLIPSIS
	EQUAL? HERE,MAIN-ENTRANCE \?L1
	RETURN TRADE-ENTRANCE
?L1:	RETURN MAIN-ENTRANCE

	.FUNCT FOREST-F,RARG
	EQUAL? RARG,M-END \FALSE
	FSET? FOREST,EVERYBIT \FALSE
	CALL DEQUEUE,I-CATCH-KISS
	FCLEAR FOREST,EVERYBIT
	PRINT INDENT
	PRINTI "Two whispered voices come from the path ahead, one reassuring, the other desperate -- they sound like"
	CALL TPRINT,DAD
	PRINTR " and Lucy. Peering over a bush, you see the couple share a fond embrace before they meander off into the jungle."

	.FUNCT CLEARING-F,RARG
	EQUAL? RARG,M-BEG \FALSE
	EQUAL? PRSO,WINDOW /?L3
	EQUAL? PRSI,WINDOW \FALSE
?L3:	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L4
	PRINT YOU-SEE
	PRINTR " only an embossed ceiling."
?L4:	EQUAL? PRSA,V?ENTER \?L6
	CALL DO-WALK,P?UP
	RTRUE
?L6:	CALL CANT-REACH,WINDOW >STACK
	RSTACK

	.FUNCT VINE-F
	EQUAL? HERE,BEACH \?L1
	EQUAL? PRSA,V?EXAMINE /?L1
	CALL CANT-REACH,VINE >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?TAKE \?L3
	PRINTI "You tug, but are unable to get any substantial length of vine"
	PRINT PCR
	RTRUE
?L3:	EQUAL? PRSA,V?CLIMB \?L4
	EQUAL? HERE,CLEARING \?L4
	CALL DO-WALK,P?UP
	RTRUE
?L4:	EQUAL? PRSA,V?CLIMB-DOWN,V?CLIMB \FALSE
	EQUAL? HERE,BEDROOM \FALSE
	CALL DO-WALK,P?DOWN
	RTRUE

	.FUNCT KITCHEN-F,RARG
	EQUAL? RARG,M-END \FALSE
	IN? LUCY,KITCHEN \FALSE
	ZERO? BOY-DRESS? /?L3
	FSET? LUCY,TOUCHBIT /FALSE
	FSET LUCY,TOUCHBIT
	CALL QUEUE,I-LUCY,2
	PRINT INDENT
	PRINTR "The woman smiles uncertainly, then rushes over. ""Are you come from the village, boy? Dost know Lord Dimsford?"" She sighs at your surprise. ""So he sent you -- I am his Lucy. It's been so long since I've seen him. Lafond caught me eavesdropping and now I can't leave the grounds."""
?L3:	FSET? GOWN,WORNBIT \?L8
	PRINT INDENT
	PRINTI """Milady,"" exclaims the woman. ""Lafond's guests are wisest not to stray. Maybe you should stay at the ball."" You find "
	PRINTD ME
	PRINTI " ushered into a hallway"
	PRINT PCR
	CRLF
	CALL GOTO,HALL-W >STACK
	RSTACK
?L8:	PRINT INDENT
	PRINTI "The woman shrieks, pushing you out the door. ""Has not the governor made clear his position on light-skirts? Out, slattern, before I report you!"" Her voice drops to a whisper, ""Sorry, but it's not safe around here. Stay in the village."" You find yourself outside"
	PRINT PCR
	CRLF
	CALL GOTO,TRADE-ENTRANCE >STACK
	RSTACK

	.FUNCT KITCHEN-EXIT
	CALL META-LOC,GARTER >STACK
	EQUAL? STACK,HERE \?L1
	CALL HELD?,GARTER >STACK
	ZERO? STACK \?L1
	IN? LUCY,HERE \?L4
	IN? DAD,HERE /?L1
	REMOVE GARTER
	CALL DEQUEUE,I-LUCY
	PRINTI "Lucy spits at you, ""Yes, desert a helpless woman. Tell Lafond I'm a spy. Dimsford will avenge me, runt!"" She comes after you with a rolling pin, pushing you out the door"
	PRINT PCR
	CRLF
	CALL PRINT-ID,STR?267
	RETURN TRADE-ENTRANCE
?L1:	IN? LUCY,HERE \?L4
	IN? DAD,HERE /?L4
	FSET? GARTER,TOUCHBIT \?L4
	PRINTI """Don't forget -- tell Dimsford,"""
	CALL TPRINT,LUCY
	PRINT CALLS-AFTER
?L4:	EQUAL? P-WALK-DIR,P?SOUTH \?L7
	RETURN HALL-W
?L7:	RETURN TRADE-ENTRANCE

	.FUNCT BALLROOM-ENTRANCE
	EQUAL? HERE,VERANDA \?L1
	FSET? VER-DOOR,OPENBIT /?L1
	CALL CTPRINT,DOOR
	PRINT IS-CLOSED
	PRINT PCR
	RFALSE
?L1:	ZERO? ENDGAME /?L3
	CALL RUNNING?,I-DUEL >STACK
	ZERO? STACK /?L4
	PRINT YOU-CANT
	PRINTI "force "
	PRINTD ME
	PRINTI " between the amazed spectators of the duel"
	PRINT PCR
	RFALSE
?L4:	RETURN BALLROOM
?L3:	FSET? GOWN,WORNBIT /?L7
	PRINTI "Though you glimpse whirling bodies beyond, the spectators fail to admit such a "
	ZERO? BOY-DRESS? /?L8
	PRINTI "grubby youth"
	JUMP ?L10
?L8:	PRINTI "poorly dressed female"
?L10:	PRINTI ".
"
	RFALSE
?L7:	PRINTI "The sea of spectators parts to admit you, murmuring approval"
	PRINT PCR
	CRLF
	RETURN BALLROOM

	.FUNCT FOYER-F,RARG
	EQUAL? RARG,M-END \?L1
	FSET? BUTLER,DEADBIT /?L3
	IN? BUTLER,HERE \?L3
	FSET? GOWN,WORNBIT \?L5
	FSET? FOYER,EVERYBIT \?L7
	FCLEAR FOYER,EVERYBIT
	REMOVE BUTLER
	PRINT INDENT
	PRINTI """Miss, the master has been expecting you, up in his room. I did look for you."" "
	CALL CTPRINT,BUTLER
	PRINTR " bows and leaves."
?L7:	FSET? BUTLER,MUNGBIT \FALSE
	PRINT INDENT
	PRINTI """"
	PRINT NO-LOITERING
	PRINT PUSHING-YOU-OUT
	CRLF
	CALL GOTO,MAIN-ENTRANCE >STACK
	RSTACK
?L5:	ZERO? BOY-DRESS? /?L11
	CALL KICKED-OUT >STACK
	RSTACK
?L11:	PRINT INDENT
	PRINTI """You may not ply your wares here, Paphian. Leave before I have you thrown off the cliff!"" You contemplate this pleasant prospect as you are tossed onto the gravel drive."
	CRLF
	CRLF
	CALL PRINT-ID,STR?268
	CALL GOTO,MAIN-ENTRANCE >STACK
	RSTACK
?L3:	ZERO? COOKIE-LOOKING /TRUE
	CALL I-COOKIE,1 >STACK
	RSTACK
?L1:	EQUAL? RARG,M-ENTER \FALSE
	FSET? BUTLER,DEADBIT /FALSE
	FSET? BUTLER,INDOORSBIT /FALSE
	CALL QUEUE,I-BUTLER,3 >STACK
	RSTACK

	.FUNCT FOYER-EXIT
	FSET? BUTLER,INDOORSBIT \?L1
	EQUAL? P-WALK-DIR,P?SOUTH \?L3
	CALL BALLROOM-ENTRANCE >STACK
	RSTACK
?L3:	EQUAL? P-WALK-DIR,P?WEST \?L5
	RETURN HALL-W
?L5:	EQUAL? P-WALK-DIR,P?UP \?L6
	RETURN STAIRTOP
?L6:	EQUAL? P-WALK-DIR,P?EAST,P?UP \FALSE
	IN? BUTLER,HERE \?L8
	PRINTI """No, ma'am, that way's private."" The butler stops you"
	PRINT PCR
	RFALSE
?L8:	RETURN HALL-E
?L1:	CALL RUNNING?,I-BUTLER >STACK
	ZERO? STACK /?L12
	CALL QUEUE,I-BUTLER,2
	PRINTI """Excuse me!"" The "
	PRINTD BUTLER
	PRINTI " pushes you back. ""Your invitation, please!"""
	CRLF
	CALL PRINT-ID,STR?269
	RFALSE
?L12:	CALL QUEUE,I-BUTLER,2
	SET 'AWAITING-FAKE-ORPHAN,1
	PRINTI "The butler prevents you. ""Miss... your invitation?"""
	CRLF
	RFALSE

	.FUNCT BALLROOM-F,RARG=0
	EQUAL? RARG,M-LOOK \?L1
	ZERO? ENDGAME /?L3
	CALL QUEUED?,I-ENDGAME >STACK
	ZERO? STACK /?L5
	CALL CTPRINT,DANCERS
	PRINTI "s stare amazed at Lafond's limp body, some disbelieving, some hopeful, all stock still. The pirates have fled to the darkness of the lawn"
	JUMP ?L8
?L5:	PRINTI "All is chaos, screaming women fainting on terrified men. Several of Jamison's scruffiest men round the dancers into a huddle in the center of"
	PRINT DANCE-FLOOR
	JUMP ?L8
?L3:	PRINTI "Lafond's party is well attended: you can hardly move for the crush. However, the room is oddly silent, no talk interrupting the musical efforts of"
	CALL TPRINT,MUSICIANS
	PRINTI " to the west. Despite the heat, no one ventures south to the veranda, nor through the opening east. The foyer is north of you"
?L8:	PRINTI "."
	RTRUE
?L1:	EQUAL? RARG,M-ENTER \?L9
	FSET? HERE,TOUCHBIT /?L10
	SET 'HERO-CTR,1
	CALL QUEUE,I-HDANCE,-1 >STACK
	RSTACK
?L10:	ZERO? PARTNER \FALSE
	EQUAL? DANCED-WITH,HERO \FALSE
	ZERO? ENDGAME \FALSE
	SET 'LAFOND-CTR,1
	CALL QUEUE,I-LDANCE,1
	RFALSE
?L9:	EQUAL? RARG,M-BEG \?L14
	EQUAL? CREW,PRSO,PRSI \?L15
	CALL NOUN-USED,W?MAN,CREW >STACK
	ZERO? STACK \?L15
	EQUAL? PRSA,V?ASK-ABOUT /?L15
	EQUAL? PRSO,LAFOND,HERO /?L15
	FSET? BALLROOM,EVERYBIT /?L15
	PRINT YOU-CANT-SEE-ANY
	PRINTI "of Jamison's crew here"
	PRINT PCR
	CALL STOP >STACK
	RSTACK
?L15:	EQUAL? PRSA,V?ASK-FOR \?L17
	IN? PRSO,HERE \?L17
	EQUAL? PRSI,BALLROOM \?L17
	CALL PERFORM,V?DANCE,PRSO
	RTRUE
?L17:	EQUAL? PRSA,V?PUT \?L18
	EQUAL? PRSI,BALLROOM \?L18
	CALL PERFORM,V?DROP,PRSO
	RTRUE
?L18:	EQUAL? PARTNER,HERO,LAFOND \FALSE
	CALL TOUCHING?,VER-DOOR >STACK
	ZERO? STACK /FALSE
	PRINTD PARTNER
	PRINTR " sweeps you past."
?L14:	EQUAL? RARG,M-END \FALSE
	ZERO? COOKIE-LOOKING /FALSE
	CALL I-COOKIE,1 >STACK
	RSTACK

	.FUNCT BALLROOM-EXIT
	EQUAL? PARTNER,HERO \?L1
	PRINTI """Would you rather not dance? "
	EQUAL? P-WALK-DIR,P?SOUTH \?L3
	PRINTI "Apparently the guests have orders not to go outside."" Instead"
	CALL TPRINT,HERO
	PRINTI " whirls and twirls you towards"
	CALL TRPRINT,MUSICIANS
	CRLF
	RETURN ORCHESTRA
?L3:	EQUAL? P-WALK-DIR,P?EAST \?L5
	PRINTI "Hungry?"" He guides you into the supper room, then tsks in dismay. ""They've cleared the food away already!"""
	CRLF
	CRLF
	RETURN SUPPER-ROOM
?L5:	EQUAL? P-WALK-DIR,P?WEST \?L6
	PRINTI "Let's listen to the music while we talk."" He walks you towards"
	CALL TRPRINT,MUSICIANS
	CRLF
	RETURN ORCHESTRA
?L6:	PRINTI "It wouldn't be wise to put ourselves into the butler's sight, though."" He escorts you into the supper-room instead"
	PRINT PCR
	CRLF
	RETURN SUPPER-ROOM
?L1:	CALL QUEUED?,I-CKILLS-DAD >STACK
	ZERO? STACK /?L8
	PRINTD LAFOND
	PRINTI " stops you. ""Stay until we hear the sad news."""
	CRLF
	RFALSE
?L8:	EQUAL? LAFOND,PARTNER \?L9
	PRINTI """How dare you walk away!"" Lafond grips your arm, so you may not leave the floor"
	PRINT PCR
	RFALSE
?L9:	CALL RUNNING?,I-LDANCE >STACK
	ZERO? STACK /?L10
	LOC LAFOND >STACK
	EQUAL? STACK,HERE \?L10
	SET 'QUESTIONER,LAFOND
	PRINTI """Your answer, cherie?"" His twists your wrist mercilessly"
	PRINT PCR
	CALL PRINT-ID,STR?270
	RFALSE
?L10:	EQUAL? P-WALK-DIR,P?NORTH \?L12
	RETURN FOYER
?L12:	EQUAL? P-WALK-DIR,P?SOUTH \?L14
	FSET? VER-DOOR,OPENBIT \?L15
	RETURN VERANDA
?L15:	CALL CTPRINT,DOOR
	PRINT IS-CLOSED
	PRINT PCR
	RFALSE
?L14:	EQUAL? P-WALK-DIR,P?WEST \?L18
	RETURN ORCHESTRA
?L18:	EQUAL? P-WALK-DIR,P?EAST \FALSE
	RETURN SUPPER-ROOM

	.FUNCT MUSICIANS-F
	EQUAL? PRSA,V?LISTEN,V?EXAMINE \?L1
	ZERO? ENDGAME /?L3
	PRINTI "The musicians are with"
	CALL TPRINT,DANCERS
	PRINTR "s in the ballroom."
?L3:	PRINTR "The small band is made up of a virginal, bass and treble viols, and several recorders. They are playing ""I Want to Kiss Your Hand,"" by J.S. Beatle."
?L1:	CALL UNIMPORTANT-THING
	CALL STOP >STACK
	RSTACK

	.FUNCT ORCHESTRA-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	ZERO? ENDGAME /?L3
	CALL QUEUED?,I-ENDGAME >STACK
	ZERO? STACK \?L3
	PRINTI "This end of the ballroom is empty of people."
	RTRUE
?L3:	PRINTI "A few older women and young girls sit near the small orchestra assembled at this end of the ballroom."
	RTRUE
?L1:	EQUAL? RARG,M-END \FALSE
	ZERO? COOKIE-LOOKING /FALSE
	CALL I-COOKIE,1 >STACK
	RSTACK

	.FUNCT SUPPER-ROOM-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	MOVE LONG-TABLE,HERE
	RTRUE
?L1:	EQUAL? RARG,M-END \FALSE
	ZERO? COOKIE-LOOKING /FALSE
	CALL I-COOKIE,1 >STACK
	RSTACK

	.FUNCT UNDER-TABLE
	PRINTI "You scuttle underneath"
	CALL TRPRINT,LONG-TABLE
	CRLF
	EQUAL? HERE,HALL-E \?L1
	RETURN SUPPER-ROOM
?L1:	RETURN HALL-E

	.FUNCT HALL-E-F,RARG
	EQUAL? RARG,M-END \?L1
	FSET? BUTLER,DEADBIT /?L1
	IN? BUTLER,FOYER \?L1
	FSET? GOWN,WORNBIT /?L3
	CALL KICKED-OUT >STACK
	RSTACK
?L3:	FSET? BUTLER,INDOORSBIT /FALSE
	PRINT INDENT
	PRINTI "A "
	PRINTD BUTLER
	PRINTI " takes your arm, pulling you into the foyer. ""I have not seen your "
	PRINTD INVITE
	PRINTI ", Miss."""
	CRLF
	CRLF
	CALL GOTO,FOYER >STACK
	RSTACK
?L1:	EQUAL? RARG,M-ENTER \FALSE
	MOVE LONG-TABLE,HALL-E
	RTRUE

	.FUNCT LIBRARY-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "Everything in this private office is larger than life. A huge "
	PRINTD PORTRAIT
	FSET? PORTRAIT,OPENBIT \?L3
	PRINTI ", slightly awry from the wall,"
?L3:	PRINTI " decorates the north side, and black drapes mask the east wall. Bookshelves tower over a cherry desk, and a massive wooden globe squats in a corner."
	ZERO? ENDGAME \?L6
	PRINTI " Music wafts distantly from the ballroom across the hall to the south."
?L6:	FSET? KNOB,DEADBIT /TRUE
	CRLF
	PRINT INDENT
	PRINTI "A knob juts out of the wall."
	RTRUE
?L1:	EQUAL? RARG,M-ENTER \?L12
	IN? COOKIE,HERE \?L12
	FSET? COOKIE,EVERYBIT /?L12
	FSET COOKIE,EVERYBIT
	PRINT SURPRISE
	PRINTD COOKIE
	PRINTI " is here, studying the walls. ""Cap'n said somethin' about a secret door, mebbe."""
	CRLF
	CRLF
	RTRUE
?L12:	EQUAL? RARG,M-END \FALSE
	IN? DAD,HERE \?L14
	EQUAL? DANCED-WITH,LAFOND \?L16
	ZERO? HERO-ARRESTED \?L16
	CALL QUEUE,I-HARRESTED,2
?L16:	CALL QUEUE,I-CATCH-KISS,25
	FSET FOREST,EVERYBIT
	FSET LIB-WINDOW,OPENBIT
	SET 'SLAT-OPEN,1
	FCLEAR HOLE,INVISIBLE
	FSET SLAT,NDESCBIT
	REMOVE DAD
	REMOVE LUCY
	PRINT INDENT
	PRINTI """A "
	PRINTD WINDOW
	PRINTI "!"" your father exclaims. ""I shall creep out to the kitchen. Get the Falcon."" He climbs out"
	CALL TRPRINT,WINDOW
	RTRUE
?L14:	IN? COOKIE,HERE \FALSE
	CALL RUNNING?,I-DUEL >STACK
	ZERO? STACK /FALSE
	MOVE COOKIE,GALLERY
	REMOVE CREW
	PRINT INDENT
	PRINTD COOKIE
	PRINTI " cocks his head. ""What is that noise? Is Cap'n duelling Lafond? There's no chance he could win as beaten as he is!"" Cookie races out towards the ballroom"
	PRINT PCR
	RTRUE

	.FUNCT PORTRAIT-EXIT
	FSET? PORTRAIT,MUNGBIT /?L1
	PRINT CANT-GO
	RFALSE
?L1:	FSET? PORTRAIT,OPENBIT /?L3
	CALL CTPRINT,PORTRAIT
	PRINT IS-CLOSED
	PRINT PCR
	RFALSE
?L3:	CALL HELD?,HAT >STACK
	ZERO? STACK /?L5
	CALL SAFETY-SAKE
	PRINT INDENT
?L5:	PRINTI "You move beyond"
	CALL TPRINT,PORTRAIT
	PRINTI " into the "
	EQUAL? HERE,STAIRWELL \?L8
	PRINTI "library"
	PRINT PCR
	CRLF
	RETURN LIBRARY
?L8:	EQUAL? HERE,LIBRARY \FALSE
	PRINTI "flickering torchlight"
	PRINT PCR
	CRLF
	RETURN STAIRWELL

	.FUNCT DRAPES-F
	EQUAL? PRSA,V?LOOK-BEHIND \?L1
	EQUAL? HERE,LAFS-ROOM \?L3
	PRINT THERES-NOTHING
	PRINTI "interesting behind"
	CALL TRPRINT,DRAPES
	RTRUE
?L3:	PRINTI "In the dark behind"
	CALL TPRINT,DRAPES
	PRINTI " is"
	CALL ARPRINT,WINDOW
	RTRUE
?L1:	EQUAL? PRSA,V?MOVE,V?PUSH,V?OPEN \?L6
	PRINT PULL-FABRIC
	CRLF
	RTRUE
?L6:	EQUAL? PRSA,V?CLOSE \?L7
	EQUAL? HERE,LIBRARY \?L8
	PRINT ALREADY-ARE
	RTRUE
?L8:	PRINT BEAUTIFUL-NIGHT
	RTRUE
?L7:	EQUAL? PRSA,V?EXAMINE \FALSE
	EQUAL? HERE,LIBRARY \?L12
	PRINTI "Dark drapes cover an entire wall of the room"
	PRINT PCR
	RTRUE
?L12:	PRINTI "The purple hangings are densely embroidered with gold"
	PRINT PCR
	RTRUE

	.FUNCT TORCH-F
	EQUAL? PRSA,V?EXAMINE \?L1
	CALL CTPRINT,TORCH
	PRINTR " is flickering madly in the breeze."
?L1:	EQUAL? PRSA,V?PUT-ON,V?PUT \?L3
	FSET? PRSI,BURNBIT \?L3
	PRINTI "Mama disapproved of pyromaniacs."
	CRLF
	CALL PRINT-ID,STR?271 >STACK
	RSTACK
?L3:	CALL TOUCHING?,TORCH >STACK
	ZERO? STACK /FALSE
	PRINT YOU-CANT
	PRINTI "reach"
	CALL TPRINT,TORCH
	PRINTR ". Ladies don't carry them anyway."

	.FUNCT PORTRAIT-F
	EQUAL? PRSA,V?EXAMINE \?L1
	EQUAL? HERE,LIBRARY \?L3
	FSET? PORTRAIT,OPENBIT \?L5
	PRINTI "Cool air seeps out from"
	CALL TRPRINT,PORTRAIT
	RTRUE
?L5:	CALL CTPRINT,PORTRAIT
	PRINTI " seems familiar, and you realize it is exactly the picture on the front of"
	CALL TPRINT,BANKNOTE
	CALL TPRINT,LAFOND
	PRINTR " sent you, same clothes, same surroundings, same pose."
?L3:	PRINT YOU-SEE
	PRINT THE-BACK
	CALL TRPRINT,PORTRAIT
	RTRUE
?L1:	EQUAL? PRSA,V?LOOK-BEHIND \?L9
	FSET? PORTRAIT,OPENBIT \?L10
	CALL PERFORM,V?EXAMINE,PORTRAIT
	RTRUE
?L10:	CALL CTPRINT,PORTRAIT
	PRINTI " is firmly fastened to the wall"
	PRINT PCR
	RTRUE
?L9:	EQUAL? PRSA,V?WALK,V?HIDE,V?ENTER \?L13
	FSET? PORTRAIT,MUNGBIT /?L14
	PRINTI "This is a "
	PRINTD PORTRAIT
	PRINTI ", not a looking glass"
	PRINT PCR
	RTRUE
?L14:	CALL DO-WALK,P?IN >STACK
	RSTACK
?L13:	EQUAL? PRSA,V?OPEN \?L17
	FSET? PORTRAIT,OPENBIT \?L18
	PRINT ALREADY-IS
	RTRUE
?L18:	FSET? PORTRAIT,MUNGBIT \?L20
	FSET PORTRAIT,OPENBIT
	EQUAL? HERE,LIBRARY \?L21
	PRINTI "Quickly you pull the book, joggle"
	CALL TPRINT,KNOB
	PRINTI " and touch"
	CALL TPRINT,GLOBE
	PRINTI ", and"
	CALL TPRINT,PORTRAIT
	PRINTI " pops open."
	IN? COOKIE,HERE \?L23
	PRINT COOKIE-HARRUMPHS
?L23:	CRLF
	RTRUE
?L21:	PRINTI "You push outwards on the wall, opening"
	CALL TRPRINT,PORTRAIT
	RTRUE
?L20:	PRINTI "Open a "
	PRINTD PORTRAIT
	PRINTR "?!"
?L17:	EQUAL? PRSA,V?CLOSE \FALSE
	FSET? PORTRAIT,MUNGBIT /?L29
	PRINT HUH
	RTRUE
?L29:	FSET? PORTRAIT,OPENBIT \FALSE
	FCLEAR PORTRAIT,OPENBIT
	FCLEAR POWER,EVERYBIT
	FCLEAR KNOB,EVERYBIT
	CALL CTPRINT,PORTRAIT
	PRINTR " swings shut with a tiny snap."

	.FUNCT GLOBE-F
	EQUAL? PRSA,V?PUSH,V?TOUCH /?L3
	EQUAL? PRSA,V?PUT-ON \?L1
	EQUAL? PRSO,HANDS \?L1
?L3:	PRINTI "You press the "
	CALL NOUN-USED,W?SINISTRA,GLOBE >STACK
	ZERO? STACK \?L6
	CALL NOUN-USED,W?ISLAND,GLOBE >STACK
	ZERO? STACK \?L6
	CALL ADJ-USED,A?ST >STACK
	ZERO? STACK /?L4
?L6:	PRINTI "painted island, and it sinks into the wooden sea."
	FSET? KNOB,EVERYBIT \?L16
	FSET? POWER,EVERYBIT \?L16
	FSET? PORTRAIT,OPENBIT /?L16
	FSET PORTRAIT,OPENBIT
	FSET? PORTRAIT,MUNGBIT /?L9
	FSET PORTRAIT,MUNGBIT
	INC 'SCORE
?L9:	PRINTI " You hear a whirr and a click and"
	CALL TPRINT,PORTRAIT
	PRINTI " pops open. A draft of sea-scented air flows in from behind it."
	IN? COOKIE,HERE \?L16
	PRINT COOKIE-HARRUMPHS
	CRLF
	RTRUE
?L4:	PRINTI "globe at random."
?L16:	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?SET,V?TAKE \?L17
	CALL CTPRINT,GLOBE
	PRINTR " is solidly fastened to the floor."
?L17:	EQUAL? PRSA,V?FIND \?L18
	EQUAL? PRSI,GLOBE \?L18
	CALL NOUN-USED,W?SINISTRA,GLOBE >STACK
	ZERO? STACK \?L19
	CALL NOUN-USED,W?ISLAND,GLOBE >STACK
	ZERO? STACK \?L19
	CALL ADJ-USED,A?ST >STACK
	ZERO? STACK /?L18
?L19:	PRINTR "It is in the West Indies, surrounded by blue."
?L18:	EQUAL? PRSA,V?EXAMINE \FALSE
	CALL NOUN-USED,W?SINISTRA,GLOBE >STACK
	ZERO? STACK \?L23
	CALL NOUN-USED,W?ISLAND,GLOBE >STACK
	ZERO? STACK \?L23
	CALL ADJ-USED,A?ST >STACK
	ZERO? STACK /?L21
?L23:	PRINTI "A tiny replica of "
	PRINTD ISLAND
	PRINTI " is painted on"
	CALL TPRINT,GLOBE
	PRINTI " in greater detail than any other country, showing even the road from Santa Ananas to Lafond's mansion"
	PRINT PCR
	RTRUE
?L21:	PRINTI "The massive wooden globe, painted in greens and blues and white, describes the world as presently known"
	PRINT PCR
	RTRUE

	.FUNCT BOOKS-GLOBAL-F
	EQUAL? PRSA,V?TAKE,V?READ,V?LOOK-INSIDE /?L3
	EQUAL? PRSA,V?OPEN \?L1
?L3:	PRINTI "You pick one at random. You always preferred horses to reading, so you put it back"
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?SEARCH,V?EXAMINE \?L4
	PRINTI "Most of the books appear unread, their pages uncut, the spines not yet creased. All except one, ""Treatise of Power"" by Sir Michael Villiers"
	PRINT PCR
	RTRUE
?L4:	EQUAL? PRSA,V?PUSH,V?MOVE \FALSE
	PRINT HUH
	RTRUE

	.FUNCT BOOKCASE-F
	EQUAL? PRSA,V?SEARCH,V?LOOK-INSIDE,V?EXAMINE \?L1
	CALL PERFORM,V?EXAMINE,BOOKS-GLOBAL
	RTRUE
?L1:	EQUAL? PRSA,V?SET,V?PUSH,V?MOVE \?L3
	SET 'AWAITING-REPLY,3
	CALL QUEUE,I-REPLY,2
	PRINTI "Why tamper with a "
	PRINTD BOOKCASE
	PRINTR "? Searching for a secret door or some such?"
?L3:	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	CALL WASTES >STACK
	RSTACK

	.FUNCT POWER-F
	EQUAL? PRSA,V?OPEN,V?TAKE,V?READ /?L3
	EQUAL? PRSA,V?FIDDLE,V?MOVE \?L1
?L3:	PRINTI "You half tip"
	CALL TPRINT,POWER
	PRINTI " out of the shelf when it snaps surprisingly back into place"
	FSET? POWER,MUNGBIT /?L4
	FSET POWER,MUNGBIT
	INC 'SCORE
?L4:	FSET? POWER,EVERYBIT /?L7
	FSET POWER,EVERYBIT
	PRINTI ". There is a mysterious scraping sound from inside the wall"
?L7:	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "You gaze at ""Treatise of Power"" without taking it. It seems to be the only book that has been read in the library, the leather creased and dull with use."

	.FUNCT GENERIC-BOOK,X,Y
	EQUAL? HERE,LIBRARY \FALSE
	RETURN BOOKS-GLOBAL

	.FUNCT KNOB-F
	EQUAL? PRSA,V?SET,V?MOVE,V?PUSH /?L3
	EQUAL? PRSA,V?FIDDLE,V?LOWER \?L1
?L3:	FSET? KNOB,EVERYBIT \?L4
	CALL HACK-HACK,STR?136 >STACK
	RSTACK
?L4:	FSET KNOB,EVERYBIT
	CALL KNOB-CAUSES-TINGLE,STR?272 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?PUT,V?PUT-ON \?L7
	EQUAL? PRSO,HAT \?L7
	FSET? KNOB,DEADBIT \?L8
	PRINT ALREADY-IS
	RTRUE
?L8:	CALL HELD?,HAT >STACK
	ZERO? STACK \?L10
	PRINT YNH
	CALL TRPRINT,HAT
	RTRUE
?L10:	FSET HAT,EVERYBIT
	FSET KNOB,DEADBIT
	MOVE HAT,LIBRARY
	PRINTI "You prop"
	CALL TPRINT,HAT
	PRINTI " back on"
	CALL TRPRINT,KNOB
	RTRUE
?L7:	EQUAL? PRSA,V?EXAMINE \FALSE
	FSET? KNOB,DEADBIT \FALSE
	CALL CTPRINT,HAT
	PRINTI " is on"
	CALL TRPRINT,KNOB
	RTRUE

	.FUNCT STAIRTOP-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "The east-west hallway opens here to curve into a grand staircase sweeping down to the foyer."
	RTRUE

	.FUNCT DIVAN-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "Backless, upholstered in Oriental silk,"
	CALL TPRINT,DIVAN
	PRINTI " looks exotic and comfortable"
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?ENTER,V?CLIMB-ON,V?BOARD \?L3
	PRINTR "You haven't time to relax now."
?L3:	CALL UNIMPORTANT-THING >STACK
	RSTACK

	.FUNCT PAIR-F
	CALL TOUCHING?,PAIR >STACK
	ZERO? STACK /FALSE
	PRINT YOU-CANT
	PRINTI "reach them. Ladies don't carry "
	PRINTD PISTOL
	PRINTR "s, anyway."

	.FUNCT LAFS-ROOM-F,RARG,THING
	EQUAL? RARG,M-BEG \?L1
	ZERO? LAFOND-LOOKING /?L1
	GRTR? LAFOND-CTR,9 \?L3
	EQUAL? PRSO,SPICES,PINCH /?L3
	EQUAL? PRSA,V?WEAR,V?TAKE \?L3
	EQUAL? PRSA,V?WEAR,V?TAKE \TRUE
	PRINTD LAFOND
	PRINTI " stops you"
	PRINT PCR
	CALL PRINT-ID,STR?273
	RTRUE
?L3:	EQUAL? PRSI,LAUD,BOTTLE /?L9
	EQUAL? PRSO,LAUD,BOTTLE \?L8
?L9:	SET 'THING,BOTTLE
	JUMP ?L15
?L8:	EQUAL? PRSA,V?POINT,V?WAVE,V?PUT \FALSE
	EQUAL? MIRROR,PRSO,PRSI \?L11
	SET 'THING,MIRROR
	JUMP ?L15
?L11:	EQUAL? TRAY,PRSO,PRSI \FALSE
	SET 'THING,TRAY
?L15:	REMOVE THING
	PRINTI "Lafond bounds to your side, grabbing"
	CALL TPRINT,THING
	PRINTI " out of "
	PRINTD HANDS
	PRINTI " before you can use it. ""What have we here? Trying to "
	EQUAL? THING,BOTTLE \?L16
	PRINTI "poison "
	PRINTD ME
	PRINTI "? Or me?"
	JUMP ?L18
?L16:	EQUAL? THING,MIRROR,TRAY \?L18
	PRINTI "signal for help? You are beyond help."
?L18:	PRINTI """ He throws it out"
	CALL TRPRINT,SHUTTERS
	RTRUE
?L1:	EQUAL? RARG,M-ENTER \?L20
	FSET? LAFS-ROOM,TOUCHBIT /?L20
	FSET LAFS-ROOM,TOUCHBIT
	INC 'SCORE
	SET 'LAFOND-CTR,1
	CALL QUEUE,I-LSED,1
	PRINTI """Welcome, ma petite"
	FSET? GOWN,WORNBIT /?L21
	PRINTI " -- but where is your "
	PRINTD GOWN
	PRINTI "? Ah, chacun a son gout"
?L21:	PRINTI "."" Lafond bows you in"
	PRINT PCR
	CRLF
	RTRUE
?L20:	EQUAL? RARG,M-LOOK \FALSE
	PRINTD LAFOND
	PRINTI "'s bedroom shows all the outpourings of his megalomania. Royal hues of purple and gold weigh down the hangings on the bed and the eastward window, as if trying to smother the moonbeam shining in."
	RTRUE

	.FUNCT LAFS-EXIT
	ZERO? LAFOND-LOOKING /?L1
	PRINTI "Lafond whirls you around. ""My pretty, you came here freely, but you may not leave freely."""
	CRLF
	RFALSE
?L1:	IN? BUTLER,HERE \?L3
	FSET? BUTLER,DEADBIT /?L3
	CALL CTPRINT,BUTLER
	PRINTI " stops you easily"
	PRINT PCR
	RFALSE
?L3:	PRINTI "You "
	FSET? LDOOR,OPENBIT /?L5
	FSET LDOOR,OPENBIT
	PRINTI "open the door and "
?L5:	FSET? BUTLER,DEADBIT \?L8
	LOC LAFOND >STACK
	EQUAL? STACK,HERE /?L8
	PRINTI "creep over the prostrate butler"
	PRINT PCR
	CRLF
	RETURN UPPER-HALL-E
?L8:	PRINTI "run out -- into"
	CALL TPRINT,BUTLER
	PRINTI "'s barrel chest and leering grin. You return to the bedroom"
	IN? LAFOND,HERE \?L11
	PRINTI "."
	CALL TPRINT,LAFOND
	PRINTI " acts as if nothing has happened"
	PRINT PCR
	RFALSE
?L11:	MOVE BUTLER,LAFS-ROOM
	PRINTI ","
	CALL TPRINT,BUTLER
	PRINTI " following. ""The governor said you were not to leave this room."""
	CRLF
	RFALSE

	.FUNCT SHUTTERS-F
	EQUAL? PRSA,V?DISEMBARK,V?EXIT,V?ENTER /?L3
	EQUAL? PRSA,V?BOARD,V?LEAP-OFF \?L1
?L3:	PRINTI "One look at the sheer drop, from sill to hedge to jagged rocks far below, is enough to dissuade you."
	CRLF
	CALL PRINT-ID,STR?274 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \?L4
	PRINTI "The full moon is high in the night sky. Some distance out from the shallow curve of the island, "
	FSET? SHIP,MUNGBIT \?L5
	PRINTI "black reefs catch the full force of the sea"
	JUMP ?L7
?L5:	PRINTI "you see the slow swelling of sails, grey turning black turning grey, on"
	CALL TPRINT,SHIP
?L7:	PRINTR "."
?L4:	EQUAL? PRSA,V?EXAMINE \?L8
	PRINTI "Old fashioned wooden "
	PRINTD SHUTTERS
	PRINTI ", not glass, fill"
	CALL TPRINT,WINDOW
	PRINTI " frame. A dusty "
	PRINTD MOONBEAM
	PRINTI " swirls in, setting alight threads of gold embroidered in"
	CALL TRPRINT,DRAPES
	RTRUE
?L8:	EQUAL? PRSA,V?SPOINT \?L9
	EQUAL? PRSO,SHIP \?L9
	CALL PROPOSE >STACK
	RSTACK
?L9:	EQUAL? PRSA,V?CLOSE \?L10
	PRINT BEAUTIFUL-NIGHT
	RTRUE
?L10:	EQUAL? PRSA,V?PUT-THROUGH \FALSE
	EQUAL? PRSO,HANDS \?L12
	PRINT HUH
	RTRUE
?L12:	EQUAL? PRSO,GREEN-GLASS,BLUE-GLASS,FLAGON \?L14
	IN? LAFOND,HERE \?L14
	PRINTD LAFOND
	PRINTR " stops you."
?L14:	CALL PUT-OBJ-THRU-WINDOW >STACK
	RSTACK

	.FUNCT GEN-SPICES
	CALL HELD?,PINCH >STACK
	ZERO? STACK /?L1
	RETURN PINCH
?L1:	RETURN SPICES

	.FUNCT SPICES-F
	EQUAL? PRSA,V?TAKE \?L1
	IN? PINCH,PROTAGONIST \?L3
	PRINT YOU-HAVE-ALREADY
	CALL ARPRINT,PINCH
	RTRUE
?L3:	MOVE PINCH,PROTAGONIST
	FSET PINCH,TOUCHBIT
	SET 'HOLDING-PINCH,1
	CALL QUEUE,I-SPICE-DROP,3
	PRINTI "You take"
	CALL APRINT,PINCH
	PRINTI " between your thumb and forefinger"
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \?L6
	IN? PINCH,PROTAGONIST \?L7
	PRINTI "You are holding"
	CALL APRINT,PINCH
	PRINTI ". "
	CALL HELD?,TRAY,HERE >STACK
	ZERO? STACK /?L9
	LOC SPICES >STACK
	EQUAL? STACK,WELL \?L9
	PRINTI "More is in"
	CALL TPRINT,WELL
	PRINTI " of"
	CALL TRPRINT,TRAY
?L9:	CRLF
	RTRUE
?L7:	CALL PERFORM,V?EXAMINE,WELL
	RTRUE
?L6:	EQUAL? PRSA,V?EAT \?L13
	MOVE PINCH,SPICES
	PRINTI "Your eyes start to water"
	PRINT PCR
	CALL PRINT-ID,STR?275 >STACK
	RSTACK
?L13:	EQUAL? PRSA,V?SMELL \?L14
	MOVE PINCH,SPICES
	PRINTI "You take a sharp sniff of"
	CALL TPRINT,SPICES
	PRINTI " and sneeze, until "
	PRINTD EYES
	PRINTI " fill with tears"
	PRINT PCR
	CALL PRINT-ID,STR?276 >STACK
	RSTACK
?L14:	EQUAL? PRSA,V?THROW \?L15
	EQUAL? PRSI,0,SPICES /?L15
	CALL PERFORM,V?THROW-AT,PRSO,PRSI
	RTRUE
?L15:	EQUAL? PRSA,V?THROW-AT,V?PUT-ON,V?BLOW \FALSE
	IN? PINCH,PROTAGONIST \?L17
	EQUAL? PRSI,BUTLER \?L19
	FSET? BUTLER,DEADBIT /?L19
	PRINTI "You try to get close enough to"
	CALL TPRINT,BUTLER
	PRINTI ", but he backs off. ""That wouldn't be seemly, Miss."""
	CRLF
	CALL PRINT-ID,STR?277
	RTRUE
?L19:	EQUAL? PRSI,ME \?L21
	CALL PRINT-ID,STR?278
	CALL IMPOSSIBLES
	RTRUE
?L21:	EQUAL? PRSI,DAD,COOKIE,LUCY \?L22
	PRINT UNLADY
	CALL PRINT-ID,STR?279
	RTRUE
?L22:	EQUAL? PRSI,CRULLEY \?L23
	LOC CRULLEY >STACK
	EQUAL? STACK,DUNGEON \?L23
	PRINTD CRULLEY
	PRINTI " snaps the whip at your elbow. ""Keep away from me!"""
	CRLF
	CALL PRINT-ID,STR?280
	RTRUE
?L23:	PRINTI "You blow"
	CALL TPRINT,SPICES
	PRINTI " off your fingertips"
	MOVE PINCH,SPICES
	ZERO? PRSI /?L27
	FSET? PRSI,DEADBIT \?L25
?L27:	PRINT PCR
	RTRUE
?L25:	EQUAL? PRSI,LAFOND \?L28
	EQUAL? HERE,LAFS-ROOM \?L28
	INC 'SCORE
	MOVE PINCH,SPICES
	REMOVE LAFOND
	SET 'LAFOND-LOOKING,0
	CALL DEQUEUE,I-LSED
	CALL DEQUEUE,I-WONT-DRINK
	CALL QUEUE,I-LRETURNS,15
	FSET LDOOR,OPENBIT
	REMOVE LAF-GLASS
	PRINTI ", directly into Lafond's face. He sneezes, his eyes watering from the heat of the peppers. Reaching blindly for some wine, he instead upsets the table, shattering a glass. Lafond stumbles cursing out of the room, in search of relief"
	CALL PRINT-ID,STR?281
	GRTR? LAFOND-CTR,HORNY \?L29
	MOVE PROTAGONIST,HERE
	MOVE RETICULE,PROTAGONIST
	MOVE CHEMISE,PROTAGONIST
	FCLEAR CHEMISE,EVERYBIT
	FSET CHEMISE,WORNBIT
	MOVE SHOES,PROTAGONIST
	FSET SHOES,WORNBIT
	PRINTI ". You stand up, quickly pulling on"
	CALL TPRINT,CHEMISE
?L29:	PRINT PCR
	RTRUE
?L28:	PRINTI " at"
	CALL TPRINT-PRSI
	PRINTI ". "
	PRINT NOTHING-HAPPENS
	RTRUE
?L17:	PRINT YNH
	PRINTI " any "
	PRINTD SPICES
	PRINT PCR
	RTRUE

	.FUNCT I-LRETURNS
	EQUAL? HERE,UPPER-HALL-E,LAFS-ROOM /?L3
	FSET? SHIP,MUNGBIT \FALSE
?L3:	IN? COOKIE,HERE /FALSE
	CALL PRINT-ID,STR?282
	CALL JIGS-UP,STR?283 >STACK
	RSTACK

	.FUNCT I-SPICE-DROP
	IN? PINCH,PROTAGONIST \FALSE
	MOVE PINCH,SPICES
	PRINT INDENT
	PRINTI "The spices dribble out from between your fingers"
	PRINT PCR
	RTRUE

	.FUNCT TRAY-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "Cabbage leaves are etched onto the mirror-bright "
	PRINTD TRAY
	PRINTI ", forming a well in the center where the metallic stalks meet."
	LOC CHICKEN >STACK
	EQUAL? STACK,TRAY \?L3
	PRINTI " Some "
	PRINTD CHICKEN
	PRINTI " is heaped around the dry spices filling"
	CALL TRPRINT,WELL
	RTRUE
?L3:	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?POINT,V?PUT \?L6
	EQUAL? PRSI,MOONBEAM,SHUTTERS,SHIP \?L6
	CALL SIGNAL-SHIP,TRAY >STACK
	RSTACK
?L6:	EQUAL? PRSA,V?EMPTY \?L7
	PRINTI "You have no other way of carrying"
	CALL TRPRINT,CHICKEN
	RTRUE
?L7:	EQUAL? PRSA,V?PUT-ON,V?PUT \FALSE
	EQUAL? PRSI,TRAY \FALSE
	PRINTI "Because of the metal work, nothing sits flat on"
	CALL TRPRINT,TRAY
	RTRUE

	.FUNCT WELL-F
	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L1
	IN? SPICES,WELL \?L3
	CALL CTPRINT,WELL
	PRINTI " in"
	CALL TPRINT,TRAY
	PRINTI " is filled with a mixture of salt and other spices, predominantly red and black pepper"
	PRINT PCR
	RTRUE
?L3:	PRINTR "It is empty."
?L1:	EQUAL? PRSA,V?TAKE \FALSE
	CALL CTPRINT,WELL
	PRINTR " is part of the tray!"

	.FUNCT CHICKEN-F
	EQUAL? PRSA,V?TAKE,V?EAT \?L1
	PRINTI "You sprinkle some "
	PRINTD SPICES
	PRINTI " on a wing and nibble at it. The peppery heat hits you like a wave, leaving you gasping, eyes watering"
	PRINT PCR
	CALL PRINT-ID,STR?284 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L3
	IN? CHICKEN,TRAY \?L4
	CALL PERFORM,V?EXAMINE,TRAY
	RTRUE
?L4:	CALL CTPRINT,CHICKEN
	PRINTI " looks tasty"
	PRINT PCR
	RTRUE
?L3:	EQUAL? PRSA,V?PUT-ON \?L7
	EQUAL? PRSO,PINCH,SPICES \?L7
	CALL PERFORM,V?EAT,CHICKEN
	RTRUE
?L7:	EQUAL? PRSA,V?PUT \FALSE
	EQUAL? PRSO,CHICKEN \FALSE
	CALL PERFORM,V?EAT,CHICKEN
	RTRUE

	.FUNCT FLAGON-F
	EQUAL? PRSA,V?EXAMINE,V?LOOK-INSIDE,V?SHAKE \?L1
	PRINTR "Some wine sloshes around inside."
?L1:	EQUAL? PRSA,V?TAKE \?L3
	FSET? FLAGON,TRYTAKEBIT \?L3
	PRINTI "Lafond takes it from you, setting it on"
	CALL TRPRINT,TABLE
	RTRUE
?L3:	EQUAL? PRSA,V?DROP \?L4
	EQUAL? HERE,LAFS-ROOM \?L4
	MOVE FLAGON,TABLE
	PRINTI "You set"
	CALL TPRINT,FLAGON
	PRINTI " on"
	CALL TRPRINT,TABLE
	RTRUE
?L4:	EQUAL? PRSA,V?THROW,V?EMPTY \?L5
	EQUAL? HERE,LAFS-ROOM \?L5
	IN? LAFOND,HERE \?L5
	CALL PRINT-ID,STR?285
	CALL FWTD,SMACK-YOUR-FACE >STACK
	RSTACK
?L5:	EQUAL? PRSA,V?DRINK-FROM \FALSE
	PRINT UNLADY
	RTRUE

	.FUNCT WINE-F
	EQUAL? PRSA,V?GIVE,V?DRINK,V?EAT /?L3
	EQUAL? PRSA,V?SHOW \?L1
?L3:	CALL HELD?,BLUE-GLASS >STACK
	ZERO? STACK /?L4
	CALL IMBIBE-WINE,BLUE-GLASS >STACK
	RSTACK
?L4:	CALL HELD?,GREEN-GLASS >STACK
	ZERO? STACK /?L6
	CALL IMBIBE-WINE,GREEN-GLASS >STACK
	RSTACK
?L6:	PRINT YNH
	PRINTR " a goblet of wine!"
?L1:	EQUAL? PRSO,WINE \?L8
	EQUAL? PRSA,V?POUR \?L8
	ZERO? PRSI \?L9
	EQUAL? P-PRSA-WORD,W?SPILL \?L11
	EQUAL? HERE,LAFS-ROOM \?L11
	IN? LAFOND,HERE \?L11
	CALL PRINT-ID,STR?286
	CALL FWTD,SMACK-YOUR-FACE >STACK
	RSTACK
?L11:	CALL SPECIFY-WHAT,STR?162,PRSO >STACK
	RSTACK
?L9:	EQUAL? PRSI,FLAGON \?L14
	PRINTI "It's not sanitary to pour wine back into"
	CALL TRPRINT,FLAGON
	CALL PRINT-ID,STR?287 >STACK
	RSTACK
?L14:	EQUAL? PRSI,GREEN-GLASS,BLUE-GLASS \?L15
	GETP PRSI,P?CONTENTS >STACK
	EQUAL? STACK,WINED,W-P \?L16
	PRINTR "It is already full!"
?L16:	CALL POUR-WINE,PRSI >STACK
	RSTACK
?L15:	PRINT POLITE-SOCIETY
	CALL PRINT-ID,STR?288 >STACK
	RSTACK
?L8:	EQUAL? PRSA,V?WRING,V?POUR-FROM \?L20
	EQUAL? PRSO,WINE \?L20
	CALL SPECIFY-WHAT,STR?162,PRSO >STACK
	RSTACK
?L20:	EQUAL? PRSA,V?THROW,V?DROP \FALSE
	EQUAL? HERE,LAFS-ROOM \?L22
	IN? LAFOND,HERE \?L22
	CALL LAFS-DROP >STACK
	RSTACK
?L22:	CALL HELD?,BLUE-GLASS >STACK
	ZERO? STACK /?L24
	GETP BLUE-GLASS,P?CONTENTS >STACK
	GRTR? STACK,0 \?L24
	CALL PERFORM,V?DROP,BLUE-GLASS
	RTRUE
?L24:	CALL HELD?,GREEN-GLASS >STACK
	ZERO? STACK /?L25
	GETP GREEN-GLASS,P?CONTENTS >STACK
	GRTR? STACK,0 \?L25
	CALL PERFORM,V?DROP,GREEN-GLASS
	RTRUE
?L25:	PRINT YNH
	PRINTR " any wine!"

	.FUNCT IMBIBE-WINE,VESSEL
	GETP VESSEL,P?CONTENTS >STACK
	EQUAL? STACK,0,POISONED \?L1
	PRINTI "There is no wine in"
	CALL TRPRINT,VESSEL
	RTRUE
?L1:	EQUAL? PRSA,V?SHOW,V?GIVE \?L3
	CALL PERFORM,V?GIVE,VESSEL,PRSI
	RTRUE
?L3:	GETP VESSEL,P?CONTENTS >STACK
	EQUAL? STACK,W-P \?L4
	CALL QUEUED?,I-SLEEP >STACK
	ZERO? STACK \?L4
	CALL QUEUE,I-SLEEP,2
?L4:	SET 'REACTION,REACTION-POSITIVE
	PUTP VESSEL,P?CONTENTS,0
	PRINTI "You empty"
	CALL TPRINT,VESSEL
	PRINTI " of wine"
	PRINT PCR
	RTRUE

	.FUNCT POUR-WINE,VESSEL,LAFOND-POURS=0
	GETP FLAGON,P?CONTENTS >STACK
	EQUAL? STACK,POISONED \?L1
	PUTP VESSEL,P?CONTENTS,W-P
	JUMP ?L3
?L1:	GETP VESSEL,P?CONTENTS >STACK
	INC 'STACK
	PUTP VESSEL,P?CONTENTS,STACK
?L3:	ZERO? LAFOND-POURS \TRUE
	PRINTI "You fill"
	CALL TPRINT,VESSEL
	PRINTI " with wine"
	PRINT PCR
	RTRUE

	.FUNCT I-WATCH-SLEEP
	ZERO? DRUGGEE /FALSE
	EQUAL? DRUGGEE,BUTLER \?L3
	EQUAL? WATCH-CTR,2 \?L3
	INC 'SCORE
	CALL PRINT-ID,STR?289
	FSET BUTLER,DEADBIT
	IN? BUTLER,HERE /?L4
	PRINT INDENT
	PRINTI "You hear a ""thump-phoosh,"" like someone slumping against a wall"
	PRINT PCR
	JUMP ?L6
?L4:	EQUAL? HERE,LAFS-ROOM \?L6
	CALL HELD?,BOTTLE,HERE >STACK
	ZERO? STACK /?L7
	REMOVE BOTTLE
	PRINT INDENT
	PRINTI "With a grunt of anger, the butler realizes he has been drugged. He grabs"
	CALL TPRINT,BOTTLE
	PRINTI " and throws it out"
	CALL TRPRINT,SHUTTERS
?L7:	PRINT INDENT
	CALL CTPRINT,DRUGGEE
	GET WATCHING-SLEEPY,WATCH-CTR >STACK
	PRINT STACK
	PRINT PCR
?L6:	SET 'DRUGGEE,0
	RTRUE
?L3:	IN? DRUGGEE,HERE \?L11
	PRINT INDENT
	CALL CTPRINT,DRUGGEE
	GET WATCHING-SLEEPY,WATCH-CTR >STACK
	PRINT STACK
	PRINT PCR
?L11:	CALL QUEUE,I-WATCH-SLEEP,1
	INC 'WATCH-CTR
	RETURN WATCH-CTR

	.FUNCT I-CROC-SLEEPS
	EQUAL? HERE,ANTEROOM \?L1
	PRINT INDENT
	PRINTI "Without warning,"
	CALL TPRINT,CROC
	PRINTI " relaxes, eyes closed, asleep."
	CRLF
	CALL PRINT-ID,STR?290
?L1:	INC 'SCORE
	SET 'CROC-SLEEP,1
	SET 'MOUTH-SHUT,1
	RFALSE

	.FUNCT I-SLEEP
	PRINT INDENT
	INC 'SLEEP-CTR
	GET GETTING-SLEEPY,SLEEP-CTR >STACK
	PRINT STACK
	CRLF
	LESS? SLEEP-CTR,4 \?L1
	CALL QUEUE,I-SLEEP,2 >STACK
	RSTACK
?L1:	EQUAL? SLEEP-CTR,4 \FALSE
	PRINT INDENT
	EQUAL? HERE,ON-LADDER,RIGGING-ROOM \?L4
	CALL PRINT-ID,STR?291
	CALL JIGS-UP,STR?292 >STACK
	RSTACK
?L4:	CALL SHIP-BOARD,HERE >STACK
	ZERO? STACK /?L6
	CALL QUEUED?,I-LOOK-SEA >STACK
	ZERO? STACK \?L7
	CALL QUEUED?,I-SHIP-EXPLODES >STACK
	ZERO? STACK /?L6
?L7:	CALL PRINT-ID,STR?293
	CALL JIGS-UP,STR?294 >STACK
	RSTACK
?L6:	PRINTI "You wake at sunrise"
	FSET? LAFS-ROOM,TOUCHBIT /?L9
	PRINTI ", too late to save your father or his friend Jamison"
?L9:	CALL PRINT-ID,STR?295
	CALL FWTD,STR?296 >STACK
	RSTACK

	.FUNCT GLASS-F
	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L1
	CALL CTPRINT,PRSO
	GETP PRSO,P?CONTENTS >STACK
	GET GLASS-DESC,STACK >STACK
	PRINT STACK
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L3
	CALL IMPOSSIBLES >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?DRINK-FROM \?L4
	ZERO? PRSI /?L5
	CALL IMBIBE-WINE,PRSI >STACK
	RSTACK
?L5:	CALL IMBIBE-WINE,PRSO >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?FILL \?L8
	CALL PERFORM,V?POUR,WINE,PRSO
	RTRUE
?L8:	EQUAL? PRSA,V?DROP \?L9
	EQUAL? HERE,LAFS-ROOM \?L9
	MOVE PRSO,TABLE
	PRINTI "You set"
	CALL TPRINT-PRSO
	PRINTI " on"
	CALL TRPRINT,TABLE
	RTRUE
?L9:	EQUAL? PRSA,V?THROW-AT,V?MUNG,V?THROW \?L10
	CALL LAFS-DROP >STACK
	RSTACK
?L10:	EQUAL? PRSA,V?TAKE \FALSE
	EQUAL? PRSO,LAUD \?L12
	CALL IMPOSSIBLES >STACK
	RSTACK
?L12:	EQUAL? PRSO,GREEN-GLASS \?L14
	LESS? LAFOND-CTR,3 \?L14
	EQUAL? HERE,LAFS-ROOM \?L14
	PRINTD LAFOND
	PRINTR " stops you. ""That is mine."""
?L14:	CALL HELD?,BLUE-GLASS >STACK
	ZERO? STACK \?L16
	CALL HELD?,GREEN-GLASS >STACK
	ZERO? STACK /FALSE
?L16:	PRINT YOU-HAVE-ALREADY
	PRINTI " a goblet"
	PRINT PCR
	RTRUE

	.FUNCT LAFS-DROP
	EQUAL? PRSO,BLUE-GLASS,GREEN-GLASS \?L1
	REMOVE PRSO
	PUTP PRSO,P?CONTENTS,0
	PRINTI "The delicate glass of"
	CALL TPRINT-PRSO
	PRINTI " shatters into pieces."
	CRLF
	CALL PRINT-ID,STR?297
	JUMP ?L4
?L1:	EQUAL? PRSO,WINE \?L3
	PRINTI "You dash"
	CALL TPRINT,WINE
	PRINTI " into Lafond's face."
	CRLF
	CALL PRINT-ID,STR?298
	JUMP ?L4
?L3:	CALL WASTES
?L4:	EQUAL? HERE,LAFS-ROOM \TRUE
	IN? LAFOND,HERE \TRUE
	CALL PRINT-ID,STR?299
	CALL FWTD,SMACK-YOUR-FACE >STACK
	RSTACK

	.FUNCT GALLERY-F,RARG,GUY=0
	EQUAL? RARG,M-BEG \?L1
	SET 'GUY,HERO
	CALL TOUCHING?,GUY >STACK
	ZERO? STACK \?L5
	SET 'GUY,LAFOND
	CALL TOUCHING?,GUY >STACK
	ZERO? STACK \?L5
	SET 'GUY,DAD
	CALL TOUCHING?,GUY >STACK
	ZERO? STACK \?L5
	SET 'GUY,LUCY
	CALL TOUCHING?,GUY >STACK
	ZERO? STACK \?L5
	SET 'GUY,COOKIE
	CALL TOUCHING?,GUY >STACK
	ZERO? STACK \?L5
	SET 'GUY,RAPIER
	CALL TOUCHING?,GUY >STACK
	ZERO? STACK /?L3
?L5:	CALL CANT-REACH,GUY >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?THROW-AT \?L6
	PRINTI "You missed."
	CRLF
	CALL PRINT-ID,STR?300 >STACK
	RSTACK
?L6:	EQUAL? PRSO,GALLERY \?L7
	EQUAL? PRSA,V?LOOK,V?EXAMINE \?L7
	CALL V-LOOK >STACK
	RSTACK
?L7:	EQUAL? PRSO,BALLROOM \?L8
	EQUAL? PRSA,V?EXAMINE \?L9
	CALL V-LOOK >STACK
	RSTACK
?L9:	EQUAL? PRSA,V?LEAP,V?ENTER \FALSE
	CALL PERFORM,V?SWING,ROPE
	RTRUE
?L8:	EQUAL? PRSA,V?LEAP-OFF \?L13
	CALL PERFORM,V?SWING,ROPE
	RTRUE
?L13:	EQUAL? PRSA,V?SWING \?L14
	EQUAL? PRSO,ROOMS \?L14
	CALL PERFORM,V?SWING,ROPE
	RTRUE
?L14:	EQUAL? PRSA,V?TELL-ABOUT,V?TELL,V?ASK-ABOUT \FALSE
	CALL RUNNING?,I-DUEL >STACK
	ZERO? STACK /FALSE
	PRINTI "No one is listening to you."
	CRLF
	CALL STOP
	RTRUE
?L1:	EQUAL? RARG,M-ENTER \?L17
	CALL RUNNING?,I-DUEL >STACK
	ZERO? STACK /?L17
	FSET HERO,NDESCBIT
	FSET LAFOND,NDESCBIT
	FSET COOKIE,NDESCBIT
	RTRUE
?L17:	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You are on a wide balcony overlooking the ballroom. A hallway lies to the north.
   Down on"
	PRINT DANCE-FLOOR
	CALL RUNNING?,I-DUEL >STACK
	ZERO? STACK /?L19
	CALL TPRINT,DANCERS
	PRINTI "s are pressed in a wide circle around Nicholas and Lafond. Cookie stands anxiously in the door to the veranda, near"
	CALL TPRINT,DAD
	PRINTI " and Lucy"
	JUMP ?L22
?L19:	FSET? BALLROOM,EVERYBIT \?L21
	PRINTI " a small number of Jamison's scruffiest men are corralling"
	CALL TPRINT,DANCERS
	PRINTI " into a screaming huddle in the center of the room"
	JUMP ?L22
?L21:	PRINTI " you see myriad colors as the guests weave the intricate steps of their dances"
?L22:	PRINTI "."
	RTRUE

	.FUNCT ROPE-F,OARG=0
	ZERO? OARG /?L1
	EQUAL? OARG,M-DESC? /TRUE
	PRINT INDENT
	CALL DESC-ROPE >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L6
	CALL DESC-ROPE >STACK
	RSTACK
?L6:	EQUAL? PRSA,V?CLIMB-ON,V?CLIMB-DOWN,V?SWING \?L7
	FSET? ROPE,EVERYBIT \?L8
	CALL CTPRINT,ROPE
	PRINTI " is looped over the railing -- you'd hang "
	PRINTD ME
	PRINT PCR
	CALL PRINT-ID,STR?301 >STACK
	RSTACK
?L8:	IN? COOKIE,HERE \?L10
	CALL RUNNING?,I-DUEL >STACK
	ZERO? STACK \?L10
	PRINTD COOKIE
	PRINTI " grabs hold of you, ""Ye lost yer mind, lass!"""
	CRLF
	CALL PRINT-ID,STR?302 >STACK
	RSTACK
?L10:	PRINTI """Aaieeee!"" The cry comes uncalled to your lips as you swoop down from the balcony"
	ZERO? BOY-DRESS? \?L12
	PRINTI ", petticoats flying,"
?L12:	PRINTI " on the end of"
	CALL TRPRINT,ROPE
	PRINT INDENT
	CALL RUNNING?,I-DUEL >STACK
	ZERO? STACK /?L15
	LESS? HERO-CTR,15 \?L17
	CALL DEQUEUE,I-DUEL
	FCLEAR RAPIER,NDESCBIT
	MOVE HERO,BEACH
	FCLEAR HERO,NDESCBIT
	MOVE LAFOND,BALLROOM
	FCLEAR LAFOND,NDESCBIT
	MOVE DAD,BEACH
	MOVE LUCY,BEACH
	MOVE COOKIE,BEACH
	FCLEAR COOKIE,NDESCBIT
	FCLEAR BALLROOM,EVERYBIT
	FSET VER-DOOR,OPENBIT
	FSET LAFOND,MUNGBIT
	INC 'SCORE
	IN? BLUE-GLASS,PROTAGONIST \?L19
	REMOVE BLUE-GLASS
	JUMP ?L21
?L19:	IN? GREEN-GLASS,PROTAGONIST \?L21
	REMOVE GREEN-GLASS
?L21:	IN? PINCH,PROTAGONIST \?L23
	MOVE PINCH,SPICES
?L23:	CALL ROB,PROTAGONIST,BALLROOM
	SET 'LAFOND-CTR,1
	CALL QUEUE,I-ENDGAME,6
	PRINTI "Your timing is perfect: you slam into Lafond just as he steps into his lunge. His rapier stabs wildly, piercing Nicholas's shoulder, missing his heart. You and Lafond roll into a snowball of "
	CALL PRINT-ID,STR?303
	ZERO? BOY-DRESS? \?L26
	PRINTI "petticoats"
	JUMP ?L28
?L26:	PRINTI "breeches"
?L28:	PRINTI " and brocade, dropping everything between you."
	CALL CLEAR-SCREEN,15
	PRINT INDENT
	PRINTI "Nicholas shouts, from far away, ""Let me go! Let me deliver Lafond to a 'better' world.""
   ""A gentleman can't kill an unconscious man!"" That is Papa's voice. ""And you're in no shape to continue, Nicholas. Rodney -- help my daughter. I'll take Nick.""
   Cookie leans over you. ""We must get back to the ship, Miss. Dragoons surround the house."" Nicholas, injured but still arguing, is already on the veranda, half-forced, half-supported by your father, shadowed by Lucy. Cookie helps you to your feet and rushes after them, expecting you to follow. Lafond lies nearby, apparently unconscious"
	PRINT PCR
	CRLF
	CALL GOTO,BALLROOM >STACK
	RSTACK
?L17:	CALL PRINT-ID,STR?304
	CALL JIGS-UP,STR?305 >STACK
	RSTACK
?L15:	FSET? BALLROOM,EVERYBIT \?L30
	CALL PRINT-ID,STR?306
	CALL JIGS-UP,STR?307 >STACK
	RSTACK
?L30:	CALL PRINT-ID,STR?308
	CALL FWTD,STR?309 >STACK
	RSTACK
?L7:	EQUAL? PRSA,V?TIE \?L32
	EQUAL? PRSI,RAILING \?L32
	FSET? ROPE,EVERYBIT \?L33
	PRINT ALREADY-IS
	RTRUE
?L33:	FSET ROPE,EVERYBIT
	PRINTR "Tied."
?L32:	EQUAL? PRSA,V?REMOVE,V?UNTIE \?L36
	FSET? ROPE,EVERYBIT \?L37
	FCLEAR ROPE,EVERYBIT
	PRINTI "Untied. "
	CALL CTPRINT,CHANDELIER
	PRINTR " swings slightly, dribs of hot wax spilling to the floor."
?L37:	CALL WASTES >STACK
	RSTACK
?L36:	EQUAL? PRSA,V?TAKE \?L40
	FSET? ROPE,EVERYBIT \?L41
	CALL DO-FIRST,STR?310 >STACK
	RSTACK
?L41:	FSET? ROPE,DEADBIT \?L43
	CALL CANT-REACH,ROPE >STACK
	RSTACK
?L43:	PRINTI "Pray describe what you intend to do with"
	CALL TRPRINT,ROPE
	RTRUE
?L40:	EQUAL? PRSA,V?FIDDLE,V?RAISE,V?MOVE \FALSE
	CALL CTPRINT,CHANDELIER
	PRINTI " swings, but is too heavy for you to pull up"
	PRINT PCR
	RTRUE

	.FUNCT DESC-ROPE
	PRINTI "A "
	PRINTD CHANDELIER
	PRINTI " is held above"
	PRINT DANCE-FLOOR
	PRINTI " by a rope and pulley system, so that the servants can lower it to light and snuff its candles. Several feet of "
	PRINTD ROPE
	PRINTI " hang down from the pulley, the "
	FSET? ROPE,EVERYBIT \?L1
	PRINTI "excess tied around"
	JUMP ?L3
?L1:	PRINTI "end resting on"
?L3:	CALL TPRINT,RAILING
	PRINTI "."
	EQUAL? PRSA,V?EXAMINE \TRUE
	CRLF
	RTRUE

	.FUNCT CHAND-F
	EQUAL? PRSA,V?OFF \?L1
	CALL CANT-REACH,CHANDELIER >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L3
	PRINTI "Held in place by a rope running through a pulley,"
	CALL TPRINT,CHANDELIER
	PRINTI " gently swings its one hundred candles over"
	PRINT DANCE-FLOOR
	PRINT PCR
	RTRUE
?L3:	EQUAL? PRSA,V?SWING,V?UNTIE \FALSE
	CALL PERFORM-PRSA,ROPE >STACK
	RSTACK

	.FUNCT CRACK-F
	EQUAL? PRSA,V?LOOK-INSIDE \?L1
	CALL PERFORM,V?EXAMINE,SHIP
	RTRUE
?L1:	EQUAL? PRSA,V?BOARD,V?CLIMB-ON,V?ENTER \FALSE
	CALL CTPRINT,CRACK
	PRINTR " is too narrow."

	.FUNCT HORN-F
	EQUAL? PRSA,V?EMPTY \?L1
	PRINTR "You start to empty it, but reconsider."
?L1:	EQUAL? PRSA,V?EMPTY-FROM \?L3
	EQUAL? PRSI,HORN \?L3
	CALL PERFORM,V?EMPTY,HORN
	RTRUE
?L3:	EQUAL? PRSA,V?TAKE \?L4
	CALL ITAKE,0 >STACK
	EQUAL? STACK,M-FATAL,0 /?L4
	FSET? HORN,TOUCHBIT /?L4
	FCLEAR POWDER,INVISIBLE
	PRINTI "Taken."
	CRLF
	CALL IS-THEFT? >STACK
	CALL PRINT-ID,STR?311,STACK >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?FILL \?L5
	EQUAL? PRSO,HORN \?L5
	CALL CANT-VERB-A-PRSO,STR?312 >STACK
	RSTACK
?L5:	EQUAL? PRSA,V?PUT,V?POUR \?L6
	EQUAL? PRSI,HORN \?L6
	CALL PERFORM,V?FILL,PRSI,PRSO
	RTRUE
?L6:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L7
	PRINT YOU-CANT-SEE-ANY
	PRINT WAY-TO-DO-THAT
	RTRUE
?L7:	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L8
	PRINTI "Almost triangular, with a little spout on top,"
	CALL TPRINT,HORN
	PRINTI " is similar to the one your father used to carry when hunting. It is filled with a mixture of "
	PRINTD POWDER
	PRINTI " and shot"
	PRINT PCR
	RTRUE
?L8:	EQUAL? PRSA,V?TAKE \FALSE
	CALL NOUN-USED,W?POWDER,HORN >STACK
	ZERO? STACK /FALSE
	CALL HELD?,HORN >STACK
	ZERO? STACK /FALSE
	PRINTI "You pour out some "
	PRINTD POWDER
	PRINTR ". It blows away."

	.FUNCT ANTEROOM-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "Two exits lead from this cavernous room, north and south. The walls drip with wet, forming a huge pool on the floor."
	RTRUE
?L1:	EQUAL? RARG,M-END \FALSE
	ZERO? CROC-FREE \?L4
	IN? DAD,HERE \?L4
	PRINT INDENT
	PRINTI "Your father stops, smiling at"
	CALL TPRINT,CROC
	PRINTI ", ""Hello, chum, how are you?"" He bends over the creature, and "
	ZERO? MUZZLED /?L6
	SET 'AWAITING-REPLY,6
	CALL QUEUE,I-REPLY,2
	MOVE GARTER,DAD
	FCLEAR GARTER,NDESCBIT
	PRINTI "laughs. ""That's my Lucy! Never one to shirk belling the cat. What a woman! Have you been to the kitchen, dear?"" He slips off"
	CALL TPRINT,GARTER
	PRINTI " and"
	JUMP ?L8
?L6:	ZERO? CROC-SLEEP /?L8
	PRINTI "scratches its bumpy snout, muttering, ""Never seen you sleep like this before."" It stirs to life as "
	PRINTD DAD
?L8:	PRINTI " walks over to you by the north entrance. The reptile"
	ZERO? CROC-SLEEP /?L10
	PRINTI ", waking,"
?L10:	SET 'CROC-FREE,1
	SET 'MOUTH-SHUT,0
	SET 'MUZZLED,0
	SET 'CROC-SLEEP,0
	FCLEAR GARTER,TRYTAKEBIT
	FSET GARTER,TAKEBIT
	PRINTR " lunges after him, choking on its chain."
?L4:	ZERO? COOKIE-FIGHTING-CROC \FALSE
	IN? COOKIE,HERE \FALSE
	SET 'COOKIE-FIGHTING-CROC,1
	FSET CROC,NDESCBIT
	PRINT INDENT
	PRINTI "Cookie rushes at"
	CALL TPRINT,CROC
	PRINTI ", crying, ""I'll take care of this monster, sweetheart. You run by and do what you must do."" He dives headlong into"
	CALL TPRINT,POOL
	IN? RAPIER,COOKIE \?L14
	MOVE RAPIER,HERE
	PRINTI ", throwing free"
	CALL TPRINT,RAPIER
?L14:	PRINT PCR
	RTRUE

	.FUNCT CROC-EXIT
	ZERO? COOKIE-FIGHTING-CROC /?L1
	CALL DUNGEON-ENTRANCE >STACK
	RSTACK
?L1:	ZERO? MUZZLED \?L4
	ZERO? CROC-SLEEP /?L3
?L4:	PRINTI "You edge past the reptile"
	PRINT PCR
	CRLF
	RETURN DUNGEON
?L3:	CALL RUNNING?,I-CROC-OPENS-MOUTH >STACK
	ZERO? STACK /?L6
	CALL DEQUEUE,I-CROC-OPENS-MOUTH
?L6:	CALL CTPRINT,CROC
	PRINTI " roars at you. You retreat to the north entrance and the monster stills, waiting, chops open, almost smiling"
	PRINT PCR
	RFALSE

	.FUNCT DUNGEON-ENTRANCE
	ZERO? COOKIE-FIGHTING-CROC /?L3
	FCLEAR DUNGEON,TOUCHBIT
	SET 'VERBOSITY,1
	FSET? CRULLEY,MUNGBIT /?L3
	ZERO? CRULLEY-BACK \?L3
	SET 'CRULLEY-CTR,1
	CALL QUEUE,I-CDUNG,-1
	PRINTI "A whip cracks "
	ZERO? WHIPPING-SPEECH /?L5
	SET 'WHIPPING-SPEECH,0
	PRINTI "the air. ""Flogs me, will ye, Cap'n? Taste it "
	PRINTD ME
	PRINTI ", har."" Jamison groans, half conscious"
	JUMP ?L7
?L5:	PRINTI "against flesh"
?L7:	PRINTI ". You rush in"
	PRINT PCR
	CRLF
?L3:	RETURN DUNGEON

	.FUNCT CROC-F,OARG=0
	ZERO? OARG /?L1
	EQUAL? OARG,M-DESC? /TRUE
	FSET? CROC,TOUCHBIT \?L6
	PRINT INDENT
	CALL CTPRINT,CROC
	JUMP ?L8
?L6:	FSET CROC,TOUCHBIT
	PRINT INDENT
	PRINTI "A "
	PRINTD CROC
?L8:	PRINTI " lies half in the pool, "
	ZERO? CROC-SLEEP /?L9
	PRINTI "sleeping."
	RTRUE
?L9:	PRINTI "gazing at you,"
	ZERO? MUZZLED /?L12
	CALL APRINT,GARTER
	PRINTI " around its snout."
	RTRUE
?L12:	ZERO? MOUTH-SHUT /?L14
	PRINTI " mouth closed."
	RTRUE
?L14:	PRINTI " with baleful eyes, jaws wide open. Dagger-sharp teeth glint in"
	CALL TPRINT,TORCH
	PRINTI "light."
	RTRUE
?L1:	EQUAL? PRSA,V?PUT-ON \?L16
	EQUAL? PRSO,GARTER \?L16
	ZERO? CROC-FREE /?L17
	REMOVE PRSO
	PRINT CROC-LUNGES
	PRINTI "Screaming, you dash back, dropping"
	CALL TPRINT,GARTER
	PRINTI " into"
	CALL TRPRINT,POOL
	RTRUE
?L17:	ZERO? MOUTH-SHUT /?L19
	MOVE GARTER,CROC
	FSET GARTER,NDESCBIT
	SET 'MUZZLED,1
	FSET GARTER,TRYTAKEBIT
	FCLEAR GARTER,TAKEBIT
	ZERO? CROC-SLEEP \?L20
	CALL QUEUED?,I-CROC-SLEEPS >STACK
	ZERO? STACK \?L22
	INC 'SCORE
?L22:	PRINTI "With great daring and greater speed, you slip"
	CALL TPRINT,GARTER
	PRINTI " around"
	CALL TPRINT,CROC
	PRINTI "'s snout. "
	CALL CTPRINT,CROC
	PRINTR " thrashes about, unable to remove it."
?L20:	CALL CTPRINT,GARTER
	PRINTI " fits on its snout like a ring on a wedding finger"
	PRINT PCR
	RTRUE
?L19:	CALL CTPRINT,GARTER
	PRINTI " won't fit around that open maw"
	PRINT PCR
	RTRUE
?L16:	ZERO? CROC-SLEEP /?L27
	EQUAL? PRSA,V?ALARM \?L27
	PRINTR "That is the last thing you want to do!"
?L27:	EQUAL? PRSA,V?EMBRACE,V?KISS \?L28
	PRINTI "The very thought makes you shiver."
	CRLF
	CALL PRINT-ID,STR?313 >STACK
	RSTACK
?L28:	EQUAL? PRSA,V?TOUCH,V?PUT-ON,V?PUT /?L30
	EQUAL? PRSA,V?ENTER \?L29
?L30:	PRINTI "It would be safer to stay distant and throw things at"
	CALL TRPRINT,CROC
	RTRUE
?L29:	CALL NOUN-USED,W?MOUTH,CROC >STACK
	ZERO? STACK /?L31
	GET P-ADJW,0 >STACK
	ZERO? STACK \?L31
	GET P-ADJW,1 >STACK
	ZERO? STACK /FALSE
?L31:	EQUAL? PRSA,V?MUZZLE \?L32
	EQUAL? PRSI,GARTER \?L32
	CALL PERFORM,V?PUT-ON,GARTER,CROC
	RTRUE
?L32:	EQUAL? PRSA,V?THROW-TO,V?GIVE,V?THROW /?L34
	EQUAL? PRSA,V?THROW-AT \?L33
?L34:	ZERO? COOKIE-FIGHTING-CROC /?L35
	CALL CTPRINT,CROC
	PRINTR " is too busy fighting Cookie to notice."
?L35:	EQUAL? PRSO,BOTTLE \?L37
	PRINTI "You might need that later."
	CRLF
	CALL PRINT-ID,STR?314 >STACK
	RSTACK
?L37:	EQUAL? PRSO,RETICULE \?L38
	CALL PRINT-ID,STR?315
	RFALSE
?L38:	ZERO? CROC-SLEEP /?L39
	EQUAL? PRSO,SALTS \?L40
	EQUAL? PRSA,V?GIVE \?L40
	CALL PERFORM,V?ALARM,CROC,SALTS
	RTRUE
?L40:	PRINTI "But"
	CALL TPRINT,CROC
	PRINTR " is asleep."
?L39:	EQUAL? PRSO,PINCH,SPICES \?L43
	IN? PINCH,PROTAGONIST \?L43
	MOVE PINCH,SPICES
	CALL CTPRINT,CROC
	PRINTI " blinks its eyes once, but takes no other notice of"
	CALL TRPRINT,SPICES
	CALL PRINT-ID,STR?316 >STACK
	RSTACK
?L43:	ZERO? CROC-FREE /?L44
	REMOVE PRSO
	PRINT CROC-LUNGES
	CALL CTPRINT,PRSO
	PRINTI " drops ignored into"
	CALL TRPRINT,POOL
	CALL PRINT-ID,STR?317
	RTRUE
?L44:	ZERO? MUZZLED /?L45
	CALL CTPRINT,CROC
	PRINTI " is helpless! "
	PRINT MOTHER
	CALL PRINT-ID,STR?318 >STACK
	RSTACK
?L45:	REMOVE PRSO
	SET 'MOUTH-SHUT,1
	CALL QUEUE,I-CROC-OPENS-MOUTH,2
	CALL CTPRINT,CROC
	PRINTI " snaps its jaws shut as"
	CALL TPRINT-PRSO
	EQUAL? PRSO,SALTS \?L47
	PRINTI " bounce"
	PRINTI " off its hide, sinking into"
	CALL TRPRINT,POOL
	RTRUE
?L47:	PRINTI " disappear"
	EQUAL? PRSO,PANTS /?L50
	PRINTI "s"
?L50:	PRINTI " into"
	EQUAL? PRSO,PORK \?L53
	ZERO? PORK-DOPED /?L55
	CALL QUEUE,I-CROC-SLEEPS,3
?L55:	PRINTR " its maw."
?L53:	CALL TRPRINT,POOL
	RTRUE
?L33:	EQUAL? PRSA,V?LEAP \?L59
	PRINTR "You can't jump that far."
?L59:	EQUAL? PRSA,V?THROW-AT,V?STHROW,V?SGIVE \?L60
	CALL PERFORM,V?THROW-TO,PRSI,CROC
	RTRUE
?L60:	EQUAL? PRSA,V?EXAMINE \?L61
	ZERO? COOKIE-FIGHTING-CROC /?L62
	CALL CTPRINT,POOL
	PRINTI " boils with the bodies of"
	CALL TPRINT,CROC
	PRINTI " and"
	CALL TRPRINT,COOKIE
	RTRUE
?L62:	ZERO? MUZZLED /?L64
	CALL CTPRINT,CROC
	PRINTI "'s snout is pinned closed by"
	CALL APRINT,GARTER
	ZERO? CROC-SLEEP /?L65
	PRINT SNORTS-IN-SLEEP
?L65:	PRINT PCR
	RTRUE
?L64:	ZERO? MOUTH-SHUT /?L68
	PRINTI "Two gleaming teeth poke out of"
	CALL TPRINT,CROC
	PRINTI "'s closed mouth"
	ZERO? CROC-SLEEP /?L69
	PRINT SNORTS-IN-SLEEP
?L69:	PRINT PCR
	RTRUE
?L68:	CALL CTPRINT,CROC
	PRINTI " smiles at you invitingly, white teeth shining in"
	CALL TPRINT,TORCH
	PRINTR "light."
?L61:	EQUAL? PRSA,V?KICK,V?MUNG,V?KILL \FALSE
	CALL PRINT-ID,STR?319
	ZERO? COOKIE-FIGHTING-CROC /?L74
	PRINTD COOKIE
	PRINTI " is seeing to"
	CALL TRPRINT,CROC
	RTRUE
?L74:	ZERO? CROC-SLEEP /?L76
	PRINTI "Harm a sleeping animal! "
	PRINT MOTHER
	RTRUE
?L76:	ZERO? MUZZLED /?L77
	PRINTI "The tear welling up in"
	CALL TPRINT,CROC
	PRINTI "'s eye is rather poignant. You can't bear to hurt the beast in this state"
	PRINT PCR
	RTRUE
?L77:	PRINTI "You have no wish to get any closer to"
	CALL TRPRINT,CROC
	RTRUE

	.FUNCT I-CROC-OPENS-MOUTH
	ZERO? MUZZLED \FALSE
	IN? CROC,HERE \FALSE
	SET 'MOUTH-SHUT,0
	PRINT INDENT
	PRINTI "With an inaudible creak,"
	CALL TPRINT,CROC
	PRINTI "'s mouth opens again"
	PRINT PCR
	RTRUE

	.FUNCT POOL-F
	EQUAL? PRSA,V?SWIM,V?CRAWL-UNDER,V?ENTER \?L1
	PRINTI "You splash around at the outskirts of"
	CALL TRPRINT,POOL
	RTRUE
?L1:	EQUAL? PRSA,V?THROW-AT,V?THROW-TO,V?THROW \?L3
	EQUAL? PRSO,PORK \?L4
	ZERO? MOUTH-SHUT \?L4
	ZERO? CROC-SLEEP \?L4
	PRINTI "With a terrific splash,"
	CALL TPRINT,CROC
	PRINTI " throws itself after"
	CALL TPRINT-PRSO
	PRINTI ". "
	CALL PERFORM,V?THROW,PORK,CROC
	RTRUE
?L4:	EQUAL? PRSO,BOTTLE \?L6
	CALL PERFORM,V?THROW,BOTTLE,CROC
	RTRUE
?L6:	REMOVE PRSO
	CALL CTPRINT,PRSO
	PRINTI " splashes into"
	CALL TRPRINT,POOL
	CALL PRINT-ID,STR?320 >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?LOOK-INSIDE \?L8
	PRINTI "It's too murky to see anything"
	PRINT PCR
	RTRUE
?L8:	EQUAL? PRSA,V?PUT \?L9
	REMOVE PRSO
	CALL CTPRINT,PRSO
	PRINTR " sinks from sight."
?L9:	EQUAL? PRSA,V?DRINK-FROM,V?DRINK \FALSE
	PRINTI "Yechh!"
	CRLF
	CALL PRINT-ID,STR?321 >STACK
	RSTACK

	.FUNCT DUNGEON-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "You sense, rather than see, the rusty skeletons of old cages and torture devices that line the walls of this cavernous room. One flaming torch, high on a wall, casts mad licks of light into the darkness. Passages lead north and west. Set deep in the rocky floor is a"
	CALL TELL-OPEN$002fCLOSED,TRAP,1
	PRINTI " "
	PRINTD TRAP
	PRINT PCR
	PRINT INDENT
	CALL DESC-MANACLES >STACK
	RSTACK
?L1:	EQUAL? RARG,M-BEG \?L3
	ZERO? ENDGAME /?L3
	IN? CRULLEY,HERE \?L3
	FSET? CRULLEY,MUNGBIT /?L3
	EQUAL? HERO,PRSO,PRSI \?L7
	CALL AFFIRMATIVE-ANSWER >STACK
	ZERO? STACK \?L6
?L7:	CALL TOUCHING?,HERO >STACK
	ZERO? STACK \?L6
	CALL TOUCHING?,MANACLES >STACK
	ZERO? STACK /?L4
?L6:	PRINTD CRULLEY
	PRINTR " growls, ""Keep away from 'im."""
?L4:	CALL TOUCHING?,TRAP >STACK
	ZERO? STACK /FALSE
	EQUAL? PRSA,V?BOARD,V?ENTER /FALSE
	PRINTD CRULLEY
	PRINTR " barks, ""Leave that alone."""
?L3:	EQUAL? RARG,M-END \FALSE
	ZERO? CRULLEY-BACK /FALSE
	PRINT INDENT
	PRINTD CRULLEY
	PRINTI " jumps out of the shadows at you."
	CALL PRINT-ID,STR?322
	CALL JIGS-UP,FALL-TO-BOTTOM >STACK
	RSTACK

	.FUNCT DUNGEON-EXIT
	CALL RUNNING?,I-CDUNG >STACK
	ZERO? STACK /?L1
	CALL DEQUEUE,I-CDUNG
	FCLEAR CRULLEY,EVERYBIT
	PRINTI """Come back 'ere, wench!"""
	CALL TPRINT,CRULLEY
	PRINT CALLS-AFTER
?L1:	EQUAL? P-WALK-DIR,P?WEST \?L4
	RETURN PASSAGE-4
?L4:	EQUAL? P-WALK-DIR,P?NORTH \FALSE
	RETURN ANTEROOM

	.FUNCT MANACLES-F
	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L1
	CALL DESC-MANACLES >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?CLOSE \?L3
	ZERO? PRSI /?L4
	CALL PERFORM,V?PUT-ON,MANACLES,PRSI
	RTRUE
?L4:	CALL OPEN-CLOSE,PRSO,0,STR?323 >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?OPEN \?L7
	FSET? MANACLES,OPENBIT \?L8
	PRINTR "They are already open!"
?L8:	EQUAL? PRSI,JEWEL \?L10
	CALL PROPOSE >STACK
	RSTACK
?L10:	PRINTI "It isn't that easy"
	PRINT PCR
	RTRUE
?L7:	EQUAL? PRSA,V?UNLOCK,V?PICK \?L12
	EQUAL? PRSI,JEWEL \?L12
	PRINTI "You twist the pin of"
	CALL TPRINT,JEWEL
	PRINTI " in the "
	IN? HERO,MANACLES \?L13
	MOVE HERO,HERE
	INC 'SCORE
	FSET MANACLES,OPENBIT
	PRINTI "locks, quickly freeing Nicholas. "
	CALL PRINT-ID,STR?324
	FSET? HERO,DEADBIT \?L15
	PRINTI "He falls in a faint at your feet"
	PRINT PCR
	RTRUE
?L15:	CRLF
	CALL NICK-RUNS-OFF >STACK
	RSTACK
?L13:	FSET MANACLES,OPENBIT
	FCLEAR MANACLES,LOCKEDBIT
	PRINTI "manacles until they pop open"
	PRINT PCR
	RTRUE
?L12:	EQUAL? PRSA,V?UNLOCK \?L19
	PRINTI "That key is much too large to fit in"
	CALL TRPRINT,MANACLES
	RTRUE
?L19:	EQUAL? PRSA,V?WEAR,V?REACH-IN \?L20
	CALL PERFORM,V?PUT-ON,MANACLES,ME
	RTRUE
?L20:	EQUAL? PRSA,V?PUT \?L21
	EQUAL? PRSO,ME \?L22
	CALL PERFORM,V?PUT-ON,MANACLES,ME
	RTRUE
?L22:	EQUAL? PRSO,LARGE-KEY \?L24
	CALL PERFORM,V?UNLOCK,MANACLES
	RTRUE
?L24:	MOVE PRSO,HERE
	CALL CTPRINT,PRSO
	PRINTR " drops to the floor."
?L21:	EQUAL? PRSA,V?WEAR,V?PUT-ON /?L27
	EQUAL? PRSA,V?TIE \FALSE
	EQUAL? P-PRSA-WORD,W?FASTEN,W?SECURE,W?ATTACH \FALSE
?L27:	EQUAL? PRSI,ME \?L28
	PRINTI "Mama would not have praised your intelligence"
	PRINT PCR
	CALL PRINT-ID,STR?325 >STACK
	RSTACK
?L28:	EQUAL? PRSI,DAD \?L30
	SET 'AWAITING-REPLY,1
	CALL QUEUE,I-REPLY,2
	PRINTR "He wanders off before you can get them on him. ""Oh dear, you have learned atrocious manners these last few year in London!"""
?L30:	EQUAL? PRSI,HERO \?L31
	PRINT YOU-CANT
	PRINTR "lift him high enough."
?L31:	PRINT YOU-CANT
	PRINTI "put that in "
	PRINTD MANACLES
	PRINTR "!"

	.FUNCT DESC-MANACLES
	IN? HERO,MANACLES \?L1
	PRINTI "Nicholas is spread-eagled against the wall, shackled in the "
	PRINTD MANACLES
	PRINTI "."
	JUMP ?L4
?L1:	IN? PROTAGONIST,MANACLES \?L3
	PRINTI "You lean against the wall, one arm raised above "
	PRINTD HEAD
	PRINTI ", cuffed in a manacle."
	JUMP ?L4
?L3:	PRINTI "A "
	PRINTD MANACLES
	PRINTI " hangs from iron chains attached high on the wall."
?L4:	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \TRUE
	CRLF
	RTRUE

	.FUNCT GEN-WELL
	EQUAL? HERE,DUNGEON \FALSE
	RETURN TRAP

	.FUNCT TRAP-F
	EQUAL? PRSA,V?MOVE,V?RAISE,V?OPEN /?L3
	EQUAL? PRSA,V?LOWER,V?CLOSE \?L1
?L3:	CALL OPEN-CLOSE,TRAP,STR?326,0 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?LOOK-INSIDE,V?LOOK-UNDER \?L4
	FSET? TRAP,OPENBIT \?L5
	IN? CRULLEY,TRAP \?L7
	PRINTD CRULLEY
	PRINTR " is slowly climbing up the well."
?L7:	PRINTI "You smell salt water and mold, but you can see nothing"
	PRINT PCR
	RTRUE
?L5:	PRINTI "It"
	PRINT IS-CLOSED
	PRINT PCR
	RTRUE
?L4:	EQUAL? PRSA,V?STAND-ON,V?BOARD,V?ENTER \?L11
	FSET? TRAP,OPENBIT \?L12
	PRINTI "You start to climb down the well, but lose your footing on the slimy rock."
	FSET? CRULLEY,MUNGBIT \?L17
	PRINTI " At least you take"
	CALL TPRINT,CRULLEY
	PRINTI " with you as you fall."
	JUMP ?L17
?L12:	PRINTI "As you stand on"
	CALL TPRINT,TRAP
	PRINTI ", the rotted wood tears away."
?L17:	CALL PRINT-ID,STR?327
	CALL JIGS-UP,FALL-TO-BOTTOM >STACK
	RSTACK
?L11:	EQUAL? PRSA,V?PUT-ON \?L18
	FSET? TRAP,OPENBIT \?L18
	CALL PERFORM,V?THROW,PRSO,TRAP
	RTRUE
?L18:	EQUAL? PRSA,V?PUT-THROUGH,V?PUT,V?THROW /?L20
	EQUAL? PRSA,V?THROW-AT \FALSE
?L20:	EQUAL? PRSO,RAPIER \?L21
	PRINTD HERO
	PRINTI " would not thank you for doing that."
	CRLF
	CALL PRINT-ID,STR?328 >STACK
	RSTACK
?L21:	EQUAL? PRSO,RETICULE \?L23
	CALL PRINT-ID,STR?329
	RFALSE
?L23:	FSET? CRULLEY,MUNGBIT \?L24
	CALL PERFORM,V?THROW,PRSO,CRULLEY
	RTRUE
?L24:	REMOVE PRSO
	PRINTI "You drop"
	CALL TPRINT-PRSO
	PRINTI " into the well. Several seconds later you hear a tiny splash"
	PRINT PCR
	CALL PRINT-ID,STR?330 >STACK
	RSTACK

	.FUNCT CELL-4-F,RARG
	EQUAL? RARG,M-END \?L1
	FSET? DAD,TOUCHBIT /?L1
	FSET DAD,TOUCHBIT
	FCLEAR DAD,NDESCBIT
	INC 'SCORE
	EQUAL? DANCED-WITH,LAFOND \?L3
	CALL QUEUE,I-SUMMONS,15
?L3:	CALL QUEUE,I-DAD,2
	PRINT INDENT
	PRINTI "As you enter, a tall bony man moves out of the darkness. ""Papa,"" you cry, rushing into his arms.
   ""Why, hullo, my dear."" He hugs you tightly. ""Nick certainly took his time about fetching you."
	CALL PRINT-ID,STR?331
	ZERO? BOY-DRESS? \?L8
	FSET? CHEMISE,EVERYBIT /?L9
?L8:	PRINTI """ He squints in horror at your clothes. ""I have always found the London fashions quite abominable."
	FSET? CHEMISE,EVERYBIT /?L9
	SET 'AWAITING-REPLY,2
	CALL QUEUE,I-REPLY,2
	PRINTI " Aren't you a trifle cold?"
?L9:	PRINTR """"
?L1:	ZERO? RARG \FALSE
	RFALSE

	.FUNCT CELL-OBJ-F
	EQUAL? PRSA,V?BOARD,V?ENTER \?L1
	EQUAL? HERE,CELL-1,CELL-2,CELL-4 \?L3
	PRINT LOOK-AROUND
	RTRUE
?L3:	EQUAL? HERE,PASSAGE-1,PASSAGE-2 \?L5
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L5:	EQUAL? HERE,PASSAGE-4 \FALSE
	CALL DO-WALK,P?NORTH >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE,V?LOOK \FALSE
	EQUAL? HERE,CELL-1,CELL-2,CELL-4 \?L9
	CALL V-LOOK >STACK
	RSTACK
?L9:	PRINTI "You would do better to enter it"
	PRINT PCR
	RTRUE

	.FUNCT PILE-OF-CLOTHES-F
	EQUAL? PRSA,V?PUT-ON,V?EXAMINE,V?TAKE /?L3
	EQUAL? PRSA,V?WEAR \FALSE
?L3:	EQUAL? HERE,LANDING,CAPT-QUARTERS \?L4
	CALL CANT-REACH,PRSO >STACK
	RSTACK
?L4:	CALL ITAKE,0 >STACK
	EQUAL? STACK,M-FATAL,0 /FALSE
	REMOVE PILE-OF-CLOTHES
	FSET PILE-OF-CLOTHES,TOUCHBIT
	MOVE SHIRT,PROTAGONIST
	MOVE PANTS,PROTAGONIST
	FCLEAR SHIRT,NDESCBIT
	FCLEAR PANTS,NDESCBIT
	FSET SHIRT,TOUCHBIT
	FSET PANTS,TOUCHBIT
	INC 'SCORE
	EQUAL? PRSA,V?EXAMINE \?L7
	PRINTI "To get a better look, y"
	JUMP ?L9
?L7:	PRINTI "Y"
?L9:	PRINTI "ou pick up"
	CALL TPRINT,PILE-OF-CLOTHES
	PRINTI ". It separates into a pair of "
	PRINTD PANTS
	PRINTI " and"
	CALL ARPRINT,SHIRT
	RTRUE

	.FUNCT GEN-CLOTHES
	GET P-NAMW,1 >STACK
	GET P-NAMW,0 >STACK
	EQUAL? W?CLOTHES,STACK,STACK \?L1
	EQUAL? HERE,SLEEPING-CUPBOARD \?L3
	FSET? SHIRT,TOUCHBIT /?L3
	FSET? PANTS,TOUCHBIT /?L3
	RETURN PILE-OF-CLOTHES
?L3:	EQUAL? PRSA,V?TAKE-OFF,V?REMOVE \FALSE
	CALL PRE-DOFF >STACK
	ZERO? STACK /?L6
	RETURN NOT-HERE-OBJECT
?L6:	CALL REMOVE-CLOTHES,1
	RETURN NOT-HERE-OBJECT
?L1:	GET P-NAMW,1 >STACK
	GET P-NAMW,0 >STACK
	EQUAL? W?DRESS,STACK,STACK \FALSE
	EQUAL? PRSA,V?TAKE-OFF,V?REMOVE \?L11
	CALL PRE-DOFF >STACK
	ZERO? STACK /?L13
	RETURN NOT-HERE-OBJECT
?L13:	CALL REMOVE-CLOTHES,1
	RETURN NOT-HERE-OBJECT
?L11:	EQUAL? PRSA,V?DROP \FALSE
	FSET? GOWN,WORNBIT \?L17
	CALL HELD?,DRESS >STACK
	ZERO? STACK /?L17
	PRINTI "["
	PRINTD DRESS
	PRINTI "]"
	CRLF
	RETURN DRESS
?L17:	FSET? DRESS,WORNBIT \?L19
	CALL HELD?,GOWN >STACK
	ZERO? STACK /?L19
	PRINTI "["
	PRINTD GOWN
	PRINTI "]"
	CRLF
	RETURN GOWN
?L19:	CALL DO-FIRST,STR?194
	RETURN NOT-HERE-OBJECT

	.FUNCT GARMENT-F
	EQUAL? PRSA,V?EXAMINE \?L1
	EQUAL? PRSO,DRESS \?L3
	ZERO? WET-DRESS /?L5
	CALL WET-DESC,DRESS
	RTRUE
?L5:	PRINTI "It is your favorite old frock, looking rather bedraggled without its hoops"
	FSET? DRESS,EVERYBIT /?L8
	FSET DRESS,EVERYBIT
	PRINTI ", which you hadn't time to put on during the pirate attack"
?L8:	PRINTI ". "
	FSET? DRESS,MUNGBIT \?L11
	PRINTI "There is a tear out of the skirt"
	JUMP ?L13
?L11:	PRINTI "The worn fabric of the skirt often catches on things, tearing"
?L13:	PRINT PCR
	RTRUE
?L3:	EQUAL? PRSO,GOWN \?L14
	PRINTI "Of cream silk, heavily embroidered on the stiffened skirt and stomacher,"
	CALL TPRINT,GOWN
	PRINTI " is a work of art"
	PRINT PCR
	RTRUE
?L14:	EQUAL? PRSO,SHIRT \?L15
	CALL CTPRINT,SHIRT
	PRINTI " is clean and not too big"
	FSET? SHIRT,MUNGBIT \?L16
	PRINT TEAR
?L16:	PRINT PCR
	RTRUE
?L15:	CALL CTPRINT,PANTS
	PRINTR " are about your size."
?L1:	EQUAL? PRSA,V?LOOK-UNDER,V?LOOK-INSIDE \?L20
	FSET? PRSO,WORNBIT \?L20
	PRINTI "Just"
	CALL APRINT,CHEMISE
	PRINTI ", and a couple fleas"
	PRINT PCR
	RTRUE
?L20:	EQUAL? PRSA,V?WEAR \?L21
	EQUAL? PRSO,GOWN,DRESS \?L25
	FSET? SHIRT,WORNBIT /?L26
	FSET? PANTS,WORNBIT /?L26
?L25:	EQUAL? PRSO,PANTS,SHIRT \?L22
	FSET? DRESS,WORNBIT /?L26
	FSET? GOWN,WORNBIT \?L22
?L26:	CALL CTPRINT,PRSO
	PRINTI " doesn't fit over what you are already wearing"
	PRINT PCR
	RTRUE
?L22:	ZERO? WET-DRESS /?L27
	EQUAL? PRSO,DRESS \?L27
	PRINTI "The clammy cotton makes it too uncomfortable to wear."
	CRLF
	CALL PRINT-ID,STR?332 >STACK
	RSTACK
?L27:	FSET PRSO,WORNBIT
	MOVE PRSO,PROTAGONIST
	EQUAL? PRSO,SHIRT,PANTS \?L29
	IN? PILE-OF-CLOTHES,SLEEPING-CUPBOARD \?L29
	FSET PILE-OF-CLOTHES,TOUCHBIT
	REMOVE PILE-OF-CLOTHES
	INC 'SCORE
?L29:	EQUAL? PRSO,PANTS \?L32
	PRINTI "You tuck"
	CALL TPRINT,CHEMISE
	FSET? SHIRT,WORNBIT \?L34
	SET 'BOY-DRESS?,1
	FSET CHEMISE,EVERYBIT
	PRINTI " and"
	CALL TPRINT,SHIRT
?L34:	PRINTI " into the pants. You look a little fat, but now you can move freely"
	PRINT PCR
	RTRUE
?L32:	EQUAL? PRSO,SHIRT \?L37
	FSET? PANTS,WORNBIT \?L38
	FSET CHEMISE,EVERYBIT
	SET 'BOY-DRESS?,1
?L38:	PRINTI "It fits loosely, masking your figure"
	PRINT PCR
	RTRUE
?L37:	FSET CHEMISE,EVERYBIT
	ZERO? GOWN-POINT \?L42
	EQUAL? PRSO,GOWN \?L42
	SET 'GOWN-POINT,1
	INC 'SCORE
	CALL CTPRINT,GOWN
	PRINTI " fits perfectly, the creamy silk bringing a glow to your cheeks. You comb your hair with your fingers and bite your lips to make them red"
	PRINT PCR
	RTRUE
?L42:	PRINTI "You don"
	CALL TRPRINT,PRSO
	RTRUE
?L21:	EQUAL? PRSA,V?REMOVE,V?TAKE-OFF \?L45
	FSET? PRSO,WORNBIT \?L45
	EQUAL? PRSO,DRESS \?L46
	FCLEAR PRSO,WORNBIT
	FCLEAR CHEMISE,EVERYBIT
	PRINTI "You take off"
	CALL TPRINT,DRESS
	PRINT PCR
	RTRUE
?L46:	EQUAL? PRSO,PANTS,SHIRT \?L49
	SET 'BOY-DRESS?,0
?L49:	FCLEAR PRSO,WORNBIT
	FCLEAR CHEMISE,EVERYBIT
	PRINTI "You remove"
	CALL TPRINT-PRSO
	PRINTI ", exposing your "
	EQUAL? PRSO,PANTS \?L52
	PRINTI "ankles"
	JUMP ?L55
?L52:	EQUAL? PRSO,SHIRT \?L54
	PRINTI "elbows"
	JUMP ?L55
?L54:	PRINTD CHEMISE
?L55:	PRINT PCR
	RTRUE
?L45:	EQUAL? PRSA,V?RIP /?L57
	EQUAL? PRSA,V?CUT \?L56
	CALL HELD?,DAGGER >STACK
	ZERO? STACK /?L56
?L57:	EQUAL? PRSO,DRESS \?L58
	LOC RAG >STACK
	ZERO? STACK \?L60
	MOVE RAG,PROTAGONIST
	EQUAL? WET-DRESS,WATER \?L62
	SET 'WET-RAG,WATER
	JUMP ?L65
?L62:	EQUAL? WET-DRESS,RUM \?L64
	SET 'WET-RAG,RUM
	JUMP ?L65
?L64:	SET 'WET-RAG,0
?L65:	FSET RAG,TOUCHBIT
	FSET? DRESS,MUNGBIT /?L66
	FSET DRESS,MUNGBIT
?L66:	PRINTI "You "
	CALL PRINT-ID,STR?333
	EQUAL? PRSA,V?CUT \?L69
	MOVE DAGGER,PROTAGONIST
	PRINTI "cut"
	JUMP ?L71
?L69:	PRINTI "rip"
?L71:	PRINTI " a large rag out of"
	CALL TRPRINT,DRESS
	RTRUE
?L60:	CALL HELD?,RAG >STACK
	ZERO? STACK \?L72
	PRINTI "There already is a rag around here somewhere"
	PRINT PCR
	RTRUE
?L72:	PRINT YOU-HAVE-ALREADY
	CALL ARPRINT,RAG
	RTRUE
?L58:	EQUAL? PRSO,GOWN \?L74
	CALL CTPRINT,GOWN
	PRINTI " is too fine to ruin"
	PRINT PCR
	RTRUE
?L74:	PRINTI "The fabric is too tightly woven"
	PRINT PCR
	RTRUE
?L56:	EQUAL? PRSA,V?TAKE \FALSE
	EQUAL? PRSO,PANTS,SHIRT \FALSE
	IN? PILE-OF-CLOTHES,HERE \FALSE
	CALL PERFORM,V?TAKE,PILE-OF-CLOTHES
	RTRUE

	.FUNCT RAG-F
	EQUAL? PRSA,V?SOAK \?L1
	EQUAL? HERE,BY-SHIP,LAGOON,SHALLOWS /?L5
	EQUAL? HERE,BEACH,MAIN-DECK \?L3
?L5:	CALL DIP-DRESS >STACK
	RSTACK
?L3:	CALL PROPOSE >STACK
	RSTACK
?L1:	CALL ADJ-USED,A?WET >STACK
	ZERO? STACK /?L7
	ZERO? WET-RAG \?L7
	PRINT YOU-CANT-SEE-ANY
	PRINTI "wet rag here"
	PRINT PCR
	RTRUE
?L7:	EQUAL? PRSA,V?EXAMINE \?L8
	ZERO? WET-RAG \?L9
	PRINTI "It is a fairly hefty scrap of fabric"
	PRINT PCR
	RTRUE
?L9:	CALL WET-DESC,RAG >STACK
	RSTACK
?L8:	EQUAL? PRSA,V?RIP \?L12
	CALL PRINT-ID,STR?334
	CALL WASTES >STACK
	RSTACK
?L12:	EQUAL? PRSA,V?TIE \?L13
	PRINTI "It won't stay tied"
	PRINT PCR
	RTRUE
?L13:	EQUAL? PRSA,V?PUT \?L14
	EQUAL? PRSI,GATE,FENCE \?L15
	CALL WASTES >STACK
	RSTACK
?L15:	EQUAL? PRSI,FUSE \FALSE
	CALL PROPOSE >STACK
	RSTACK
?L14:	EQUAL? PRSA,V?THROW \FALSE
	EQUAL? PRSI,FUSE \FALSE
	CALL PERFORM,V?THROW-OVER,RAG,FENCE
	RTRUE

	.FUNCT WET-DESC,OBJ
	PRINTI "The "
	PRINTD OBJ
	PRINTI " is soaked and dripping with "
	EQUAL? OBJ,RAG \?L4
	EQUAL? WET-RAG,RUM /?L3
?L4:	EQUAL? OBJ,DRESS \?L1
	EQUAL? WET-DRESS,RUM \?L1
?L3:	PRINTI "rum"
	JUMP ?L5
?L1:	EQUAL? OBJ,RAG \?L7
	EQUAL? WET-RAG,WATER /?L6
?L7:	EQUAL? OBJ,DRESS \?L5
	EQUAL? WET-DRESS,WATER \?L5
?L6:	PRINTI "water"
?L5:	PRINT PCR
	RTRUE

	.FUNCT CHEMISE-F
	EQUAL? PRSA,V?EXAMINE \?L1
	EQUAL? PRSO,CHEMISE \?L3
	FSET? CHEMISE,EVERYBIT \?L5
	PRINTI "It's covered by other clothes"
	PRINT PCR
	RTRUE
?L5:	CALL CTPRINT,CHEMISE
	PRINTI ", kneelength and sleeveless, clings damply to your legs and torso"
	FSET? CHEMISE,MUNGBIT \?L8
	PRINT TEAR
?L8:	PRINT PCR
	RTRUE
?L3:	EQUAL? PRSO,SHOES \FALSE
	PRINTI "They are dainty yet practical kidskin shoes"
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?LOOK-UNDER,V?LOOK-INSIDE \?L13
	EQUAL? PRSO,CHEMISE \?L14
	PRINTI "Just you and your "
	PRINTD UNMENTIONABLES
	PRINT PCR
	RTRUE
?L14:	PRINTI "Your feet are in"
	CALL TRPRINT,SHOES
	RTRUE
?L13:	EQUAL? PRSA,V?REMOVE,V?TAKE-OFF \?L17
	PRINTI "But"
	EQUAL? PRSO,SHOES \?L18
	CALL TPRINT-PRSO
	PRINTI " are so comfortable"
	JUMP ?L20
?L18:	PRINTI " that wouldn't be decent"
?L20:	PRINTR "!"
?L17:	EQUAL? PRSA,V?CUT,V?RIP \FALSE
	PRINT YOU-CANT
	PRINTI "bring yourself to ruin"
	CALL TRPRINT,CHEMISE
	CALL PRINT-ID,STR?335 >STACK
	RSTACK

	.FUNCT GARTER-F
	EQUAL? PRSA,V?WEAR \?L1
	ZERO? MUZZLED /?L3
	CALL PERFORM,V?TAKE,GARTER
	RTRUE
?L3:	FSET? PANTS,WORNBIT \?L5
	PRINTI "One doesn't wear"
	CALL APRINT,GARTER
	PRINTI " over "
	PRINTD PANTS
	PRINTR "!"
?L5:	FSET GARTER,WORNBIT
	MOVE GARTER,PROTAGONIST
	PRINTI "You slide"
	CALL TPRINT,GARTER
	PRINTI " up around your thigh"
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?TAKE,V?REMOVE \?L7
	ZERO? MUZZLED /?L7
	ZERO? CROC-SLEEP \?L8
	PRINTI "The reptile surges forward as you remove"
	CALL TPRINT,GARTER
	CALL JIGS-UP,STR?336 >STACK
	RSTACK
?L8:	SET 'MUZZLED,0
	FCLEAR GARTER,TRYTAKEBIT
	FSET GARTER,TAKEBIT
	MOVE GARTER,PROTAGONIST
	PRINTR "You slip it off the scaly snout."
?L7:	EQUAL? PRSA,V?TAKE \?L11
	FSET? GARTER,TOUCHBIT /?L12
	EQUAL? HERE,KITCHEN \?L12
	CALL ITAKE,0 >STACK
	EQUAL? STACK,M-FATAL,0 /?L12
	PRINTI "Taken.
   Lucy kisses "
	PRINTD HEAD
	PRINTI " and returns to the fire, humming"
	PRINT PCR
	RTRUE
?L12:	IN? GARTER,DAD \FALSE
	MOVE GARTER,PROTAGONIST
	PRINTR """Take it, dear,"" Papa says."
?L11:	EQUAL? PRSA,V?PUT-ON,V?PUT \?L16
	EQUAL? PRSI,GARTER \?L16
	IN? GARTER,PROTAGONIST /?L17
	PRINT YNH
	CALL TRPRINT,GARTER
	RTRUE
?L17:	EQUAL? P-PRSA-WORD,W?THROW \?L19
	EQUAL? PRSO,STONE \?L20
	CALL PERFORM,V?THROW,STONE,GARTER
	RTRUE
?L19:	EQUAL? PRSO,STONE \?L20
	FSET? GARTER,WORNBIT \?L21
	PRINTI "Not while you're wearing"
	CALL TRPRINT,GARTER
	RTRUE
?L21:	MOVE STONE,GARTER
	ZERO? PENULTIM-POINT \?L24
	SET 'PENULTIM-POINT,1
	INC 'SCORE
?L24:	PRINTI "You slip"
	CALL TPRINT,STONE
	PRINTI " into"
	CALL TRPRINT,GARTER
	RTRUE
?L20:	PRINTI "It falls through"
	CALL TRPRINT,GARTER
	RTRUE
?L16:	EQUAL? PRSA,V?KILL \?L28
	FSET? PRSO,ACTORBIT /?L29
	EQUAL? PRSO,CROC \?L28
?L29:	CALL PROPOSE >STACK
	RSTACK
?L28:	EQUAL? PRSA,V?SHOOT,V?THROW \?L30
	IN? STONE,GARTER \?L31
	ZERO? PRSI \?L33
	CALL PERFORM,V?SHOOT,STONE
	RTRUE
?L33:	CALL WASTES >STACK
	RSTACK
?L31:	ZERO? PRSI \?L37
	EQUAL? PRSA,V?THROW \?L37
	MOVE GARTER,HERE
	PRINTR "Thrown."
?L37:	EQUAL? PRSO,STONE \FALSE
	CALL DO-FIRST,STR?337,GARTER >STACK
	RSTACK
?L30:	EQUAL? PRSA,V?SSHOOT \?L41
	EQUAL? PRSO,GARTER \?L41
	CALL HELD?,STONE >STACK
	ZERO? STACK /?L41
	CALL PERFORM,V?SHOOT,PRSI,STONE
	RTRUE
?L41:	EQUAL? PRSA,V?EXAMINE \FALSE
	CALL CTPRINT,GARTER
	PRINTI " is "
	ZERO? MUZZLED /?L43
	PRINTI "stretched taut around the jaws of"
	CALL TPRINT,CROC
	PRINT PCR
	RTRUE
?L43:	PRINTI "made of abnormally strong, red, stretchy lace"
	PRINT PCR
	RTRUE

	.FUNCT UNMENTIONABLES-F
	PRINTI "Shh! Why do you think they're called "
	PRINTD UNMENTIONABLES
	PRINTR "?"

	.FUNCT RETICULE-F
	EQUAL? PRSA,V?PUT,V?REMOVE,V?DROP /?L3
	EQUAL? PRSA,V?PUT-UNDER,V?PUT-THROUGH,V?PUT-ON /?L3
	EQUAL? PRSA,V?THROW-TO,V?THROW-AT,V?THROW /?L3
	EQUAL? PRSA,V?GIVE \?L1
?L3:	EQUAL? PRSO,RETICULE \?L1
	PRINTI "A lady is never without her reticule"
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?PUT \?L4
	EQUAL? PRSO,RAPIER,COFFER \?L4
	CALL CTPRINT,PRSO
	PRINTI " won't fit in"
	CALL TRPRINT,RETICULE
	RTRUE
?L4:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "You and Mama made the little drawstring bag a few months before she passed on. It's amazing how much it can hold"
	PRINT PCR
	RTRUE

	.FUNCT BANKNOTE-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "This is"
	CALL TPRINT,BANKNOTE
	CALL IN-PACKAGE >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?POINT,V?WAVE \FALSE
	IN? BUTLER,HERE \FALSE
	FSET? BUTLER,DEADBIT /FALSE
	CALL BRIBE-BUTLER,PRSO >STACK
	RSTACK

	.FUNCT SALTS-F,PER=0
	EQUAL? PRSA,V?SMELL \?L1
	PRINTI "You jerk"
	CALL TPRINT,SALTS
	PRINTI " away from your nose after one brief ammoniac whiff. Your burning nostrils make you feel more alert"
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?WAVE \?L3
	EQUAL? HERE,DUNGEON \?L4
	FSET? HERO,DEADBIT \?L4
	CALL PERFORM,V?ALARM,HERO,SALTS
	RTRUE
?L4:	CALL PERFORM,V?SMELL,SALTS
	RTRUE
?L3:	EQUAL? PRSA,V?USE \?L7
	ZERO? PRSI \?L8
	CALL FIND-IN,HERE,ACTORBIT,STR?338 >PER
	EQUAL? PER,0,CRULLEY /?L10
	CALL PERFORM,V?ALARM,PER,SALTS
	RTRUE
?L10:	CALL PERFORM,V?SMELL,SALTS
	RTRUE
?L8:	FSET? PRSI,ACTORBIT \?L13
	CALL PERFORM,V?ALARM,PRSI,SALTS
	RTRUE
?L13:	PRINT HUH
	RTRUE
?L7:	EQUAL? PRSA,V?PUT-ON,V?PUT-UNDER \?L15
	FSET? PRSI,ACTORBIT \?L15
	CALL PERFORM,V?ALARM,PRSI,SALTS
	RTRUE
?L15:	EQUAL? PRSA,V?GIVE \?L16
	CALL PERFORM,V?ALARM,PRSI,SALTS
	RTRUE
?L16:	EQUAL? PRSA,V?SGIVE,V?ALARM \?L17
	EQUAL? PRSO,HERO \?L18
	CALL REVIVE-HERO >STACK
	RSTACK
?L18:	EQUAL? PRSO,ME \?L20
	CALL PERFORM,V?SMELL,SALTS
	RTRUE
?L20:	EQUAL? PRSO,BUTLER \?L21
	FSET? BUTLER,DEADBIT \?L21
	PRINT YOU-CANT
	PRINTI "wake him"
	PRINT PCR
	RTRUE
?L21:	EQUAL? PRSO,CRULLEY \?L22
	FSET? CRULLEY,DEADBIT \?L22
	SET 'AWAITING-REPLY,2
	CALL QUEUE,I-REPLY,2
	PRINTR "Are you sure that's really wise?"
?L22:	CALL PRONOUN
	PRINTI " doesn't need reviving"
	PRINT PCR
	RTRUE
?L17:	EQUAL? PRSA,V?EXAMINE \?L24
	PRINTI "You always carry your "
	PRINTD SALTS
	PRINTI ", for emergencies. There is a small tag on one side of them"
	PRINT PCR
	RTRUE
?L24:	EQUAL? PRSA,V?READ \FALSE
	PRINTR "It says, ""For cases of vapors, hysteria or collapse, revive persons with the smelling salts."""

	.FUNCT REVIVE-HERO
	FSET? HERO,DEADBIT \?L1
	INC 'SCORE
	FCLEAR HERO,DEADBIT
	PRINTI "You wave"
	CALL TPRINT,SALTS
	PRINTI " under Nicholas's nose. He stirs, sneezes and looks at you blearily. ""How --?"" he says, bewildered. ""Lafond, did he --?"" He "
	FSET? CHEMISE,EVERYBIT /?L3
	PRINTI "looks at you in growing horror, glancing from your chemise to your face, and "
?L3:	PRINTI "straightens. ""Darling, you are an angel, to have gone through all this and then rescue me. Your ravisher will not go unpunished."" He squares his shoulders. ""For my brother, his wife, and your honor, I will kill Jean Lafond."""
	CRLF
	IN? HERO,MANACLES \?L6
	SET 'AWAITING-REPLY,13
	CALL QUEUE,I-REPLY,2
	PRINT INDENT
	PRINTR "He tugs at his chains with a wry smile. ""But I must get free first. Have you the key?"""
?L6:	CALL NICK-RUNS-OFF >STACK
	RSTACK
?L1:	PRINTR "Jamison brushes you away, ""Thank you, but I'm not having the vapors."""

	.FUNCT BOTTLE-F
	EQUAL? PRSA,V?CLOSE,V?OPEN \?L1
	PRINTI "This is a squeezable bottle. You don't need to open or close it"
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?TAKE \?L3
	FSET? BOTTLE,TOUCHBIT /?L3
	CALL ITAKE,0 >STACK
	EQUAL? STACK,M-FATAL,0 /?L3
	INC 'SCORE
	PRINTI "Taken."
	CRLF
	CALL IS-THEFT? >STACK
	CALL PRINT-ID,STR?339,STACK >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?PUT,V?POUR \?L4
	EQUAL? PRSI,BOTTLE \?L4
	CALL PERFORM,V?FILL,BOTTLE,PRSO
	RTRUE
?L4:	EQUAL? PRSA,V?WRING,V?DRINK-FROM \?L5
	EQUAL? PRSO,BOTTLE \?L5
	CALL SQUEEZE-BOTTLE >STACK
	RSTACK
?L5:	EQUAL? PRSA,V?WRING,V?POUR-FROM \?L6
	EQUAL? PRSO,LAUD \?L6
	CALL SPECIFY-WHAT,STR?340,LAUD >STACK
	RSTACK
?L6:	EQUAL? PRSA,V?DRINK-FROM \?L7
	CALL PERFORM,V?WRING,LAUD,MOUTH
	RTRUE
?L7:	EQUAL? PRSA,V?FILL \?L8
	EQUAL? PRSI,BOTTLE \?L9
	CALL PERFORM,V?POUR,PRSI,PRSO
	RTRUE
?L9:	PRINT YOU-CANT
	PRINTI "get anything into"
	CALL TRPRINT,BOTTLE
	RTRUE
?L8:	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L12
	PRINTI "It's a small leather bottle, with a tiny label on one side"
	GRTR? LAUD-LEFT,0 \?L13
	PRINTI ". It appears to be almost empty"
?L13:	PRINT PCR
	RTRUE
?L12:	EQUAL? PRSA,V?READ \FALSE
	PRINTR "The label reads, ""Laudanum drops. Squeeze into a glass of wine to sleep free of pain and mental anguish."""

	.FUNCT LAUD-F
	EQUAL? PRSA,V?WRING,V?PUT,V?POUR /?L3
	EQUAL? PRSA,V?PUT-ON \?L1
?L3:	EQUAL? PRSO,LAUD \?L1
	CALL SQUEEZE-BOTTLE >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?TAKE \?L4
	PRINTI "If you intend to drink"
	CALL TPRINT,LAUD
	PRINTR ", say so."
?L4:	EQUAL? PRSA,V?DRINK,V?EAT \?L5
	CALL PERFORM,V?WRING,BOTTLE,ME
	RTRUE
?L5:	EQUAL? PRSO,LAUD \?L6
	CALL PERFORM-PRSA,BOTTLE,PRSI
	RTRUE
?L6:	EQUAL? PRSI,LAUD \FALSE
	CALL PERFORM-PRSA,PRSO,BOTTLE
	RTRUE

	.FUNCT SQUEEZE-BOTTLE
	EQUAL? PRSI,BOTTLE \?L1
	CALL IMPOSSIBLES >STACK
	RSTACK
?L1:	FSET? PRSI,ACTORBIT \?L3
	PRINT POLITE
	RTRUE
?L3:	EQUAL? PRSI,CROC \?L4
	CALL PERFORM,V?PUT,BOTTLE,CROC
	RTRUE
?L4:	LESS? LAUD-LEFT,3 \?L5
	EQUAL? HERE,LAFS-ROOM /?L5
	PRINTR "You stop, deciding you might need some later."
?L5:	DEC 'LAUD-LEFT
	GRTR? LAUD-LEFT,0 \FALSE
	MOVE BOTTLE,PROTAGONIST
	EQUAL? PRSI,ME \?L7
	CALL QUEUE,I-SLEEP,2
	PUTP ME,P?CONTENTS,POISONED
	PRINT SQUEEZE-DROPS
	PRINTI "into"
	CALL TPRINT,MOUTH
	PRINTI "."
	JUMP ?L15
?L7:	EQUAL? PRSI,FLAGON \?L11
	PUTP FLAGON,P?CONTENTS,POISONED
	CALL DOPE-WINE
	JUMP ?L15
?L11:	EQUAL? PRSI,PORK \?L12
	SET 'PORK-DOPED,1
	PRINT SQUEEZE-DROPS
	PRINTI "onto"
	CALL TPRINT,PORK
	PRINTI ". A patch of salt dissolves as"
	CALL TPRINT,LAUD
	PRINTI " absorbs into the meat."
	JUMP ?L15
?L12:	EQUAL? PRSI,GREEN-GLASS,BLUE-GLASS \?L13
	GETP PRSI,P?CONTENTS >STACK
	ADD STACK,POISONED >STACK
	PUTP PRSI,P?CONTENTS,STACK
	CALL DOPE-WINE
	JUMP ?L15
?L13:	PRINT SQUEEZE-DROPS
	PRINTI "into"
	CALL TPRINT-PRSI
	PRINTI "."
	FSET? PRSI,WEARBIT \?L15
	PRINTI " It evaporates quickly."
?L15:	ZERO? LAUD-LEFT \?L18
	PRINTI " From the feel of it, the bottle is now empty."
?L18:	CRLF
	RTRUE

	.FUNCT DOPE-WINE
	SET 'USED-LAUD,1
	PRINT SQUEEZE-DROPS
	PRINTI "into"
	CALL TPRINT-PRSI
	PRINTI "."
	IN? LAFOND,HERE \TRUE
	PRINTI " You sense Lafond hesitate, then continue primping."
	RTRUE

	.FUNCT JEWEL-F
	EQUAL? PRSA,V?WEAR /?L3
	EQUAL? PRSA,V?PUT-ON \?L1
	EQUAL? PRSI,ME \?L1
?L3:	CALL CTPRINT,JEWEL
	PRINTI " won't stay clasped"
	PRINT PCR
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \?L4
	PRINTI "All diamonds winking fire, tears of sapphire and crushed rubies in an oval setting, it is a pity that the clasp of"
	CALL TPRINT,JEWEL
	PRINTI " has broken. The gold pin at the back swings about uselessly"
	PRINT PCR
	RTRUE
?L4:	EQUAL? PRSA,V?FIX \FALSE
	PRINTR "That will have to be done by a goldsmith."

	.FUNCT HAT-F,OARG=0
	ZERO? OARG /?L1
	FSET? HAT,EVERYBIT \FALSE
	EQUAL? OARG,M-DESC? /TRUE
	PRINT INDENT
	PRINTI "An expensive hat is hanging on"
	CALL APRINT,KNOB
	PRINTI "."
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \?L9
	CALL NOUN-USED,W?QUILL,HAT >STACK
	ZERO? STACK /?L10
	PRINTR "It's a curling ostrich plume."
?L10:	PRINTR "It is a crimson tricorne with a curling ostrich plume stuck in the crown."
?L9:	EQUAL? PRSA,V?WEAR,V?TAKE \?L13
	CALL NOUN-USED,W?QUILL,HAT >STACK
	ZERO? STACK /?L14
	CALL CTPRINT,HAT
	PRINTR " looks so drab without its plume that you cannot bear to."
?L14:	FSET? HAT,EVERYBIT \FALSE
	FCLEAR KNOB,DEADBIT
	FSET KNOB,EVERYBIT
	FCLEAR HAT,EVERYBIT
	MOVE HAT,PROTAGONIST
	FSET HAT,TOUCHBIT
	EQUAL? PRSA,V?WEAR \?L17
	FSET HAT,WORNBIT
?L17:	CALL KNOB-CAUSES-TINGLE,STR?341 >STACK
	RSTACK
?L13:	EQUAL? PRSA,V?TAKE-OFF,V?REMOVE \?L21
	FSET? HAT,WORNBIT \?L21
	FCLEAR HAT,WORNBIT
	PRINTI "Doffed"
	PRINT PCR
	RTRUE
?L21:	EQUAL? PRSA,V?PUT-ON \FALSE
	EQUAL? PRSO,HAT \FALSE
	EQUAL? PRSI,HEAD,ME \?L23
	CALL PERFORM,V?WEAR,HAT
	RTRUE
?L23:	FSET? PRSI,ACTORBIT \?L25
	FSET? PRSI,DEADBIT \?L26
	PRINTR "It slides off."
?L26:	CALL CTPRINT,HAT
	PRINTI " doesn't go with what "
	EQUAL? PRSI,LUCY \?L29
	PRINTI "s"
?L29:	PRINTR "he's wearing."
?L25:	CALL WASTES >STACK
	RSTACK

	.FUNCT KNOB-CAUSES-TINGLE,STRING
	PRINT STRING
	PRINTI " knob on the wall, a low vibration tingles up your legs from the floor"
	PRINT PCR
	RTRUE

	.FUNCT CRULLEY-F,OARG=0,X
	ZERO? OARG /?L1
	EQUAL? OARG,M-DESC? /TRUE
	PRINT INDENT
	EQUAL? HERE,BEACH \?L6
	PRINTD CRULLEY
	PRINTI " stands"
	GRTR? LAFOND-CTR,6 \?L8
	PRINTI ", pistol ready,"
	PRINT HALFWAY
	RTRUE
?L8:	PRINTI " with the dragoons."
	RTRUE
?L6:	EQUAL? HERE,CABIN \FALSE
	PRINTD CRULLEY
	PRINTI " the pirate"
	FSET? CRULLEY,DEADBIT \?L12
	PRINTI " lies unconscious on the floor."
	RTRUE
?L12:	PRINTI ", hook raised, leering, comes toward you."
	RTRUE
?L1:	EQUAL? CRULLEY,WINNER \?L16
	FSET? CRULLEY,DEADBIT \?L17
	PRINT DOESNT-RESPOND
	RTRUE
?L17:	EQUAL? PRSA,V?TELL-ABOUT \?L19
	EQUAL? PRSO,ME \?L19
	CALL NOUN-USED,W?HOOK,CRULLEY >STACK
	ZERO? STACK /?L20
	PRINTI "He snarls at the memory, ""'Twere bit off by a monster crocodile."""
	CRLF
	JUMP ?L26
?L20:	EQUAL? PRSI,LAFOND \?L22
	PRINTI """'E's a hard 'un, who won't take no guff. But 'e pays well"
	FSET? BEACH,TOUCHBIT /?L23
	PRINTI " -- er, so I hear"
?L23:	PRINTI "."""
	CRLF
	JUMP ?L26
?L22:	PRINTD CRULLEY
	PRINTI " ignores you"
	PRINT PCR
?L26:	CALL STOP >STACK
	RSTACK
?L19:	EQUAL? PRSA,V?HELLO \?L27
	PRINTR """Har-har."""
?L27:	EQUAL? PRSA,V?KISS \?L28
	EQUAL? PRSO,ME \?L28
	PRINTR """Wi' a wannion! I likes me ladies forward!"""
?L28:	CALL COM-CHECK,CRULLEY >X
	ZERO? X /FALSE
	EQUAL? X,M-FATAL \TRUE
	RFALSE
?L16:	EQUAL? PRSA,V?CUT,V?KILL \?L34
	FSET? CRULLEY,DEADBIT \?L35
	CALL PRINT-ID,STR?342
	CALL MAN-IS-DOWN >STACK
	RSTACK
?L35:	ZERO? PRSI /?L38
	EQUAL? PRSI,HANDS \?L37
?L38:	EQUAL? P-PRSA-WORD,W?SLAP \?L39
	PRINTI "Slap! The pirate fingers the red welt left by"
	CALL TPRINT,HANDS
	PRINTI ", and laughs."
	CRLF
	CALL PRINT-ID,STR?343 >STACK
	RSTACK
?L39:	IN? COFFER,PROTAGONIST \?L41
	ZERO? PRSI \?L41
	CALL PERFORM,V?KILL,CRULLEY,COFFER
	RTRUE
?L41:	IN? RAPIER,PROTAGONIST \?L42
	ZERO? PRSI \?L42
	CALL PERFORM,V?KILL,CRULLEY,RAPIER
	RTRUE
?L42:	CALL PRINT-ID,STR?344
	CALL CANT-HURT,STR?345 >STACK
	RSTACK
?L37:	EQUAL? PRSI,COFFER \?L44
	INC 'ATTACK-C
	SET 'CRULLEY-HIT,1
	PRINTI "With all your strength you whack the pirate"
	PRINT OVER-HEAD
	CALL TRPRINT,PRSI
	CALL PRINT-ID,STR?346
	MOVE PROTAGONIST,HERE
	CALL DEQUEUE,I-CRULLEY
	CALL I-CRULLEY >STACK
	RSTACK
?L44:	EQUAL? PRSI,RAPIER \?L45
	FSET? CRULLEY,EVERYBIT \?L46
	FSET? CRULLEY,MUNGBIT \?L48
	PRINT YOU-CANT
	PRINTI "very well reach"
	CALL TPRINT,CRULLEY
	PRINTI " when he's down in"
	CALL TRPRINT,WELL
	CALL PRINT-ID,STR?347 >STACK
	RSTACK
?L48:	CALL DEQUEUE,I-CDUNG
	INC 'SCORE
	SET 'CRULLEY-CTR,1
	CALL QUEUE,I-CCLIMBS-UP,2
	FSET CRULLEY,MUNGBIT
	FSET CRULLEY,NDESCBIT
	MOVE CRULLEY,TRAP
	REMOVE WHIP
	PRINTI "You flick"
	CALL TPRINT,RAPIER
	PRINTI " across his chest, barely scratching him. He cries, ""Avast me! Pricked by a woman!"" and trips into"
	CALL TRPRINT,TRAP
	PRINT INDENT
	PRINTI "You peer down the hole to find "
	PRINTD CRULLEY
	PRINTI " hanging in midair, his hook caught in the rocks a few yards down. He curses and starts to climb up the sheer slimy walls of"
	CALL TRPRINT,WELL
	CALL PRINT-ID,STR?348 >STACK
	RSTACK
?L46:	FSET CRULLEY,EVERYBIT
	PRINTD CRULLEY
	PRINTI " seems more amazed than frightened of your attack, guessing correctly that you hardly know the tip from the hilt of"
	CALL TPRINT,RAPIER
	PRINTI ". He steps sideways in surprise, so he stands at"
	PRINT THE-EDGE
	CALL TRPRINT,TRAP
	CALL PRINT-ID,STR?349 >STACK
	RSTACK
?L45:	PRINTI "You slap"
	CALL TPRINT,CRULLEY
	PRINT OVER-HEAD
	CALL TPRINT-PRSI
	PRINTI ", to no effect"
	PRINT PCR
	CALL PRINT-ID,STR?350 >STACK
	RSTACK
?L34:	EQUAL? PRSA,V?KISS \?L53
	SET 'WINNER,CRULLEY
	CALL PERFORM,V?KISS,ME
	SET 'WINNER,PROTAGONIST
	RTRUE
?L53:	EQUAL? PRSA,V?KICK \?L54
	CALL PRINT-ID,STR?351
	CALL CANT-HURT,STR?352 >STACK
	RSTACK
?L54:	EQUAL? PRSA,V?PUT-ON,V?PUT,V?THROW /?L56
	EQUAL? PRSA,V?THROW-AT \?L55
?L56:	FSET? CRULLEY,MUNGBIT \?L57
	EQUAL? PRSO,RAPIER \?L59
	CALL PERFORM,V?PUT,RAPIER,TRAP
	RTRUE
?L59:	EQUAL? PRSO,RETICULE /FALSE
	CALL PRINT-ID,STR?353
	REMOVE PRSO
	PRINTD CRULLEY
	PRINTI " curses as"
	CALL TPRINT-PRSO
	PRINTI " sails past him down into"
	CALL TRPRINT,WELL
	RTRUE
?L57:	EQUAL? PRSO,COFFER \FALSE
	CALL PERFORM,V?KILL,CRULLEY,PRSO >STACK
	RSTACK
?L55:	EQUAL? PRSA,V?SEARCH \?L65
	FSET? CRULLEY,DEADBIT \?L66
	PRINTR "And dirty your lily hands? Never!"
?L66:	FSET? CRULLEY,MUNGBIT \?L68
	CALL CANT-REACH,CRULLEY >STACK
	RSTACK
?L68:	PRINTR "You are uncomfortably sure he would love to have you frisk him."
?L65:	EQUAL? PRSA,V?GIVE \?L70
	EQUAL? PRSO,BANKNOTE \?L70
	EQUAL? HERE,BEACH /?L70
	PRINTI "He takes it, smiling blackly"
	PRINT PCR
	RTRUE
?L70:	EQUAL? PRSA,V?EXAMINE \FALSE
	CALL NOUN-USED,W?HOOK,CRULLEY >STACK
	ZERO? STACK /?L72
	PRINTR "The hook replaces one of his hands."
?L72:	PRINTI "The pirate's unsavory face is crisscrossed with scars, and those not from shaving nicks, to judge by his scruffy beard. A hook replaces one of his hands at the end of a torn black sleeve"
	PRINT PCR
	RTRUE

	.FUNCT I-CRULLEY
	PRINT INDENT
	ZERO? ATTACK-C \?L1
	FSET? CRULLEY,TOUCHBIT /?L1
	CALL QUEUE,I-MEET-HERO,2
	FSET CRULLEY,TOUCHBIT
	MOVE CRULLEY,CABIN
	CALL QUEUE,I-CRULLEY,-1
	FSET DOOR,MUNGBIT
	PRINTI "Crash! You whirl around to see"
	CALL TPRINT,DOOR
	PRINTI " shatter, kicked by a hulking man, his twisted visage blackened with soot and blood. "
	JUMP ?L3
?L1:	EQUAL? ATTACK-C,1 \?L3
	PRINTI "The pirate stumbles, dizzy. "
?L3:	EQUAL? ATTACK-C,2 \?L5
	FSET CRULLEY,DEADBIT
	PRINT STUNNED-THE-SAILOR
	PRINT PCR
	JUMP ?L7
?L5:	CALL CRULLEY-SAYS
?L7:	INC 'CRULLEY-CTR
	RETURN CRULLEY-CTR

	.FUNCT CRULLEY-SAYS
	PRINTI """"
	GET MENACES,CRULLEY-CTR >STACK
	PRINT STACK
	PRINTI ","" "
	EQUAL? ATTACK-C,1 \?L1
	PRINTI "slurs"
	JUMP ?L3
?L1:	PRINTI "sniggers"
?L3:	PRINTI " the pirate"
	EQUAL? CRULLEY-CTR,1 \?L4
	PRINTI ". His breath is heavy with rum"
	JUMP ?L6
?L4:	RANDOM 100 >STACK
	LESS? 60,STACK /?L6
	PRINTI ", advancing toward you"
?L6:	PRINT PCR
	RTRUE

	.FUNCT I-OVERHEAR-CRULLEY
	EQUAL? HERE,CREWS-QUARTERS \FALSE
	SET 'HEARD-CRULLEY,1
	FSET ANCHOR,MUNGBIT
	FSET LEVER,MUNGBIT
	CALL QUEUE,I-SEE-CRULLEY-ESCAPE,20
	CALL QUEUE,I-LOOK-SEA,10
	PRINT INDENT
	PRINTI """I gotta let"
	CALL TPRINT,LAFOND
	PRINTI " know 'e's comin'."""
	CALL TPRINT,CRULLEY
	PRINTI " stands on deck above, talking to himself, his voice floating down through"
	CALL APRINT,GRATE
	PRINTI " in"
	CALL TPRINT,CEILING
	PRINTI ". ""First, I do in the mates aboard-ship, with this and t'other mischief,"" he grunts, and you hear a snapping noise, like a taut rope being cut. ""Now to warn the boss and collect me pay. Off I go, har."" He dives into"
	CALL TRPRINT,SEA
	RTRUE

	.FUNCT I-SEE-CRULLEY-ESCAPE
	CALL SHIP-BOARD,HERE >STACK
	ZERO? STACK /?L1
	CALL INNER-DECK,HERE >STACK
	ZERO? STACK \?L1
	PRINT INDENT
	PRINTI "Your eyes are drawn to a flicker of light off the sea. Squinting, you see a man swimming to shore, moonlight flashing off his hook."
	EQUAL? HERE,POOP,QUARTERDECK,MAIN-DECK /?L5
	EQUAL? HERE,FOCSLE \?L3
?L5:	PRINTI " A wisp of breeze brings an odor of onions and rum, and the occasional gargling chuckle, ""...mischief, har...reefs."""
?L3:	CRLF
	RTRUE
?L1:	CALL QUEUE,I-SEE-CRULLEY-ESCAPE,3 >STACK
	RSTACK

	.FUNCT I-CDUNG
	LESS? CRULLEY-CTR,7 \?L1
	PRINT INDENT
	PRINTD CRULLEY
	EQUAL? CRULLEY-CTR,1 \?L3
	PRINTI " steps leering out of the shadows and"
?L3:	PRINTI " cracks"
	CALL TPRINT,WHIP
	PRINTI " near you, hopping you towards the open "
	PRINTD TRAP
	PRINTI ". """
	ZERO? CRULLEY-HIT /?L6
	EQUAL? CRULLEY-CTR,1 \?L6
	CALL QUEUE,I-REPLY,2
	SET 'AWAITING-REPLY,17
	PRINTI "Come to hit me agin, are ye?"
	JUMP ?L8
?L6:	SET 'AWAITING-REPLY,2
	CALL QUEUE,I-REPLY,2
	CALL PICK-ONE,ABUSES >STACK
	PRINT STACK
?L8:	PRINTI """"
	CRLF
	JUMP ?L9
?L1:	PRINT INDENT
	PRINTD CRULLEY
	PRINTI " snaps"
	CALL TPRINT,WHIP
	PRINTI " around your neck, jerking you sideways and down through"
	CALL TPRINT,TRAP
	PRINTI "."
	CALL PRINT-ID,STR?354
	CALL JIGS-UP,FALL-TO-BOTTOM
?L9:	INC 'CRULLEY-CTR
	RETURN CRULLEY-CTR

	.FUNCT I-CCLIMBS-UP
	CALL QUEUE,I-CCLIMBS-UP,-1
	INC 'CRULLEY-CTR
	EQUAL? CRULLEY-CTR,10 \?L1
	SET 'CRULLEY-BACK,1
	FCLEAR CRULLEY,NDESCBIT
	CALL DEQUEUE,I-CCLIMBS-UP
	EQUAL? HERE,DUNGEON /?L3
	FCLEAR CRULLEY,MUNGBIT
	MOVE CRULLEY,DUNGEON
	RFALSE
?L3:	FSET? TRAP,OPENBIT /?L5
	PRINT INDENT
	PRINTI "Roaring with anger,"
	CALL TPRINT,CRULLEY
	PRINTI " slaps"
	CALL TPRINT,TRAP
	PRINTI " back on its hinges and"
	JUMP ?L6
?L5:	PRINT INDENT
	PRINTD CRULLEY
?L6:	PRINTI " leaps out of"
	CALL TPRINT,WELL
	PRINTI ", seizing you."
	CALL PRINT-ID,STR?355
	CALL JIGS-UP,FALL-TO-BOTTOM >STACK
	RSTACK
?L1:	RANDOM 100 >STACK
	LESS? 50,STACK /FALSE
	EQUAL? HERE,DUNGEON \FALSE
	PRINT INDENT
	PRINTI "Sounds of scraping hook against stone and curses echo out of"
	CALL TPRINT,WELL
	FSET? TRAP,OPENBIT /?L8
	PRINTI ", muffled by"
	CALL TPRINT,TRAP
?L8:	PRINT PCR
	RTRUE

	.FUNCT WHIP-F
	EQUAL? PRSA,V?TAKE \FALSE
	PRINTD CRULLEY
	PRINTI " snaps"
	CALL TPRINT,WHIP
	PRINTR " near you. ""Get away wit' ye."""

	.FUNCT DAVIS-F
	EQUAL? PRSA,V?MUNG,V?KICK,V?KILL /?L3
	EQUAL? PRSA,V?KISS \?L1
?L3:	PRINTD DAVIS
	PRINTR " dodges."
?L1:	EQUAL? PRSA,V?EXAMINE \?L4
	PRINTD DAVIS
	PRINTR " is ugly with fear."
?L4:	EQUAL? DAVIS,WINNER \FALSE
	CALL FAILS-TO-NOTICE >STACK
	RSTACK

	.FUNCT COOKIE-F,OARG=0,X
	ZERO? OARG /?L1
	EQUAL? OARG,M-DESC? /TRUE
	PRINT INDENT
	EQUAL? HERE,GALLEY \?L6
	PRINTI "An entirely bald man sits here, carving into his peg leg"
	JUMP ?L19
?L6:	ZERO? COOKIE-FIGHTING-CROC /?L8
	PRINTI "The pool is roily with the writhing bodies of"
	CALL TPRINT,COOKIE
	PRINTI " and"
	CALL TPRINT,CROC
	JUMP ?L19
?L8:	CALL QUEUED?,I-ENDGAME >STACK
	ZERO? STACK /?L9
	EQUAL? HERE,BEACH \?L9
	FSET? COOKIE,DEADBIT \?L10
	PRINTI "Lucy cleans the sand from Quick's quiescent face, as Papa "
	FSET? LAFOND,DEADBIT \?L12
	PRINTI "sneaks up the cliff stairs"
	JUMP ?L19
?L12:	PRINTI "stands nearby"
	IN? GARTER,DAD \?L19
	PRINTI ", holding"
	CALL TPRINT,GARTER
	JUMP ?L19
?L10:	PRINTD COOKIE
	PRINTI ", Lucy and your father are moving towards"
	CALL TPRINT,SKIFF
	JUMP ?L19
?L9:	PRINTD COOKIE
	PRINTI " chews anxiously at a cheroot"
?L19:	PRINTI "."
	RTRUE
?L1:	EQUAL? COOKIE,WINNER \?L20
	FSET? COOKIE,DEADBIT \?L21
	PRINT DOESNT-RESPOND
	RTRUE
?L21:	EQUAL? PRSA,V?READ \?L23
	PRINTR """I can't read! I'm a cook, not a gentleman!"""
?L23:	EQUAL? PRSA,V?HELLO \?L24
	PRINTI """Hullo -- boy!"" He winks at you"
	PRINT PCR
	RTRUE
?L24:	EQUAL? PRSA,V?SAVE-SOMETHING,V?HELP \?L25
	EQUAL? HERE,GALLEY \?L26
	PRINTI """Eh? Don't be panicking. We'll be fine."" He carves a smile into his leg"
	PRINT PCR
	RTRUE
?L26:	PRINTD COOKIE
	PRINTR " grumbles, ""What d'ye think I'm trying to do!"""
?L25:	EQUAL? PRSA,V?FIX \?L29
	EQUAL? PRSO,DAGGER \?L29
	PRINTR """I never was able to sharpen that dagger."""
?L29:	EQUAL? PRSA,V?TELL-ABOUT \?L30
	EQUAL? PRSO,ME \?L30
	EQUAL? PRSI,HERO \?L31
	IN? HERO,MANACLES \?L33
	PRINTI """I'm tryin' to find him!"""
	CRLF
	JUMP ?L39
?L33:	PRINTI """The Cap'n? I been with him since the war. Then came Lafond."""
	CRLF
	JUMP ?L39
?L31:	EQUAL? PRSI,COOKIE \?L36
	PRINTI """'Rodney Quick's me name, cookin's me game.
Lost me leg in sixty-eight, 'tis why I bake.
Losin' me hearin' in every fight, but I've got me sight --
And come our Good Lord's 1701, I'll lose me life to a ruffian's gun.'
-- Old dame told me that. Leastways, I've several years left."""
	CRLF
	JUMP ?L39
?L36:	EQUAL? PRSI,LAFOND \?L37
	PRINTI """He murdered Cap'n's brother and family these three year'n past. Cap'n's been searching for a time to avenge the dead ones, and now he's found it."""
	CRLF
	JUMP ?L39
?L37:	EQUAL? PRSI,CRULLEY \?L38
	PRINTI """Don't trust 'im. Never 'ave."""
	CRLF
	JUMP ?L39
?L38:	PRINTD COOKIE
	PRINTI " cocks an ear, ""Eh, what's that?"""
	CRLF
?L39:	CALL STOP >STACK
	RSTACK
?L30:	EQUAL? PRSA,V?GIVE \?L40
	EQUAL? PRSO,ME \?L40
	IN? RAPIER,COOKIE \?L40
	CALL PERFORM,V?TAKE,RAPIER
	RTRUE
?L40:	EQUAL? PRSA,V?FOLLOW \?L41
	EQUAL? PRSO,ME \?L41
	PRINTI """Foller you?"
	EQUAL? HERE,GALLEY /?L42
	PRINTI " Anywheres"
?L42:	PRINTR "!"""
?L41:	EQUAL? PRSA,V?TAKE \?L45
	EQUAL? PRSO,PAIR \?L45
	EQUAL? HERE,X-ROOM \?L45
	PRINTR """No, lass. A lady don't use guns, and I've no need for one."""
?L45:	CALL COM-CHECK,COOKIE >X
	ZERO? X /FALSE
	EQUAL? X,M-FATAL \TRUE
	RFALSE
?L20:	EQUAL? PRSA,V?EXAMINE \?L51
	PRINTD COOKIE
	PRINTR " is a grizzled old man with a peg-leg."
?L51:	EQUAL? PRSA,V?TELL-ABOUT \?L52
	CALL NOUN-USED,W?GUNPOW,SUPPLIES >STACK
	ZERO? STACK /?L53
	PRINTR """Clam chowder? Never make it -- too fancy."""
?L53:	EQUAL? PRSI,REEFS \?L55
	PRINTR """We dropped the sea anchor -- no need to fear."""
?L55:	EQUAL? PRSI,SUPPLIES \?L56
	PRINTR """Aye, you must mean the supplies in the hold. Yep, that's where we store them."""
?L56:	EQUAL? PRSI,FIRE,HOLD \?L57
	PRINTR """Fire for the cold? I think it be too warm..."""
?L57:	EQUAL? PRSI,FUSE \?L58
	PRINTR """Lose sommat? I be always losing things. Think there be thieves aboard."""
?L58:	EQUAL? PRSI,HERO \FALSE
	ZERO? COOKIE-FIGHTING-CROC /?L60
	CALL FAILS-TO-NOTICE >STACK
	RSTACK
?L60:	CALL HELD?,HERO,DUNGEON >STACK
	ZERO? STACK /?L62
	PRINTI """Well, show me, lass!"" he grumbles"
	PRINT PCR
	RTRUE
?L62:	PRINTI """He's a fine man, is Cap'n,"" he smiles"
	PRINT PCR
	RTRUE
?L52:	EQUAL? PRSA,V?KISS \?L65
	PRINTR """Nah, me pretty, ye belong to Cap'n."""
?L65:	EQUAL? PRSA,V?GIVE \?L66
	EQUAL? PRSO,BANKNOTE \?L66
	PRINTI """I hain't no need fer that kind of money,"" he waves away your offer"
	PRINT PCR
	RTRUE
?L66:	EQUAL? PRSA,V?CUT,V?MUNG,V?KILL \FALSE
	FSET? COOKIE,DEADBIT \?L68
	EQUAL? PRSA,V?MUNG,V?KILL /?L70
	PUSH 0
	JUMP ?L71
?L70:	PUSH 1
?L71:	CALL PRINT-ID,STR?356,STACK
	EQUAL? PRSA,V?CUT /?L72
	PUSH 0
	JUMP ?L73
?L72:	PUSH 1
?L73:	CALL PRINT-ID,STR?357,STACK
	CALL MAN-IS-DOWN >STACK
	RSTACK
?L68:	PRINTI "He holds you off, ""'Ere now, there's no call for that!"""
	CRLF
	EQUAL? PRSA,V?MUNG,V?KILL /?L75
	PUSH 0
	JUMP ?L76
?L75:	PUSH 1
?L76:	CALL PRINT-ID,STR?358,STACK
	EQUAL? PRSA,V?CUT /?L77
	PUSH 0
	JUMP ?L78
?L77:	PUSH 1
?L78:	CALL PRINT-ID,STR?359,STACK >STACK
	RSTACK

	.FUNCT I-COOKIE,FIRST-MOVE=0
	ZERO? FIRST-MOVE /?L1
	SET 'COOKIE-LOOKING,0
	SET 'QUESTIONER,COOKIE
	SET 'AWAITING-REPLY,10
	CALL QUEUE,I-REPLY,2
	ZERO? CLOCK-WAIT /?L3
	PUSH 1
	JUMP ?L5
?L3:	PUSH 2
?L5:	CALL QUEUE,I-COOKIE,STACK
	MOVE COOKIE,HERE
	FSET COOKIE,MUNGBIT
	SET 'CRULLEY-CTR,0
	PRINT INDENT
	PRINTD COOKIE
	PRINTI " rushes up to you, looking worried. ""Miss, we must find the Cap'n. Have ye any idea where to look?"""
	CRLF
	JUMP ?L13
?L1:	IN? COOKIE,HERE /?L6
	CALL DEQUEUE,I-COOKIE
	JUMP ?L13
?L6:	EQUAL? REACTION,REACTION-POSITIVE /?L8
	EQUAL? PRSA,V?WALK \?L7
?L8:	PRINT INDENT
	PRINTD COOKIE
	PRINTI " grins broadly, ""I knew we could depend on you, lass. Lead on!"""
	CRLF
	JUMP ?L13
?L7:	EQUAL? CRULLEY-CTR,2 \?L9
	MOVE COOKIE,LIBRARY
	EQUAL? REACTION,REACTION-NEGATIVE \?L10
	PRINT INDENT
	PRINTI """Hell and damnation, I was afraid of that"
	JUMP ?L12
?L10:	PRINT INDENT
	PRINTI "He harrumphs. ""So ye do not care fer him after all"
?L12:	PRINTI "!"" "
	PRINTD COOKIE
	PRINTI " orders the men to search, moving off himself.
"
	JUMP ?L13
?L9:	SET 'QUESTIONER,COOKIE
	SET 'AWAITING-REPLY,10
	CALL QUEUE,I-REPLY,2
	CALL QUEUE,I-COOKIE,1
	PRINT INDENT
	PRINTD COOKIE
	PRINTI " urges you, ""Think agin. Any idea?"""
	CRLF
?L13:	INC 'CRULLEY-CTR
	RETURN CRULLEY-CTR

	.FUNCT CREW-F
	EQUAL? CREW,WINNER \?L1
	EQUAL? PRSA,V?HELLO \?L3
	PRINTI "He grins at you toothlessly"
	PRINT PCR
	JUMP ?L14
?L3:	ZERO? ENDGAME /?L5
	EQUAL? PRSA,V?FIND,V?WHERE \?L5
	EQUAL? PRSO,HERO,COOKIE \?L5
	CALL PERFORM,V?TELL-ABOUT,ME,PRSO
	RTRUE
?L5:	EQUAL? PRSA,V?TELL-ABOUT \?L6
	EQUAL? PRSO,ME \?L6
	ZERO? ENDGAME /?L7
	EQUAL? PRSI,HERO,COOKIE \?L7
	EQUAL? PRSI,COOKIE \?L9
	PRINTI """'E went"
	JUMP ?L11
?L9:	PRINTI """Cookie be"
?L11:	PRINTI " a-lookin' for Cap'n."""
	CRLF
	JUMP ?L14
?L7:	EQUAL? PRSI,LAFOND \?L12
	PRINTI """'E be an evil man, I do hear."""
	CRLF
	JUMP ?L14
?L12:	CALL FAILS-TO-NOTICE
	JUMP ?L14
?L6:	PRINTI """I'm busy. Do it yerself, boy."" He cuffs you aside."
	CRLF
?L14:	CALL STOP >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTD HERO
	PRINTI "'s crew are a ragged, toothless bunch, all sporting jagged scars. Despite their abhorrent appearances, they call friendlily to each other"
	PRINT PCR
	RTRUE

	.FUNCT LUCY-F,OARG=0
	ZERO? OARG /?L1
	EQUAL? OARG,M-DESC? /TRUE
	EQUAL? HERE,KITCHEN \FALSE
	PRINT INDENT
	FSET? LUCY,TOUCHBIT \?L8
	PRINTD LUCY
	JUMP ?L10
?L8:	PRINTI "A blond woman"
?L10:	CALL RUNNING?,I-LUCY >STACK
	ZERO? STACK /?L11
	PRINTI " stands talking to you"
	JUMP ?L13
?L11:	PRINTI " huddles alone by the fire, as if cold"
?L13:	PRINTI "."
	RTRUE
?L1:	EQUAL? LUCY,WINNER \?L15
	EQUAL? PRSA,V?TELL-ABOUT \?L16
	EQUAL? PRSO,ME \?L16
	CALL NOUN-USED,W?LIBRARY,HOUSE >STACK
	ZERO? STACK /?L18
	PRINTI """I ain't allowed in that wing of"
	CALL TRPRINT,HOUSE
	JUMP ?L21
?L18:	EQUAL? PRSI,LAFOND \?L20
	PRINTI """He's a regular lout who don't like my cooking."""
	CRLF
	JUMP ?L21
?L20:	CALL FAILS-TO-NOTICE
?L21:	CALL STOP >STACK
	RSTACK
?L16:	EQUAL? PRSA,V?HELLO \?L22
	PRINTI "She smiles"
	PRINT PCR
	RTRUE
?L22:	EQUAL? PRSA,V?KISS \?L23
	EQUAL? PRSO,ME \?L23
	PRINTI """I hardly know you!"" she gasps."
	CRLF
	CALL PRINT-ID,STR?360 >STACK
	RSTACK
?L23:	CALL COM-CHECK,LUCY >OARG
	ZERO? OARG /FALSE
	EQUAL? OARG,M-FATAL \TRUE
	RFALSE
?L15:	EQUAL? PRSA,V?TELL-ABOUT \?L29
	EQUAL? PRSI,DAD \?L29
	FSET? DAD,TOUCHBIT \?L30
	PRINTR """Yes, he told me."""
?L30:	SET 'AWAITING-REPLY,2
	CALL QUEUE,I-REPLY,2
	PRINTR "She yelps, ""Dear Dimsy, how can I save him?"""
?L29:	EQUAL? PRSA,V?GIVE \?L33
	EQUAL? PRSO,GARTER \?L34
	FSET? GARTER,INVISIBLE /?L34
	PRINTD LUCY
	PRINTR " frowns. ""No, you silly boy! Give that to Dimsford!"""
?L34:	EQUAL? PRSO,BANKNOTE \FALSE
	PRINTD LUCY
	PRINTI " slaps you hard across the face. ""I'm not that sort of girl!"""
	CRLF
	CALL PRINT-ID,STR?361 >STACK
	RSTACK
?L33:	EQUAL? PRSA,V?LISTEN \?L38
	CALL RUNNING?,I-LUCY >STACK
	ZERO? STACK /?L39
	PRINTR "You are listening to her!"
?L39:	PRINTI "She talks a lot, but doesn't say much"
	PRINT PCR
	RTRUE
?L38:	EQUAL? PRSA,V?ASK-FOR \?L42
	EQUAL? PRSI,GARTER \?L42
	CALL PERFORM,V?TAKE,GARTER
	RTRUE
?L42:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "Lucy is a very pretty woman, a few years your senior, her yellow hair neatly arranged. She wears a cook's apron"
	PRINT PCR
	RTRUE

	.FUNCT I-LUCY
	FCLEAR GARTER,INVISIBLE
	CALL THIS-IS-IT,GARTER
	PRINT INDENT
	PRINTI """I haven't found Lafond's papers, I'm watched too closely. Tell Dimsford that I -- I'm scared, and I want him to come get me. Give this to him -- he'll recognize it."" Lucy slides"
	CALL APRINT,GARTER
	PRINTI " down her leg and holds it out to you"
	PRINT PCR
	RTRUE

	.FUNCT I-CATCH-KISS
	FCLEAR FOREST,EVERYBIT
	RTRUE

	.FUNCT BUTLER-F,OARG=0,CONTENTS=0
	ZERO? OARG /?L1
	EQUAL? OARG,M-DESC? /TRUE
	PRINT INDENT
	CALL CTPRINT,BUTLER
	FSET? BUTLER,DEADBIT /?L6
	PRINTI " stands near the entrance to "
	EQUAL? HERE,FOYER \?L8
	PRINTI "the ballroom"
	JUMP ?L11
?L8:	PRINTI "the hallway"
	JUMP ?L11
?L6:	PRINTI " lies on the floor, prone and snoring loudly"
?L11:	PRINTI "."
	RTRUE
?L1:	EQUAL? BUTLER,WINNER \?L12
	FSET? BUTLER,DEADBIT \?L13
	PRINT DOESNT-RESPOND
	RTRUE
?L13:	EQUAL? PRSA,V?HELLO \?L15
	PRINTI "He bows"
	PRINT PCR
	RTRUE
?L15:	EQUAL? PRSA,V?TAKE \?L16
	EQUAL? PRSO,BLUE-GLASS,BANKNOTE,INVITE /?L17
	EQUAL? PRSO,GREEN-GLASS \?L16
?L17:	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?GIVE,PRSO,BUTLER
	SET 'WINNER,BUTLER
	RTRUE
?L16:	EQUAL? PRSA,V?TELL-ABOUT \?L18
	EQUAL? PRSO,ME \?L18
	EQUAL? PRSI,LAFOND \?L18
	CALL QUEUED?,I-SUMMONS >STACK
	ZERO? STACK \?L21
	FSET? LDOOR,LOCKEDBIT /?L19
?L21:	EQUAL? HERE,LAFS-ROOM \?L22
	PRINTR """He's gone for water, Miss."""
?L22:	PRINTI """He's awaiting you now, Miss. In his room."""
	CRLF
	MOVE LAFOND,LAFS-ROOM
	RTRUE
?L19:	EQUAL? DANCED-WITH,LAFOND \?L25
	PRINTR """He has retired to his room, and requests not to be disturbed."""
?L25:	PRINTR """The governor is in the ballroom, Miss."""
?L18:	CALL COM-CHECK,BUTLER >OARG
	ZERO? OARG /FALSE
	EQUAL? OARG,M-FATAL \TRUE
	RFALSE
?L12:	EQUAL? PRSA,V?EXAMINE \?L32
	CALL CTPRINT,BUTLER
	PRINTI ", scarred and burly, looks uncomfortable in his formal blacks, as if he'd prefer the rags of a pirate"
	FSET? BUTLER,DEADBIT \?L33
	PRINTI ". He lies snoring on the floor"
?L33:	PRINT PCR
	RTRUE
?L32:	FSET? BUTLER,DEADBIT \?L36
	EQUAL? PRSA,V?SEARCH \?L37
	PRINT NOTHING-NEW
	RTRUE
?L37:	EQUAL? PRSA,V?HELLO,V?ASK-ABOUT,V?TELL /FALSE
	PRINT DOESNT-RESPOND
	RTRUE
?L36:	EQUAL? PRSA,V?SHOW,V?GIVE \?L41
	EQUAL? PRSO,BANKNOTE,INVITE \?L42
	CALL BRIBE-BUTLER,PRSO >STACK
	RSTACK
?L42:	EQUAL? PRSO,GREEN-GLASS,BLUE-GLASS \FALSE
	PRINTI "He looks pleased"
	GETP PRSO,P?CONTENTS >STACK
	EQUAL? STACK,0,POISONED \?L45
	PRINTR ", then disappointed. ""There's no wine in that glass, Ma'am."""
?L45:	GETP PRSO,P?CONTENTS >STACK
	EQUAL? STACK,W-P \?L47
	SET 'DRUGGEE,BUTLER
	CALL QUEUE,I-WATCH-SLEEP,2
?L47:	MOVE PRSO,BUTLER
	PUTP PRSO,P?CONTENTS,0
	PRINTI ". ""I am rather parched, Ma'am,"" he says, taking and emptying"
	CALL TRPRINT,PRSO
	RTRUE
?L41:	EQUAL? P-PRSA-WORD,W?TIP \FALSE
	CALL HELD?,BANKNOTE >STACK
	ZERO? STACK /?L51
	CALL BRIBE-BUTLER,BANKNOTE >STACK
	RSTACK
?L51:	PRINTR "You have nothing to do that with."

	.FUNCT I-BUTLER,CALLED-BY-BUTLER-F=0
	INC 'BUTLER-CTR
	ZERO? CALLED-BY-BUTLER-F /?L1
	CALL QUEUE,I-BUTLER,2
	JUMP ?L3
?L1:	CALL QUEUE,I-BUTLER,-1
?L3:	EQUAL? HERE,FOYER /?L4
	SET 'AWAITING-FAKE-ORPHAN,0
	CALL DEQUEUE,I-BUTLER
	RFALSE
?L4:	FSET? GOWN,WORNBIT \FALSE
	ZERO? CALLED-BY-BUTLER-F \?L8
	PRINT INDENT
	PRINTI """"
?L8:	EQUAL? BUTLER-CTR,3 \?L13
	CALL DEQUEUE,I-BUTLER
	FSET BUTLER,MUNGBIT
	PRINT YOULL-HAVE-TO
	PRINTI "hope to be invited to the next party,"" smirks"
	CALL TPRINT,BUTLER
	PRINT PUSHING-YOU-OUT
	CRLF
	CALL GOTO,MAIN-ENTRANCE >STACK
	RSTACK
?L13:	PRINTI "Your invitation, Miss?"" says"
	CALL TPRINT,BUTLER
	EQUAL? BUTLER-CTR,4 \?L16
	PRINTI " snapping his fingers"
	JUMP ?L18
?L16:	PRINTI " bowing"
?L18:	PRINT PCR
	RTRUE

	.FUNCT BRIBE-BUTLER,GRAFT
	MOVE GRAFT,BUTLER
	FSET? BUTLER,INDOORSBIT \?L1
	PRINTI "He takes"
	CALL TPRINT,GRAFT
	PRINTI " and bows. ""Thank you, Miss"
	EQUAL? GRAFT,INVITE \?L3
	PRINTI " Davis"
?L3:	PRINTR "."""
?L1:	FSET BUTLER,INDOORSBIT
	FCLEAR BUTLER,MUNGBIT
	CALL DEQUEUE,I-BUTLER
	INC 'SCORE
	CALL CTPRINT,BUTLER
	PRINTI " takes"
	CALL TPRINT,GRAFT
	EQUAL? GRAFT,BANKNOTE \?L7
	PRINTI " and secrets it away"
	CALL PRINT-ID,STR?362
?L7:	PRINTI ". ""Enjoy the dance, Miss"
	EQUAL? GRAFT,INVITE \?L10
	PRINTI " Davis"
?L10:	PRINTR "."""

	.FUNCT DANCERS-F
	EQUAL? DANCERS,WINNER \?L1
	ZERO? ENDGAME /?L3
	CALL CTPRINT,DANCERS
	PRINTR " looks away, terrified."
?L3:	EQUAL? PRSA,V?HELLO \?L5
	PRINTI "A dancer smiles nervously and looks away"
	PRINT PCR
	RTRUE
?L5:	EQUAL? PRSA,V?TELL-ABOUT \FALSE
	EQUAL? PRSO,ME \FALSE
	EQUAL? PRSI,LAFOND \?L7
	PRINTI """He's such a good host! I've never been to such a fine party! I'm so glad he is our governor."" You have never seen anyone so nervous before"
	PRINT PCR
	JUMP ?L9
?L7:	PRINTI "Nobody seems inclined to chat with you"
	PRINT PCR
?L9:	CALL STOP >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?DANCE /?L12
	EQUAL? PRSA,V?ASK-FOR \?L13
	EQUAL? PRSI,BALLROOM \?L11
?L12:	PRINTR "A man regretfully shakes his head. ""We haven't been introduced by the governor."""
?L11:	EQUAL? PRSA,V?ASK-FOR \?L13
	EQUAL? PRSI,BALLROOM \?L13
	CALL PERFORM,V?DANCE,DANCERS
	RTRUE
?L13:	EQUAL? PRSA,V?EXAMINE \FALSE
	CALL CTPRINT,DANCERS
	PRINTI "s are dressed in powdered wigs and heavy jewels. All seem paler than fashion and the tropics would decree, and rather nervous"
	PRINT PCR
	RTRUE

	.FUNCT DAD-F,OARG=0
	ZERO? OARG /?L1
	EQUAL? OARG,M-DESC? /TRUE
	PRINT INDENT
	PRINTI "Your father calmly stands nearby."
	RTRUE
?L1:	EQUAL? DAD,WINNER \?L6
	EQUAL? PRSA,V?TELL-ABOUT \?L7
	EQUAL? PRSO,ME \?L7
	EQUAL? PRSI,GARTER \?L9
	PRINTI """That belongs to -- a friend."""
	CRLF
	JUMP ?L11
?L9:	PRINTI """My dear,"" he says rather impatiently, ""There are people waiting for our help -- I haven't time to answer your questions just now."""
	CRLF
?L11:	CALL STOP >STACK
	RSTACK
?L7:	EQUAL? PRSA,V?I-LOVE-YOU \?L12
	EQUAL? PRSI,EYES \?L13
	PRINT DAD-KISS
	RTRUE
?L13:	EQUAL? PRSI,HERO \?L15
	PRINTR """I hoped you would,"" he smiles."
?L15:	EQUAL? PRSI,LAFOND \?L16
	PRINTR """My poor doomed daughter!"""
?L16:	CALL FAILS-TO-NOTICE >STACK
	RSTACK
?L12:	EQUAL? PRSA,V?FOLLOW \?L18
	EQUAL? PRSO,ME \?L18
	PRINTR """Lead on, daughter!"""
?L18:	EQUAL? PRSA,V?HELLO \?L19
	PRINT DAD-KISS
	CALL PRINT-ID,STR?363 >STACK
	RSTACK
?L19:	CALL COM-CHECK,DAD >OARG
	ZERO? OARG /FALSE
	EQUAL? OARG,M-FATAL \TRUE
	RFALSE
?L6:	EQUAL? PRSA,V?ASK-FOR \?L25
	EQUAL? PRSI,GARTER \?L25
	CALL PERFORM,V?TAKE,GARTER
	RTRUE
?L25:	EQUAL? PRSA,V?TELL-ABOUT \?L26
	EQUAL? PRSI,LUCY \?L27
	PRINTR "He listens intently, and laughs, ""What a delightful girl she is, to be sure!"""
?L27:	EQUAL? PRSI,HERO \FALSE
	CALL RUNNING?,I-DAD >STACK
	ZERO? STACK /?L30
	CALL DEQUEUE,I-DAD
	CALL I-DAD,1 >STACK
	RSTACK
?L30:	SET 'AWAITING-REPLY,16
	CALL QUEUE,I-REPLY,2
	PRINTI """So you like him?"" he asks, smiling"
	PRINT PCR
	RTRUE
?L26:	EQUAL? PRSA,V?SHOW,V?GIVE \?L34
	EQUAL? PRSO,BANKNOTE \?L35
	REMOVE BANKNOTE
	PRINTI """Do not stain yourself with that dirty money,"" he takes"
	CALL TPRINT,BANKNOTE
	PRINTI " and rips it up"
	PRINT PCR
	CALL PRINT-ID,STR?364 >STACK
	RSTACK
?L35:	EQUAL? PRSO,GARTER \FALSE
	PRINTR "He smiles dreamily at a memory."
?L34:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "Prison has only added a peppery beard to your father's handsome features. His green eyes still twinkle, his wrists still poke bonily out of his shirt cuffs"
	PRINT PCR
	RTRUE

	.FUNCT I-DAD,CALLED-BY-DAD-F=0
	ZERO? CALLED-BY-DAD-F \?L1
	PRINT INDENT
?L1:	PRINTR "You briefly explain the current situation to your father.
   ""I knew Falcon would do his best to rescue me, once you were safe,"" he responds. ""Now to rescue Lucy -- Nicholas will have told you about her. You get him while I get Lucy, and the four of us will meet down at the beach. Just show me the way out of this maze, and we'll get started."""

	.FUNCT LAFOND-F,OARG=0
	ZERO? OARG /?L1
	EQUAL? OARG,M-DESC? /TRUE
	PRINT INDENT
	PRINTD LAFOND
	FSET? LAFOND,MUNGBIT \?L6
	PRINT LAF-MUNGED
	RTRUE
?L6:	FSET? LAFOND,DEADBIT \?L8
	PRINTI " is slumped in the sand, dead."
	RTRUE
?L8:	EQUAL? HERE,BEACH \?L9
	PRINTI " stands"
	PRINT HALFWAY
	RTRUE
?L9:	PRINTI " is leering, lip curled."
	RTRUE
?L1:	EQUAL? LAFOND,WINNER \?L11
	CALL RUNNING?,I-DUEL >STACK
	ZERO? STACK \?L14
	CALL RUNNING?,I-ENDGAME >STACK
	ZERO? STACK /?L12
?L14:	FSET? LAFOND,DEADBIT /?L12
	PRINTR "He ignores you."
?L12:	EQUAL? PRSA,V?TELL-ABOUT \?L15
	EQUAL? PRSO,ME \?L15
	EQUAL? PRSI,LRING \?L15
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?TAKE,LRING
	SET 'WINNER,LAFOND
	RTRUE
?L15:	CALL COM-CHECK,LAFOND >OARG
	ZERO? OARG /FALSE
	EQUAL? OARG,M-FATAL \TRUE
	RFALSE
?L11:	EQUAL? PRSA,V?POUR \?L21
	EQUAL? PRSO,WINE \?L21
	FSET? LAFOND,DEADBIT /?L21
	CALL PRINT-ID,STR?365
	CALL FWTD,SMACK-YOUR-FACE >STACK
	RSTACK
?L21:	EQUAL? PRSA,V?DANCE \?L22
	EQUAL? HERE,BALLROOM \?L22
	EQUAL? PARTNER,LAFOND \?L23
	PRINT PACE
	RTRUE
?L23:	CALL RUNNING?,I-LDANCE >STACK
	ZERO? STACK /FALSE
	PRINTI "You curtsey and walk to"
	PRINT DANCE-FLOOR
	PRINT PCR
	SET 'REACTION,REACTION-POSITIVE
	RETURN REACTION
?L22:	EQUAL? PRSA,V?KICK,V?BITE,V?KILL \?L27
	FSET? LAFOND,MUNGBIT \?L28
	EQUAL? PRSA,V?KILL /?L30
	PUSH 0
	JUMP ?L31
?L30:	PUSH 1
?L31:	CALL PRINT-ID,STR?366,STACK
	EQUAL? PRSA,V?KICK,V?BITE /?L32
	PUSH 0
	JUMP ?L33
?L32:	PUSH 1
?L33:	CALL PRINT-ID,STR?367,STACK
	CALL MAN-IS-DOWN >STACK
	RSTACK
?L28:	EQUAL? HERE,BALLROOM \?L34
	SET 'AWAITING-REPLY,2
	CALL QUEUE,I-REPLY,2
	PRINT LAF-GRABS
	PRINT THE-BALLROOM
	PRINTI "whirling blur through your tears as he leads you around the floor. ""Ma petite, a ball is not the right place to kill me. What would my guests think?!"""
	CRLF
	EQUAL? PRSA,V?KILL /?L35
	PUSH 0
	JUMP ?L36
?L35:	PUSH 1
?L36:	CALL PRINT-ID,STR?368,STACK
	EQUAL? PRSA,V?KICK,V?BITE /?L37
	PUSH 0
	JUMP ?L38
?L37:	PUSH 1
?L38:	CALL PRINT-ID,STR?369,STACK >STACK
	RSTACK
?L34:	ZERO? KILL-L \?L39
	SET 'KILL-L,1
	PRINT LAF-GRABS
	PRINTI "Twisting your wrist, pain stabbing down your arm, he forces his mouth on yours, hard, thrusting, cutting your lips. He releases you"
	EQUAL? PRSA,V?KILL /?L40
	PUSH 0
	JUMP ?L41
?L40:	PUSH 1
?L41:	CALL PRINT-ID,STR?370,STACK
	EQUAL? PRSA,V?KICK,V?BITE /?L42
	PUSH 0
	JUMP ?L43
?L42:	PUSH 1
?L43:	CALL PRINT-ID,STR?371,STACK
	EQUAL? PRSI,0,RETICULE /?L44
	FSET? PRSI,WORNBIT /?L44
	MOVE PRSI,LAFOND
	PRINTI ", taking"
	CALL TPRINT-PRSI
?L44:	PRINTR ". ""Let that be a warning to you, my love."""
?L39:	EQUAL? PRSA,V?KILL /?L48
	PUSH 0
	JUMP ?L49
?L48:	PUSH 1
?L49:	CALL PRINT-ID,STR?372,STACK
	EQUAL? PRSA,V?KICK,V?BITE /?L50
	PUSH 0
	JUMP ?L51
?L50:	PUSH 1
?L51:	CALL PRINT-ID,STR?373,STACK
	CALL JIGS-UP,STR?374 >STACK
	RSTACK
?L27:	EQUAL? PRSA,V?TOUCH \?L52
	FSET? LAFOND,DEADBIT /?L52
	PRINTR "He smiles."
?L52:	EQUAL? PRSA,V?GIVE \?L53
	EQUAL? PRSO,GREEN-GLASS,BLUE-GLASS \?L53
	IN? BLUE-GLASS,LAFOND /?L56
	IN? GREEN-GLASS,LAFOND \?L54
?L56:	PRINTR """I already have a glass, thank you."""
?L54:	MOVE PRSO,LAFOND
	PRINTI "He takes"
	CALL TRPRINT,PRSO
	RTRUE
?L53:	EQUAL? PRSA,V?KISS \?L58
	EQUAL? HERE,LAFS-ROOM \?L59
	GRTR? LAFOND-CTR,HORNY \?L61
	PRINTR "Queasy, you turn up your face to be kissed. His lips are cold, dry."
?L61:	PRINTR "He laughs. ""Not yet, petite."""
?L59:	PRINTI "You shudder at the thought"
	PRINT PCR
	RTRUE
?L58:	EQUAL? PRSA,V?EXAMINE \FALSE
	CALL RUNNING?,I-LSED >STACK
	ZERO? STACK /?L66
	GRTR? LAFOND-CTR,11 \?L66
	PRINTI "You turn away in modesty after a brief glimpse of pasty pink flesh"
	PRINT PCR
	RTRUE
?L66:	FSET? LAFOND,MUNGBIT \?L68
	PRINTD LAFOND
	PRINT LAF-MUNGED
	CRLF
	RTRUE
?L68:	ZERO? ENDGAME \?L70
	CALL RUNNING?,I-LSED >STACK
	ZERO? STACK /?L69
	GRTR? LAFOND-CTR,4 \?L69
?L70:	PRINTI "Lafond is dressed in a rich brocade robe"
	PRINT PCR
	RTRUE
?L69:	PRINTI "Wigged in dark brown curls, dressed in velvets and brocade, he is warmly attractive. Until you meet his eyes, stone gray and cold"
	PRINT PCR
	RTRUE

	.FUNCT RING-F
	CALL NOUN-USED,W?LATIN,LRING >STACK
	ZERO? STACK \?L3
	CALL NOUN-USED,W?LATIN,HRING >STACK
	ZERO? STACK \?L3
	EQUAL? PRSA,V?READ \?L1
?L3:	CALL REPERTOIRE,STR?375 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L4
	EQUAL? PRSO,LRING \?L5
	PRINTI "It's an ancient gold band, with"
	JUMP ?L7
?L5:	PRINTI "Made of copper,"
	CALL TPRINT,HRING
	PRINTI " has"
?L7:	PRINTI " a curious design of gargoyles, curled tongues extended, on its flat face, with ""Sal Sapit Omnia"" engraved at the bottom"
	PRINT PCR
	RTRUE
?L4:	EQUAL? PRSA,V?TAKE \FALSE
	EQUAL? PRSO,LRING \?L9
	IN? LRING,LAFOND \?L9
	FSET? LAFOND,MUNGBIT \?L11
	PRINTD LAFOND
	PRINTI "'s fingers are curled tight in a fist. You cannot get it"
	PRINT PCR
	RTRUE
?L11:	PRINTR """It is an impressive crest, no? I've thought of making it my own."""
?L9:	FSET? HERO,DEADBIT \?L15
	CALL PRINT-ID,STR?376
	CALL NO-TIME-FOR,STR?377 >STACK
	RSTACK
?L15:	PRINTD HERO
	PRINTI " curls his fist around it. ""This is "
	IN? HRING,HERO \?L18
	PRINTI "a copy of "
?L18:	PRINTR "the family ring lost with my brother."""

	.FUNCT GEN-RING
	RETURN HRING

	.FUNCT COM-CHECK,PER
	EQUAL? PRSA,V?HELP \?L1
	EQUAL? PER,LAFOND \?L3
	PRINTR "He snickers, ""So I shall, petite."""
?L3:	EQUAL? PER,CRULLEY \?L5
	PRINTR """An' what'll I get fer it?"" he says, eying your body."
?L5:	PRINTR """I'm doing all I can."""
?L1:	EQUAL? PRSA,V?KISS \?L7
	EQUAL? PRSO,ME \?L7
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?KISS,PER
	SET 'WINNER,PER
	RTRUE
?L7:	EQUAL? PRSA,V?WALK \?L8
	PRINTR """After you!"""
?L8:	EQUAL? PRSA,V?FOLLOW \?L9
	EQUAL? PRSO,ME \?L9
	PRINTR """Anywhere!"""
?L9:	EQUAL? PRSA,V?HELLO \?L10
	PRINTR """Hello!"""
?L10:	EQUAL? PRSA,V?WHAT \?L11
	CALL PERFORM,V?TELL-ABOUT,ME,PRSO
	RTRUE
?L11:	EQUAL? PRSA,V?GIVE \?L12
	EQUAL? PRSI,ME \?L12
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-FOR,PER,PRSO
	SET 'WINNER,PER
	RTRUE
?L12:	EQUAL? PRSA,V?SGIVE \?L13
	RETURN 8
?L13:	EQUAL? PRSA,V?NO,V?YES \?L16
	SET 'WINNER,PROTAGONIST
	CALL PERFORM-PRSA
	SET 'WINNER,PER
	RTRUE
?L16:	CALL FAILS-TO-NOTICE
	EQUAL? PRSA,V?DRINK \?L18
	SET 'REACTION,REACTION-NEGATIVE
?L18:	CALL STOP
	RTRUE

	.FUNCT I-LDANCE
	EQUAL? HERE,BALLROOM /?L1
	CALL DEQUEUE,I-LDANCE >STACK
	RSTACK
?L1:	EQUAL? LAFOND-CTR,1 \?L4
	MOVE LAFOND,HERE
	CALL QUEUE,I-LDANCE,-1
	SET 'AWAITING-REPLY,11
	CALL QUEUE,I-REPLY,2
	SET 'QUESTIONER,LAFOND
	SET 'DANCED-WITH,LAFOND
	PRINT INDENT
	PRINTI "A fashionably bewigged man stalks up to you and bows deeply. ""Will you dance?"" he asks, with a light French accent. ""Not that you have much choice. If you turn me down,"
	CALL TPRINT,DAD
	PRINTI " dies."""
	CRLF
	JUMP ?L37
?L4:	EQUAL? LAFOND-CTR,2 \?L6
	EQUAL? REACTION,REACTION-POSITIVE \?L7
	SET 'PARTNER,LAFOND
	INC 'LAFOND-CTR
	PRINT INDENT
	PRINTI """I am, of course, Lafond."" "
	PRINT LAUGHS
	JUMP ?L37
?L7:	SET 'QUESTIONER,LAFOND
	SET 'AWAITING-REPLY,11
	CALL QUEUE,I-REPLY,2
	PRINT INDENT
	PRINTI "The man's smile hardens. ""You have"
	CALL TPRINT,DAD
	PRINTI "'s eyes. I am Lafond --  I have recently become intimate with that gentleman."" He slightly stresses the word ""intimate.""
   ""Now, tell me 'yes.' And remember, I am a man of my word."""
	CRLF
	JUMP ?L37
?L6:	EQUAL? LAFOND-CTR,3 \?L10
	EQUAL? REACTION,REACTION-NEGATIVE,REACTION-NEUTRAL \?L11
	CALL DEQUEUE,I-LDANCE
	CALL QUEUE,I-CKILLS-DAD,2
	PRINT INDENT
	PRINTI """A mistake, ma petite."" Lafond gestures to a shadowy figure, who disappears into the east wing. ""Say adieu to your dear Papa."""
	CRLF
	JUMP ?L37
?L11:	SET 'PARTNER,LAFOND
	PRINT LAUGHS
	JUMP ?L37
?L10:	EQUAL? LAFOND-CTR,4 \?L14
	CALL QUEUE,I-LDANCE,-1
	PRINT INDENT
	PRINTI """So you know I am not your father's friend,"" Lafond says, offering a hand for the promenade. ""Unfortunately, you are in my power, "
	ZERO? HERO-ARRESTED /?L15
	PRINTI "the Falcon is with my dragoons"
	JUMP ?L17
?L15:	PRINTI "he is in my dungeon"
?L17:	PRINTI " and I am still King of these waters."" A gold ring flashes on his hand. It seems vaguely familiar"
	PRINT PCR
	JUMP ?L37
?L14:	EQUAL? LAFOND-CTR,5 \FALSE
	FSET? DAD,TOUCHBIT \?L19
	ZERO? HERO-ARRESTED \?L21
	CALL QUEUE,I-HARRESTED,3
?L21:	CALL QUEUE,I-SUMMONS,5
?L19:	INC 'SCORE
	CALL DEQUEUE,I-LDANCE
	REMOVE LAFOND
	SET 'PARTNER,0
	PRINT INDENT
	PRINTD LAFOND
	PRINTI "'s eyes rake your body. ""When I am ready,"
	CALL TPRINT,BUTLER
	PRINTI " will summon you to sup with me in my room"
	FSET? DAD,TOUCHBIT /?L25
	PRINTI "; it may be some time"
?L25:	PRINTI ". We will find much in common before dawn, I am sure. Then I may free your "
	ZERO? HERO-ARRESTED /?L28
	PRINTI "lover"
	JUMP ?L30
?L28:	PRINTI "father"
?L30:	PRINTI "."""
	CALL TPRINT,LAFOND
	PRINTI " bows as the dance ends, and kisses "
	PRINTD HANDS
	PRINTI ". "
	FSET? DAD,TOUCHBIT /?L31
	PRINTI "He cocks his head, curious, ""You have far less spirit than"
	CALL TPRINT,DAD
	PRINTI " credited you. He swore you would have him freed in no time at all. A pity, I prefer doyennes with mettle."" "
?L31:	PRINTI "He moves to speak with"
	CALL TPRINT,BUTLER
	PRINTI ", then "
	CALL QUEUED?,I-SUMMONS >STACK
	ZERO? STACK /?L34
	PRINTI "heads upstairs."
	JUMP ?L36
?L34:	PRINTI "drifts into the crowd."
?L36:	CRLF
?L37:	INC 'LAFOND-CTR
	RETURN LAFOND-CTR

	.FUNCT I-LSED
	SET 'AWAITING-REPLY,12
	CALL QUEUE,I-REPLY,1
	PRINT INDENT
	EQUAL? LAFOND-CTR,1 \?L1
	MOVE LAFOND,HERE
	MOVE BLUE-GLASS,PROTAGONIST
	PUTP BLUE-GLASS,P?CONTENTS,WINED
	MOVE GREEN-GLASS,LAFOND
	MOVE FLAGON,TABLE
	FCLEAR LDOOR,OPENBIT
	CALL QUEUE,I-WONT-DRINK,1
	PRINTI """Have some wine."" Lafond pours wine into two glasses, giving a blue one to you. ""Drink this down. We have a long night ahead of us."" He drains his own"
	PRINT PCR
	JUMP ?L52
?L1:	EQUAL? LAFOND-CTR,2 \?L3
	MOVE GREEN-GLASS,TABLE
	MOVE BUTLER,UPPER-HALL-E
	MOVE HERO,MANACLES
	FSET HERO,DEADBIT
	FSET HERO,NDESCBIT
	FSET TRAP,OPENBIT
	FCLEAR PORTRAIT,OPENBIT
	FCLEAR KNOB,EVERYBIT
	FCLEAR POWER,EVERYBIT
	MOVE RAPIER,DUNGEON
	FCLEAR RAPIER,NDESCBIT
	FCLEAR MANACLES,OPENBIT
	FSET MANACLES,LOCKEDBIT
	FSET CRULLEY,NDESCBIT
	MOVE CRULLEY,DUNGEON
	MOVE WHIP,CRULLEY
	CALL QUEUE,I-LSED,-1
	FCLEAR FLAGON,TRYTAKEBIT
	SET 'LAFOND-LOOKING,0
	PRINTI "Suddenly, the door slams open. It is Jamison, coatless, sword bared, his shirt ripped. ""Thank God I am not too late. Leave, darling, before I skewer this dog to his bedposts,"" he cries. The scar on his cheek gleams coldly.
   With a yell,"
	CALL TPRINT,CRULLEY
	PRINTI " and"
	CALL TPRINT,BUTLER
	PRINTI " jump out of the darkness behind him. Nicholas struggles, but soon lies unconscious on the floor.
   ""Take him to the dungeon,"" Lafond says, setting down his glass. ""You, butler, stay nearby. I do not wish to be disturbed again.
   ""Now that we are rid of that intrusion, cherie, I will change into something more comfortable. Pour me more wine."" He crosses to the wardrobe removing his coat and vest, turned slightly away from you"
	PRINT PCR
	JUMP ?L52
?L3:	EQUAL? LAFOND-CTR,3 \?L4
	PRINTI """In private, call me Jean, or whatever endearment you choose, once I have approved it."" Lafond is looking into the wardrobe"
	PRINT PCR
	JUMP ?L52
?L4:	EQUAL? LAFOND-CTR,4 \?L5
	MOVE TRAY,TABLE
	CALL CTPRINT,BUTLER
	PRINTI " enters, laying"
	CALL APRINT,TRAY
	PRINTI " of "
	PRINTD CHICKEN
	PRINTI " on"
	CALL TPRINT,TABLE
	PRINTI ". ""The kitchen wench has gone, your grace. I took the liberty of fetching these myself."" He bows and leaves the room.
   ""Sprinkle some spices on the fowl, ma petite,"" Lafond says, donning a long brocade robe, his back to you. ""They are hot, but delicious."""
	CRLF
	JUMP ?L52
?L5:	EQUAL? LAFOND-CTR,5 \?L6
	PRINTI """Tsk. The cook has gone too far. She shall be 'leaving us' tomorrow."" Lafond adjusts the lace at his neck"
	PRINT PCR
	JUMP ?L52
?L6:	EQUAL? LAFOND-CTR,6 \?L7
	SET 'QUESTIONER,LAFOND
	SET 'LAFOND-LOOKING,1
	PRINTD LAFOND
	PRINTI " strolls to"
	LOC GREEN-GLASS >STACK
	EQUAL? STACK,TABLE \?L8
	CALL TPRINT,TABLE
	JUMP ?L10
?L8:	PRINTI " you,"
?L10:	PRINTI " smiling slyly"
	GETP BLUE-GLASS,P?CONTENTS >STACK
	EQUAL? STACK,2,0 /?L13
	GETP GREEN-GLASS,P?CONTENTS >STACK
	EQUAL? STACK,2,0 \?L17
?L13:	PRINTI ". ""But you haven't finished pouring the wine."" He tops off both glasses"
	GETP BLUE-GLASS,P?CONTENTS >STACK
	EQUAL? STACK,2,0 \?L14
	CALL POUR-WINE,BLUE-GLASS,1
?L14:	GETP GREEN-GLASS,P?CONTENTS >STACK
	EQUAL? STACK,2,0 \?L17
	CALL POUR-WINE,GREEN-GLASS,1
?L17:	ZERO? USED-LAUD /?L21
	PRINTI ". ""Which glass was mine? I seem to have forgotten."" He points at"
	CALL TPRINT,GREEN-GLASS
	PRINTI " and smiles in a way that does not grant you confidence. ""Is this it?"""
	CRLF
	JUMP ?L52
?L21:	INC 'LAFOND-CTR
	PRINTI ".
   Lafond takes"
	CALL TPRINT,GREEN-GLASS
	PRINTI " and salutes you, gulping down the contents"
	PRINT PCR
	JUMP ?L52
?L7:	EQUAL? LAFOND-CTR,7 \?L24
	SET 'QUESTIONER,LAFOND
	PRINTI """Ah yes, of course."" Lafond obligingly takes"
	ZERO? USED-LAUD /?L30
	EQUAL? REACTION,REACTION-POSITIVE \?L27
	CALL SWITCH-GLASSES,GREEN-GLASS
	JUMP ?L30
?L27:	EQUAL? REACTION,REACTION-NEGATIVE \?L29
	CALL SWITCH-GLASSES,BLUE-GLASS
	JUMP ?L30
?L29:	GETP BLUE-GLASS,P?CONTENTS >STACK
	GRTR? STACK,WINED \?L31
	GETP GREEN-GLASS,P?CONTENTS >STACK
	EQUAL? STACK,WINED \?L31
	CALL SWITCH-GLASSES,BLUE-GLASS
	JUMP ?L33
?L31:	CALL SWITCH-GLASSES,GREEN-GLASS
?L33:	PRINT AFTER-HESITATING
?L30:	PRINT PCR
	PRINT INDENT
	CALL DEQUEUE,I-LSED
	CALL QUEUE,I-WONT-DRINK,1
	PRINTI "He inhales deeply of the bouquet of his wine, then turns to you. ""You must think me very naive to fall for such a trick. I saw you pour something into one of these glasses -- although "
	ZERO? SPICED-WINE /?L35
	PRINTI "you have tried to cover the scent with"
	CALL TPRINT,SPICES
	JUMP ?L37
?L35:	PRINTI "I cannot smell it"
?L37:	PRINTI "."" He switches goblets, setting"
	CALL TPRINT,YOUR-GLASS
	PRINTI " into your nerveless grasp and taking up the other, smiling evilly. ""Now you will drink from the cup intended for me."""
	CRLF
	JUMP ?L52
?L24:	EQUAL? LAFOND-CTR,8 \?L38
	CALL QUEUE,I-LSED,-1
	PRINTD LAFOND
	PRINTI " draws near, whispering indecencies. He caresses your lily white neck, his fingers ice-cold despite the tropic heat"
	PRINT PCR
	JUMP ?L52
?L38:	EQUAL? LAFOND-CTR,9 \?L39
	CALL ROB,PROTAGONIST,LAFS-ROOM
	PRINTD LAFOND
	PRINTI " slides his hand up your neck and into your hair, letting it fall down your back in thick waves and tresses. He lays everything you carry on the floor"
	PRINT PCR
	JUMP ?L52
?L39:	EQUAL? LAFOND-CTR,HORNY \?L40
	PRINTI "One by one Lafond undoes your buttons. He pulls open your "
	CALL PRINT-ID,STR?378
	FSET? SHIRT,WORNBIT \?L41
	PRINTI "shirt"
	JUMP ?L45
?L41:	FSET? GOWN,WORNBIT /?L44
	FSET? DRESS,WORNBIT \?L43
?L44:	PRINTI "bodice"
	JUMP ?L45
?L43:	PRINTI "chemise"
?L45:	CALL REMOVE-CLOTHES
	FCLEAR CHEMISE,WORNBIT
	FSET CHEMISE,EVERYBIT
	FCLEAR SHOES,WORNBIT
	CALL ROB,PROTAGONIST,LAFS-ROOM
	MOVE RETICULE,LAFS-ROOM
	CALL ROB,LAFOND,LAFS-ROOM
	PRINTI ". Your clothes float to the floor"
	PRINT PCR
	JUMP ?L52
?L40:	EQUAL? LAFOND-CTR,11 \?L46
	PRINTD LAFOND
	PRINTI " runs his fingers down your naked spine, and compliments your body. He removes his dressing gown"
	PRINT PCR
	CALL PRINT-ID,STR?379
	JUMP ?L52
?L46:	EQUAL? LAFOND-CTR,12 \?L47
	PRINTD LAFOND
	PRINTI " kisses your shoulder, your neck, your ear. ""Close your eyes, if you will,"" he taunts, ""and pretend I am your dearest"
	CALL TPRINT,HERO
	PRINTI ". But I am greater than he will ever be."" He kisses you, his lips thin and cold"
	PRINT PCR
	JUMP ?L52
?L47:	EQUAL? LAFOND-CTR,13 \?L48
	IN? PROTAGONIST,LAFS-BED \?L49
	SET 'LAFOND-CTR,14
	CALL I-LSED
	JUMP ?L52
?L49:	MOVE LAFOND,LAFS-BED
	MOVE PROTAGONIST,LAFS-BED
	PRINTD LAFOND
	PRINTI " leads you over to the bed"
	PRINT PCR
	JUMP ?L52
?L48:	EQUAL? LAFOND-CTR,14 \?L52
	CALL PRINT-ID,STR?380
	CALL FWTD,STR?381
?L52:	INC 'LAFOND-CTR
	RETURN LAFOND-CTR

	.FUNCT SWITCH-GLASSES,GLASS
	EQUAL? GLASS,GREEN-GLASS \?L1
	SET 'LAF-GLASS,BLUE-GLASS
	SET 'YOUR-GLASS,GREEN-GLASS
	JUMP ?L3
?L1:	SET 'LAF-GLASS,GREEN-GLASS
	SET 'YOUR-GLASS,BLUE-GLASS
?L3:	MOVE YOUR-GLASS,PROTAGONIST
	MOVE LAF-GLASS,LAFOND
	CALL TPRINT,GLASS
	RTRUE

	.FUNCT I-WONT-DRINK,POISON-SCENE=0
	GRTR? LAFOND-CTR,7 \?L1
	SET 'POISON-SCENE,1
?L1:	INC 'ANGER-CTR
	SET 'QUESTIONER,LAFOND
	SET 'AWAITING-REPLY,12
	CALL QUEUE,I-REPLY,2
	PRINT INDENT
	EQUAL? REACTION,REACTION-NEGATIVE /?L4
	EQUAL? PRSO,YOUR-GLASS \?L7
	EQUAL? PRSA,V?DRINK-FROM /?L8
?L7:	EQUAL? PRSO,WINE \?L4
	EQUAL? PRSA,V?DRINK-FROM,V?DRINK,V?EAT /?L8
	EQUAL? PRSA,V?POUR \?L4
	EQUAL? PRSI,ME,MOUTH \?L4
?L8:	PUTP YOUR-GLASS,P?CONTENTS,0
	PRINTI """Good girl,"" he says"
	ZERO? POISON-SCENE /?L9
	PRINTI ". "
	CALL CALL-IN-BUTLER >STACK
	RSTACK
?L9:	PRINTI ", ""Let's see more cooperation of this sort."""
	CRLF
	CALL I-LSED >STACK
	RSTACK
?L4:	GRTR? ANGER-CTR,2 \?L13
	CALL QUEUE,I-LSED,1
	ZERO? POISON-SCENE /?L15
	PRINTI "Lafond grows suddenly violent. ""I will not have insubordination. You shall cooperate, minx."" He forces"
	CALL TPRINT,WINE
	PRINTI " down your throat"
	PRINT PCR
	CALL PRINT-ID,STR?382
	GETP YOUR-GLASS,P?CONTENTS >STACK
	GRTR? STACK,WINED \?L17
	CALL QUEUED?,I-SLEEP >STACK
	ZERO? STACK \?L17
	CALL QUEUE,I-SLEEP,2
?L17:	PUTP YOUR-GLASS,P?CONTENTS,0
	PRINT INDENT
	CALL CALL-IN-BUTLER >STACK
	RSTACK
?L15:	MOVE YOUR-GLASS,TABLE
	PUTP YOUR-GLASS,P?CONTENTS,0
	PRINTI "He angrily takes"
	CALL TPRINT,YOUR-GLASS
	PRINTI " and sets it on"
	CALL TPRINT,TABLE
	PRINTI ". "
	CALL CTPRINT,WINE
	PRINTR " slops a dark stain across the lace. ""Do not try my patience, little one. I have those you love, remember."""
?L13:	CALL QUEUE,I-WONT-DRINK,1
	EQUAL? ANGER-CTR,1 \?L22
	PRINTD LAFOND
	PRINTI " waits impatiently for you to drink"
	PRINT PCR
	RTRUE
?L22:	EQUAL? ANGER-CTR,2 \FALSE
	PRINTI """Drink. We must not waste all night."""
	CALL TPRINT,LAFOND
	PRINTI " pushes the glass toward "
	PRINTD MOUTH
	PRINT PCR
	RTRUE

	.FUNCT CALL-IN-BUTLER
	GETP LAF-GLASS,P?CONTENTS >STACK
	GRTR? STACK,WINED \?L1
	SET 'DRUGGEE,BUTLER
	CALL QUEUE,I-WATCH-SLEEP,1
?L1:	PUTP LAF-GLASS,P?CONTENTS,0
	SET 'LAUD-LEFT,0
	CALL QUEUE,I-LSED,1
	CALL META-LOC,BOTTLE >STACK
	EQUAL? STACK,HERE \?L4
	REMOVE BOTTLE
	PRINTI "Lafond takes"
	CALL TPRINT,BOTTLE
	PRINTI " and drops it out the window. ""You shall not need this. You may suffer no headaches in my employ."""
	CRLF
	PRINT INDENT
?L4:	PRINTI "He lifts his glass to drink, but stops. ""Your father, for all his idiotic meddling in other people's business, is not a fool. I doubt you are, either."" He calls in"
	CALL TPRINT,BUTLER
	PRINTI ", ordering him to empty"
	CALL TPRINT,LAF-GLASS
	PRINTI ". The man reports no odd taste and returns to his post"
	PRINT PCR
	RTRUE

	.FUNCT I-SUMMONS
	FCLEAR LDOOR,LOCKEDBIT
	MOVE LAFOND,LAFS-ROOM
	EQUAL? HERE,LIBRARY \?L1
	IN? DAD,HERE \?L3
	CALL QUEUE,I-SUMMONS,2
	RTRUE
?L3:	PRINT INDENT
	CALL CTPRINT,BUTLER
	PRINTI " enters the room"
	FSET? PORTRAIT,OPENBIT \?L6
	PRINTI ", sees the open "
	PRINTD PORTRAIT
	PRINTI ", and seizes your arms, pinning them behind your back. "
	CALL PRINT-ID,STR?383
	CALL FWTD,SOMETHING-HITS-YOU >STACK
	RSTACK
?L6:	REMOVE BUTLER
	PRINTI ". ""Excuse me for interrupting, Miss, but the master requests your company in his room."" He "
	FSET? KNOB,EVERYBIT /?L11
	FSET? POWER,EVERYBIT \?L9
?L11:	FCLEAR KNOB,EVERYBIT
	FCLEAR POWER,EVERYBIT
	PRINTI "moves around the room, straightening things, then "
?L9:	PRINTI "guides you back to the foyer. ""The governor's "
	PRINTD OBJ-QUARTERS
	PRINTI " are in the east wing."
	PRINT BUTLER-POINTS
	CRLF
	CALL GOTO,FOYER >STACK
	RSTACK
?L1:	EQUAL? HERE,BALLROOM,SUPPER-ROOM,ORCHESTRA /?L14
	EQUAL? HERE,HALL-W,FOYER,HALL-E /?L14
	EQUAL? HERE,BEDROOM,GALLERY,X-ROOM /?L14
	EQUAL? HERE,MAIN-ENTRANCE,VERANDA,KITCHEN /?L14
	EQUAL? HERE,STAIRTOP,UPPER-HALL-W,UPPER-HALL-E \?L13
?L14:	FSET? GOWN,WORNBIT \?L15
	REMOVE BUTLER
	PRINT INDENT
	CALL CTPRINT,BUTLER
	PRINT BUTLER-SUMMONS
	EQUAL? HERE,UPPER-HALL-E \?L17
	PRINTI "to"
	CALL TPRINT,LDOOR
	PRINTI ", unlocks it"
	JUMP ?L22
?L17:	EQUAL? HERE,STAIRTOP,UPPER-HALL-W,X-ROOM /?L20
	EQUAL? HERE,BEDROOM \?L19
?L20:	PRINTI "to the east"
	JUMP ?L22
?L19:	EQUAL? HERE,GALLERY \?L21
	PRINTI "to the north"
	JUMP ?L22
?L21:	PRINTI "up"
	CALL TPRINT,STAIRS
	PRINTI "s"
?L22:	PRINTR ", bows, and leaves."
?L15:	FSET FOYER,EVERYBIT
	PRINT INDENT
	CALL CTPRINT,BUTLER
	PRINTI ", who looks like he is seeking someone, grabs your collar, ""Who invited beggars? Get back to the village where you belong."""
	CALL PRINT-ID,STR?384
	EQUAL? HERE,MAIN-ENTRANCE /?L24
	PRINTI " He escorts you out of the house"
	PRINT PCR
	CRLF
	CALL GOTO,MAIN-ENTRANCE >STACK
	RSTACK
?L24:	CRLF
	RTRUE
?L13:	FSET FOYER,EVERYBIT
	RTRUE

	.FUNCT I-CKILLS-DAD
	EQUAL? HERE,BALLROOM,FOYER /?L3
	EQUAL? HERE,SUPPER-ROOM,ORCHESTRA \FALSE
?L3:	PRINT INDENT
	PRINTI "You see"
	CALL TPRINT,CRULLEY
	PRINTI " come in from the east wing and beckon to Lafond. ""'E's gone"
	FSET? DAD,TOUCHBIT \?L4
	CALL QUEUE,I-LDANCE,2
	REMOVE HERO
	PRINTI "! The cocky crupper 'as disappeared!"" Lafond looks around angrily, eyes narrowed, ""Then get his compatriot. Take Falcon."""
	CALL TPRINT,CRULLEY
	PRINTI " runs out the front door, reappearing a moment later with help"
	PRINT PCR
	CALL I-HARRESTED,1
	JUMP ?L7
?L4:	CALL H-JIGS-UP,STR?385,1
?L7:	INC 'CRULLEY-CTR
	RETURN CRULLEY-CTR

	.FUNCT I-DUEL
	CALL CANT-HEAR-DUEL >STACK
	ZERO? STACK /?L1
	LESS? HERO-CTR,16 /?L23
?L1:	LESS? HERO-CTR,12 \?L3
	PRINT INDENT
	EQUAL? HERE,GALLERY \?L4
	PRINTI "Nicholas and Lafond circle each other intently, the one breathing hard, the other casual, sword tips almost touching. Jamison has lost copious amounts of blood and is no match for Lafond, cool and competent."
	CRLF
?L4:	CALL PICK-ONE,DUEL-SOUNDS >STACK
	PRINT STACK
	CRLF
	JUMP ?L23
?L3:	EQUAL? HERO-CTR,12 \?L7
	PRINT INDENT
	PRINTI "Someone calls out, ""We've got the Dimsford girl, Governor"" -- lying, of course, since you're obviously free"
	EQUAL? HERE,GALLERY \?L8
	PRINTI ". But Nick glances towards the voice, missteps, and slips in his own blood, falling backwards to the floor, his rapier skittering aside"
?L8:	PRINT PCR
	JUMP ?L23
?L7:	EQUAL? HERO-CTR,13 \?L11
	PRINT INDENT
	EQUAL? HERE,GALLERY \?L12
	PRINTD LAFOND
	PRINTI " leaps to Jamison's side, placing one heeled boot on the prostrate man's throat, the tip of his sword over Nick's heart. He sneers then, one eyebrow tilted, and moves to plunge in the sword. Nicholas cannot move."
	JUMP ?L14
?L12:	SET 'HERO-CTR,15
	PRINTI "One of the duellists falls heavily to the floor, his sword skittering away. All is silence for a moment, broken once by a low chuckle. Then a woman screams, someone gasps, and Jean Lafond's wicked laugh blasts your ears, ""Who else cares to taste my blade?"""
?L14:	CRLF
	JUMP ?L23
?L11:	EQUAL? HERO-CTR,14 \?L15
	EQUAL? HERE,GALLERY \?L23
	PRINT INDENT
	PRINTI "The sword plunges down into Jamison's heart, a red stain flowing up to meet it on his breast. Nicholas draws his last breath, his tortured gaze drawn heavenwards, to your face. He reaches for you, his hand dripping his own blood, and breathes your name...
   Nicholas's hand falls limply to the swelling pool of wine red blood and silence pounds on your ears"
	PRINT PCR
	JUMP ?L23
?L15:	EQUAL? HERO-CTR,15 \?L19
	EQUAL? HERE,GALLERY \?L20
	PRINT INDENT
	PRINTI "Lafond wipes his sword on your lover's inert body, ordering someone to drag away the corpse. Suddenly there are sounds of fighting all about, and you realize dragoons surround the house"
	PRINT PCR
	JUMP ?L23
?L20:	PRINTI "Time has stopped. Silence reigns."
	CRLF
	JUMP ?L23
?L19:	EQUAL? HERO-CTR,16 \?L23
	CALL CANT-HEAR-DUEL >STACK
	ZERO? STACK \?L24
	PRINT INDENT
	PRINTI """Find the girl and bring her to me,"" Lafond orders."
	CRLF
?L24:	PRINT INDENT
	PRINT DRAGOONS-SURROUND
	CALL FWTD,SOMETHING-HITS-YOU
?L23:	INC 'HERO-CTR
	RETURN HERO-CTR

	.FUNCT CANT-HEAR-DUEL
	EQUAL? HERE,UPPER-HALL-E,STAIRTOP,HALL-W /FALSE
	EQUAL? HERE,FOYER,LIBRARY,HALL-E /FALSE
	EQUAL? HERE,VERANDA,GALLERY \TRUE
	RFALSE

	.FUNCT PISTOL-F
	EQUAL? PRSA,V?FILL \?L1
	ZERO? PRSI \?L3
	EQUAL? P-PRSA-WORD,W?LOAD \?L3
	CALL HELD?,POWDER >STACK
	ZERO? STACK /?L5
	CALL PERFORM,V?FILL,PISTOL,POWDER
	RTRUE
?L5:	PRINT YNH
	PRINTI " any "
	PRINTD POWDER
	PRINT PCR
	RTRUE
?L3:	EQUAL? PRSI,POWDER \?L8
	ZERO? PRIMED /?L9
	PRINT YOU-HAVE-ALREADY
	PRINTI " loaded"
	CALL TRPRINT,PISTOL
	RTRUE
?L9:	SET 'PRIMED,1
	MOVE HORN,PROTAGONIST
	ZERO? PENULTIM-POINT \?L12
	SET 'PENULTIM-POINT,1
	INC 'SCORE
?L12:	PRINTI "You pour a lumpy stream of"
	CALL TPRINT,POWDER
	PRINTI " mixture into the barrel of"
	CALL TPRINT,PISTOL
	PRINTI " tamping it as best you can"
	PRINT PCR
	RTRUE
?L8:	EQUAL? PRSO,PISTOL \FALSE
	PRINT YOU-CANT
	PRINTI "put that into"
	CALL ARPRINT,PISTOL
	CALL PRINT-ID,STR?386 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?POUR,V?PUT \?L17
	EQUAL? PRSI,PISTOL \?L17
	EQUAL? PRSO,POWDER \?L18
	CALL PERFORM,V?FILL,PISTOL,PRSO
	RTRUE
?L18:	PRINT HUH
	RTRUE
?L17:	EQUAL? PRSA,V?EXAMINE \?L21
	PRINTI "One of"
	CALL APRINT,PAIR
	PRINTI ", the gun is "
	ZERO? PRIMED /?L22
	PRINTR "primed and ready to fire."
?L22:	PRINTR "not loaded."
?L21:	EQUAL? PRSA,V?KILL \?L25
	CALL PERFORM,V?SHOOT,PRSO,PRSI
	RTRUE
?L25:	EQUAL? PRSA,V?SHOOT \?L26
	ZERO? PRIMED \?L27
	PRINTI "But"
	CALL TPRINT,PISTOL
	PRINTR " is not loaded."
?L27:	ZERO? PRSI /?L30
	EQUAL? PRSO,AIR \?L29
?L30:	INC 'SCORE
	PRINTI "You fire"
	CALL TPRINT,PISTOL
	PRINTI " into the air. Startled by the loud report,"
	CALL TPRINT,CRULLEY
	PRINTI " jerks his pistol and fires, aiming not at Nicholas, but at you. You hear a distant scream, your own, and watch, as through from afar,"
	CALL TPRINT,DAD
	PRINTI " wrestle"
	CALL TPRINT,CRULLEY
	PRINTI " to"
	CALL TPRINT,GROUND
	PRINTI ". You feel only numbness as loving arms take you up, and Nicholas kisses you into death, his tears damp on your cheek."
	PRINT YOU-DIED
	CALL PRINT-ID,STR?387
	SET 'FINAL-RANK,2
	CALL FINISH >STACK
	RSTACK
?L29:	EQUAL? PRSO,BUSHES,PATROL \?L31
	PRINTI "They are out of range."
	CRLF
	CALL PRINT-ID,STR?388 >STACK
	RSTACK
?L31:	EQUAL? PRSO,CRULLEY \?L32
	INC 'SCORE
	PRINTI "Trembling, you fire the heavy pistol. You hear its loud report over roaring surf. Crulley staggers, hit, and falls from the cliff. The gun falls from your nerveless hands.
   Time stops as you and Nicholas gaze at one another, adoring and amazed. Slowly he bows and offers his hand.
   "
	PRINT NUTBROWN
	PRINTI "His eyes, twin seas of blue, devour you with a love deep and true-hearted, and you are pulled into his embrace, your mouth on his, lips parted, thirsting, arching into his kiss..."
	CRLF
	CALL PRINT-ID,STR?389
	CALL FINALE >STACK
	RSTACK
?L32:	EQUAL? PRSO,PISTOL \?L33
	CALL IMPOSSIBLES >STACK
	RSTACK
?L33:	FSET? PRSO,DEADBIT \?L34
	CALL PRINT-ID,STR?390
	CALL MAN-IS-DOWN >STACK
	RSTACK
?L34:	FSET? PRSO,ACTORBIT \?L35
	PRINTI "You wouldn't kill"
	CALL TPRINT-PRSO
	PRINTI "!"
	CRLF
	CALL PRINT-ID,STR?391 >STACK
	RSTACK
?L35:	IN? PRSO,HERE /?L36
	CALL CTPRINT,PISTOL
	PRINTI " can't fire that far"
	PRINT PCR
	CALL PRINT-ID,STR?392 >STACK
	RSTACK
?L36:	CALL WASTES >STACK
	RSTACK
?L26:	EQUAL? PRSO,STONE \FALSE
	EQUAL? PRSA,V?SSHOOT \FALSE
	CALL PRINT-ID,STR?393
	CALL WASTES >STACK
	RSTACK

	.FUNCT I-ENDGAME
	EQUAL? HERE,LAGOON,BY-SHIP \?L1
	GRTR? LAFOND-CTR,1 \?L1
	SET 'SCORE,25
	PRINT INDENT
	PRINTI "You hear distant shots and screams, and gaze back across the restless waves to the massacre on the beach. The sight blurs with your tears of shame, tears for the father and the lover you left behind."
	CRLF
	CALL CLEAR-SCREEN,15
	PRINT INDENT
	PRINTI "The tale you tell Jamison's crew, of rapine and blood, of your heroic attempt to save their captain, and of your own escape after his death in your arms, is not so far from the truth that you cannot appear sincere. Cannily, you take advantage of their temporary grief, select a private guard, and teach the rest the discipline of the whip."
	SET 'FINAL-RANK,3
	LESS? LAFOND-CTR,DEAD \?L3
	PRINTI " You have started on the ruthless road to revenge. You intend to meet Lafond again, and that time, you intend to win."
?L3:	CRLF
	CALL FINISH
	RFALSE
?L1:	PRINT INDENT
	EQUAL? LAFOND-CTR,1 \?L7
	EQUAL? HERE,BEACH,SHALLOWS,LAGOON /?L9
	CALL PRINT-ID,STR?394
	CALL FWTD,STR?395
	JUMP ?L26
?L9:	CALL QUEUE,I-ENDGAME,-1
	MOVE LAFOND,BEACH
	FCLEAR LAFOND,MUNGBIT
	MOVE CRULLEY,BEACH
	FCLEAR CRULLEY,MUNGBIT
	PRINTI "A shot rings out over the roar of the surf. Turning, you see that Lafond stands at the top of the cliff, a pistol in each hand. ""Trying to sneak out the back, cowards? You will die like your brother, Falcon. Snivelling for mercy."" He hands one gun to "
	PRINTD CRULLEY
	PRINTI ", standing nearby, and levels the other at Jamison"
	PRINT PCR
	JUMP ?L26
?L7:	EQUAL? LAFOND-CTR,2 \?L12
	FSET COOKIE,DEADBIT
	SET 'QUESTIONER,HERO
	SET 'AWAITING-REPLY,9
	CALL QUEUE,I-REPLY,2
	PRINTI "As the gun fires, Cookie throws himself before his captain. He cries out, blood blossoming on his shoulder, and falls face first into the sand. Lucy runs to him.
   Jamison yells up the cliff, brandishing his sword. ""Fight like a man, Lafond. You have drawn my blood once tonight -- let me draw yours.""
   Lafond sneers. ""On one condition. If I win, your lady comes to me. You will have no need of her when you are dead.""
   Nicholas stiffens, glances at the dragoons on the cliff above, and turns slowly to you. He says nothing, his face hard, but his eyes tell you what you want to know. ""Answer, my darling. Yes or no?"""
	CRLF
	JUMP ?L26
?L12:	EQUAL? LAFOND-CTR,3,4 \?L13
	SET 'QUESTIONER,HERO
	SET 'AWAITING-REPLY,9
	CALL QUEUE,I-REPLY,2
	CALL AFFIRMATIVE-ANSWER >STACK
	ZERO? STACK \?L16
	EQUAL? PRSA,V?YES \?L14
?L16:	FSET RAPIER,NDESCBIT
	FSET LAFOND,NDESCBIT
	FCLEAR CRULLEY,NDESCBIT
	MOVE PISTOL,BEACH
	SET 'LAFOND-CTR,4
	PRINTI "Nicholas looks determined. ""I accept. So long as my people go free if I win. Order your dragoons to obey us, then."" In answer, Lafond jumps off the cliff like a huge brocaded bat to land in front of"
	CALL TPRINT,HERO
	PRINTI ". ""Die then, fool!""
   "
	CALL CTPRINT,PISTOL
	PRINTI ", spinning from Lafond's grip, drops to the sand "
	EQUAL? HERE,BEACH \?L17
	PRINTI "nearby."
	CRLF
	JUMP ?L26
?L17:	PRINTI "of the beach."
	CRLF
	JUMP ?L26
?L14:	EQUAL? REACTION,REACTION-NEUTRAL \?L20
	EQUAL? LAFOND-CTR,3 \?L20
	PRINTI "Lafond calls down to you, ""My pretty doxy, do make up your mind. Yes or no?"""
	CRLF
	JUMP ?L26
?L20:	CALL PRINT-ID,STR?396
	CALL JIGS-UP,STR?397
	JUMP ?L26
?L13:	EQUAL? LAFOND-CTR,FIGHTING \?L22
	PRINTD LAFOND
	PRINTI " immediately takes the advantage, forcing Nicholas in a retreat towards the foaming surf. But Nicholas fights hard, jaw set, ignoring his wounds. Lafond finally loses his smile.
   Behind the duellists, far away atop the cliff, you notice "
	PRINTD CRULLEY
	PRINTI " madly reloading the pistol"
	PRINT PCR
	JUMP ?L26
?L22:	EQUAL? LAFOND-CTR,6 \?L23
	FCLEAR LAFOND,NDESCBIT
	REMOVE HRING
	MOVE LRING,HERO
	FCLEAR RAPIER,NDESCBIT
	FSET LAFOND,DEADBIT
	PRINTI "Suddenly the force of the duel turns, Nicholas advancing against Lafond's retreat. Their blades silently flash in the moonlight. Lafond is pressed back into the shadow of the cliff, sweat beading on his forehead. Abruptly, Jamison leaps forward, metal scrapes, and his rapier licks neatly into Lafond's ribs, like a snake slipping into its burrow. The body of the governor of St. Sinistra convulses, as in amazement, then sags dead on the sword.
   Nicholas removes"
	CALL APRINT,LRING
	PRINTI " from the dead man's finger, throwing his own cheap copy into the surf.
   Far above him,"
	CALL TPRINT,CRULLEY
	PRINTI " moves down the stairs."
	CRLF
	JUMP ?L26
?L23:	EQUAL? LAFOND-CTR,DEAD \?L24
	PRINTD CRULLEY
	PRINTI " is levelling"
	CALL TPRINT,PISTOL
	PRINTI ", feet apart, braced by the cliff wall."
	CRLF
	JUMP ?L26
?L24:	EQUAL? LAFOND-CTR,8 \?L25
	PRINTD CRULLEY
	PRINTI " carefully aims"
	CALL TPRINT,PISTOL
	PRINTI ", a triumphal grin benighting his face. Nicholas turns and walks smiling towards you, oblivious to his danger"
	PRINT PCR
	JUMP ?L26
?L25:	EQUAL? LAFOND-CTR,9 \?L26
	CALL PRINT-ID,STR?398
	CALL JIGS-UP,STR?399
?L26:	INC 'LAFOND-CTR
	RETURN LAFOND-CTR

	.FUNCT FINALE
	MOVE HERO,FOCSLE
	CALL CLEAR-SCREEN,15
	SET 'VERBOSITY,0
	CALL GOTO,FOCSLE
	PRINT INDENT
	PRINTI "As dawn breaks over the eastern seas, you stand with Nicholas on his ship, looking north. ""I have nothing left in England,"" he says. ""There I am but a destitute gentleman, wanted for piracy. Here -- this isle holds too many memories"
	FSET? DAD,DEADBIT \?L1
	SET 'FINAL-RANK,1
	PRINTI " --"" he pauses, gazing into your tear-filled eyes with compassion. """
	JUMP ?L3
?L1:	SET 'FINAL-RANK,4
	PRINTI "; your father may have it. "
?L3:	PRINTI "Mayhap my brother's wife yet lives. I must try to find her, either way."" He takes you into his arms. ""Come with me, my love? To America -- they tell of endless fertile fields and strange beasts in that wild land. It won't be easy, but we will have each other. Together, shall we carve a kingdom blessed with fair children and freedom?""
   You wrap your arms about his waist and lean into him, and smile at the rising sun"
	PRINT PCR
	CALL PRINT-ID,STR?400
	CALL FINISH >STACK
	RSTACK

	.FUNCT PATROL-F
	EQUAL? PATROL,WINNER \?L1
	PRINTR "A rough voice yells to leave them alone."
?L1:	CALL TOUCHING?,PATROL >STACK
	ZERO? STACK /FALSE
	CALL CANT-REACH,PATROL >STACK
	RSTACK

	.FUNCT FAILS-TO-NOTICE
	EQUAL? WINNER,LUCY \?L1
	PRINTI "Sh"
	JUMP ?L3
?L1:	PRINTI "H"
?L3:	PRINTI "e fails to notice you've spoken"
	PRINT PCR
	RTRUE

	.INSERT "plunderedhearts/plunderedhearts_str"
	.END
