	.NEW 5

	.BYTE 5
	.BYTE FLAGS
	.WORD RELEASEID
	.WORD ENDLOD
	.WORD START
	.WORD VOCAB
	.WORD OBJECT
	.WORD GLOBAL
	.WORD IMPURE
	.WORD FLAGS2
	.BYTE 0,0,0,0,0,0
	.WORD WORDS
	.WORD 0,0
	.WORD 0
	.WORD 0
	.WORD 0
	.WORD 0
	.WORD 0
	.WORD 0
	.WORD 0
	.WORD 0
	.WORD TCHARS
	.WORD 0
	.WORD 0
	.WORD CHRSET
	.WORD EXTAB
	.WORD 0
	.WORD 0
	.WORD 0
	.WORD 0
	.INSERT "annotated_games/borderzone/borderzone_freq"
	.INSERT "annotated_games/borderzone/borderzone_data"

	.FUNCT PRINT-DESC1,OBJ
	ZERO? OBJ /FALSE
	CALL2 IPRINT,OBJ >STACK
	RSTACK

	.FUNCT PRINT-ID,ID,CONDITION
	ASSIGNED? 'CONDITION /?L4
	SET 'CONDITION,1
?L4:	ZERO? CONDITION /FALSE
	PRINTI "[ID: "
	PRINT ID
	PRINTI ", PRSO: "
	ICALL2 PRINT-DESC1,PRSO
	PRINTI ", PRSI: "
	ICALL2 PRINT-DESC1,PRSI
	PRINTI "]"
	RTRUE

	.FUNCT PRINT-DEBUG,TEXT,CONDITION
	ASSIGNED? 'CONDITION /?L4
	SET 'CONDITION,1
?L4:	ZERO? CONDITION /FALSE
	PRINTI "DEBUG FLAG: "
	PRINT TEXT
	RTRUE

	.FUNCT IS-THEFT?
	EQUAL? PRSA,V?TAKE \FALSE
	EQUAL? PRSO,ANTIQUE-SIGN,ASSORTED-TOOLS,BINOCULARS /TRUE
	EQUAL? PRSO,BOLT-CUTTER,BOOTS,CAR /TRUE
	EQUAL? PRSO,CAR-STUFF,CURIOS,FAKE-CUTTERS /TRUE
	EQUAL? PRSO,FAKE-GLOVES,FAKE-HAMMER,FAKE-SAW /TRUE
	EQUAL? PRSO,GLOBAL-CAR,GLOBAL-MACHINE-GUN,HAMMER /TRUE
	EQUAL? PRSO,HUT-MAP,HUT-WOOD,KNAPSACK /TRUE
	EQUAL? PRSO,LADDER,LAV-FAUCET,LAV-MIRROR /TRUE
	EQUAL? PRSO,LAV-SINK,MACHINE-GUN,MISC-CLOTHING /TRUE
	EQUAL? PRSO,MISC-FURNITURE,NORMAL-SHOES,OIL-CAN /TRUE
	EQUAL? PRSO,PARKA,RARE-BOOKS,RUBBER-GLOVES /TRUE
	EQUAL? PRSO,SNIPER-RIFLE,TOWEL-DISPENSER,TRASH-CAN /TRUE
	EQUAL? PRSO,VENDOR-CART,WOOD-PILE,WOOD-SAW /TRUE
	EQUAL? PRSO,WORK-SHOES \FALSE
	RTRUE

	.FUNCT IS-OBJECT-OR-PROPERTY?
	EQUAL? PRSO,ANTIQUE-COUNTER,ANTIQUE-COUNTER-DOOR,ANTIQUE-SHOP /TRUE
	EQUAL? PRSO,ANTIQUE-SIDE-DOOR,ANTIQUE-SIGN,ANTIQUE-STREET-DOOR /TRUE
	EQUAL? PRSO,ASSORTED-TOOLS,BAD-CLOTHES,BAD-GUN /TRUE
	EQUAL? PRSO,BAD-WATCH,BARRICADE,BINOCULARS /TRUE
	EQUAL? PRSO,BLDG-1,BLDG-2,BLDG-3 /TRUE
	EQUAL? PRSO,BLDG-4,BLDG-5,BLDG-6 /TRUE
	EQUAL? PRSO,BLDG-7,BLDG-8,BOLT-CUTTER /TRUE
	EQUAL? PRSO,BOOTS,BORDER-FENCE,BRACE /TRUE
	EQUAL? PRSO,BRACE-POST,BRIEFCASE,BUILDING /TRUE
	EQUAL? PRSO,BY-GUN,BYSTANDER-CLOTHES,BYSTANDER-WATCH /TRUE
	EQUAL? PRSO,CAFE-FOOD,CAFE-TABLE,CAMERA /TRUE
	EQUAL? PRSO,CAMERA-BAG,CAR,CAR-STUFF /TRUE
	EQUAL? PRSO,CAR-WINDOW,CEILING,CHIMNEY /TRUE
	EQUAL? PRSO,CIGARETTE,CLOTHES,COLOR-ROLL /TRUE
	EQUAL? PRSO,COLUMN,COMP-SEAT-BACK,COMP-SEAT-FRONT /TRUE
	EQUAL? PRSO,COMP-5-DOOR,COMP-CORD,COMP-N-DOOR /TRUE
	EQUAL? PRSO,COMP-RACK,COMP-WINDOW,COUNTER /TRUE
	EQUAL? PRSO,CURIOS,DOCUMENT,ELEVATOR-BUTTON /TRUE
	EQUAL? PRSO,ELEVATOR-DOOR,EXPLODING-PEN,EXPOSED-ROLL /TRUE
	EQUAL? PRSO,FAKE-CUTTERS,FAKE-GLOVES,FAKE-HAMMER /TRUE
	EQUAL? PRSO,FAKE-SAW,FENCE,FENCE-SIGN /TRUE
	EQUAL? PRSO,FIRE-LADDER,FIRE-WINDOW,FOREST /TRUE
	EQUAL? PRSO,GLOBAL-BLDGS,GLOBAL-CAR,GLOBAL-MACHINE-GUN /TRUE
	EQUAL? PRSO,GLOBAL-SEARCHLIGHTS,GLOBAL-TREES,GLOBAL-WINDOW /TRUE
	EQUAL? PRSO,HAMMER,HOT-DOGS,HUT-MAP /TRUE
	EQUAL? PRSO,HUT-WINDOW,HUT-WOOD,KNAPSACK /TRUE
	EQUAL? PRSO,LADDER,LAV-FAUCET,LAV-MIRROR /TRUE
	EQUAL? PRSO,LAV-SINK,LAV-TOILET,LAV-WINDOW /TRUE
	EQUAL? PRSO,LAVATORY-DOOR,MACHINE-GUN,MATCHES /TRUE
	EQUAL? PRSO,MISC-CLOTHING,MISC-FURNITURE,NORMAL-SHOES /TRUE
	EQUAL? PRSO,OIL-CAN,PAPER-TOWEL,PARKA /TRUE
	EQUAL? PRSO,PASSPORT,PEN-CAP,PHONY-FILM /TRUE
	EQUAL? PRSO,PICTURE,PLAT-FENCE,PLAT-TRAIN /TRUE
	EQUAL? PRSO,POSTS,PRETZEL,PRETZELS /TRUE
	EQUAL? PRSO,RARE-BOOKS,REMINGTON,RIPPED-CLOTHES /TRUE
	EQUAL? PRSO,ROAD,ROADBLOCK,RUBBER-GLOVES /TRUE
	EQUAL? PRSO,SEARCHLIGHTS,SHED,SNIPER-RIFLE /TRUE
	EQUAL? PRSO,SNIPER-WINDOW,SODA,SODA-CANS /TRUE
	EQUAL? PRSO,SOUTH-HUT,SQUARE-BUILDINGS,TICKET /TRUE
	EQUAL? PRSO,TIMER-BUTTON,TOILET-KIT,TOOTHBRUSH /TRUE
	EQUAL? PRSO,TOWEL-DISPENSER,TOWER,TOWER-DOOR /TRUE
	EQUAL? PRSO,TRACKS,TRAIN,TRASH-CAN /TRUE
	EQUAL? PRSO,TWEEZERS,TWR-2,VENDOR-CART /TRUE
	EQUAL? PRSO,WALLS,WOOD-PILE,WOOD-SAW /TRUE
	EQUAL? PRSO,WORK-SHOES \FALSE
	RTRUE

	.FUNCT IS-PERSON?
	EQUAL? PRSO,APARTMENT-GUARDS,BAD-SPY,BY-GUARDS /TRUE
	EQUAL? PRSO,CAR-GUARDS,CROWD,CUSTOMER /TRUE
	EQUAL? PRSO,ELEVATOR-OPERATOR,GLOBAL-BAD-SPY,GLOBAL-CONTACT /TRUE
	EQUAL? PRSO,GLOBAL-HUT-MAN,GLOBAL-SCOUT,GLOBAL-TOPAZ /TRUE
	EQUAL? PRSO,GUARDS,HER,HIM /TRUE
	EQUAL? PRSO,HUT-MAN,INJURED-GUARD,MAYOR /TRUE
	EQUAL? PRSO,PLAT-GUARDS,PLAT-PEOPLE,POLICE /TRUE
	EQUAL? PRSO,PROPRIETOR,RUSSIAN-GUARD,SCOUT /TRUE
	EQUAL? PRSO,SMALLISH-WOMAN,SNIPER,TOPAZ /TRUE
	EQUAL? PRSO,VENDOR,WAITERS,YOUNG-BOY /TRUE
	EQUAL? PRSO,YOUNG-GIRL \FALSE
	RTRUE

	.FUNCT BURNING-HOUSE-DANGER?
	EQUAL? PRSA,V?CLIMB,V?BITE,V?TOUCH /TRUE
	EQUAL? PRSA,V?KNOCK,V?KICK,V?HOLD /TRUE
	EQUAL? PRSA,V?PULL,V?PUSH,V?OPEN /TRUE
	EQUAL? PRSA,V?SIT,V?SHAKE,V?SEARCH /TRUE
	EQUAL? PRSA,V?UNLOCK,V?TOPPLE /TRUE
	RFALSE

	.FUNCT DANGEROUS-DRINK?
	EQUAL? PRSO,SWAMP \FALSE
	RTRUE

	.FUNCT DANGEROUS-FOOD?,?TMP
	CALL1 IS-PART-OF-SELF? >?TMP
	ZERO? ?TMP /?L2
	RETURN ?TMP
?L2:	CALL1 IS-OBJECT-OR-PROPERTY? >STACK
	RSTACK

	.FUNCT IS-ANIMAL?
	EQUAL? PRSO,DOGS,GLOBAL-DOGS \FALSE
	RTRUE

	.FUNCT IS-OBJ-PROP-ANIMAL?,?TMP
	CALL1 IS-OBJECT-OR-PROPERTY? >?TMP
	ZERO? ?TMP /?L2
	RETURN ?TMP
?L2:	CALL1 IS-ANIMAL? >STACK
	RSTACK

	.FUNCT IS-PART-OF-SELF?
	EQUAL? PRSO,BODY-PARTS \FALSE
	RTRUE

	.FUNCT HARM-VERB?
	EQUAL? PRSA,V?KICK,V?BITE,V?HIT /TRUE
	EQUAL? PRSA,V?MOVE,V?THROW,V?PUSH /TRUE
	RFALSE

	.FUNCT KILL-VERB?
	EQUAL? PRSA,V?MUNG,V?KILL \FALSE
	RTRUE

	.FUNCT TELL-OPEN-CLOSED,OBJ
	ASSIGNED? 'OBJ /?L4
	SET 'OBJ,0
?L4:	ZERO? OBJ /?L1
	ICALL2 CTHE-PRINT,OBJ
	JUMP ?L3
?L1:	SET 'OBJ,PRSO
	ICALL1 THE-PRINT-PRSO
?L3:	ICALL2 IS-ARE,OBJ
	PRINTI " "
	CALL2 OPEN-CLOSED,OBJ >STACK
	RSTACK

	.FUNCT OPEN-CLOSED,OBJ
	FSET? OBJ,OPENBIT \?L1
	PRINTI "open"
	JUMP ?L3
?L1:	PRINTI "closed"
?L3:	PRINT PERIOD
	RTRUE

	.FUNCT IS-ARE,OBJ
	PRINTI " is"
	RTRUE

	.FUNCT CTHE-PRINT-PRSO
	CALL THE-PRINT,PRSO,1 >STACK
	RSTACK

	.FUNCT CTHE-PRINT,O
	CALL THE-PRINT,O,1 >STACK
	RSTACK

	.FUNCT THE-PRINT-PRSO
	CALL2 THE-PRINT,PRSO >STACK
	RSTACK

	.FUNCT THE-PRINT-PRSI
	CALL2 THE-PRINT,PRSI >STACK
	RSTACK

	.FUNCT THE-PRINT,O,CAP?
	ASSIGNED? 'CAP? /?L3
	SET 'CAP?,0
?L3:	FSET? O,NOTHEBIT /?L1
	PUSH 1
	JUMP ?L2
?L1:	PUSH 0
?L2:	CALL DPRINT,O,CAP?,STACK >STACK
	RSTACK

	.FUNCT PRINTA-PRSO
	CALL2 PRINTA,PRSO >STACK
	RSTACK

	.FUNCT PRINTA-PRSI
	CALL2 PRINTA,PRSI >STACK
	RSTACK

	.FUNCT PRINTA,O
	FSET? O,THE \?L1
	PRINTI "the "
	JUMP ?L6
?L1:	FSET? O,NOABIT /?L6
	FSET? O,AN \?L4
	PRINTI "an "
	JUMP ?L6
?L4:	PRINTI "a "
?L6:	CALL2 IPRINT,O >STACK
	RSTACK

	.FUNCT DPRINT,O,CAP?,THE?,S
	ASSIGNED? 'CAP? /?L8
	SET 'CAP?,0
?L8:	ASSIGNED? 'THE? /?L9
	SET 'THE?,0
?L9:	ZERO? THE? \?L3
	FSET? O,THE \?L6
?L3:	ZERO? CAP? /?L4
	PRINTI "The "
	JUMP ?L6
?L4:	PRINTI "the "
?L6:	CALL2 IPRINT,O >STACK
	RSTACK

	.FUNCT IPRINT,O
	PRINTD O
	RTRUE

	.FUNCT NSPRINT,NUM,STR
	PRINTN NUM
	PRINTI " "
	PRINT STR
	EQUAL? NUM,1 /FALSE
	PRINTI "s"
	RTRUE

	.FUNCT APRINT,OBJ
	FSET? OBJ,NARTICLEBIT \?L1
	PRINTI " "
	JUMP ?L4
?L1:	FSET? OBJ,VOWELBIT \?L3
	PRINTI " an "
	JUMP ?L4
?L3:	PRINTI " a "
?L4:	CALL2 DPRINT,OBJ >STACK
	RSTACK

	.FUNCT TPRINT,OBJ
	FSET? OBJ,NARTICLEBIT \?L1
	PRINTI " "
	JUMP ?L3
?L1:	PRINTI " the "
?L3:	CALL2 DPRINT,OBJ >STACK
	RSTACK

	.FUNCT TPRINT-PRSO
	CALL2 TPRINT,PRSO >STACK
	RSTACK

	.FUNCT TPRINT-PRSI
	CALL2 TPRINT,PRSI >STACK
	RSTACK

	.FUNCT ARPRINT,OBJ
	ICALL2 APRINT,OBJ
	PRINT PERIOD-CR
	RTRUE

	.FUNCT TRPRINT,OBJ
	ICALL2 TPRINT,OBJ
	PRINT PERIOD-CR
	RTRUE

	.FUNCT PICK-ONE,TBL,LENGTH,CNT,RND,MSG,RFROB
	GET TBL,0 >LENGTH
	GET TBL,1 >CNT
	DEC 'LENGTH
	ADD TBL,2 >TBL
	MUL CNT,2 >STACK
	ADD TBL,STACK >RFROB
	SUB LENGTH,CNT >STACK
	RANDOM STACK >RND
	GET RFROB,RND >MSG
	GET RFROB,1 >STACK
	PUT RFROB,RND,STACK
	PUT RFROB,1,MSG
	INC 'CNT
	EQUAL? CNT,LENGTH \?L1
	SET 'CNT,0
?L1:	PUT TBL,0,CNT
	RETURN MSG

	.FUNCT GO
START::
?L0:	ICALL1 OPENING-SCREEN
	ICALL1 V-LOOK
	ICALL1 MAIN-LOOP
	JUMP ?L0

	.FUNCT MAIN-LOOP,TRASH
?L1:	CALL1 MAIN-LOOP-1 >TRASH
	JUMP ?L1

	.FUNCT MAIN-LOOP-1,ICNT,OCNT,NUM,CNT,OBJ,TBL,V,PTBL,OBJ1,TMP
	SET 'CNT,0
	SET 'OBJ,0
	SET 'PTBL,1
	CALL1 PARSER >P-WON
	ZERO? P-WON /?L1
	GET P-PRSI,P-MATCHLEN >ICNT
	GET P-PRSO,P-MATCHLEN >OCNT
	ZERO? P-IT-OBJECT /?L3
	CALL2 ACCESSIBLE?,P-IT-OBJECT >STACK
	ZERO? STACK /?L3
	SET 'TMP,0
?L5:	IGRTR? 'CNT,ICNT /?L6
	GET P-PRSI,CNT >STACK
	EQUAL? STACK,IT \?L5
	PUT P-PRSI,CNT,P-IT-OBJECT
	SET 'TMP,1
?L6:	ZERO? TMP \?L16
	SET 'CNT,0
?L15:	IGRTR? 'CNT,OCNT /?L16
	GET P-PRSO,CNT >STACK
	EQUAL? STACK,IT \?L15
	PUT P-PRSO,CNT,P-IT-OBJECT
?L16:	SET 'CNT,0
?L3:	ZERO? OCNT \?L25
	SET 'NUM,OCNT
	JUMP ?L32
?L25:	GRTR? OCNT,1 \?L27
	SET 'TBL,P-PRSO
	ZERO? ICNT \?L28
	SET 'OBJ,0
	JUMP ?L30
?L28:	GET P-PRSI,1 >OBJ
?L30:	SET 'NUM,OCNT
	JUMP ?L32
?L27:	GRTR? ICNT,1 \?L31
	SET 'PTBL,0
	SET 'TBL,P-PRSI
	GET P-PRSO,1 >OBJ
	SET 'NUM,ICNT
	JUMP ?L32
?L31:	SET 'NUM,1
?L32:	ZERO? OBJ \?L33
	EQUAL? ICNT,1 \?L33
	GET P-PRSI,1 >OBJ
?L33:	EQUAL? PRSA,V?WALK \?L36
	ZERO? PRSO /?L36
	CALL2 PERFORM-PRSA,PRSO >V
	JUMP ?L52
?L36:	ZERO? NUM \?L38
	GETB P-SYNTAX,P-SBITS >STACK
	BAND STACK,P-SONUMS >STACK
	ZERO? STACK \?L39
	CALL1 PERFORM-PRSA >V
	SET 'PRSO,0
	JUMP ?L52
?L39:	PRINTI "There isn't anything to "
	GET P-ITBL,P-VERBN >TMP
	EQUAL? PRSA,V?TELL \?L42
	PRINTI "talk to"
	JUMP ?L46
?L42:	ZERO? P-OFLAG \?L45
	ZERO? P-MERGED /?L44
?L45:	GET TMP,0 >STACK
	PRINTB STACK
	JUMP ?L46
?L44:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	ICALL WORD-PRINT,STACK,STACK
?L46:	PRINTI "!"
	CRLF
	SET 'V,0
	ICALL1 STOP
	JUMP ?L52
?L38:	SET 'P-NOT-HERE,0
	SET 'P-MULT,0
	GRTR? NUM,1 \?L48
	SET 'P-MULT,1
?L48:	SET 'TMP,0
?L51:	IGRTR? 'CNT,NUM \?L53
	GRTR? P-NOT-HERE,0 \?L55
	PRINTI "[The "
	EQUAL? P-NOT-HERE,NUM /?L57
	PRINTI "other "
?L57:	PRINTI "object"
	EQUAL? P-NOT-HERE,1 /?L60
	PRINTI "s"
?L60:	PRINTI " that you mentioned "
	EQUAL? P-NOT-HERE,1 /?L63
	PRINTI "are"
	JUMP ?L65
?L63:	PRINTI "is"
?L65:	PRINTI "n't here.]"
	CRLF
	JUMP ?L52
?L55:	ZERO? TMP \?L52
	ICALL1 REFERRING
	JUMP ?L52
?L53:	ZERO? PTBL /?L69
	GET P-PRSO,CNT >OBJ1
	JUMP ?L71
?L69:	GET P-PRSI,CNT >OBJ1
?L71:	ZERO? PTBL /?L72
	SET 'PRSO,OBJ1
	JUMP ?L74
?L72:	SET 'PRSO,OBJ
?L74:	ZERO? PTBL /?L75
	SET 'PRSI,OBJ
	JUMP ?L77
?L75:	SET 'PRSI,OBJ1
?L77:	GRTR? NUM,1 /?L80
	GET P-ITBL,P-NC1 >STACK
	GET STACK,0 >STACK
	EQUAL? STACK,W?ALL,W?EVERYTHING \?L83
?L80:	CALL2 DONT-ALL,OBJ1 >STACK
	ZERO? STACK \?L51
	EQUAL? OBJ1,IT \?L84
	ICALL2 DPRINT,P-IT-OBJECT
	JUMP ?L88
?L84:	EQUAL? OBJ1,HIM \?L86
	ICALL2 DPRINT,P-HIM-OBJECT
	JUMP ?L88
?L86:	EQUAL? OBJ1,HER \?L87
	ICALL2 DPRINT,P-HER-OBJECT
	JUMP ?L88
?L87:	ICALL2 DPRINT,OBJ1
?L88:	PRINTI ": "
?L83:	SET 'TMP,1
	CALL PERFORM-PRSA,PRSO,PRSI >V
	EQUAL? V,M-FATAL \?L51
?L52:	EQUAL? V,M-FATAL \?L93
	SET 'P-CONT,0
?L93:	CALL1 CLOCKER-VERB? >STACK
	ZERO? STACK /?L99
	EQUAL? PRSA,V?TELL /?L99
	ZERO? P-WON /?L100
	GETP HERE,P?ACTION >STACK
	CALL2 STACK,M-END >V
	JUMP ?L99
?L1:	SET 'P-CONT,0
?L99:	ZERO? P-WON /?L100
	CALL1 CLOCKER-VERB? >STACK
	ZERO? STACK /?L102
	CALL1 CLOCKER >V
?L102:	SET 'P-PRSA-WORD,0
	SET 'PRSA,0
	SET 'PRSO,0
	SET 'PRSI,0
?L100:	ZERO? AWAITING-FAKE-ORPHAN /FALSE
	ZERO? P-OFLAG \FALSE
	CALL1 ORPHAN-VERB >STACK
	RSTACK

	.FUNCT DONT-ALL,OBJ1,L
	LOC OBJ1 >L
	EQUAL? OBJ1,NOT-HERE-OBJECT \?L1
	INC 'P-NOT-HERE
	RTRUE
?L1:	EQUAL? PRSA,V?TAKE \?L3
	ZERO? PRSI /?L3
	IN? PRSO,PRSI \TRUE
?L3:	CALL2 ACCESSIBLE?,OBJ1 >STACK
	ZERO? STACK /TRUE
	EQUAL? P-GETFLAGS,P-ALL \FALSE
	ZERO? PRSI /?L6
	EQUAL? PRSO,PRSI /TRUE
?L6:	EQUAL? PRSA,V?TAKE \?L8
	FSET? OBJ1,TAKEBIT /?L9
	FSET? OBJ1,TRYTAKEBIT \TRUE
?L9:	EQUAL? L,WINNER,HERE,PRSI /?L11
	LOC WINNER >STACK
	EQUAL? L,STACK /?L11
	FSET? L,SURFACEBIT \TRUE
	FSET? L,TAKEBIT /TRUE
	RFALSE
?L11:	ZERO? PRSI \FALSE
	CALL2 ULTIMATELY-IN?,PRSO >STACK
	ZERO? STACK /FALSE
	RTRUE
?L8:	EQUAL? PRSA,V?PUT-ON,V?PUT,V?DROP /?L18
	EQUAL? PRSA,V?SGIVE,V?GIVE \?L17
?L18:	IN? OBJ1,WINNER \TRUE
?L17:	EQUAL? PRSA,V?PUT-ON,V?PUT,V?DROP /?L20
	EQUAL? PRSA,V?SGIVE,V?GIVE \?L19
?L20:	FSET? OBJ1,WORNBIT /TRUE
?L19:	EQUAL? PRSA,V?PUT-ON,V?PUT \FALSE
	IN? PRSO,WINNER /FALSE
	CALL ULTIMATELY-IN?,PRSO,PRSI >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT CLOCKER-VERB?
	EQUAL? PRSA,V?RESTORE,V?SAVE,V?VERSION /FALSE
	EQUAL? PRSA,V?SCRIPT,V?QUIT,V?RESTART /FALSE
	EQUAL? PRSA,V?SUPER-BRIEF,V?BRIEF,V?UNSCRIPT /FALSE
	EQUAL? PRSA,V?$0024ISL,V?HINT,V?VERBOSE \TRUE
	RFALSE

	.FUNCT FAKE-ORPHAN,IT-WAS-USED,TMP
	ASSIGNED? 'IT-WAS-USED /?L8
	SET 'IT-WAS-USED,0
?L8:	ICALL ORPHAN,P-SYNTAX,0
	GET P-OTBL,P-VERBN >TMP
	PRINTI "[Be specific: Wh"
	ZERO? IT-WAS-USED /?L1
	PRINTI "at object"
	JUMP ?L3
?L1:	PRINTI "o"
?L3:	PRINTI " do you want to "
	ZERO? TMP \?L4
	PRINTI "tell"
	JUMP ?L7
?L4:	GETB P-VTBL,2 >STACK
	ZERO? STACK \?L6
	GET TMP,0 >STACK
	PRINTB STACK
	JUMP ?L7
?L6:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	ICALL WORD-PRINT,STACK,STACK
	PUTB P-VTBL,2,0
?L7:	SET 'P-OFLAG,1
	SET 'P-WON,0
	GETB P-SYNTAX,P-SPREP1 >STACK
	ICALL2 PREP-PRINT,STACK
	PRINTR "?]"

	.FUNCT PERFORM-PRSA,O,I
	ASSIGNED? 'O /?L1
	SET 'O,0
?L1:	ASSIGNED? 'I /?L2
	SET 'I,0
?L2:	CALL PERFORM,PRSA,O,I >STACK
	RSTACK

	.FUNCT PERFORM,A,O,I,V,OA,OO,OI
	ASSIGNED? 'O /?L55
	SET 'O,0
?L55:	ASSIGNED? 'I /?L56
	SET 'I,0
?L56:	SET 'OA,PRSA
	SET 'OO,PRSO
	SET 'OI,PRSI
	SET 'PRSA,A
	EQUAL? IT,O,I \?L8
	EQUAL? A,V?WALK /?L8
	CALL2 VISIBLE?,P-IT-OBJECT >STACK
	ZERO? STACK /?L3
	EQUAL? IT,O \?L5
	SET 'O,P-IT-OBJECT
	JUMP ?L8
?L5:	SET 'I,P-IT-OBJECT
	JUMP ?L8
?L3:	ZERO? I \?L9
	ICALL2 FAKE-ORPHAN,1
	RETURN 8
?L9:	ICALL1 REFERRING
	RETURN 8
?L8:	EQUAL? HIM,O,I \?L22
	EQUAL? A,V?WALK /?L22
	CALL2 VISIBLE?,P-HIM-OBJECT >STACK
	ZERO? STACK /?L17
	EQUAL? HIM,O \?L19
	SET 'O,P-HIM-OBJECT
	JUMP ?L22
?L19:	SET 'I,P-HIM-OBJECT
	JUMP ?L22
?L17:	ZERO? I \?L23
	ICALL1 FAKE-ORPHAN
	RETURN 8
?L23:	ICALL2 REFERRING,1
	RETURN 8
?L22:	EQUAL? HER,O,I \?L36
	EQUAL? A,V?WALK /?L36
	CALL2 VISIBLE?,P-HER-OBJECT >STACK
	ZERO? STACK /?L31
	EQUAL? HER,O \?L33
	SET 'O,P-HER-OBJECT
	JUMP ?L36
?L33:	SET 'I,P-HER-OBJECT
	JUMP ?L36
?L31:	ZERO? I \?L37
	ICALL1 FAKE-ORPHAN
	RETURN 8
?L37:	ICALL2 REFERRING,1
	RETURN 8
?L36:	SET 'PRSO,O
	SET 'PRSI,I
	EQUAL? A,V?WALK /?L43
	EQUAL? NOT-HERE-OBJECT,PRSO,PRSI \?L43
	CALL D-APPLY,STR?19,NOT-HERE-OBJECT-F >V
	ZERO? V /?L43
	SET 'P-WON,0
	JUMP ?L53
?L43:	SET 'O,PRSO
	SET 'I,PRSI
	ICALL2 THIS-IS-IT,PRSI
	ICALL2 THIS-IS-IT,PRSO
	GETP WINNER,P?ACTION >STACK
	CALL D-APPLY,STR?20,STACK >V
	ZERO? V \?L53
	GET SCENARIO-TBL,SCENARIO >STACK
	CALL D-APPLY,STR?21,STACK,M-BEG >V
	ZERO? V \?L53
	GETP HERE,P?ACTION >STACK
	CALL D-APPLY,STR?21,STACK,M-BEG >V
	ZERO? V \?L53
	GET PREACTIONS,A >STACK
	CALL D-APPLY,STR?22,STACK >V
	ZERO? V \?L53
	ZERO? I /?L51
	GETP I,P?ACTION >STACK
	CALL D-APPLY,STR?23,STACK >V
	ZERO? V \?L53
?L51:	ZERO? O /?L52
	ZERO? P-WALK-DIR \?L52
	GETP O,P?ACTION >STACK
	CALL D-APPLY,STR?24,STACK >V
	ZERO? V \?L53
?L52:	GET ACTIONS,A >STACK
	CALL D-APPLY,0,STACK >V
	ZERO? V /?L53
?L53:	SET 'PRSA,OA
	SET 'PRSO,OO
	SET 'PRSI,OI
	RETURN V

	.FUNCT D-APPLY,STR,FCN,FOO,RES
	ASSIGNED? 'FOO /?L7
	SET 'FOO,0
?L7:	ZERO? FCN /FALSE
	ZERO? FOO /?L4
	CALL2 FCN,FOO >RES
	RETURN RES
?L4:	CALL1 FCN >RES
	RETURN RES

	.FUNCT NOISY-VERB?
	EQUAL? PRSA,V?YELL,V?MUNG,V?KICK /TRUE
	EQUAL? PRSA,V?KNOCK,V?ALARM,V?CALL /TRUE
	EQUAL? PRSA,V?HIT,V?KILL /TRUE
	RFALSE

	.FUNCT QUIET-VERB?
	CALL1 CLOCKER-VERB? >STACK
	ZERO? STACK /TRUE
	EQUAL? PRSA,V?DRINK,V?EAT,V?WATCH /TRUE
	EQUAL? PRSA,V?EXAMINE,V?LOOK,V?HIDE /TRUE
	EQUAL? PRSA,V?FIND,V?INVENTORY,V?LOOK-DOWN /TRUE
	EQUAL? PRSA,V?LOOK-UP,V?LOOK-INSIDE,V?READ /TRUE
	EQUAL? PRSA,V?COUNT,V?SMELL,V?WAIT /TRUE
	EQUAL? PRSA,V?WAVE,V?RESET,V?RESTORE /TRUE
	EQUAL? PRSA,V?SAVE,V?PUT,V?DROP /TRUE
	EQUAL? PRSA,V?TAKE,V?FAST-TIME,V?OPEN /TRUE
	EQUAL? PRSA,V?OIL,V?SLOW-TIME /TRUE
	EQUAL? PRSA,V?PUSH \FALSE
	CALL ULTIMATELY-IN?,PRSO,WINNER >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT CLOCKER,E,TICK,RTN,FLG,Q?,OWINNER,?TMP
	SET 'FLG,0
	SET 'Q?,0
	ZERO? CUT-DETECTED /?L1
	GRTR? CLOCK-TIME,CUT-DETECTED \?L1
	ZERO? CUT-VIGILANCE \?L1
	SET 'CUT-VIGILANCE,1
	JUMP ?L15
?L1:	EQUAL? HERE,HUT-STORAGE,HUT-BEDROOM \?L3
	IN? HUT-MAN,HUT-LIVING \?L3
	EQUAL? PRSA,V?WALK /?L3
	CALL1 QUIET-VERB? >STACK
	ZERO? STACK \?L3
	HLIGHT H-BOLD
	CRLF
	ICALL2 PRINT-ID,STR?25
	ICALL2 JIGS-UP,STR?26
	RTRUE
?L3:	FSET? HERE,GVIEWBIT \?L15
	EQUAL? PRSA,V?WALK /?L15
	CALL1 GUARD-DISTANCE >TICK
	ZERO? VIGILANCE \?L7
	ZERO? CUT-VIGILANCE /?L5
?L7:	ZERO? TOWER-DESTROYED \?L8
	RANDOM 100 >STACK
	LESS? 30,STACK /?L5
?L8:	ZERO? GUARD-CHASE \?L5
	CRLF
	PRINTI "One of the guards, more alert due"
	ZERO? VIGILANCE /?L9
	PRINTI " to the recent explosion"
	JUMP ?L11
?L9:	PRINTI ", perhaps, to the belated detection of voltage loss in the fence"
?L11:	PRINTI ", notices you, and calls out to the other guards, who rapidly surround you and take you into custody."
	ICALL2 PRINT-ID,STR?27
	ICALL2 JIGS-UP,STR?28
	RTRUE
?L5:	CALL1 NOISY-VERB? >STACK
	ZERO? STACK /?L14
	LESS? TICK,40 /?L13
?L14:	EQUAL? PRSA,V?CUT \?L12
	LESS? TICK,25 \?L12
?L13:	ZERO? GUARD-CHASE \?L12
	CRLF
	ICALL2 PRINT-ID,STR?29
	ICALL2 JIGS-UP,STR?30
	RTRUE
?L12:	CALL1 QUIET-VERB? >STACK
	ZERO? STACK \?L15
	CALL1 GUARDS-FACING-PLAYER? >STACK
	ZERO? STACK /?L15
	LESS? TICK,70 \?L15
	SUB 100,TICK >STACK
	DIV STACK,4 >?TMP
	RANDOM 100 >STACK
	LESS? ?TMP,STACK /?L15
	ZERO? GUARD-CHASE \?L15
	CRLF
	ICALL2 PRINT-ID,STR?31
	ICALL2 JIGS-UP,STR?32
	RTRUE
?L15:	ICALL2 I-CLOCKER,CLOCK-MOVE
	ZERO? SL-WATCH \?L20
	ZERO? G-WATCH /?L18
?L20:	ICALL UPDATE-CHRONOGRAPH,0,1
	ICALL1 UPDATE-TIME
?L18:	SET 'CLOCK-MOVE,CLOCK-DEFAULT
	RTRUE

	.FUNCT ABS,N
	LESS? N,0 /?L1
	RETURN N
?L1:	SUB 0,N >STACK
	RSTACK

	.FUNCT TOO-LATE
	PRINTR "That's already been done."

	.FUNCT CHRONOGRAPH-TELL,N
	MOD CHRONOGRAPH-TIME,3600 >STACK
	DIV STACK,60 >N
	GRTR? N,59 \?L1
	SUB N,60 >N
?L1:	LESS? N,10 \?L4
	PRINTI "0"
?L4:	PRINTN N
	PRINTI ":"
	MOD CHRONOGRAPH-TIME,60 >N
	LESS? N,10 \?L7
	PRINTI "0"
?L7:	PRINTN N
	RTRUE

	.FUNCT SLOW-CLOCK-QUEUE,FCN,TIM,OFF
	SET 'OFF,I-SLOW-CLOCK-OFF
	SUB OFF,1 >STACK
	PUT CLOCK-TBL,STACK,FCN
	PUT CLOCK-TBL,OFF,TIM
	RTRUE

	.FUNCT SLOW-CLOCK-QUEUED?,FCN,OFF
	SET 'OFF,I-SLOW-CLOCK-OFF
	SUB OFF,1 >STACK
	GET CLOCK-TBL,STACK >STACK
	EQUAL? STACK,FCN \FALSE
	GET CLOCK-TBL,OFF >STACK
	EQUAL? STACK,32767 \TRUE
	RFALSE

	.FUNCT DE-QUEUE,OFF
	PUT CLOCK-TBL,OFF,32767
	RTRUE

	.FUNCT DE-RT-QUEUE
	CALL2 DE-QUEUE,I-RT-QUEUE-OFF >STACK
	RSTACK

	.FUNCT DE-RANDOM-QUEUE
	CALL2 DE-QUEUE,I-RANDOM-QUEUE-OFF >STACK
	RSTACK

	.FUNCT DE-SLOW-CLOCK-QUEUE
	CALL2 DE-QUEUE,I-SLOW-CLOCK-OFF >STACK
	RSTACK

	.FUNCT RT-QUEUE,FCN,TIM,OFF,?TMP
	ASSIGNED? 'OFF /?L1
	SET 'OFF,I-RT-QUEUE-OFF
?L1:	SUB OFF,1 >STACK
	PUT CLOCK-TBL,STACK,FCN
	SET '?TMP,CLOCK-TBL
	CALL1 INT-TIME >STACK
	ADD STACK,TIM >STACK
	PUT ?TMP,OFF,STACK
	RTRUE

	.FUNCT RANDOM-QUEUE,FCN,TIM,OFF,?TMP
	SET 'OFF,I-RANDOM-QUEUE-OFF
	SUB OFF,1 >STACK
	PUT CLOCK-TBL,STACK,FCN
	SET '?TMP,CLOCK-TBL
	CALL1 INT-TIME >STACK
	ADD STACK,TIM >STACK
	PUT ?TMP,OFF,STACK
	RTRUE

	.FUNCT RT-QUEUED?,FCN,OFF
	SET 'OFF,I-RT-QUEUE-OFF
	SUB OFF,1 >STACK
	GET CLOCK-TBL,STACK >STACK
	EQUAL? STACK,FCN \FALSE
	GET CLOCK-TBL,OFF >STACK
	EQUAL? STACK,32767 \TRUE
	RFALSE

	.FUNCT I-CLOCKER,TICKS,SCENE,CNT,TBL,TIM
	ASSIGNED? 'TICKS /?L17
	SET 'TICKS,1
?L17:	SET 'SCENE,SCENARIO
	SET 'CNT,CLOCK-INTS
	SET 'TBL,CLOCK-TBL
	EQUAL? TICKS,1 \?L1
	ZERO? INT-FLAG /FALSE
?L1:	SET 'CLOCK-TICKS,TICKS
?L4:	EQUAL? SCENE,SCENARIO /?L6
	ZERO? PRSA \?L5
	SET 'READ-INTERRUPTED,1
	RETURN READ-INTERRUPTED
?L6:	DLESS? 'CNT,0 \?L11
	ICALL2 UPDATE-CLOCK,TICKS
	RETURN READ-INTERRUPTED
?L11:	GET TBL,1 >TIM
	LESS? TICKS,TIM \?L12
	MOD CLOCK-TIME,TIM >STACK
	ADD TICKS,STACK >STACK
	LESS? STACK,TIM /?L16
	GET TBL,0 >STACK
	ICALL1 STACK
	JUMP ?L16
?L12:	DIV TICKS,TIM >STACK
	GET TBL,0 >STACK
	ICALL MULTAPPLY,STACK,STACK
?L16:	ADD TBL,4 >TBL
	JUMP ?L4
?L5:	RETURN READ-INTERRUPTED

	.FUNCT UPDATE-CLOCK,TICKS,FORCE?
	ASSIGNED? 'FORCE? /?L4
	SET 'FORCE?,0
?L4:	ADD CLOCK-TIME,TICKS >CLOCK-TIME
	ICALL UPDATE-CHRONOGRAPH,TICKS,FORCE?
	ADD REAL-UPDATE,TICKS >REAL-UPDATE
	GRTR? REAL-UPDATE,59 \FALSE
	MOD REAL-UPDATE,60 >REAL-UPDATE
	CALL1 UPDATE-TIME >STACK
	RSTACK

	.FUNCT MULTAPPLY,FCN,NUM
?L1:	DLESS? 'NUM,0 /TRUE
	ICALL1 FCN
	JUMP ?L1

	.FUNCT UPDATE-TIME,MIN,TMP
	BUFOUT 0
	SCREEN 1
	GETB 0,33 >STACK
	SUB STACK,5 >STACK
	CURSET 1,STACK
	HLIGHT H-INVERSE
	DIV CLOCK-TIME,60 >STACK
	ADD STACK,START-MINUTE >MIN
	DIV MIN,60 >STACK
	ADD START-HOUR,STACK >TMP
	GRTR? TMP,23 \?L1
	PRINTI "0"
	SUB TMP,24 >TMP
?L1:	PRINTN TMP
	PRINTI ":"
	MOD MIN,60 >MIN
	LESS? MIN,10 \?L4
	PRINTI "0"
?L4:	PRINTN MIN
	PRINTI " "
	CALL1 SCREEN-0 >STACK
	RSTACK

	.FUNCT UPDATE-CHRONOGRAPH,TICKS,FORCE?,SCR
	ASSIGNED? 'FORCE? /?L26
	SET 'FORCE?,0
?L26:	ASSIGNED? 'SCR /?L27
	SET 'SCR,0
?L27:	ZERO? CHRONOGRAPH-ON /?L1
	ICALL1 SCREEN-1
	SET 'SCR,1
	GETB 0,33 >STACK
	GRTR? STACK,58 \?L3
	GETB 0,33 >STACK
	DIV STACK,2 >STACK
	SUB STACK,3 >STACK
	CURSET 1,STACK
	JUMP ?L5
?L3:	CURSET 1,27
?L5:	ADD CHRONOGRAPH-TIME,TICKS >CHRONOGRAPH-TIME
	EQUAL? SCENARIO,2 \?L6
	ICALL1 CHRONOGRAPH-TELL
	JUMP ?L8
?L6:	PRINTI "     "
?L8:	PRINTI " "
?L1:	ZERO? SL-WATCH /?L10
	ZERO? SCR \?L12
	ICALL1 SCREEN-1
	SET 'SCR,1
?L12:	ICALL1 SL-WATCHER
?L10:	ZERO? G-WATCH /?L16
	ZERO? FORCE? \?L18
	MOD CHRONOGRAPH-TIME,5 >STACK
	ZERO? STACK \?L16
?L18:	ZERO? SCR \?L19
	ICALL1 SCREEN-1
	SET 'SCR,1
?L19:	ICALL1 GUARD-WATCHER
?L16:	ZERO? SCR /TRUE
	ICALL1 SCREEN-0
	RTRUE

	.FUNCT I-SEARCHLIGHTS
	CALL1 TURN-SL >STACK
	RSTACK

	.FUNCT SL-WATCHER
	CURSET 2,8
	CALL2 SL-POS-STR-AB,1 >STACK
	PRINT STACK
	PRINTI "  "
	GETB 0,33 >STACK
	DIV STACK,2 >STACK
	ADD STACK,2 >STACK
	CURSET 2,STACK
	CALL2 SL-POS-STR-AB,2 >STACK
	PRINT STACK
	PRINTI "  "
	GETB 0,33 >STACK
	SUB STACK,4 >STACK
	CURSET 2,STACK
	CALL2 SL-POS-STR-AB,3 >STACK
	PRINT STACK
	PRINTR "  "

	.FUNCT GUARD-WATCHER,INIT?,MT,FACE?,OFF,SW
	ASSIGNED? 'INIT? /?L24
	SET 'INIT?,0
?L24:	GETB 0,33 >SW
	ZERO? GUARD-MARGIN /?L1
	SET 'OFF,GUARD-MARGIN
	JUMP ?L3
?L1:	LESS? SW,41 \?L4
	SET 'OFF,2
	JUMP ?L6
?L4:	SUB SW,36 >STACK
	DIV STACK,2 >STACK
	SUB STACK,4 >OFF
?L6:	SET 'GUARD-MARGIN,OFF
?L3:	ICALL1 SCREEN-1
	CURSET 2,OFF
	CRLF
	PRINTI "T"
	ICALL2 PRINT-SPACES,18
	ADD 18,OFF >STACK
	CURSET 2,STACK
	PRINTI "T"
	ICALL2 PRINT-SPACES,18
	ADD 36,OFF >STACK
	CURSET 2,STACK
	PRINTI "T"
	CRLF
	GETP HERE,P?GPOS >STACK
	DIV STACK,5 >STACK
	ADD OFF,STACK >STACK
	CURSET 3,STACK
	CALL1 GUARDS-FACING-EACH-OTHER? >FACE?
	MOD CLOCK-TIME,180 >MT
	LESS? MT,90 /?L9
	SUB 180,MT >MT
?L9:	ZERO? GUARD-CHASE /?L12
	SET 'FACE?,1
	SUB CLOCK-TIME,GUARD-CHASE-TIME >STACK
	SUB GUARD-CHASE,STACK >MT
	SUB 90,MT >MT
?L12:	DIV MT,5 >STACK
	ADD STACK,1 >G-WATCH
	SUB G-WATCH,1 >STACK
	ADD OFF,STACK >STACK
	CURSET 2,STACK
	SUB G-WATCH,1 >STACK
	ADD 0,STACK >STACK
	ICALL2 PRINT-SPACES,STACK
	ZERO? FACE? /?L15
	PRINTI ">"
	JUMP ?L17
?L15:	PRINTI "<"
?L17:	SUB 37,G-WATCH >STACK
	ADD OFF,STACK >STACK
	CURSET 2,STACK
	MUL G-WATCH,2 >STACK
	SUB 38,STACK >STACK
	ICALL2 PRINT-SPACES,STACK
	ZERO? FACE? /?L18
	PRINTI "<"
	JUMP ?L20
?L18:	PRINTI ">"
?L20:	ZERO? INIT? /?L21
	ICALL1 SCREEN-0
?L21:	CRLF
	GETP HERE,P?GPOS >STACK
	DIV STACK,5 >STACK
	ADD 0,STACK >STACK
	ICALL2 PRINT-SPACES,STACK
	PRINTR "*"

	.FUNCT GUARDS-FACING-EACH-OTHER?
	DIV CLOCK-TIME,90 >STACK
	MOD STACK,2 >STACK
	ZERO? STACK \FALSE
	RTRUE

	.FUNCT GUARDS-FACING-PLAYER?
	GETP HERE,P?GPOS >STACK
	EQUAL? STACK,90 \TRUE
	DIV CLOCK-TIME,90 >STACK
	MOD STACK,2 >STACK
	ZERO? STACK /TRUE
	RFALSE

	.FUNCT SCREEN-1
	BUFOUT 0
	SCREEN 1
	HLIGHT H-INVERSE
	RTRUE

	.FUNCT SCREEN-0
	HLIGHT H-NORMAL
	SCREEN 0
	BUFOUT 1
	RTRUE

	.FUNCT HLIGHTELL,STR,HL
	ASSIGNED? 'HL /?L1
	SET 'HL,H-ITALIC
?L1:	HLIGHT HL
	PRINT STR
	HLIGHT H-NORMAL
	RTRUE

	.FUNCT THIS-IS-IT,OBJ
	EQUAL? OBJ,0,PROTAGONIST,NOT-HERE-OBJECT /TRUE
	EQUAL? OBJ,ME,GLOBAL-ROOM /TRUE
	EQUAL? PRSA,V?WALK \?L1
	EQUAL? PRSO,OBJ /TRUE
?L1:	FSET? OBJ,PERSON \?L4
	SET 'P-HIM-OBJECT,OBJ
	RETURN P-HIM-OBJECT
?L4:	SET 'P-IT-OBJECT,OBJ
	RETURN P-IT-OBJECT

	.FUNCT CHECK-REFRESH
	GET 0,8 >STACK
	BTST STACK,4 \FALSE
	GET 0,8 >STACK
	BAND STACK,-5 >STACK
	PUT 0,8,STACK
	CALL2 V-$0024ISL,0 >STACK
	RSTACK

	.FUNCT PARSER,PTR,WRD,VAL,VERB,DONT,OMERGED,OWINNER,LEN,DIR,NW,LW,CNT,OF-FLAG
?L0:	SET 'PTR,P-LEXSTART
	SET 'VAL,0
	SET 'VERB,0
	SET 'DONT,0
	SET 'DIR,0
	SET 'NW,0
	SET 'LW,0
	SET 'CNT,-1
	SET 'OF-FLAG,0
	SET 'MINUTES-FLAG,0
	ZERO? P-OFLAG \?L1
	COPYT P-ITBL,P-OTBL,20
?L1:	COPYT P-ITBL,0,20
	SET 'P-NAM,0
	SET 'IN-FRONT-FLAG,0
	SET 'P-ADJ,0
	SET 'OMERGED,P-MERGED
	SET 'OWINNER,WINNER
	SET 'P-MERGED,0
	SET 'P-END-ON-PREP,0
	PUT P-PRSO,P-MATCHLEN,0
	PUT P-PRSI,P-MATCHLEN,0
	PUT P-BUTS,P-MATCHLEN,0
	ZERO? QUOTE-FLAG \?L4
	EQUAL? WINNER,PROTAGONIST /?L4
	SET 'WINNER,PROTAGONIST
	LOC WINNER >HERE
?L4:	ZERO? VERBOSE-CLOCK /?L7
	ZERO? CHRONOGRAPH-ON /?L7
	CRLF
	PRINTI "["
	ICALL1 CHRONOGRAPH-TELL
	PRINTI "]"
?L7:	ZERO? RESERVE-PTR /?L10
	SET 'PTR,RESERVE-PTR
	ICALL STUFF,P-LEXV,RESERVE-LEXV
	ICALL INBUF-STUFF,P-INBUF,RESERVE-INBUF
	EQUAL? VERBOSITY,1,2 \?L12
	EQUAL? PROTAGONIST,WINNER \?L12
	CRLF
?L12:	SET 'RESERVE-PTR,0
	SET 'P-CONT,0
	JUMP ?L29
?L10:	ZERO? P-CONT /?L15
	SET 'PTR,P-CONT
	ZERO? VERBOSE-CLOCK /?L16
	ZERO? CHRONOGRAPH-ON /?L16
	CRLF
?L16:	EQUAL? VERBOSITY,1,2 \?L19
	EQUAL? PROTAGONIST,WINNER \?L19
	CRLF
?L19:	SET 'P-CONT,0
	JUMP ?L29
?L15:	SET 'WINNER,PROTAGONIST
	SET 'QUOTE-FLAG,0
	LOC WINNER >HERE
	ZERO? VERBOSE-CLOCK /?L23
	ZERO? CHRONOGRAPH-ON /?L23
	CRLF
?L23:	EQUAL? VERBOSITY,1,2 \?L26
	CRLF
?L26:	ICALL1 CHECK-REFRESH
	ICALL1 STATUS-LINE
	PRINTI ">"
	PUTB P-INBUF,1,0
	READ P-INBUF,P-LEXV,READ-CLOCK,I-CLOCKER >STACK
	ZERO? READ-INTERRUPTED /?L29
	SET 'READ-INTERRUPTED,0
	JUMP ?L0
?L29:	GETB P-LEXV,P-LEXWORDS >P-LEN
	ZERO? P-LEN \?L32
	PRINTI "[I beg your pardon?]"
	CRLF
	RFALSE
?L32:	GET P-LEXV,PTR >STACK
	EQUAL? STACK,W?OOPS,W?O \?L34
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?$PERIOD,W?$COMMA \?L35
	ADD PTR,P-LEXELEN >PTR
	DEC 'P-LEN
?L35:	GRTR? P-LEN,1 /?L38
	PRINTI "[There was no word after OOPS!]"
	CRLF
	RFALSE
?L38:	GET OOPS-TABLE,O-PTR >VAL
	ZERO? VAL /?L40
	GRTR? P-LEN,2 \?L41
	PRINTI "[Warning: only the first word after OOPS is used.]"
	CRLF
?L41:	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	PUT AGAIN-LEXV,VAL,STACK
	SET 'WINNER,OWINNER
	MUL VAL,P-LEXELEN >STACK
	ADD STACK,3 >STACK
	MUL PTR,P-LEXELEN >STACK
	ADD STACK,7 >STACK
	GETB P-LEXV,STACK >STACK
	MUL PTR,P-LEXELEN >STACK
	ADD STACK,6 >STACK
	GETB P-LEXV,STACK >STACK
	ICALL INBUF-ADD,STACK,STACK,STACK
	ICALL STUFF,P-LEXV,AGAIN-LEXV
	GETB P-LEXV,P-LEXWORDS >P-LEN
	GET OOPS-TABLE,O-START >PTR
	ICALL INBUF-STUFF,P-INBUF,OOPS-INBUF
	JUMP ?L45
?L40:	PUT OOPS-TABLE,O-END,0
	PRINTI "[OOPS is useful only after the ""I don't know the word..."" response.]"
	CRLF
	RFALSE
?L34:	PUT OOPS-TABLE,O-END,0
?L45:	GET P-LEXV,PTR >STACK
	EQUAL? STACK,W?AGAIN,W?G \?L46
	ZERO? P-OFLAG /?L48
	PRINTI "[It's difficult to repeat fragments.]"
	CRLF
	RFALSE
?L48:	ZERO? P-WON \?L50
	PRINTI "[That would just repeat a mistake!]"
	CRLF
	RFALSE
?L50:	EQUAL? OWINNER,PROTAGONIST /?L51
	CALL2 VISIBLE?,OWINNER >STACK
	ZERO? STACK \?L51
	PRINTI "[You can't see "
	ICALL2 DPRINT,OWINNER
	PRINTI " anymore.]"
	CRLF
	ICALL1 STOP
	RFALSE
?L51:	GRTR? P-LEN,1 \?L52
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?$PERIOD,W?$COMMA,W?THEN /?L55
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?AND \?L53
?L55:	ADD PTR,4 >PTR
	GETB P-LEXV,P-LEXWORDS >STACK
	SUB STACK,2 >STACK
	PUTB P-LEXV,P-LEXWORDS,STACK
	JUMP ?L57
?L53:	PRINTI "[I couldn't understand that sentence.]"
	CRLF
	RFALSE
?L52:	ADD PTR,P-LEXELEN >PTR
	GETB P-LEXV,P-LEXWORDS >STACK
	DEC 'STACK
	PUTB P-LEXV,P-LEXWORDS,STACK
?L57:	GETB P-LEXV,P-LEXWORDS >STACK
	GRTR? STACK,0 \?L58
	ICALL STUFF,RESERVE-LEXV,P-LEXV
	ICALL INBUF-STUFF,RESERVE-INBUF,P-INBUF
	SET 'RESERVE-PTR,PTR
	JUMP ?L60
?L58:	SET 'RESERVE-PTR,0
?L60:	SET 'WINNER,OWINNER
	SET 'P-MERGED,OMERGED
	ICALL INBUF-STUFF,P-INBUF,OOPS-INBUF
	ICALL STUFF,P-LEXV,AGAIN-LEXV
	SET 'DIR,AGAIN-DIR
	COPYT P-OTBL,P-ITBL,20
	JUMP ?L61
?L46:	ICALL STUFF,AGAIN-LEXV,P-LEXV
	ICALL INBUF-STUFF,OOPS-INBUF,P-INBUF
	PUT OOPS-TABLE,O-START,PTR
	MUL 4,P-LEN >STACK
	PUT OOPS-TABLE,O-LENGTH,STACK
	GETB P-LEXV,P-LEXWORDS >STACK
	MUL P-LEXELEN,STACK >STACK
	ADD PTR,STACK >STACK
	MUL 2,STACK >LEN
	SUB LEN,2 >STACK
	GETB P-LEXV,STACK >STACK
	SUB LEN,1 >STACK
	GETB P-LEXV,STACK >STACK
	ADD STACK,STACK >STACK
	PUT OOPS-TABLE,O-END,STACK
	SET 'RESERVE-PTR,0
	SET 'LEN,P-LEN
	PUT P-NAMW,0,0
	PUT P-NAMW,1,0
	PUT P-OFW,0,0
	PUT P-OFW,1,0
	PUT P-ADJW,0,0
	PUT P-ADJW,1,0
	SET 'P-NCN,0
	SET 'P-GETFLAGS,0
?L62:	DLESS? 'P-LEN,0 \?L64
	SET 'QUOTE-FLAG,0
	JUMP ?L63
?L64:	GET P-LEXV,PTR >WRD
	ZERO? WRD \?L67
	CALL2 NUMBER?,PTR >WRD
	ZERO? WRD /?L66
?L67:	ZERO? P-LEN \?L68
	SET 'NW,0
	JUMP ?L70
?L68:	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >NW
?L70:	EQUAL? WRD,W?TO \?L71
	EQUAL? VERB,ACT?TELL \?L71
	PUT P-ITBL,P-VERB,ACT?TELL
	SET 'WRD,W?$QUOTE
	JUMP ?L74
?L71:	EQUAL? WRD,W?THEN \?L73
	GRTR? P-LEN,0 \?L73
	ZERO? VERB \?L73
	ZERO? QUOTE-FLAG \?L73
	PUT P-ITBL,P-VERB,ACT?TELL
	PUT P-ITBL,P-VERBN,0
	SET 'WRD,W?$QUOTE
	JUMP ?L74
?L73:	EQUAL? WRD,W?$PERIOD \?L74
	EQUAL? LW,W?MR \?L74
	DEC 'P-NCN
	ICALL CHANGE-LEXV,PTR,LW,1
	SET 'WRD,LW
	SET 'LW,0
?L74:	EQUAL? WRD,W?THEN,W?$PERIOD,W?$QUOTE \?L76
	EQUAL? WRD,W?$QUOTE \?L82
	ZERO? QUOTE-FLAG /?L80
	SET 'QUOTE-FLAG,0
	JUMP ?L82
?L80:	SET 'QUOTE-FLAG,1
?L82:	ZERO? P-LEN /?L84
	ADD PTR,P-LEXELEN >P-CONT
?L84:	PUTB P-LEXV,P-LEXWORDS,P-LEN
	JUMP ?L63
?L76:	CALL WT?,WRD,PS?DIRECTION,P1?DIRECTION >VAL
	ZERO? VAL /?L86
	EQUAL? VERB,0,ACT?WALK,ACT?GO \?L86
	EQUAL? LEN,1 \?L88
	ZERO? P-OFLAG /?L87
	CALL WT?,WRD,PS?ADJECTIVE >STACK
	ZERO? STACK /?L87
?L88:	EQUAL? LEN,2 \?L89
	EQUAL? VERB,ACT?WALK,ACT?GO /?L87
?L89:	EQUAL? NW,W?THEN,W?$PERIOD,W?$QUOTE \?L90
	LESS? LEN,2 \?L87
?L90:	ZERO? QUOTE-FLAG /?L91
	EQUAL? LEN,2 \?L91
	EQUAL? NW,W?$QUOTE /?L87
?L91:	GRTR? LEN,2 \?L86
	EQUAL? NW,W?$COMMA,W?AND \?L86
?L87:	SET 'DIR,VAL
	EQUAL? NW,W?$COMMA,W?AND \?L92
	ADD PTR,P-LEXELEN >STACK
	ICALL CHANGE-LEXV,STACK,W?THEN
?L92:	GRTR? LEN,2 /?L130
	SET 'QUOTE-FLAG,0
	JUMP ?L63
?L86:	CALL WT?,WRD,PS?VERB,P1?VERB >VAL
	ZERO? VAL /?L98
	ZERO? VERB \?L98
	SET 'P-PRSA-WORD,WRD
	SET 'VERB,VAL
	PUT P-ITBL,P-VERB,VAL
	PUT P-ITBL,P-VERBN,P-VTBL
	PUT P-VTBL,0,WRD
	MUL PTR,2 >STACK
	ADD STACK,2 >CNT
	GETB P-LEXV,CNT >STACK
	PUTB P-VTBL,2,STACK
	ADD CNT,1 >STACK
	GETB P-LEXV,STACK >STACK
	PUTB P-VTBL,3,STACK
	JUMP ?L130
?L98:	CALL WT?,WRD,PS?PREPOSITION,0 >VAL
	ZERO? VAL \?L100
	EQUAL? WRD,W?ALL,W?ONE,W?BOTH /?L100
	CALL WT?,WRD,PS?ADJECTIVE >STACK
	ZERO? STACK \?L100
	CALL WT?,WRD,PS?OBJECT >STACK
	ZERO? STACK /?L99
?L100:	GRTR? P-LEN,1 \?L101
	EQUAL? NW,W?OF \?L101
	ZERO? VAL \?L140
	EQUAL? WRD,W?ALL,W?ONE,W?A /?L101
	EQUAL? WRD,W?BOTH /?L101
	GET P-OFW,P-NCN >STACK
	ZERO? STACK \?L101
	PUT P-OFW,P-NCN,WRD
	SET 'OF-FLAG,1
	JUMP ?L130
?L101:	ZERO? VAL /?L103
?L140:	ZERO? P-LEN /?L104
	EQUAL? NW,W?THEN,W?$PERIOD \?L103
?L104:	SET 'P-END-ON-PREP,1
	LESS? P-NCN,2 \?L130
	PUT P-ITBL,P-PREP1,VAL
	PUT P-ITBL,P-PREP1N,WRD
	JUMP ?L130
?L103:	EQUAL? P-NCN,2 \?L108
	PRINTI "[There were too many nouns in that sentence.]"
	CRLF
	RFALSE
?L108:	INC 'P-NCN
	EQUAL? VAL,PR?IN \?L110
	EQUAL? NW,W?FRONT \?L110
	SET 'IN-FRONT-FLAG,1
	JUMP ?L112
?L110:	EQUAL? VAL,PR?DOWN \?L112
	EQUAL? NW,W?IN \?L112
	ADD PTR,4 >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?FRONT \?L112
	SET 'IN-FRONT-FLAG,1
?L112:	CALL CLAUSE,PTR,VAL,WRD >PTR
	ZERO? PTR /FALSE
	LESS? PTR,0 \?L130
	SET 'QUOTE-FLAG,0
	JUMP ?L63
?L99:	EQUAL? WRD,W?OF \?L119
	ZERO? OF-FLAG /?L122
	EQUAL? NW,W?$PERIOD,W?THEN \?L120
?L122:	ICALL2 CANT-USE,PTR
	RFALSE
?L120:	SET 'OF-FLAG,0
	JUMP ?L130
?L119:	CALL WT?,WRD,PS?BUZZ-WORD >STACK
	ZERO? STACK /?L124
	EQUAL? WRD,W?MINUTES,W?MINUTE \?L130
	SET 'MINUTES-FLAG,1
	JUMP ?L130
?L124:	EQUAL? VERB,ACT?TELL \?L128
	CALL WT?,WRD,PS?VERB >STACK
	ZERO? STACK /?L128
	PRINTI "[Please consult your manual for the correct way to talk to characters.]"
	CRLF
	RFALSE
?L128:	ICALL2 CANT-USE,PTR
	RFALSE
?L66:	ICALL2 UNKNOWN-WORD,PTR
	RFALSE
?L130:	SET 'LW,WRD
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L62
?L63:	PUT OOPS-TABLE,O-CONT,P-CONT
	PUT OOPS-TABLE,O-LEN,P-LEN
?L61:	PUT OOPS-TABLE,O-PTR,0
	ZERO? DIR /?L131
	SET 'PRSA,V?WALK
	SET 'PRSO,DIR
	SET 'P-OFLAG,0
	SET 'P-WALK-DIR,DIR
	SET 'AGAIN-DIR,DIR
	RTRUE
?L131:	ZERO? P-OFLAG /?L134
	ICALL1 ORPHAN-MERGE
?L134:	SET 'P-WALK-DIR,0
	SET 'AGAIN-DIR,0
	CALL1 SYNTAX-CHECK >STACK
	ZERO? STACK /FALSE
	CALL1 SNARF-OBJECTS >STACK
	ZERO? STACK /FALSE
	CALL1 MANY-CHECK >STACK
	ZERO? STACK /FALSE
	CALL1 TAKE-CHECK >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT CHANGE-LEXV,PTR,WRD,BPTR,X,Y,Z
	ASSIGNED? 'BPTR /?L4
	SET 'BPTR,0
?L4:	ZERO? BPTR /?L1
	SUB PTR,P-LEXELEN >STACK
	MUL 2,STACK >STACK
	ADD 2,STACK >X
	GETB P-LEXV,X >Y
	MUL 2,PTR >STACK
	ADD 2,STACK >Z
	PUTB P-LEXV,Z,Y
	PUTB AGAIN-LEXV,Z,Y
	ADD 1,X >STACK
	GETB P-LEXV,STACK >Y
	MUL 2,PTR >STACK
	ADD 3,STACK >Z
	PUTB P-LEXV,Z,Y
	PUTB AGAIN-LEXV,Z,Y
?L1:	PUT P-LEXV,PTR,WRD
	PUT AGAIN-LEXV,PTR,WRD
	RTRUE

	.FUNCT STUFF,DEST,SRC,MAX
	ASSIGNED? 'MAX /?L1
	SET 'MAX,29
?L1:	MUL MAX,4 >STACK
	COPYT SRC,DEST,STACK
	RTRUE

	.FUNCT INBUF-STUFF,DEST,SRC
	COPYT SRC,DEST,60
	RTRUE

	.FUNCT INBUF-ADD,LEN,BEG,SLOT,DBEG,CTR,TMP
	SET 'CTR,0
	GET OOPS-TABLE,O-END >TMP
	ZERO? TMP /?L1
	SET 'DBEG,TMP
	JUMP ?L3
?L1:	GET OOPS-TABLE,O-LENGTH >TMP
	ADD TMP,1 >STACK
	GETB AGAIN-LEXV,STACK >STACK
	GETB AGAIN-LEXV,TMP >STACK
	ADD STACK,STACK >DBEG
?L3:	ADD DBEG,LEN >STACK
	PUT OOPS-TABLE,O-END,STACK
	ADD OOPS-INBUF,DBEG >STACK
	ADD P-INBUF,BEG >STACK
	COPYT STACK,STACK,LEN
	PUTB AGAIN-LEXV,SLOT,DBEG
	SUB SLOT,1 >STACK
	PUTB AGAIN-LEXV,STACK,LEN
	RTRUE

	.FUNCT WT?,PTR,BIT,B1,OFFS,TYP
	ASSIGNED? 'B1 /?L11
	SET 'B1,5
?L11:	SET 'OFFS,P-P1OFF
	GETB PTR,P-PSOFF >TYP
	BTST TYP,BIT \FALSE
	GRTR? B1,4 /TRUE
	EQUAL? BIT,PS?OBJECT /TRUE
	BAND TYP,P-P1BITS >TYP
	EQUAL? TYP,B1 /?L7
	INC 'OFFS
?L7:	GETB PTR,OFFS >STACK
	RSTACK

	.FUNCT CLAUSE,PTR,VAL,WRD,OFF,NUM,ANDFLG,FIRST??,NW,LW
	SET 'ANDFLG,0
	SET 'FIRST??,1
	SET 'LW,0
	SUB P-NCN,1 >STACK
	MUL STACK,2 >OFF
	ZERO? VAL /?L1
	ADD P-PREP1,OFF >NUM
	PUT P-ITBL,NUM,VAL
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,WRD
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L3
?L1:	INC 'P-LEN
?L3:	ZERO? P-LEN \?L4
	DEC 'P-NCN
	RETURN -1
?L4:	ADD P-NC1,OFF >NUM
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	PUT P-ITBL,NUM,STACK
	GET P-LEXV,PTR >STACK
	EQUAL? STACK,W?THE,W?A,W?AN \?L7
	GET P-ITBL,NUM >STACK
	ADD STACK,4 >STACK
	PUT P-ITBL,NUM,STACK
?L7:	DLESS? 'P-LEN,0 \?L12
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,STACK
	RETURN -1
?L12:	GET P-LEXV,PTR >WRD
	ZERO? WRD \?L17
	CALL2 NUMBER?,PTR >WRD
	ZERO? WRD /?L15
?L17:	ZERO? P-LEN \?L18
	SET 'NW,0
	JUMP ?L21
?L18:	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >NW
	ZERO? NW \?L21
	ADD PTR,P-LEXELEN >STACK
	CALL2 NUMBER?,STACK >NW
?L21:	EQUAL? WRD,W?$PERIOD \?L24
	EQUAL? LW,W?MR \?L24
	SET 'LW,0
	JUMP ?L47
?L24:	EQUAL? WRD,W?AND,W?$COMMA \?L26
	SET 'ANDFLG,1
	JUMP ?L47
?L26:	EQUAL? WRD,W?ALL,W?ONE,W?BOTH \?L27
	EQUAL? NW,W?OF \?L47
	DEC 'P-LEN
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L47
?L27:	EQUAL? WRD,W?THEN,W?$PERIOD /?L32
	CALL WT?,WRD,PS?PREPOSITION >STACK
	ZERO? STACK /?L31
	GET P-ITBL,P-VERB >STACK
	ZERO? STACK /?L31
	ZERO? FIRST?? \?L31
?L32:	INC 'P-LEN
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,STACK
	SUB PTR,P-LEXELEN >STACK
	RSTACK
?L31:	ZERO? ANDFLG /?L33
	GET P-ITBL,P-VERB >STACK
	ZERO? STACK \?L33
	SUB PTR,4 >PTR
	ADD PTR,2 >STACK
	ICALL CHANGE-LEXV,STACK,W?THEN
	ADD P-LEN,2 >P-LEN
	JUMP ?L47
?L33:	CALL WT?,WRD,PS?OBJECT >STACK
	ZERO? STACK /?L34
	GRTR? P-LEN,0 \?L35
	EQUAL? NW,W?OF \?L35
	EQUAL? WRD,W?ALL,W?ONE /?L35
	SUB P-NCN,1 >STACK
	PUT P-OFW,STACK,WRD
	JUMP ?L47
?L35:	CALL WT?,WRD,PS?ADJECTIVE >STACK
	ZERO? STACK /?L37
	ZERO? NW /?L37
	CALL WT?,NW,PS?OBJECT >STACK
	ZERO? STACK \?L47
?L37:	ZERO? ANDFLG \?L38
	EQUAL? NW,W?BUT,W?EXCEPT,W?AND /?L38
	EQUAL? NW,W?$COMMA /?L38
	ADD PTR,2 >STACK
	MUL STACK,2 >STACK
	ADD P-LEXV,STACK >STACK
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,STACK
	RETURN PTR
?L38:	SET 'ANDFLG,0
	JUMP ?L47
?L34:	CALL WT?,WRD,PS?ADJECTIVE >STACK
	ZERO? STACK \?L41
	CALL WT?,WRD,PS?BUZZ-WORD >STACK
	ZERO? STACK /?L40
?L41:	EQUAL? WRD,W?MINUTES,W?MINUTE \?L47
	SET 'MINUTES-FLAG,1
	JUMP ?L47
?L40:	CALL WT?,WRD,PS?PREPOSITION >STACK
	ZERO? STACK \?L47
	ICALL2 CANT-USE,PTR
	RFALSE
?L15:	ICALL2 UNKNOWN-WORD,PTR
	RFALSE
?L47:	SET 'LW,WRD
	SET 'FIRST??,0
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L7

	.FUNCT NUMBER?,PTR,CNT,BPTR,CHR,SUM,TIM,EXC
	SET 'SUM,0
	SET 'TIM,0
	SET 'EXC,0
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	GETB STACK,2 >CNT
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	GETB STACK,3 >BPTR
?L1:	DLESS? 'CNT,0 /?L2
	GETB P-INBUF,BPTR >CHR
	EQUAL? CHR,58 \?L6
	ZERO? EXC \FALSE
	SET 'TIM,SUM
	SET 'SUM,0
	JUMP ?L17
?L6:	EQUAL? CHR,45,47 \?L11
	ZERO? TIM \FALSE
	SET 'EXC,SUM
	SET 'SUM,0
	JUMP ?L17
?L11:	GRTR? SUM,9999 /FALSE
	LESS? CHR,58 \FALSE
	GRTR? CHR,47 \FALSE
	SUB CHR,48 >STACK
	MUL SUM,10 >STACK
	ADD STACK,STACK >SUM
?L17:	INC 'BPTR
	JUMP ?L1
?L2:	ICALL CHANGE-LEXV,PTR,W?NUMBER
	GRTR? SUM,9999 /FALSE
	ZERO? EXC /?L20
	SET 'P-EXCHANGE,EXC
	JUMP ?L28
?L20:	ZERO? TIM /?L21
	SET 'P-EXCHANGE,0
	GRTR? TIM,23 /FALSE
	GRTR? TIM,19 /?L27
	GRTR? TIM,12 /FALSE
	GRTR? TIM,7 /?L27
	ADD 12,TIM >TIM
?L27:	MUL TIM,60 >STACK
	ADD SUM,STACK >SUM
	JUMP ?L28
?L21:	SET 'P-EXCHANGE,0
?L28:	SET 'P-NUMBER,SUM
	RETURN W?NUMBER

	.FUNCT ORPHAN-MERGE,CNT,TEMP,VERB,BEG,END,ADJ,WRD,?TMP
	SET 'CNT,-1
	SET 'ADJ,0
	SET 'P-OFLAG,0
	GET P-ITBL,P-VERBN >STACK
	GET STACK,0 >WRD
	CALL WT?,WRD,PS?VERB,P1?VERB >?TMP
	GET P-OTBL,P-VERB >STACK
	EQUAL? ?TMP,STACK /?L3
	CALL WT?,WRD,PS?ADJECTIVE >STACK
	ZERO? STACK /?L1
?L3:	SET 'ADJ,1
	JUMP ?L4
?L1:	CALL WT?,WRD,PS?OBJECT >STACK
	ZERO? STACK /?L4
	ZERO? P-NCN \?L4
	PUT P-ITBL,P-VERB,0
	PUT P-ITBL,P-VERBN,0
	ADD P-LEXV,2 >STACK
	PUT P-ITBL,P-NC1,STACK
	ADD P-LEXV,6 >STACK
	PUT P-ITBL,P-NC1L,STACK
	SET 'P-NCN,1
?L4:	GET P-ITBL,P-VERB >VERB
	ZERO? VERB /?L6
	ZERO? ADJ \?L6
	GET P-OTBL,P-VERB >STACK
	EQUAL? VERB,STACK \FALSE
?L6:	EQUAL? P-NCN,2 /FALSE
	GET P-OTBL,P-NC1 >STACK
	EQUAL? STACK,1 \?L9
	GET P-ITBL,P-PREP1 >TEMP
	GET P-OTBL,P-PREP1 >STACK
	EQUAL? TEMP,STACK /?L12
	ZERO? TEMP \FALSE
?L12:	ZERO? ADJ /?L13
	ADD P-LEXV,2 >STACK
	PUT P-OTBL,P-NC1,STACK
	GET P-ITBL,P-NC1L >STACK
	ZERO? STACK \?L15
	ADD P-LEXV,6 >STACK
	PUT P-ITBL,P-NC1L,STACK
?L15:	ZERO? P-NCN \?L21
	SET 'P-NCN,1
	JUMP ?L21
?L13:	GET P-ITBL,P-NC1 >STACK
	PUT P-OTBL,P-NC1,STACK
?L21:	GET P-ITBL,P-NC1L >STACK
	PUT P-OTBL,P-NC1L,STACK
	JUMP ?L42
?L9:	GET P-OTBL,P-NC2 >STACK
	EQUAL? STACK,1 \?L23
	GET P-ITBL,P-PREP1 >TEMP
	GET P-OTBL,P-PREP2 >STACK
	EQUAL? TEMP,STACK /?L26
	ZERO? TEMP \FALSE
?L26:	ZERO? ADJ /?L29
	ADD P-LEXV,2 >STACK
	PUT P-ITBL,P-NC1,STACK
	GET P-ITBL,P-NC1L >STACK
	ZERO? STACK \?L29
	ADD P-LEXV,6 >STACK
	PUT P-ITBL,P-NC1L,STACK
?L29:	GET P-ITBL,P-NC1 >STACK
	PUT P-OTBL,P-NC2,STACK
	GET P-ITBL,P-NC1L >STACK
	PUT P-OTBL,P-NC2L,STACK
	SET 'P-NCN,2
	JUMP ?L42
?L23:	ZERO? P-ACLAUSE /?L42
	EQUAL? P-NCN,1 /?L35
	ZERO? ADJ \?L35
	SET 'P-ACLAUSE,0
	RFALSE
?L35:	GET P-ITBL,P-NC1 >BEG
	ZERO? ADJ /?L38
	ADD P-LEXV,2 >BEG
	SET 'ADJ,0
?L38:	GET P-ITBL,P-NC1L >END
?L41:	GET BEG,0 >WRD
	EQUAL? BEG,END \?L43
	ZERO? ADJ /?L45
	ICALL2 ACLAUSE-WIN,ADJ
	JUMP ?L42
?L45:	SET 'P-ACLAUSE,0
	RFALSE
?L43:	ZERO? ADJ \?L48
	GETB WRD,P-PSOFF >STACK
	BTST STACK,PS?ADJECTIVE /?L49
	EQUAL? WRD,W?ALL,W?ONE \?L48
?L49:	SET 'ADJ,WRD
	JUMP ?L51
?L48:	EQUAL? WRD,W?ONE \?L50
	ICALL2 ACLAUSE-WIN,ADJ
	JUMP ?L42
?L50:	GETB WRD,P-PSOFF >STACK
	BTST STACK,PS?OBJECT \?L51
	EQUAL? WRD,P-ANAM \?L52
	ICALL2 ACLAUSE-WIN,ADJ
	JUMP ?L42
?L52:	ICALL1 NCLAUSE-WIN
	JUMP ?L42
?L51:	ADD BEG,P-WORDLEN >BEG
	ZERO? END \?L41
	SET 'END,BEG
	SET 'P-NCN,1
	SUB BEG,4 >STACK
	PUT P-ITBL,P-NC1,STACK
	PUT P-ITBL,P-NC1L,BEG
	JUMP ?L41
?L42:	GET P-OVTBL,0 >STACK
	PUT P-VTBL,0,STACK
	GETB P-OVTBL,2 >STACK
	PUTB P-VTBL,2,STACK
	GETB P-OVTBL,3 >STACK
	PUTB P-VTBL,3,STACK
	PUT P-OTBL,P-VERBN,P-VTBL
	PUTB P-VTBL,2,0
	COPYT P-OTBL,P-ITBL,20
	SET 'P-MERGED,1
	RTRUE

	.FUNCT ACLAUSE-WIN,ADJ
	GET P-OTBL,P-VERB >STACK
	PUT P-ITBL,P-VERB,STACK
	ADD P-ACLAUSE,1 >STACK
	ADD P-ACLAUSE,1 >STACK
	IXCALL CLAUSE-COPY,P-OTBL,P-OTBL,P-ACLAUSE,STACK,P-ACLAUSE,STACK,ADJ
	GET P-OTBL,P-NC2 >STACK
	ZERO? STACK /?L1
	SET 'P-NCN,2
?L1:	SET 'P-ACLAUSE,0
	RTRUE

	.FUNCT NCLAUSE-WIN
	ADD P-ACLAUSE,1 >STACK
	IXCALL CLAUSE-COPY,P-ITBL,P-OTBL,P-NC1,P-NC1L,P-ACLAUSE,STACK
	GET P-OTBL,P-NC2 >STACK
	ZERO? STACK /?L1
	SET 'P-NCN,2
?L1:	SET 'P-ACLAUSE,0
	RTRUE

	.FUNCT WORD-PRINT,CNT,BUF
?L1:	DLESS? 'CNT,0 /TRUE
	GETB P-INBUF,BUF >STACK
	PRINTC STACK
	INC 'BUF
	JUMP ?L1

	.FUNCT UNKNOWN-WORD,PTR,BUF,?TMP
	PUT OOPS-TABLE,O-PTR,PTR
	PRINTI "[I don't know"
	PRINTI " the word """
	MUL PTR,2 >BUF
	ADD P-LEXV,BUF >STACK
	GETB STACK,2 >?TMP
	ADD P-LEXV,BUF >STACK
	GETB STACK,3 >STACK
	ICALL WORD-PRINT,?TMP,STACK
	PRINTI ".""]"
	CRLF
	SET 'QUOTE-FLAG,0
	RETURN QUOTE-FLAG

	.FUNCT CANT-USE,PTR,BUF,?TMP
	PRINTI "[You used the word """
	MUL PTR,2 >BUF
	ADD P-LEXV,BUF >STACK
	GETB STACK,2 >?TMP
	ADD P-LEXV,BUF >STACK
	GETB STACK,3 >STACK
	ICALL WORD-PRINT,?TMP,STACK
	PRINTI """ in a way that I don't understand.]"
	CRLF
	SET 'QUOTE-FLAG,0
	SET 'P-OFLAG,0
	RETURN P-OFLAG

	.FUNCT SYNTAX-CHECK,SYN,LEN,NUM,OBJ,DRIVE1,DRIVE2,PREP,VERB,TMP
	SET 'DRIVE1,0
	SET 'DRIVE2,0
	GET P-ITBL,P-VERB >VERB
	ZERO? VERB \?L1
	PRINTI "[There was no verb in that sentence!]"
	CRLF
	RFALSE
?L1:	SUB 255,VERB >STACK
	GET VERBS,STACK >SYN
	GETB SYN,0 >LEN
	INC 'SYN
?L4:	GETB SYN,P-SBITS >STACK
	BAND STACK,P-SONUMS >NUM
	GRTR? P-NCN,NUM /?L13
	LESS? NUM,1 /?L8
	ZERO? P-NCN \?L8
	GET P-ITBL,P-PREP1 >PREP
	ZERO? PREP /?L9
	GETB SYN,P-SPREP1 >STACK
	EQUAL? PREP,STACK \?L8
?L9:	SET 'DRIVE1,SYN
	JUMP ?L13
?L8:	GET P-ITBL,P-PREP1 >STACK
	GETB SYN,P-SPREP1 >STACK
	EQUAL? STACK,STACK \?L13
	EQUAL? NUM,2 \?L11
	EQUAL? P-NCN,1 \?L11
	SET 'DRIVE2,SYN
	JUMP ?L13
?L11:	GET P-ITBL,P-PREP2 >STACK
	GETB SYN,P-SPREP2 >STACK
	EQUAL? STACK,STACK \?L13
	ICALL2 SYNTAX-FOUND,SYN
	RTRUE
?L13:	DLESS? 'LEN,1 \?L16
	ZERO? DRIVE1 \?L49
	ZERO? DRIVE2 \?L5
	PRINT RECOGNIZE
	RFALSE
?L16:	ADD SYN,P-SYNLEN >SYN
	JUMP ?L4
?L5:	ZERO? DRIVE1 /?L23
?L49:	GETB DRIVE1,P-SPREP1 >STACK
	GETB DRIVE1,P-SLOC1 >STACK
	GETB DRIVE1,P-SFWIM1 >STACK
	CALL GWIM,STACK,STACK,STACK >OBJ
	ZERO? OBJ /?L23
	PUT P-PRSO,P-MATCHLEN,1
	PUT P-PRSO,1,OBJ
	CALL2 SYNTAX-FOUND,DRIVE1 >STACK
	RSTACK
?L23:	ZERO? DRIVE2 /?L25
	GETB DRIVE2,P-SPREP2 >STACK
	GETB DRIVE2,P-SLOC2 >STACK
	GETB DRIVE2,P-SFWIM2 >STACK
	CALL GWIM,STACK,STACK,STACK >OBJ
	ZERO? OBJ /?L25
	PUT P-PRSI,P-MATCHLEN,1
	PUT P-PRSI,1,OBJ
	CALL2 SYNTAX-FOUND,DRIVE2 >STACK
	RSTACK
?L25:	EQUAL? VERB,ACT?FIND \?L26
	PRINTI "[I can't answer that question.]"
	CRLF
	RFALSE
?L26:	EQUAL? WINNER,PROTAGONIST \?L28
	ICALL ORPHAN,DRIVE1,DRIVE2
	PRINTI "[Wh"
	JUMP ?L30
?L28:	PRINTI "[Your command was not complete. Next time, type wh"
?L30:	EQUAL? VERB,ACT?WALK,ACT?GO \?L31
	PRINTI "ere"
	JUMP ?L36
?L31:	ZERO? DRIVE1 /?L35
	GETB DRIVE1,P-SFWIM1 >STACK
	EQUAL? STACK,PERSON /?L34
?L35:	ZERO? DRIVE2 /?L33
	GETB DRIVE2,P-SFWIM2 >STACK
	EQUAL? STACK,PERSON \?L33
?L34:	PRINTI "om"
	JUMP ?L36
?L33:	PRINTI "at"
?L36:	EQUAL? WINNER,PROTAGONIST \?L37
	PRINTI " do you want to "
	JUMP ?L39
?L37:	PRINTI " you want "
	ICALL2 TPRINT,WINNER
	PRINTI " to "
?L39:	ICALL1 VERB-PRINT
	ZERO? DRIVE2 /?L40
	ICALL CLAUSE-PRINT,P-NC1,P-NC1L
?L40:	SET 'P-END-ON-PREP,0
	ZERO? DRIVE1 /?L43
	GETB DRIVE1,P-SPREP1 >STACK
	JUMP ?L45
?L43:	GETB DRIVE2,P-SPREP2 >STACK
?L45:	ICALL2 PREP-PRINT,STACK
	EQUAL? WINNER,PROTAGONIST \?L46
	SET 'P-OFLAG,1
	PRINTI "?]"
	CRLF
	RFALSE
?L46:	SET 'P-OFLAG,0
	PRINTI ".]"
	CRLF
	RFALSE

	.FUNCT VERB-PRINT,TMP
	GET P-ITBL,P-VERBN >TMP
	ZERO? TMP \?L1
	PRINTI "tell"
	RTRUE
?L1:	GETB P-VTBL,2 >STACK
	ZERO? STACK \?L3
	GET TMP,0 >STACK
	PRINTB STACK
	RTRUE
?L3:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	ICALL WORD-PRINT,STACK,STACK
	PUTB P-VTBL,2,0
	RTRUE

	.FUNCT ORPHAN,D1,D2?1,CNT
	SET 'CNT,-1
	ZERO? P-MERGED \?L1
	PUT P-OCLAUSE,P-MATCHLEN,0
?L1:	GET P-VTBL,0 >STACK
	PUT P-OVTBL,0,STACK
	GETB P-VTBL,2 >STACK
	PUTB P-OVTBL,2,STACK
	GETB P-VTBL,3 >STACK
	PUTB P-OVTBL,3,STACK
	COPYT P-ITBL,P-OTBL,20
	EQUAL? P-NCN,2 \?L4
	IXCALL CLAUSE-COPY,P-ITBL,P-OTBL,P-NC2,P-NC2L,P-NC2,P-NC2L
?L4:	LESS? P-NCN,1 /?L7
	IXCALL CLAUSE-COPY,P-ITBL,P-OTBL,P-NC1,P-NC1L,P-NC1,P-NC1L
?L7:	ZERO? D1 /?L10
	GETB D1,P-SPREP1 >STACK
	PUT P-OTBL,P-PREP1,STACK
	PUT P-OTBL,P-NC1,1
	RTRUE
?L10:	ZERO? D2?1 /FALSE
	GETB D2?1,P-SPREP2 >STACK
	PUT P-OTBL,P-PREP2,STACK
	PUT P-OTBL,P-NC2,1
	RTRUE

	.FUNCT ORPHAN-VERB
	PUT P-VTBL,0,W?ZZMGCK
	PUT P-OVTBL,0,W?ANSWER
	PUT P-OTBL,P-VERB,ACT?$0024ID
	PUT P-OTBL,P-VERBN,P-VTBL
	PUT P-OTBL,P-PREP1,0
	PUT P-OTBL,P-PREP1N,0
	PUT P-OTBL,P-PREP2,0
	PUT P-OTBL,5,0
	PUT P-OTBL,P-NC1,1
	PUT P-OTBL,P-NC1L,0
	PUT P-OTBL,P-NC2,0
	PUT P-OTBL,P-NC2L,0
	SET 'P-OFLAG,1
	RETURN P-OFLAG

	.FUNCT CLAUSE-PRINT,BPTR,EPTR,THE?
	ASSIGNED? 'THE? /?L1
	SET 'THE?,1
?L1:	GET P-ITBL,EPTR >STACK
	GET P-ITBL,BPTR >STACK
	CALL BUFFER-PRINT,STACK,STACK,THE? >STACK
	RSTACK

	.FUNCT BUFFER-PRINT,BEG,END,CP,NOSP,WRD,FIRST??,PN
	SET 'NOSP,0
	SET 'FIRST??,1
	SET 'PN,0
?L1:	EQUAL? BEG,END /TRUE
	ZERO? NOSP /?L6
	SET 'NOSP,0
	JUMP ?L8
?L6:	PRINTI " "
?L8:	GET BEG,0 >WRD
	EQUAL? WRD,W?$PERIOD \?L9
	SET 'NOSP,1
	JUMP ?L14
?L9:	EQUAL? WRD,W?ME \?L11
	PRINTD ME
	SET 'PN,1
	JUMP ?L14
?L11:	EQUAL? WRD,W?MY \?L12
	PRINTI "your"
	SET 'PN,1
	JUMP ?L14
?L12:	CALL2 NAME?,WRD >STACK
	ZERO? STACK /?L13
	ICALL2 CAPITALIZE,BEG
	SET 'PN,1
	JUMP ?L14
?L13:	ZERO? FIRST?? /?L15
	ZERO? PN \?L15
	ZERO? CP /?L15
	PRINTI "the "
?L15:	ZERO? P-OFLAG \?L20
	ZERO? P-MERGED /?L18
?L20:	PRINTB WRD
	JUMP ?L24
?L18:	EQUAL? WRD,W?IT,W?THEM \?L21
	CALL2 ACCESSIBLE?,P-IT-OBJECT >STACK
	ZERO? STACK /?L21
	PRINTD P-IT-OBJECT
	JUMP ?L24
?L21:	EQUAL? WRD,W?HIM,W?HIMSELF \?L22
	CALL2 ACCESSIBLE?,P-HIM-OBJECT >STACK
	ZERO? STACK /?L22
	ICALL2 DPRINT,P-HIM-OBJECT
	JUMP ?L24
?L22:	EQUAL? WRD,W?HER,W?HERSELF \?L23
	CALL2 ACCESSIBLE?,P-HER-OBJECT >STACK
	ZERO? STACK /?L23
	ICALL2 DPRINT,P-HER-OBJECT
	JUMP ?L24
?L23:	GETB BEG,3 >STACK
	GETB BEG,2 >STACK
	ICALL WORD-PRINT,STACK,STACK
?L24:	SET 'FIRST??,0
?L14:	ADD BEG,P-WORDLEN >BEG
	JUMP ?L1

	.FUNCT NAME?,WRD
	EQUAL? WRD,W?TOPAZ,W?RIZNIK \FALSE
	RTRUE

	.FUNCT CAPITALIZE,PTR
	ZERO? P-OFLAG \?L3
	ZERO? P-MERGED /?L1
?L3:	GET PTR,0 >STACK
	PRINTB STACK
	RTRUE
?L1:	GETB PTR,3 >STACK
	GETB P-INBUF,STACK >STACK
	SUB STACK,32 >STACK
	PRINTC STACK
	GETB PTR,3 >STACK
	INC 'STACK
	GETB PTR,2 >STACK
	DEC 'STACK
	CALL WORD-PRINT,STACK,STACK >STACK
	RSTACK

	.FUNCT PREP-PRINT,PREP,WRD
	ZERO? PREP /FALSE
	PRINTI " "
	CALL2 PREP-FIND,PREP >WRD
	PRINTB WRD
	RTRUE

	.FUNCT CLAUSE-COPY,SRC,DEST,SRCBEG,SRCEND,DESTBEG,DESTEND,INSRT,BEG,END
	ASSIGNED? 'INSRT /?L9
	SET 'INSRT,0
?L9:	GET SRC,SRCBEG >BEG
	GET SRC,SRCEND >END
	GET P-OCLAUSE,P-MATCHLEN >STACK
	MUL STACK,P-LEXELEN >STACK
	ADD STACK,2 >STACK
	ADD P-OCLAUSE,STACK >STACK
	PUT DEST,DESTBEG,STACK
?L1:	EQUAL? BEG,END \?L3
	GET P-OCLAUSE,P-MATCHLEN >STACK
	MUL STACK,P-LEXELEN >STACK
	ADD STACK,2 >STACK
	ADD P-OCLAUSE,STACK >STACK
	PUT DEST,DESTEND,STACK
	RTRUE
?L3:	ZERO? INSRT /?L6
	GET BEG,0 >STACK
	EQUAL? P-ANAM,STACK \?L6
	ICALL2 CLAUSE-ADD,INSRT
?L6:	GET BEG,0 >STACK
	ICALL2 CLAUSE-ADD,STACK
	ADD BEG,P-WORDLEN >BEG
	JUMP ?L1

	.FUNCT CLAUSE-ADD,WRD,PTR
	GET P-OCLAUSE,P-MATCHLEN >STACK
	ADD STACK,2 >PTR
	SUB PTR,1 >STACK
	PUT P-OCLAUSE,STACK,WRD
	PUT P-OCLAUSE,PTR,0
	PUT P-OCLAUSE,P-MATCHLEN,PTR
	RTRUE

	.FUNCT PREP-FIND,PREP,CNT,SIZE
	SET 'CNT,0
	GET PREPOSITIONS,0 >STACK
	MUL STACK,2 >SIZE
?L1:	IGRTR? 'CNT,SIZE /FALSE
	GET PREPOSITIONS,CNT >STACK
	EQUAL? STACK,PREP \?L1
	SUB CNT,1 >STACK
	GET PREPOSITIONS,STACK >STACK
	RSTACK

	.FUNCT SYNTAX-FOUND,SYN
	SET 'P-SYNTAX,SYN
	GETB SYN,P-SACTION >PRSA
	RETURN PRSA

	.FUNCT GWIM,GBIT,LBIT,PREP,OBJ
	EQUAL? GBIT,RLANDBIT \?L1
	RETURN ROOMS
?L1:	SET 'P-GWIMBIT,GBIT
	SET 'P-SLOCBITS,LBIT
	PUT P-MERGE,P-MATCHLEN,0
	CALL GET-OBJECT,P-MERGE,0 >STACK
	ZERO? STACK /?L4
	SET 'P-GWIMBIT,0
	GET P-MERGE,P-MATCHLEN >STACK
	EQUAL? STACK,1 \FALSE
	GET P-MERGE,1 >OBJ
	PRINTI "["
	ZERO? PREP /?L15
	ZERO? P-END-ON-PREP \?L15
	CALL2 PREP-FIND,PREP >PREP
	PRINTB PREP
	EQUAL? PREP,W?OUT \?L10
	PRINTI " of"
?L10:	FSET? OBJ,NARTICLEBIT /?L13
	PRINTI " the "
	JUMP ?L15
?L13:	PRINTI " "
?L15:	ICALL2 DPRINT,OBJ
	PRINTI "]"
	CRLF
	RETURN OBJ
?L4:	SET 'P-GWIMBIT,0
	RFALSE

	.FUNCT SNARF-OBJECTS,PTR
	GET P-ITBL,P-NC1 >PTR
	ZERO? PTR /?L5
	SET 'P-PHR,0
	GETB P-SYNTAX,P-SLOC1 >P-SLOCBITS
	GET P-ITBL,P-NC1L >STACK
	CALL SNARFEM,PTR,STACK,P-PRSO >STACK
	ZERO? STACK /FALSE
	GET P-BUTS,P-MATCHLEN >STACK
	ZERO? STACK /?L5
	CALL2 BUT-MERGE,P-PRSO >P-PRSO
?L5:	GET P-ITBL,P-NC2 >PTR
	ZERO? PTR /TRUE
	SET 'P-PHR,1
	GETB P-SYNTAX,P-SLOC2 >P-SLOCBITS
	GET P-ITBL,P-NC2L >STACK
	CALL SNARFEM,PTR,STACK,P-PRSI >STACK
	ZERO? STACK /FALSE
	GET P-BUTS,P-MATCHLEN >STACK
	ZERO? STACK /TRUE
	GET P-PRSI,P-MATCHLEN >STACK
	EQUAL? STACK,1 \?L14
	CALL2 BUT-MERGE,P-PRSO >P-PRSO
	RTRUE
?L14:	CALL2 BUT-MERGE,P-PRSI >P-PRSI
	RTRUE

	.FUNCT BUT-MERGE,TBL,LEN,BUTLEN,CNT,MATCHES?1,OBJ,NTBL
	SET 'CNT,1
	SET 'MATCHES?1,0
	GET TBL,P-MATCHLEN >LEN
	PUT P-MERGE,P-MATCHLEN,0
?L1:	DLESS? 'LEN,0 /?L2
	ZERO? P-BUTS /?L5
	GET TBL,CNT >OBJ
	GET P-BUTS,0 >STACK
	ADD P-BUTS,2 >STACK
	INTBL? OBJ,STACK,STACK >STACK /?L6
?L5:	ADD MATCHES?1,1 >STACK
	PUT P-MERGE,STACK,OBJ
	INC 'MATCHES?1
?L6:	INC 'CNT
	JUMP ?L1
?L2:	PUT P-MERGE,P-MATCHLEN,MATCHES?1
	SET 'NTBL,P-MERGE
	SET 'P-MERGE,TBL
	RETURN NTBL

	.FUNCT SNARFEM,PTR,EPTR,TBL,BUT,LEN,TMP,WRD,NW,ONEOBJ,WAS-ALL
	SET 'BUT,0
	SET 'WAS-ALL,0
	SET 'P-AND,0
	EQUAL? P-GETFLAGS,P-ALL \?L1
	SET 'WAS-ALL,1
?L1:	SET 'P-GETFLAGS,0
	PUT P-BUTS,P-MATCHLEN,0
	PUT TBL,P-MATCHLEN,0
	GET PTR,0 >WRD
?L4:	EQUAL? PTR,EPTR \?L6
?L60:	ZERO? BUT /?L9
	PUSH BUT
	JUMP ?L8
?L9:	PUSH TBL
?L8:	CALL2 GET-OBJECT,STACK >TMP
	ZERO? WAS-ALL /?L10
	SET 'P-GETFLAGS,P-ALL
?L10:	RETURN TMP
?L6:	ADD PTR,P-WORDLEN >STACK
	EQUAL? EPTR,STACK \?L14
	SET 'NW,0
	JUMP ?L16
?L14:	GET PTR,P-LEXELEN >NW
?L16:	EQUAL? WRD,W?ALL,W?BOTH \?L17
	SET 'P-GETFLAGS,P-ALL
	EQUAL? NW,W?OF \?L55
	ADD PTR,P-WORDLEN >PTR
	JUMP ?L55
?L17:	EQUAL? WRD,W?BUT,W?EXCEPT \?L22
	ZERO? BUT /?L26
	PUSH BUT
	JUMP ?L25
?L26:	PUSH TBL
?L25:	CALL2 GET-OBJECT,STACK >STACK
	ZERO? STACK /FALSE
	SET 'BUT,P-BUTS
	PUT BUT,P-MATCHLEN,0
	JUMP ?L55
?L22:	EQUAL? WRD,W?A,W?ONE \?L27
	ZERO? P-ADJ \?L28
	SET 'P-GETFLAGS,P-ONE
	EQUAL? NW,W?OF \?L55
	ADD PTR,P-WORDLEN >PTR
	JUMP ?L55
?L28:	SET 'P-NAM,ONEOBJ
	ZERO? BUT /?L37
	PUSH BUT
	JUMP ?L36
?L37:	PUSH TBL
?L36:	CALL2 GET-OBJECT,STACK >STACK
	ZERO? STACK /FALSE
	ZERO? NW /TRUE
	JUMP ?L55
?L27:	EQUAL? WRD,W?AND,W?$COMMA \?L40
	EQUAL? NW,W?AND,W?$COMMA /?L40
	SET 'P-AND,1
	ZERO? BUT /?L44
	PUSH BUT
	JUMP ?L43
?L44:	PUSH TBL
?L43:	CALL2 GET-OBJECT,STACK >STACK
	ZERO? STACK /FALSE
	JUMP ?L55
?L40:	CALL WT?,WRD,PS?BUZZ-WORD >STACK
	ZERO? STACK /?L45
	EQUAL? WRD,W?MINUTE,W?MINUTES \?L55
	SET 'MINUTES-FLAG,1
	JUMP ?L55
?L45:	EQUAL? WRD,W?AND,W?$COMMA /?L55
	EQUAL? WRD,W?OF \?L50
	ZERO? P-GETFLAGS \?L55
	SET 'P-GETFLAGS,P-INHIBIT
	JUMP ?L55
?L50:	CALL WT?,WRD,PS?ADJECTIVE >STACK
	ZERO? STACK /?L54
	CALL2 ADJ-CHECK,WRD >STACK
	ZERO? STACK /?L54
	EQUAL? NW,W?OF /?L54
	SET 'P-ADJ,WRD
	JUMP ?L55
?L54:	CALL WT?,WRD,PS?OBJECT >STACK
	ZERO? STACK /?L55
	SET 'P-NAM,WRD
	SET 'ONEOBJ,WRD
?L55:	EQUAL? PTR,EPTR /?L60
	ADD PTR,P-WORDLEN >PTR
	SET 'WRD,NW
	JUMP ?L4

	.FUNCT ADJ-CHECK,WRD
	ZERO? P-ADJ /TRUE
	EQUAL? WRD,W?MY \FALSE
	RTRUE

	.FUNCT NOUN-MISSING
	EQUAL? P-NAM,W?ALL,W?BOTH \?L1
	CALL1 REFERRING >STACK
	RSTACK
?L1:	PRINTR "[There seems to be a noun missing in that sentence.]"

	.FUNCT GET-OBJECT,TBL,VRB,BITS,LEN,XBITS,TLEN,GCHECK,OLEN,OBJ
	ASSIGNED? 'VRB /?L55
	SET 'VRB,1
?L55:	SET 'GCHECK,0
	SET 'OLEN,0
	SET 'XBITS,P-SLOCBITS
	GET TBL,P-MATCHLEN >TLEN
	BTST P-GETFLAGS,P-INHIBIT /TRUE
	ZERO? P-NAM \?L4
	ZERO? P-ADJ /?L6
	CALL WT?,P-ADJ,PS?OBJECT >STACK
	ZERO? STACK /?L4
	SET 'P-NAM,P-ADJ
	SET 'P-ADJ,0
	JUMP ?L6
?L4:	ZERO? P-ADJ /?L6
	CALL WT?,P-ADJ,PS?DIRECTION,P1?DIRECTION >BITS
	ZERO? BITS /?L6
	SET 'P-DIRECTION,BITS
?L6:	ZERO? P-NAM \?L8
	ZERO? P-ADJ \?L8
	EQUAL? P-GETFLAGS,P-ALL /?L56
	ZERO? P-GWIMBIT \?L8
	ZERO? VRB /FALSE
	ICALL1 NOUN-MISSING
	RFALSE
?L8:	EQUAL? P-GETFLAGS,P-ALL \?L16
?L56:	ZERO? P-SLOCBITS \?L14
?L16:	SET 'P-SLOCBITS,-1
?L14:	ZERO? GCHECK /?L20
	ICALL2 GLOBAL-CHECK,TBL
	JUMP ?L22
?L20:	FCLEAR PROTAGONIST,TRANSBIT
	IXCALL DO-SL,HERE,SOG,SIR,TBL
	FSET PROTAGONIST,TRANSBIT
	IXCALL DO-SL,PROTAGONIST,SH,SC,TBL
?L22:	GET TBL,P-MATCHLEN >STACK
	SUB STACK,TLEN >LEN
	BTST P-GETFLAGS,P-ALL /?L53
	BTST P-GETFLAGS,P-ONE \?L25
	ZERO? LEN /?L25
	EQUAL? LEN,1 /?L26
	RANDOM LEN >STACK
	GET TBL,STACK >STACK
	PUT TBL,1,STACK
	PRINTI "[How about the "
	GET TBL,1 >STACK
	PRINTD STACK
	PRINTI "?]"
	CRLF
?L26:	PUT TBL,P-MATCHLEN,1
	JUMP ?L53
?L25:	GRTR? LEN,1 /?L30
	ZERO? LEN \?L53
	EQUAL? P-SLOCBITS,-1 /?L29
?L30:	EQUAL? P-SLOCBITS,-1 \?L31
	SET 'P-SLOCBITS,XBITS
	SET 'OLEN,LEN
	GET TBL,P-MATCHLEN >STACK
	SUB STACK,LEN >STACK
	PUT TBL,P-MATCHLEN,STACK
	JUMP ?L14
?L31:	PUT P-NAMW,P-PHR,P-NAM
	PUT P-ADJW,P-PHR,P-ADJ
	ZERO? LEN \?L34
	SET 'LEN,OLEN
?L34:	ZERO? P-NAM /?L37
	ADD TLEN,1 >STACK
	GET TBL,STACK >OBJ
	ZERO? OBJ /?L37
	GETP OBJ,P?GENERIC >STACK
	CALL1 STACK >OBJ
	ZERO? OBJ /?L37
	EQUAL? OBJ,NOT-HERE-OBJECT /FALSE
	PUT TBL,1,OBJ
	PUT TBL,P-MATCHLEN,1
	SET 'P-NAM,0
	SET 'P-ADJ,0
	RTRUE
?L37:	ZERO? VRB /?L47
	EQUAL? WINNER,PROTAGONIST /?L42
	ICALL WHICH-PRINT,TLEN,LEN,TBL
	RFALSE
?L42:	ZERO? VRB /?L47
	ZERO? P-NAM /?L43
	ICALL WHICH-PRINT,TLEN,LEN,TBL
	EQUAL? TBL,P-PRSO \?L44
	SET 'P-ACLAUSE,P-NC1
	JUMP ?L46
?L44:	SET 'P-ACLAUSE,P-NC2
?L46:	SET 'P-AADJ,P-ADJ
	SET 'P-ANAM,P-NAM
	ICALL ORPHAN,0,0
	SET 'P-OFLAG,1
	JUMP ?L47
?L43:	ZERO? VRB /?L47
	ICALL1 NOUN-MISSING
?L47:	SET 'P-NAM,0
	SET 'P-ADJ,0
	RFALSE
?L29:	ZERO? LEN \?L53
	ZERO? GCHECK /?L49
	PUT P-NAMW,P-PHR,P-NAM
	PUT P-ADJW,P-PHR,P-ADJ
	ZERO? VRB /?L50
	SET 'P-SLOCBITS,XBITS
	ICALL OBJ-FOUND,NOT-HERE-OBJECT,TBL
	SET 'P-XNAM,P-NAM
	SET 'P-XADJ,P-ADJ
	SET 'P-NAM,0
	SET 'P-ADJ,0
	RTRUE
?L50:	SET 'P-NAM,0
	SET 'P-ADJ,0
	RFALSE
?L49:	ZERO? LEN \?L53
	SET 'GCHECK,1
	JUMP ?L14
?L53:	SET 'P-SLOCBITS,XBITS
	PUT P-NAMW,P-PHR,P-NAM
	PUT P-ADJW,P-PHR,P-ADJ
	SET 'P-NAM,0
	SET 'P-ADJ,0
	RTRUE

	.FUNCT MOBY-FIND,TBL,OBJ,LEN,FOO,NAM,ADJ
	SET 'OBJ,1
	SET 'NAM,P-NAM
	SET 'ADJ,P-ADJ
	SET 'P-NAM,P-XNAM
	SET 'P-ADJ,P-XADJ
	PUT TBL,P-MATCHLEN,0
?L1:	IN? OBJ,ROOMS /?L5
	CALL2 THIS-IT?,OBJ >FOO
	ZERO? FOO /?L5
	CALL OBJ-FOUND,OBJ,TBL >FOO
?L5:	IGRTR? 'OBJ,LAST-OBJECT \?L1
	GET TBL,P-MATCHLEN >LEN
	EQUAL? LEN,1 \?L11
	GET TBL,1 >P-MOBY-FOUND
?L11:	SET 'P-NAM,NAM
	SET 'P-ADJ,ADJ
	RETURN LEN

	.FUNCT WHICH-PRINT,TLEN,LEN,TBL,OBJ,RLEN
	ZERO? LEN \?L1
	ICALL1 REFERRING
	RTRUE
?L1:	SET 'RLEN,LEN
	EQUAL? WINNER,PROTAGONIST /?L4
	PRINTI """I don't understand "
	JUMP ?L6
?L4:	PRINTI "[Which"
	ZERO? P-OFLAG \?L9
	ZERO? P-MERGED \?L9
	ZERO? P-AND /?L7
?L9:	PRINTI " "
	PRINTB P-NAM
	JUMP ?L11
?L7:	EQUAL? TBL,P-PRSO \?L10
	ICALL CLAUSE-PRINT,P-NC1,P-NC1L,0
	JUMP ?L11
?L10:	ICALL CLAUSE-PRINT,P-NC2,P-NC2L,0
?L11:	PRINTI " do you mean, "
?L6:	INC 'TLEN
	GET TBL,TLEN >OBJ
	FSET? OBJ,NARTICLEBIT /?L14
	PRINTI "the "
?L14:	ICALL2 DPRINT,OBJ
	EQUAL? LEN,2 \?L17
	EQUAL? RLEN,2 /?L19
	PRINTI ","
?L19:	PRINTI " or "
	JUMP ?L22
?L17:	GRTR? LEN,2 \?L22
	PRINTI ", "
?L22:	DLESS? 'LEN,1 \?L6
	EQUAL? WINNER,PROTAGONIST /?L27
	PRINTR "."""
?L27:	PRINTR "?]"

	.FUNCT GLOBAL-CHECK,TBL,LEN,RMG,RMGL,CNT,OBJ,OBITS,FOO
	SET 'CNT,0
	GET TBL,P-MATCHLEN >LEN
	SET 'OBITS,P-SLOCBITS
	GETPT HERE,P?GLOBAL >RMG
	ZERO? RMG /?L4
	PTSIZE RMG >STACK
	DIV STACK,2 >STACK
	SUB STACK,1 >RMGL
?L3:	GET RMG,CNT >OBJ
	CALL2 THIS-IT?,OBJ >STACK
	ZERO? STACK /?L5
	ICALL OBJ-FOUND,OBJ,TBL
	JUMP ?L7
?L5:	FIRST? OBJ >OBJ \?L7
	CALL2 THIS-IT?,OBJ >STACK
	ZERO? STACK /?L7
	ICALL OBJ-FOUND,OBJ,TBL
?L7:	IGRTR? 'CNT,RMGL \?L3
?L4:	GET TBL,P-MATCHLEN >STACK
	EQUAL? STACK,LEN \FALSE
	SET 'P-SLOCBITS,-1
	IXCALL DO-SL,GLOBAL-OBJECTS,1,1,TBL
	SET 'P-SLOCBITS,OBITS
	RETURN P-SLOCBITS

	.FUNCT DO-SL,OBJ,BIT1,BIT2,TBL,MOBY-FLAG,BTS
	ASSIGNED? 'MOBY-FLAG /?L8
	SET 'MOBY-FLAG,0
?L8:	ADD BIT1,BIT2 >STACK
	BTST P-SLOCBITS,STACK \?L1
	XCALL SEARCH-LIST,OBJ,TBL,P-SRCALL,MOBY-FLAG >STACK
	RSTACK
?L1:	BTST P-SLOCBITS,BIT1 \?L4
	XCALL SEARCH-LIST,OBJ,TBL,P-SRCTOP,MOBY-FLAG >STACK
	RSTACK
?L4:	BTST P-SLOCBITS,BIT2 \TRUE
	XCALL SEARCH-LIST,OBJ,TBL,P-SRCBOT,MOBY-FLAG >STACK
	RSTACK

	.FUNCT SEARCH-LIST,OBJ,TBL,LVL,MOBY-FLAG,FLS,NOBJ
	ASSIGNED? 'MOBY-FLAG /?L28
	SET 'MOBY-FLAG,0
?L28:	FIRST? OBJ >OBJ \FALSE
?L3:	EQUAL? LVL,P-SRCBOT /?L10
	GETPT OBJ,P?SYNONYM >STACK
	ZERO? STACK /?L10
	CALL2 THIS-IT?,OBJ >STACK
	ZERO? STACK /?L10
	IN? OBJ,GLOBAL-OBJECTS \?L9
	GETP OBJ,P?SCENARIO >FLS
	EQUAL? FLS,0,SCENARIO /?L7
	SET 'FLS,0
	JUMP ?L10
?L7:	IN? OBJ,GLOBAL-OBJECTS \?L9
	GETP OBJ,P?TRANSIENT >FLS
	ZERO? FLS /?L9
	GET FLS,0 >STACK
	ADD FLS,2 >STACK
	INTBL? HERE,STACK,STACK >STACK /?L9
	SET 'FLS,0
	JUMP ?L10
?L9:	ICALL OBJ-FOUND,OBJ,TBL
?L10:	EQUAL? LVL,P-SRCTOP \?L14
	FSET? OBJ,SEARCHBIT /?L14
	FSET? OBJ,SURFACEBIT \?L15
?L14:	FIRST? OBJ >NOBJ \?L15
	FSET? OBJ,OPENBIT /?L17
	FSET? OBJ,TRANSBIT /?L17
	ZERO? MOBY-FLAG /?L15
?L17:	FSET? OBJ,SURFACEBIT \?L18
	PUSH P-SRCALL
	JUMP ?L21
?L18:	FSET? OBJ,SEARCHBIT \?L20
	PUSH P-SRCALL
	JUMP ?L21
?L20:	PUSH P-SRCTOP
?L21:	XCALL SEARCH-LIST,OBJ,TBL,STACK,MOBY-FLAG >FLS
?L15:	NEXT? OBJ >OBJ /?L3
	RTRUE

	.FUNCT OBJ-FOUND,OBJ,TBL,PTR
	GET TBL,P-MATCHLEN >STACK
	ADD 1,STACK >PTR
	PUT TBL,PTR,OBJ
	PUT TBL,P-MATCHLEN,PTR
	RTRUE

	.FUNCT TAKE-CHECK
	GETB P-SYNTAX,P-SLOC1 >STACK
	CALL ITAKE-CHECK,P-PRSO,STACK >STACK
	ZERO? STACK /FALSE
	GETB P-SYNTAX,P-SLOC2 >STACK
	CALL ITAKE-CHECK,P-PRSI,STACK >STACK
	RSTACK

	.FUNCT ITAKE-CHECK,TBL,IBITS,PTR,OBJ,TAKEN
	GET TBL,P-MATCHLEN >PTR
	ZERO? PTR /TRUE
	BTST IBITS,SHAVE /?L3
	BTST IBITS,STAKE \TRUE
?L3:	DLESS? 'PTR,0 /TRUE
	ADD PTR,1 >STACK
	GET TBL,STACK >OBJ
	EQUAL? OBJ,IT \?L9
	CALL2 VISIBLE?,P-IT-OBJECT >STACK
	ZERO? STACK \?L11
	ICALL1 REFERRING
	RFALSE
?L11:	SET 'OBJ,P-IT-OBJECT
	JUMP ?L21
?L9:	EQUAL? OBJ,HIM \?L14
	CALL2 VISIBLE?,P-HIM-OBJECT >STACK
	ZERO? STACK \?L15
	ICALL2 REFERRING,1
	RFALSE
?L15:	SET 'OBJ,P-HIM-OBJECT
	JUMP ?L21
?L14:	EQUAL? OBJ,HER \?L21
	CALL2 VISIBLE?,P-HER-OBJECT >STACK
	ZERO? STACK \?L19
	ICALL2 REFERRING,1
	RFALSE
?L19:	SET 'OBJ,P-HER-OBJECT
?L21:	CALL2 HELD?,OBJ >STACK
	ZERO? STACK \?L3
	EQUAL? OBJ,HANDS,INTNUM /?L3
	SET 'PRSO,OBJ
	FSET? OBJ,TRYTAKEBIT \?L27
	SET 'TAKEN,1
	JUMP ?L31
?L27:	EQUAL? WINNER,PROTAGONIST /?L29
	SET 'TAKEN,0
	JUMP ?L31
?L29:	BTST IBITS,STAKE \?L30
	CALL2 ITAKE,0 >STACK
	EQUAL? STACK,1 \?L30
	SET 'TAKEN,0
	JUMP ?L31
?L30:	SET 'TAKEN,1
?L31:	ZERO? TAKEN /?L44
	BTST IBITS,SHAVE \?L32
	GET TBL,P-MATCHLEN >STACK
	LESS? 1,STACK \?L34
	PRINT YNH
	PRINTI " all those things!"
	CRLF
	RFALSE
?L34:	EQUAL? OBJ,NOT-HERE-OBJECT \?L36
	PRINTI "[You can't see that here!]"
	CRLF
	RFALSE
?L36:	EQUAL? WINNER,PROTAGONIST \?L38
	PRINT YNH
	JUMP ?L40
?L38:	PRINTI "It doesn't look as if"
	ICALL2 TPRINT,WINNER
	PRINTI " has"
?L40:	ICALL2 THIS-IS-IT,OBJ
	ICALL2 TRPRINT,OBJ
	RFALSE
?L32:	ZERO? TAKEN \?L3
?L44:	EQUAL? WINNER,PROTAGONIST \?L3
	PRINTI "[taking"
	ICALL2 TPRINT,OBJ
	PRINTI " first]"
	CRLF
	JUMP ?L3

	.FUNCT MANY-CHECK,LOSS,TMP
	SET 'LOSS,0
	GET P-PRSO,P-MATCHLEN >STACK
	GRTR? STACK,1 \?L1
	GETB P-SYNTAX,P-SLOC1 >STACK
	BTST STACK,SMANY /?L1
	SET 'LOSS,1
	JUMP ?L3
?L1:	GET P-PRSI,P-MATCHLEN >STACK
	GRTR? STACK,1 \?L3
	GETB P-SYNTAX,P-SLOC2 >STACK
	BTST STACK,SMANY /?L3
	SET 'LOSS,2
?L3:	EQUAL? LOSS,1 \?L5
	PRINTI "[One at a time, please!]"
	CRLF
	RFALSE
?L5:	ZERO? LOSS /TRUE
	PRINTI "[Hey, you can't use more than one indirect object with """
	GET P-ITBL,P-VERBN >TMP
	ZERO? TMP \?L8
	PRINTI "tell"
	JUMP ?L12
?L8:	ZERO? P-OFLAG \?L11
	ZERO? P-MERGED /?L10
?L11:	GET TMP,0 >STACK
	PRINTB STACK
	JUMP ?L12
?L10:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	ICALL WORD-PRINT,STACK,STACK
?L12:	PRINTI """.]"
	CRLF
	RFALSE

	.FUNCT THIS-IT?,OBJ,SYNS,CNT
	FSET? OBJ,INVISIBLE /FALSE
	GETPT OBJ,P?SYNONYM >SYNS
	ZERO? SYNS /FALSE
	ZERO? P-NAM /?L5
	PTSIZE SYNS >STACK
	DIV STACK,2 >STACK
	INTBL? P-NAM,SYNS,STACK >STACK \FALSE
?L5:	ZERO? P-ADJ /?L12
	GETPT OBJ,P?ADJECTIVE >SYNS
	ZERO? SYNS /FALSE
	PTSIZE SYNS >STACK
	DIV STACK,2 >STACK
	INTBL? P-ADJ,SYNS,STACK >STACK \FALSE
?L12:	ZERO? P-GWIMBIT /TRUE
	FSET? OBJ,P-GWIMBIT /TRUE
	RFALSE

	.FUNCT GOOD-SCENARIO-F,FLG,STUFF?1,LD,?TMP
	EQUAL? FLG,M-BEG \?L3
	EQUAL? PRSA,V?WALK \?L1
	ZERO? SHOES-WORN \?L1
	EQUAL? SCENARIO,2 \?L1
	PRINTR "You're not going anywhere without shoes."
?L1:	EQUAL? FLG,M-BEG \?L3
	EQUAL? PRSA,V?DROP \?L3
	FSET? HERE,SWAMPBIT \?L3
	PRINTR "You'd only get it filthy; try putting it down somewhere else."
?L3:	EQUAL? FLG,M-ENTER \FALSE
	ZERO? CUT-DETECTED /?L5
	GRTR? CLOCK-TIME,CUT-DETECTED \?L5
	SET 'CUT-VIGILANCE,1
?L5:	EQUAL? HERE,OUTSIDE-HUT,NORTH-HUT,SOUTH-HUT /?L10
	EQUAL? HERE,D5,BEHIND-HUT,ROAD-END \?L8
?L10:	SET 'BEEN-AT-HUT?,1
?L8:	FSET? HERE,SWAMPBIT /?L12
	ZERO? IN-SWAMP? /?L45
	SET 'IN-SWAMP?,0
?L12:	ZERO? IN-SWAMP? \?L15
?L45:	PUTP HERE,P?PATH,0
	PUTP STUFF?1,P?PATH,HERE
?L15:	LOC DOGS >LD
	EQUAL? LD,HERE \?L18
	CRLF
	PRINTI "You can hear the guard dogs within 50 yards! Their voices reach a fevered pitch - a guard calls out - a muffled explosion - the night sky is lit by a single red-orange flare. In the nick of time, you retreat to your earlier position and remind yourself to take the chase dogs more seriously in the future."
	CRLF
	ICALL GOTO,STUFF?1,0
	RTRUE
?L18:	IN? CAR,HERE \?L20
	EQUAL? HERE,ROAD-END /?L20
	ICALL1 CAR-NEARLY-HITS
	RTRUE
?L20:	IN? SCOUT,HERE \?L21
	CRLF
	PRINTI "You walk a short ways, then catch a glimpse of a lone guard who appears to be checking out the area around the hut. Rather than continue on, you retreat to your previous location"
	EQUAL? STUFF?1,HUT-STORAGE \?L22
	FCLEAR HUT-BACK-DOOR,OPENBIT
	PRINTI ", closing the door behind you."
?L22:	PRINT PERIOD-CR
	ICALL GOTO,STUFF?1,0
	RTRUE
?L21:	IN? CAR,ROAD-END \?L25
	EQUAL? HERE,D5,OUTSIDE-HUT \?L25
	EQUAL? STUFF?1,C5,C6 /?L28
	EQUAL? STUFF?1,D4,OUTSIDE-SHED \?L26
?L28:	CRLF
	PRINTI "You just start to emerge from the forest when you notice an automobile and some guards in front of a small hut to the east of the clearing. You retreat back into the safety of the trees, thinking that perhaps it would be safer approaching the hut from the other side."
	CRLF
	ICALL GOTO,STUFF?1,0
	RTRUE
?L26:	ICALL1 GUARDS-SPOTTED
	RTRUE
?L25:	IN? HUT-MAN,HERE \?L30
	ICALL1 MAN-CATCHES
	RTRUE
?L30:	ZERO? MOVE-FORCED \?L32
	CALL HOW-FAR,LD,STUFF?1 >?TMP
	CALL HOW-FAR,LD,HERE >STACK
	IXCALL GONE-TO-THE-DOGS?,?TMP,STACK,DOGS,0
?L32:	ZERO? SL-WATCH /?L35
	FSET? HERE,SLVIEWBIT /?L35
	CRLF
	ICALL PERFORM,V?OFF-2,TIMING-OBJECT,SEARCHLIGHTS
?L35:	ZERO? G-WATCH /TRUE
	FSET? HERE,GVIEWBIT /?L38
	CRLF
	ICALL PERFORM,V?OFF-2,TIMING-OBJECT,GUARDS
?L38:	ZERO? G-WATCH /TRUE
	ICALL1 SCREEN-1
	GETP STUFF?1,P?GPOS >STACK
	DIV STACK,5 >STACK
	ADD GUARD-MARGIN,STACK >STACK
	CURSET 3,STACK
	PRINTI " "
	GETP HERE,P?GPOS >STACK
	DIV STACK,5 >STACK
	ADD GUARD-MARGIN,STACK >STACK
	CURSET 3,STACK
	PRINTI "*"
	ICALL1 SCREEN-0
	RTRUE

	.FUNCT BAD-SCENARIO-F,FLG,STUFF?1
	EQUAL? FLG,M-BEG \?L1
	EQUAL? PRSA,V?WALK \?L1
	ZERO? ON-THE-CAN /?L1
	EQUAL? PRSO,P?UP /?L1
	PRINTR "You'd best get off the can first."
?L1:	EQUAL? FLG,M-ENTER \FALSE
	FSET? STUFF?1,HUTBIT \?L4
	GET FLOOR-PROPS,HALL-FLOOR >STACK
	GETP STUFF?1,STACK >STACK
	ICALL MOVE-ALL,STUFF?1,STACK
?L4:	EQUAL? HERE,HALL-1 \?L7
	FSET? STUFF?1,PENBIT \?L7
	GETP STUFF?1,P?SIZE >HALL-FLOOR
?L7:	FSET? HERE,HUTBIT \?L10
	GET FLOOR-PROPS,HALL-FLOOR >STACK
	GETP HERE,STACK >STACK
	ICALL MOVE-ALL,STACK,HERE
?L10:	ZERO? CHASE-FLAG \?L13
	EQUAL? STUFF?1,BLDG-2 \?L13
	ICALL2 DE-QUEUE,I-TOPAZ-OFF
?L13:	PUTP HERE,P?PATH,0
	PUTP STUFF?1,P?PATH,HERE
	PUTP STUFF?1,P?PATH-TIME,CLOCK-MOVE
	RFALSE

	.FUNCT BYSTANDER-SCENARIO-F,FLG,STUFF?1
	EQUAL? FLG,M-BEG \?L4
	EQUAL? PRSA,V?EMPTY,V?THROW,V?DROP \?L1
	FSET? HERE,HUTBIT \?L1
	PRINTI "With the guards watching, it isn't a good idea to litter."
	CRLF
	ICALL2 PRINT-ID,STR?33
	RTRUE
?L1:	EQUAL? FLG,M-BEG \?L4
	EQUAL? PRSA,V?DROP \?L3
	ZERO? BUMPER-FLAG /?L3
	SET 'CLOCK-MOVE,50
	RFALSE
?L3:	EQUAL? FLG,M-BEG \?L4
	EQUAL? PRSA,V?WALK \?L4
	ZERO? BAD-CONFINED /?L4
	EQUAL? PRSO,P?EAST,P?OUT \?L4
	PRINTR "You start to go through your compartment's door, but are stopped by a uniformed guard. You return to your compartment, out of sight of the guard. You'd might as well get comfortable here until you reach the station."
?L4:	ZERO? AT-STATION /FALSE
	EQUAL? FLG,M-BEG \FALSE
	EQUAL? PRSA,V?WALK \FALSE
	EQUAL? HERE,PASS-5 \?L6
	EQUAL? PRSO,P?NORTH \?L6
	PRINTR "The guard stops you, pointing toward the south and the other exit."
?L6:	EQUAL? HERE,PASS-6 \FALSE
	EQUAL? PRSO,P?SOUTH \FALSE
	PRINTI "You move past the guard, down the stairs, and onto the station platform.[RWD_ID: scenario:158, VAL: 1]"
	CRLF
	CRLF
	ICALL2 PLATFORM-ROOM-F,M-LOOK
	ICALL GOTO,PLATFORM-4,0
	ICALL SLOW-CLOCK-QUEUE,I-PLATFORM,30
	RTRUE

	.FUNCT DESCRIBE-ROOM,LOOK?,V?,STR,AV
	ASSIGNED? 'LOOK? /?L21
	SET 'LOOK?,0
?L21:	IN? HERE,ROOMS \?L1
	ICALL1 HERE-TELL
?L1:	LOC WINNER >AV
	CRLF
	SET 'V?,LOOK?
	ZERO? V? \?L7
	EQUAL? VERBOSITY,1,2 /?L6
	SET 'V?,0
	JUMP ?L7
?L6:	SET 'V?,1
?L7:	FSET? HERE,TOUCHBIT /?L10
	FSET HERE,TOUCHBIT
	ZERO? VERBOSITY /?L10
	EQUAL? SCENARIO,S-BAD \?L10
	SET 'V?,1
?L10:	SET 'DESCRIBED-ROOM?,V?
	ZERO? V? /TRUE
	CRLF
	GETP HERE,P?ACTION >STACK
	CALL2 STACK,M-LOOK >STACK
	ZERO? STACK \TRUE
	GETP HERE,P?LDESC >STR
	ZERO? STR /TRUE
	PRINT STR
	CRLF
	RTRUE

	.FUNCT DESCRIBE-OBJECTS,O,STR,AV,TMP
	LOC WINNER >AV
	FIRST? HERE >O \FALSE
?L7:	CALL2 DESCRIBABLE?,O >STACK
	ZERO? STACK /?L9
	FSET? O,TOUCHBIT /?L9
	GETP O,P?FDESC >STR
	ZERO? STR /?L9
	ICALL2 THIS-IS-IT,O
	CRLF
	PRINT STR
	FSET? O,CONTBIT \?L10
	ICALL DESCRIBE-CONTENTS,O,1,3
?L10:	CRLF
?L9:	NEXT? O >O /?L7
	FIRST? HERE >O \?L17
?L18:	CALL2 DESCRIBABLE?,O >STACK
	ZERO? STACK /?L32
	GETP O,P?FDESC >STACK
	ZERO? STACK /?L20
	FSET? O,TOUCHBIT \?L32
?L20:	GETP O,P?DESCFCN >STR
	ZERO? STR /?L22
	CALL STR,M-OBJDESC?,O >TMP
	ZERO? TMP /?L22
	EQUAL? TMP,M-FATAL /?L32
	ICALL2 THIS-IS-IT,O
	CRLF
	CALL STR,M-OBJDESC,O >STR
	ZERO? STR /?L27
	FSET? O,CONTBIT \?L27
	EQUAL? STR,M-FATAL /?L27
	ICALL DESCRIBE-CONTENTS,O,1,3
?L27:	CRLF
	JUMP ?L32
?L22:	GETP O,P?LDESC >STR
	ZERO? STR /?L32
	ICALL2 THIS-IS-IT,O
	CRLF
	PRINT STR
	FSET? O,CONTBIT \?L33
	ICALL DESCRIBE-CONTENTS,O,1,3
?L33:	CRLF
?L32:	NEXT? O >O /?L18
?L17:	ICALL DESCRIBE-CONTENTS,HERE,0,0
	ZERO? AV /FALSE
	EQUAL? HERE,AV /FALSE
	CALL DESCRIBE-CONTENTS,AV,0,0 >STACK
	RSTACK

	.FUNCT DESCRIBE-CONTENTS,OBJ,LEVEL,ALL?,F,N,1ST?,IT?,TWO?,START?,PARA?,DB
	ASSIGNED? 'LEVEL /?L80
	SET 'LEVEL,-1
?L80:	ASSIGNED? 'ALL? /?L81
	SET 'ALL?,D-ALL?
?L81:	SET 'F,0
	SET '1ST?,1
	SET 'IT?,0
	SET 'TWO?,0
	SET 'START?,0
	SET 'PARA?,0
	EQUAL? LEVEL,2 \?L1
	SET 'LEVEL,1
	SET 'PARA?,1
	SET 'START?,1
	JUMP ?L3
?L1:	BTST ALL?,D-PARA? \?L3
	SET 'PARA?,1
?L3:	FIRST? OBJ >N /?L5
?L5:	ZERO? START? \?L10
	IN? OBJ,ROOMS /?L10
	FSET? OBJ,PERSON /?L10
	ZERO? N /FALSE
	FSET? OBJ,CONTBIT \FALSE
	FSET? OBJ,OPENBIT /?L9
	FSET? OBJ,TRANSBIT \FALSE
?L9:	EQUAL? LEVEL,-1 /?L10
	FSET? OBJ,SEARCHBIT \FALSE
?L10:	ZERO? N /?L16
?L84:	CALL2 DESCRIBABLE?,N >STACK
	ZERO? STACK /?L13
	BTST ALL?,D-ALL? /?L16
	CALL2 SIMPLE-DESC?,N >STACK
	ZERO? STACK /?L13
?L16:	ZERO? F /?L36
	ZERO? 1ST? /?L19
	SET '1ST?,0
	EQUAL? LEVEL,0,1 \?L21
	ZERO? START? \?L33
	ZERO? PARA? \?L25
	SET 'PARA?,1
	CRLF
	JUMP ?L27
?L25:	EQUAL? LEVEL,1 \?L27
	PRINTI " "
?L27:	ICALL DESCRIBE-START,OBJ,N
	JUMP ?L33
?L21:	EQUAL? LEVEL,-1 /?L33
	PRINT LEVEL
	JUMP ?L33
?L19:	ZERO? N /?L32
	PRINTI ", "
	JUMP ?L33
?L32:	PRINTI " and "
?L33:	ICALL2 PRINTA,F
	ZERO? IT? \?L34
	ZERO? TWO? \?L34
	SET 'IT?,F
	JUMP ?L36
?L34:	SET 'TWO?,1
	SET 'IT?,0
?L36:	SET 'F,N
?L13:	ZERO? N /?L41
	NEXT? N >N /?L41
?L41:	ZERO? F \?L10
	ZERO? N \?L84
	ZERO? IT? /?L45
	ZERO? TWO? \?L45
	ICALL2 THIS-IS-IT,IT?
?L45:	ZERO? 1ST? /?L82
	ZERO? START? /?L48
	PRINTI " nothing"
	RFALSE
?L48:	ZERO? 1ST? \?L12
?L82:	EQUAL? LEVEL,0,1 \?L60
	EQUAL? OBJ,HERE \?L51
	PRINTI " here"
?L51:	PRINTI "."
?L12:	EQUAL? LEVEL,0,1 \?L60
	FIRST? OBJ >F \?L60
?L61:	FSET? F,CONTBIT \?L63
	CALL DESCRIBABLE?,F,1 >STACK
	ZERO? STACK /?L63
	BTST ALL?,D-ALL? /?L64
	CALL2 SIMPLE-DESC?,F >STACK
	ZERO? STACK /?L63
?L64:	SET 'DB,D-BIT
	SET 'D-BIT,0
	ZERO? PARA? /?L67
	PUSH 3
	JUMP ?L69
?L67:	PUSH D-ALL?
?L69:	CALL DESCRIBE-CONTENTS,F,1,STACK >STACK
	ZERO? STACK /?L65
	SET '1ST?,0
	SET 'PARA?,1
?L65:	SET 'D-BIT,DB
?L63:	NEXT? F >F /?L61
?L60:	ZERO? 1ST? \FALSE
	EQUAL? LEVEL,0,1 \?L74
	LOC WINNER >STACK
	EQUAL? OBJ,HERE,STACK \?L74
	CRLF
?L74:	ZERO? 1ST? \FALSE
	RTRUE

	.FUNCT DESCRIBE-START,OBJ,N
	EQUAL? OBJ,HERE \?L1
	PRINTI "There is "
	RTRUE
?L1:	EQUAL? OBJ,PROTAGONIST \?L3
	EQUAL? D-BIT,WORNBIT \?L4
	PRINTI " You are wearing "
	RTRUE
?L4:	PRINTI "You are carrying "
	RTRUE
?L3:	FSET? OBJ,PERSON \?L7
	ICALL2 CTHE-PRINT,OBJ
	PRINTI " wears "
	RTRUE
?L7:	EQUAL? OBJ,BYSTANDER-CLOTHES \?L8
	PRINTI "Pinned to "
	ICALL2 THE-PRINT,OBJ
	PRINTI " is "
	RTRUE
?L8:	FSET? OBJ,SURFACEBIT \?L9
	PRINTI "Sitting on "
	ICALL2 THE-PRINT,OBJ
	PRINTI " is "
	RTRUE
?L9:	ICALL2 CTHE-PRINT,OBJ
	PRINTI " contains "
	RTRUE

	.FUNCT DESCRIBABLE?,OBJ,CONT?
	ASSIGNED? 'CONT? /?L15
	SET 'CONT?,0
?L15:	FSET? OBJ,INVISIBLE /FALSE
	EQUAL? OBJ,WINNER /FALSE
	LOC WINNER >STACK
	EQUAL? OBJ,STACK \?L4
	LOC WINNER >STACK
	EQUAL? HERE,STACK \FALSE
?L4:	ZERO? CONT? \?L5
	FSET? OBJ,NDESCBIT /FALSE
?L5:	ZERO? D-BIT /TRUE
	GRTR? D-BIT,0 \?L7
	FSET? OBJ,D-BIT \FALSE
	RTRUE
?L7:	SUB 0,D-BIT >STACK
	FSET? OBJ,STACK /FALSE
	RTRUE

	.FUNCT SIMPLE-DESC?,OBJ,STR
	GETP OBJ,P?FDESC >STACK
	ZERO? STACK /?L1
	FSET? OBJ,TOUCHBIT \FALSE
?L1:	GETP OBJ,P?DESCFCN >STR
	ZERO? STR /?L3
	CALL STR,M-OBJDESC?,OBJ >STACK
	ZERO? STACK \FALSE
?L3:	GETP OBJ,P?LDESC >STACK
	ZERO? STACK /TRUE
	RFALSE

	.FUNCT V-VERBOSE
	SET 'VERBOSITY,2
	PRINTI "Verbose descriptions."
	CRLF
	CRLF
	CALL1 V-LOOK >STACK
	RSTACK

	.FUNCT V-BRIEF
	PRINTR "In BORDER ZONE, you can choose only between VERBOSE descriptions (the default) or SUPERBRIEF descriptions."

	.FUNCT V-SUPER-BRIEF
	SET 'VERBOSITY,0
	PRINTR "Superbrief descriptions."

	.FUNCT V-SAVE,SV,FLG
	SET 'SAVE-FLAG,1
	SAVE >SV
	EQUAL? SV,1 \?L1
	ICALL1 CHECK-REFRESH
	PRINTI "Ok."
	CRLF
	JUMP ?L8
?L1:	EQUAL? SV,2 \?L3
	ICALL1 CHECK-REFRESH
	ZERO? G-WATCH /?L4
	ICALL PERFORM,V?OFF-2,TIMING-OBJECT,GUARDS
	CRLF
	ICALL PERFORM,V?WATCH,GUARDS
	ICALL UPDATE-CHRONOGRAPH,0,1
	JUMP ?L7
?L4:	ZERO? SL-WATCH /?L6
	ICALL PERFORM,V?OFF-2,TIMING-OBJECT,SEARCHLIGHTS
	CRLF
	ICALL PERFORM,V?WATCH,SEARCHLIGHTS
	ICALL UPDATE-CHRONOGRAPH,0,1
	JUMP ?L7
?L6:	ICALL1 REDISPLAY-CHRONOGRAPH
	ICALL1 FLUSH-WATCHER
?L7:	PRINTI "Ok."
	CRLF
	JUMP ?L8
?L3:	PRINTI "Failed."
	CRLF
?L8:	ICALL1 UPDATE-TIME
	SET 'SAVE-FLAG,0
	RTRUE

	.FUNCT V-RESTORE
	ZERO? SCENARIO \?L1
	ICALL2 INIT-STATUS-LINE,3
	CRLF
?L1:	RESTORE >STACK
	ZERO? STACK /?L4
	PRINTI "Ok."
	CRLF
	CRLF
	CALL1 V-LOOK >STACK
	RSTACK
?L4:	PRINTR "Failed."

	.FUNCT V-SCRIPT
	PRINT STR?34
	PRINTI "n.]"
	CRLF
	DIROUT D-PRINTER-ON
	ICALL2 TRANSCRIPT,STR?35
	RTRUE

	.FUNCT V-UNSCRIPT
	ICALL2 TRANSCRIPT,STR?36
	DIROUT D-PRINTER-OFF
	PRINT STR?34
	PRINTR "ff.]"

	.FUNCT TRANSCRIPT,STR
	DIROUT D-SCREEN-OFF
	CRLF
	PRINTI "Here "
	PRINT STR
	PRINTI "s a transcript of interaction with"
	CRLF
	ICALL1 V-VERSION
	DIROUT D-SCREEN-ON
	RTRUE

	.FUNCT V-DIAGNOSE
	LESS? HEALTH,9 /?L3
	LESS? WARMTH,9 \?L1
?L3:	PRINTI "You are suffering from "
	ICALL2 SLOWDOWN,1
	PRINT PERIOD-CR
	RTRUE
?L1:	EQUAL? SCENARIO,2 /?L4
	PRINTR "You're in good enough shape to accomplish your goal."
?L4:	PRINTR "You are in reasonably good health, though your arm hurts badly and you've lost some blood."

	.FUNCT V-INVENTORY
	SET 'CLOCK-MOVE,5
	SUB 0,WORNBIT >D-BIT
	CALL DESCRIBE-CONTENTS,WINNER,0,3 >STACK
	ZERO? STACK \?L1
	PRINTI "You are empty-handed."
?L1:	SET 'D-BIT,WORNBIT
	ICALL DESCRIBE-CONTENTS,WINNER,0,3
	SET 'D-BIT,0
	CRLF
	RTRUE

	.FUNCT V-QUIT
	ICALL2 DO-YOU-WISH,STR?37
	CALL1 YES? >STACK
	ZERO? STACK /?L1
	QUIT
?L1:	PRINTR "Okay."

	.FUNCT V-RESTART
	ICALL2 DO-YOU-WISH,STR?38
	CALL1 YES? >STACK
	ZERO? STACK /FALSE
	PRINTI "Restarting."
	CRLF
	RESTART

	.FUNCT DO-YOU-WISH,STRING
	CRLF
	PRINTI "Do you wish to "
	PRINT STRING
	PRINTI "?:"
	RTRUE

	.FUNCT YES?,TO-PERSON
?L0:	ASSIGNED? 'TO-PERSON /?L9
	SET 'TO-PERSON,0
?L9:	ZERO? TO-PERSON /?L1
	PRINTI ">>"
	JUMP ?L3
?L1:	PRINTI ">"
?L3:	PUTB P-INBUF,1,0
	READ P-INBUF,P-LEXV >STACK
	GET P-LEXV,1 >STACK
	CALL2 YES-WORD?,STACK >STACK
	ZERO? STACK \TRUE
	GET P-LEXV,1 >STACK
	EQUAL? STACK,W?N,W?NO /FALSE
	EQUAL? TO-PERSON,BAD-SPY \?L7
	PRINTI """Please, just a simple yes or no."""
	CRLF
	CRLF
	JUMP ?L0
?L7:	PRINTI "Please answer YES or NO."
	CRLF
	CRLF
	JUMP ?L0

	.FUNCT YES-WORD?,WRD
	EQUAL? WRD,W?YES,W?Y /TRUE
	EQUAL? WRD,W?OK,W?OKAY \FALSE
	RTRUE

	.FUNCT FINISH,CONTIN,W
?L0:	ASSIGNED? 'CONTIN /?L20
	SET 'CONTIN,0
?L20:	HLIGHT H-NORMAL
	CRLF
	CRLF
	PRINTI "Would you like to "
	ZERO? CONTIN /?L1
	PRINTI "continue with the next scenario, "
?L1:	PRINTI "start over, restore a saved position, get a hint, or end this session of the game?
(Type "
	ZERO? CONTIN /?L4
	PRINTI "CONTINUE, "
?L4:	PRINTI "RESTART, RESTORE, HINT, or QUIT) >"
	PUTB P-INBUF,1,0
	READ P-INBUF,P-LEXV >STACK
	SET 'W,W?CONTINUE
	EQUAL? W,W?RESTART \?L7
	RESTART
?L7:	EQUAL? W,W?RESTORE \?L9
	RESTORE >STACK
	ZERO? STACK \FALSE
	PRINTI "Failed."
	CRLF
	CALL2 FINISH,CONTIN >STACK
	RSTACK
?L9:	EQUAL? W,W?HINT \?L13
	ICALL1 V-HINT
	JUMP ?L0
?L13:	EQUAL? W,W?QUIT,W?Q \?L14
	QUIT
?L14:	ZERO? CONTIN /?L0
	EQUAL? W,W?CONTINUE,W?C \?L0
	ICALL2 FLUSH-BAD-SCENARIO,CONTIN
	EQUAL? CONTIN,2 \?L16
	CALL2 START-SCENARIO-2,1 >STACK
	RSTACK
?L16:	CALL2 START-SCENARIO-3,1 >STACK
	RSTACK

	.FUNCT V-VERSION,CNT,V
	SET 'CNT,17
	GET 0,1 >STACK
	BAND STACK,2047 >V
	CRLF
	PRINTI "BORDER ZONE: A Game of Intrigue
Copyright (c) 1987 by Infocom, Inc. All rights reserved.
BORDER ZONE is a trademark of Infocom, Inc.
Release "
	PRINTN V
	PRINTI " / Serial number "
?L1:	IGRTR? 'CNT,23 /?L2
	GETB 0,CNT >STACK
	PRINTC STACK
	JUMP ?L1
?L2:	PRINTI " / "
	ICALL1 V-$0024ID
	CRLF
	RTRUE

	.FUNCT V-$0024RANDOM
	EQUAL? PRSO,INTNUM /?L1
	PRINTR "Illegal call to #RANDOM."
?L1:	SUB 0,P-NUMBER >STACK
	RANDOM STACK >STACK
	RTRUE

	.FUNCT V-$0024ID
	PRINTI "Interpreter "
	GETB 0,30 >STACK
	PRINTN STACK
	PRINTI " Version "
	GETB 0,31 >STACK
	PRINTC STACK
	CRLF
	RTRUE

	.FUNCT V-$0024VERIFY
	EQUAL? PRSO,INTNUM \?L1
	EQUAL? P-NUMBER,811 \?L1
	PRINTN SERIAL
	CRLF
	RTRUE
?L1:	ICALL1 V-$0024ID
	CRLF
	PRINTI "[Verifying.]"
	CRLF
	VERIFY \?L4
	PRINTR "Ok."
?L4:	CRLF
	PRINTR "** Bad **"

	.FUNCT V-ADVANCE
	CALL1 WASTES >STACK
	RSTACK

	.FUNCT V-ALARM
	EQUAL? PRSO,ROOMS \?L1
	ICALL PERFORM,V?ALARM,ME
	RTRUE
?L1:	PRINTI "But"
	ICALL1 TPRINT-PRSO
	PRINTR " isn't asleep."

	.FUNCT V-ANSWER
	PRINTI "Nobody is awaiting your answer."
	CRLF
	CALL1 STOP >STACK
	RSTACK

	.FUNCT V-ARREST
	PRINTI "Be glad it isn't you that's arrested."
	CRLF
	CALL1 IS-PERSON? >STACK
	CALL PRINT-ID,STR?39,STACK >STACK
	RSTACK

	.FUNCT V-ASK-ABOUT
	EQUAL? PRSO,ME \?L1
	ICALL PERFORM,V?TELL,ME
	RTRUE
?L1:	FSET? PRSO,PERSON \?L3
	SET 'WINNER,PRSO
	ICALL PERFORM,V?TELL-ABOUT,ME,PRSI
	RTRUE
?L3:	ICALL PERFORM,V?TELL,PRSO
	RTRUE

	.FUNCT V-ASK-FOR
	PRINTI "Unsurprisingly,"
	ICALL1 TPRINT-PRSO
	PRINTR " doesn't oblige."

	.FUNCT V-BITE,?TMP
	ICALL2 HACK-HACK,STR?40
	CALL1 IS-OBJ-PROP-ANIMAL? >?TMP
	ZERO? ?TMP /?L2
	PUSH ?TMP
	JUMP ?L1
?L2:	CALL1 IS-PERSON? >STACK
?L1:	ICALL PRINT-ID,STR?41,STACK
	CALL1 IS-PART-OF-SELF? >STACK
	CALL PRINT-ID,STR?42,STACK >STACK
	RSTACK

	.FUNCT V-BEND
	EQUAL? PRSI,0,WAY /?L1
	PRINTR "Huh?"
?L1:	PRINTR "You can't bend that."

	.FUNCT PRE-BOARD
	IN? PROTAGONIST,PRSO \?L1
	PRINT LOOK-AROUND
	RTRUE
?L1:	CALL2 HELD?,PRSO >STACK
	ZERO? STACK /FALSE
	PRINT HOLDING-IT
	RTRUE

	.FUNCT V-BOARD
	PRINTI "You can't get into "
	ICALL1 THE-PRINT-PRSO
	PRINTR "!"

	.FUNCT V-BUY
	PRINTR "It's not for sale."

	.FUNCT V-BUY-WITH,ACTOR
	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-BUY-OBJECT-WITH,ACTOR
	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-CALL
	CALL2 META-LOC,PRSO >STACK
	EQUAL? STACK,HERE /?L1
	EQUAL? PRSO,ME /?L1
	CALL GLOBAL-IN?,PRSO,HERE >STACK
	ZERO? STACK \?L1
	CALL2 CANT-SEE,PRSO >STACK
	RSTACK
?L1:	ICALL PERFORM,V?TELL,PRSO
	RTRUE

	.FUNCT V-CHASTISE
	PRINT TOO-LATE
	CRLF
	RTRUE

	.FUNCT PRE-CHASTISE
	CALL2 DIRECTION?,PRSO >STACK
	ZERO? STACK /?L1
	PRINTR "You'll have to go in that direction to see what's there."
?L1:	PRINTR "Use prepositions to indicate precisely what you want to do: LOOK AT the object, LOOK INSIDE it, LOOK UNDER it, etc."

	.FUNCT V-CLEAN
	PRINTR "A nice thought, but not that important just now."

	.FUNCT V-CLIMB-NUL
	PRINTR "You'll have to be more specific."

	.FUNCT V-CLIMB
	EQUAL? PRSO,ROOMS \?L1
	CALL2 DO-WALK,P?UP >STACK
	RSTACK
?L1:	CALL2 HELD?,PRSO >STACK
	ZERO? STACK /?L3
	PRINT HOLDING-IT
	RTRUE
?L3:	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-CLIMB-DOWN
	EQUAL? PRSO,ROOMS \?L1
	CALL2 DO-WALK,P?DOWN >STACK
	RSTACK
?L1:	CALL2 HELD?,PRSO >STACK
	ZERO? STACK /?L3
	PRINT HOLDING-IT
	RTRUE
?L3:	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-CLIMB-ON
	CALL2 HELD?,PRSO >STACK
	ZERO? STACK /?L1
	PRINT HOLDING-IT
	RTRUE
?L1:	LOC PRSO >STACK
	EQUAL? STACK,COMP-SEAT-FRONT,COMP-SEAT-BACK \?L3
	EQUAL? PRSO,DOCUMENT,SHRED,SHREDS \?L4
	PRINTR "It's a clever idea, but you wouldn't get away with it."
?L4:	PRINTR "It would neither be comfortable nor helpful."
?L3:	PRINTI "You can't climb onto "
	ICALL1 THE-PRINT-PRSO
	PRINT PERIOD-CR
	RTRUE

	.FUNCT V-CLIMB-OVER
	CALL2 HELD?,PRSO >STACK
	ZERO? STACK /?L1
	PRINT HOLDING-IT
	RTRUE
?L1:	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-CLIMB-UP
	EQUAL? PRSO,ROOMS \?L1
	CALL2 DO-WALK,P?UP >STACK
	RSTACK
?L1:	CALL2 HELD?,PRSO >STACK
	ZERO? STACK /?L3
	PRINT HOLDING-IT
	RTRUE
?L3:	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-CLOSE
	FSET? PRSO,SURFACEBIT /?L3
	FSET? PRSO,PERSON \?L1
?L3:	CALL2 CANT-VERB-A-PRSO,STR?43 >STACK
	RSTACK
?L1:	FSET? PRSO,DOORBIT /?L5
	FSET? PRSO,CONTBIT \?L4
?L5:	FSET? PRSO,OPENBIT \?L6
	FCLEAR PRSO,OPENBIT
	PRINTI "Okay,"
	ICALL1 TPRINT-PRSO
	PRINTR " is now closed."
?L6:	PRINTR "It's already closed."
?L4:	CALL2 CANT-VERB-A-PRSO,STR?43 >STACK
	RSTACK

	.FUNCT V-COUNT
	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-CRAWL-UNDER
	FSET? PRSO,TAKEBIT /?L1
	CALL1 TELL-HIT-HEAD >STACK
	RSTACK
?L1:	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-CUT,?TMP
	CALL1 IS-OBJ-PROP-ANIMAL? >?TMP
	ZERO? ?TMP /?L2
	PUSH ?TMP
	JUMP ?L1
?L2:	CALL1 IS-PERSON? >STACK
?L1:	ICALL PRINT-ID,STR?44,STACK
	CALL1 IS-PART-OF-SELF? >STACK
	ICALL PRINT-ID,STR?45,STACK
	ZERO? PRSI \?L3
	CALL1 IMPOSSIBLES >STACK
	RSTACK
?L3:	EQUAL? PRSI,WOOD-SAW \?L5
	PRINTR "It's not wood, so you won't get anywhere."
?L5:	EQUAL? PRSI,BOLT-CUTTER \?L6
	PRINTR "There's no use cutting that."
?L6:	PRINTI "You'll never get anywhere with "
	ICALL1 PRINTA-PRSI
	PRINT PERIOD-CR
	RTRUE

	.FUNCT V-DIG
	CALL1 WASTES >STACK
	RSTACK

	.FUNCT V-DISEMBARK
	FSET? PRSO,TAKEBIT \?L1
	CALL2 META-LOC,PRSO >STACK
	EQUAL? STACK,HERE \?L1
	IN? PRSO,HERE /?L1
	IN? PRSO,PROTAGONIST /?L1
	IN? PROTAGONIST,PRSO /?L3
	ICALL PERFORM,V?TAKE,PRSO
	RTRUE
?L1:	IN? PROTAGONIST,PRSO /?L3
	PRINT LOOK-AROUND
	RETURN 8
?L3:	MOVE PROTAGONIST,HERE
	PRINTI "You"
	PRINTI " get out of the "
	ICALL2 DPRINT,PRSO
	PRINTR "."

	.FUNCT V-DRINK
	PRINTI "You can't drink that!"
	CRLF
	CALL1 DANGEROUS-DRINK? >STACK
	CALL PRINT-ID,STR?46,STACK >STACK
	RSTACK

	.FUNCT V-DRINK-FROM
	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-DROP
	SET 'CLOCK-MOVE,6
	MOVE PRSO,HERE
	PRINTR "Dropped."

	.FUNCT SPECIAL-DROP
	RFALSE

	.FUNCT V-EAT
	CALL1 IS-PERSON? >STACK
	ICALL PRINT-ID,STR?47,STACK
	CALL1 DANGEROUS-FOOD? >STACK
	ICALL PRINT-ID,STR?48,STACK
	PRINTI "Your incipient ulcer would not be helped by eating "
	ICALL1 PRINTA-PRSO
	PRINT PERIOD-CR
	RTRUE

	.FUNCT V-EMPTY,OBJ,NXT
	FSET? PRSO,CONTBIT \?L1
	FSET? PRSO,OPENBIT \?L3
	FIRST? PRSO >OBJ \?L6
?L8:	NEXT? OBJ >NXT /?L10
?L10:	MOVE OBJ,HERE
	ZERO? NXT /?L9
	SET 'OBJ,NXT
	JUMP ?L8
?L9:	PRINTI "You dump the contents of"
	ICALL1 TPRINT-PRSO
	PRINTR " onto the ground."
?L6:	PRINTR "It's already empty!"
?L3:	PRINTR "It's closed."
?L1:	CALL2 HELD?,PRSO >STACK
	ZERO? STACK /?L16
	IN? PRSO,PROTAGONIST /?L16
	MOVE PRSO,HERE
	PRINTR "Done."
?L16:	ICALL1 IMPOSSIBLES
	RTRUE

	.FUNCT V-ENTER
	FSET? PRSO,DOORBIT \?L1
	CALL2 OTHER-SIDE,PRSO >STACK
	ICALL2 DO-WALK,STACK
	RTRUE
?L1:	FSET? PRSO,TAKEBIT /?L3
	CALL1 TELL-HIT-HEAD >STACK
	RSTACK
?L3:	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-EXAMINE
	FSET? PRSO,PERSON \?L1
	FIRST? PRSO >STACK \?L3
	ICALL PERFORM,V?LOOK-INSIDE,PRSO
	RTRUE
?L3:	PRINTI "There's nothing noteworthy about"
	ICALL2 TRPRINT,PRSO
	RTRUE
?L1:	FSET? PRSO,DOORBIT /?L7
	FSET? PRSO,SURFACEBIT \?L6
?L7:	CALL1 V-LOOK-INSIDE >STACK
	RSTACK
?L6:	FSET? PRSO,CONTBIT \?L8
	FSET? PRSO,OPENBIT \?L9
	CALL1 V-LOOK-INSIDE >STACK
	RSTACK
?L9:	PRINTR "It's closed."
?L8:	PRINTI "It's a pretty typical "
	ICALL2 DPRINT,PRSO
	PRINTR "."

	.FUNCT V-EXAMINE-THROUGH-FLIP
	ICALL PERFORM,V?EXAMINE-THROUGH,PRSI,PRSO
	RTRUE

	.FUNCT V-EXAMINE-THROUGH
	PRINTR "This reveals nothing new."

	.FUNCT V-EXIT
	CALL2 DO-WALK,P?OUT >STACK
	RSTACK

	.FUNCT V-FEED
	PRINTI "You have nothing to feed "
	ICALL1 THE-PRINT-PRSO
	PRINTR " with."

	.FUNCT V-FILL
	ZERO? PRSI \?L1
	PRINTI "There's nothing to fill it with."
	RTRUE
?L1:	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-FIND,WHERE,L
	ASSIGNED? 'WHERE /?L14
	SET 'WHERE,0
?L14:	LOC PRSO >L
	ZERO? L \?L1
	PRINTR "You can't tell."
?L1:	EQUAL? PRSO,ME \?L3
	PRINTI "You're in """
	ICALL2 HERE-TELL,0
	PRINTR """."
?L3:	IN? PRSO,PROTAGONIST \?L4
	PRINTR "You're holding it!"
?L4:	IN? PRSO,HERE \?L5
	PRINTR "It's right in front of you."
?L5:	IN? PRSO,GLOBAL-OBJECTS /?L7
	CALL GLOBAL-IN?,PRSO,HERE >STACK
	ZERO? STACK /?L6
?L7:	PRINTR "You'll have to find it yourself!"
?L6:	FSET? L,PERSON \?L8
	CALL2 VISIBLE?,L >STACK
	ZERO? STACK /?L8
	PRINTI "It seems as though "
	ICALL2 THE-PRINT,L
	PRINTR " has it."
?L8:	FSET? L,CONTBIT \?L9
	CALL2 VISIBLE?,PRSO >STACK
	ZERO? STACK /?L9
	IN? L,GLOBAL-OBJECTS /?L9
	FSET? PRSO,PERSON \?L10
	PRINTI "He"
	JUMP ?L12
?L10:	PRINTI "It"
?L12:	PRINTI "'s in"
	ICALL2 TRPRINT,L
	RTRUE
?L9:	PRINTR "You'll have to find it yourself!"

	.FUNCT V-FLUSH
	PRINTR "Perhaps the strain is getting to you."

	.FUNCT V-FOLLOW
	IN? PRSO,HERE \?L1
	PRINTI "But"
	ICALL1 TPRINT-PRSO
	PRINTR " is right here!"
?L1:	FSET? PRSO,PERSON /?L3
	CALL1 IMPOSSIBLES >STACK
	RSTACK
?L3:	PRINTI "You have no idea where"
	ICALL1 TPRINT-PRSO
	PRINTR " is."

	.FUNCT PRE-GIVE
	EQUAL? PRSA,V?GIVE \?L1
	EQUAL? PRSO,HANDS \?L1
	ICALL PERFORM,V?SHAKE-WITH,PRSI
	RTRUE
?L1:	CALL1 IDROP >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT V-GIVE
	FSET? PRSI,PERSON \?L1
	PRINTI "Briskly, "
	ICALL1 THE-PRINT-PRSI
	PRINTR " refuses your offer."
?L1:	PRINTI "You can't give "
	ICALL1 PRINTA-PRSO
	PRINTI " to "
	ICALL1 PRINTA-PRSI
	PRINTR "!"

	.FUNCT V-HELLO
	ZERO? PRSO /?L1
	PRINTR "[The proper way to talk to characters in the story is CHARACTER, HELLO.]"
?L1:	ICALL PERFORM,V?TELL,ME
	RTRUE

	.FUNCT V-HIDE
	EQUAL? HERE,SNIPER-ROOM \?L1
	ICALL PERFORM,V?HIDE-BEHIND,HALL-DOOR-E
	RTRUE
?L1:	PRINTI "There's no good place to hide "
	ZERO? PRSO /?L4
	PRINTI "t"
?L4:	PRINTR "here."

	.FUNCT V-HIDE-BEHIND
	CALL1 WASTES >STACK
	RSTACK

	.FUNCT V-HOLD
	ICALL PERFORM,V?TAKE,PRSO
	RTRUE

	.FUNCT V-IN
	FSET? HERE,SWAMPBIT \?L1
	ICALL PERFORM,V?ENTER,SWAMP
	RTRUE
?L1:	CALL2 DO-WALK,P?IN >STACK
	RSTACK

	.FUNCT V-INFLATE
	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-KICK,?TMP
	ICALL2 HACK-HACK,STR?49
	CALL1 IS-PERSON? >?TMP
	ZERO? ?TMP /?L2
	PUSH ?TMP
	JUMP ?L1
?L2:	CALL1 IS-OBJ-PROP-ANIMAL? >STACK
?L1:	CALL PRINT-ID,STR?50,STACK >STACK
	RSTACK

	.FUNCT V-KILL
	PRINTI "Pull yourself together."
	CRLF
	CALL1 IS-PERSON? >STACK
	ICALL PRINT-ID,STR?51,STACK
	CALL1 IS-OBJ-PROP-ANIMAL? >STACK
	ICALL PRINT-ID,STR?52,STACK
	EQUAL? PRSO,ME /?L1
	PUSH 0
	JUMP ?L2
?L1:	PUSH 1
?L2:	CALL PRINT-ID,STR?53,STACK >STACK
	RSTACK

	.FUNCT V-KISS
	PRINTI "Good grief! The pressure must be getting to you."
	CRLF
	CALL1 IS-PERSON? >STACK
	CALL PRINT-ID,STR?54,STACK >STACK
	RSTACK

	.FUNCT V-KNOCK
	FSET? PRSO,DOORBIT \?L1
	PRINTR "There's no answer."
?L1:	CALL2 HACK-HACK,STR?55 >STACK
	RSTACK

	.FUNCT V-LEAP
	ZERO? PRSO /?L3
	IN? PRSO,HERE /?L1
	CALL1 IMPOSSIBLES >STACK
	RSTACK
?L1:	ZERO? PRSO /?L3
	FSET? PRSO,PERSON \?L3
	ICALL PERFORM,V?KILL,PRSO
	RTRUE
?L3:	EQUAL? HERE,TOWER-SOUTH \?L4
	ICALL PERFORM,V?LEAP,BORDER-FENCE
	RTRUE
?L4:	CALL1 V-SKIP >STACK
	RSTACK

	.FUNCT V-LEAP-OFF
	ICALL PERFORM,V?LEAP,PRSO
	RTRUE

	.FUNCT V-LEAVE
	ZERO? PRSO \?L1
	SET 'PRSO,ROOMS
?L1:	EQUAL? PRSO,ROOMS \?L4
	CALL2 DO-WALK,P?OUT >STACK
	RSTACK
?L4:	IN? PROTAGONIST,PRSO \?L6
	ICALL PERFORM,V?DISEMBARK,PRSO
	RTRUE
?L6:	ICALL PERFORM,V?DROP,PRSO
	RTRUE

	.FUNCT V-LIE-DOWN
	CALL1 WASTES >STACK
	RSTACK

	.FUNCT V-LISTEN
	ZERO? PRSO \?L1
	EQUAL? SCENARIO,2 \?L3
	PRINTR "The wind is blowing through the trees, but other than that you should be more specific with what you are listening for."
?L3:	EQUAL? HERE,ANTIQUE-STORAGE \?L5
	ICALL PERFORM,PRSA,ANTIQUE-CONVERSATION
	RTRUE
?L5:	PRINTR "You don't hear anything you haven't heard before."
?L1:	PRINTI "At the moment, "
	ICALL1 THE-PRINT-PRSO
	PRINTR " makes no sound."

	.FUNCT PRE-LOCK
	RFALSE

	.FUNCT V-LOCK
	PRINTR "You can't lock that."

	.FUNCT V-LOOK
	ICALL2 DESCRIBE-ROOM,1
	CALL1 DESCRIBE-OBJECTS >STACK
	RSTACK

	.FUNCT V-LOOK-BEHIND
	FSET? PRSO,DOORBIT \?L1
	ICALL PERFORM,V?LOOK-INSIDE,PRSO
	RTRUE
?L1:	PRINTI "There is nothing behind "
	ICALL1 THE-PRINT-PRSO
	PRINT PERIOD-CR
	RTRUE

	.FUNCT V-LOOK-DOWN
	EQUAL? PRSO,ROOMS \?L1
	ICALL PERFORM,V?EXAMINE,GROUND
	RTRUE
?L1:	ICALL PERFORM,V?LOOK-INSIDE,PRSO
	RTRUE

	.FUNCT WHAT-CONTENTS
	CALL2 DESCRIBE-CONTENTS,PRSO >STACK
	ZERO? STACK \?L3
	PRINTI "nothing"
	IN? PROTAGONIST,PRSO \?L3
	PRINTI " (other than you)"
?L3:	PRINT PERIOD
	RTRUE

	.FUNCT V-LOOK-INSIDE
	FSET? PRSO,SURFACEBIT \?L1
	PRINTI "On "
	ICALL1 THE-PRINT-PRSO
	PRINTI " is "
	CALL1 WHAT-CONTENTS >STACK
	RSTACK
?L1:	FSET? PRSO,DOORBIT \?L3
	ICALL2 THIS-IS-IT,PRSO
	PRINTI "All you can tell is that "
	CALL1 TELL-OPEN-CLOSED >STACK
	RSTACK
?L3:	FSET? PRSO,CONTBIT \?L4
	LOC WINNER >STACK
	EQUAL? PRSO,STACK \?L5
	MOVE PROTAGONIST,ROOMS
	PRINTI "Aside from you, there's "
	ICALL1 WHAT-CONTENTS
	MOVE PROTAGONIST,PRSO
	RTRUE
?L5:	CALL2 SEE-INSIDE?,PRSO >STACK
	ZERO? STACK /?L7
	ICALL1 CTHE-PRINT-PRSO
	PRINTI " contains "
	CALL1 WHAT-CONTENTS >STACK
	RSTACK
?L7:	FSET? PRSO,OPENBIT /?L8
	FIRST? PRSO >STACK \?L8
	PRINTI "But "
	ICALL1 THE-PRINT-PRSO
	PRINTR " is closed."
?L8:	ICALL2 THIS-IS-IT,PRSO
	PRINTI "It seems "
	CALL1 TELL-OPEN-CLOSED >STACK
	RSTACK
?L4:	PRINTR "You can't look inside that."

	.FUNCT V-LOOK-OVER
	CALL1 V-EXAMINE >STACK
	RSTACK

	.FUNCT V-LOOK-UNDER
	CALL2 HELD?,PRSO >STACK
	ZERO? STACK /?L1
	FSET? PRSO,WORNBIT \?L3
	PRINTR "You're wearing it!"
?L3:	PRINT HOLDING-IT
	RTRUE
?L1:	PRINTI "There's nothing to be seen under"
	ICALL2 TRPRINT,PRSO
	RTRUE

	.FUNCT V-LOOK-UP
	EQUAL? PRSO,ROOMS \?L1
	FSET? HERE,HUTBIT /?L3
	ICALL PERFORM,V?EXAMINE,SKY
	RTRUE
?L3:	ICALL PERFORM,V?EXAMINE,CEILING
	RTRUE
?L1:	ICALL PERFORM,V?LOOK-INSIDE,PRSO
	RTRUE

	.FUNCT V-LOWER
	CALL1 V-RAISE >STACK
	RSTACK

	.FUNCT V-MAKE
	PRINTI "You can't make"
	ICALL2 ARPRINT,PRSO
	RTRUE

	.FUNCT V-MOVE
	CALL2 HELD?,PRSO >STACK
	ZERO? STACK /?L1
	PRINTR "Why juggle objects?"
?L1:	CALL1 LOC-CLOSED >STACK
	ZERO? STACK \TRUE
	FSET? PRSO,TAKEBIT \?L4
	PRINTI "Moving"
	ICALL1 TPRINT-PRSO
	PRINTR " reveals nothing."
?L4:	PRINTI "You can't move"
	ICALL2 TRPRINT,PRSO
	RTRUE

	.FUNCT V-MUNG
	ICALL2 HACK-HACK,STR?56
	CALL1 IS-PERSON? >STACK
	ICALL PRINT-ID,STR?57,STACK
	CALL1 IS-OBJ-PROP-ANIMAL? >STACK
	ICALL PRINT-ID,STR?58,STACK
	CALL1 IS-PART-OF-SELF? >STACK
	CALL PRINT-ID,STR?59,STACK >STACK
	RSTACK

	.FUNCT V-NO
	PRINTR "You could use a better attitude."

	.FUNCT V-RESET
	PRINTR "You can't reset that."

	.FUNCT V-OFF-2
	EQUAL? PRSO,WATCHING-OBJECT \?L1
	PRINTR "Not implemented."
?L1:	EQUAL? PRSO,TIMING-OBJECT \?L3
	ICALL PERFORM,V?OFF,PRSO
	RTRUE
?L3:	PRINTR "That sentence doesn't make sense."

	.FUNCT V-OFF
	ICALL PERFORM,V?DISPOSE,PRSO
	RTRUE

	.FUNCT V-ON-2
	EQUAL? PRSO,WATCHING-OBJECT,TIMING-OBJECT \?L1
	ICALL PERFORM,V?WATCH,PRSI
	RTRUE
?L1:	PRINTR "That sentence doesn't make sense."

	.FUNCT V-ON
	CALL2 CANT-TURN,STR?60 >STACK
	RSTACK

	.FUNCT CANT-TURN,STRING
	PRINTI "You can't turn that o"
	PRINT STRING
	PRINTR "."

	.FUNCT V-OPEN
	FSET? PRSO,SURFACEBIT /?L3
	FSET? PRSO,PERSON \?L1
?L3:	CALL1 IMPOSSIBLES >STACK
	RSTACK
?L1:	FSET? PRSO,OPENBIT \?L4
	PRINTR "It's already open."
?L4:	FSET? PRSO,DOORBIT \?L5
	FSET PRSO,OPENBIT
	FSET PRSO,TOUCHBIT
	PRINTI "The "
	ICALL2 DPRINT,PRSO
	PRINTR " swings open."
?L5:	FSET? PRSO,CONTBIT \?L8
	FSET PRSO,OPENBIT
	FSET PRSO,TOUCHBIT
	FIRST? PRSO >STACK \?L11
	FSET? PRSO,TRANSBIT \?L9
?L11:	PRINTR "Opened."
?L9:	PRINTI "Opening"
	ICALL1 TPRINT-PRSO
	PRINTI " reveals "
	CALL DESCRIBE-CONTENTS,PRSO,-1 >STACK
	ZERO? STACK \?L13
	PRINTI "nothing"
?L13:	PRINTR "."
?L8:	CALL2 CANT-VERB-A-PRSO,STR?61 >STACK
	RSTACK

	.FUNCT V-PICK
	PRINTR "You can't pick that."

	.FUNCT V-PICK-UP
	ICALL PERFORM,V?TAKE,PRSO,PRSI
	RTRUE

	.FUNCT V-PLAY
	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-PLUG-IN
	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-POINT,ACTOR
	PRINTR "Pointless."

	.FUNCT V-POUR
	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-PUSH
	ICALL2 HACK-HACK,STR?62
	CALL1 IS-PERSON? >STACK
	CALL PRINT-ID,STR?63,STACK >STACK
	RSTACK

	.FUNCT PRE-PUT
	EQUAL? PRSO,BODY-PARTS /FALSE
	EQUAL? PRSI,GROUND \?L3
	ICALL PERFORM,V?DROP,PRSO
	RTRUE
?L3:	IN? PRSO,WINNER \?L4
	FSET? PRSO,WORNBIT \?L4
	PRINTI "But, you are wearing "
	ICALL1 THE-PRINT-PRSO
	PRINT PERIOD-CR
	RTRUE
?L4:	CALL HELD?,PRSI,PRSO >STACK
	ZERO? STACK /?L5
	PRINTI "You can't put"
	ICALL1 TPRINT-PRSO
	PRINTI " in"
	ICALL1 TPRINT-PRSI
	PRINTI " when"
	ICALL1 TPRINT-PRSI
	PRINTI " is already in"
	ICALL1 TPRINT-PRSO
	PRINTR "!"
?L5:	CALL1 IDROP >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT V-PUT,?TMP
	FSET? PRSI,OPENBIT /?L1
	FSET? PRSI,DOORBIT /?L1
	FSET? PRSI,CONTBIT /?L1
	FSET? PRSI,SURFACEBIT /?L1
	PRINTI "You can't put"
	ICALL1 TPRINT-PRSO
	PRINTI " in "
	ICALL1 PRINTA-PRSI
	PRINTR "!"
?L1:	EQUAL? PRSI,PRSO /?L4
	CALL2 HELD?,PRSO >STACK
	ZERO? STACK /?L3
	FSET? PRSO,TAKEBIT /?L3
?L4:	PRINTR "How can you do that?"
?L3:	FSET? PRSI,OPENBIT /?L5
	FSET? PRSI,SURFACEBIT /?L5
	SET 'P-IT-OBJECT,PRSI
	PRINTI "Inspection reveals that"
	ICALL1 TPRINT-PRSI
	PRINTR " isn't open."
?L5:	IN? PRSO,PRSI \?L6
	PRINTI "But"
	ICALL1 TPRINT-PRSO
	PRINTI " is already in"
	ICALL2 TRPRINT,PRSI
	RTRUE
?L6:	FSET? PRSI,DOORBIT \?L7
	ICALL PERFORM,V?PUT-THROUGH,PRSO,PRSI
	RTRUE
?L7:	CALL2 WEIGHT,PRSI >?TMP
	GETP PRSO,P?SIZE >STACK
	ADD ?TMP,STACK >?TMP
	GETP PRSI,P?SIZE >STACK
	SUB ?TMP,STACK >?TMP
	GETP PRSI,P?CAPACITY >STACK
	GRTR? ?TMP,STACK \?L8
	PRINTI "There's no room "
	FSET? PRSI,SURFACEBIT \?L9
	PRINTI "on"
	JUMP ?L11
?L9:	PRINTI "in"
?L11:	ICALL1 TPRINT-PRSI
	PRINTI " for"
	ICALL2 TRPRINT,PRSO
	RTRUE
?L8:	CALL2 HELD?,PRSO >STACK
	ZERO? STACK \?L12
	CALL1 ITAKE >STACK
	EQUAL? STACK,M-FATAL,0 /TRUE
?L12:	MOVE PRSO,PRSI
	FSET PRSO,TOUCHBIT
	PRINTR "Done."

	.FUNCT V-PUT-BEHIND
	CALL1 WASTES >STACK
	RSTACK

	.FUNCT V-PUT-ON
	EQUAL? PRSI,ME \?L1
	ICALL PERFORM,V?WEAR,PRSO
	RTRUE
?L1:	FSET? PRSI,SURFACEBIT \?L3
	CALL1 V-PUT >STACK
	RSTACK
?L3:	PRINTI "There's no good surface on"
	ICALL2 TRPRINT,PRSI
	RTRUE

	.FUNCT V-PUT-THROUGH
	FSET? PRSI,DOORBIT \?L1
	PRINTR "It would be imprudent to throw things through a door."
?L1:	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-PUT-UNDER
	CALL1 WASTES >STACK
	RSTACK

	.FUNCT V-RAISE
	CALL2 HACK-HACK,STR?64 >STACK
	RSTACK

	.FUNCT V-REACH-IN,OBJ
	FIRST? PRSO >OBJ /?L1
?L1:	FSET? PRSO,PERSON /?L4
	FSET? PRSO,SURFACEBIT /?L4
	FSET? PRSO,CONTBIT /?L2
?L4:	CALL2 PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE
?L2:	FSET? PRSO,OPENBIT /?L5
	ICALL PERFORM,V?LOOK-INSIDE,PRSO
	RTRUE
?L5:	ZERO? OBJ /?L7
	FSET? OBJ,INVISIBLE /?L7
	FSET? OBJ,TAKEBIT /?L6
?L7:	PRINTI "There's nothing in"
	ICALL2 TRPRINT,PRSO
	RTRUE
?L6:	PRINTI "You reach into"
	ICALL1 TPRINT-PRSO
	PRINTR " and feel something."

	.FUNCT PRE-READ
	ZERO? PRSI /FALSE
	FSET? PRSI,TRANSBIT /FALSE
	PRINTR "You would need an x-ray machine for that."

	.FUNCT V-READ
	PRINTI "You cannot read"
	ICALL2 ARPRINT,PRSO
	RTRUE

	.FUNCT V-REMOVE
	FSET? PRSO,WEARBIT \?L1
	ICALL PERFORM,V?TAKE-OFF,PRSO
	RTRUE
?L1:	ICALL PERFORM,V?TAKE,PRSO
	RTRUE

	.FUNCT V-RIP
	PRINTI "Unrippable."
	CRLF
	CALL1 IS-PERSON? >STACK
	CALL PRINT-ID,STR?65,STACK >STACK
	RSTACK

	.FUNCT V-SAVE-SOMETHING
	PRINTR "You would do better to start helping yourself."

	.FUNCT V-SAY,V
	EQUAL? SCENARIO,1 \?L1
	ICALL1 SIIF
	CALL1 STOP >STACK
	RSTACK
?L1:	EQUAL? SCENARIO,3 \?L3
	ZERO? AWAITING-PASSWORD /?L3
	ICALL1 CHECK-PASSWORD
	CALL1 STOP >STACK
	RSTACK
?L3:	CALL FIND-IN,HERE,PERSON >V
	ZERO? V \?L6
	CALL GLOBAL-IN?,VENDOR,HERE >STACK
	ZERO? STACK /?L4
	ZERO? V \?L6
	SET 'V,VENDOR
?L6:	EQUAL? SCENARIO,3 \?L9
	ICALL PERFORM,V?TELL,V
	JUMP ?L11
?L9:	PRINTI "You must address"
	ICALL2 TPRINT,V
	PRINTI " directly."
	CRLF
?L11:	CALL1 STOP >STACK
	RSTACK
?L4:	ICALL PERFORM,V?TELL,ME
	CALL1 STOP >STACK
	RSTACK

	.FUNCT V-SCORE
	PRINTR "There is no score in this game."

	.FUNCT V-SEARCH
	FSET? PRSO,PERSON \?L1
	PRINTR "That wouldn't be polite."
?L1:	FSET? PRSO,CONTBIT \?L4
	FSET? PRSO,OPENBIT /?L3
	PRINTR "You'll have to open that first."
?L3:	FSET? PRSO,CONTBIT \?L4
	FIRST? PRSO >STACK \?L4
	FIRST? PRSO >STACK /?L5
?L5:	FSET? STACK,NDESCBIT /?L4
	PRINTI "You find "
	CALL DESCRIBE-CONTENTS,PRSO,-1 >STACK
	ZERO? STACK \?L6
	PRINTI " nothing"
?L6:	PRINTR "."
?L4:	PRINTR "You find nothing unusual."

	.FUNCT V-SET
	ZERO? PRSI \?L1
	FSET? PRSO,TAKEBIT \?L3
	CALL2 HACK-HACK,STR?66 >STACK
	RSTACK
?L3:	PRINT YNH
	ICALL2 TRPRINT,PRSO
	RTRUE
?L1:	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-SGIVE
	ICALL PERFORM,V?GIVE,PRSI,PRSO
	RTRUE

	.FUNCT V-SHAKE
	FSET? PRSO,PERSON \?L1
	PRINTR "Try to vent your anger in a more productive way."
?L1:	CALL2 HACK-HACK,STR?67 >STACK
	RSTACK

	.FUNCT V-SHAKE-WITH
	EQUAL? PRSO,HANDS /?L1
	PRINT RECOGNIZE
	RTRUE
?L1:	FSET? PRSI,PERSON /?L3
	PRINTI "I don't think"
	ICALL1 TPRINT-PRSI
	PRINTR " even has hands."
?L3:	ICALL PERFORM,V?THANK,PRSI
	RTRUE

	.FUNCT V-SHOW
	PRINTI "It's doubtful"
	ICALL1 TPRINT-PRSI
	PRINTR " is interested."

	.FUNCT V-SIGN
	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-SIT
	CALL1 WASTES >STACK
	RSTACK

	.FUNCT V-SKIP
	PRINTR "That won't help, and just might get you caught."

	.FUNCT V-SLEEP
	PRINTR "You're not tired."

	.FUNCT V-SMELL
	ZERO? PRSO \?L1
	ICALL PERFORM,V?SMELL,ME
	RTRUE
?L1:	PRINTI "It smells just like "
	ICALL1 PRINTA-PRSO
	PRINT PERIOD-CR
	RTRUE

	.FUNCT V-SMILE
	PRINTI "How nice."
	CRLF
	CALL2 PRINT-ID,STR?68 >STACK
	RSTACK

	.FUNCT V-SPIN
	PRINTR "You can't spin that!"

	.FUNCT V-SPUT-ON
	ICALL PERFORM,V?PUT-ON,PRSI,PRSO
	RTRUE

	.FUNCT V-SSHOW
	ICALL PERFORM,V?SHOW,PRSI,PRSO
	RTRUE

	.FUNCT V-STAND
	ZERO? PRSO /?L1
	FSET? PRSO,TAKEBIT \?L1
	CALL1 WASTES >STACK
	RSTACK
?L1:	PRINTR "You are already standing."

	.FUNCT V-STAND-ON
	CALL1 WASTES >STACK
	RSTACK

	.FUNCT V-STELL
	ICALL PERFORM,V?TELL,PRSI
	RTRUE

	.FUNCT PRE-TAKE
	GET P-OFW,0 >STACK
	EQUAL? STACK,W?PHOTO,W?PHOTOGRAPH,W?PICTURE \?L1
	ICALL PERFORM,V?PHOTOGRAPH,PRSO
	RTRUE
?L1:	CALL1 LOC-CLOSED >STACK
	ZERO? STACK \TRUE
	EQUAL? PRSI,GROUND \?L4
	ICALL PERFORM,PRSA,PRSO
	RTRUE
?L4:	IN? PROTAGONIST,PRSO \?L5
	PRINTR "You're in it!"
?L5:	ZERO? PRSI /?L6
	FSET? PRSI,FILMBIT \?L6
	FSET? PRSO,FILMBIT \?L6
	PRINTR "You can't take the film out of the roll without destroying it."
?L6:	EQUAL? PRSO,PHONY-FILM /FALSE
	ZERO? PRSI /?L23
	FSET? PRSO,FILMBIT \?L8
	GET P-ADJW,0 >STACK
	ZERO? STACK \?L8
	EQUAL? PRSI,CAMERA \?L8
	ICALL PERFORM,PRSA,PHONY-FILM,CAMERA
	RTRUE
?L8:	ZERO? PRSI \?L14
?L23:	IN? PRSO,PROTAGONIST /?L10
	CALL2 HELD?,PRSO >STACK
	ZERO? STACK /?L9
	FSET? PRSO,TAKEBIT /?L9
?L10:	FSET? PRSO,WORNBIT \?L11
	EQUAL? PRSO,WOUNDED-LEFT-ARM /?L11
	PRINTR "You are already wearing it."
?L11:	PRINTR "You already have it."
?L9:	ZERO? PRSI /FALSE
?L14:	IN? PRSO,PRSI /FALSE
	EQUAL? PRSO,ME \?L16
	ICALL PERFORM,V?DROP,PRSI
	RTRUE
?L16:	IN? PRSO,PRSI /?L17
	EQUAL? PRSI,BY-GUARDS /?L17
	PRINTI "But"
	ICALL1 TPRINT-PRSO
	PRINTI " isn't "
	FSET? PRSI,PERSON \?L18
	PRINTI "being held by "
	JUMP ?L21
?L18:	FSET? PRSI,SURFACEBIT \?L20
	PRINTI "on "
	JUMP ?L21
?L20:	PRINTI "in "
?L21:	ICALL1 THE-PRINT-PRSI
	PRINT PERIOD-CR
	RTRUE
?L17:	SET 'PRSI,0
	RFALSE

	.FUNCT V-TAKE
	CALL1 ITAKE >STACK
	EQUAL? STACK,1 \FALSE
	PRINTI "Taken."
	CRLF
	CALL1 IS-THEFT? >STACK
	CALL PRINT-ID,STR?69,STACK >STACK
	RSTACK

	.FUNCT V-TAKE-OFF,?TMP
	FSET? PRSO,WORNBIT \?L1
	FCLEAR PRSO,WORNBIT
	REMOVE PRSO
	CALL2 WEIGHT,PRSO >?TMP
	CALL2 WEIGHT,PROTAGONIST >STACK
	ADD ?TMP,STACK >STACK
	GRTR? STACK,MAX-WEIGHT \?L3
	MOVE PRSO,HERE
	PRINTI "You take off "
	ICALL1 THE-PRINT-PRSO
	PRINTR ". It's too heavy to carry, so you put it down on the ground."
?L3:	MOVE PRSO,WINNER
	PRINTI "Okay, you're no longer wearing "
	ICALL1 THE-PRINT-PRSO
	PRINT PERIOD-CR
	RTRUE
?L1:	PRINTI "You aren't wearing"
	ICALL2 TRPRINT,PRSO
	RTRUE

	.FUNCT V-TELL
	EQUAL? SCENARIO,1 \?L1
	EQUAL? PRSO,BAD-SPY \?L3
	PRINTI "He is engaged in conversation with some people in another compartment, so it isn't surprising that he ignores you."
	CRLF
	JUMP ?L7
?L3:	PRINTI "To say something out loud, try SAY ""what you want to say"""
	CRLF
	JUMP ?L7
?L1:	EQUAL? SCENARIO,2 \?L6
	PRINTI "Talking out loud here is only going to get you caught."
	CRLF
	JUMP ?L7
?L6:	PRINTI "You can't talk to that!"
	CRLF
?L7:	CALL1 STOP >STACK
	RSTACK

	.FUNCT V-TELL-ABOUT
	EQUAL? PRSO,ME \?L1
	ICALL PERFORM,V?WHAT,PRSI
	RTRUE
?L1:	PRINTI "It doesn't look like"
	ICALL1 TPRINT-PRSO
	PRINTR " is interested."

	.FUNCT V-THANK
	FSET? PRSO,PERSON \?L1
	PRINTI "You do so, but"
	ICALL1 TPRINT-PRSO
	PRINTR " seems less than overjoyed."
?L1:	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-THROW
	CALL1 SPECIAL-DROP >STACK
	ZERO? STACK \FALSE
	PRINTR "An almost perfect waste of time."

	.FUNCT V-THROW-OFF
	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-TIE
	PRINTI "You can't tie"
	ICALL2 ARPRINT,PRSO
	RTRUE

	.FUNCT V-TIE-FLIP
	ICALL PERFORM,V?TIE,PRSI,PRSO
	RTRUE

	.FUNCT V-TIE-TOGETHER
	CALL1 V-TIE >STACK
	RSTACK

	.FUNCT V-TOUCH
	CALL1 LOC-CLOSED >STACK
	ZERO? STACK \TRUE
	ICALL2 HACK-HACK,STR?70
	CALL1 IS-PERSON? >STACK
	CALL PRINT-ID,STR?71,STACK >STACK
	RSTACK

	.FUNCT V-UNLOCK
	FSET? PRSO,DOORBIT \?L1
	PRINTI "But the "
	ICALL2 DPRINT,PRSO
	PRINTR " isn't locked."
?L1:	CALL2 PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT V-UNTIE
	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-USE
	PRINTI "You'll have to be more specific about how you want to use"
	ICALL2 TRPRINT,PRSO
	RTRUE

	.FUNCT V-WALK,PT,PTS,STR,OBJ,RM
?L0:	ZERO? P-WALK-DIR \?L1
	ICALL PERFORM,V?WALK-TO,PRSO
	RTRUE
?L1:	GETPT HERE,PRSO >PT
	ZERO? PT /?L3
	PTSIZE PT >PTS
	EQUAL? PTS,UEXIT \?L4
	GET PT,REXIT >STACK
	CALL2 GOTO,STACK >STACK
	RSTACK
?L4:	EQUAL? PTS,NEXIT \?L6
	GET PT,NEXITSTR >STACK
	PRINT STACK
	CRLF
	RETURN 8
?L6:	EQUAL? PTS,FEXIT \?L9
	GET PT,FEXITFCN >STACK
	CALL1 STACK >RM
	ZERO? RM /?L10
	EQUAL? SCENARIO,3 \?L12
	CALL BACKTRACK?,RM,1 >STACK
	ZERO? STACK /?L12
	RETURN 8
?L12:	CALL2 GOTO,RM >STACK
	RSTACK
?L10:	RETURN 8
?L9:	EQUAL? PTS,SEXIT \?L20
	GET PT,SEXITSTR >STR
	ZERO? STR /?L27
	EQUAL? SCENARIO,3 \?L23
	GET PT,REXIT >STACK
	CALL2 BACKTRACK?,STACK >STACK
	ZERO? STACK /?L23
	RETURN 8
?L23:	PRINT STR
	CRLF
?L27:	GETB PT,SEXITFLG >STACK
	VALUE STACK >STR
	ZERO? STR /?L29
	CRLF
?L29:	GET PT,REXIT >STACK
	CALL GOTO,STACK,STR >STACK
	RSTACK
?L20:	EQUAL? PTS,DEXIT \FALSE
	GET PT,DEXITOBJ >OBJ
	FSET? OBJ,OPENBIT \?L33
	GET PT,REXIT >STACK
	CALL2 GOTO,STACK >STACK
	RSTACK
?L33:	GET PT,DEXITSTR >STR
	ZERO? STR /?L35
	PRINT STR
	CRLF
	SET 'P-IT-OBJECT,OBJ
	RETURN 8
?L35:	PRINTI "The "
	ICALL2 DPRINT,OBJ
	PRINTI " is closed."
	CRLF
	SET 'P-IT-OBJECT,OBJ
	RETURN 8
?L3:	EQUAL? PRSO,P?IN \?L42
	GETP HERE,P?IN-DIR >STR
	ZERO? STR /?L42
	SET 'PRSO,STR
	JUMP ?L0
?L42:	EQUAL? PRSO,P?OUT \?L43
	GETP HERE,P?OUT-DIR >STR
	ZERO? STR /?L43
	SET 'PRSO,STR
	JUMP ?L0
?L43:	EQUAL? PRSO,P?IN,P?OUT \?L45
	ICALL1 V-WALK-AROUND
	RETURN 8
?L45:	PRINT CANT-GO
	RETURN 8

	.FUNCT V-WALK-AROUND
	PRINTR "Just say the direction you want to move in."

	.FUNCT V-WALK-TO
	CALL2 DIRECTION?,PRSO >STACK
	ZERO? STACK /?L1
	CALL2 DO-WALK,P-DIRECTION >STACK
	RSTACK
?L1:	CALL1 V-WALK-AROUND >STACK
	RSTACK

	.FUNCT V-WAIT,NUM,PERSON?1,NW
	ASSIGNED? 'NUM /?L19
	SET 'NUM,0
?L19:	ZERO? MINUTES-FLAG /?L1
	MUL NUM,60 >NUM
?L1:	GRTR? NUM,999 \?L4
	PRINTI "That's too long to wait! You've not much time left!"
	CRLF
	SET 'CLOCK-MOVE,0
	RTRUE
?L4:	PRINTI "Time passes..."
	CRLF
	ZERO? NUM \?L9
	SET 'NUM,30
	EQUAL? SCENARIO,1 \?L9
	SET 'NUM,90
?L9:	DIV NUM,5 >NW
	SET 'I-FATAL,0
?L13:	ZERO? I-FATAL \?L14
	DLESS? 'NW,0 /?L14
	ICALL2 I-CLOCKER,5
	JUMP ?L13
?L14:	SET 'CLOCK-MOVE,0
	RTRUE

	.FUNCT V-$0024WAIT
	EQUAL? PRSO,INTNUM \?L1
	CALL2 V-WAIT,P-NUMBER >STACK
	RSTACK
?L1:	CALL1 V-WAIT >STACK
	RSTACK

	.FUNCT V-WAIT-FOR
	EQUAL? PRSO,INTNUM \?L1
	ICALL PERFORM,V?$0024WAIT,INTNUM
	RTRUE
?L1:	PRINTR "You may be waiting quite a while."

	.FUNCT V-WAIT-IN
	IN? PROTAGONIST,PRSO \?L1
	CALL1 V-WAIT >STACK
	RSTACK
?L1:	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-WAVE
	CALL1 IMPOSSIBLES >STACK
	RSTACK

	.FUNCT V-WAVE-AT
	ZERO? PRSO \?L1
	CALL1 V-SMILE >STACK
	RSTACK
?L1:	PRINTI "It doesn't seem that "
	ICALL1 THE-PRINT-PRSO
	PRINTR " is likely to respond."

	.FUNCT V-WEAR
	FSET? PRSO,WORNBIT \?L1
	PRINTI "You're already wearing"
	ICALL2 TRPRINT,PRSO
	RTRUE
?L1:	FSET? PRSO,WEARBIT \?L3
	MOVE PRSO,PROTAGONIST
	FSET PRSO,WORNBIT
	PRINTI "You are now wearing"
	ICALL2 TRPRINT,PRSO
	RTRUE
?L3:	PRINTI "You can't wear "
	ICALL1 THE-PRINT-PRSO
	PRINT PERIOD-CR
	RTRUE

	.FUNCT V-WHAT
	ZERO? PRSO \?L1
	PRINTI "That's what."
	CRLF
	JUMP ?L3
?L1:	PRINTI "Good question."
	CRLF
?L3:	CALL1 STOP >STACK
	RSTACK

	.FUNCT V-WHERE
	ZERO? PRSO /?L1
	CALL2 V-FIND,1 >STACK
	RSTACK
?L1:	PRINTR "Right here."

	.FUNCT V-WHO
	ZERO? PRSO \?L1
	PRINTR "You."
?L1:	FSET? PRSO,PERSON \?L3
	ICALL PERFORM,V?WHAT,PRSO
	RTRUE
?L3:	PRINTR "That's for you to find out!"

	.FUNCT V-WHY
	PRINTR "In this country, it is best not to ask."

	.FUNCT V-YELL
	PRINTI "Not wise. It would only call attention to yourself."
	CRLF
	ICALL2 PRINT-ID,STR?72
	CALL1 STOP >STACK
	RSTACK

	.FUNCT V-YES
	PRINTR "Yes?"

	.FUNCT ITAKE,VB,OBJ,?TMP
	ASSIGNED? 'VB /?L37
	SET 'VB,1
?L37:	FSET? PRSO,TAKEBIT /?L1
	ZERO? VB /?L3
	ICALL1 IMPOSSIBLES
?L3:	RETURN 8
?L1:	CALL2 HELD?,PRSO >STACK
	ZERO? STACK \?L8
	CALL2 WEIGHT,PRSO >?TMP
	CALL2 WEIGHT,PROTAGONIST >STACK
	ADD ?TMP,STACK >STACK
	GRTR? STACK,MAX-WEIGHT \?L8
	ZERO? VB /?L9
	PRINTI "It's too heavy, considering "
	EQUAL? SCENARIO,2 \?L13
	CALL2 WEIGHT,PROTAGONIST >?TMP
	DIV MAX-WEIGHT,2 >STACK
	GRTR? ?TMP,STACK \?L14
?L13:	PRINTI "what you're already holding"
	EQUAL? SCENARIO,2 \?L18
	PRINTI " and "
?L14:	EQUAL? SCENARIO,2 \?L18
	PRINTI "your bad arm"
?L18:	PRINT PERIOD-CR
?L9:	RETURN 8
?L8:	CALL2 CCOUNT,PROTAGONIST >STACK
	GRTR? STACK,5 \?L24
	ZERO? VB /?L25
	PRINTI "You're already holding as many items as you can"
	EQUAL? SCENARIO,2 \?L27
	PRINTI ", especially in light of your bad arm"
?L27:	PRINT PERIOD-CR
?L25:	RETURN 8
?L24:	EQUAL? PRSO,EXPLODING-PEN \?L34
	IN? PRSO,FENCE \?L34
	FCLEAR HERE,PENBIT
	GETP HERE,P?ACROSS >STACK
	FCLEAR STACK,PENBIT
?L34:	MOVE PRSO,PROTAGONIST
	FSET PRSO,TOUCHBIT
	FCLEAR PRSO,NDESCBIT
	FCLEAR PRSO,WORNBIT
	RTRUE

	.FUNCT IDROP
	EQUAL? PRSO,INTNUM \?L1
	SET 'CLOCK-WAIT,1
	RETURN 8
?L1:	EQUAL? PRSO,HANDS \?L5
	EQUAL? PRSA,V?GIVE,V?THROW,V?DROP \FALSE
	CALL1 IMPOSSIBLES >STACK
	RSTACK
?L5:	IN? PRSO,GLOBAL-OBJECTS \?L9
	PRINTR "Don't lose your head, now! You can't do that!"
?L9:	CALL2 HELD?,PRSO >STACK
	ZERO? STACK \?L10
	PRINTI "That's easy for you to say since you don't even have"
	ICALL2 TRPRINT,PRSO
	RTRUE
?L10:	IN? PRSO,PROTAGONIST /?L11
	LOC PRSO >STACK
	FSET? STACK,CONTBIT \?L11
	LOC PRSO >STACK
	FSET? STACK,OPENBIT /?L11
	PRINTI "Impossible because"
	LOC PRSO >STACK
	ICALL2 TPRINT,STACK
	PRINTR " is closed."
?L11:	FSET? PRSO,WORNBIT \FALSE
	PRINTI "You'll have to remove "
	FSET? PRSO,PLURALBIT \?L13
	PRINTI "them"
	JUMP ?L15
?L13:	PRINTI "that"
?L15:	PRINTR " first."

	.FUNCT CCOUNT,OBJ,CNT,X
	SET 'CNT,0
	FIRST? OBJ >X \?L4
?L3:	FSET? X,WORNBIT /?L5
	INC 'CNT
?L5:	NEXT? X >X /?L3
?L4:	RETURN CNT

	.FUNCT WEIGHT,OBJ,CONT,WT
	SET 'WT,0
	FIRST? OBJ >CONT \?L4
?L3:	EQUAL? OBJ,PROTAGONIST \?L8
	FSET? CONT,WORNBIT \?L5
	INC 'WT
	JUMP ?L9
?L5:	EQUAL? OBJ,PROTAGONIST \?L8
	LOC CONT >STACK
	FSET? STACK,WORNBIT \?L7
	INC 'WT
	JUMP ?L9
?L7:	EQUAL? OBJ,PROTAGONIST \?L8
	INC 'WT
	JUMP ?L9
?L8:	CALL2 WEIGHT,CONT >STACK
	ADD WT,STACK >WT
?L9:	NEXT? CONT >CONT /?L3
?L4:	GETP OBJ,P?SIZE >STACK
	ADD WT,STACK >STACK
	RSTACK

	.FUNCT GOTO,NEW-LOC,DESC?,OLD-HERE
	ASSIGNED? 'DESC? /?L52
	SET 'DESC?,1
?L52:	ZERO? DESC? \?L1
	SET 'MOVE-FORCED,1
	JUMP ?L3
?L1:	SET 'MOVE-FORCED,0
?L3:	FCLEAR COMP-N-DOOR,OPENBIT
	EQUAL? SCENARIO,2 \?L4
	GETP SHOES-WORN,P?SPEED >STACK
	MUL STACK,100 >STACK
	DIV STACK,HEALTH >STACK
	DIV STACK,WARMTH >CLOCK-MOVE
	FSET? NEW-LOC,VILLAGEBIT \?L6
	FSET? HERE,VILLAGEBIT \?L6
	DIV CLOCK-MOVE,4 >CLOCK-MOVE
	JUMP ?L26
?L6:	EQUAL? INSIDE-SHED,NEW-LOC,HERE \?L8
	DIV CLOCK-MOVE,4 >CLOCK-MOVE
	JUMP ?L26
?L8:	FSET? NEW-LOC,VILLAGEBIT /?L10
	FSET? HERE,VILLAGEBIT \?L9
?L10:	DIV CLOCK-MOVE,2 >CLOCK-MOVE
	JUMP ?L26
?L9:	FSET? NEW-LOC,GVIEWBIT \?L26
	FSET? HERE,GVIEWBIT \?L26
	EQUAL? PRSO,P?NORTH,P?SOUTH /?L14
	EQUAL? PRSO,P?UP,P?DOWN \?L26
?L14:	DIV CLOCK-MOVE,3 >CLOCK-MOVE
	JUMP ?L26
?L4:	EQUAL? SCENARIO,1 \?L17
	FSET? HERE,PLATFORMBIT \?L18
	SET 'CLOCK-MOVE,25
	JUMP ?L26
?L18:	SET 'CLOCK-MOVE,15
	JUMP ?L26
?L17:	SET 'CLOCK-MOVE,29
	FSET? HERE,HUTBIT \?L22
	SET 'CLOCK-MOVE,7
	JUMP ?L24
?L22:	EQUAL? HERE,FIRE-2,FIRE-3,FIRE-4 \?L24
	SET 'CLOCK-MOVE,9
?L24:	ZERO? TOPAZ-FIGHT /?L26
	MUL CLOCK-MOVE,2 >STACK
	DIV STACK,3 >CLOCK-MOVE
?L26:	EQUAL? SCENARIO,3 \?L29
	CALL2 BACKTRACK?,NEW-LOC >STACK
	ZERO? STACK \TRUE
?L29:	SET 'OLD-HERE,HERE
	MOVE PROTAGONIST,NEW-LOC
	IN? NEW-LOC,ROOMS \?L32
	SET 'HERE,NEW-LOC
	JUMP ?L34
?L32:	LOC NEW-LOC >HERE
?L34:	GET SCENARIO-TBL,SCENARIO >STACK
	ICALL STACK,M-ENTER,OLD-HERE
	EQUAL? HERE,NEW-LOC \TRUE
	GETP HERE,P?ACTION >STACK
	ICALL2 STACK,M-ENTER
	EQUAL? HERE,NEW-LOC \TRUE
	ZERO? DESC? /?L41
	ZERO? DONT-DESCRIBE-ROOM \?L41
	ICALL1 DESCRIBE-ROOM
?L41:	SET 'DONT-DESCRIBE-ROOM,0
	ZERO? VERBOSITY /?L44
	EQUAL? SCENARIO,2,3 /?L46
	ZERO? DESC? /?L44
?L46:	ICALL1 DESCRIBE-OBJECTS
?L44:	GETP HERE,P?ACTION >STACK
	ICALL2 STACK,M-ENTER-DESC
	ZERO? G-WATCH \?L50
	ZERO? SL-WATCH /TRUE
?L50:	ICALL UPDATE-CHRONOGRAPH,0,1
	RTRUE

	.FUNCT BACKTRACK?,NEW-LOC,TOO-LATE?
	ASSIGNED? 'TOO-LATE? /?L7
	SET 'TOO-LATE?,0
?L7:	IN? TOPAZ,NEW-LOC \FALSE
	ZERO? CHASE-FLAG /FALSE
	ZERO? TOPAZ-FIGHT \FALSE
	ZERO? TOO-LATE? /?L3
	PRINTI "Seeing that this has put you closer to Topaz, you hastily retreat to your last position."
	JUMP ?L5
?L3:	PRINTI "You decide not to go in that direction - it would put you in Topaz's hands."
?L5:	ICALL1 TOPAZ-THOUGHT
	CRLF
	RTRUE

	.FUNCT JIGS-UP,DESC,CONTIN,FLG,L
	ASSIGNED? 'CONTIN /?L19
	SET 'CONTIN,0
?L19:	SET 'FLG,0
	LOC EXPLODING-PEN >L
	PRINT DESC
	GRTR? FUSE-ARMED,0 \?L1
	GET CLOCK-TBL,I-FUSE-OFF >STACK
	SUB STACK,CLOCK-TIME >DESC
	LESS? DESC,120 \?L1
	GRTR? DESC,0 \?L1
	SET 'CHRONOGRAPH-TIME,FUSE-ARMED
	LESS? DESC,180 \?L3
	IN? L,ROOMS \?L3
	IN? HUT-MAN,HERE \?L3
	EQUAL? L,HERE \?L5
	CRLF
	CRLF
	PRINTI "Just when you think that things couldn't get worse, they do. As you await the arrival of the border guards, the pen explodes, seriously wounding both you and your captor. The end result is the same, however.[EVENT: GAME OVER][RWD_ID: verbs:1662, VAL: -1]"
	ICALL2 PRINT-ID,STR?73
	JUMP ?L10
?L5:	FSET? L,HUTBIT \?L10
	FSET? HERE,HUTBIT \?L10
	CRLF
	CRLF
	PRINTI "A short while later, the pen explodes, turning the hut into an inferno. Unfortunately, the owner keeps his wits about him, and hustles you out of the hut to await the authorities.[EVENT: GAME OVER][RWD_ID: verbs:1668, VAL: -1]"
	CRLF
	ICALL2 PRINT-ID,STR?74
	JUMP ?L10
?L3:	LESS? DESC,30 \?L9
	CALL1 BOMB-IN-TOWER? >STACK
	ZERO? STACK /?L9
	EQUAL? HERE,TOWER-SOUTH,LADDER-TOP \?L9
	SET 'FLG,1
	CRLF
	CRLF
	PRINTI "As you are taken down the ladder, the bomb explodes, sending you and the guards tumbling to earth. In the confusion, you try to escape, but you are quickly recaptured.[EVENT: GAME OVER][RWD_ID: verbs:1678, VAL: -1]"
	ICALL2 PRINT-ID,STR?75
	JUMP ?L10
?L9:	FSET? HERE,GVIEWBIT \?L10
	CALL1 BOMB-IN-TOWER? >STACK
	ZERO? STACK /?L10
	SET 'FLG,1
	CRLF
	CRLF
	PRINTI "As you are taken away, the bomb explodes, and the tower collapses.[EVENT: GAME OVER]"
	ICALL2 PRINT-ID,STR?76
?L10:	ZERO? FLG /?L12
	LOC EXPLODING-PEN >STACK
	EQUAL? STACK,NE-POST,NW-POST \?L12
	PRINTI " Ironically, the northernmost part of the tower falls onto and over the border fence, landing at the place where you had been hoping to arrive."
?L12:	HLIGHT 0
	ICALL2 UPDATE-CHRONOGRAPH,0
?L1:	EQUAL? SCENARIO,2 \?L16
	CRLF
	CRLF
	PRINTI "****  You have been arrested  ****[EVENT: GAME OVER][RWD_ID: verbs:1694, VAL: -1]"
	CRLF
?L16:	HLIGHT H-NORMAL
	ICALL1 STATUS-LINE
	ICALL2 FINISH,CONTIN
	RTRUE

	.FUNCT BOMB-IN-TOWER?,L
	LOC EXPLODING-PEN >L
	EQUAL? L,NE-POST,NW-POST,TOWER-SOUTH /TRUE
	EQUAL? L,LADDER-TOP,SE-POST,SW-POST /TRUE
	RFALSE

	.FUNCT ACCESSIBLE?,OBJ,L
	ZERO? OBJ /FALSE
	LOC OBJ >L
	FSET? OBJ,INVISIBLE /FALSE
	ZERO? L /FALSE
	EQUAL? L,GLOBAL-OBJECTS /TRUE
	EQUAL? L,LOCAL-GLOBALS \?L8
	CALL GLOBAL-IN?,OBJ,HERE >STACK
	ZERO? STACK \TRUE
?L8:	CALL2 META-LOC,OBJ >STACK
	EQUAL? STACK,HERE \FALSE
	EQUAL? L,WINNER,HERE /TRUE
	FSET? L,OPENBIT \FALSE
	CALL2 ACCESSIBLE?,L >STACK
	ZERO? STACK /FALSE
	RTRUE

	.FUNCT VISIBLE?,OBJ,L
	ZERO? OBJ /FALSE
	LOC OBJ >L
	CALL2 ACCESSIBLE?,OBJ >STACK
	ZERO? STACK \TRUE
	CALL2 SEE-INSIDE?,L >STACK
	ZERO? STACK /FALSE
	CALL2 VISIBLE?,L >STACK
	ZERO? STACK /FALSE
	RTRUE

	.FUNCT META-LOC,OBJ
?L1:	ZERO? OBJ /FALSE
	IN? OBJ,GLOBAL-OBJECTS \?L5
	RETURN GLOBAL-OBJECTS
?L5:	IN? OBJ,ROOMS \?L7
	RETURN OBJ
?L7:	LOC OBJ >OBJ
	JUMP ?L1

	.FUNCT OTHER-SIDE,DOBJ,P,TEE
	SET 'P,0
?L1:	NEXTP HERE,P >P
	LESS? P,P?OUT /FALSE
	GETPT HERE,P >TEE
	PTSIZE TEE >STACK
	EQUAL? STACK,DEXIT \?L1
	GETB TEE,DEXITOBJ >STACK
	EQUAL? STACK,DOBJ \?L1
	RETURN P

	.FUNCT ULTIMATELY-IN?,OBJ,WHR
	ASSIGNED? 'WHR /?L4
	SET 'WHR,0
?L4:	ZERO? WHR \?L1
	SET 'WHR,PROTAGONIST
?L1:	CALL HELD?,OBJ,WHR >STACK
	RSTACK

	.FUNCT HELD?,OBJ,CONT
	ASSIGNED? 'CONT /?L10
	SET 'CONT,0
?L10:	ZERO? CONT \?L1
	SET 'CONT,WINNER
?L1:	ZERO? OBJ /FALSE
	IN? OBJ,CONT /TRUE
	IN? OBJ,ROOMS /FALSE
	IN? OBJ,GLOBAL-OBJECTS /FALSE
	LOC OBJ >STACK
	CALL HELD?,STACK,CONT >STACK
	RSTACK

	.FUNCT SEE-INSIDE?,OBJ
	ZERO? OBJ /FALSE
	FSET? OBJ,INVISIBLE /FALSE
	FSET? OBJ,TRANSBIT /TRUE
	FSET? OBJ,OPENBIT /TRUE
	RFALSE

	.FUNCT GLOBAL-IN?,OBJ1,OBJ2,TEE
	GETPT OBJ2,P?GLOBAL >TEE
	ZERO? TEE /?L1
	PTSIZE TEE >STACK
	DIV STACK,2 >STACK
	INTBL? OBJ1,TEE,STACK >STACK /?L2
	RSTACK
?L1:	PUSH 0
?L2:	RSTACK

	.FUNCT FIND-IN,WHERE,FLAG-IN-QUESTION,STRING,OBJ
	ASSIGNED? 'STRING /?L14
	SET 'STRING,0
?L14:	FIRST? WHERE >OBJ \FALSE
?L2:	FSET? OBJ,FLAG-IN-QUESTION \?L7
	FSET? OBJ,INVISIBLE /?L7
	ZERO? STRING /?L9
	PRINTI "("
	PRINT STRING
	ICALL2 TPRINT,OBJ
	PRINTI ")"
	CRLF
?L9:	RETURN OBJ
?L7:	NEXT? OBJ >OBJ /?L2
	RFALSE

	.FUNCT DIRECTION?,OBJ
	EQUAL? OBJ,P?NORTH,P?SOUTH,P?EAST /TRUE
	EQUAL? OBJ,P?WEST,P?NE,P?NW /TRUE
	EQUAL? OBJ,P?SE,P?SW \FALSE
	RTRUE

	.FUNCT LOC-CLOSED
	LOC PRSO >STACK
	FSET? STACK,CONTBIT \FALSE
	LOC PRSO >STACK
	FSET? STACK,OPENBIT /FALSE
	FSET? PRSO,TAKEBIT \FALSE
	PRINTI "But"
	LOC PRSO >STACK
	ICALL2 TPRINT,STACK
	PRINTR " is closed!"

	.FUNCT DO-WALK,DIR
	SET 'P-WALK-DIR,DIR
	CALL PERFORM,V?WALK,DIR >STACK
	RSTACK

	.FUNCT STOP
	SET 'P-CONT,0
	SET 'QUOTE-FLAG,0
	RETURN 8

	.FUNCT HACK-HACK,STR
	PRINT STR
	ICALL1 THE-PRINT-PRSO
	CALL2 PICK-ONE,HO-HUM >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT IMPOSSIBLES
	CALL2 PICK-ONE,IMPOSSIBLE-LIST >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT WASTES
	CALL2 PICK-ONE,WASTE-LIST >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT V-WATCH
	ICALL PERFORM,V?EXAMINE,PRSO
	RTRUE

	.FUNCT V-SHOOT-FLIP
	ICALL PERFORM,V?SHOOT,PRSI,PRSO
	RTRUE

	.FUNCT V-SHOOT
	GET P-OFW,0 >STACK
	EQUAL? STACK,W?PHOTO,W?PHOTOGRAPH,W?PICTURE /?L3
	EQUAL? SCENARIO,1 \?L1
	IN? CAMERA,WINNER \?L1
?L3:	ICALL PERFORM,V?PHOTOGRAPH,PRSO
	RTRUE
?L1:	FSET? PRSO,PERSON \?L5
	PRINTI "That wouldn't help."
	CRLF
	CALL2 PRINT-ID,STR?77 >STACK
	RSTACK
?L5:	PRINTI "You can't shoot that."
	CRLF
	CALL1 IS-OBJ-PROP-ANIMAL? >STACK
	ICALL PRINT-ID,STR?78,STACK
	CALL1 IS-PART-OF-SELF? >STACK
	CALL PRINT-ID,STR?79,STACK >STACK
	RSTACK

	.FUNCT V-OIL
	PRINTI "There's nothing to be gained by oiling that."
	CRLF
	CALL2 PRINT-ID,STR?80 >STACK
	RSTACK

	.FUNCT V-TAKE-WITH
	PRINTR "You don't need to take it with that."

	.FUNCT V-LOAD
	PRINTR "You can't load that."

	.FUNCT V-SLOAD
	ICALL PERFORM,V?LOAD,PRSI,PRSO
	RTRUE

	.FUNCT V-REPLACE
	ZERO? PRSI \?L1
	EQUAL? PRSO,PEN-CAP \?L1
	ICALL PERFORM,V?PUT-ON,PEN-CAP,EXPLODING-PEN
	RTRUE
?L1:	PRINTI "You'll have to say what to put the "
	ICALL2 DPRINT,PRSO
	PRINTR " in."

	.FUNCT V-PHOTOGRAPH
	ZERO? PRSI /?L12
	EQUAL? PRSI,CAMERA /?L1
	PRINTI "You're not much of a photographer, if you think you can take pictures with a "
	ICALL2 DPRINT,PRSI
	PRINTR "."
?L1:	ZERO? PRSI \?L3
?L12:	IN? CAMERA,WINNER /?L3
	PRINTR "Perhaps you're thinking of a mental picture, since you won't get any other without a camera."
?L3:	EQUAL? PRSO,CAMERA \?L4
	EQUAL? HERE,LAVATORY /?L4
	PRINTR "Too bad you haven't got a mirror."
?L4:	EQUAL? PRSO,BODY-PARTS,LEFT-ARM,RIGHT-ARM /?L6
	EQUAL? PRSO,PICTURE \?L5
?L6:	PRINTR "That would be a good trick."
?L5:	CALL ULTIMATELY-IN?,PRSO,WINNER >STACK
	ZERO? STACK /?L7
	EQUAL? PRSO,CAMERA /?L7
	PRINTR "You'll have to put it down if you're going to take a picture of it."
?L7:	EQUAL? PRSO,ME \?L8
	PRINTR "You have more than enough of these already."
?L8:	LOC PRSO >STACK
	EQUAL? STACK,TOWEL-DISPENSER,TOILET-KIT,BRIEFCASE \?L9
	PRINTI "You might take it out of the "
	LOC PRSO >STACK
	ICALL2 DPRINT,STACK
	PRINTR " first."
?L9:	FSET? HERE,PLATFORMBIT \?L10
	PRINTR "A guard approaches you, waving his arms, and saying ""Nye mneshna fotomattni!"""
?L10:	ICALL1 TAKE-A-PICTURE
	RTRUE

	.FUNCT V-REWIND
	PRINTR "That is quite a concept."

	.FUNCT V-CROSS
	PRINTR "You'll have to indicate which direction you intend to go."

	.FUNCT V-FOLD
	PRINTR "There's no use in folding that."

	.FUNCT V-UNFOLD
	PRINTR "It's not folded up."

	.FUNCT V-SURRENDER
	EQUAL? SCENARIO,2 \?L1
	ICALL2 JIGS-UP,STR?81
	CALL2 PRINT-ID,STR?82 >STACK
	RSTACK
?L1:	PRINTR "To whom? Why?"

	.FUNCT V-DISPOSE
	EQUAL? HERE,COMP-5 \?L1
	FSET? COMP-WINDOW,OPENBIT \?L1
	IN? PRSO,WINNER \?L1
	ICALL PERFORM,V?PUT-THROUGH,PRSO,COMP-WINDOW
	RTRUE
?L1:	FSET? PRSO,PERSON \?L3
	PRINTR "That's something you'll have to do on your own."
?L3:	PRINTR "You'll have to be more explicit about how you want to throw it out."

	.FUNCT V-WET
	ICALL PERFORM,V?PUT,PRSO,GLOBAL-WATER
	RTRUE

	.FUNCT V-BRIBE
	PRINTI "You can't bribe "
	ICALL1 THE-PRINT-PRSO
	PRINT PERIOD-CR
	RTRUE

	.FUNCT V-TOPPLE
	CALL PERFORM,V?KILL,PRSO >STACK
	RSTACK

	.FUNCT V-STRANGLE
	PRINTI "Why on earth do that?"
	CRLF
	CALL1 IS-PERSON? >STACK
	ICALL PRINT-ID,STR?83,STACK
	CALL1 IS-ANIMAL? >STACK
	ICALL PRINT-ID,STR?84,STACK
	EQUAL? PRSO,ME /?L1
	PUSH 0
	JUMP ?L2
?L1:	PUSH 1
?L2:	CALL PRINT-ID,STR?85,STACK >STACK
	RSTACK

	.FUNCT V-HINTS-OFF
	PRINTI "[Hints are now disabled for this session.]"
	CRLF
	SET 'HINTS-OFF,1
	RETURN HINTS-OFF

	.FUNCT V-HIT
	ICALL PERFORM,V?KILL,PRSO,PRSI
	RTRUE

	.FUNCT V-STACK
	PRINTR "You're wasting time."

	.FUNCT FLUSH-BAD-SCENARIO,SC?1,F,N
	FIRST? PROTAGONIST >F /?L4
	RTRUE
?L1:	ZERO? F /TRUE
?L4:	NEXT? F >N /?L7
?L7:	GETP F,P?SCENARIO >STACK
	ZERO? STACK /?L8
	GETP F,P?SCENARIO >STACK
	EQUAL? STACK,SC?1 /?L8
	REMOVE F
?L8:	SET 'F,N
	JUMP ?L1

	.FUNCT V-SLOW-TIME
	SET 'READ-CLOCK,30
	SET 'CLOCK-MOVE,0
	PRINTR "Slow time."

	.FUNCT V-FAST-TIME
	SET 'READ-CLOCK,10
	SET 'CLOCK-MOVE,0
	PRINTR "Fast (real) time."

	.FUNCT V-PULL
	PRINTR "It's not clear what you're driving at."

	.FUNCT V-$0024ISL,PRT?
	ASSIGNED? 'PRT? /?L8
	SET 'PRT?,1
?L8:	ICALL2 INIT-STATUS-LINE,3
	ZERO? SL-WATCH /?L1
	ICALL1 SL-CYCLE
	JUMP ?L3
?L1:	ZERO? G-WATCH /?L3
	ICALL1 G-CYCLE
?L3:	ICALL UPDATE-CHRONOGRAPH,0,1
	ICALL1 UPDATE-TIME
	ZERO? PRT? /TRUE
	PRINTR "Done."

	.FUNCT INIT-STATUS-LINE,HEIGHT,DONT-CLEAR
	ASSIGNED? 'DONT-CLEAR /?L4
	SET 'DONT-CLEAR,0
?L4:	ZERO? DONT-CLEAR \?L1
	CLEAR -1
	SPLIT HEIGHT
?L1:	SCREEN S-WINDOW
	BUFOUT 0
	CURSET 1,1
	ICALL1 INVERSE-LINE
	CURSET 2,1
	ICALL1 INVERSE-LINE
	CURSET 3,1
	ICALL1 INVERSE-LINE
	BUFOUT 1
	SCREEN S-TEXT
	RTRUE

	.FUNCT INVERSE-LINE,CENTER-HALF
	SET 'CENTER-HALF,0
	HLIGHT H-INVERSE
	GETB 0,33 >STACK
	ICALL2 PRINT-SPACES,STACK
	HLIGHT H-NORMAL
	RTRUE

	.FUNCT PRINT-SPACES,CNT
?L1:	DLESS? 'CNT,0 /TRUE
	PRINTC 32
	JUMP ?L1

	.FUNCT STATUS-LINE,LEN,LOCATION
	ICALL1 SCREEN-1
	CURSET 1,2
	ICALL1 HERE-TELL
	CALL1 SCREEN-0 >STACK
	RSTACK

	.FUNCT HERE-TELL,PAD?,LEN
	ASSIGNED? 'PAD? /?L17
	SET 'PAD?,1
?L17:	DIROUT D-TABLE-ON,DIROUT-TBL
	ZERO? IN-SWAMP? /?L1
	PRINTI "In the Swamp"
	JUMP ?L5
?L1:	ZERO? ON-BRACE? /?L3
	PRINTI "On the Brace"
	JUMP ?L5
?L3:	ZERO? ON-THE-CAN /?L4
	PRINTI "On the Trash Can"
	JUMP ?L5
?L4:	ICALL2 DPRINT,HERE
?L5:	DIROUT D-TABLE-OFF
	GET DIROUT-TBL,0 >LEN
	GRTR? LEN,24 \?L6
	PRINTI "** Desc too long **"
	RTRUE
?L6:	ZERO? IN-SWAMP? /?L9
	PRINTI "In the Swamp"
	JUMP ?L13
?L9:	ZERO? ON-BRACE? /?L11
	PRINTI "On the Brace"
	JUMP ?L13
?L11:	ZERO? ON-THE-CAN /?L12
	PRINTI "On the Trash Can"
	JUMP ?L13
?L12:	ICALL2 DPRINT,HERE
?L13:	ZERO? PAD? /TRUE
	SUB 24,LEN >STACK
	ICALL2 PRINT-SPACES,STACK
	RTRUE

	.FUNCT NOT-HERE-OBJECT-F,TBL,PRSO?,OBJ,X
	SET 'PRSO?,1
	SET 'X,0
	EQUAL? PRSO,NOT-HERE-OBJECT \?L3
	EQUAL? PRSI,NOT-HERE-OBJECT \?L1
	PRINTR "Those things aren't here!"
?L1:	EQUAL? PRSO,NOT-HERE-OBJECT \?L3
	SET 'TBL,P-PRSO
	JUMP ?L4
?L3:	SET 'TBL,P-PRSI
	SET 'PRSO?,0
?L4:	ZERO? PRSO? /?L22
	CALL1 PRSO-MOBY-VERB? >STACK
	ZERO? STACK /?L5
	SET 'X,1
	JUMP ?L7
?L5:	ZERO? PRSO? \?L7
?L22:	CALL1 PRSI-MOBY-VERB? >STACK
	ZERO? STACK /?L7
	SET 'X,1
?L7:	ZERO? X /?L9
	CALL FIND-NOT-HERE,TBL,PRSO? >OBJ
	EQUAL? OBJ,0,NOT-HERE-OBJECT /FALSE
	RTRUE
?L9:	EQUAL? WINNER,PROTAGONIST \?L14
	PRINTI "You can't see"
	CALL2 NAME?,P-XNAM >STACK
	ZERO? STACK \?L15
	PRINTI " any"
?L15:	ICALL2 NOT-HERE-PRINT,PRSO?
	PRINTI " here!"
	CRLF
	JUMP ?L18
?L14:	PRINTI "Looking confused, the "
	PRINT WINNER
	PRINTI " says, ""I don't see"
	CALL2 NAME?,P-XNAM >STACK
	ZERO? STACK \?L19
	PRINTI " any"
?L19:	ICALL2 NOT-HERE-PRINT,PRSO?
	PRINTI " here!"""
	CRLF
?L18:	CALL1 STOP >STACK
	RSTACK

	.FUNCT PRSO-MOBY-VERB?
	EQUAL? PRSA,V?FIND,V?FOLLOW,V?WHAT /TRUE
	EQUAL? PRSA,V?WHERE,V?WHO,V?WAIT-FOR /TRUE
	EQUAL? PRSA,V?WALK-TO /TRUE
	EQUAL? PRSA,V?CALL,V?SAY,V?YELL \FALSE
	RTRUE

	.FUNCT PRSI-MOBY-VERB?
	EQUAL? PRSA,V?ASK-ABOUT,V?ASK-FOR,V?TELL-ABOUT \FALSE
	RTRUE

	.FUNCT FIND-NOT-HERE,TBL,PRSO?,M-F,OBJ
	CALL2 MOBY-FIND,TBL >M-F
	EQUAL? 1,M-F \?L1
	ZERO? PRSO? /?L3
	SET 'PRSO,P-MOBY-FOUND
	ICALL2 THIS-IS-IT,PRSO
	RFALSE
?L3:	SET 'PRSI,P-MOBY-FOUND
	RFALSE
?L1:	LESS? 1,M-F \?L6
	GET TBL,1 >OBJ
	GETP OBJ,P?GENERIC >STACK
	CALL1 STACK >OBJ
	ZERO? OBJ /?L6
	EQUAL? OBJ,NOT-HERE-OBJECT /TRUE
	ZERO? PRSO? /?L9
	SET 'PRSO,OBJ
	ICALL2 THIS-IS-IT,PRSO
	RFALSE
?L9:	SET 'PRSI,OBJ
	RFALSE
?L6:	RETURN NOT-HERE-OBJECT

	.FUNCT NOT-HERE-PRINT,PRSO?
	ZERO? P-OFLAG /?L1
	ZERO? P-XADJ /?L3
	PRINTI " "
	PRINTB P-XADJN
?L3:	ZERO? P-XNAM /FALSE
	PRINTI " "
	PRINTB P-XNAM
	RTRUE
?L1:	ZERO? PRSO? /?L9
	GET P-ITBL,P-NC1L >STACK
	GET P-ITBL,P-NC1 >STACK
	CALL BUFFER-PRINT,STACK,STACK,0 >STACK
	RSTACK
?L9:	GET P-ITBL,P-NC2L >STACK
	GET P-ITBL,P-NC2 >STACK
	CALL BUFFER-PRINT,STACK,STACK,0 >STACK
	RSTACK

	.FUNCT GROUND-F
	EQUAL? PRSA,V?CLIMB,V?CLIMB-ON,V?CLIMB-UP /?L3
	EQUAL? PRSA,V?BOARD \?L1
?L3:	CALL1 WASTES >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?LOOK-UNDER \?L4
	CALL1 IMPOSSIBLES >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?LEAVE \?L5
	CALL2 DO-WALK,P?UP >STACK
	RSTACK
?L5:	EQUAL? PRSA,V?CLEAN \?L6
	IN? COMP-BLOOD-STAIN,HERE \?L7
	ICALL PERFORM,V?CLEAN,COMP-BLOOD-STAIN
	RTRUE
?L7:	PRINTR "You're not aware that it needs cleaning."
?L6:	EQUAL? PRSA,V?EXAMINE \?L14
	EQUAL? HERE,COMP-5 \?L10
	IN? COMP-BLOOD-STAIN,HERE \?L10
	PRINTI "When you look at the floor in front of you, your eye is immediately drawn to "
	FSET? COMP-BLOOD-STAIN,CROSSBIT \?L11
	PRINTI "a smeared blood stain"
	JUMP ?L13
?L11:	PRINTI "some drops of blood bunched together"
?L13:	PRINTR " near the door."
?L10:	EQUAL? PRSA,V?EXAMINE \?L14
	ICALL2 PERFORM,V?LOOK
	RTRUE
?L14:	EQUAL? PRSA,V?DIG \FALSE
	EQUAL? SCENARIO,2 \FALSE
	PRINTR "Except for digging up some snow, you wont get anywhere; the frozen ground is much too hard."

	.FUNCT CEILING-F
	FSET? HERE,OUTHUTBIT \?L1
	EQUAL? PRSA,V?CLIMB-UP,V?CLIMB \?L1
	PRINTR "You'd never make it with that bad arm of yours."
?L1:	EQUAL? PRSA,V?LOOK-UNDER \FALSE
	ICALL2 PERFORM,V?LOOK
	RTRUE

	.FUNCT HANDS-F,ACTOR
	EQUAL? PRSA,V?WAVE \?L1
	SET 'PRSO,0
	ICALL2 PERFORM,V?WAVE-AT
	RTRUE
?L1:	EQUAL? PRSA,V?SHAKE \?L3
	CALL FIND-IN,HERE,PERSON,STR?86 >ACTOR
	ZERO? ACTOR /?L4
	ICALL PERFORM,V?SHAKE-WITH,HANDS,ACTOR
	RTRUE
?L4:	PRINTR "Pleased to meet you."
?L3:	EQUAL? PRSA,V?CLEAN \FALSE
	PRINTR "They're as clean as they'll get."

	.FUNCT ME-F
	EQUAL? PRSA,V?SAVE-SOMETHING \?L1
	PRINTR "Perhaps you need a HINT?"
?L1:	EQUAL? PRSA,V?LOOK-BEHIND \?L3
	PRINTR "In this country, looking over one's shoulder is a way of life; at the moment, you don't see anything you haven't seen before."
?L3:	EQUAL? PRSA,V?TELL \?L4
	PRINTI "Talking to yourself is a sign of impending mental collapse."
	CRLF
	CALL1 STOP >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?LISTEN \?L5
	PRINTR "Yes?"
?L5:	EQUAL? PRSA,V?GIVE \?L6
	EQUAL? PRSI,ME \?L6
	ICALL PERFORM,V?TAKE,PRSO
	RTRUE
?L6:	EQUAL? PRSA,V?MOVE \?L7
	CALL1 V-WALK-AROUND >STACK
	RSTACK
?L7:	EQUAL? PRSA,V?SEARCH \?L8
	ICALL1 V-INVENTORY
	RTRUE
?L8:	EQUAL? PRSA,V?MUNG,V?HIT,V?KILL /?L10
	EQUAL? PRSA,V?OFF \?L9
?L10:	PRINTI "Self-flagellation is not the answer."
	CRLF
	CALL1 KILL-VERB? >STACK
	ICALL PRINT-ID,STR?87,STACK
	CALL1 HARM-VERB? >STACK
	CALL PRINT-ID,STR?88,STACK >STACK
	RSTACK
?L9:	EQUAL? PRSA,V?FIND \?L11
	PRINTR "You're right here!"
?L11:	EQUAL? PRSA,V?FOLLOW \FALSE
	PRINTR "When you talk this way, you're very hard to follow."

	.FUNCT GLOBAL-ROOM-F
	EQUAL? PRSA,V?EXAMINE,V?LOOK-INSIDE,V?LOOK \?L1
	ICALL2 PERFORM,V?LOOK
	RTRUE
?L1:	EQUAL? PRSA,V?WALK-TO,V?ENTER \?L3
	ICALL PERFORM,V?WALK-AROUND,PRSO
	RTRUE
?L3:	EQUAL? PRSA,V?EXIT,V?LEAVE \?L4
	ICALL2 DO-WALK,P?OUT
	RTRUE
?L4:	EQUAL? PRSA,V?WALK-AROUND \FALSE
	PRINTR "Walking around here reveals nothing new. To move elsewhere, just type the desired direction."

	.FUNCT SKY-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	EQUAL? SCENARIO,3 \?L3
	PRINTR "It's a beautiful, sunny day in Ostnitz."
?L3:	EQUAL? SCENARIO,1 \?L5
	PRINTR "It's dark outside and cloudy, if memory serves."
?L5:	EQUAL? HERE,INSIDE-SHED,HUT-LIVING /?L7
	EQUAL? HERE,HUT-BEDROOM,HUT-STORAGE \?L6
?L7:	PRINTR "It's hard to tell from here, but it can be assumed that it is still dark and cloudy out."
?L6:	PRINTI "It is dark and cloudy, though the clouds are thin enough to see the pale image of a full moon lighting up the sky."
	EQUAL? HERE,OUTSIDE-HUT,NORTH-HUT /?L11
	EQUAL? HERE,SOUTH-HUT,D5,BEHIND-HUT \?L9
?L11:	CRLF
	RTRUE
?L9:	PRINTI " Off to the "
	ICALL TELL-DIRECTION,HERE,D5
	ZERO? HUT-BURNING /?L13
	PRINTR ", you can see a dull orange glow with plumes of black smoke billowing upwards."
?L13:	PRINTR ", you can see some wisps of black smoke rising up into the heavens."

	.FUNCT TOUCHING?,THING
	EQUAL? PRSA,V?TAKE,V?TOUCH,V?SHAKE /?L3
	EQUAL? PRSA,V?SPIN,V?PUT-ON,V?PUSH /?L3
	EQUAL? PRSA,V?CLOSE,V?MOVE,V?OPEN /?L3
	EQUAL? PRSA,V?RAISE,V?CLIMB-OVER,V?CLIMB-UP /?L3
	EQUAL? PRSA,V?BEND,V?CLIMB,V?CLIMB-DOWN /?L3
	EQUAL? PRSA,V?CLIMB-ON,V?BOARD,V?ENTER /?L3
	EQUAL? PRSA,V?CRAWL-UNDER /?L3
	CALL2 HURT?,THING >STACK
	ZERO? STACK /?L1
?L3:	EQUAL? PRSO,THING /TRUE
?L1:	EQUAL? PRSI,THING \FALSE
	EQUAL? PRSA,V?PUT-ON,V?PUT \FALSE
	RTRUE

	.FUNCT HURT?,THING
	EQUAL? PRSA,V?MUNG,V?KICK,V?KILL /?L3
	EQUAL? PRSA,V?KNOCK,V?CUT /?L3
	EQUAL? PRSA,V?BITE,V?PUSH \?L1
?L3:	EQUAL? PRSO,THING /TRUE
?L1:	EQUAL? PRSA,V?THROW \FALSE
	EQUAL? PRSI,THING \FALSE
	RTRUE

	.FUNCT PRSO-PRINT,PTR
	ZERO? P-MERGED \?L3
	GET P-ITBL,P-NC1 >PTR
	GET PTR,0 >STACK
	EQUAL? STACK,W?IT \?L1
?L3:	PRINTI " "
	ICALL2 DPRINT,PRSO
	RTRUE
?L1:	GET P-ITBL,P-NC1L >STACK
	CALL BUFFER-PRINT,PTR,STACK,0 >STACK
	RSTACK

	.FUNCT PRSI-PRINT,PTR
	ZERO? P-MERGED \?L3
	GET P-ITBL,P-NC2 >PTR
	GET PTR,0 >STACK
	EQUAL? STACK,W?IT \?L1
?L3:	PRINTI " "
	ICALL2 DPRINT,PRSI
	RTRUE
?L1:	GET P-ITBL,P-NC2L >STACK
	CALL BUFFER-PRINT,PTR,STACK,0 >STACK
	RSTACK

	.FUNCT CANT-SEE,OBJ,STRING
	ASSIGNED? 'OBJ /?L9
	SET 'OBJ,0
?L9:	ASSIGNED? 'STRING /?L10
	SET 'STRING,0
?L10:	SET 'P-WON,0
	PRINTI "You can't see"
	ZERO? OBJ /?L3
	ZERO? OBJ /?L11
	CALL2 NAME?,OBJ >STACK
	ZERO? STACK \?L1
?L3:	PRINTI " any"
?L1:	ZERO? OBJ \?L5
?L11:	PRINTI " "
	PRINT STRING
	JUMP ?L8
?L5:	EQUAL? OBJ,PRSI \?L7
	ICALL1 PRSI-PRINT
	JUMP ?L8
?L7:	ICALL1 PRSO-PRINT
?L8:	PRINTR " here."

	.FUNCT CANT-VERB-A-PRSO,STRING
	PRINTI "You can't "
	PRINT STRING
	ICALL2 ARPRINT,PRSO
	RTRUE

	.FUNCT TELL-HIT-HEAD
	PRINTI "You hit your head against the "
	ICALL2 DPRINT,PRSO
	PRINTR " as you attempt this."

	.FUNCT REFERRING,FOO
	ASSIGNED? 'FOO /?L1
	SET 'FOO,0
?L1:	PRINTR "[I don't see what you're referring to.]"

	.FUNCT V-HINT,CURQ,CURL,CHR,MAXQ,MAXL,Q
?L0:	SET 'Q,0
	ZERO? HINTS-OFF /?L1
	PRINTR "[Hints have been disallowed for this session.]"
?L1:	ZERO? HINT-WARNING \?L3
	SET 'HINT-WARNING,1
	PRINTR "[Warning: It is recognized that the temptation for help may at times be so exceedingly strong that you might fetch hints prematurely. Therefore, you may at any time during the story type HINTS OFF, and this will disallow the seeking out of help for the present session of the story. If you still want a hint now, indicate HINT.]"
?L3:	EQUAL? SCENARIO,2 \?L5
	SET 'HINT-TBL,HINT-TBL-2
	JUMP ?L8
?L5:	EQUAL? SCENARIO,1 \?L7
	SET 'HINT-TBL,HINT-TBL-1
	JUMP ?L8
?L7:	SET 'HINT-TBL,HINT-TBL-3
?L8:	GET HINT-TBL,0 >MAXQ
	ICALL1 INIT-HINT-SCREEN
	CURSET 4,1
	CALL2 PUT-UP-QUESTIONS,1 >MAXL
	SET 'CURQ,1
	SET 'CURL,5
	GRTR? LAST-HINT,0 \?L9
	SET 'CURL,LAST-HINT
?L9:	GRTR? LAST-Q,0 \?L12
	SET 'CURQ,LAST-Q
?L12:	CURSET CURL,2
	PRINTI "->"
?L15:	INPUT 1 >CHR
	EQUAL? CHR,81,113 \?L17
	SET 'LAST-HINT,CURL
	SET 'LAST-Q,CURQ
	SET 'Q,1
	JUMP ?L16
?L17:	EQUAL? CHR,78,110 \?L19
	EQUAL? CURQ,MAXQ /?L15
	CURSET CURL,2
	PRINTI "  "
	INC 'CURL
	INC 'CURQ
	CURSET CURL,2
	PRINTI "->"
	JUMP ?L15
?L19:	EQUAL? CHR,80,112 \?L23
	EQUAL? CURQ,1 /?L15
	CURSET CURL,2
	PRINTI "  "
	DEC 'CURL
	DEC 'CURQ
	CURSET CURL,2
	PRINTI "->"
	JUMP ?L15
?L23:	EQUAL? CHR,13,10 \?L15
	SET 'LAST-HINT,CURL
	SET 'LAST-Q,CURQ
	ICALL2 DISPLAY-HINT,CURQ
?L16:	ZERO? Q /?L0
	SPLIT 0
	CLEAR -1
	BUFOUT 1
	ICALL1 V-$0024ISL
	PRINTR "Back to the game..."

	.FUNCT DISPLAY-HINT,N,H,MX,CNT,CHR,FLG
	SET 'CNT,HINT-HINTS
	SET 'FLG,1
	SPLIT 0
	CLEAR -1
	SPLIT 3
	SCREEN S-WINDOW
	CURSET 1,1
	ICALL1 INVERSE-LINE
	ICALL CENTER-LINE,1,STR?89,16
	CURSET 3,1
	ICALL1 INVERSE-LINE
	ICALL LEFT-LINE,3,STR?90
	ICALL RIGHT-LINE,3,STR?91,12
	HLIGHT H-BOLD
	GET HINT-TBL,N >H
	GET H,HINT-QUESTION >STACK
	ICALL CENTER-LINE,2,STACK
	HLIGHT H-NORMAL
	GET H,0 >MX
	SCREEN S-TEXT
	BUFOUT 1
	CRLF
?L1:	GET H,HINT-SEEN >STACK
	EQUAL? CNT,STACK /?L2
	GET H,CNT >STACK
	PRINT STACK
	CRLF
	CRLF
	INC 'CNT
	JUMP ?L1
?L2:	ZERO? FLG /?L10
	GRTR? CNT,MX \?L8
	SET 'FLG,0
	PRINTI "[That's all folks!]"
	CRLF
	JUMP ?L10
?L8:	ZERO? FLG /?L10
	PRINTI "Hint ("
	SUB MX,CNT >STACK
	ZERO? STACK \?L11
	PRINTI "last"
	JUMP ?L13
?L11:	SUB MX,CNT >STACK
	PRINTN STACK
	PRINTI " left"
?L13:	PRINTI ") -> "
	SET 'FLG,0
?L10:	INPUT 1 >CHR
	EQUAL? CHR,81,113 \?L15
	PUT H,HINT-SEEN,CNT
	JUMP ?L7
?L15:	EQUAL? CHR,13,10 \?L2
	GRTR? CNT,MX /?L2
	SET 'FLG,1
	GET H,CNT >STACK
	PRINT STACK
	CRLF
	CRLF
	IGRTR? 'CNT,MX \?L2
	SET 'FLG,0
	PRINTI "[That's all folks!]"
	CRLF
	JUMP ?L2
?L7:	BUFOUT 0
	RTRUE

	.FUNCT PUT-UP-QUESTIONS,ST,MXQ,MXL,LN
	GET HINT-TBL,0 >MXQ
	GETB 0,32 >MXL
	SET 'LN,6
?L1:	INC 'LN
	GRTR? ST,MXQ \?L3
	SUB LN,2 >STACK
	CURSET STACK,1
	PRINTI "[Last question]"
	RETURN MXQ
?L3:	SUB LN,2 >STACK
	CURSET STACK,1
	PRINTI "    "
	GET HINT-TBL,ST >STACK
	GET STACK,HINT-QUESTION >STACK
	PRINT STACK
	INC 'ST
	JUMP ?L1

	.FUNCT INIT-HINT-SCREEN,WID,LEN
	GETB 0,33 >WID
	SPLIT 0
	CLEAR -1
	GETB 0,32 >STACK
	DEC 'STACK
	SPLIT STACK
	SCREEN S-WINDOW
	BUFOUT 0
	CURSET 1,1
	ICALL1 INVERSE-LINE
	CURSET 2,1
	ICALL1 INVERSE-LINE
	CURSET 3,1
	ICALL1 INVERSE-LINE
	ICALL CENTER-LINE,1,STR?89,16
	ICALL LEFT-LINE,2,STR?92
	ICALL RIGHT-LINE,2,STR?93,19
	ICALL LEFT-LINE,3,STR?94
	CALL RIGHT-LINE,3,STR?95,19 >STACK
	RSTACK

	.FUNCT CENTER-LINE,LN,STR,LEN,INV
	ASSIGNED? 'LEN /?L10
	SET 'LEN,0
?L10:	ASSIGNED? 'INV /?L11
	SET 'INV,1
?L11:	ZERO? LEN \?L1
	DIROUT D-TABLE-ON,DIROUT-TBL
	PRINT STR
	DIROUT D-TABLE-OFF
	GET DIROUT-TBL,0 >LEN
?L1:	GETB 0,33 >STACK
	SUB STACK,LEN >STACK
	DIV STACK,2 >STACK
	CURSET LN,STACK
	ZERO? INV /?L4
	HLIGHT H-INVERSE
?L4:	PRINT STR
	ZERO? INV /FALSE
	HLIGHT H-NORMAL
	RTRUE

	.FUNCT LEFT-LINE,LN,STR,INV
	ASSIGNED? 'INV /?L7
	SET 'INV,1
?L7:	CURSET LN,1
	ZERO? INV /?L1
	HLIGHT H-INVERSE
?L1:	PRINT STR
	ZERO? INV /FALSE
	HLIGHT H-NORMAL
	RTRUE

	.FUNCT RIGHT-LINE,LN,STR,LEN,INV
	ASSIGNED? 'LEN /?L10
	SET 'LEN,0
?L10:	ASSIGNED? 'INV /?L11
	SET 'INV,1
?L11:	ZERO? LEN \?L1
	DIROUT 3,DIROUT-TBL
	PRINT STR
	DIROUT -3
	GET DIROUT-TBL,0 >LEN
?L1:	GETB 0,33 >STACK
	SUB STACK,LEN >STACK
	CURSET LN,STACK
	ZERO? INV /?L4
	HLIGHT H-INVERSE
?L4:	PRINT STR
	ZERO? INV /FALSE
	HLIGHT H-NORMAL
	RTRUE

	.FUNCT I-120-SECONDS
	IN? RIPPED-CLOTHES,WOUNDED-LEFT-ARM /FALSE
	DLESS? 'HEALTH,1 \?L3
	ICALL2 PRINT-ID,STR?96
	CALL2 JIGS-UP,STR?97 >STACK
	RSTACK
?L3:	HLIGHT H-BOLD
	CRLF
	DIV HEALTH,2 >STACK
	GET HEALTH-TBL,STACK >STACK
	PRINT STACK
	HLIGHT H-NORMAL
	CRLF
	RTRUE

	.FUNCT I-30-SECONDS,TMP,HF,OC,?TMP
	LOC CAR >OC
	INC '30-TIMER
	MOD 30-TIMER,4 >STACK
	ZERO? STACK \?L1
	ICALL1 I-120-SECONDS
?L1:	DLESS? 'WOOD-TIMER,0 \?L4
	CALL1 RUN-WOOD-SEQUENCE >STACK
	RSTACK
?L4:	ZERO? CAR-SEQUENCE /?L6
	CALL1 RUN-CAR-SEQUENCE >STACK
	RSTACK
?L6:	ZERO? CAR-ON-ROAD? /FALSE
	GET RESTED-ROAD-TBL,0 >TMP
	ZERO? TMP \?L8
	REMOVE CAR
	JUMP ?L10
?L8:	MOVE CAR,TMP
?L10:	ADD RESTED-ROAD-TBL,2 >RESTED-ROAD-TBL
	ZERO? TMP \?L11
	EQUAL? HERE,B8,C8,D8 \?L13
	ICALL2 BOLDTELL,STR?98
?L13:	SET 'CAR-ON-ROAD?,0
	RETURN CAR-ON-ROAD?
?L11:	EQUAL? HERE,TMP \?L16
	HLIGHT H-BOLD
	CRLF
	ICALL1 CAR-NEARLY-HITS
	RTRUE
?L16:	EQUAL? TMP,ROAD-END \?L17
	ZERO? SEQUENCE-RUN? \?L17
	SET 'SEQUENCE-RUN?,1
	SET 'CAR-SEQUENCE,1
	CALL1 RUN-CAR-SEQUENCE >STACK
	RSTACK
?L17:	EQUAL? OC,ROOMS /TRUE
	EQUAL? TMP,D6 \?L19
	ZERO? SEQUENCE-RUN? /?L19
	EQUAL? HERE,NORTH-HUT,C5 \?L19
	CALL2 BOLDTELL,STR?99 >STACK
	RSTACK
?L19:	CALL HOW-FAR,OC,HERE,1 >?TMP
	CALL HOW-FAR,TMP,HERE,1 >STACK
	CALL GONE-TO-THE-DOGS?,?TMP,STACK,CAR >STACK
	RSTACK

	.FUNCT GONE-TO-THE-DOGS?,DL,NDL,BOGEY,BMOVE,N,S,E,W,T1,T2,F
	ASSIGNED? 'BOGEY /?L86
	SET 'BOGEY,DOGS
?L86:	ASSIGNED? 'BMOVE /?L87
	SET 'BMOVE,1
?L87:	SET 'N,0
	SET 'S,0
	SET 'E,0
	SET 'W,0
	SET 'F,0
	ZERO? BMOVE /?L1
	HLIGHT H-BOLD
?L1:	GETP HERE,P?NS >T1
	LOC BOGEY >STACK
	GETP STACK,P?NS >T2
	GRTR? T1,T2 \?L4
	SET 'N,1
	JUMP ?L6
?L4:	LESS? T1,T2 \?L6
	SET 'S,1
?L6:	GETP HERE,P?EW >T1
	LOC BOGEY >STACK
	GETP STACK,P?EW >T2
	GRTR? T1,T2 \?L8
	SET 'W,1
	JUMP ?L10
?L8:	LESS? T1,T2 \?L10
	SET 'E,1
?L10:	GRTR? DL,3 \?L12
	LESS? NDL,4 \?L14
	CRLF
	PRINTI "You can hear "
	ICALL2 PRINTA,BOGEY
	PRINTI " off to the "
	FSET BOGEY,PENBIT
	SET 'F,1
	JUMP ?L62
?L14:	ZERO? BMOVE /TRUE
	HLIGHT H-NORMAL
	RTRUE
?L12:	LESS? NDL,DL /?L21
	ZERO? NDL \?L20
?L21:	EQUAL? NDL,2 \?L22
	CRLF
	EQUAL? BOGEY,DOGS \?L24
	PRINTI "The sound of barking dogs echoes into the night. They"
	FSET? BOGEY,PENBIT \?L26
	ZERO? BMOVE \?L28
	PRINTI " are"
	JUMP ?L30
?L28:	PRINTI "'ve moved"
?L30:	PRINTI " closer now, perhaps not"
	JUMP ?L37
?L26:	FSET BOGEY,PENBIT
	PRINTI " can't be"
	JUMP ?L37
?L24:	FSET? HERE,ROADBIT \?L32
	FSET? BOGEY,PENBIT \?L33
	PRINTI "The"
	JUMP ?L35
?L33:	FSET BOGEY,PENBIT
	PRINTI "An"
?L35:	PRINTI " automobile comes into view, moving slowly; it's no"
	JUMP ?L37
?L32:	FSET? BOGEY,PENBIT /?L36
	FSET BOGEY,PENBIT
	PRINTI "You can hear an automobile engine close by; it can't be"
	JUMP ?L37
?L36:	PRINTI "The automobile's engine sounds closer now; it can't be"
?L37:	PRINTI " more than a few hundred yards to the "
	SET 'F,1
	JUMP ?L62
?L22:	EQUAL? NDL,1 \?L38
	EQUAL? BOGEY,DOGS \?L39
	CRLF
	PRINTI "The sound of the dogs is much louder now, and you can hear the shouting voices of the guards they accompany. They can't be more than a hundred yards to the "
	SET 'F,1
	JUMP ?L62
?L39:	FSET? HERE,ROADBIT \?L41
	GET RESTED-ROAD-TBL,0 >STACK
	EQUAL? HERE,STACK \?L42
	CRLF
	PRINTI "The automobile is bearing down on you now, though it doesn't seem as if the driver has taken notice. He's no more than a hundred yards away."
	JUMP ?L62
?L42:	CRLF
	PRINTI "The automobile is only a hundred yards from you, but it is moving away. It will soon be out of sight."
	JUMP ?L62
?L41:	CRLF
	PRINTI "The automobile is much closer now, perhaps no more than one hundred yards to the "
	SET 'F,1
	JUMP ?L62
?L38:	CRLF
	PRINTI "The sound of the dogs seems to come from all around you. They can't be more than fifty yards away."
	JUMP ?L62
?L20:	EQUAL? NDL,DL \?L47
	EQUAL? BOGEY,DOGS \?L48
	ZERO? BMOVE /?L52
	LOC DOGS >T1
	GETP T1,P?EW >STACK
	EQUAL? STACK,4 \?L50
	GETP T1,P?NS >STACK
	EQUAL? STACK,5 \?L50
	CRLF
	PRINTI "The dogs sound just a little bit closer and they still"
	JUMP ?L53
?L50:	ZERO? BMOVE /?L52
	CRLF
	PRINTI "The dogs are no closer, but now they"
	JUMP ?L53
?L52:	PRINTI "You've moved such that the dogs now"
?L53:	PRINTI " seem to be off to the "
	JUMP ?L54
?L48:	CRLF
	PRINTI "From the sound of it, the car is now off to the "
?L54:	SET 'F,1
	JUMP ?L62
?L47:	GRTR? NDL,3 \?L55
	ZERO? BMOVE /?L56
	CRLF
?L56:	EQUAL? BOGEY,DOGS \?L59
	PRINTI "To your relief, the sound of the dogs has faded into the distance."
	JUMP ?L62
?L59:	PRINTI "The sounds of the automobile fade into the night air."
	JUMP ?L62
?L55:	EQUAL? BOGEY,DOGS \?L63
	ZERO? BMOVE /?L65
	CRLF
	PRINTI "The sounds of the dogs seem"
	JUMP ?L67
?L65:	PRINTI "You've moved such that the barking seems"
?L67:	PRINTI " farther away and to the "
	JUMP ?L68
?L63:	CRLF
	PRINTI "The automobile sounds farther away and to the "
?L68:	SET 'F,1
?L62:	ZERO? F /?L79
	ZERO? N /?L71
	PRINTI "north"
	JUMP ?L73
?L71:	ZERO? S /?L73
	PRINTI "south"
?L73:	ZERO? E /?L75
	PRINTI "east"
	JUMP ?L77
?L75:	ZERO? W /?L77
	PRINTI "west"
?L77:	PRINTI "."
	EQUAL? BOGEY,DOGS \?L79
	ZERO? LOST-SCENT /?L79
	PRINTI " The dogs' barking is more shrill now than when you first heard it."
?L79:	ZERO? BMOVE /?L83
	HLIGHT H-NORMAL
	CRLF
	RTRUE
?L83:	CRLF
	CRLF
	RTRUE

	.FUNCT GLOBAL-TOURNIQUET-F
	EQUAL? PRSA,V?MAKE \?L6
	ZERO? PRSI /?L1
	ZERO? CLOTHES-RIPPED \?L1
	EQUAL? PRSI,CLOTHES \?L3
	ICALL PERFORM,V?RIP,CLOTHES
	RTRUE
?L3:	PRINTR "You won't have any luck making a tourniquet out of that."
?L1:	EQUAL? PRSA,V?MAKE \?L6
	PRINTR "That's easy enough to say; the question is really how you can make one."
?L6:	EQUAL? PRSA,V?FIND \FALSE
	PRINTR "It's unlikely that you'll just run into one. You'd do better to make one."

	.FUNCT RIPPED-CLOTHES-F
	EQUAL? PRSA,V?TIE \?L1
	PRINTR "Tying it to that won't do you any good."
?L1:	EQUAL? PRSA,V?MAKE \?L3
	PRINTR "You've already made a tourniquet, of sorts. Now you've just got to use it to stop the bleeding."
?L3:	IN? RIPPED-CLOTHES,WOUNDED-LEFT-ARM \?L4
	EQUAL? PRSA,V?UNTIE,V?TAKE-OFF,V?TAKE \?L4
	PRINTR "That would only cause you to start bleeding again."
?L4:	IN? RIPPED-CLOTHES,RIGHT-ARM \FALSE
	EQUAL? PRSA,V?UNTIE,V?TAKE-OFF \FALSE
	ICALL PERFORM,V?TAKE,PRSO
	RTRUE

	.FUNCT BODY-PARTS-F
	EQUAL? PRSA,V?PUT-ON \?L1
	EQUAL? PRSI,BODY-PARTS \?L1
	PRINTR "You couldn't hide anything there."
?L1:	PRINTR "There's no reason to refer to that part of your body."

	.FUNCT ARM-F
	EQUAL? PRSA,V?PUT-ON,V?PUT,V?TIE \?L6
	EQUAL? PRSO,CLOTHES \?L1
	IN? RIPPED-CLOTHES,WINNER \?L3
	ICALL PERFORM,PRSA,RIPPED-CLOTHES,PRSI
	RTRUE
?L3:	PRINTI "With "
	ICALL1 THE-PRINT-PRSO
	PRINTR " intact, it's hard to see how you can tie it around your arm."
?L1:	EQUAL? PRSA,V?PUT-ON,V?PUT,V?TIE \?L6
	EQUAL? PRSO,RIPPED-CLOTHES \?L6
	IN? PRSO,PRSI /?L6
	MOVE PRSO,PRSI
	PRINTI "You make a tourniquet of the torn piece of clothing and put it over "
	EQUAL? PRSI,WOUNDED-LEFT-ARM \?L7
	PRINTI "your bleeding left arm."
	JUMP ?L9
?L7:	ICALL1 THE-PRINT-PRSI
	PRINTI "."
?L9:	EQUAL? PRSI,WOUNDED-LEFT-ARM \?L10
	PRINTI " Blood oozes from the wound into the cloth, but the major bleeding appears to be stopped.[RWD_ID: good:320, VAL: 1]"
	ICALL2 PRINT-ID,STR?100
?L10:	CRLF
	RTRUE
?L6:	EQUAL? PRSA,V?PUT-ON,V?TIE \?L13
	PRINTR "What a strange thing to want to do!"
?L13:	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L14
	EQUAL? PRSO,WOUNDED-LEFT-ARM \?L14
	IN? RIPPED-CLOTHES,WOUNDED-LEFT-ARM \?L15
	PRINTR "It hurts like hell, and blood oozes from around the tourniquet, but it's not bleeding badly."
?L15:	PRINTR "It looks pretty bad. The bullet has apparently damaged an artery in your upper arm, and the bleeding is continuous."
?L14:	EQUAL? PRSA,V?OFF-2,V?OFF \?L18
	EQUAL? PRSO,WOUNDED-LEFT-ARM \?L18
	PRINTR "That appears to be your problem."
?L18:	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L19
	PRINTI "There's nothing wrong with it"
	IN? RIPPED-CLOTHES,PRSO \?L20
	PRINTI ", so it's something of a mystery why you've got a tourniquet around it"
?L20:	PRINT PERIOD-CR
	RTRUE
?L19:	EQUAL? PRSA,V?HOLD \?L23
	EQUAL? PRSO,WOUNDED-LEFT-ARM \?L23
	PRINTR "That won't stop the bleeding. You'll have to do better."
?L23:	EQUAL? PRSA,V?TAKE-OFF,V?REMOVE \FALSE
	PRINTI "Wishing won't make it so."
	CRLF
	CALL2 PRINT-ID,STR?101 >STACK
	RSTACK

	.FUNCT CLOTHES-F
	EQUAL? PRSA,V?TAKE-OFF \?L1
	PRINTI "It is hardly appropriate, forgetting even the weather."
	CRLF
	CALL2 PRINT-ID,STR?102 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \?L3
	PRINTR "There's nothing in your clothes that can help you."
?L3:	EQUAL? PRSA,V?EXAMINE \?L4
	PRINTI "Your clothes are ordinary businessman fare"
	ZERO? CLOTHES-RIPPED /?L5
	PRINTI ", with the exception of the large tear you created in making your tourniquet"
?L5:	PRINT PERIOD-CR
	RTRUE
?L4:	EQUAL? PRSA,V?RIP \FALSE
	ZERO? CLOTHES-RIPPED /?L9
	PRINTI "You've done enough damage to your wardrobe already."
	CRLF
	CALL2 PRINT-ID,STR?103 >STACK
	RSTACK
?L9:	PRINTI "You rip a piece of "
	ICALL2 DPRINT,PRSO
	PRINTI " and now hold a scrap of it in your hand."
	CRLF
	MOVE RIPPED-CLOTHES,WINNER
	ICALL2 THIS-IS-IT,RIPPED-CLOTHES
	SET 'CLOTHES-RIPPED,1
	RETURN CLOTHES-RIPPED

	.FUNCT I-200-SECONDS
	LESS? CLOCK-TIME,401 /TRUE
	FSET? HERE,HUTBIT /?L4
	IN? PARKA,PROTAGONIST \?L6
	FSET? PARKA,WORNBIT /?L4
?L6:	DLESS? 'WARMTH,1 \?L7
	CRLF
	ICALL2 JIGS-UP,STR?104
	CALL2 PRINT-ID,STR?105 >STACK
	RSTACK
?L7:	HLIGHT H-BOLD
	CRLF
	DIV WARMTH,2 >STACK
	GET WARMTH-TBL,STACK >STACK
	PRINT STACK
	ZERO? BEEN-AT-HUT? \?L10
	EQUAL? HERE,INSIDE-SHED /?L10
	PRINTI " You look up at the sky and notice the smoke rising into the sky to the "
	ICALL TELL-DIRECTION,HERE,D5
	PRINTI ". Perhaps where there's smoke there will be warmth."
?L10:	HLIGHT H-NORMAL
	CRLF
	RTRUE
?L4:	LESS? WARMTH,9 \FALSE
	ADD WARMTH,2 >WARMTH
	CALL2 BOLDTELL,STR?106 >STACK
	RSTACK

	.FUNCT WATCHING-OBJECT-F
	EQUAL? PRSA,V?ON-2,V?OFF-2 /FALSE
	PRINTR "Huh?"

	.FUNCT TIMING-OBJECT-F,TMP
	EQUAL? PRSA,V?SET \?L1
	PRINTR "You can only do three things to the timer: reset it, turn it on, and turn it off."
?L1:	EQUAL? PRSA,V?ON \?L3
	SET 'CHRONOGRAPH-ON,1
	SET 'CLOCK-MOVE,0
	PRINTI "The "
	ICALL2 DPRINT,PRSO
	PRINTR " is on."
?L3:	EQUAL? PRSA,V?OFF \?L4
	SET 'CHRONOGRAPH-ON,0
	PRINTI "The "
	ICALL2 DPRINT,PRSO
	PRINTR " is off."
?L4:	EQUAL? PRSA,V?DROP \?L5
	PRINTR "Not a good idea; you'll probably need it."
?L5:	EQUAL? PRSA,V?RESET \?L6
	SET 'CHRONOGRAPH-TIME,0
	PRINTI "The "
	ICALL2 DPRINT,PRSO
	PRINTI " is now reset."
	CRLF
	SET 'CLOCK-MOVE,0
	ICALL1 REDISPLAY-CHRONOGRAPH
	RTRUE
?L6:	EQUAL? PRSA,V?READ \?L7
	PRINTR "The time appears on your status line."
?L7:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "The watch is a precision Swiss instrument, incorporating both a digital clock and a one-hour timer."

	.FUNCT REDISPLAY-CHRONOGRAPH,TMP
	SET 'TMP,CHRONOGRAPH-ON
	SET 'CHRONOGRAPH-ON,1
	ICALL UPDATE-CHRONOGRAPH,0,1
	SET 'CHRONOGRAPH-ON,TMP
	RETURN CHRONOGRAPH-ON

	.FUNCT SEARCHLIGHTS-F
	EQUAL? PRSA,V?EXAMINE-THROUGH,V?EXAMINE \?L1
	PRINTI "The three searchlights are rotating clockwise. The first and third are moving at the same slow pace, and the middle one is moving quite a bit faster. At this moment, the "
	ICALL2 SL-TELL,0
	ZERO? SL-WATCH \?L3
	PRINTI " Since the lights are always in motion, it might be best to WATCH them."
?L3:	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?WATCH \?L6
	SET 'CHRONOGRAPH-ON,1
	ZERO? SL-WATCH /?L7
	PRINTR "You already are."
?L7:	ZERO? G-WATCH /?L10
	ICALL PERFORM,V?OFF-2,TIMING-OBJECT,GUARDS
?L10:	SET 'SL-WATCH,1
	SET 'CLOCK-MOVE,4
	ICALL1 SCREEN-1
	CURSET 2,2
	PRINTI "Left:"
	GETB 0,33 >STACK
	DIV STACK,2 >STACK
	SUB STACK,6 >STACK
	CURSET 2,STACK
	PRINTI "Center:"
	GETB 0,33 >STACK
	SUB STACK,11 >STACK
	CURSET 2,STACK
	PRINTI "Right:"
	ICALL1 SL-WATCHER
	ICALL1 SCREEN-0
	CRLF
	ICALL PERFORM,V?EXAMINE,SEARCHLIGHTS
	CRLF
	PRINTR "Now that you're watching the searchlights, you'll take a moment to check on them after everything you do until you stop watching them, or move out of range.[RWD_ID: good:519, VAL: 1]"
?L6:	EQUAL? PRSA,V?OFF-2 \FALSE
	EQUAL? PRSO,TIMING-OBJECT,WATCHING-OBJECT \FALSE
	ZERO? SL-WATCH \?L14
	PRINTR "You weren't watching them."
?L14:	SET 'SL-WATCH,0
	SET 'CLOCK-MOVE,4
	ICALL1 FLUSH-WATCHER
	ZERO? SAVE-FLAG \TRUE
	PRINTR "You're no longer watching the searchlights."

	.FUNCT SL-CYCLE
	SET 'SAVE-FLAG,1
	ICALL PERFORM,V?OFF-2,TIMING-OBJECT,SEARCHLIGHTS
	ICALL PERFORM,V?WATCH,SEARCHLIGHTS
	SET 'SAVE-FLAG,0
	RTRUE

	.FUNCT G-CYCLE
	SET 'SAVE-FLAG,1
	ICALL PERFORM,V?OFF-2,TIMING-OBJECT,GUARDS
	ICALL PERFORM,V?WATCH,GUARDS
	SET 'SAVE-FLAG,0
	RTRUE

	.FUNCT SL-TELL,CR
	ASSIGNED? 'CR /?L4
	SET 'CR,1
?L4:	PRINTI "left light faces "
	CALL2 SL-POS-STR,1 >STACK
	PRINT STACK
	PRINTI ", "
	PRINTI "the middle one "
	CALL2 SL-POS-STR,2 >STACK
	PRINT STACK
	PRINTI ", "
	PRINTI "and the right one "
	CALL2 SL-POS-STR,3 >STACK
	PRINT STACK
	PRINTI "."
	ZERO? CR /TRUE
	CRLF
	RTRUE

	.FUNCT SL-POS-STR,L,?TMP
	SET '?TMP,SL-POS-STR-TBL
	CALL2 SL-POS,L >STACK
	ADD STACK,112 >STACK
	DIV STACK,225 >STACK
	GET ?TMP,STACK >STACK
	RSTACK

	.FUNCT SL-POS-STR-AB,L,?TMP
	SET '?TMP,SL-POS-STR-AB-TBL
	CALL2 SL-POS,L >STACK
	ADD STACK,112 >STACK
	DIV STACK,225 >STACK
	GET ?TMP,STACK >STACK
	RSTACK

	.FUNCT SL-POS,L
	GET SL-TBL,L >STACK
	GET STACK,0 >STACK
	RSTACK

	.FUNCT NOMANS-MOVE,TBL,MVS,MV,OFF,SL,TMP,?TMP
	SET 'MV,1
	SET 'OFF,0
	GETP HERE,P?NOMAN >TBL
	GETP SHOES-WORN,P?SPEED >STACK
	DIV STACK,10 >STACK
	MUL STACK,100 >STACK
	DIV STACK,WARMTH >STACK
	DIV STACK,HEALTH >MVS
	SET 'NOMANS-SPEED,MVS
	MUL MVS,5 >MVS
	CALL2 WEIGHT,WINNER >STACK
	GRTR? STACK,50 \?L1
	PRINTI "With all the weight you are carrying, you'd never make it across without getting caught."
	CRLF
	ICALL2 PRINT-ID,STR?107
	RFALSE
?L1:	GRTR? NOMANS-SPEED,6 \?L3
	PRINTI "You are slowed down so extensively by "
	ICALL1 SLOWDOWN
	PRINTI " that you turn back almost at once. You'll never get across in this condition."
	CRLF
	ICALL2 PRINT-ID,STR?108
	RFALSE
?L3:	GET TBL,OFF >SL
	GET SL,1 >?TMP
	GET SL,0 >TMP
	SUB ?TMP,TMP >STACK
	DIV STACK,MVS >STACK
	PUT SL,2,STACK
	PUT SL,3,TMP
	IGRTR? 'OFF,2 \?L3
?L6:	DLESS? 'MVS,0 /?L11
	SET 'OFF,0
?L15:	GRTR? OFF,2 /?L16
	GET TBL,OFF >SL
	GET SL,2 >STACK
	GET SL,3 >STACK
	ADD STACK,STACK >TMP
	PUT SL,3,TMP
	ADD OFF,1 >STACK
	CALL IN-THE-SPOTLIGHT?,TMP,STACK >STACK
	ZERO? STACK /?L25
	LESS? MVS,5 \?L22
	ICALL1 SL-CAUGHT-START
	PRINTI "You're almost there now, but in the corner of your eye, you see the light from the "
	GET SL-CAUGHT-TOWERS,OFF >STACK
	PRINT STACK
	PRINTI "racing toward you! Too late! The intense white light blinds you and piercing sirens fill the night air!"
	ICALL2 PRINT-ID,STR?109
	ICALL2 JIGS-UP,STR?28
	RTRUE
?L22:	DIV NOMANS-SPEED,2 >STACK
	DIV MVS,5 >STACK
	GRTR? STACK,STACK /?L24
	ICALL1 SL-CAUGHT-START
	PRINTI "You're past the halfway point, but wait! The light from the "
	GET SL-CAUGHT-TOWERS,OFF >STACK
	PRINT STACK
	PRINTI "is heading right at you! You freeze, and consider turning back, but it's too late. The searchlight is upon you now, and before you can react, the night is filled with the sound of wailing sirens."
	ICALL2 PRINT-ID,STR?110
	ICALL2 JIGS-UP,STR?28
	RTRUE
?L24:	ICALL1 SL-CAUGHT-START
	PRINTI "Well before you reach the halfway point, the light from the "
	GET SL-CAUGHT-TOWERS,OFF >STACK
	PRINT STACK
	PRINTI "is bearing down on you. You decide to turn back, and just barely manage to reach the safety of the "
	EQUAL? P-WALK-DIR,P?SOUTH \?L26
	PRINTI "fence"
	JUMP ?L28
?L26:	PRINTI "forest"
?L28:	PRINTI " as the light sweeps over you."
	CRLF
	RFALSE
?L25:	INC 'OFF
	JUMP ?L15
?L16:	ICALL1 TURN-SL
	ICALL UPDATE-CLOCK,1,1
	INC 'MV
	JUMP ?L6
?L11:	FSET HERE,CROSSBIT
	GET TBL,3 >STACK
	RSTACK

	.FUNCT PAUSE,N
?L1:	DLESS? 'N,0 /TRUE
	INPUT 1,10,I-READ-FALSE >STACK
	JUMP ?L1

	.FUNCT I-READ-FALSE
	RTRUE

	.FUNCT SL-CAUGHT-START
	PRINTI "You run across the open field "
	LESS? NOMANS-SPEED,4 \?L1
	PRINTI "at your best speed"
	JUMP ?L6
?L1:	EQUAL? NOMANS-SPEED,4 \?L3
	PRINTI "at a good clip, though you are hampered by "
	ICALL1 SLOWDOWN
	JUMP ?L6
?L3:	EQUAL? NOMANS-SPEED,5 \?L4
	PRINTI "at a rather slow pace, hampered as you are by "
	ICALL1 SLOWDOWN
	JUMP ?L6
?L4:	EQUAL? NOMANS-SPEED,6 \?L5
	PRINTI "slowly, badly hampered by "
	ICALL1 SLOWDOWN
	JUMP ?L6
?L5:	PRINTI "at a dreadful pace, slowed miserably by "
	ICALL1 SLOWDOWN
?L6:	PRINTI ". "
	RTRUE

	.FUNCT SLOWDOWN,DIAGNOSE?,FLG
	ASSIGNED? 'DIAGNOSE? /?L27
	SET 'DIAGNOSE?,0
?L27:	SET 'FLG,0
	ZERO? DIAGNOSE? \?L1
	GETP SHOES-WORN,P?SPEED >STACK
	GRTR? STACK,30 \?L1
	PRINTI "slick-surfaced shoes"
	INC 'FLG
?L1:	LESS? HEALTH,9 \?L9
	GRTR? FLG,0 \?L4
	LESS? WARMTH,9 \?L6
	PRINTI ", "
	JUMP ?L9
?L6:	PRINTI " and "
	JUMP ?L9
?L4:	LESS? HEALTH,9 \?L9
	INC 'FLG
?L9:	LESS? HEALTH,3 \?L11
	PRINTI "severe blood loss"
	JUMP ?L14
?L11:	LESS? HEALTH,5 \?L13
	PRINTI "considerable blood loss"
	JUMP ?L14
?L13:	LESS? HEALTH,9 \?L14
	PRINTI "blood loss"
?L14:	LESS? WARMTH,9 \?L16
	GRTR? FLG,0 \?L16
	GRTR? FLG,1 \?L18
	PRINTI ","
?L18:	PRINTI " and "
?L16:	LESS? WARMTH,3 \?L22
	PRINTI "severe exposure"
	RTRUE
?L22:	LESS? WARMTH,5 \?L24
	PRINTI "considerable cold exposure"
	RTRUE
?L24:	LESS? WARMTH,9 \FALSE
	PRINTI "cold exposure"
	RTRUE

	.FUNCT IN-THE-SPOTLIGHT?,YOU,IT?1,SL
	GET SL-TBL,IT?1 >STACK
	GET STACK,0 >STACK
	DIV STACK,10 >SL
	LESS? SL,271 \FALSE
	SUB SL,SL-BEAM >STACK
	GRTR? YOU,STACK \FALSE
	ADD SL,SL-BEAM >STACK
	LESS? YOU,STACK \FALSE
	RTRUE

	.FUNCT TURN-SL,OFF,TBL,SL
	SET 'OFF,0
?L1:	IGRTR? 'OFF,3 /TRUE
	GET SL-TBL,OFF >TBL
	GET TBL,1 >STACK
	GET TBL,0 >STACK
	ADD STACK,STACK >SL
	EQUAL? SL,3600 \?L6
	SET 'SL,0
?L6:	PUT TBL,0,SL
	JUMP ?L1

	.FUNCT GLOBAL-DOGS-F,B,L,HF
	ASSIGNED? 'B /?L14
	SET 'B,DOGS
?L14:	EQUAL? PRSA,V?WATCH,V?FIND,V?LISTEN /?L3
	EQUAL? PRSA,V?EXAMINE \FALSE
?L3:	LOC B >L
	ZERO? L /?L6
	CALL HOW-FAR,L,HERE >HF
	GRTR? HF,3 \?L4
?L6:	PRINTI "You are relieved to find that you can't hear the "
	ICALL2 DPRINT,B
	PRINTR "."
?L4:	PRINTI "You can hear the "
	ICALL2 DPRINT,B
	ZERO? HF \?L8
	PRINTR "; they are now at close range."
?L8:	EQUAL? HF,1 \?L10
	PRINTI " less than a hundred yards"
	JUMP ?L12
?L10:	EQUAL? HF,2 \?L11
	PRINTI " a few hundred yards"
	JUMP ?L12
?L11:	PRINTI " off in the distance"
?L12:	PRINTI " to the "
	ICALL TELL-DIRECTION,HERE,L
	PRINT PERIOD-CR
	RTRUE

	.FUNCT I-DOGS,DL,HF,NDL
	LOC DOGS >DL
	LESS? CLOCK-TIME,140 /TRUE
	ZERO? NODOGS-FLAG \TRUE
	ZERO? DOG-PURSUIT /?L7
	FSET? HERE,GVIEWBIT \?L7
	CRLF
	HLIGHT H-BOLD
	ICALL2 PRINT-ID,STR?111
	ICALL2 JIGS-UP,STR?112
	SET 'NODOGS-FLAG,1
	RTRUE
?L7:	CALL HOW-FAR,DL,HERE >HF
	GETP DL,P?PATH >NDL
	ZERO? NDL /?L10
	SET 'LOST-SCENT,0
	MOVE DOGS,NDL
	EQUAL? NDL,HERE \?L12
	CRLF
	HLIGHT H-BOLD
	FSET? HERE,HUTBIT /?L16
	EQUAL? HERE,INSIDE-SHED \?L14
?L16:	PRINTI "A pair of guards, presumably with the pursuing dogs, rushes in, finding you within seconds."
	JUMP ?L17
?L14:	PRINTI "The sounds of dogs barking madly and soldiers barking orders are close upon you. A muddled explosion - a signal flare lightens the sky with a red-orange glow. Before you can react, you are spotted! Brilliant white searchlights are aimed upon you, blinding you long enough for more soldiers and border guards to arrive."
?L17:	ICALL2 PRINT-ID,STR?113
	ICALL2 JIGS-UP,STR?114
	RTRUE
?L12:	FSET? NDL,CROSSBIT \?L19
	FSET? HERE,GVIEWBIT \?L19
	HLIGHT H-BOLD
	CRLF
	PRINTI "From across the expanse of no-man's-land comes the sound of the search dogs. They are moving quickly in your direction, following the tracks made in your desperate run to the fence. The approaching dogs have alerted the guards as well, who appear increasingly vigilant. You don't have much time."
	HLIGHT H-NORMAL
	CRLF
	SET 'DOG-PURSUIT,1
?L19:	CALL HOW-FAR,NDL,HERE >STACK
	CALL GONE-TO-THE-DOGS?,HF,STACK >STACK
	RSTACK
?L10:	SET 'LOST-SCENT,1
	RETURN LOST-SCENT

	.FUNCT HOW-FAR,L1,L2,CAR?,TMP,?TMP
	ASSIGNED? 'CAR? /?L9
	SET 'CAR?,0
?L9:	CALL NS-DIFF,L1,L2 >TMP
	MUL TMP,TMP >?TMP
	CALL EW-DIFF,L1,L2 >TMP
	MUL TMP,TMP >STACK
	ADD ?TMP,STACK >TMP
	LESS? TMP,1 /FALSE
	ZERO? CAR? /?L3
	EQUAL? TMP,2 \?L3
	RETURN 2
?L3:	LESS? TMP,3 /TRUE
	LESS? TMP,7 \?L5
	RETURN 2
?L5:	LESS? TMP,13 \?L6
	RETURN 3
?L6:	LESS? TMP,21 \?L7
	RETURN 4
?L7:	RETURN 5

	.FUNCT NS-DIFF,L1,L2
	GETP L2,P?NS >STACK
	GETP L1,P?NS >STACK
	SUB STACK,STACK >STACK
	CALL2 ABS,STACK >STACK
	RSTACK

	.FUNCT EW-DIFF,L1,L2
	GETP L2,P?EW >STACK
	GETP L1,P?EW >STACK
	SUB STACK,STACK >STACK
	CALL2 ABS,STACK >STACK
	RSTACK

	.FUNCT CAR-F
	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L1
	PRINTI "It's an official car, bearing the seal of Frobnia. There is no key in the ignition, so starting it is out of the question."
	IN? EXPLODING-PEN,PRSO \?L3
	PRINTI " The pen is adhering to the side of the car."
?L3:	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?PUT-UNDER,V?PUT-ON,V?PUT /?L7
	EQUAL? PRSA,V?TIE \?L6
?L7:	EQUAL? PRSO,EXPLODING-PEN \?L6
	MOVE PRSO,PRSI
	PRINTI "The pen adheres to the "
	EQUAL? PRSA,V?PUT-UNDER \?L8
	PRINTI "under"
?L8:	PRINTR "side of the car."
?L6:	EQUAL? PRSA,V?HIDE \?L11
	PRINTR "You can't get in, so hiding's inside's out of the question; neither is there anything to be gained from hiding under the car."
?L11:	EQUAL? PRSA,V?ON \?L12
	PRINTR "You can't get in, so starting it is rather difficult."
?L12:	EQUAL? PRSA,V?OPEN,V?CLIMB,V?BOARD /?L14
	EQUAL? PRSA,V?ENTER \FALSE
?L14:	PRINTR "It wouldn't help. There's nothing important inside, and you couldn't possibly start it up without being caught."

	.FUNCT CAR-WINDOW-F
	EQUAL? PRSA,V?KICK,V?MUNG \?L1
	PRINTI "This would only alert the guards, who are just fifty yards away."
	CRLF
	CALL2 PRINT-ID,STR?115 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?OPEN \FALSE
	PRINTR "You can't open the car's windows."

	.FUNCT CAR-STUFF-F
	EQUAL? PRSA,V?BOARD,V?UNLOCK,V?OPEN /?L3
	EQUAL? PRSA,V?ENTER \FALSE
?L3:	PRINTR "It's closed and locked; trying to get in would undoubtably alert the guards, and lead to your arrest."

	.FUNCT GLOBAL-CAR-F,HF
	EQUAL? PRSA,V?FIND,V?LISTEN \?L3
	ZERO? CAR-SEQUENCE /?L1
	PRINTR "You can neither see nor hear the car."
?L1:	EQUAL? PRSA,V?FIND,V?LISTEN \?L3
	ICALL2 GLOBAL-DOGS-F,CAR
	RTRUE
?L3:	EQUAL? PRSA,V?EXAMINE \?L4
	CALL1 CAR-IN-VIEW? >STACK
	ZERO? STACK /?L5
	LOC FLAMING-CAR >STACK
	ZERO? STACK /?L7
	PRINTR "The car is engulfed in flame; nothing else much can be seen."
?L7:	PRINTR "At this distance, at night and in the light snowfall, it is impossible to make out any details."
?L5:	PRINTR "You can't see the car from here."
?L4:	EQUAL? PRSA,V?THROW \?L11
	EQUAL? PRSI,GLOBAL-CAR \?L11
	CALL1 CAR-IN-VIEW? >STACK
	ZERO? STACK /?L11
	IN? PRSO,WINNER \?L11
	FSET? PRSO,WORNBIT /?L11
	REMOVE PRSO
	PRINTI "You throw the "
	ICALL2 DPRINT,PRSO
	PRINTR " at the car, missing it entirely."
?L11:	EQUAL? PRSA,V?WAVE-AT \FALSE
	FSET? HERE,ROADBIT /?L13
	PRINTR "You're not even on a road!"
?L13:	CALL1 CAR-IN-VIEW? >STACK
	ZERO? STACK /?L15
	PRINTR "The driver seems to pay no attention and heads right toward you..."
?L15:	ZERO? CAR-ON-ROAD? /?L16
	EQUAL? HF,2 \?L16
	PRINTR "It's unlikely the driver can see you through the snow at this distance."
?L16:	PRINTR "The car isn't quite in view yet, so the driver won't see you."

	.FUNCT I-CARS,FORCE?
	ASSIGNED? 'FORCE? /?L12
	SET 'FORCE?,0
?L12:	ZERO? CAR-ON-ROAD? \FALSE
	ZERO? SEQUENCE-RUN? \FALSE
	SET 'CAR-ON-ROAD?,1
	SET 'RESTED-ROAD-TBL,ROAD-TBL
	EQUAL? HERE,F3,F4,G4 \?L3
	HLIGHT H-BOLD
	CRLF
	PRINTI "You can see the headlights of an automobile coming from the "
	EQUAL? F3,HERE \?L5
	PRINTI "east"
	JUMP ?L8
?L5:	EQUAL? F4,HERE \?L7
	PRINTI "northeast"
	JUMP ?L8
?L7:	PRINTI "north"
?L8:	HLIGHT H-NORMAL
	CRLF
	RTRUE
?L3:	CALL HOW-FAR,HERE,F4 >STACK
	LESS? STACK,4 \FALSE
	HLIGHT H-BOLD
	CRLF
	PRINTI "Off to the "
	ICALL TELL-DIRECTION,HERE,F4
	PRINTI ", you can hear the sound of an approaching automobile."
	HLIGHT H-NORMAL
	CRLF
	RTRUE

	.FUNCT TELL-DIRECTION,FR,TO,N,S,W,E,T1,T2
	SET 'N,0
	SET 'S,0
	SET 'W,0
	SET 'E,0
	GETP FR,P?NS >T1
	GETP TO,P?NS >T2
	GRTR? T1,T2 \?L1
	SET 'N,1
	JUMP ?L3
?L1:	LESS? T1,T2 \?L3
	SET 'S,1
?L3:	GETP FR,P?EW >T1
	GETP TO,P?EW >T2
	GRTR? T1,T2 \?L5
	SET 'W,1
	JUMP ?L7
?L5:	LESS? T1,T2 \?L7
	SET 'E,1
?L7:	ZERO? N /?L9
	PRINTI "north"
	JUMP ?L11
?L9:	ZERO? S /?L11
	PRINTI "south"
?L11:	ZERO? E /?L13
	PRINTI "east"
	RTRUE
?L13:	ZERO? W /FALSE
	PRINTI "west"
	RTRUE

	.FUNCT RET-DIRECTION,FR,TO,N,S,W,E,T1,T2
	SET 'N,0
	SET 'S,0
	SET 'W,0
	SET 'E,0
	GETP FR,P?NS >T1
	GETP TO,P?NS >T2
	GRTR? T1,T2 \?L1
	SET 'N,1
	JUMP ?L3
?L1:	LESS? T1,T2 \?L3
	SET 'S,1
?L3:	GETP FR,P?EW >T1
	GETP TO,P?EW >T2
	GRTR? T1,T2 \?L5
	SET 'W,1
	JUMP ?L7
?L5:	LESS? T1,T2 \?L7
	SET 'E,1
?L7:	SET 'T1,0
	SET 'T2,0
	ZERO? N \?L13
	ZERO? S /?L11
	ADD T1,4 >T1
	JUMP ?L13
?L11:	ZERO? E /?L12
	SET 'T1,3
	SET 'T2,1
	JUMP ?L13
?L12:	ZERO? W /?L13
	SET 'T1,7
	SET 'T2,1
?L13:	ZERO? T2 \?L18
	ZERO? E /?L17
	ADD T1,2 >T1
	JUMP ?L18
?L17:	ZERO? W /?L18
	INC 'T1
?L18:	GET DIR-PROP-TBL,T1 >STACK
	RSTACK

	.FUNCT CAR-NEARLY-HITS
	CRLF
	ICALL2 PRINT-ID,STR?116
	CALL2 JIGS-UP,STR?117 >STACK
	RSTACK

	.FUNCT RUN-CAR-SEQUENCE
	EQUAL? CAR-SEQUENCE,1 \?L1
	EQUAL? HERE,D5,OUTSIDE-HUT,SOUTH-HUT \?L3
	HLIGHT H-BOLD
	ICALL1 CAR-SPOTTED
	JUMP ?L41
?L3:	EQUAL? HERE,NORTH-HUT,BEHIND-HUT \?L5
	HLIGHT H-BOLD
	CRLF
	PUT CAR-SEQUENCE-TBL,1,1
	ZERO? HUT-BURNING /?L6
	SET 'CAR-SEQUENCE,0
	EQUAL? HERE,NORTH-HUT \?L8
	PRINTI "From your hidden (and quite warm) vantage point, you watch the car stop at the end of the road. A single man gets out, looks over the situation, and returns to the car. After a moment, the car turns around and heads away."
	JUMP ?L10
?L8:	PRINTI "You hear a car approach, then make a quick departure."
?L10:	HLIGHT H-NORMAL
	CRLF
	RTRUE
?L6:	EQUAL? HERE,NORTH-HUT \?L11
	PRINTI "From your hidden vantage point, you can see the car stop at the end of the road. The car's doors open, and two guards step out, machine guns at the ready. A third man exits the car slowly, and all three head for the clearing to their north."
	JUMP ?L12
?L11:	PRINTI "You hear a car stop nearby, followed by the sound of doors opening and closing. Dimly, you believe you can make out some talking - it's clear that the occupants of the car are heading toward the hut."
?L12:	HLIGHT H-NORMAL
	CRLF
	JUMP ?L41
?L5:	CALL HOW-FAR,ROAD-END,HERE >STACK
	LESS? STACK,4 \?L41
	HLIGHT H-BOLD
	CRLF
	PRINTI "The sound of the automobile stops abruptly."
	HLIGHT H-NORMAL
	CRLF
	JUMP ?L41
?L1:	ZERO? HUT-BURNING /?L15
	SET 'CAR-SEQUENCE,0
	REMOVE HUT-MAN
	EQUAL? HERE,NORTH-HUT,SOUTH-HUT \?L16
	HLIGHT H-BOLD
	CRLF
	CRLF
	PRINTI "With the house ablaze, the guards confer for a moment, then retreat to their automobile."
	IN? HUT-MAN,OUTSIDE-HUT \?L18
	PRINTI " The man from the hut follows along as well, looking visibly shaken."
?L18:	PRINTI " A moment later, the car is started and turned around."
	HLIGHT H-NORMAL
	CRLF
	RTRUE
?L16:	CALL HOW-FAR,ROAD-END,HERE >STACK
	LESS? STACK,5 \TRUE
	CRLF
	ICALL2 BOLDTELL,STR?118
	RTRUE
?L15:	EQUAL? CAR-SEQUENCE,3 \?L23
	EQUAL? HERE,NORTH-HUT,SOUTH-HUT,BEHIND-HUT \?L41
	PUT CAR-SEQUENCE-TBL,3,1
	EQUAL? HERE,BEHIND-HUT \?L26
	ICALL2 BOLDTELL,STR?119
	JUMP ?L41
?L26:	GET CAR-SEQUENCE-TBL,1 >STACK
	ZERO? STACK \?L28
	ICALL2 BOLDTELL,STR?120
	JUMP ?L41
?L28:	ICALL2 BOLDTELL,STR?121
	JUMP ?L41
?L23:	EQUAL? CAR-SEQUENCE,4 \?L31
	IN? HUT-MAN,OUTSIDE-HUT /?L31
	MOVE HUT-MAN,OUTSIDE-HUT
	EQUAL? HERE,NORTH-HUT,SOUTH-HUT,BEHIND-HUT \?L41
	PUT CAR-SEQUENCE-TBL,5,1
	EQUAL? HERE,BEHIND-HUT \?L34
	ICALL2 BOLDTELL,STR?122
	JUMP ?L41
?L34:	GET CAR-SEQUENCE-TBL,1 >STACK
	ZERO? STACK \?L37
	GET CAR-SEQUENCE-TBL,3 >STACK
	ZERO? STACK /?L36
?L37:	ICALL2 BOLDTELL,STR?123
	JUMP ?L41
?L36:	ICALL2 BOLDTELL,STR?124
	JUMP ?L41
?L31:	GRTR? CAR-SEQUENCE,5 \?L40
	LESS? CAR-SEQUENCE,11 \?L40
	ICALL2 RUN-SCOUT-SEQUENCE,CAR-SEQUENCE
	JUMP ?L41
?L40:	EQUAL? CAR-SEQUENCE,13 \?L41
	MOVE HUT-MAN,HUT-LIVING
	EQUAL? HERE,NORTH-HUT,SOUTH-HUT \?L42
	HLIGHT H-BOLD
	CRLF
	GET CAR-SEQUENCE-TBL,1 >STACK
	ZERO? STACK \?L46
	GET CAR-SEQUENCE-TBL,3 >STACK
	ZERO? STACK \?L46
	GET CAR-SEQUENCE-TBL,5 >STACK
	ZERO? STACK /?L44
?L46:	PRINTI "The three men from the car"
	JUMP ?L47
?L44:	PRINTI "Three men standing at the door to the hut"
?L47:	PRINTI " appear to thank the fourth man. Briskly, they reenter their car, and start it up."
	HLIGHT H-NORMAL
	CRLF
	JUMP ?L49
?L42:	EQUAL? ROAD-END,HERE \?L48
	HLIGHT H-BOLD
	CRLF
	PRINTI "The guards turn from the house and start in your direction. Thinking quickly, you dart into the nearby forest to the west. You are lucky not to have been seen."
	CRLF
	ICALL GOTO,C5,0
	JUMP ?L49
?L48:	CALL HOW-FAR,ROAD-END,HERE >STACK
	LESS? STACK,5 \?L49
	HLIGHT H-BOLD
	CRLF
	EQUAL? HERE,HUT-LIVING \?L50
	MOVE WINNER,HUT-STORAGE
	SET 'HERE,HUT-STORAGE
	PRINTI "The conversation outside seems to have ended, and you suspect that the man is about to reenter his hut. Quickly, you retreat to the storage area, and a moment later he does, indeed, return. You'll now have to be extra careful to avoid detection."
	CRLF
	CRLF
	JUMP ?L52
?L50:	EQUAL? HERE,HUT-STORAGE,HUT-BEDROOM \?L52
	PRINTI "The occupant of the hut reenters; fortunately, he hasn't seen you yet. You'll have to be extra careful to avoid detection."
	CRLF
	CRLF
?L52:	PRINTI "You can hear the sound of an automobile engine being started, though it's hard to tell from which direction the sound is coming."
	HLIGHT H-NORMAL
	CRLF
	ICALL1 OWNER-NOTICES?
?L49:	SET 'CAR-SEQUENCE,0
	RTRUE
?L41:	INC 'CAR-SEQUENCE
	RETURN CAR-SEQUENCE

	.FUNCT RUN-SCOUT-SEQUENCE,SS,TBL
	SUB SS,6 >STACK
	GET SCOUT-TBL,STACK >TBL
	GET TBL,4 >STACK
	ZERO? STACK \?L1
	REMOVE SCOUT
	JUMP ?L3
?L1:	GET TBL,4 >STACK
	MOVE SCOUT,STACK
?L3:	IN? SCOUT,HERE \?L4
	HLIGHT H-BOLD
	CRLF
	ICALL2 PRINT-ID,STR?125
	CALL1 SCOUT-CATCHES >STACK
	RSTACK
?L4:	IN? SCOUT,BEHIND-HUT \?L6
	FSET? HUT-BACK-DOOR,OPENBIT \?L6
	FSET? HERE,HUTBIT \?L6
	HLIGHT H-BOLD
	CRLF
	ICALL2 PRINT-ID,STR?126
	CALL2 JIGS-UP,STR?127 >STACK
	RSTACK
?L6:	GET TBL,0 >STACK
	EQUAL? HERE,STACK \?L7
	GET TBL,2 >STACK
	CALL2 BOLDTELL,STACK >STACK
	RSTACK
?L7:	GET TBL,1 >STACK
	EQUAL? HERE,STACK \FALSE
	GET TBL,3 >STACK
	CALL2 BOLDTELL,STACK >STACK
	RSTACK

	.FUNCT SCOUT-CATCHES
	CALL2 JIGS-UP,STR?128 >STACK
	RSTACK

	.FUNCT GUARDS-SPOTTED
	CRLF
	ICALL2 PRINT-ID,STR?129
	CALL2 JIGS-UP,STR?130 >STACK
	RSTACK

	.FUNCT CAR-SPOTTED
	CRLF
	ICALL2 PRINT-ID,STR?131
	CALL2 JIGS-UP,STR?132 >STACK
	RSTACK

	.FUNCT WRONG-SCENARIO
	PRINTR "You must be thinking of the wrong scenario."

	.FUNCT SWAMP-F
	EQUAL? SCENARIO,2 /?L1
	CALL1 WRONG-SCENARIO >STACK
	RSTACK
?L1:	FSET? HERE,SWAMPBIT /?L3
	PRINTR "You can't see that here."
?L3:	EQUAL? PRSA,V?SMELL \?L4
	PRINTR "It's not a pretty smell."
?L4:	EQUAL? PRSA,V?BOARD,V?ENTER \?L5
	ZERO? IN-SWAMP? /?L6
	PRINTR "You're flirting with death as it is..."
?L6:	ZERO? SHOES-WORN \?L8
	PRINTR "Not without shoes, you're not."
?L8:	SET 'IN-SWAMP?,1
	EQUAL? SHOES-WORN,BOOTS /?L10
	FSET SHOES-WORN,MUNGEDBIT
	GETP SHOES-WORN,P?SPEED >STACK
	ADD STACK,10 >STACK
	PUTP SHOES-WORN,P?SPEED,STACK
	PRINTI "You're a foot deep in the swamp, but the muck has entered your "
	ICALL2 DPRINT,SHOES-WORN
	PRINTR ", making movement a little slower than you might like."
?L10:	PRINTR "You're now a foot deep in the swamp, but the boots keep your feet nice and dry."
?L5:	EQUAL? PRSA,V?DISEMBARK,V?LEAVE \FALSE
	ZERO? IN-SWAMP? \?L14
	PRINTR "You're not in the swamp, merely at the edge."
?L14:	SET 'IN-SWAMP?,0
	ICALL1 STATUS-LINE
	PRINTR "You take a large step, and pull yourself out of the swamp."

	.FUNCT GUARD-DISTANCE,TICK
	MOD CLOCK-TIME,180 >TICK
	LESS? TICK,90 /?L1
	SUB 180,TICK >TICK
?L1:	SUB 90,TICK >TICK
	GETP HERE,P?GPOS >STACK
	EQUAL? STACK,90 \?L4
	RETURN TICK
?L4:	SUB 90,TICK >STACK
	RSTACK

	.FUNCT IN-GUARD-VIEW?,MT
	MOD CLOCK-TIME,360 >MT
	CALL1 GUARDS-FACING-PLAYER? >STACK
	ZERO? STACK /FALSE
	CALL1 GUARD-DISTANCE >STACK
	LESS? STACK,86 /TRUE
	RFALSE

	.FUNCT RUN-WOOD-SEQUENCE,L,NL
	LOC HUT-MAN >L
	INC 'WOOD-COUNT
	LESS? WOOD-COUNT,0 /TRUE
	EQUAL? WOOD-COUNT,1 \?L3
	IN? HUT-MAN,HUT-LIVING /?L3
	SET 'WOOD-COUNT,0
	RETURN WOOD-COUNT
?L3:	GET WOOD-TBL,WOOD-COUNT >NL
	EQUAL? L,NL /TRUE
	ZERO? NL \?L5
	SET 'WOOD-COUNT,-10000
	RTRUE
?L5:	SET 'HUT-MAN-FROM,L
	MOVE HUT-MAN,NL
	EQUAL? HERE,NL \?L7
	CRLF
	ICALL2 PRINT-ID,STR?133
	CALL2 JIGS-UP,HUT-MAN-HALT >STACK
	RSTACK
?L7:	GETP NL,P?WOODFCN >STACK
	CALL2 STACK,L >STACK
	RSTACK

	.FUNCT HUT-MUNGER,RM,PRP,PT,DST
	FIRST? ROOMS >RM \TRUE
?L4:	SET 'PRP,0
?L7:	NEXTP RM,PRP >PRP
	ZERO? PRP /?L8
	GETPT RM,PRP >PT
	PTSIZE PT >STACK
	EQUAL? STACK,5 \?L7
	GET PT,0 >DST
	EQUAL? DST,NORTH-HUT,SOUTH-HUT,OUTSIDE-HUT /?L16
	EQUAL? DST,BEHIND-HUT,D5 \?L7
?L16:	GETP DST,P?SHOOT >STACK
	PUT PT,SEXITSTR,STACK
	JUMP ?L7
?L8:	NEXT? RM >RM /?L4
	RTRUE

	.FUNCT GLOBAL-SEARCHLIGHTS-F
	FSET? HERE,GVIEWBIT /?L1
	CALL2 CANT-SEE,SEARCHLIGHTS >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L3
	PRINTR "From this position, you can see the beam of the searchlights, but not the lights themselves. Your viewpoint also makes it impossible to correctly gauge their positions."
?L3:	PRINT TOO-FAR
	CRLF
	RTRUE

	.FUNCT OUTF-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You are crouched at the base of the first fence.[RWD_ID: border:39, VAL: 2] Behind you is the hundred yards of no-man's-land you've crossed, searchlights dancing across the snow-covered ground. Before you, not fifteen feet away, is the base of the guard tower, and beyond that, another fence, the last barrier to your freedom. Although you are relatively exposed, the low snowdrifts provide reasonable cover from the guards."
	CRLF
	CRLF
	SET 'P-WALK-DIR,0
	ICALL PERFORM,V?EXAMINE,FENCE
	ZERO? G-WATCH \TRUE
	CRLF
	ICALL PERFORM,V?EXAMINE,GUARDS
	RTRUE

	.FUNCT CAR-GUARDS-F
	IN? CAR,ROAD-END \?L6
	EQUAL? HERE,NORTH-HUT,SOUTH-HUT,ROAD-END \?L1
	EQUAL? PRSA,V?WATCH,V?EXAMINE,V?LISTEN \FALSE
	ICALL1 CAR-SEQ-TELL
	RTRUE
?L1:	IN? CAR,ROAD-END \?L6
	EQUAL? HERE,BEHIND-HUT,HUT-LIVING \?L6
	EQUAL? PRSA,V?WATCH,V?EXAMINE,V?LISTEN \FALSE
	PRINTR "You can't see the guards here, but you can faintly hear them talking."
?L6:	PRINTR "There are no guards here, which is fortunate."

	.FUNCT GLOBAL-SCOUT-F
	LOC SCOUT >STACK
	ZERO? STACK \?L1
	CALL2 CANT-SEE,GLOBAL-SCOUT >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?WATCH,V?EXAMINE \?L3
	ICALL2 SCOUT-TELL,0
	RTRUE
?L3:	PRINT TOO-FAR
	CRLF
	RTRUE

	.FUNCT SCOUT-TELL,LOOK?,SS
	ASSIGNED? 'LOOK? /?L14
	SET 'LOOK?,1
?L14:	SET 'SS,0
	ZERO? SS \?L1
	SET 'SS,STR?134
?L1:	ZERO? LOOK? \?L4
	SET 'SS,STR?135
?L4:	EQUAL? HERE,NORTH-HUT,SOUTH-HUT \?L7
	IN? SCOUT,OUTSIDE-HUT \?L7
	PRINT SS
	PRINTR " scout is in front of the hut, walking slowly toward the north side."
?L7:	EQUAL? HERE,BEHIND-HUT,HUT-LIVING \?L9
	IN? SCOUT,NORTH-HUT \?L9
	PRINT SS
	PRINTR " scout is slowly making his way toward the back side of the hut."
?L9:	EQUAL? HERE,SOUTH-HUT \?L10
	IN? SCOUT,BEHIND-HUT \?L10
	PRINT SS
	PRINTR " scout is coming around the back side of the hut, and heading toward the south side."
?L10:	EQUAL? HERE,ROAD-END \?L11
	IN? SCOUT,SOUTH-HUT \?L11
	PRINT SS
	PRINTR " scout is rounding the south side of the hut and heading back toward the group of guards at the front door."
?L11:	ZERO? LOOK? \FALSE
	CALL2 CANT-SEE,SCOUT >STACK
	RSTACK

	.FUNCT GUARDS-F,MT,POS,DIR,FACE?,TMP
	GETP HERE,P?GPOS >POS
	CALL1 AT-NML? >STACK
	ZERO? STACK /?L1
	EQUAL? PRSA,V?OFF-2 /?L46
	EQUAL? PRSA,V?WATCH,V?EXAMINE \?L3
	PRINTR "You can't make them out too well from here; they keep moving in and out of the searchlight's glare."
?L3:	EQUAL? PRSA,V?YELL,V?CALL,V?WAVE \?L5
	PRINTI "A suicidal idea, and you're pretty far away as well."
	CRLF
	CALL2 PRINT-ID,STR?136 >STACK
	RSTACK
?L5:	PRINTR "The guards are too far away."
?L1:	EQUAL? PRSA,V?OFF-2 \?L7
?L46:	EQUAL? PRSO,TIMING-OBJECT,WATCHING-OBJECT \?L7
	ZERO? G-WATCH \?L8
	PRINTR "You weren't watching them."
?L8:	SET 'G-WATCH,0
	SET 'CLOCK-MOVE,4
	ICALL1 FLUSH-WATCHER
	ZERO? SAVE-FLAG \TRUE
	PRINTR "You're no longer watching the guards."
?L7:	EQUAL? PRSA,V?WATCH \?L14
	ZERO? G-WATCH /?L15
	PRINTR "You're already watching them."
?L15:	ZERO? SL-WATCH /?L18
	ICALL PERFORM,V?OFF-2,TIMING-OBJECT,SEARCHLIGHTS
	CRLF
?L18:	SET 'G-WATCH,1
	SET 'CHRONOGRAPH-ON,1
	SET 'CLOCK-MOVE,4
	ICALL2 GUARD-WATCHER,1
	PRINTR "You start to watch the guards, and take a moment to check their position after everything you do.[RWD_ID: border:167, VAL: 1]

[The asterisk is your position, the T's are the three guard towers, and the < and > characters are the guards, indicating their direction of motion.]"
?L14:	EQUAL? PRSA,V?EXAMINE \?L21
	ICALL2 I-CLOCKER,CLOCK-MOVE
	SET 'CLOCK-MOVE,0
	ZERO? POS \?L22
	SET 'DIR,STR?137
	JUMP ?L24
?L22:	EQUAL? POS,180 \?L24
	SET 'DIR,STR?138
?L24:	MOD CLOCK-TIME,180 >MT
	LESS? MT,90 /?L26
	SUB 180,MT >MT
?L26:	CALL1 GUARDS-FACING-EACH-OTHER? >FACE?
	PRINTI "Two guards are now visible, patrolling the area between the fences; "
	EQUAL? POS,90 \?L29
	SUB 100,MT >STACK
	DIV STACK,10 >STACK
	MUL STACK,10 >TMP
	ZERO? TMP \?L31
	SET 'TMP,5
?L31:	PRINTI "both are about "
	PRINTN TMP
	PRINTI " yards away, "
	ZERO? GUARD-CHASE \?L34
	PRINTI "and they are walking "
	ICALL FACE-TELL,FACE?,0
	JUMP ?L37
?L34:	PRINTI "moving carefully in your direction, weapons drawn."
	JUMP ?L37
?L29:	ADD MT,5 >STACK
	DIV STACK,10 >STACK
	MUL STACK,10 >TMP
	ZERO? TMP \?L38
	SET 'TMP,5
?L38:	PRINTI "both are off to your "
	PRINT DIR
	PRINTI ", though one is about "
	PRINTN TMP
	PRINTI " yards away, and the other is much farther off. The guards are moving "
	ICALL FACE-TELL,FACE?,0
?L37:	ZERO? G-WATCH \?L41
	PRINTI " Since they are moving all the time, you would do well to WATCH them."
?L41:	CRLF
	RTRUE
?L21:	EQUAL? PRSA,V?WAVE,V?YELL,V?CALL \?L44
	PRINTI "Not very smart."
	CRLF
	CALL2 PRINT-ID,STR?139 >STACK
	RSTACK
?L44:	PRINTI "You can't get close enough to the guards, and it's just as well."
	CRLF
	CALL2 PRINT-ID,STR?140 >STACK
	RSTACK

	.FUNCT FLUSH-WATCHER
	SCREEN 1
	BUFOUT 0
	CURSET 2,1
	ICALL1 INVERSE-LINE
	CURSET 3,1
	ICALL1 INVERSE-LINE
	BUFOUT 1
	SCREEN 0
	RTRUE

	.FUNCT FACE-TELL,FACE?,CR?
	ASSIGNED? 'CR? /?L7
	SET 'CR?,1
?L7:	ZERO? FACE? /?L1
	PRINTI "toward"
	JUMP ?L3
?L1:	PRINTI "away from"
?L3:	PRINTI " each other."
	ZERO? CR? /TRUE
	CRLF
	RTRUE

	.FUNCT INF-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You're just inside the fence. Fifteen feet before you is the base of the guard tower, and beyond that the fence at the border itself. Behind you, to the south, is the hundred yards of no-man's-land you've been across. It is peaceful here, but the searchlights passing harmlessly overhead remind you that you are in great danger. Fortunately, some small snowdrifts give some protection from the guards, although you're easily spotted once their suspicions are aroused. You'd best be very careful if you're to avoid detection.[RWD_ID: border:262, VAL: 2]"
	CRLF
	ZERO? G-WATCH \TRUE
	CRLF
	SET 'P-WALK-DIR,0
	ICALL PERFORM,V?EXAMINE,GUARDS
	RTRUE

	.FUNCT FENCE-CROSS
	SET 'P-WALK-DIR,0
	ICALL PERFORM,V?ENTER,FENCE
	RFALSE

	.FUNCT FENCE-HOLE-F
	EQUAL? PRSA,V?OPEN \?L1
	ICALL PERFORM,V?OPEN,FENCE
	RTRUE
?L1:	EQUAL? PRSA,V?CUT \?L3
	ICALL2 PRINT-ID,STR?141
	ICALL PERFORM,V?CUT,FENCE,PRSI
	RTRUE
?L3:	FSET? HERE,FENCECUTBIT /?L4
	FSET? HERE,FENCEBLOWNBIT /?L4
	PRINTR "There's no hole here."
?L4:	EQUAL? PRSA,V?BOARD,V?ENTER \?L5
	ICALL PERFORM,PRSA,FENCE
	RTRUE
?L5:	EQUAL? PRSA,V?EXAMINE \FALSE
	FSET? HERE,FENCEBLOWNBIT /?L9
	FSET? HERE,FENCEBENTBIT \?L7
?L9:	PRINTR "The hole in the fence is large enough to go through."
?L7:	PRINTR "The vertical slit is about three feet long, though you'd have to get it out of the way if you wanted to go through."

	.FUNCT GUARD-CATCH
	ICALL2 PRINT-ID,STR?142
	ICALL2 JIGS-UP,STR?143
	RFALSE

	.FUNCT GUARD-MOVE-TWR,RM
	ASSIGNED? 'RM /?L8
	SET 'RM,TWR-2
?L8:	CALL1 IN-GUARD-VIEW? >STACK
	ZERO? STACK /?L1
	CALL1 GUARD-CATCH >STACK
	RSTACK
?L1:	PRINTI "You run across to the base of the "
	EQUAL? RM,TWR-2 \?L4
	PRINTI "guard tower"
	JUMP ?L7
?L4:	EQUAL? RM,BDR-2 \?L6
	PRINTI "border fence"
	JUMP ?L7
?L6:	PRINTI "first fence"
?L7:	PRINTI "; apparently, you weren't seen by the guards."
	CRLF
	CRLF
	RETURN RM

	.FUNCT GUARD-MOVE-BDR
	CALL2 GUARD-MOVE-TWR,BDR-2 >STACK
	RSTACK

	.FUNCT GUARD-MOVE-INF
	CALL2 GUARD-MOVE-TWR,INF-2 >STACK
	RSTACK

	.FUNCT LADDER-CLIMB
	SET 'CLOCK-MOVE,10
	PRINTI "You quietly ascend the ladder and arrive at the closed door."
	CRLF
	CRLF
	RETURN LADDER-TOP

	.FUNCT LADDER-DESCEND
	ZERO? ON-BRACE? /?L1
	PRINTI "You'd better get off the brace first."
	CRLF
	RFALSE
?L1:	SET 'CLOCK-MOVE,10
	PRINTI "You clamber down the ladder to the base of the tower."
	CRLF
	CRLF
	RETURN TWR-2

	.FUNCT GLOBAL-MACHINE-GUN-F
	EQUAL? HERE,BDR-2 \?L1
	PRINTR "The gun is on the other side of the tower."
?L1:	EQUAL? PRSA,V?EXAMINE \?L3
	PRINTR "It's hard to tell much, since all you can see is the business end, but it's primary purpose would appear to be sniping at people crossing the open field to the south. It doesn't appear that it can pivot enough to hit anybody that has crossed the outer fence."
?L3:	PRINT TOO-FAR
	CRLF
	RTRUE

	.FUNCT MACHINE-GUN-F
	EQUAL? PRSA,V?KILL,V?SHOOT \FALSE
	PRINTI "The machine gun is on a turret that swings in an arc of about 90 degrees, taking in the entirety of no-man's-land. In retrospect, it must appear a strange oversight that the gun cannot be used on the area between the fences. In any event, there's nothing to be gained by firing the gun except to vent some frustration."
	CRLF
	CALL1 IS-OBJ-PROP-ANIMAL? >STACK
	ICALL PRINT-ID,STR?144,STACK
	CALL1 IS-PERSON? >STACK
	ICALL PRINT-ID,STR?145,STACK
	CALL1 IS-PART-OF-SELF? >STACK
	CALL PRINT-ID,STR?146,STACK >STACK
	RSTACK

	.FUNCT TOWER-ENTRY
	ZERO? ON-BRACE? /?L1
	PRINTI "You'd better get off the brace first."
	CRLF
	RFALSE
?L1:	FSET? TOWER-DOOR,OPENBIT \?L3
	RETURN TOWER-SOUTH
?L3:	PRINTI "The tower door is closed."
	CRLF
	RFALSE

	.FUNCT LADDER-TOP-F,RARG,GD,?TMP
	EQUAL? RARG,M-LOOK \?L1
	ZERO? ON-BRACE? \?L3
	PRINTI "You are standing at the top of the wooden ladder, at the entrance to the tower. The ladder itself is bolted to the tower near the base of the door; for additional support, a metal brace runs horizontally between the ladder and the southwest post, just a few steps below the top rung. With a little luck, it would be possible to climb onto the brace."
	CRLF
	CRLF
	JUMP ?L5
?L3:	PRINTI "You are perched on the metal brace which runs horizontally between the ladder and the southwest post. From here, you are about two feet below the level of the tower entrance, and can easily watch the border guards' movements with little chance of detection."
	CRLF
	CRLF
?L5:	SET 'P-WALK-DIR,0
	CALL PERFORM,V?EXAMINE,GUARDS >STACK
	RSTACK
?L1:	ZERO? GUARD-WAIT /?L6
	EQUAL? RARG,M-ENTER \?L6
	ICALL2 PRINT-ID,STR?147
	CALL2 JIGS-UP,STR?148 >STACK
	RSTACK
?L6:	EQUAL? RARG,M-BEG \FALSE
	EQUAL? PRSA,V?DROP \?L7
	ZERO? ON-BRACE? /?L7
	GETP PRSO,P?SIZE >?TMP
	CALL1 GUARD-DISTANCE >GD
	DIV GD,3 >STACK
	GRTR? ?TMP,STACK \?L8
	PRINTI "The "
	ICALL2 DPRINT,PRSO
	PRINTI " drops to the ground, and the sound of its impact is loud enough to alert the guards."
	LESS? GD,25 \?L10
	ICALL2 PRINT-ID,STR?149
	ICALL2 JIGS-UP,STR?150
	JUMP ?L12
?L10:	PRINTI " They start to approach, weapons drawn."
	CRLF
	ICALL2 PRINT-ID,STR?151
?L12:	CALL2 START-GUARD-CHASE,GD >STACK
	RSTACK
?L8:	PRINTI "The "
	ICALL2 DPRINT,PRSO
	PRINTI " falls to the ground, where it becomes lost in a soft pile of snow."
	CRLF
	EQUAL? PRSO,EXPLODING-PEN \?L14
	ICALL2 DE-QUEUE,I-FUSE-OFF
?L14:	REMOVE PRSO
	RTRUE
?L7:	EQUAL? RARG,M-BEG \FALSE
	EQUAL? PRSA,V?WALK \FALSE
	ZERO? ON-BRACE? /FALSE
	EQUAL? PRSO,P?UP \?L18
	ICALL PERFORM,V?DISEMBARK,BRACE
	RTRUE
?L18:	PRINTR "You'd better get off the brace first."

	.FUNCT BRACE-POST-F
	EQUAL? PRSA,V?EXAMINE \?L1
	CALL PERFORM,PRSA,SW-POST >STACK
	RSTACK
?L1:	ZERO? ON-BRACE? \?L3
	PRINTR "You can't reach it from here; perhaps if you were on the brace, though, it would be possible."
?L3:	EQUAL? BRACE-POST,PRSO \?L4
	ICALL PERFORM,PRSA,SW-POST,PRSI
	RTRUE
?L4:	ICALL PERFORM,PRSA,PRSO,SW-POST
	RTRUE

	.FUNCT TOWER-DOOR-F
	EQUAL? PRSA,V?CLOSE \?L1
	FSET? PRSO,OPENBIT \?L1
	EQUAL? HERE,TOWER-SOUTH \FALSE
	PRINTI "The door closes and locks."
	CRLF
	FCLEAR PRSO,OPENBIT
	RTRUE
?L1:	EQUAL? PRSA,V?LOCK \?L6
	PRINTR "The door locks automatically when it closes."
?L6:	EQUAL? PRSA,V?OPEN \?L7
	FSET? PRSO,OPENBIT /?L7
	EQUAL? HERE,LADDER-TOP \FALSE
	PRINTI "It's locked; trying to open it would only get you caught."
	CRLF
	CALL2 PRINT-ID,STR?152 >STACK
	RSTACK
?L7:	EQUAL? PRSA,V?KNOCK \FALSE
	ZERO? GUARD-FOOLED /?L12
	ICALL2 PRINT-ID,STR?153
	CALL2 JIGS-UP,STR?154 >STACK
	RSTACK
?L12:	IN? GUARD-LEG,HERE \?L14
	PRINTI "Are you crazy? The guard is practically on top of you!"
	CRLF
	CALL2 PRINT-ID,STR?155 >STACK
	RSTACK
?L14:	ZERO? ON-BRACE? /?L15
	PRINTI "You reach up and rap on the door. A few moments later, you hear the door open, and the guard calls out ""Who is there?"" He pauses for a moment, then takes a step down the ladder, his left leg barely missing your cheek."
	CRLF
	MOVE GUARD-LEG,HERE
	FSET TOWER-DOOR,OPENBIT
	CALL RT-QUEUE,I-GUARD-BACK,40 >STACK
	RSTACK
?L15:	ICALL2 PRINT-ID,STR?156
	CALL2 JIGS-UP,STR?157 >STACK
	RSTACK

	.FUNCT I-GUARD-BACK
	LOC GUARD-LEG >STACK
	ZERO? STACK /TRUE
	REMOVE GUARD-LEG
	SET 'GUARD-FOOLED,1
	FCLEAR TOWER-DOOR,OPENBIT
	CALL2 BOLDTELL,STR?158 >STACK
	RSTACK

	.FUNCT GUARD-LEG-F,GD
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "There's not much to say, really. It's just a pair of legs in uniform, presumably attached to a man whom you would prefer not to meet."
?L1:	EQUAL? PRSA,V?PULL,V?MOVE,V?TAKE /?L4
	CALL2 HURT?,PRSO >STACK
	ZERO? STACK /FALSE
?L4:	PRINTI "With a short yelp, the guard stumbles, then falls head-first to the ground with a sickening thud.[RWD_ID: border:683, VAL: 1] The guards on their rounds take notice and start moving toward you. Not knowing whether or not you are armed, they approach slowly and carefully."
	CRLF
	ICALL2 PRINT-ID,STR?159
	REMOVE GUARD-LEG
	MOVE INJURED-GUARD,TWR-2
	CALL1 GUARD-DISTANCE >GD
	LESS? GD,25 \?L5
	CRLF
	ICALL2 PRINT-ID,STR?160
	ICALL2 JIGS-UP,STR?161
	RTRUE
?L5:	ICALL2 START-GUARD-CHASE,GD
	RTRUE

	.FUNCT START-GUARD-CHASE,GD
	SUB GD,25 >STACK
	ICALL RT-QUEUE,I-TOWER,STACK
	SET 'GUARD-CHASE,GD
	SET 'NODOGS-FLAG,1
	SET 'GUARD-CHASE-TIME,CLOCK-TIME
	RETURN GUARD-CHASE-TIME

	.FUNCT INJURED-GUARD-F
	PRINTI "The guards are drawing closer as you reach the sprawled body."
	CRLF
	CRLF
	ICALL1 I-TOWER
	RTRUE

	.FUNCT INT-TIME
	ADD CLOCK-TIME,CLOCK-TICKS >STACK
	RSTACK

	.FUNCT I-TOWER
	EQUAL? HERE,LADDER-TOP,TWR-2,BDR-2 \?L1
	ZERO? G-WATCH /?L3
	ICALL UPDATE-CHRONOGRAPH,0,1
?L3:	HLIGHT H-BOLD
	CRLF
	PRINTI "The guards reach a position within firing range, and fire at you, hitting you in the back. You "
	ICALL2 PRINT-ID,STR?162
	EQUAL? HERE,LADDER-TOP /?L6
	PRINTI "s"
?L6:	PRINTI "tumble to the ground, unconscious, but alive."
	EQUAL? HERE,LADDER-TOP \?L9
	SET 'HERE,TWR-2
	MOVE WINNER,TWR-2
	ICALL1 STATUS-LINE
?L9:	CALL2 JIGS-UP,STR?28 >STACK
	RSTACK
?L1:	EQUAL? HERE,TOWER-SOUTH \?L12
	ICALL2 BOLDTELL,STR?163
	ICALL RT-QUEUE,I-CHARGE,15
	SET 'GUARD-WAIT,1
	RETURN GUARD-WAIT
?L12:	HLIGHT H-BOLD
	CRLF
	ICALL2 PRINT-ID,STR?164
	CALL2 JIGS-UP,STR?165 >STACK
	RSTACK

	.FUNCT I-CHARGE
	HLIGHT H-BOLD
	CRLF
	PRINTI "You can hear the guards charging up the ladder."
	CRLF
	CRLF
	FSET? TOWER-DOOR,OPENBIT \?L1
	ICALL2 PRINT-ID,STR?166
	CALL2 JIGS-UP,STR?167 >STACK
	RSTACK
?L1:	PRINTI "They arrive at the door, and find it locked. Angrily, one guard calls down for the key; a moment later, shots ring out as the frustrated guard riddles the lock mechanism with holes. You've only got moments before you are captured!"
	HLIGHT H-NORMAL
	CRLF
	CALL RT-QUEUE,I-CATCH,10 >STACK
	RSTACK

	.FUNCT I-CATCH
	HLIGHT H-BOLD
	CRLF
	ICALL2 PRINT-ID,STR?168
	CALL2 JIGS-UP,STR?169 >STACK
	RSTACK

	.FUNCT BRACE-F
	EQUAL? PRSA,V?CLIMB,V?CLIMB-ON,V?BOARD /?L3
	EQUAL? PRSA,V?CLIMB-UP \?L1
?L3:	ZERO? ON-BRACE? /?L4
	PRINTI "You're already on it."
	CRLF
	JUMP ?L6
?L4:	SET 'CLOCK-MOVE,8
	PRINTI "You're now standing on the brace, just a few feet below the top rung of the ladder. The bottom corner of the door is just visible from your position. A quick check below confirms that you are relatively well hidden from the pacing guards."
	CRLF
?L6:	SET 'ON-BRACE?,1
	RETURN ON-BRACE?
?L1:	EQUAL? PRSA,V?LEAP \?L7
	ZERO? ON-BRACE? \?L8
	PRINTR "You're not on the brace."
?L8:	PRINTI "You'd break both of your legs."
	CRLF
	CALL2 PRINT-ID,STR?170 >STACK
	RSTACK
?L7:	EQUAL? PRSA,V?CLIMB-DOWN,V?TAKE-OFF,V?DISEMBARK \FALSE
	ZERO? ON-BRACE? \?L12
	PRINTR "You're not on the brace."
?L12:	IN? GUARD-LEG,HERE \?L15
	ICALL2 PRINT-ID,STR?171
	ICALL2 JIGS-UP,STR?172
	RTRUE
?L15:	SET 'CLOCK-MOVE,5
	PRINTI "You're now back at the top of the ladder."
	CRLF
	FSET HERE,GVIEWBIT
	SET 'ON-BRACE?,0
	RTRUE

	.FUNCT TWR-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You're underneath the middle guard tower. The tower itself is supported by four metal posts which rise to a height of twenty feet or so. Entrance to the tower itself is via a wooden ladder running up and to the east at the southwest corner of the tower and leading to a closed door. Just a few dozen feet beyond the northern posts, beyond a seemingly impenetrable border fence, lies freedom."
	CRLF
	CRLF
	SET 'P-WALK-DIR,0
	CALL PERFORM,V?EXAMINE,GUARDS >STACK
	RSTACK

	.FUNCT BINOCULARS-F
	EQUAL? PRSA,V?WEAR \?L1
	PRINTR "The strap seems to be gone; you'll just have to carry them."
?L1:	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L3
	PRINTR "They are your typical pair of binoculars with a magnification of perhaps eight times. If you want to look at something in particular through them, try saying ""LOOK THROUGH BINOCULARS AT something."""
?L3:	EQUAL? PRSA,V?EXAMINE-THROUGH \FALSE
	EQUAL? PRSI,BINOCULARS \FALSE
	EQUAL? PRSO,FENCE-SIGN \?L5
	CALL1 AT-NML? >STACK
	ZERO? STACK /?L5
	ICALL1 SIGN-READER
	RTRUE
?L5:	EQUAL? PRSO,FENCE \?L7
	CALL1 AT-NML? >STACK
	ZERO? STACK /?L7
	ICALL PERFORM,V?EXAMINE,FENCE
	CRLF
	PRINTI "Through the binoculars, you can make out what the signs say:"
	CRLF
	CALL1 SIGN-READER >STACK
	RSTACK
?L7:	EQUAL? PRSO,BORDER-FENCE \?L8
	CALL1 AT-NML? >STACK
	ZERO? STACK /?L8
	ICALL PERFORM,V?EXAMINE,PRSO
	CRLF
	PRINTR "It doesn't appear that any more detail has been found than you could see with your naked eye."
?L8:	EQUAL? PRSO,GUARDS \?L9
	CALL1 AT-NML? >STACK
	ZERO? STACK /?L9
	PRINTR "It's a little easier to see the guards now, but the glare of the searchlights is still annoying. There are clearly two guards; they appear to march back and forth between the three towers, meeting in the middle under the second tower. They are armed with automatic weapons, and have that distinctive no-nonsense air about them which seems quite appropriate for their job. A quick scan at the towers themselves reveal that each has a guard poised ready at his machine gun."
?L9:	EQUAL? PRSO,TOWER \?L10
	CALL1 AT-NML? >STACK
	ZERO? STACK /?L10
	PRINTI "With the "
	ICALL2 DPRINT,PRSI
	PRINTI ", the towers are easily seen. The important detail seems to be that each tower has a guard inside, with a machine gun trained on the field that lies before you."
	CRLF
	ZERO? TOWER-DESTROYED /TRUE
	CRLF
	PRINTR "The bomb you left seems to have quite an impact, as the middle tower is lying in ruins on the ground."
?L10:	CALL ULTIMATELY-IN?,PRSO,WINNER >STACK
	ZERO? STACK /?L14
	PRINTR "Perhaps you are becoming near-sighted, but this is surely extreme. You remind yourself to get a ""company"" physical, if you survive."
?L14:	PRINTR "There's nothing more to be seen than with the naked eye."

	.FUNCT AT-NML?
	EQUAL? HERE,B2,C2,D2 /TRUE
	EQUAL? HERE,E2,A2 /TRUE
	RFALSE

	.FUNCT EXPLODING-PEN-F
	EQUAL? PRSA,V?PUT-ON,V?TIE \?L1
	EQUAL? PRSO,EXPLODING-PEN \?L1
	IN? PRSI,GLOBAL-OBJECTS \?L3
	PRINT SANITY-2
	CRLF
	RTRUE
?L3:	PRINTI "The pen won't stick to the "
	ICALL2 DPRINT,PRSI
	PRINT PERIOD-CR
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \?L6
	ZERO? BOMB-DUD /?L7
	PRINTR "It looks like the bomb is a dud."
?L7:	PRINTR "Although the pen looks quite ordinary, it's nothing of the sort. It is, in fact, an explosive device that you've always thought well-suited for a James Bond movie. When the cap is removed, a small button is revealed. Each push of the button sets the internal timer for an additional minute before detonation. When the cap is replaced, the explosive is armed and nothing can stop it. It's not very powerful, but it can do the job. It is also highly magnetic, making it easier to place, but more difficult to handle in the vicinity of wire hangers and the like."
?L6:	EQUAL? PRSA,V?TIE,V?PUT-ON,V?PUT \?L10
	EQUAL? PRSI,EXPLODING-PEN \?L10
	EQUAL? PRSO,PEN-CAP /?L10
	PRINTR "The only thing you can put on the pen is the pen cap."
?L10:	EQUAL? PRSA,V?OPEN \?L12
	IN? PEN-CAP,EXPLODING-PEN \?L11
	ICALL PERFORM,V?TAKE,PEN-CAP
	ICALL2 THIS-IS-IT,EXPLODING-PEN
	RTRUE
?L11:	EQUAL? PRSA,V?OPEN \?L12
	PRINTR "It's as open as it gets."
?L12:	EQUAL? PRSA,V?CLOSE \?L13
	IN? PEN-CAP,WINNER \?L13
	ICALL PERFORM,V?PUT-ON,PEN-CAP,EXPLODING-PEN
	ICALL2 THIS-IS-IT,EXPLODING-PEN
	RTRUE
?L13:	EQUAL? PRSA,V?THROW \FALSE
	PRINTR "No, it's not the sort of explosive that detonates on impact, though come to think of it, that wouldn't be bad to have. Just place it where you want it."

	.FUNCT I-FUSE,RM,RMA,L
	SET 'I-FATAL,1
	PUT CLOCK-TBL,I-FUSE-OFF,32767
	SET 'CHRONOGRAPH-TIME,FUSE-ARMED
	ICALL2 UPDATE-CHRONOGRAPH,0
	HLIGHT H-BOLD
	CRLF
	IN? EXPLODING-PEN,KNAPSACK \?L1
	LOC KNAPSACK >STACK
	MOVE EXPLODING-PEN,STACK
	REMOVE KNAPSACK
?L1:	LOC EXPLODING-PEN >L
	CALL ULTIMATELY-IN?,EXPLODING-PEN,WINNER >STACK
	ZERO? STACK /?L4
	PRINTI "The exploding pen does its thing, and you have finished doing yours."
	ICALL2 PRINT-ID,STR?173
	HLIGHT H-NORMAL
	CRLF
	ICALL1 FINISH
	JUMP ?L88
?L4:	CALL ULTIMATELY-IN?,EXPLODING-PEN,HERE >STACK
	ZERO? STACK \?L7
	EQUAL? L,FENCE \?L6
	CALL GLOBAL-IN?,FENCE,HERE >STACK
	ZERO? STACK /?L6
	FSET? HERE,PENBIT \?L6
?L7:	PRINTI "The pen explodes nearby, and you are wounded by the flying debris. "
	ICALL2 PRINT-ID,STR?174
	ZERO? GUARD-CHASE /?L8
	ICALL2 JIGS-UP,STR?175
	JUMP ?L88
?L8:	ICALL2 JIGS-UP,STR?176
	JUMP ?L88
?L6:	IN? EXPLODING-PEN,FENCE \?L11
	FSET? OUTF-1,PENBIT \?L12
	SET 'RM,OUTF-1
	JUMP ?L15
?L12:	FSET? OUTF-2,PENBIT \?L14
	SET 'RM,OUTF-2
	JUMP ?L15
?L14:	SET 'RM,OUTF-3
?L15:	GETP RM,P?ACROSS >RMA
	FSET RM,FENCEBLOWNBIT
	FSET RMA,FENCEBLOWNBIT
	FCLEAR RM,PENBIT
	FCLEAR RMA,PENBIT
	SET 'VIGILANCE,1
	ICALL2 BOMB-TELL,RM
	ICALL2 PRINT-ID,STR?177
	JUMP ?L88
?L11:	EQUAL? L,NW-POST,NE-POST \?L16
	EQUAL? HERE,TOWER-SOUTH \?L17
	PRINTI "The pen explodes, and a long moment passes in silence. The tower starts to tremble, and a moment later you're tumbling down toward the ground. You don't arrive, however, as the rear of the tower catches the top of the border fence. For a second, you are suspended over the border, the sound of approaching guards and scattered machine gun fire echoing in your ears. And then the tower itself falls over, landing in a small heap just across the border. As if by instinct, you lift yourself up and move into the darkness beyond. You don't quite know where you are, but what the heck, you're safe now. Somebody will find you sooner or later, but for now sleep doesn't sound so bad...


Congratulations! You have survived the second chapter of Border Zone. The story continues with Chapter 3: The Assassination.[RWD_ID: border:1064, VAL: 3] To start, type CONTINUE at the next prompt.

"
	ICALL2 PRINT-ID,STR?178
	ICALL2 FINISH,3
	JUMP ?L88
?L17:	EQUAL? HERE,LADDER-TOP \?L19
	ICALL1 PEN-POOF
	PRINTI " The tower gives way, and you fall to the ground. This must be your lucky day, because the falling tower misses you by a small margin. Before you are captured, you notice that the rearmost section of the tower has fallen on the other side of the border."
	ICALL2 PRINT-ID,STR?179
	ICALL2 JIGS-UP,STR?28
	JUMP ?L88
?L19:	EQUAL? HERE,TWR-2,BDR-2 \?L20
	ICALL1 PEN-POOF
	PRINTI " The tower is about to give way, but you quickly move aside, as the tower falls backward into the border fence, the northmost section of the tower landing across the border, and the remaining portion landing in a heap alongside you. Guards are everywhere, and it's not long before you are captured."
	ICALL2 PRINT-ID,STR?180
	ICALL2 JIGS-UP,STR?28
	JUMP ?L88
?L20:	FSET? HERE,GVIEWBIT \?L21
	ICALL1 PEN-POOF
	PRINTI " The tower gives way, falling backward toward the border fence. The rearmost portion hits the fence itself, projecting part of the tower across the border. The remainder falls in a heap on the ground. Guards quickly arrive on the scene; one of them spots you, and you are speedily captured."
	ICALL2 PRINT-ID,STR?181
	ICALL2 JIGS-UP,STR?28
	JUMP ?L88
?L21:	SET 'TOWER-DESTROYED,1
	PRINT EXPLOSION-HEARD
	CRLF
	JUMP ?L88
?L16:	EQUAL? L,SE-POST,SW-POST,LADDER-TOP \?L23
	EQUAL? HERE,TOWER-SOUTH,LADDER-TOP \?L24
	ICALL1 PEN-POOF
	PRINTI " The tower gives way, falling southward and to the group. You are flung to the ground, fortunately just a few feet away from the bulk of the debris. Dazed, you slowly regain your feet as the guards arrive to place you under arrest."
	ICALL2 PRINT-ID,STR?182
	ICALL2 JIGS-UP,STR?28
	JUMP ?L88
?L24:	EQUAL? HERE,TWR-2,BDR-2 \?L26
	ICALL1 PEN-POOF
	PRINTI " The tower is about to give way, but you quickly move aside, as the tower falls forward, away from the border, landing in a heap alongside you. Guards are everywhere, and it's not long before you are captured."
	ICALL2 PRINT-ID,STR?183
	ICALL2 JIGS-UP,STR?28
	JUMP ?L88
?L26:	FSET? HERE,GVIEWBIT \?L27
	ICALL1 PEN-POOF
	PRINTI " The tower gives way, falling forward, away from the border, in a heap. Guards quickly arrive on the scene; one of them spots you, and you are speedily captured."
	ICALL2 PRINT-ID,STR?184
	ICALL2 JIGS-UP,STR?28
	JUMP ?L88
?L27:	SET 'TOWER-DESTROYED,1
	PRINT EXPLOSION-HEARD
	CRLF
	JUMP ?L88
?L23:	FSET? L,HUTBIT /?L30
	FSET? L,OUTHUTBIT \?L29
?L30:	SET 'HUT-BURNING,1
	ICALL1 HUT-MUNGER
	REMOVE SCOUT
	FSET? HERE,HUTBIT \?L31
	PRINTI "The pen explodes nearby, and immediately the hut catches fire. You stumble through the smoke-filled air, and end up outside the rear of the hut, dazed but unhurt."
	ICALL2 PRINT-ID,STR?185
	HLIGHT H-NORMAL
	CRLF
	CRLF
	ICALL2 GOTO,BEHIND-HUT
	ICALL1 STATUS-LINE
	JUMP ?L37
?L31:	FSET? HERE,OUTHUTBIT \?L33
	PRINTI "The pen explodes "
	FSET? L,OUTHUTBIT \?L34
	PRINTI "around the other side of"
	JUMP ?L36
?L34:	PRINTI "somewhere inside"
?L36:	PRINTI " the hut. Almost at once, you can smell the burning wood as the hut starts to go up in flames."
	ICALL2 PRINT-ID,STR?186
	JUMP ?L37
?L33:	ICALL2 BOMB-TELL,L
?L37:	ZERO? CAR-SEQUENCE /?L38
	ICALL1 RUN-CAR-SEQUENCE
?L38:	IN? HUT-MAN,OUTSIDE-HUT \?L88
	SET 'WOOD-COUNT,-10000
	REMOVE HUT-MAN
	ICALL2 PRINT-ID,STR?187
	JUMP ?L88
?L29:	FSET? L,GVIEWBIT \?L44
	SET 'VIGILANCE,1
	FSET? HERE,GVIEWBIT /?L47
	FSET? HERE,SLVIEWBIT \?L45
?L47:	PRINTI "The pen explodes, sending debris flying into the air. Naturally, the guards have all taken notice, making your position quite precarious."
	CRLF
	ICALL2 PRINT-ID,STR?188
	JUMP ?L88
?L45:	ICALL2 BOMB-TELL,L
	JUMP ?L88
?L44:	EQUAL? L,OUTSIDE-SHED \?L49
	EQUAL? HERE,INSIDE-SHED \?L50
	PRINTI "The bomb explodes outside the shed; fortunately for you, the wet ground prevents a fire from spreading."
	CRLF
	JUMP ?L88
?L50:	ICALL2 BOMB-TELL,L
	JUMP ?L88
?L49:	EQUAL? L,INSIDE-SHED \?L53
	SET 'I-FATAL,0
	MOVE EXPLODING-PEN,INSIDE-SHED
	SET 'BOMB-DUD,1
	JUMP ?L88
?L53:	CALL HOW-FAR,D5,L >STACK
	LESS? STACK,3 \?L54
	IN? HUT-MAN,OUTSIDE-HUT /?L54
	MOVE HUT-MAN,OUTSIDE-HUT
	EQUAL? HERE,NORTH-HUT,SOUTH-HUT,BEHIND-HUT \?L55
	PRINTI "The pen explodes nearby with a rather loud noise; loud enough, in fact, to "
	GRTR? CAR-SEQUENCE,0 \?L57
	LESS? CAR-SEQUENCE,6 \?L57
	SET 'CAR-SEQUENCE,6
	PRINTI "hurry the owner up in reaching the guards outside."
	ICALL2 PRINT-ID,STR?189
	JUMP ?L88
?L57:	SET 'HUT-MAN-DIVERSION,1
	ICALL RT-QUEUE,I-MAN-BACK,150
	PRINTI "alert the man inside the hut, who stands up and walks out of the door to look around."
	ICALL2 PRINT-ID,STR?190
	JUMP ?L88
?L55:	ICALL2 BOMB-TELL,L
	JUMP ?L88
?L54:	EQUAL? L,CAR \?L61
	LOC CAR >STACK
	ZERO? STACK /?L88
	IN? CAR,ROAD-END \?L64
	REMOVE SCOUT
	EQUAL? HERE,SOUTH-HUT,NORTH-HUT \?L65
	EQUAL? GUARDS-IN-CAR,1 /?L67
	PUSH 0
	JUMP ?L68
?L67:	PUSH 1
?L68:	ICALL PRINT-ID,STR?191,STACK
	ZERO? GUARDS-IN-CAR /?L69
	PUSH 0
	JUMP ?L70
?L69:	PUSH 1
?L70:	ICALL PRINT-ID,STR?192,STACK
	EQUAL? HERE,SOUTH-HUT \?L71
	PRINTI "The car explodes in a ball of red-orange flame."
	JUMP ?L73
?L71:	PRINTI "You hear the sound of the car exploding to the south."
?L73:	PRINTI " The guards quickly regroup and march off to the northeast (presumably to the roadblock there)."
	IN? HUT-MAN,OUTSIDE-HUT \?L77
	MOVE HUT-MAN,HUT-LIVING
	PRINTI " The man from the hut returns to the safety of his home."
	JUMP ?L77
?L65:	ICALL2 BOMB-TELL,L
?L77:	ICALL1 DEMOLISH-CAR
	HLIGHT H-NORMAL
	RTRUE
?L64:	CALL1 CAR-IN-VIEW? >STACK
	ZERO? STACK /?L78
	PRINTI "Off to your "
	LOC CAR >STACK
	ICALL TELL-DIRECTION,HERE,STACK
	ICALL1 DEMOLISH-CAR
	PRINTI ", you watch as the car explodes in a ball of red-orange flame. It's hard to believe there are any survivors."
	EQUAL? GUARDS-IN-CAR,1 /?L79
	PUSH 0
	JUMP ?L80
?L79:	PUSH 1
?L80:	ICALL PRINT-ID,STR?193,STACK
	ZERO? GUARDS-IN-CAR /?L81
	PUSH 0
	JUMP ?L82
?L81:	PUSH 1
?L82:	ICALL PRINT-ID,STR?194,STACK
	JUMP ?L88
?L78:	ICALL2 BOMB-TELL,L
	ICALL1 DEMOLISH-CAR
	EQUAL? GUARDS-IN-CAR,1 /?L84
	PUSH 0
	JUMP ?L85
?L84:	PUSH 1
?L85:	ICALL PRINT-ID,STR?195,STACK
	ZERO? GUARDS-IN-CAR /?L86
	PUSH 0
	JUMP ?L87
?L86:	PUSH 1
?L87:	ICALL PRINT-ID,STR?196,STACK
	JUMP ?L88
?L61:	ICALL2 BOMB-TELL,L
?L88:	REMOVE EXPLODING-PEN
	HLIGHT H-NORMAL
	CRLF
	RTRUE

	.FUNCT FLAMING-CAR-F
	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L1
	PRINTI "The car is entirely engulfed in flame, and it's hard to get very close. "
	ZERO? GUARDS-IN-CAR /?L3
	PRINTI "Through the smoke and fire, you can see the burning bodies of the guards inside; none, it seems, was lucky enough to get away"
	JUMP ?L5
?L3:	PRINTI "You can't make out anything inside"
?L5:	PRINT PERIOD-CR
	RTRUE
?L1:	EQUAL? PRSA,V?ENTER,V?BOARD,V?OPEN /?L7
	CALL2 TOUCHING?,PRSO >STACK
	ZERO? STACK /FALSE
?L7:	PRINTI "You can't get close enough for that."
	CRLF
	CALL2 PRINT-ID,STR?197 >STACK
	RSTACK

	.FUNCT DEMOLISH-CAR
	ZERO? CAR-SEQUENCE \?L1
	SET 'GUARDS-IN-CAR,1
?L1:	SET 'CAR-SEQUENCE,0
	SET 'CAR-ON-ROAD?,0
	SET 'SEQUENCE-RUN?,1
	LOC CAR >STACK
	MOVE FLAMING-CAR,STACK
	REMOVE CAR
	RTRUE

	.FUNCT CAR-IN-VIEW?,L
	LOC CAR >L
	LOC FLAMING-CAR >STACK
	ZERO? STACK /?L1
	LOC FLAMING-CAR >L
?L1:	EQUAL? L,ROAD-END \?L4
	EQUAL? HERE,SOUTH-HUT,NORTH-HUT /TRUE
?L4:	EQUAL? L,F4,F5 \?L6
	EQUAL? HERE,F4,F5 /TRUE
?L6:	EQUAL? L,D6,E6 \?L7
	EQUAL? HERE,D6,E6 /TRUE
?L7:	EQUAL? L,D6,D7,D8 \FALSE
	EQUAL? HERE,D6,D7,D8 /TRUE
	RFALSE

	.FUNCT I-MAN-BACK
	SET 'HUT-MAN-DIVERSION,0
	MOVE HUT-MAN,HUT-LIVING
	EQUAL? HERE,NORTH-HUT,SOUTH-HUT,BEHIND-HUT /?L3
	EQUAL? HERE,HUT-STORAGE,HUT-BEDROOM \FALSE
?L3:	CALL2 BOLDTELL,STR?198 >STACK
	RSTACK

	.FUNCT BOMB-TELL,RM,HF
	IN? RM,ROOMS /?L1
	LOC RM >RM
?L1:	ICALL HOW-FAR,HERE,RM
	PRINTI "You hear a"
	LESS? HF,2 \?L4
	PRINTI " loud "
	JUMP ?L7
?L4:	LESS? HF,4 \?L6
	PRINTI "n "
	JUMP ?L7
?L6:	PRINTI " muffled "
?L7:	PRINTI "explosion "
	ZERO? HF \?L8
	PRINTI "nearby"
	JUMP ?L10
?L8:	PRINTI "off to the "
	ICALL TELL-DIRECTION,HERE,RM
?L10:	PRINT PERIOD-CR
	RTRUE

	.FUNCT PEN-POOF
	PRINTI "The exploding pen does its thing, taking the "
	LOC EXPLODING-PEN >STACK
	ICALL2 DPRINT,STACK
	PRINTI " with it."
	RTRUE

	.FUNCT PEN-CAP-F
	EQUAL? PRSA,V?TAKE \?L1
	IN? PEN-CAP,EXPLODING-PEN \?L1
	PRINTI "Taking the cap reveals the internal timer button."
	CRLF
	MOVE PEN-CAP,WINNER
	MOVE TIMER-BUTTON,EXPLODING-PEN
	RTRUE
?L1:	EQUAL? PRSA,V?PUT-ON,V?PUT \?L3
	IN? PRSO,PRSI /?L3
	EQUAL? PRSI,EXPLODING-PEN \?L3
	MOVE PRSO,PRSI
	REMOVE TIMER-BUTTON
	ZERO? FUSE-ARMED \?L4
	GRTR? FUSE-TIME,0 \?L4
	MUL FUSE-TIME,60 >FUSE-ARMED
	PRINTI "The explosive is now armed; it will explode in "
	ICALL NSPRINT,FUSE-TIME,STR?199
	PRINTI ". You reset your chronometer's timer to zero and start it up."
	CRLF
	SET 'CLOCK-MOVE,0
	SET 'CHRONOGRAPH-TIME,0
	SET 'CHRONOGRAPH-ON,1
	ICALL2 UPDATE-CHRONOGRAPH,0
	ADD CLOCK-TIME,FUSE-ARMED >STACK
	PUT CLOCK-TBL,I-FUSE-OFF,STACK
	RTRUE
?L4:	ZERO? FUSE-TIME \FALSE
	PRINTR "You replace the cap, but the timing button was never pushed, so the explosive isn't armed."
?L3:	EQUAL? PRSA,V?OPEN \FALSE
	ICALL PERFORM,PRSA,EXPLODING-PEN
	RTRUE

	.FUNCT TIMER-BUTTON-F
	EQUAL? PRSA,V?PUSH \?L1
	SET 'CLOCK-MOVE,3
	GRTR? FUSE-ARMED,0 \?L3
	PRINTR "It won't make any difference; the device is armed."
?L3:	GRTR? FUSE-TIME,59 \?L5
	PRINTR "Nothing happens; perhaps you've worn the damned thing out."
?L5:	PRINTI "The button replies with an almost silent ""click""; you've pushed the timer button "
	INC 'FUSE-TIME
	ICALL NSPRINT,FUSE-TIME,STR?200
	PRINT PERIOD-CR
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "The button is small, red, and quite lethal."

	.FUNCT LADDER-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "The ladder is made of wood and climbs steeply up and to the east at the southwest side of the tower, ending at a narrow landing at the entrance to the tower itself. It is secured in place not only at the tower entrance, but, additionally, by a brace running horizontally between the ladder and the southwest post at a point a few feet lower. From the sturdiness of construction, you could probably climb the ladder without drawing the attention of the occupant."
?L1:	EQUAL? PRSA,V?CUT \?L3
	PRINTI "That would make too much noise."
	CRLF
	CALL2 PRINT-ID,STR?201 >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?BOARD,V?CLIMB-UP,V?CLIMB /?L5
	EQUAL? PRSA,V?CLIMB-ON \?L4
	ZERO? ON-BRACE? /?L4
?L5:	EQUAL? HERE,TWR-2 \?L6
	ICALL2 DO-WALK,P?UP
	RTRUE
?L6:	ZERO? ON-BRACE? /?L8
	ICALL PERFORM,V?DISEMBARK,BRACE
	RTRUE
?L8:	PRINTR "You're at the top."
?L4:	EQUAL? PRSA,V?CLIMB-DOWN \?L10
	EQUAL? HERE,LADDER-TOP \?L11
	ICALL2 DO-WALK,P?DOWN
	RTRUE
?L11:	PRINTR "You're at the bottom."
?L10:	EQUAL? PRSA,V?CLIMB-ON,V?BOARD \FALSE
	ZERO? ON-BRACE? /FALSE
	ICALL PERFORM,V?LEAVE,BRACE
	RTRUE

	.FUNCT POSTS-F,L
	LOC EXPLODING-PEN >L
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "Each guard tower is supported by four posts of six-inch square steel. They are situated on the northeast, northwest, southeast, and southwest corners of the building. The posts rise to a height of twenty feet, where they are welded to the underside of the tower proper."
	CRLF
	EQUAL? L,NE-POST,NW-POST /?L5
	EQUAL? L,SE-POST,SW-POST \TRUE
?L5:	CRLF
	PRINTI "The pen is attached to the "
	ICALL2 DPRINT,L
	PRINT PERIOD-CR
	RTRUE
?L1:	PRINTR "It would be best to refer to each post individually, by its position around the base of the tower (e.g. northeast, northwest, etc.)"

	.FUNCT POST-F
	EQUAL? PRSA,V?PUT-ON,V?PUT,V?TIE \?L1
	EQUAL? PRSI,NW-POST,NE-POST /?L3
	EQUAL? PRSI,SE-POST,SW-POST \?L1
?L3:	EQUAL? PRSO,EXPLODING-PEN \FALSE
	MOVE PRSO,PRSI
	EQUAL? HERE,LADDER-TOP \?L6
	PRINTR "The pen adheres to the post after sliding down it to a point just a few feet from the ground. You can't reach it again from here, but you could from down below."
?L6:	PRINTI "The pen adheres strongly to the metallic post, and you remember to position it out of the line of sight of the passing guards.[RWD_ID: border:1509, VAL: 1]"
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \?L10
	PRINTI "Each post is six inches square, made of steel, and twenty-odd feet high."
	EQUAL? PRSO,SW-POST \?L11
	PRINTI " Near the top of this post, a horizontal brace can be seen connecting the post to the ladder which leads to the tower's entrance."
?L11:	IN? EXPLODING-PEN,PRSO \?L14
	PRINTI " Positioned away from the guards' line of sight, the magnetic pen is adhering to the post."
?L14:	CRLF
	RTRUE
?L10:	EQUAL? PRSA,V?KICK,V?MUNG \FALSE
	CRLF
	ICALL2 PRINT-ID,STR?202
	CALL2 JIGS-UP,STR?203 >STACK
	RSTACK

	.FUNCT BORDER-FENCE-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "The fence is quite formidable. It rises to a height of fifteen feet above the ground, and is made of a much heavier chain-link construction than the first. The overhang, six feet wide, is a solid sheet of metal, providing no possibility for scaling."
?L1:	CALL1 AT-NML? >STACK
	ZERO? STACK /?L3
	PRINTR "You'll have to get there first."
?L3:	EQUAL? PRSA,V?LEAP \?L4
	EQUAL? HERE,TOWER-SOUTH \?L5
	PRINTI "You're high enough, all right, but you'd probably end up skewered on the barbed wire."
	CRLF
	CALL2 PRINT-ID,STR?204 >STACK
	RSTACK
?L5:	PRINTR "You're not Superman."
?L4:	EQUAL? PRSA,V?CLIMB-OVER,V?CLIMB,V?CLIMB-UP \?L8
	PRINTR "Utterly hopeless."
?L8:	EQUAL? PRSA,V?TIE,V?PUT-ON,V?PUT \?L9
	EQUAL? PRSO,EXPLODING-PEN \?L9
	PRINTI "The pen won't adhere to the fence; perhaps it is not steel."
	CRLF
	CALL2 PRINT-ID,STR?205 >STACK
	RSTACK
?L9:	EQUAL? PRSA,V?MUNG,V?CUT \FALSE
	PRINTI "You haven't a chance of breaking through."
	CRLF
	CALL2 PRINT-ID,STR?206 >STACK
	RSTACK

	.FUNCT BDR-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You are standing just a few feet away from the border. The fence here is simply too much to hope to overcome. Behind you, to the south, is the central guard tower, the other two flanking the first a hundred yards on each side."
	CRLF
	SET 'P-WALK-DIR,0
	CALL PERFORM,V?EXAMINE,GUARDS >STACK
	RSTACK

	.FUNCT TOWER-F
	EQUAL? PRSA,V?BOARD,V?ENTER \?L1
	EQUAL? HERE,LADDER-TOP \?L1
	ZERO? ON-BRACE? /?L3
	PRINTR "You'll have to get off the brace first."
?L3:	ICALL2 DO-WALK,P?IN
	RTRUE
?L1:	EQUAL? PRSA,V?LEAP-OFF \?L6
	EQUAL? HERE,TOWER-SOUTH \?L7
	ICALL PERFORM,V?LEAP,BORDER-FENCE
	RTRUE
?L7:	PRINTR "Tell me again when you've gotten there."
?L6:	EQUAL? PRSA,V?CRAWL-UNDER \?L10
	EQUAL? HERE,INF-2 \?L11
	ICALL2 DO-WALK,P?NORTH
	RTRUE
?L11:	EQUAL? HERE,TWR-2 \?L13
	PRINTR "You already are."
?L13:	EQUAL? HERE,BDR-2 \?L14
	ICALL2 DO-WALK,P?SOUTH
	RTRUE
?L14:	PRINTR "You're not close enough for that yet."
?L10:	EQUAL? PRSA,V?WALK-TO \?L16
	PRINTR "Just say the direction you wish to cross in; given the lights and the distances involved, however, it would only safe to cross directly to the north."
?L16:	EQUAL? PRSA,V?WATCH,V?FIND,V?EXAMINE /?L18
	EQUAL? PRSA,V?EXAMINE-THROUGH \?L17
?L18:	CALL1 AT-NML? >STACK
	ZERO? STACK /?L19
	PRINTR "It's hard to make out much detail at this distance, but each tower is the same - fifteen, perhaps twenty feet high, supported by long posts. It could be presumed that guards are inside, but you couldn't be certain."
?L19:	EQUAL? HERE,TOWER-SOUTH \?L21
	PRINTR "You're in it; there's no more to be seen."
?L21:	PRINTI "From this distance, you are more-or-less looking up at the tower, which is supported by four metal posts. You can see the business end of a machine gun poking out of the guard's platform, but otherwise can make out no significant details."
	RTRUE
?L17:	CALL1 AT-NML? >STACK
	ZERO? STACK /FALSE
	PRINTR "It's awfully hard to do anything to the tower at this distance."

	.FUNCT GENERIC-FENCE
	EQUAL? HERE,OUTF-1,OUTF-2,OUTF-3 /?L3
	EQUAL? HERE,INF-1,INF-2,INF-3 \?L1
?L3:	RETURN FENCE
?L1:	EQUAL? HERE,TOWER-SOUTH,LADDER-TOP,BDR-2 /?L5
	EQUAL? HERE,TWR-2 \FALSE
?L5:	RETURN BORDER-FENCE

	.FUNCT FENCE-SIGN-F
	EQUAL? PRSA,V?TOUCH \?L1
	ICALL PERFORM,V?TOUCH,FENCE
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE,V?READ \FALSE
	CALL1 AT-NML? >STACK
	ZERO? STACK /?L4
	PRINTR "At this distance, you can't read the sign."
?L4:	CALL1 SIGN-READER >STACK
	RSTACK

	.FUNCT SIGN-READER
	ICALL2 BOLDTELL,STR?207
	CRLF
	CRLF
	PRINTR "You smile, thinking of the literal translation: Have fear! The fence will incinerate you! Touch it and die!"

	.FUNCT FENCE-F,ACROSS
	GETP HERE,P?ACROSS >ACROSS
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "The fence runs across the entire length of the border area. It is of chain-link construction, and reaches a height of eight feet. At the top the fence slopes back toward you, forming an overhang of about four feet, which is completely covered with razor-sharp barbs."
	FSET? HERE,FENCEBLOWNBIT \?L3
	PRINTI " The fence has been destroyed here by the blast of the exploding pen. Enough has been blown away to allow passage easily to the other side."
	JUMP ?L8
?L3:	FSET? HERE,FENCECUTBIT \?L8
	PRINTI " The fence has been cut here"
	FSET? HERE,FENCEBENTBIT \?L6
	PRINTI " and has been bent out of the way, so that it's possible to safely go through it."
	JUMP ?L8
?L6:	PRINTI "."
?L8:	PRINTI " Every ten feet along the fence is a warning sign."
	FSET? HERE,PENBIT \?L10
	PRINTI " The pen is adhering to the fence at this point."
?L10:	CRLF
	RTRUE
?L1:	CALL1 AT-NML? >STACK
	ZERO? STACK /?L13
	PRINTR "You'll have to get a lot closer for that."
?L13:	EQUAL? PRSA,V?DIG \?L14
	ICALL PERFORM,V?DIG,GROUND
	RTRUE
?L14:	EQUAL? PRSA,V?ENTER,V?CRAWL-UNDER \?L15
	FSET? HERE,FENCEBENTBIT /?L18
	FSET? HERE,FENCEBLOWNBIT \?L16
?L18:	PRINTI "You carefully negotiate yourself through the "
	FSET? HERE,FENCEBENTBIT \?L19
	PRINTI "bent"
	JUMP ?L21
?L19:	PRINTI "mangled"
?L21:	PRINTI " fence, making sure no part of your body contacts the fence itself."
	CRLF
	CRLF
	ICALL2 GOTO,ACROSS
	RTRUE
?L16:	FSET? HERE,FENCECUTBIT \?L22
	PRINTI "You start through the fence..."
	CRLF
	CRLF
	REMOVE RUBBER-GLOVES
	ICALL PERFORM,V?TOUCH,FENCE
	RTRUE
?L22:	PRINTR "Just how to achieve that goal is your predicament at the moment."
?L15:	CALL2 TOUCHING?,PRSO >STACK
	ZERO? STACK /?L24
	IN? RUBBER-GLOVES,PROTAGONIST \?L25
	FSET? RUBBER-GLOVES,WORNBIT /?L24
?L25:	ICALL2 PRINT-ID,STR?208
	CALL2 JIGS-UP,STR?209 >STACK
	RSTACK
?L24:	EQUAL? PRSA,V?TIE,V?PUT-ON,V?PUT \?L26
	EQUAL? PRSO,EXPLODING-PEN \?L26
	MOVE PRSO,PRSI
	PRINTI "The pen is now adhering to the fence at this point."
	CRLF
	FSET HERE,PENBIT
	GETP HERE,P?ACROSS >STACK
	FSET STACK,PENBIT
	RTRUE
?L26:	EQUAL? PRSA,V?TOUCH \?L27
	PRINTR "You find you can safely touch the fence."
?L27:	EQUAL? PRSA,V?CLIMB-OVER,V?CLIMB-UP,V?CLIMB /?L29
	EQUAL? PRSA,V?CLIMB-ON \?L28
?L29:	PRINTR "You clamber up the fence and reach the overhang. From here, the small caliber of the wires and the bulky gloves on your hands, makes it clear that the overhang is simply not negotiable. You drop back to the ground."
?L28:	EQUAL? PRSA,V?MUNG,V?CUT \?L30
	FSET? HERE,FENCEBLOWNBIT \?L31
	PRINTR "It's not necessary; there's little fence left here."
?L31:	FSET? HERE,FENCECUTBIT \?L33
	PRINTI "It won't help to break any more links on the fence; you'd just risk setting off an alarm if the fence happens to be wired to detect voltage drop."
	CRLF
	CALL2 PRINT-ID,STR?210 >STACK
	RSTACK
?L33:	EQUAL? PRSI,BOLT-CUTTER \?L34
	FSET HERE,FENCECUTBIT
	FSET ACROSS,FENCECUTBIT
	ADD CLOCK-TIME,800 >CUT-DETECTED
	PRINTI "It's not easy, but you manage to cut a dozen or so of the chain links, making a vertical slit about three feet long.[RWD_ID: border:1791, VAL: 1]"
	CRLF
	CALL2 PRINT-ID,STR?211 >STACK
	RSTACK
?L34:	EQUAL? PRSI,WOOD-SAW \?L35
	PRINTI "You try it for a while, and make little progress. Apparently, the wood saw isn't very useful with metal."
	CRLF
	CALL2 PRINT-ID,STR?212 >STACK
	RSTACK
?L35:	PRINTI "You won't make any progress with that!"
	CRLF
	CALL2 PRINT-ID,STR?213 >STACK
	RSTACK
?L30:	EQUAL? PRSA,V?MOVE,V?PUSH,V?BEND /?L38
	EQUAL? PRSA,V?OPEN \FALSE
?L38:	FSET? HERE,FENCEBLOWNBIT \?L39
	PRINTR "It's not necessary any more."
?L39:	FSET? HERE,FENCECUTBIT \?L41
	FSET? HERE,FENCEBENTBIT \?L42
	FCLEAR HERE,FENCEBENTBIT
	FCLEAR ACROSS,FENCEBENTBIT
	PRINTR "You bend the fence back to its original position."
?L42:	FSET HERE,FENCEBENTBIT
	FSET ACROSS,FENCEBENTBIT
	PRINTR "You bend back the fence far enough to allow you to go through."
?L41:	PRINTR "You can't bend the fence while it's just sitting there in one piece."

	.FUNCT EDGE-ROOM-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You are standing at the edge of the forest; before you, to the north, is an open field perhaps 200 yards wide beyond which lies the border. Three guard towers, "
	EQUAL? HERE,B2 \?L3
	PRINTI "all to your right"
	JUMP ?L9
?L3:	PRINTI "one before you and "
	EQUAL? HERE,C2 \?L6
	PRINTI "two to your right"
	JUMP ?L9
?L6:	EQUAL? HERE,D2 \?L8
	PRINTI "one to either side"
	JUMP ?L9
?L8:	PRINTI "two to your left"
?L9:	PRINTI ", and each with a rotating searchlight mounted on top, stand watch over this no-man's-land. And assuming you could cross without being seen, two more obstacles remain, in the form of imposing fences, one before and the other beyond the tower. You can continue along the edge of the forest to the "
	EQUAL? HERE,E2 /?L10
	PRINTI "east and "
?L10:	PRINTI "west or reenter the forest to the south."
	EQUAL? HERE,E2 \?L13
	PRINTI " To the east, the ground dips sharply; you'd probably be hurt trying to go that way."
?L13:	CRLF
	RTRUE

	.FUNCT BORDER-FIELD-F
	EQUAL? PRSA,V?CLIMB,V?ENTER,V?CROSS \FALSE
	ICALL2 DO-WALK,P?NORTH
	RTRUE

	.FUNCT TRACKS-F,FLG
	ASSIGNED? 'FLG /?L6
	SET 'FLG,1
?L6:	ZERO? FLG /?L1
	FSET? HERE,TRACKSBIT /?L1
	PRINTR "There are no tracks here."
?L1:	EQUAL? PRSA,V?FOLLOW \?L3
	PRINTR "You'll have to specify a direction."
?L3:	EQUAL? PRSA,V?LISTEN \FALSE
	PRINTR "You listen for a while; there's no train coming."

	.FUNCT ROAD-F
	FSET? HERE,ROADBIT /?L1
	PRINTR "There is no road here."
?L1:	CALL2 TRACKS-F,0 >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT TRACKS-ROOM-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You are standing on tracks "
	EQUAL? HERE,A7 \?L3
	PRINTI "which lead off far to the north, but at this point bend to the southeast."
	JUMP ?L6
?L3:	EQUAL? HERE,B8 \?L5
	PRINTI "which run from northwest to southeast."
	JUMP ?L6
?L5:	PRINTI "which run directly north-south."
?L6:	PRINTI " The terrain rises sharply just to the west"
	EQUAL? HERE,A7,B8 \?L7
	PRINTI " and south"
?L7:	PRINTI ", and it's unlikely that you could scramble up very far. To the east lies a dense forest."
	EQUAL? HERE,A2 \?L10
	PRINTR " Just north of here, the tracks enter a brightly lit clearing just beyond which is the border station. It would be suicidal to continue in that direction."
?L10:	EQUAL? HERE,B8 \?L12
	ZERO? FIRST-B8-FLAG /?L12
	SET 'FIRST-B8-FLAG,0
	PRINTI " Off to the northeast you can see smoke rising into the night sky."
?L12:	CRLF
	RTRUE

	.FUNCT FOREST-ROOM-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTR "You are standing in the middle of the forest, which surrounds you on every side."

	.FUNCT SHED-MOVE
	FSET? SHED-DOOR,OPENBIT /?L1
	PRINTI "You open the door and enter the shed, closing the door behind you to keep out the cold and wind."
	CRLF
	CRLF
?L1:	RETURN INSIDE-SHED

	.FUNCT OUTSIDE-SHED-WF,FRM
	EQUAL? HERE,OUTSIDE-SHED \?L1
	CALL1 MAN-CATCHES >STACK
	RSTACK
?L1:	EQUAL? FRM,D5 \FALSE
	EQUAL? HERE,INSIDE-SHED \FALSE
	CALL2 BOLDTELL,STR?214 >STACK
	RSTACK

	.FUNCT BOLDTELL,STR,CR
	ASSIGNED? 'CR /?L7
	SET 'CR,1
?L7:	ZERO? CR /?L1
	CRLF
?L1:	HLIGHT H-BOLD
	PRINT STR
	HLIGHT H-NORMAL
	ZERO? CR /TRUE
	CRLF
	RTRUE

	.FUNCT OUTSIDE-SHED-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You are standing outside of a small shed. Through a small window you can see many stacks of cut wood. The wooden door is "
	ICALL2 DOOR-TELL,SHED-DOOR
	PRINTI ". The forest surrounds you in all directions, though it appears that it becomes less dense to the southeast."
	CRLF
	ICALL2 HUT-MAN-DESC,STR?215
	RTRUE

	.FUNCT WOOD-PILE-F
	EQUAL? PRSA,V?TAKE \?L1
	PRINTI "You don't need any wood at the moment."
	CRLF
	CALL2 PRINT-ID,STR?216 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?MOVE \?L3
	PRINTR "You move a few pieces of wood around, but nothing interesting turns up, unless you've got an interest in entomology."
?L3:	EQUAL? PRSA,V?SEARCH \?L4
	ICALL PERFORM,V?SEARCH,ASSORTED-TOOLS
	RTRUE
?L4:	EQUAL? PRSA,V?EXAMINE \?L5
	PRINTR "It's a large pile, from floor to ceiling; it's not very interesting otherwise."
?L5:	EQUAL? PRSA,V?CUT \FALSE
	EQUAL? PRSI,WOOD-SAW \?L7
	PRINTR "You could certainly cut some logs that way, but it would only waste time."
?L7:	PRINTR "Not with that, you won't."

	.FUNCT FAKE-TOOLS-F
	PRINTI "You can't see that out in the open, though it might be somewhere among the wood and tools."
	CRLF
	CALL2 PRINT-ID,STR?217 >STACK
	RSTACK

	.FUNCT ASSORTED-TOOLS-F
	EQUAL? PRSA,V?SEARCH,V?EXAMINE \?L1
	FSET? PRSO,PENBIT /?L1
	FSET PRSO,PENBIT
	REMOVE FAKE-HAMMER
	REMOVE FAKE-GLOVES
	REMOVE FAKE-SAW
	REMOVE FAKE-CUTTERS
	REMOVE PRSO
	MOVE HAMMER,HERE
	MOVE BOLT-CUTTER,HERE
	MOVE WOOD-SAW,HERE
	MOVE RUBBER-GLOVES,HERE
	PRINTR "You look around and find a hammer, a bolt-cutter, and a wood saw. You also come across an old pair of rubber gloves."
?L1:	PRINTR "You'll do better to look at the tools first, to see which one you want."

	.FUNCT HAMMER-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "It's an ordinary hammer."

	.FUNCT WOOD-SAW-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "It's your average size wood saw, and it's probably used here to cut up the larger logs."

	.FUNCT SHED-WINDOW-F
	EQUAL? PRSA,V?LOOK-INSIDE \?L1
	EQUAL? HERE,INSIDE-SHED \?L3
	IN? HUT-MAN,OUTSIDE-SHED \?L5
	PRINTI "You can't see much. Wait! There's a man, not far from the shed, heading "
	ZERO? WOOD-RETURNING /?L7
	PRINTR "southeast, toward the hut."
?L7:	PRINTR "right toward you!"
?L5:	PRINTR "You can't see much outside, except for some ice which has formed on the window pane."
?L3:	IN? HUT-MAN,INSIDE-SHED \?L11
	PRINTR "You can see piles of wood stacked inside; disturbingly, you can see a man gathering a pile of wood for himself - under his coat is a large revolver."
?L11:	PRINTR "You can see only piles of wood, though other things might be there."
?L1:	EQUAL? PRSA,V?OPEN \?L13
	PRINTR "It can't be opened; it just provides some light to the inside."
?L13:	EQUAL? PRSA,V?MUNG \FALSE
	PRINTI "It would only make noise and call attention to yourself."
	CRLF
	CALL2 PRINT-ID,STR?218 >STACK
	RSTACK

	.FUNCT LEAVE-SHED
	SET 'P-WALK-DIR,0
	ICALL PERFORM,V?EXIT,SHED
	RFALSE

	.FUNCT SHED-F
	EQUAL? PRSA,V?CLOSE,V?OPEN \?L1
	ICALL PERFORM,PRSA,SHED-DOOR
	RTRUE
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \?L3
	ICALL PERFORM,V?LOOK-INSIDE,SHED-WINDOW
	RTRUE
?L3:	EQUAL? PRSA,V?ENTER \?L4
	EQUAL? HERE,OUTSIDE-SHED \?L5
	CALL1 SHED-MOVE >STACK
	CALL2 GOTO,STACK >STACK
	RSTACK
?L5:	PRINTR "That doesn't make sense."
?L4:	EQUAL? PRSA,V?EXIT,V?LEAVE \FALSE
	EQUAL? HERE,INSIDE-SHED \?L9
	CALL2 GOTO,OUTSIDE-SHED >STACK
	RSTACK
?L9:	PRINTR "You're not in the shed."

	.FUNCT INSIDE-SHED-WF,FRM
	SET 'WOOD-RETURNING,1
	RETURN WOOD-RETURNING

	.FUNCT INSIDE-SHED-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "The shed appears to be entirely for the storage of wood, although some scattered tools are lying about.[RWD_ID: border:2897, VAL: 1] Snow can be seen falling through a small window. The door leading back into the forest is "
	ICALL2 DOOR-TELL,SHED-DOOR
	PRINTR "."

	.FUNCT D5-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You are standing in a small clearing in the forest. To the east, there is a small hut,"
	ZERO? HUT-BURNING \?L3
	PRINTI " and it would seem that somebody is inside, judging by the swirls of smoke that pour through the chimney and into the night sky."
	JUMP ?L5
?L3:	PRINTI " engulfed in flame. Large plumes of black smoke rise into the night sky."
?L5:	PRINTI " To the south lies the start of a paved road which gently winds its way through the trees and out of sight. The forest surrounds the clearing in the other directions, though it appears that a poorly defined path leads to the northwest."
	CRLF
	ICALL2 HUT-MAN-DESC,STR?215
	RTRUE

	.FUNCT CHIMNEY-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "Besides the smoke coming out, there's not much to tell."
?L1:	EQUAL? PRSA,V?CLIMB-UP,V?CLIMB-DOWN,V?ENTER /?L4
	EQUAL? PRSA,V?CLIMB \FALSE
?L4:	PRINTI "You would be incinerated."
	CRLF
	CALL2 PRINT-ID,STR?219 >STACK
	RSTACK

	.FUNCT HUT-F,RM
	EQUAL? PRSA,V?EXAMINE \?L1
	ZERO? HUT-BURNING /?L3
	PRINTR "There's not much to tell; the entire wooden structure is now engulfed in flames, and the heat and smoke make it hard to get much closer."
?L3:	PRINTR "The hut is small, perhaps no more than a few rooms. The exterior is a dark wooden clapboard, worn and weaterbeaten. Some black smoke rises out of a small chimney, swirling around in the cold breeze, and vanishing into the night sky."
?L1:	EQUAL? PRSA,V?CLIMB-UP,V?CLIMB-OVER,V?CLIMB \?L6
	PRINTR "There's nothing on top of the hut except for the chimney, so unless you're Santa Claus it won't be of much use."
?L6:	EQUAL? PRSA,V?LEAVE,V?ENTER \?L7
	ZERO? HUT-BURNING /?L8
	PRINTI "It's too late for that."
	CRLF
	CALL2 PRINT-ID,STR?220 >STACK
	RSTACK
?L8:	EQUAL? PRSA,V?ENTER \?L10
	EQUAL? HERE,BEHIND-HUT \?L10
	ICALL2 DO-WALK,P?IN
	RTRUE
?L10:	EQUAL? PRSA,V?LEAVE \?L11
	EQUAL? HERE,HUT-STORAGE \?L11
	ICALL2 DO-WALK,P?OUT
	RTRUE
?L11:	PRINTR "You'll have to figure out how to do that."
?L7:	EQUAL? PRSA,V?LOOK-INSIDE \?L13
	CALL GLOBAL-IN?,HUT-WINDOW,HERE >STACK
	ZERO? STACK /?L13
	ICALL PERFORM,PRSA,HUT-WINDOW
	RTRUE
?L13:	EQUAL? PRSA,V?WALK-AROUND \FALSE
	CALL LKP,HERE,HUT-WALKS >RM
	ZERO? RM /?L15
	ZERO? HUT-BURNING /?L17
	PRINTI "You cough from the smoke you've inhaled, but continue around the remains of the burning hut..."
	CRLF
	CRLF
?L17:	ICALL2 GOTO,RM
	RTRUE
?L15:	PRINTR "You can only walk around the hut if you're standing just outside of it."

	.FUNCT LKP,THING,TBL,SIZE,FROB
	GET TBL,0 >SIZE
?L1:	GET TBL,1 >FROB
	EQUAL? FROB,THING \?L3
	GET TBL,2 >STACK
	RSTACK
?L3:	ZERO? FROB /FALSE
	ADD TBL,2 >TBL
	JUMP ?L1

	.FUNCT D5-WF,FRM
	EQUAL? HERE,D5 \?L1
	CALL1 MAN-CATCHES >STACK
	RSTACK
?L1:	EQUAL? HERE,NORTH-HUT,SOUTH-HUT /?L4
	EQUAL? HERE,ROAD-END,OUTSIDE-HUT \?L3
?L4:	EQUAL? FRM,OUTSIDE-SHED \?L5
	ZERO? HUT-BURNING /?L7
	REMOVE HUT-MAN
	SET 'WOOD-COUNT,-10000
	CALL2 BOLDTELL,STR?221 >STACK
	RSTACK
?L7:	CALL2 BOLDTELL,STR?222 >STACK
	RSTACK
?L5:	CALL2 BOLDTELL,STR?223 >STACK
	RSTACK
?L3:	EQUAL? FRM,OUTSIDE-SHED \FALSE
	ZERO? HUT-BURNING /FALSE
	SET 'WOOD-COUNT,-10000
	RETURN WOOD-COUNT

	.FUNCT OUTSIDE-HUT-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "You are standing outside of the "
	ZERO? HUT-BURNING /?L3
	PRINTI "blazing "
?L3:	PRINTI "hut, just a few feet away from the front door. You could walk around the house to either the northeast or southeast, or you could return to the clearing just west of here or the road that starts just to the south. All other directions lead back into the forest."
	CRLF
	ICALL2 HUT-MAN-DESC,STR?215
	RTRUE
?L1:	EQUAL? RARG,M-BEG \FALSE
	EQUAL? PRSA,V?WALK \FALSE
	EQUAL? PRSO,P?EAST,P?IN \FALSE
	ZERO? HUT-BURNING /FALSE
	SET 'P-WALK-DIR,0
	ICALL PERFORM,V?ENTER,HUT
	RTRUE

	.FUNCT OUTSIDE-HUT-WF,FRM
	EQUAL? HERE,OUTSIDE-HUT \?L1
	CALL1 MAN-CATCHES >STACK
	RSTACK
?L1:	EQUAL? FRM,D5 \?L3
	EQUAL? HERE,NORTH-HUT,SOUTH-HUT,ROAD-END \?L10
	ZERO? HUT-BURNING /?L4
	REMOVE HUT-MAN
	SET 'WOOD-COUNT,-10000
	CALL2 BOLDTELL,STR?224 >STACK
	RSTACK
?L4:	CALL2 BOLDTELL,STR?225 >STACK
	RSTACK
?L3:	EQUAL? HERE,NORTH-HUT,SOUTH-HUT,ROAD-END /?L8
?L10:	EQUAL? HERE,BEHIND-HUT \FALSE
?L8:	CALL2 BOLDTELL,STR?226 >STACK
	RSTACK

	.FUNCT NORTH-HUT-F,RARG
	EQUAL? RARG,M-ENTER-DESC \?L1
	ICALL1 CAR-SEQ-TELL
	ICALL2 HUT-MAN-DESC,STR?215
	RTRUE
?L1:	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You are on the north side of the "
	ZERO? HUT-BURNING /?L4
	PRINTI "burning "
?L4:	PRINTI "hut, the front door and a small clearing lying to your southwest and the rear of the hut to your southeast."
	ZERO? HUT-BURNING \?L7
	PRINTI " A small window looks into what appears to be the living room."
	CRLF
?L7:	ICALL1 CAR-SEQ-TELL
	RTRUE

	.FUNCT CAR-SEQ-TELL
	ZERO? HUT-MAN-DIVERSION /?L1
	CRLF
	PRINTI "The man from the hut is standing out front, looking a bit confused. He takes a few tentative steps in different directions, hoping perhaps to sense better the source of the explosion."
	RTRUE
?L1:	GRTR? CAR-SEQUENCE,0 \?L3
	CRLF
	LOC SCOUT >STACK
	ZERO? STACK /?L4
	PRINTI "Two"
	JUMP ?L6
?L4:	PRINTI "Three"
?L6:	PRINTI " men, presumably from the automobile parked at the end of the roadway south of the clearing, are "
	LESS? CAR-SEQUENCE,4 \?L7
	PRINTI "walking toward the front door of the hut"
	JUMP ?L10
?L7:	EQUAL? CAR-SEQUENCE,4 \?L9
	PRINTI "standing at the front door of the hut, talking quietly among themselves, as if waiting for someone to answer the door"
	JUMP ?L10
?L9:	PRINTI "in quiet conversation with a man, presumably the owner of the hut, who stands leaning against the closed front door. They seem to be lecturing him about something, for he speaks little and nods often"
?L10:	PRINTI "."
	CALL1 SCOUT-TELL >STACK
	ZERO? STACK \TRUE
	CRLF
	RTRUE
?L3:	IN? CAR,ROAD-END \FALSE
	CRLF
	PRINTR "Three men have just returned to their automobile which was parked at the end of the roadway just south of the clearing. The car has been started and is preparing to depart."

	.FUNCT HUT-WINDOW-F,H
	SET 'H,0
	ZERO? HUT-BURNING /?L1
	PRINTR "It's engulfed in flame."
?L1:	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L3
	EQUAL? HERE,HUT-STORAGE,BEHIND-HUT \?L4
	FSET? HUT-BACK-DOOR,OPENBIT \?L4
	PRINTR "The door's open, so the view isn't too interesting."
?L4:	PRINTI "You look through the window and see "
	EQUAL? HERE,HUT-LIVING,HUT-BEDROOM,HUT-STORAGE \?L7
	PRINTI "a wintry landscape."
	EQUAL? HERE,HUT-STORAGE \?L14
	IN? SCOUT,BEHIND-HUT \?L14
	PRINTI " A lone scout is walking toward the south side of the hut."
	JUMP ?L14
?L7:	EQUAL? HERE,NORTH-HUT \?L12
	PRINTI "the living room, furnished sparsely."
	SET 'H,HUT-LIVING
	JUMP ?L14
?L12:	EQUAL? HERE,SOUTH-HUT \?L13
	PRINTI "the bedroom, furnished sparsely."
	SET 'H,HUT-BEDROOM
	JUMP ?L14
?L13:	EQUAL? HERE,BEHIND-HUT \?L14
	PRINTI "the storage room."
	SET 'H,HUT-STORAGE
?L14:	ZERO? H /?L16
	IN? HUT-MAN,H \?L16
	PRINTI " A man is there!"
?L16:	CRLF
	RTRUE
?L3:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L19
	PRINTR "The windows here don't open and close - not surprising, for an inexpensively built hut like this."
?L19:	EQUAL? PRSA,V?KNOCK \?L20
	PRINTI "Not smart; sombody might hear you."
	CRLF
	CALL2 PRINT-ID,STR?227 >STACK
	RSTACK
?L20:	EQUAL? PRSA,V?KICK,V?MUNG \FALSE
	PRINTI "Not smart. If somebody's home, you're in big trouble, and if nobody's home, the broken window will just alert the owner to trouble when he returns."
	CRLF
	EQUAL? PRSA,V?MUNG /?L22
	PUSH 0
	JUMP ?L23
?L22:	PUSH 1
?L23:	ICALL PRINT-ID,STR?228,STACK
	EQUAL? PRSA,V?MUNG /?L24
	PUSH 1
	JUMP ?L25
?L24:	PUSH 0
?L25:	CALL PRINT-ID,STR?229,STACK >STACK
	RSTACK

	.FUNCT SOUTH-HUT-F,RARG
	EQUAL? RARG,M-ENTER-DESC \?L1
	ICALL1 CAR-SEQ-TELL
	ICALL2 HUT-MAN-DESC,STR?215
	RTRUE
?L1:	EQUAL? RARG,M-LOOK \FALSE
	ZERO? HUT-BURNING \?L4
	PRINTI "You are on the south side of the hut. Northwest of here lies the front of the hut, and beyond that a small clearing. To the northeast lies the back side of the hut. Through a small window, you can see the bedroom."
	CRLF
	JUMP ?L6
?L4:	PRINTI "You are south of the burning hut. To the northwest is the front of the hut, and beyond that a small clearing."
	CRLF
?L6:	ICALL1 CAR-SEQ-TELL
	RTRUE

	.FUNCT BEHIND-HUT-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	ZERO? HUT-BURNING \?L3
	PRINTI "You are standing at the back door of the hut, which can be circled to the northwest and the southwest. On all other sides lies the forest."
	FSET? HUT-BACK-DOOR,OPENBIT \?L5
	PRINTR " The door stands open."
?L5:	PRINTR " A small window in the door gives a view into the house."
?L3:	PRINTR "You are standing at the back of the blazing hut, which can be circled to the northwest and southwest. The forest surrounds you on all other sides."
?L1:	EQUAL? RARG,M-BEG \FALSE
	EQUAL? PRSA,V?WALK \FALSE
	EQUAL? PRSO,P?WEST,P?IN \FALSE
	ZERO? HUT-BURNING /FALSE
	SET 'P-WALK-DIR,0
	ICALL PERFORM,V?ENTER,HUT
	RTRUE

	.FUNCT HUT-BACK-DOOR-F
	ZERO? HUT-BURNING /?L1
	PRINTI "The door is completely in flames."
	CRLF
	CALL1 BURNING-HOUSE-DANGER? >STACK
	CALL PRINT-ID,STR?230,STACK >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?KNOCK \?L3
	PRINTI "What, are you crazy? What if someone's home?"
	CRLF
	CALL2 PRINT-ID,STR?231 >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?OPEN \?L4
	FSET? PRSO,OPENBIT /?L4
	ZERO? DOOR-OILED \?L4
	PRINTI "The door squeaks loudly as you open it."
	CRLF
	LOC HUT-MAN >STACK
	EQUAL? STACK,HUT-LIVING,HUT-BEDROOM \?L5
	CRLF
	ICALL2 PRINT-ID,STR?232
	ICALL2 JIGS-UP,STR?233
?L5:	FSET PRSO,OPENBIT
	RTRUE
?L4:	EQUAL? PRSA,V?OIL \?L10
	IN? OIL-CAN,WINNER /?L9
?L10:	EQUAL? PRSA,V?PUT \?L8
	EQUAL? PRSO,OIL-CAN \?L8
?L9:	EQUAL? HERE,BEHIND-HUT \?L11
	PRINTR "A good idea, but the hinges are on the inside, so you'll have to do it from there."
?L11:	PRINTI "The squeaky door gets the grease, or words to that effect. The door seems quieter already."
	CRLF
	SET 'DOOR-OILED,1
	RETURN DOOR-OILED
?L8:	EQUAL? PRSA,V?OIL \?L14
	PRINTR "You aren't holding any oil."
?L14:	EQUAL? PRSA,V?EXAMINE \?L15
	PRINTI "The wooden door is chipped in places, but is otherwise in pretty good shape. The hinges, though, are rusted badly"
	ZERO? DOOR-OILED \?L16
	PRINTI " - it'll make some noise when it's opened"
?L16:	PRINT PERIOD-CR
	RTRUE
?L15:	EQUAL? PRSA,V?CLOSE \FALSE
	ZERO? DOOR-OILED \FALSE
	FSET? PRSO,OPENBIT \FALSE
	PRINTI "The door squeaks loudly as you start to pull it closed."
	CRLF
	FCLEAR PRSO,OPENBIT
	RTRUE

	.FUNCT MAN-AT-HOME?
	LOC HUT-MAN >STACK
	EQUAL? STACK,HUT-STORAGE,HUT-LIVING,HUT-BEDROOM /TRUE
	RFALSE

	.FUNCT HUT-FRONT-DOOR-F
	ZERO? HUT-BURNING /?L1
	PRINTI "What's left of it is in flames."
	CRLF
	CALL1 BURNING-HOUSE-DANGER? >STACK
	CALL PRINT-ID,STR?234,STACK >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?KNOCK \?L3
	EQUAL? HERE,HUT-LIVING \?L3
	PRINTR "That would be dangerous, particularly if anyone's outside."
?L3:	EQUAL? PRSA,V?KNOCK,V?OPEN \?L4
	CALL1 MAN-AT-HOME? >STACK
	ZERO? STACK /?L4
	ICALL2 PRINT-ID,STR?235
	ICALL2 JIGS-UP,STR?236
	RTRUE
?L4:	EQUAL? PRSA,V?OPEN \FALSE
	IN? CAR,ROAD-END \FALSE
	PRINTI "That would be foolish, with guards standing just outside."
	CRLF
	CALL2 PRINT-ID,STR?237 >STACK
	RSTACK

	.FUNCT HUT-STORAGE-EXIT
	FSET? HUT-BACK-DOOR,OPENBIT \?L1
	FCLEAR HUT-BACK-DOOR,OPENBIT
	PRINTI "You walk out into the night air, closing the door behind you."
	CRLF
	CRLF
	RETURN BEHIND-HUT
?L1:	PRINTI "The door is closed."
	CRLF
	RFALSE

	.FUNCT HUT-STORAGE-WF,FRM
	EQUAL? HERE,HUT-STORAGE \?L1
	CALL1 MAN-CATCHES >STACK
	RSTACK
?L1:	ZERO? HUT-STORE-FLAG /?L3
	SET 'HUT-STORE-FLAG,0
	EQUAL? HERE,NORTH-HUT \?L4
	IN? PARKA,HUT-STORAGE \?L6
	MOVE PARKA,HUT-MAN
?L6:	CALL2 BOLDTELL,STR?238 >STACK
	RSTACK
?L4:	EQUAL? HERE,BEHIND-HUT \FALSE
	HLIGHT H-BOLD
	CRLF
	PRINTI "You watch through the window as the man enters the storage area and "
	IN? PARKA,HUT-STORAGE \?L10
	MOVE PARKA,HUT-MAN
	PRINTI "puts on the white parka which is lying there, then "
	JUMP ?L12
?L10:	PRINTI "seems to search for something; after a moment, he "
?L12:	PRINTI "heads back toward the front of the hut."
	HLIGHT H-NORMAL
	CRLF
	RTRUE
?L3:	IN? PARKA,HUT-MAN \?L15
	MOVE PARKA,HUT-STORAGE
?L15:	EQUAL? HERE,NORTH-HUT \?L18
	CALL2 BOLDTELL,STR?239 >STACK
	RSTACK
?L18:	EQUAL? HERE,BEHIND-HUT \FALSE
	IN? PARKA,HUT-STORAGE \?L21
	CALL2 BOLDTELL,STR?240 >STACK
	RSTACK
?L21:	CALL2 BOLDTELL,STR?241 >STACK
	RSTACK

	.FUNCT HUT-STORAGE-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "The storage area connects to the main living area of the hut through an open doorway to the west.[RWD_ID: border:3823, VAL: 1] A door which is "
	ICALL2 DOOR-TELL,HUT-BACK-DOOR
	PRINTR " leads back into the forest."

	.FUNCT DOOR-TELL,D
	FSET? D,OPENBIT \?L1
	PRINTI "open"
	RTRUE
?L1:	PRINTI "closed"
	RTRUE

	.FUNCT HUT-WOOD-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "The pile is sitting next to the wood stove, and has about "
	ZERO? HUT-WOOD-ADDED /?L3
	PRINTI "twenty"
	JUMP ?L5
?L3:	PRINTI "a dozen"
?L5:	PRINTR " pieces of wood on it."
?L1:	EQUAL? PRSA,V?TAKE \?L6
	PRINTI "It can't help you. Leave it alone."
	CRLF
	CALL2 PRINT-ID,STR?242 >STACK
	RSTACK
?L6:	EQUAL? PRSA,V?CUT \FALSE
	CALL1 TOO-LATE >STACK
	RSTACK

	.FUNCT TAKEABLE?,OBJ,F
	FIRST? OBJ >F \FALSE
?L4:	FSET? F,TAKEBIT /TRUE
	NEXT? F >F /?L4
	RFALSE

	.FUNCT GLOBAL-HUT-MAN-F
	EQUAL? PRSA,V?FOLLOW \?L1
	PRINTI "Unwise; if he saw you, the results could be disastrous."
	CRLF
	CALL2 PRINT-ID,STR?243 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	CALL1 HUT-MAN-DESC >STACK
	ZERO? STACK \TRUE
	PRINTR "You can't see him here."

	.FUNCT HUT-MAN-DESC,STR
	ASSIGNED? 'STR /?L24
	SET 'STR,STR?244
?L24:	IN? HUT-MAN,HUT-LIVING \?L1
	ZERO? HUT-BURNING \?L1
	EQUAL? HERE,NORTH-HUT,HUT-BEDROOM,HUT-STORAGE \?L1
	PRINT STR
	PRINTI " in the living room, "
	ZERO? WOOD-RETURNING \?L5
	GRTR? WOOD-COUNT,0 /?L3
?L5:	PRINTI "sitting in a chair"
	JUMP ?L7
?L3:	EQUAL? HUT-MAN-FROM,OUTSIDE-HUT \?L6
	PRINTI "heading toward the storage area"
	JUMP ?L7
?L6:	PRINTI "heading toward the front door"
?L7:	PRINT PERIOD-CR
	RTRUE
?L1:	IN? HUT-MAN,D5 \?L8
	EQUAL? HERE,OUTSIDE-HUT,SOUTH-HUT,NORTH-HUT /?L9
	EQUAL? HERE,ROAD-END \?L8
?L9:	PRINT STR
	PRINTI " in the clearing, "
	EQUAL? HUT-MAN-FROM,OUTSIDE-HUT \?L10
	PRINTI "heading into the forest to the northwest"
	JUMP ?L12
?L10:	PRINTI "heading back toward the hut with an armful of logs"
?L12:	PRINT PERIOD-CR
	RTRUE
?L8:	IN? HUT-MAN,INSIDE-SHED \?L13
	EQUAL? HERE,OUTSIDE-SHED \?L13
	PRINT STR
	PRINTR " inside the shed, collecting logs."
?L13:	IN? HUT-MAN,HUT-STORAGE \?L14
	EQUAL? HERE,BEHIND-HUT,HUT-LIVING \?L14
	PRINT STR
	PRINTI " in the storage area, "
	ZERO? WOOD-RETURNING /?L15
	PRINTI "preparing to return to the living room"
	JUMP ?L17
?L15:	PRINTI "looking for his parka"
?L17:	PRINT PERIOD-CR
	RTRUE
?L14:	IN? HUT-MAN,OUTSIDE-HUT \FALSE
	EQUAL? HERE,ROAD-END,D5,NORTH-HUT /?L19
	EQUAL? HERE,SOUTH-HUT \FALSE
?L19:	GRTR? WOOD-COUNT,0 \FALSE
	PRINT STR
	PRINTI " outside the hut, "
	EQUAL? HUT-MAN-FROM,D5 \?L20
	PRINTI "heading inside with an armful of logs"
	JUMP ?L22
?L20:	PRINTI "heading off toward the clearing"
?L22:	PRINT PERIOD-CR
	RTRUE

	.FUNCT HUT-LIVING-WF,FRM
	EQUAL? HERE,HUT-LIVING,HUT-BEDROOM \?L1
	CALL2 MAN-CATCHES,1 >STACK
	RSTACK
?L1:	EQUAL? FRM,OUTSIDE-HUT \?L3
	ZERO? HUT-BURNING /?L4
	REMOVE HUT-MAN
	SET 'WOOD-COUNT,-10000
	CALL2 BOLDTELL,STR?224 >STACK
	RSTACK
?L4:	EQUAL? HERE,SOUTH-HUT,ROAD-END \?L6
	CALL2 BOLDTELL,STR?245 >STACK
	RSTACK
?L6:	EQUAL? HERE,NORTH-HUT,HUT-BEDROOM \?L7
	SET 'HUT-WOOD-ADDED,1
	CALL2 BOLDTELL,STR?246 >STACK
	RSTACK
?L7:	EQUAL? HERE,HUT-STORAGE \FALSE
	CALL2 BOLDTELL,STR?247 >STACK
	RSTACK
?L3:	ZERO? WOOD-RETURNING /?L10
	EQUAL? HERE,NORTH-HUT \?L11
	ICALL2 BOLDTELL,STR?248
	JUMP ?L14
?L11:	EQUAL? HERE,HUT-BEDROOM \?L13
	PRINTI "You see the man return to the living room, then pass your line of sight. Presumably, he has taken a seat there."
	CRLF
	JUMP ?L14
?L13:	EQUAL? HERE,BEHIND-HUT \?L14
	ICALL1 MAN-TO-LIVING-ROOM
?L14:	ICALL1 OWNER-NOTICES?
	RTRUE
?L10:	EQUAL? HERE,NORTH-HUT \?L16
	CRLF
	HLIGHT H-BOLD
	PRINTI "Through the window, you see the man enter the living room"
	IN? PARKA,HUT-MAN \?L17
	PRINTI " wearing a white parka"
?L17:	PRINTI ", and proceed to the front door, stopping for a moment to count the logs sitting by the wood stove."
	HLIGHT H-NORMAL
	CRLF
	RTRUE
?L16:	EQUAL? HERE,BEHIND-HUT \FALSE
	CALL1 MAN-TO-LIVING-ROOM >STACK
	RSTACK

	.FUNCT OWNER-NOTICES?
	CALL2 TAKEABLE?,HUT-LIVING >STACK
	ZERO? STACK /FALSE
	FSET? HERE,HUTBIT \FALSE
	CRLF
	HLIGHT H-BOLD
	MOVE HUT-MAN,HERE
	ICALL2 PRINT-ID,STR?249
	CALL2 JIGS-UP,STR?250 >STACK
	RSTACK

	.FUNCT MAN-TO-LIVING-ROOM
	CALL2 BOLDTELL,STR?251 >STACK
	RSTACK

	.FUNCT MAN-CATCHES,HME?
	ASSIGNED? 'HME? /?L5
	SET 'HME?,0
?L5:	MOVE HUT-MAN,HERE
	HLIGHT H-BOLD
	CRLF
	ZERO? HME? /?L1
	PRINTI "The owner of the hut returns to the living room and spots you before you can react. He"
	ICALL2 PRINT-ID,STR?252
	ICALL2 JIGS-UP,HAVE-A-SEAT
	RTRUE
?L1:	FSET? HERE,HUTBIT \?L3
	PRINTI "The owner of the hut spots you, and"
	ICALL2 PRINT-ID,STR?253
	ICALL2 JIGS-UP,HAVE-A-SEAT
	RTRUE
?L3:	ICALL2 PRINT-ID,STR?254
	ICALL2 JIGS-UP,HUT-MAN-HALT
	RTRUE

	.FUNCT HUT-LIVING-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "The main living area in the hut is extremely simple, consisting of a couch, a table, a few chairs, and a small kitchen area. A woodstove in the corner keeps the room warm, and a small lightbulb dangling from the end of a cord keeps the room lit. On a wall hangs what appears to be a map of the local area. To the south, a doorway leads to the bedroom, and to the east, a smaller doorway leads to what appears from here to be a storage area. The front door, to the west, leads outside. At the moment, it is "
	ICALL2 DOOR-TELL,HUT-FRONT-DOOR
	PRINT PERIOD-CR
	RTRUE

	.FUNCT HUT-MAP-F
	EQUAL? PRSA,V?OPEN \?L1
	PRINTR "It's framed on the wall, not folded up!"
?L1:	EQUAL? PRSA,V?EXAMINE,V?READ \FALSE
	PRINTR "This is the map included in your BORDER ZONE package."

	.FUNCT MISC-LIVING-F
	PRINTR "There's nothing of interest here; you'd best get on with your more pressing problems."

	.FUNCT OIL-CAN-F
	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \FALSE
	PRINTR "It's your everyday oil can, and it's pretty full of oil. Out here in the middle of nowhere, it probably comes in quite handy."

	.FUNCT GENERIC-SHOES
	EQUAL? PRSA,V?REMOVE,V?TAKE-OFF \FALSE
	FSET? WORK-SHOES,WORNBIT \?L1
	RETURN WORK-SHOES
?L1:	EQUAL? PRSA,V?REMOVE,V?TAKE-OFF \FALSE
	FSET? NORMAL-SHOES,WORNBIT \FALSE
	RETURN NORMAL-SHOES

	.FUNCT KNAPSACK-F
	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	PRINTR "The knapsack has a cover which can't be fastened, which is just as well, since you don't have to worry about opening or closing it."

	.FUNCT SHOES-F
	EQUAL? PRSA,V?CLEAN \?L1
	FSET? PRSO,MUNGEDBIT \?L3
	PRINTR "It's a good idea, but facilities around here are scarce."
?L3:	PRINTR "They'll do just fine as is."
?L1:	EQUAL? PRSA,V?EXAMINE \?L6
	EQUAL? PRSO,WORK-SHOES \?L7
	PRINTI "These shoes have rugged soles for traction; they're in good shape"
	JUMP ?L10
?L7:	EQUAL? PRSO,BOOTS \?L9
	PRINTI "The boots are about knee high, with fairly slick soles. They've seen better days, but at least they appear to be intact"
	JUMP ?L10
?L9:	PRINTI "They're just an ordinary "
	ICALL2 DPRINT,PRSO
?L10:	FSET? PRSO,MUNGEDBIT \?L11
	PRINTI ", though they're covered inside and out in swamp muck, which will slow you down a bit when you're wearing them"
?L11:	PRINT PERIOD-CR
	RTRUE
?L6:	EQUAL? PRSA,V?TAKE-OFF \?L14
	ZERO? IN-SWAMP? /?L15
	PRINTR "Not in the swamp, you won't!"
?L15:	ZERO? SHOES-WORN /?L17
	EQUAL? SHOES-WORN,PRSO /?L18
	PRINTR "You're not wearing those."
?L18:	PRINTI "You take off the "
	ICALL2 DPRINT,SHOES-WORN
	PRINTI " and put them on the ground."
	CRLF
	SET 'SHOES-WORN,0
	MOVE PRSO,HERE
	FCLEAR PRSO,WORNBIT
	RTRUE
?L17:	PRINTR "You're not wearing any shoes."
?L14:	EQUAL? PRSA,V?WEAR \FALSE
	EQUAL? SHOES-WORN,PRSO \?L23
	CALL1 TOO-LATE >STACK
	RSTACK
?L23:	ZERO? IN-SWAMP? /?L25
	PRINTR "Not in the swamp, you won't!"
?L25:	ZERO? SHOES-WORN /?L26
	PRINTI "You take off the "
	ICALL2 DPRINT,SHOES-WORN
	PRINTI ", put them on the ground, and put on the "
	ICALL2 DPRINT,PRSO
	PRINTI "."
	CRLF
	MOVE SHOES-WORN,HERE
	FCLEAR SHOES-WORN,WORNBIT
	SET 'SHOES-WORN,PRSO
	FSET SHOES-WORN,WORNBIT
	MOVE SHOES-WORN,WINNER
	RTRUE
?L26:	PRINTI "You put on the "
	ICALL2 DPRINT,PRSO
	PRINTI "."
	CRLF
	FSET PRSO,WORNBIT
	MOVE PRSO,WINNER
	SET 'SHOES-WORN,PRSO
	RETURN SHOES-WORN

	.FUNCT MISC-CLOTHING-F
	EQUAL? PRSA,V?EXAMINE,V?SEARCH \?L1
	PRINTI "There's nothing interesting in the clothes."
	CRLF
	CALL2 PRINT-ID,STR?255 >STACK
	RSTACK
?L1:	PRINTR "The clothing isn't of any interest."

	.FUNCT MISC-FURNITURE-F
	PRINTR "Never mind about the furniture. It's not important now."

	.FUNCT ROAD-END-F,RARG
	EQUAL? RARG,M-ENTER-DESC \?L1
	CALL1 CAR-SEQ-TELL >STACK
	RSTACK
?L1:	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You're now at the end of a road (fortunately, not THE road) which starts off to the south through the forest. Just north of here lies a small clearing and east of that, a wooden hut"
	ZERO? HUT-BURNING /?L4
	PRINTI ", which is engulfed in flame"
?L4:	PRINT PERIOD-CR
	ICALL1 CAR-SEQ-TELL
	RTRUE

	.FUNCT ROAD-ROOM-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You are standing on a piece of roadway that winds its way through the forest. At this point, the road "
	EQUAL? HERE,D6 \?L3
	PRINTR "bends, running to the south and east. In addition, a narrow spur leads north and out of sight."
?L3:	EQUAL? HERE,D7 \?L5
	PRINTR "runs north and south."
?L5:	EQUAL? HERE,D8,F5 \?L6
	PRINTR "bends, running to the north and southwest."
?L6:	EQUAL? HERE,E6 \?L7
	PRINTR "bends, running from west to northeast."
?L7:	PRINTR "bends, running from the south to the northeast."

	.FUNCT G4-SWAMP
	ICALL1 SWAMP-MOVE-TELL
	RETURN G4

	.FUNCT E7-SWAMP
	ICALL1 SWAMP-MOVE-TELL
	RETURN E7

	.FUNCT E8-SWAMP
	ICALL1 SWAMP-MOVE-TELL
	RETURN E8

	.FUNCT D9-SWAMP
	ICALL1 SWAMP-MOVE-TELL
	RETURN D9

	.FUNCT G5-SWAMP
	ICALL1 SWAMP-MOVE-TELL
	RETURN G5

	.FUNCT F6-SWAMP
	ICALL1 SWAMP-MOVE-TELL
	RETURN F6

	.FUNCT SWAMP-MOVE-TELL
	PRINTI "You continue along the edge of the swamp, your feet "
	ZERO? IN-SWAMP? /?L1
	PRINTI "sinking a foot or so into the mud"
	JUMP ?L3
?L1:	PRINTI "leaving deep prints in the sticky mud"
?L3:	PRINTI ". The air remains stench-laden, and you're eager to move quickly, but the ground is soft and progress slow."
	CRLF
	CRLF
	RTRUE

	.FUNCT SWAMP-ROOM-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You are standing "
	ZERO? IN-SWAMP? /?L3
	PRINTI "a few feet into the swamp, where the muck rises a foot up your leg."
	JUMP ?L5
?L3:	PRINTI "at the edge of a swamp."
?L5:	PRINTI " You could follow along the edge of the swamp to the "
	EQUAL? HERE,E7 \?L6
	PRINTI "south and northeast"
	JUMP ?L11
?L6:	EQUAL? HERE,E8,G5 \?L8
	PRINTI "north and southwest"
	JUMP ?L11
?L8:	EQUAL? HERE,D9 \?L9
	PRINTI "northeast"
	JUMP ?L11
?L9:	EQUAL? HERE,F6 \?L10
	PRINTI "southwest and northeast"
	JUMP ?L11
?L10:	PRINTI "south"
?L11:	PRINTI ". On the other hand, you could leave the swamp and walk onto the roadway by going "
	EQUAL? HERE,D9,E7,F6 \?L12
	PRINTI "west or north"
	JUMP ?L14
?L12:	PRINTI "west"
?L14:	PRINT PERIOD-CR
	RTRUE

	.FUNCT ROADBLOCK-F
	EQUAL? HERE,F4,G4 \?L1
	PRINTR "There's no roadblock here, but there is surely one lurking in the darkness nearby."
?L1:	CALL2 CANT-SEE,ROADBLOCK >STACK
	RSTACK

	.FUNCT SWAMP-MOVE
	ZERO? IN-SWAMP? \?L1
	PRINTI "You should simply enter the swamp, if that is indeed your intention."
	CRLF
	RFALSE
?L1:	PRINTI "You're as far into the swamp as you can go."
	CRLF
	RFALSE

	.FUNCT TRAIN-F
	EQUAL? SCENARIO,2 \?L1
	PRINTR "There's no train anywhere near here, as far as you can tell."
?L1:	EQUAL? SCENARIO,1 \FALSE
	FSET? HERE,PLATFORMBIT /FALSE
	EQUAL? PRSA,V?LEAVE,V?TAKE-OFF,V?DISEMBARK \?L4
	EQUAL? HERE,PASS-6 \?L6
	ICALL2 DO-WALK,P?SOUTH
	RTRUE
?L6:	PRINTR "You'll have to get to the exit, which is near the lavatory."
?L4:	EQUAL? PRSA,V?OFF-2,V?OFF \?L9
	PRINTR "You might try the cord, but that would be the only way."
?L9:	EQUAL? PRSA,V?LOOK-INSIDE \FALSE
	ICALL PERFORM,V?LOOK-INSIDE,PASS-WINDOW
	RTRUE

	.FUNCT FOREST-F
	EQUAL? PRSA,V?FIND \?L1
	PRINTR "You cannot see the forest for the trees."
?L1:	EQUAL? PRSA,V?SEARCH \?L3
	PRINTR "That would take hours or days; you've got seconds or minutes."
?L3:	EQUAL? PRSA,V?LEAVE,V?ENTER \FALSE
	PRINTR "You should use compass directions to do that."

	.FUNCT GLOBAL-HUT-F
	ZERO? BEEN-AT-HUT? \?L1
	PRINTR "You haven't seen any hut, but it would be a sight for sore eyes."
?L1:	EQUAL? PRSA,V?WALK-AROUND \?L3
	PRINTI "You can't see the hut from here, but the smoke in the sky tells you that it's off to the "
	ICALL TELL-DIRECTION,HERE,D5
	PRINTR ". As for walking around it, that's up to you."
?L3:	EQUAL? PRSA,V?FIND,V?WALK-TO \FALSE
	EQUAL? HERE,INSIDE-SHED \?L5
	PRINTR "Not from inside the shed."
?L5:	PRINTI "You can't see the hut, but the smoke in the sky is coming from the "
	ICALL TELL-DIRECTION,HERE,D5
	PRINTI ", so you start to walk in that direction."
	CRLF
	CRLF
	CALL RET-DIRECTION,HERE,D5 >STACK
	CALL2 DO-WALK,STACK >STACK
	RSTACK

	.FUNCT T-STATION-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "The border station, to the left of the three towers, consists of a guards' station and a train platform. The station itself is heavily guarded, so movement in that direction would be suicidal."
?L1:	PRINT TOO-FAR
	CRLF
	RTRUE

	.FUNCT GLOBAL-TUNNEL-F
	EQUAL? PRSA,V?WATCH,V?WALK-TO,V?EXAMINE \?L1
	EQUAL? HERE,C9 \?L3
	PRINTR "It's the tunnel you came through just before you jumped. It's a few miles long and very, very dark."
?L3:	CALL2 CANT-SEE,PRSO >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?FIND \?L6
	PRINTI "If memory serves, it should be off to the "
	ICALL TELL-DIRECTION,HERE,C9
	PRINT PERIOD-CR
	RTRUE
?L6:	PRINT TOO-FAR
	CRLF
	RTRUE

	.FUNCT GLOBAL-SNOW-F
	EQUAL? PRSA,V?LEAP \?L1
	PRINTR "This is no time for acrobatics."
?L1:	FSET? HERE,HUTBIT /?L4
	EQUAL? HERE,INSIDE-SHED \FALSE
?L4:	CALL2 CANT-SEE,PRSO >STACK
	RSTACK

	.FUNCT GLOBAL-TREES-F
	FSET? HERE,HUTBIT /?L3
	EQUAL? HERE,INSIDE-SHED \?L1
?L3:	PRINTR "There aren't any indoor trees here."
?L1:	EQUAL? PRSA,V?CUT \FALSE
	PRINTR "Chopping wood is an exhausting activity and won't help you."

	.FUNCT GLOBAL-BORDER-F
	EQUAL? PRSA,V?WALK-TO,V?FIND \?L1
	PRINTR "If memory serves, the border should be to the north."
?L1:	EQUAL? PRSA,V?EXAMINE \?L3
	PRINTR "It's just like any other military fortress border."
?L3:	CALL2 CANT-SEE,GLOBAL-BORDER >STACK
	RSTACK

	.FUNCT PLAT-FENCE-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "The fence is perhaps twenty feet tall, and virtually unscalable. It's a good thing you have a ticket."

	.FUNCT PLATFORM-MOVE-1
	CALL2 PLATFORM-MOVE,PLATFORM-1 >STACK
	RSTACK

	.FUNCT PLATFORM-MOVE-2
	CALL2 PLATFORM-MOVE,PLATFORM-2 >STACK
	RSTACK

	.FUNCT PLATFORM-MOVE-3
	CALL2 PLATFORM-MOVE,PLATFORM-3 >STACK
	RSTACK

	.FUNCT PLATFORM-MOVE-4
	CALL2 PLATFORM-MOVE,PLATFORM-4 >STACK
	RSTACK

	.FUNCT PLATFORM-MOVE,RM
	PRINTI "You walk slowly through the crowd"
	IN? CONTACT,HERE /?L1
	PRINTI ", eyes open but totally in the dark regarding the nature of your contact"
?L1:	PRINTI "."
	GRTR? SUSPICION,0 \?L4
	ZERO? FOLLOW-WARNING \?L15
	SET 'FOLLOW-WARNING,1
	PRINTI " It's probably nothing, but you could swear that a man you see behind you was also behind you before you started walking."
	JUMP ?L9
?L4:	ZERO? FOLLOW-WARNING /?L9
?L15:	ZERO? FOLLOW-SURE \?L9
	RANDOM 100 >STACK
	LESS? 40,STACK /?L7
	SET 'FOLLOW-SURE,1
	PRINTI " There he is again, ducking behind a group of tourists. It's all but certain you're being followed!"
	JUMP ?L9
?L7:	PRINTI " You nonchalantly look around, and are relieved that the man you saw earlier is no longer around."
?L9:	EQUAL? RM,PLATFORM-1 \?L11
	CRLF
	CRLF
	PRINTI "You've come to the northern end of the platform now, and you can see in the distance the darkness that is Litzenburg."
	JUMP ?L13
?L11:	EQUAL? RM,PLATFORM-4 \?L13
	CRLF
	CRLF
	PRINTI "You've arrived at the platform's southern end, and can look back into Frobnia, sighting its formidible border defenses: guard towers, searchlights, patrols, guard dogs - God knows what else. It's a whole lot better to have a ticket, and you smile, realizing that it's not easy this way either."
?L13:	CRLF
	SET 'DONT-DESCRIBE-ROOM,1
	RETURN RM

	.FUNCT PLATFORM-ROOM-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "The platform itself is the same size as the trains which cross the border here - four train-lengths - a hundred yards or so. The train you arrived on is standing here, each entrance door guarded so as to prevent passengers from reboarding until the train is ready to leave. Why? Don't ask."
	CRLF
	CRLF
	PRINTI "There are people everywhere, milling back and forth - men, women, even a few children. And then there are the guards, the ones you can see, and, more troublesome, the ones you can't."
	CRLF
	CRLF
	EQUAL? HERE,PLATFORM-1 \?L3
	PRINTR "Right now, you're standing at the northern end of the platform. Looking ahead, you can see the darkness that is Litzenburg at night. In just a few minutes, you hope to be there ... after making your contact."
?L3:	EQUAL? HERE,PLATFORM-2 \?L5
	PRINTR "You're now alongside the second car."
?L5:	EQUAL? HERE,PLATFORM-3 \?L6
	PRINTR "You're now alongside the third car."
?L6:	PRINTR "You're at the southern end of the platform. Looking back into Frobnia, you can start to make out the border defenses of Frobnia. Incredible. Guard towers. Searchlights. Patrols. Guard dogs. God knows what else. Better to have a ticket. You smile, thinking that even then it's not all that easy!"

	.FUNCT PLAT-GUARDS-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "There guards here are many and close between, to twist a phrase. They are all in uniform - well, you think so, in any case. Each is constantly looking about for whatever happens to be illegal on this particular day."
?L1:	CALL2 HURT?,PLAT-GUARDS >STACK
	ZERO? STACK /FALSE
	PRINTI "To what end? The jails are not known for their comfort or amenities."
	CRLF
	CALL2 PRINT-ID,STR?256 >STACK
	RSTACK

	.FUNCT PLAT-PEOPLE-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "There are quite a large number of people here on the platform - maybe a few hundred or more - men, women, children - and no idea of who your contact is to be."
?L1:	EQUAL? PRSA,V?SEARCH \FALSE
	PRINTR "You stare at the people in the crowd, but it's no use. You have no idea who the contact might be."

	.FUNCT GLOBAL-CONTACT-F
	EQUAL? SCENARIO,1,3 /?L1
	PRINTR "You must be thinking of another scenario."
?L1:	EQUAL? SCENARIO,3 \?L3
	EQUAL? PRSA,V?WHERE,V?FIND \FALSE
	PRINTR "Your contact is Riznik, the antique dealer. His business card clearly shows how to find him."
?L3:	IN? CONTACT,HERE \?L7
	EQUAL? PRSO,GLOBAL-CONTACT \?L8
	ICALL PERFORM,PRSA,CONTACT,PRSI
	RTRUE
?L8:	ICALL PERFORM,PRSA,PRSO,CONTACT
	RTRUE
?L7:	EQUAL? PRSA,V?WHERE,V?FIND \?L11
	PRINTR "You have almost nothing to go on, but in any event, the contact was supposed to find you at the station platform."
?L11:	PRINTR "You can't see your contact here, or if you can, you don't know it."

	.FUNCT GLOBAL-COMPARTMENT-F
	EQUAL? PRSA,V?WALK-TO,V?FIND \?L1
	EQUAL? HERE,COMP-5,PASS-5 \?L3
	PRINTR "Right here."
?L3:	PRINTR "It's the southmost compartment along the passageway."
?L1:	EQUAL? PRSA,V?ENTER \?L6
	EQUAL? HERE,PASS-5 \?L7
	ICALL2 DO-WALK,P?IN
	RTRUE
?L7:	EQUAL? HERE,COMP-5 \?L9
	PRINTR "Right here."
?L9:	EQUAL? HERE,PASS-2,PASS-3,PASS-4 /?L11
	EQUAL? HERE,PASS-1 \?L10
?L11:	ICALL2 DO-WALK,P?WEST
	RTRUE
?L10:	PRINT GET-THERE-FIRST
	CRLF
	RTRUE
?L6:	EQUAL? PRSA,V?DISEMBARK,V?LEAVE \?L13
	EQUAL? HERE,COMP-5 \?L14
	ICALL2 DO-WALK,P?OUT
	RTRUE
?L14:	PRINT GET-THERE-FIRST
	CRLF
	RTRUE
?L13:	EQUAL? PRSA,V?LOOK-INSIDE \?L17
	EQUAL? HERE,COMP-5 /?L17
	ICALL PERFORM,PRSA,COMP-N-DOOR
	RTRUE
?L17:	EQUAL? PRSA,V?EXAMINE \FALSE
	EQUAL? HERE,COMP-5 \?L19
	ICALL2 PERFORM,V?LOOK
	RTRUE
?L19:	PRINTR "It's easier from inside."

	.FUNCT COMP-5-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "This is your compartment on the train to Litzenburg. You were lucky enough to avoid having a roommate on this trip, so the two bench-style seats are more than enough. The compartment itself is quite simple - the two seats on either side, the openable window looking out over the nighttime landscape, the emergency stop cord, the luggage rack. It easily could be worse; this is the first-class car, after all. What little privacy exists on this train is in the form of a door to the east which is now "
	FSET? COMP-5-DOOR,OPENBIT \?L3
	PRINTI "open"
	JUMP ?L5
?L3:	PRINTI "closed"
?L5:	IN? COMP-BLOOD-STAIN,HERE \?L6
	PRINTI ". A blood stain is noticeable on the floor here, a grim reminder of the task that lies ahead"
?L6:	PRINT PERIOD-CR
	RTRUE
?L1:	EQUAL? RARG,M-ENTER \FALSE
	FCLEAR COMP-5-DOOR,OPENBIT
	RTRUE

	.FUNCT COMP-CORD-F
	EQUAL? PRSA,V?PULL \?L1
	PRINTR "You pull the cord, but nothing happens. This doesn't surprise you, considering the train itself."
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "It's just a piece of cord with a small wooden handle on the end."

	.FUNCT COMP-RACK-F
	EQUAL? PRSA,V?CLOSE,V?OPEN /?L3
	EQUAL? PRSA,V?EXAMINE \FALSE
	FIRST? PRSO >STACK /FALSE
?L3:	PRINTR "It's just an open rack at your eye-level."

	.FUNCT COMP-SEAT-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "The seats are simple wooden benches, with nothing to soften the ride. You are told that this is an improvement over second class, but it's difficult to imagine what this could mean."
	EQUAL? PRSO,COMP-SEAT-BACK \?L3
	PRINTI " Further inspection reveals a narrow space under the seat."
?L3:	FIRST? PRSO >STACK \?L6
	PRINTI " "
	ICALL PERFORM,V?LOOK-INSIDE,PRSO
	RTRUE
?L6:	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?BOARD,V?CLIMB-ON \?L9
	PRINTR "You've always thought better on your feet, and there's no better time to be thinking."
?L9:	EQUAL? PRSA,V?PUT-UNDER \?L10
	EQUAL? PRSI,COMP-SEAT-BACK \?L10
	EQUAL? PRSO,CAMERA-BAG,BRIEFCASE,CAMERA \?L11
	PRINTR "It's too bulky to fit."
?L11:	MOVE PRSO,UNDER-SEAT
	PRINTI "You slide the "
	ICALL2 DPRINT,PRSO
	PRINTR " under the rear-facing bench."
?L10:	EQUAL? PRSA,V?LOOK-UNDER \?L14
	EQUAL? PRSO,COMP-SEAT-FRONT \?L15
	PRINTR "The front-facing bench has no space underneath it; however, a quick look indicates that the rear bench has a narrow space underneath it."
?L15:	ICALL PERFORM,V?LOOK-INSIDE,UNDER-SEAT
	RTRUE
?L14:	EQUAL? PRSA,V?CRAWL-UNDER \?L18
	PRINTR "There's not enough room for you under the seat."
?L18:	EQUAL? PRSA,V?REACH-IN \FALSE
	EQUAL? PRSO,COMP-SEAT-BACK \FALSE
	PRINTI "You reach under the seat"
	FIRST? UNDER-SEAT >STACK /?L20
	PRINTR ", but come up empty."
?L20:	PRINTI " and pull out the "
	FIRST? UNDER-SEAT >STACK /?L23
?L23:	ICALL2 DPRINT,STACK
	PRINTI "."
	CRLF
	FIRST? UNDER-SEAT >STACK /?L24
?L24:	MOVE STACK,WINNER
	RTRUE

	.FUNCT COMP-WINDOW-F
	EQUAL? PRSA,V?CLEAN,V?LOOK-INSIDE \?L1
	ICALL PERFORM,PRSA,PASS-WINDOW
	RTRUE
?L1:	EQUAL? PRSA,V?ENTER,V?LEAP-OFF,V?DISEMBARK /?L4
	EQUAL? PRSA,V?EXIT \?L3
?L4:	PRINTI "Your situation is serious, but not desperate."
	CRLF
	CALL2 PRINT-ID,STR?257 >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?PUT,V?PUT-THROUGH \FALSE
	EQUAL? PRSI,COMP-WINDOW \FALSE
	CALL ULTIMATELY-IN?,PASSPORT,PRSO >STACK
	ZERO? STACK /?L6
	SET 'PRSO,PASSPORT
	JUMP ?L8
?L6:	CALL ULTIMATELY-IN?,TICKET,PRSO >STACK
	ZERO? STACK /?L8
	SET 'PRSO,TICKET
?L8:	LOC PRSO >STACK
	EQUAL? STACK,GLOBAL-OBJECTS,LOCAL-GLOBALS \?L10
	PRINTR "Funny."
?L10:	CALL ULTIMATELY-IN?,PRSO,WINNER >STACK
	ZERO? STACK \?L12
	PRINTR "You're not holding that."
?L12:	EQUAL? PRSO,PASSPORT,TICKET \?L13
	PRINTI "Without your "
	ICALL2 DPRINT,PRSO
	PRINTI ", you won't be leaving Frobnia for a good long time."
	CRLF
	CALL2 PRINT-ID,STR?258 >STACK
	RSTACK
?L13:	FSET? PRSI,OPENBIT \?L14
	ICALL2 REMOVE-TO-BOTTOM,PRSO
	PRINTI "The "
	ICALL2 DPRINT,PRSO
	PRINTI " goes through the window and out of your life."
	CRLF
	ICALL2 PRINT-ID,STR?259
	EQUAL? PRSO,DOCUMENT \FALSE
	PRINTI "[RWD_ID: bystander:435, VAL: 1]"
	RTRUE
?L14:	PRINTR "The window's closed. Surely you don't mean through the window!"

	.FUNCT PASS-WINDOW-F
	EQUAL? PRSA,V?CLEAN \?L1
	PRINTR "The windows are clean enough, at least by FNR standards."
?L1:	EQUAL? PRSA,V?MUNG,V?KICK \?L3
	PRINTI "With guards posted at either end of the car, and the level of tension high, you would only call attention to yourself."
	CRLF
	CALL2 PRINT-ID,STR?260 >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L4
	PRINTR "The windows along the passageway aren't openable."
?L4:	EQUAL? PRSA,V?LOOK-INSIDE \FALSE
	CALL2 RT-QUEUED?,I-BAD-BORDER >STACK
	ZERO? STACK /?L6
	PRINTR "The landscape is dark and bleak; this is the area just preceding the border checkpoint."
?L6:	ZERO? BAD-TUNNEL /?L8
	PRINTR "From the sound of it, you're in a tunnel, and a long one at that. There is only blackness punctuated by single trouble lights every ten seconds or so."
?L8:	CALL2 RT-QUEUED?,I-GORMNASH >STACK
	ZERO? STACK /?L9
	PRINTR "The train is sitting at the border station platform, which is crowded with people."
?L9:	PRINTR "The sky is dark now, but you can see the occasional lights of small villages here and there. You don't know exactly where you are, but you are getting near the border checkpoint."

	.FUNCT GLOBAL-BAD-SPY-F
	LOC BAD-SPY >STACK
	ZERO? STACK /?L1
	LOC BAD-SPY >STACK
	FSET? STACK,HUTBIT \?L1
	FSET? HERE,HUTBIT \?L1
	EQUAL? HERE,LAVATORY /?L1
	EQUAL? PRSI,GLOBAL-BAD-SPY \?L3
	EQUAL? PRSA,V?GIVE,V?SHOW \?L3
	EQUAL? PRSO,DOCUMENT,SHRED,SHREDS \?L5
	ICALL1 BAD-SPY-F
	RTRUE
?L5:	PRINTR "There's nothing to be gained by doing that."
?L3:	EQUAL? PRSA,V?LISTEN,V?BRIBE,V?PHOTOGRAPH /?L9
	EQUAL? PRSA,V?EXAMINE \?L8
?L9:	ICALL PERFORM,PRSA,BAD-SPY
	RTRUE
?L8:	EQUAL? PRSA,V?WATCH,V?FOLLOW \FALSE
	PRINTR "If you just stand around here, you'll be able to watch his movements. On the other hand, it might look suspicious to him."
?L1:	EQUAL? PRSA,V?FOLLOW \?L12
	PRINTR "You don't know where he is at the moment."
?L12:	EQUAL? PRSA,V?LISTEN,V?BRIBE,V?PHOTOGRAPH \?L13
	ICALL PERFORM,PRSA,BAD-SPY
	RTRUE
?L13:	CALL2 CANT-SEE,GLOBAL-BAD-SPY >STACK
	RSTACK

	.FUNCT PASS-F,RARG,BSL
	LOC BAD-SPY >BSL
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "You are standing in the passageway that runs along the length of the car. "
	ZERO? AT-STATION /?L3
	PRINTI "Just north of your compartment, a guard is standing. He is motioning you out of the train to the south."
	JUMP ?L5
?L3:	PRINTI "At either end of the passageway, a guard is standing, machine gun poised at his side."
?L5:	PRINTI " Right now, you're standing outside "
	EQUAL? HERE,PASS-5 \?L6
	PRINTI "your own compartment"
	JUMP ?L8
?L6:	PRINTI "the "
	GETP HERE,P?NS >STACK
	GET PASS-TELLS,STACK >STACK
	PRINT STACK
?L8:	PRINTI "."
	ZERO? BSL /?L9
	FSET? BSL,HUTBIT \?L9
	PRINTI " A man, wearing a trench coat, is "
	EQUAL? BSL,HERE \?L11
	PRINTI "also standing here"
	JUMP ?L14
?L11:	EQUAL? BSL,PASS-5 \?L13
	PRINTI "standing outside of your compartment, motioning for you to return"
	JUMP ?L14
?L13:	PRINTI "standing outside "
	PRINTI "the "
	GETP BSL,P?NS >STACK
	GET PASS-TELLS,STACK >STACK
	PRINT STACK
	PRINTI ", and talking to its occupants in rapid-fire Frobnian"
?L14:	PRINTI "."
?L9:	CRLF
	RTRUE
?L1:	EQUAL? RARG,M-ENTER \FALSE
	SET 'CURRENT-PASS,HERE
	RFALSE

	.FUNCT HST?
	IN? CAMERA,WINNER /TRUE
	IN? DOCUMENT,WINNER /TRUE
	IN? SHREDS,WINNER /TRUE
	IN? COLOR-ROLL,WINNER /TRUE
	IN? EXPOSED-ROLL,WINNER /TRUE
	RFALSE

	.FUNCT COMP-5-ENTER
	CALL2 SLOW-CLOCK-QUEUED?,I-BAD-WAITS >STACK
	ZERO? STACK \?L1
	CALL2 SLOW-CLOCK-QUEUED?,I-BAD-LAV-WAITS >STACK
	ZERO? STACK \?L1
	PRINTI "You enter your compartment, closing the door behind you"
	PRINT PERIOD-CR
?L1:	SET 'DONT-DESCRIBE-ROOM,1
	RETURN COMP-5

	.FUNCT COMP-MOVE
	FSET? COMP-N-DOOR,OPENBIT \?L1
	RETURN COMP-N
?L1:	IN? BAD-SPY,HERE \?L3
	PRINTI "It would be not only rude, but suspicious, for you to enter now."
	CRLF
	ICALL2 PRINT-ID,STR?261
	RFALSE
?L3:	PRINTI "The door to that compartment is closed."
	CRLF
	RFALSE

	.FUNCT LAVATORY-MOVE
	FSET? LAVATORY-DOOR,OPENBIT \?L1
	PRINTI "You"
	JUMP ?L3
?L1:	FSET LAVATORY-DOOR,OPENBIT
	PRINTI "You open the door, then"
?L3:	PRINTI " enter the lavatory. "
	ICALL2 LAVATORY-F,M-LOOK
	SET 'DONT-DESCRIBE-ROOM,1
	RETURN LAVATORY

	.FUNCT PASS-MOVE-1
	CALL2 PASS-MOVE,PASS-1 >STACK
	RSTACK

	.FUNCT PASS-MOVE-2
	CALL2 PASS-MOVE,PASS-2 >STACK
	RSTACK

	.FUNCT PASS-MOVE-3
	CALL2 PASS-MOVE,PASS-3 >STACK
	RSTACK

	.FUNCT PASS-MOVE-4
	CALL2 PASS-MOVE,PASS-4 >STACK
	RSTACK

	.FUNCT PASS-MOVE-5
	CALL2 PASS-MOVE,PASS-5 >STACK
	RSTACK

	.FUNCT PASS-MOVE-6
	CALL2 PASS-MOVE,PASS-6 >STACK
	RSTACK

	.FUNCT PASS-MOVE,WHR,NFP,BSL
	ASSIGNED? 'NFP /?L26
	SET 'NFP,0
?L26:	LOC BAD-SPY >BSL
	ZERO? NFP \?L1
	PRINTI "You move along the passageway until you come to "
	EQUAL? WHR,PASS-5 \?L3
	PRINTI "your own compartment"
	JUMP ?L5
?L3:	PRINTI "the "
	GETP WHR,P?NS >STACK
	GET PASS-TELLS,STACK >STACK
	PRINT STACK
?L5:	PRINTI "."
?L1:	ZERO? AT-STATION /?L7
	PRINTI " Just north of your position, a guard is standing. He is motioning you out of the train to the south."
?L7:	ZERO? GUARD-NOTICE-FLAG \?L10
	PRINTI " You scan the passageway, noting guards at either end, machine guns poised at their sides. You don't remember them from the beginning of the trip, so you can only suppose that security has been tightened in the search for the American agent."
	SET 'GUARD-NOTICE-FLAG,1
?L10:	ZERO? BSL /?L13
	FSET? BSL,HUTBIT \?L13
	CRLF
	CRLF
	ZERO? BAD-SPY-SEEN /?L15
	PRINTI "The man in the coat"
	JUMP ?L17
?L15:	PRINTI "Another man, wearing a trench coat,"
?L17:	PRINTI " is "
	EQUAL? BAD-SPY-SEEN,BSL \?L18
	PRINTI "still "
?L18:	SET 'BAD-SPY-SEEN,BSL
	EQUAL? BSL,WHR \?L21
	PRINTI "standing here"
	JUMP ?L24
?L21:	EQUAL? BSL,PASS-5 \?L23
	PRINTI "standing outside of your compartment, motioning for you to return"
	JUMP ?L24
?L23:	PRINTI "standing outside "
	PRINTI "the "
	GETP BSL,P?NS >STACK
	GET PASS-TELLS,STACK >STACK
	PRINT STACK
	PRINTI ", and talking to its occupants in rapid-fire Frobnian"
?L24:	ICALL HST-CHECK,BSL,WHR
	PRINTI "."
?L13:	ICALL1 DOC-CHECK
	CRLF
	SET 'DONT-DESCRIBE-ROOM,1
	RETURN WHR

	.FUNCT DOC-CHECK
	IN? BAD-SPY,HERE \FALSE
	IN? DOCUMENT,WINNER \FALSE
	CRLF
	CRLF
	REMOVE DOCUMENT
	FSET DOCUMENT,PENBIT
	PRINTI "He looks again, this time directly at the document. ""Ah, thank you very much for returning this document,"" he says. He takes it from you and regards you with contempt. ""We may need to talk more about this later."" And with this, he returns to his conversation with the other passengers."
	INC 'SUSPICION
	RETURN SUSPICION

	.FUNCT HST-CHECK,BSL,WHR,STR
	ASSIGNED? 'STR /?L7
	SET 'STR,0
?L7:	ZERO? STR \?L1
	SET 'STR,STR?262
?L1:	CALL1 HST? >STACK
	ZERO? STACK /FALSE
	ZERO? HST-FLAG \FALSE
	GETP WHR,P?NS >STACK
	GETP BSL,P?NS >STACK
	SUB STACK,STACK >STACK
	CALL2 ABS,STACK >STACK
	LESS? STACK,3 \FALSE
	PRINT STR
	SET 'HST-FLAG,1
	INC 'SUSPICION
	RETURN SUSPICION

	.FUNCT LAVATORY-EXIT
	CALL COMP-EXIT,LAVATORY-DOOR,PASS-6 >STACK
	RSTACK

	.FUNCT COMP-EXIT,DOOR,PASS
	ASSIGNED? 'DOOR /?L7
	SET 'DOOR,COMP-5-DOOR
?L7:	ASSIGNED? 'PASS /?L8
	SET 'PASS,PASS-5
?L8:	FSET? DOOR,OPENBIT /?L1
	EQUAL? DOOR,COMP-5-DOOR \?L3
	FSET DOOR,OPENBIT
?L3:	PRINTI "You open the door and"
	JUMP ?L6
?L1:	PRINTI "You"
?L6:	PRINTI " walk out into the passageway."
	CALL PASS-MOVE,PASS,1 >STACK
	RSTACK

	.FUNCT COMP-N-F,RARG
	EQUAL? RARG,M-ENTER \FALSE
	GETP CURRENT-PASS,P?EJECT >STACK
	PRINT STACK
	CRLF
	FCLEAR COMP-N-DOOR,OPENBIT
	ICALL GOTO,CURRENT-PASS,0
	RTRUE

	.FUNCT COMP-N-DOOR-F
	EQUAL? PRSA,V?CLOSE,V?OPEN \?L1
	IN? BAD-SPY,HERE \?L1
	PRINTI "That would be terribly rude."
	CRLF
	CALL2 PRINT-ID,STR?263 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE,V?LOOK-INSIDE \FALSE
	IN? BAD-SPY,HERE \?L4
	PRINTR "The man in the coat is talking to the passengers inside; you can't tell much about them from here, and it would be rude to force yourself into the doorway."
?L4:	FSET? PRSO,OPENBIT \FALSE
	PRINTR "You might as well just go in and find out..."

	.FUNCT LAVATORY-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTR "Like most facilities here, it is rather primitive. There is a flush toilet, naturally, and a sink with a mirror above it. Conveniently located alongside the sink is a paper towel dispenser - inconveniently, there is no place to put the paper towels once used. A small, grimy window looks out over the darkened landscape."

	.FUNCT LAV-TOILET-F
	EQUAL? PRSA,V?USE \?L1
	ICALL PERFORM,PRSA,GLOBAL-LAVATORY
	RTRUE
?L1:	EQUAL? PRSA,V?BOARD,V?CLIMB-ON \?L3
	PRINTR "You aren't in need of the facilities at the moment."
?L3:	EQUAL? PRSA,V?PUT \?L5
	EQUAL? PRSI,LAV-TOILET \?L4
	GETP PRSO,P?SIZE >STACK
	GRTR? STACK,5 \?L4
	PRINTI "That's not the sort of thing one puts in the toilet."
	CRLF
	CALL2 PRINT-ID,STR?264 >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?PUT \?L5
	EQUAL? PRSI,LAV-TOILET \?L5
	EQUAL? PRSO,PAPER-TOWEL \?L5
	PRINTI "The paper towel drops into the toilet."
	CRLF
	REMOVE PAPER-TOWEL
	ICALL2 THIS-IS-IT,WET-PAPER-TOWEL
	MOVE WET-PAPER-TOWEL,LAV-TOILET
	RTRUE
?L5:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L6
	PRINTR "You can't open and close the toilet; there's no lid, and how very typical."
?L6:	EQUAL? PRSA,V?LOOK-INSIDE,V?SEARCH \?L7
	IN? SHRED,LAV-TOILET \?L7
	NEXT? SHRED >STACK /?L7
	FSET? SHRED,TOUCHBIT /?L7
	PRINTR "You see a small shred of the document floating in the toilet."
?L7:	EQUAL? PRSA,V?MOVE,V?FLUSH \FALSE
	PRINTI "With an all too loud whooshing sound, the toilet flushes."
	IN? DOCUMENT,LAV-TOILET /?L11
	IN? SHREDS,LAV-TOILET \?L9
?L11:	ICALL RANDOM-QUEUE,I-SHRED,25
?L9:	ICALL DOWN-THE-DRAIN,LAV-TOILET,6
	CRLF
	RTRUE

	.FUNCT I-SHRED
	MOVE SHRED,LAV-TOILET
	ICALL1 DE-RANDOM-QUEUE
	RFALSE

	.FUNCT DOWN-THE-DRAIN,OBJ,SIZE,OFF,F,N
	ASSIGNED? 'SIZE /?L20
	SET 'SIZE,2
?L20:	SET 'OFF,0
	FIRST? OBJ >F /?L4
	JUMP ?L3
?L1:	ZERO? F /?L3
?L4:	NEXT? F >N /?L7
?L7:	GETP F,P?SIZE >STACK
	LESS? STACK,SIZE \?L8
	EQUAL? F,TICKET,PASSPORT /?L8
	REMOVE F
	INC 'OFF
	PUT DRAIN-TBL,OFF,F
?L8:	SET 'F,N
	JUMP ?L1
?L3:	ZERO? OFF /FALSE
	PRINTI " Down the drain, along with the water, goes the "
?L13:	GET DRAIN-TBL,OFF >STACK
	ICALL2 DPRINT,STACK
	DLESS? 'OFF,1 /?L14
	EQUAL? OFF,1 \?L17
	PRINTI ", and "
	JUMP ?L13
?L17:	PRINTI ", "
	JUMP ?L13
?L14:	PRINTI "."
	RTRUE

	.FUNCT GLOBAL-LAVATORY-F
	EQUAL? PRSA,V?FIND,V?WALK-TO,V?ENTER \?L1
	EQUAL? HERE,PASS-6 \?L3
	ICALL2 DO-WALK,P?IN
	RTRUE
?L3:	EQUAL? HERE,LAVATORY \?L5
	PRINTR "There is no other..."
?L5:	PRINTR "The lavatory, as you recall, is at the south end of the passageway."
?L1:	EQUAL? PRSA,V?USE \?L7
	EQUAL? HERE,LAVATORY \?L8
	PRINTR "You have no need of it now, and a good thing too. Just looking at the fixtures is likely to cause disease."
?L8:	PRINT GET-THERE-FIRST
	CRLF
	RTRUE
?L7:	EQUAL? PRSA,V?EXAMINE \?L11
	EQUAL? HERE,LAVATORY \?L12
	ICALL2 PERFORM,V?LOOK
	RTRUE
?L12:	PRINTR "You should go there first."
?L11:	EQUAL? PRSA,V?LEAVE \FALSE
	EQUAL? HERE,LAVATORY \?L16
	ICALL2 DO-WALK,P?OUT
	RTRUE
?L16:	PRINTR "You're not there!"

	.FUNCT BRIEFCASE-F
	EQUAL? PRSA,V?TAKE \FALSE
	EQUAL? PRSO,BRIEFCASE \FALSE
	FSET? PRSO,OPENBIT \FALSE
	PRINTR "You'd best close the briefcase first."

	.FUNCT CAMERA-F,FILM,SHOT
	FIRST? CAMERA >FILM /?L1
?L1:	EQUAL? PRSA,V?EXAMINE \?L2
	PRINTI "It's a Pentax 35-mm SLR camera; you could have done better, but the dollar's not been so good, and getting Japanese goods here is difficult at best. Right now, it's "
	ZERO? FILM \?L4
	PRINTI "not loaded with any film"
	JUMP ?L9
?L4:	FSET? FILM,FILMBIT /?L6
	PRINTI "got a "
	ICALL2 DPRINT,FILM
	PRINTI " inside"
	JUMP ?L9
?L6:	GETP FILM,P?SHOT >SHOT
	ZERO? SHOT \?L7
	PRINTI "got a "
	ICALL2 DPRINT,FILM
	PRINTI " inside that's ready to be loaded"
	JUMP ?L9
?L7:	LESS? SHOT,0 \?L8
	PRINTI "got a rewound "
	ICALL2 DPRINT,FILM
	PRINTI " inside"
	JUMP ?L9
?L8:	PRINTI "loaded with a "
	ICALL2 DPRINT,FILM
?L9:	PRINTI ". "
	FSET? CAMERA,OPENBIT \?L10
	PRINTR "The back of the camera is open."
?L10:	ZERO? FILM /?L13
	FSET? FILM,FILMBIT \?L12
	GETP FILM,P?SHOT >STACK
	EQUAL? STACK,-1 \?L12
	PRINTR "The gizmo on top says that the film inside is rewound."
?L12:	ZERO? FILM /?L13
	FSET? FILM,FILMBIT \?L13
	PRINTI "According to the gizmo on top, you're currently at picture number "
	GETP FILM,P?SHOT >STACK
	PRINTN STACK
	PRINTI " of a roll of 24."
?L13:	CRLF
	RTRUE
?L2:	EQUAL? PRSA,V?PUT \?L15
	EQUAL? PRSI,CAMERA \?L15
	FSET? CAMERA,OPENBIT /?L16
	PRINTR "The camera's not open."
?L16:	ZERO? FILM /?L18
	PRINTR "There's already something there."
?L18:	GETP PRSO,P?SIZE >STACK
	GRTR? STACK,5 \?L19
	PRINTR "That won't fit in the camera."
?L19:	PRINTI "The "
	ICALL2 DPRINT,PRSO
	PRINTI " is now resting in the camera."
	CRLF
	MOVE PRSO,PRSI
	RTRUE
?L15:	EQUAL? PRSA,V?OPEN \?L21
	FSET? CAMERA,OPENBIT \?L22
	CALL1 TOO-LATE >STACK
	RSTACK
?L22:	FSET CAMERA,OPENBIT
	PRINTI "The camera is now opened."
	ZERO? FILM /?L25
	FSET? FILM,FILMBIT \?L25
	GETP FILM,P?SHOT >STACK
	EQUAL? STACK,-1,0 /?L25
	EQUAL? FILM,COLOR-ROLL \?L27
	SET 'FILM-RUINED,1
?L27:	PUTP FILM,P?SHOT,-1
	PRINTI " Sadly, the film was not rewound, so some of your photos have probably been destroyed. It's too late now, but you rewind the roll anyway."
	ICALL2 PRINT-ID,STR?265
?L25:	CRLF
	RTRUE
?L21:	EQUAL? PRSA,V?CLOSE \?L31
	FSET? CAMERA,OPENBIT \?L32
	FCLEAR CAMERA,OPENBIT
	PRINTR "The camera is now closed."
?L32:	CALL1 TOO-LATE >STACK
	RSTACK
?L31:	EQUAL? PRSA,V?LOAD \?L35
	ZERO? FILM \?L44
	ZERO? PRSI /?L38
	FSET? PRSI,FILMBIT \?L38
	ICALL PERFORM,V?PUT,PRSI,PRSO
	FIRST? CAMERA >FILM \TRUE
	EQUAL? FILM,PRSI /?L44
	RTRUE
?L38:	PRINTR "In order to properly load the film into the camera's winding mechanism, you must first put the film in the camera."
?L44:	FSET? FILM,FILMBIT /?L46
	PRINTI "Not likely, with the "
	ICALL2 DPRINT,FILM
	PRINTR " sitting in there."
?L46:	ZERO? PRSI /?L48
	EQUAL? FILM,PRSI /?L48
	PRINTR "There's another roll already in there."
?L48:	GETP FILM,P?SHOT >SHOT
	LESS? SHOT,0 \?L49
	PRINTR "The film has been rewound back into the spool; there's no way to load it onto the winding mechanism now."
?L49:	GRTR? FILM,0 \TRUE
	PRINTR "It's already loaded properly."
?L35:	EQUAL? PRSA,V?REWIND \FALSE
	ZERO? FILM /?L55
	FSET? FILM,FILMBIT /?L53
?L55:	PRINTR "There's no film in the camera."
?L53:	GETP FILM,P?SHOT >FILM
	GRTR? FILM,1 /?L56
	PRINTR "The film in the camera isn't loaded."
?L56:	FIRST? CAMERA >STACK /?L58
?L58:	PUTP STACK,P?SHOT,-1
	PRINTR "The film in the camera is now rewound."

	.FUNCT COLOR-ROLL-F
	EQUAL? PRSA,V?LOAD \?L1
	ZERO? PRSI \?L1
	ICALL PERFORM,V?LOAD,CAMERA,PRSO
	RTRUE
?L1:	EQUAL? PRSA,V?BEND \?L3
	ICALL PERFORM,PRSA,EXPOSED-ROLL
	RTRUE
?L3:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L4
	PRINTR "Not a chance."
?L4:	EQUAL? PRSA,V?REWIND \FALSE
	CALL1 REWIND-FILM >STACK
	RSTACK

	.FUNCT PHONY-FILM-F,F
	EQUAL? PRSA,V?TAKE \?L3
	EQUAL? PRSO,PHONY-FILM \?L1
	EQUAL? PRSI,COLOR-ROLL,EXPOSED-ROLL \?L1
	PRINTR "You can't remove the film from the roll it's on."
?L1:	EQUAL? PRSA,V?TAKE \?L3
	EQUAL? PRSI,CAMERA \?L3
	FSET? CAMERA,OPENBIT /?L4
	PRINTR "The camera's closed."
?L4:	FIRST? CAMERA >F \?L7
	FSET? F,FILMBIT /?L6
?L7:	PRINTR "There's no film in the camera."
?L6:	ICALL PERFORM,V?TAKE,F
	RTRUE
?L3:	PRINTR "There's no film there."

	.FUNCT GENERIC-FILM,F
	EQUAL? PRSA,V?REWIND \?L1
	RETURN CAMERA
?L1:	EQUAL? PRSA,V?TAKE \FALSE
	EQUAL? P-NCN,2 \FALSE
	RETURN PHONY-FILM

	.FUNCT EXPOSED-ROLL-F
	EQUAL? PRSA,V?CLOSE,V?OPEN \?L1
	PRINTR "Don't be ridiculous."
?L1:	EQUAL? PRSA,V?LOAD \?L3
	ZERO? PRSI \?L3
	ICALL PERFORM,V?LOAD,CAMERA,PRSO
	RTRUE
?L3:	EQUAL? PRSA,V?BEND \?L4
	PRINTR "You can't pull the film out of the roll."
?L4:	EQUAL? PRSA,V?EXAMINE \?L5
	PRINTR "The exposed roll has been rewound into the spool. If your memory serves, it contains pictures of your last family outing at Lake Gurthark. Why you didn't have it developed months ago is a mystery to you."
?L5:	EQUAL? PRSA,V?REWIND \FALSE
	CALL1 REWIND-FILM >STACK
	RSTACK

	.FUNCT REWIND-FILM
	IN? CAMERA,WINNER /?L1
	PRINTR "It's a lot easier if you're holding the camera."
?L1:	FIRST? CAMERA >STACK /?L3
	PRINTR "There's no film in the camera."
?L3:	ICALL PERFORM,V?REWIND,CAMERA
	RTRUE

	.FUNCT GLOBAL-FILM-F
	EQUAL? SCENARIO,1 \?L1
	EQUAL? PRSA,V?REWIND \?L1
	ICALL1 REWIND-FILM
	RTRUE
?L1:	PRINTR "You can't see any such film here."

	.FUNCT TOOTHBRUSH-F
	EQUAL? PRSA,V?USE,V?EXAMINE \FALSE
	PRINTR "You brought the toothbrush along, but you forgot the toothpaste, making the device utterly worthless."

	.FUNCT TEETH-F
	EQUAL? PRSA,V?CLEAN \FALSE
	PRINTR "A nice idea, but not very helpful."

	.FUNCT BYSTANDER-WATCH-F
	EQUAL? PRSA,V?TAKE-OFF,V?DROP \?L1
	PRINTR "If you're to make your connections, you shouldn't be without it."
?L1:	EQUAL? PRSA,V?EXAMINE \?L3
	PRINTR "It's a Timex, and not a particularly nice one at that."
?L3:	EQUAL? PRSA,V?READ \FALSE
	PRINTR "You can read the time on your status line."

	.FUNCT TWEEZERS-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "They're your ordinary pair of tweezers. You don't know why you keep it in your toilet kit, since you never use it."

	.FUNCT PICTURE-F
	EQUAL? PRSA,V?TAKE \FALSE
	PRINTR "You'll have to say what you want to photograph."

	.FUNCT TAKE-A-PICTURE,FILM,SHOT
	FSET? CAMERA,OPENBIT \?L1
	PRINTR "But the back of the camera is open!"
?L1:	FIRST? CAMERA >FILM /?L3
	PRINTR "There's no film in the camera, or hadn't you noticed?"
?L3:	FSET? FILM,FILMBIT /?L4
	PRINTR "There's something in the camera, but it sure isn't film."
?L4:	GETP FILM,P?SHOT >SHOT
	EQUAL? SHOT,-1 \?L5
	PRINTR "The camera's shutter makes a clicking noise, but nothing else happens; the film is rewound."
?L5:	ZERO? SHOT \?L6
	PRINTR "The film's in the camera, all right, but it's not loaded."
?L6:	EQUAL? SHOT,25 \?L7
	PRINTR "Nothing happens; it appears you've taken your last shot on this roll."
?L7:	INC 'SHOT
	PUTP FILM,P?SHOT,SHOT
	SUB SHOT,24 >STACK
	GETP FILM,P?PHOTO >STACK
	PUT STACK,STACK,PRSO
	PRINTI "You take the picture of "
	ICALL1 THE-PRINT-PRSO
	PRINTI ". The film is automatically advanced to frame number "
	PRINTN SHOT
	PRINT PERIOD-CR
	EQUAL? PRSO,DOCUMENT \FALSE
	PRINTI "[RWD_ID: bystander:1368, VAL: 1]"
	RTRUE

	.FUNCT BYSTANDER-CLOTHES-F
	EQUAL? PRSA,V?REMOVE,V?TAKE-OFF \?L1
	PRINTI "This would be highly inappropriate."
	CRLF
	IN? ME,LAVATORY /?L3
	PUSH 1
	JUMP ?L4
?L3:	PUSH 0
?L4:	CALL PRINT-ID,STR?266,STACK >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L5
	EQUAL? SCENARIO,1 \?L6
	PRINTI "You are looking rather dapper in your business suit."
	JUMP ?L8
?L6:	PRINTI "You're doing your best to look nondescript in your trench coat."
	CRLF
?L8:	IN? CARNATION,PRSO \?L9
	EQUAL? SCENARIO,1 \?L9
	PRINTI " A white carnation adorns your jacket's lapel."
?L9:	CRLF
	RTRUE
?L5:	EQUAL? PRSA,V?LOOK-INSIDE \?L12
	PRINTR "There's nothing in your clothes that can help you."
?L12:	EQUAL? PRSA,V?RIP \FALSE
	PRINTI "Why on earth should you damage your rather expensive outfit?"
	CRLF
	CALL2 PRINT-ID,STR?267 >STACK
	RSTACK

	.FUNCT CARNATION-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "It's a sad looking carnation, though it is arguably in better shape than its previous owner."
?L1:	EQUAL? PRSA,V?TAKE-OFF \?L3
	IN? PRSO,BYSTANDER-CLOTHES \?L3
	MOVE PRSO,WINNER
	FCLEAR PRSO,WORNBIT
	PRINTR "You take off the carnation. It is a sorry sight."
?L3:	EQUAL? PRSA,V?WEAR \FALSE
	FSET? PRSO,WORNBIT /FALSE
	MOVE PRSO,BYSTANDER-CLOTHES
	FSET PRSO,WORNBIT
	PRINTR "You put the rumpled carnation through the hole in your lapel. Except for the contact, you can only pray that nobody notices."

	.FUNCT BAD-SPY-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "He is a rather large man, though unassuming in appearance. He wears an off-white trench coat and a hat and talks with a beautiful, resonant voice. In all, he doesn't appear very formidable, but your intuition tells you that he is a very high-level official - in what agency, you could never know."
?L1:	EQUAL? PRSA,V?BRIBE \?L3
	PRINTI "It's too risky; you'd probably end up in jail."
	CRLF
	CALL2 PRINT-ID,STR?268 >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?SHOW,V?GIVE \?L4
	EQUAL? PRSO,SHRED,SHREDS,DOCUMENT \?L4
	PRINTI "Even in a text-only game, that would be stupid beyond words."
	CRLF
	CALL2 PRINT-ID,STR?269 >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?GIVE \?L5
	EQUAL? PRSI,BAD-SPY \?L5
	PRINTR "He waves you away with his hand."
?L5:	EQUAL? PRSA,V?PHOTOGRAPH \?L6
	PRINTI "Seeing what you are about to do, he turns to you, and speaks harshly. ""This is not permitted."" You decide against taking the picture."
	CRLF
	INC 'SUSPICION
	RETURN SUSPICION
?L6:	EQUAL? PRSA,V?LISTEN \FALSE
	PRINTR "You know little Frobnian, and he is speaking very quickly."

	.FUNCT I-BAD-SPY,SM,?TMP
	INC 'BAD-SPY-COUNT
	MOD BAD-SPY-COUNT,6 >STACK
	ZERO? STACK \FALSE
	DIV BAD-SPY-COUNT,6 >SM
	LESS? SM,7 \FALSE
	GET BAD-SPY-MOVES,SM >SM
	MOVE BAD-SPY,SM
	FSET? HERE,HUTBIT \?L3
	HLIGHT H-BOLD
	CRLF
	EQUAL? SM,PASS-1 \?L5
	SET 'BAD-SPY-SEEN,1
	PRINTI "You watch as a man in a trench coat enters your car to the north. He "
	FSET? COMP-N-DOOR,OPENBIT /?L7
	PRINTI "opens the door to the first compartment, and "
?L7:	PRINTI "begins to speak to the occupants, though you can't make out a word."
	JUMP ?L15
?L5:	EQUAL? SM,PASS-5,PASS-6 \?L10
	EQUAL? SM,PASS-5 \?L11
	PRINTI "The man arrives at your compartment and sees that nobody is inside. After a moment, he looks in your direction"
	JUMP ?L13
?L11:	PRINTI "The man walks up to you,"
?L13:	PRINTI " and speaks to you in a beautifully deep voice with a heavily Russian accent. ""Please return now to your compartment."""
	GETP HERE,P?NS >STACK
	LOC BAD-SPY >STACK
	GETP STACK,P?NS >STACK
	SUB STACK,STACK >STACK
	CALL2 ABS,STACK >BAD-DISTANCE
	ICALL SLOW-CLOCK-QUEUE,I-BAD-WAITS,20
	JUMP ?L15
?L10:	EQUAL? HERE,SM \?L14
	PRINTI "The man politely thanks the people in the next compartment, closes their door, and moves to where you are standing. He looks you over briefly, then proceeds to speak to the occupants in what you realize to be Frobnian; sadly, you don't understand enough to make sense of his speech."
	JUMP ?L15
?L14:	PRINTI "The man in the trench coat tips his hat at the occupants of the compartment, shuts the door, and moves to the next compartment, where he opens the door and starts to converse. He's now "
	SET '?TMP,SMALL-NUMS-TBL
	GETP HERE,P?NS >STACK
	GETP SM,P?NS >STACK
	SUB STACK,STACK >STACK
	CALL2 ABS,STACK >STACK
	GET ?TMP,STACK >STACK
	PRINT STACK
	PRINTI " away from you."
?L15:	ICALL HST-CHECK,SM,HERE,STR?270
	ICALL1 DOC-CHECK
	HLIGHT H-NORMAL
	CRLF
	RTRUE
?L3:	EQUAL? SM,PASS-6 \?L16
	EQUAL? HERE,LAVATORY \?L16
	ICALL SLOW-CLOCK-QUEUE,I-BAD-LAV-WAITS,20
	CALL2 BOLDTELL,STR?271 >STACK
	RSTACK
?L16:	EQUAL? SM,PASS-5,PASS-6 \FALSE
	EQUAL? HERE,COMP-5 \FALSE
	ICALL1 DE-SLOW-CLOCK-QUEUE
	ICALL2 BOLDTELL,STR?272
	ICALL1 BAD-INTERVIEW
	ZERO? PRSA \TRUE
	SET 'READ-INTERRUPTED,1
	RTRUE

	.FUNCT BAD-INTERVIEW,FORCE?
	ASSIGNED? 'FORCE? /?L36
	SET 'FORCE?,0
?L36:	ICALL1 DE-SLOW-CLOCK-QUEUE
	SET 'BAD-INTERVIEW-FLAG,1
	CRLF
	PRINTI "He speaks beautiful, correct English, though his accent is rather thick. ""I am so sorry to "
	ZERO? FORCE? /?L1
	PRINTI "well, shall I say 'insist'"
	JUMP ?L3
?L1:	PRINTI "intrude"
?L3:	PRINTI ", but I was hoping you could be of some assistance."" His eyes dart around the room as he speaks, taking in everything. Then, his gaze settles on you - his searching eyes take you in from top to bottom"
	FSET? CARNATION,WORNBIT \?L4
	FSET CARNATION,HUTBIT
	INC 'SUSPICION
	PRINTI ", and you imagine that he is frowning slightly, as if slightly confused."
	JUMP ?L6
?L4:	PRINTI "."
?L6:	IN? CAMERA,WINNER \?L7
	PRINTI " He looks at the camera, and raises an eyebrow. ""You are taking pictures? I hope you are using fast film."""
	INC 'SUSPICION
?L7:	IN? STAINED-PAPER-TOWEL,WINNER \?L10
	INC 'SUSPICION
	PRINTI " He then stares for a moment at the blood-stained towel in your hand, then smiles and looks you in the eye."
?L10:	CRLF
	CALL2 BAD-SEARCH,WINNER >STACK
	ZERO? STACK \TRUE
	CALL2 BAD-SEARCH,HERE >STACK
	ZERO? STACK \TRUE
	CALL2 BAD-SEARCH,COMP-SEAT-FRONT >STACK
	ZERO? STACK \TRUE
	CALL2 BAD-SEARCH,COMP-SEAT-BACK >STACK
	ZERO? STACK \TRUE
	CRLF
	PRINTI "He casually takes a cigarette and a book of matches from his pocket and attempts to light a match, giving up after the fourth try. He smiles good-naturedly, and says, ""I should be giving these up anyway."" He returns them to his pocket and continues."
	CRLF
	CRLF
	PRINTI """I will come to the point. We are looking for "
	FSET? DOCUMENT,PENBIT \?L17
	PRINTI "the man who gave you the document. Perhaps you have seen where he has gone?"" He eyes you suspiciously, but you are relieved to be able to answer him honestly - you have no idea where he's gone."
	JUMP ?L19
?L17:	PRINTI "a man - tall, slight, a bit disheveled - hurt, perhaps. We believe he may have come this way, and we have need to find him, for his own safety."" He smiles wanly. ""Have you seen such a man?"""
?L19:	CRLF
	CRLF
	FSET? DOCUMENT,PENBIT /?L32
	CALL2 YES?,BAD-SPY >STACK
	ZERO? STACK /?L22
	CRLF
	IN? COMP-BLOOD-STAIN,HERE /?L25
	IN? STAINED-PAPER-TOWEL,WINNER \?L23
?L25:	PRINT BAD-YES-START
	CRLF
	CRLF
	INC 'SUSPICION
	JUMP ?L32
?L23:	PRINT BAD-YES-START
	PRINTI " The man pauses for a moment, then looks around furtively, but unmistakably, as if he had misplaced something."
	CRLF
	CRLF
	ADD SUSPICION,2 >SUSPICION
	JUMP ?L32
?L22:	IN? COMP-BLOOD-STAIN,HERE /?L28
	IN? STAINED-PAPER-TOWEL,WINNER \?L27
?L28:	CRLF
	PRINTI "You answer negatively with a shake of your head and a curt ""Nobody like that has been here. Sorry."""
	CRLF
	CRLF
	PRINTI "He "
	IN? COMP-BLOOD-STAIN,HERE \?L29
	PRINTI "lowers his eyes to the floor, as if in thought"
	JUMP ?L31
?L29:	PRINTI "looks at your hands"
?L31:	PRINTI ", then looks you straight in the eye. ""You are certain, then?"" he asks, with a hint of humor - or is it disbelief? You again reassure him that you would certainly have noticed someone of that description."
	CRLF
	CRLF
	ADD SUSPICION,3 >SUSPICION
	JUMP ?L32
?L27:	CRLF
	PRINTI "He looks around again briefly, and nods his head a few times as if agreeing with you.[RWD_ID: bystander:1624, VAL: 1]"
	CRLF
	CRLF
?L32:	GRTR? SUSPICION,2 \?L33
	PRINTI """Well, thank you anyway. We shall be arriving at the checkpoint in a few minutes, and then we must conduct our border search - you understand. Until then, I would appreciate it if you would remain here."" He leaves with a tip of his hat. As he leaves, he speaks briefly with one of the guards stationed in the passageway."
	CRLF
	SET 'BAD-CONFINED,1
	JUMP ?L35
?L33:	FCLEAR COMP-5-DOOR,OPENBIT
	PRINTI """Thank you anyway. We shall be arriving shortly at the border, and I will see you again at that time."" He leaves with a tip of his hat, closing the door behind him."
	CRLF
?L35:	SET 'I-FATAL,1
	SET 'BAD-INTERVIEW-FLAG,0
	REMOVE BAD-SPY
	RTRUE

	.FUNCT COMP-BLOOD-STAIN-F
	EQUAL? PRSA,V?CLEAN \?L8
	EQUAL? PRSI,WET-PAPER-TOWEL /?L3
	EQUAL? PRSA,V?CLEAN \?L8
	ZERO? PRSI \?L1
	IN? WET-PAPER-TOWEL,WINNER \?L1
?L3:	PRINTI "You wipe up the drops of blood; it is unlikely anyone would notice the slight discoloration that remains.[RWD_ID: bystander:1669, VAL: 1]"
	CRLF
	MOVE STAINED-PAPER-TOWEL,WINNER
	REMOVE WET-PAPER-TOWEL
	REMOVE COMP-BLOOD-STAIN
	RTRUE
?L1:	EQUAL? PRSA,V?CLEAN \?L8
	EQUAL? PRSI,PAPER-TOWEL /?L6
	EQUAL? PRSA,V?CLEAN \?L8
	ZERO? PRSI \?L5
	IN? PAPER-TOWEL,WINNER \?L5
?L6:	FSET PRSO,CROSSBIT
	PRINTR "The dry towel merely smears the blood around, leaving, in all, a bigger mess than when you started."
?L5:	EQUAL? PRSA,V?CLEAN \?L8
	PRINTR "It's a good idea to cover the agent's tracks, but you don't have anything suitable for cleaning up the mess."
?L8:	EQUAL? PRSA,V?PUT-ON,V?PUT \FALSE
	EQUAL? PRSI,COMP-BLOOD-STAIN \FALSE
	PRINTI "You'd only ruin the "
	ICALL2 DPRINT,PRSO
	PRINT PERIOD-CR
	RTRUE

	.FUNCT I-BAD-WAITS
	LOC BAD-SPY >STACK
	ZERO? STACK /TRUE
	GETP HERE,P?NS >STACK
	LOC BAD-SPY >STACK
	GETP STACK,P?NS >STACK
	SUB STACK,STACK >STACK
	CALL2 ABS,STACK >STACK
	LESS? STACK,BAD-DISTANCE /?L3
	EQUAL? HERE,COMP-5 /?L3
	EQUAL? HERE,LAVATORY /?L6
	IGRTR? 'BAD-WAIT-COUNT,4 \?L4
?L6:	HLIGHT H-BOLD
	CRLF
	INC 'SUSPICION
	EQUAL? HERE,LAVATORY \?L7
	PRINTI "A guard forces his way into the lavatory and leads"
	JUMP ?L9
?L7:	PRINTI "The man signals to a guard, who arrives and forcibly takes"
?L9:	PRINTI " you to your compartment. ""That is better,"" the trench coated man says."
	HLIGHT H-NORMAL
	CRLF
	ICALL GOTO,COMP-5,0
	ICALL1 DE-SLOW-CLOCK-QUEUE
	ICALL2 BAD-INTERVIEW,1
	RTRUE
?L4:	EQUAL? BAD-WAIT-COUNT,1 /FALSE
	GET BAD-WAIT-TBL,BAD-WAIT-COUNT >STACK
	CALL2 BOLDTELL,STACK >STACK
	RSTACK
?L3:	DLESS? 'BAD-DISTANCE,1 \FALSE
	ICALL2 BOLDTELL,STR?273
	ICALL GOTO,COMP-5,0
	ICALL1 BAD-INTERVIEW
	ICALL1 DE-SLOW-CLOCK-QUEUE
	RTRUE

	.FUNCT I-BAD-LAV-WAITS
	LOC BAD-SPY >STACK
	ZERO? STACK /TRUE
	FSET? LAVATORY-DOOR,OPENBIT \?L3
	ICALL2 BOLDTELL,STR?274
	ICALL GOTO,COMP-5,0
	ICALL1 BAD-INTERVIEW
	ICALL1 DE-SLOW-CLOCK-QUEUE
	RTRUE
?L3:	IGRTR? 'BAD-WAIT-COUNT,4 \?L4
	ICALL2 BOLDTELL,STR?275
	INC 'SUSPICION
	ICALL GOTO,COMP-5,0
	ICALL2 BAD-INTERVIEW,1
	ICALL1 DE-SLOW-CLOCK-QUEUE
	RTRUE
?L4:	EQUAL? BAD-WAIT-COUNT,1 /FALSE
	GET BAD-LAV-WAIT-TBL,BAD-WAIT-COUNT >STACK
	CALL2 BOLDTELL,STACK >STACK
	RSTACK

	.FUNCT GRAFFITI-F
	EQUAL? PRSA,V?EXAMINE,V?READ \FALSE
	PRINTR "The words don't make a lot of sense, and your Frobnian is poor, but it seems to say:

         BORDER ZONE
    Written by Marc Blank
Copyright (c) 1987, Infocom, Inc.
"

	.FUNCT TOWEL-DISPENSER-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "It's your ordinary metal towel dispenser. Here, as in the States, people tend to write grafitti on towel dispensers, and this one is no exception."
	IN? PAPER-TOWEL,PRSO \?L3
	PRINTR " You are in luck - there's at least one paper towel inside."
?L3:	PRINTR " It seems to be empty, which is somehow not surprising."
?L1:	EQUAL? PRSA,V?OPEN \?L6
	PRINTR "You can't open it, reminding yourself of how stupid it is that all towel dispensers seem to be locked."
?L6:	EQUAL? PRSA,V?CLOSE \?L7
	PRINTR "It already is."
?L7:	EQUAL? PRSA,V?PUT \?L8
	EQUAL? PRSI,TOWEL-DISPENSER \?L8
	EQUAL? PRSO,DOCUMENT,SHRED,SHREDS \?L9
	MOVE PRSO,PRSI
	PRINTI "You carefully place the "
	ICALL2 DPRINT,PRSO
	PRINTR " inside the dispenser."
?L9:	EQUAL? PRSO,PAPER-TOWEL \?L11
	MOVE PRSO,PRSI
	PRINTR "You replace the paper towel in the dispenser."
?L11:	PRINTR "The opening is too small and narrow for that."
?L8:	EQUAL? PRSA,V?KICK,V?MUNG,V?UNLOCK /?L14
	EQUAL? PRSA,V?HIT \FALSE
?L14:	PRINTI "Did it occur to you to simply take the towel rather than vandalizing the machine?"
	CRLF
	CALL2 PRINT-ID,STR?276 >STACK
	RSTACK

	.FUNCT PAPER-TOWEL-F
	EQUAL? PRSA,V?RIP,V?CUT \?L1
	PRINTR "That won't serve any purpose."
?L1:	EQUAL? PRSA,V?PUT-ON,V?PUT \?L3
	EQUAL? PRSO,DOCUMENT \?L3
	PRINTR "You'd never get away with it."
?L3:	EQUAL? PRSA,V?MOVE,V?TAKE \FALSE
	EQUAL? PRSO,PAPER-TOWEL \FALSE
	IN? PRSO,TOWEL-DISPENSER \FALSE
	PRINTI "You pull out the paper towel - it's the last one.[RWD_ID: bystander:1854, VAL: 1]"
	CRLF
	MOVE PRSO,WINNER
	RTRUE

	.FUNCT LAV-SINK-F
	EQUAL? PRSA,V?CLOSE,V?OPEN \?L1
	PRINTR "An odd idea."
?L1:	EQUAL? PRSA,V?EXAMINE \?L3
	PRINTI "The sink is hideously dirty and grimy"
	FSET? LAV-FAUCET,OPENBIT \?L4
	PRINTI ", in spite of the running water"
?L4:	PRINTI "; you hesitate to even consider using it."
	FIRST? LAV-SINK >STACK \?L7
	PRINTI " "
	FCLEAR LAV-SINK,NDESCBIT
	ICALL1 V-EXAMINE
	FSET LAV-SINK,NDESCBIT
	RTRUE
?L7:	CRLF
	RTRUE
?L3:	EQUAL? PRSA,V?PUT \FALSE
	EQUAL? PRSI,LAV-SINK \?L10
	GETP PRSO,P?SIZE >STACK
	GRTR? STACK,2 \?L10
	PRINTR "That would only clog the drain, which won't help you, though it would make an interesting sort of statement."
?L10:	EQUAL? PRSA,V?PUT \FALSE
	EQUAL? PRSI,LAV-SINK \FALSE
	FSET? LAV-FAUCET,OPENBIT \FALSE
	ICALL PERFORM,V?PUT-UNDER,PRSO,LAV-FAUCET
	RTRUE

	.FUNCT GLOBAL-TAIL-F
	ZERO? FOLLOW-WARNING \?L1
	PRINTR "You don't see any particular man around here, at least none that you recognize."
?L1:	PRINTR "You try to find the man who appears to be tailing you, but he has gone out of sight."

	.FUNCT GLOBAL-WATER-F
	EQUAL? HERE,LAVATORY /?L1
	PRINTR "There's no water here."
?L1:	EQUAL? PRSA,V?EAT,V?DRINK \?L3
	PRINTI "You "
	FSET? LAV-FAUCET,OPENBIT /?L4
	PRINTI "turn on the faucet and "
?L4:	PRINTI "take a nice, refreshing drink, after which you turn the water back off again."
	CRLF
	FCLEAR LAV-FAUCET,OPENBIT
	RTRUE
?L3:	EQUAL? PRSA,V?WALK \?L7
	ICALL PERFORM,V?OPEN,LAV-FAUCET
	RTRUE
?L7:	EQUAL? PRSA,V?SET,V?OFF,V?ON /?L9
	EQUAL? PRSA,V?CLOSE,V?OPEN \?L8
?L9:	ICALL PERFORM,PRSA,LAV-FAUCET
	RTRUE
?L8:	EQUAL? PRSA,V?PUT-UNDER,V?PUT \FALSE
	EQUAL? PRSI,GLOBAL-WATER \FALSE
	FSET? LAV-FAUCET,OPENBIT /?L11
	PRINTR "There's no water running, so it'll take some time..."
?L11:	EQUAL? PRSO,PAPER-TOWEL \?L13
	PRINTI "You put the "
	ICALL2 DPRINT,PRSO
	PRINTI " under the running water until it's good and wet."
	CRLF
	LOC PAPER-TOWEL >STACK
	MOVE WET-PAPER-TOWEL,STACK
	ICALL2 THIS-IS-IT,WET-PAPER-TOWEL
	REMOVE PAPER-TOWEL
	RTRUE
?L13:	PRINTR "There's nothing to be gained by wetting that."

	.FUNCT LAV-FAUCET-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "Like much of the rest of Frobnia, you have a choice of cold or cold running water - thus, only one faucet."
	FSET? PRSO,OPENBIT \?L3
	PRINTI " At the moment, the faucet is open and water splashes into the sink and down the drain."
?L3:	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?PUT-UNDER \?L6
	EQUAL? PRSI,LAV-FAUCET \?L6
	ICALL PERFORM,PRSA,PRSO,GLOBAL-WATER
	RTRUE
?L6:	EQUAL? PRSA,V?ON,V?OPEN /?L8
	EQUAL? PRSA,V?SET \?L7
	FSET? PRSO,OPENBIT /?L7
?L8:	FSET? PRSO,OPENBIT \?L9
	PRINTR "The pressure is low, but the faucet is quite open."
?L9:	FSET PRSO,OPENBIT
	PRINTI "You turn the faucet and the cold water starts to flow into the sink."
	ICALL DOWN-THE-DRAIN,LAV-SINK,3
	CRLF
	RTRUE
?L7:	EQUAL? PRSA,V?OFF,V?CLOSE /?L13
	EQUAL? PRSA,V?SET \FALSE
	FSET? PRSO,OPENBIT \FALSE
?L13:	FSET? PRSO,OPENBIT /?L14
	PRINTR "The faucet is already closed."
?L14:	FCLEAR PRSO,OPENBIT
	PRINTR "You turn off the faucet which, after some dripping, finally obliges."

	.FUNCT DOCUMENT-F
	EQUAL? PRSA,V?FOLD \?L1
	GETP PRSO,P?SIZE >STACK
	GRTR? STACK,4 \?L3
	PUTP PRSO,P?SIZE,2
	PRINTR "The document is now folded up."
?L3:	PRINTR "It's already folded up as much as it can be."
?L1:	EQUAL? PRSA,V?UNFOLD \?L6
	GETP PRSO,P?SIZE >STACK
	LESS? STACK,4 \?L7
	PRINTI "The document is no longer folded up."
	CRLF
	PUTP PRSO,P?SIZE,5
	RTRUE
?L7:	CALL1 TOO-LATE >STACK
	RSTACK
?L6:	EQUAL? PRSA,V?MUNG,V?RIP \?L10
	PRINTI "You "
	EQUAL? PRSA,V?RIP \?L11
	PRINTI "rip"
	JUMP ?L13
?L11:	PRINTI "cut"
?L13:	PRINTI " up the document into a number of pieces, leaving you with a handful of shreds."
	CRLF
	REMOVE DOCUMENT
	ICALL2 THIS-IS-IT,SHREDS
	MOVE SHREDS,WINNER
	RTRUE
?L10:	EQUAL? PRSA,V?READ,V?EXAMINE \?L14
	GETP PRSO,P?SIZE >STACK
	LESS? STACK,4 \?L15
	PRINTI "Before you start reading, you first unfold the document."
	CRLF
	CRLF
	PUTP PRSO,P?SIZE,5
?L15:	PRINTR "It's an official document of some kind, though you can't understand a word of the contents - it's in Frobnian, naturally, so you wouldn't expect to."
?L14:	EQUAL? PRSA,V?LOOK-INSIDE,V?CLOSE,V?OPEN /?L19
	EQUAL? PRSA,V?PUT-ON,V?PUT \FALSE
	EQUAL? DOCUMENT,PRSI \FALSE
?L19:	PRINTR "That's ridiculous."

	.FUNCT SHRED-F
	EQUAL? PRSA,V?READ,V?EXAMINE \FALSE
	PRINTR "You can tell it's from the original document, though it's hard to make much of anything out of the small, wet shred of paper."

	.FUNCT SHREDS-F
	EQUAL? PRSA,V?READ,V?EXAMINE \?L1
	PRINTR "There about a dozen of them, none small enough to read which, presumably, was the idea."
?L1:	EQUAL? PRSA,V?EAT \?L3
	PRINTI "Just like in the movies, you eat the shreds; they don't go down easy, and you hope you won't be seeing them again."
	CRLF
	REMOVE SHREDS
	RTRUE
?L3:	EQUAL? PRSA,V?TAKE \FALSE
	IN? PRSO,LAV-TOILET \FALSE
	PRINTR "The shreds are wet, now. You can't take them."

	.FUNCT LAV-MIRROR-F
	EQUAL? PRSA,V?PUT-BEHIND \?L1
	EQUAL? PRSI,LAV-MIRROR \?L1
	PRINTR "The mirror is flush with the wall."
?L1:	EQUAL? PRSA,V?EXAMINE,V?LOOK-INSIDE \?L3
	PRINTI "You see yourself, of course"
	IN? CARNATION,BYSTANDER-CLOTHES \?L4
	PRINTI ", and the mangled carnation on your lapel reminds you of your task"
?L4:	PRINT PERIOD-CR
	RTRUE
?L3:	EQUAL? PRSA,V?KICK,V?MUNG \FALSE
	PRINTI "There are enough vandals around without your getting into the act."
	CRLF
	CALL2 PRINT-ID,STR?277 >STACK
	RSTACK

	.FUNCT LAV-WINDOW-F
	EQUAL? PRSA,V?LOOK-INSIDE \?L1
	PRINTR "You can't make out much; the window is much too grimy."
?L1:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L3
	PRINTR "The window here doesn't open or close, which is a shame considering the not too pleasant odors contained here. The only ones that ever seem to open are those in the compartments."
?L3:	EQUAL? PRSA,V?CLEAN \?L4
	PRINTR "It's good that somebody thought of it, but the grime is on the outside and out of reach."
?L4:	EQUAL? PRSA,V?KICK,V?MUNG \FALSE
	PRINTI "That would make lots of noise and bring attention to yourself, so you reconsider."
	CRLF
	CALL2 PRINT-ID,STR?278 >STACK
	RSTACK

	.FUNCT I-BAD-TUNNEL
	ICALL2 BOLDTELL,STR?279
	SET 'BAD-TUNNEL,1
	ICALL RT-QUEUE,I-BAD-TUNNEL-END,160
	RTRUE

	.FUNCT I-BAD-TUNNEL-END
	HLIGHT H-BOLD
	CRLF
	PRINTI "The train has left the tunnel; these are the final moments before arriving at the checkpoint."
	CRLF
	SET 'BAD-TUNNEL,0
	EQUAL? HERE,LAVATORY /?L1
	CRLF
	PRINTI "Out of the corner of your eye, you catch a glimpse of someone falling from the roof of the train! Though you can't be sure, you'd swear it was the American agent."
?L1:	HLIGHT H-NORMAL
	CRLF
	CALL RT-QUEUE,I-BAD-BORDER,100 >STACK
	RSTACK

	.FUNCT I-BAD-BORDER,ITM,TMP
	HLIGHT H-BOLD
	SET 'BAD-CONFINED,0
	CRLF
	PRINTI "The train, without warning, slams on its brakes and comes to a stop at the border station. After so many trips, you'd think you were used to this jarring moment, but alas, it's always the same."
	CRLF
	HLIGHT H-NORMAL
	CRLF
	EQUAL? HERE,COMP-5 /?L1
	ICALL GOTO,COMP-5,0
	PRINTI "A guard comes up to you, speaks some gibberish you take for a lower-class dialect of Frobnian, and hustles you back to your compartment."
	CRLF
	CRLF
?L1:	PRINTI "Within seconds, the man in the trench coat along with two uniformed guards enter. This border search ritual has become second-nature to you, although the man in the coat is a new twist."
	CRLF
	CRLF
	PRINTI "They begin by asking about your trip, your nationality (as if they didn't know), and a host of inquiries about currency and other possible contraband."
	FSET? CARNATION,WORNBIT \?L4
	FSET? CARNATION,HUTBIT /?L4
	PRINTI " During the questioning, a guard motions to the man in the trench coat who then appears to stare straight at your clothing, frowning slightly."
	INC 'SUSPICION
?L4:	PRINTI " Then, as usual, they move on to the possessions."
	CRLF
	CALL ULTIMATELY-IN?,BRIEFCASE,HERE >STACK
	ZERO? STACK /?L9
	ICALL MOVE-ALL,BRIEFCASE,COMP-SEAT-FRONT
	ICALL2 THEY-START-WITH,BRIEFCASE
	SET 'TMP,1
	CALL2 BAD-SEARCH,BRIEFCASE >STACK
	ZERO? STACK \TRUE
?L9:	CALL ULTIMATELY-IN?,CAMERA-BAG,HERE >STACK
	ZERO? STACK /?L18
	ICALL MOVE-ALL,CAMERA-BAG,COMP-SEAT-FRONT
	ZERO? TMP /?L15
	ICALL2 FINDING-NOTHING,CAMERA-BAG
	JUMP ?L17
?L15:	ICALL2 THEY-START-WITH,CAMERA-BAG
	SET 'TMP,1
?L17:	CALL2 BAD-SEARCH,CAMERA-BAG >STACK
	ZERO? STACK \TRUE
?L18:	CALL ULTIMATELY-IN?,CAMERA,HERE >STACK
	ZERO? STACK /?L22
	ZERO? TMP /?L24
	ICALL2 FINDING-NOTHING,CAMERA
	JUMP ?L26
?L24:	ICALL2 THEY-START-WITH,CAMERA
	SET 'TMP,1
?L26:	PRINTI " The guard examines it for a moment, then passes it to the trench coated man."
	CRLF
	CALL1 CAMERA-SEARCH >STACK
	ZERO? STACK \TRUE
	CRLF
	JUMP ?L34
?L22:	LOC CAMERA >STACK
	ZERO? STACK /?L30
	CRLF
	CRLF
	PRINTI "Just at this moment, another guard enters the compartment, holding your camera. He speaks quickly, in Frobnian, then leaves. ""That was very careless of you, leaving your camera in the "
	LOC CAMERA >STACK
	ICALL2 DPRINT,STACK
	PRINTI "."""
	CRLF
	CALL1 CAMERA-SEARCH >STACK
	ZERO? STACK \TRUE
	CRLF
	JUMP ?L34
?L30:	CALL ULTIMATELY-IN?,COLOR-ROLL,HERE >STACK
	ZERO? STACK \?L35
	CALL ULTIMATELY-IN?,EXPOSED-ROLL,HERE >STACK
	ZERO? STACK /?L34
?L35:	CRLF
	CRLF
	IN? COLOR-ROLL,COMP-SEAT-FRONT /?L38
	IN? EXPOSED-ROLL,COMP-SEAT-FRONT \?L36
?L38:	PRINTI "The man in the trench coat looks down at the front facing seat and holds up your film, frowning as though puzzled."
	JUMP ?L39
?L36:	PRINTI "The guards, who have started looking elsewhere in your compartment, find your film and hand it to over to the trench coated man."
?L39:	PRINTI " ""Now this I find peculiar. We find no camera of yours on this train, yet here you have film."" He toys with the film for a moment, then exposes it all, handing it finally to one of the guards standing by. ""Let us hope that the pictures were not so good anyway."""
	CALL ULTIMATELY-IN?,COLOR-ROLL,HERE >STACK
	ZERO? STACK /?L40
	REMOVE COLOR-ROLL
?L40:	CALL ULTIMATELY-IN?,EXPOSED-ROLL,HERE >STACK
	ZERO? STACK /?L43
	REMOVE EXPOSED-ROLL
?L43:	CRLF
?L34:	LESS? SUSPICION,2 \?L47
	ZERO? SECOND-ROLL /?L47
	CALL2 DONT-CONFISCATE,BRIEFCASE >STACK
	ZERO? STACK \?L53
	CALL2 DONT-CONFISCATE,COMP-SEAT-BACK >STACK
	ZERO? STACK \?L53
	CALL2 DONT-CONFISCATE,COMP-SEAT-FRONT >STACK
	ZERO? STACK \?L53
	CALL2 DONT-CONFISCATE,COMP-RACK >STACK
	ZERO? STACK \?L53
?L47:	GRTR? SUSPICION,0 \?L50
	ZERO? SECOND-ROLL \?L50
	CALL2 CONFISCATE-FILM,BRIEFCASE >STACK
	ZERO? STACK \?L53
?L50:	GRTR? SUSPICION,1 \?L51
	ZERO? SECOND-ROLL /?L51
	CALL2 CONFISCATE-FILM,BRIEFCASE >STACK
	ZERO? STACK \?L53
	CALL2 CONFISCATE-FILM,COMP-SEAT-FRONT >STACK
	ZERO? STACK \?L53
	CALL2 CONFISCATE-FILM,COMP-SEAT-BACK >STACK
	ZERO? STACK \?L53
	CALL2 CONFISCATE-FILM,COMP-RACK >STACK
	ZERO? STACK \?L53
?L51:	IN? COLOR-ROLL,WINNER /?L54
	IN? EXPOSED-ROLL,WINNER \?L53
?L54:	ICALL REMOVE-IF-IN?,COLOR-ROLL,WINNER
	ICALL REMOVE-IF-IN?,EXPOSED-ROLL,WINNER
	CRLF
	PRINTI "He then notices the film you're holding, exposes that, and hands it over to one of the guards. ""I do not understand why you would be holding your film. It is night, and the view... well, the view is not so exciting. We can only hope that the pictures here were not so good, eh?"""
	CRLF
?L53:	CALL2 BAD-SEARCH,LAV-TOILET >STACK
	ZERO? STACK \TRUE
	CALL2 BAD-SEARCH,LAV-SINK >STACK
	ZERO? STACK \TRUE
	CALL2 BAD-SEARCH,LAVATORY >STACK
	ZERO? STACK \TRUE
	CALL2 BAD-SEARCH,TOWEL-DISPENSER >STACK
	ZERO? STACK \TRUE
	CALL2 BAD-SEARCH,WINNER >STACK
	ZERO? STACK \TRUE
	CALL2 BAD-SEARCH,HERE >STACK
	ZERO? STACK \TRUE
	CALL2 BAD-SEARCH,TOILET-KIT >STACK
	ZERO? STACK \TRUE
	CALL2 BAD-SEARCH,COMP-RACK >STACK
	ZERO? STACK \TRUE
	CALL2 BAD-SEARCH,COMP-SEAT-FRONT >STACK
	ZERO? STACK \TRUE
	CALL2 BAD-SEARCH,COMP-SEAT-BACK >STACK
	ZERO? STACK \TRUE
	CALL2 BAD-SEARCH,UNDER-SEAT >STACK
	ZERO? STACK \TRUE
	CRLF
	PRINTI """You have been through worse, I am sure."" The man smiles that unnerving smile of his and "
	IN? CARNATION,WINNER \?L60
	INC 'SUSPICION
	PRINTI "seems to notice your carnation for the first time"
	JUMP ?L62
?L60:	PRINTI "continues"
?L62:	PRINTI ". ""And you have been very patient. Have a pleasant journey, and feel free to leave the train, if you wish. We shall be stopping here longer than usual today."" He exits, along with the other guards."
	SET 'AT-STATION,1
	ICALL RT-QUEUE,I-GORMNASH,850
	ICALL2 I-CLOCKER,240
	FCLEAR PASS-5,TOUCHBIT
	FCLEAR PASS-6,TOUCHBIT
	CRLF
	RTRUE

	.FUNCT DONT-CONFISCATE,OBJ
	IN? COLOR-ROLL,OBJ /?L3
	IN? EXPOSED-ROLL,OBJ \FALSE
?L3:	CRLF
	PRINTI "The man pauses, then moves to "
	ICALL2 THE-PRINT,OBJ
	PRINTR ", picking up the film that lies there. He rolls it in his hand, then returns it. ""I was thinking..."" he starts. He stops for a tense moment, then continues, ""I was thinking that perhaps we are on the wrong track."" And with that, he returns the film to its place.[RWD_ID: bystander:2322, VAL: 2]"

	.FUNCT CONFISCATE-FILM,OBJ
	IN? COLOR-ROLL,OBJ /?L3
	IN? EXPOSED-ROLL,OBJ \FALSE
?L3:	ICALL REMOVE-IF-IN?,COLOR-ROLL,OBJ
	ICALL REMOVE-IF-IN?,EXPOSED-ROLL,OBJ
	CRLF
	PRINTI "The man pauses, then moves to "
	ICALL2 THE-PRINT,OBJ
	PRINTI ", picking up the film that is "
	FSET? OBJ,SURFACEBIT \?L4
	PRINTI "sitting there"
	JUMP ?L6
?L4:	PRINTI "inside"
?L6:	PRINTR ". ""I am afraid that this film will have to be confiscated. We cannot be too careful with potential enemies of the state."""

	.FUNCT REMOVE-IF-IN?,OBJ,CNT
	IN? OBJ,CNT \FALSE
	REMOVE OBJ
	RTRUE

	.FUNCT CAMERA-SEARCH,OBJ
	CRLF
	PRINTI "He smiles at you, but you find it difficult to return the gesture. ""You like to take pictures, then..."" He pauses, massaging his upper lip between his thumb and forefinger, then "
	FSET? CAMERA,OPENBIT \?L1
	PRINTI "looks in"
	JUMP ?L3
?L1:	PRINTI "opens"
?L3:	PRINTI " the back of the camera."
	IN? SHRED,CAMERA /?L6
	IN? SHREDS,CAMERA /?L6
	IN? DOCUMENT,CAMERA \?L4
?L6:	CRLF
	CRLF
	PRINTI "He shakes his head for a moment, then pulls the "
	FIRST? CAMERA >STACK /?L7
?L7:	ICALL2 DPRINT,STACK
	PRINTI " out of the camera. "
	PRINT BAD-END
	CRLF
	CRLF
	ICALL2 PRINT-ID,STR?280
	ICALL2 JIGS-UP,EPILOGUE-ASS
	RTRUE
?L4:	FIRST? CAMERA >OBJ \FALSE
	FSET? OBJ,FILMBIT \FALSE
	EQUAL? OBJ,COLOR-ROLL \?L9
	SET 'SECOND-ROLL,EXPOSED-ROLL
	JUMP ?L11
?L9:	SET 'SECOND-ROLL,COLOR-ROLL
?L11:	REMOVE OBJ
	PRINTI " ""I myself have quite an interest in photography, but as for these pictures..."" He pulls the film out of the roll, exposing every frame. ""These pictures..."" he continues, ""...were probably not your best."" He hands the exposed film to a guard, who pockets it."
	RFALSE

	.FUNCT FINDING-NOTHING,OBJ
	PRINTI " Seeing nothing of interest there, they continue with the "
	ICALL2 DPRINT,OBJ
	PRINTI "."
	RTRUE

	.FUNCT THEY-START-WITH,OBJ
	CRLF
	PRINTI "They start with the "
	ICALL2 DPRINT,OBJ
	PRINTI ", looking it over, and finally dumping its contents onto the front facing seat."
	RTRUE

	.FUNCT BAD-FOUND,ITM,CNT
	CRLF
	EQUAL? CNT,WINNER \?L1
	ZERO? BAD-INTERVIEW-FLAG /?L3
	PRINTI "The man notices what you are carrying, and forces it from your hand."
	JUMP ?L13
?L3:	PRINTI "At the signal from a the man in the trench coat, a guard searches you, finding the "
	ICALL2 DPRINT,ITM
	PRINTI ". Looking pleased, he hands it"
	JUMP ?L13
?L1:	EQUAL? CNT,HERE \?L6
	ZERO? BAD-INTERVIEW-FLAG /?L7
	PRINTI "The man sees the "
	ICALL2 DPRINT,ITM
	PRINTI " on the floor, and picks it up."
	JUMP ?L13
?L7:	PRINTI "One of the guards notices the "
	ICALL2 DPRINT,ITM
	PRINTI " sitting on the floor. He hands it"
	JUMP ?L13
?L6:	EQUAL? CNT,LAVATORY /?L11
	CALL ULTIMATELY-IN?,CNT,LAVATORY >STACK
	ZERO? STACK /?L10
?L11:	PRINTI "A guard bursts into the room, holding the "
	ICALL2 DPRINT,ITM
	PRINTI ". He hands it"
	JUMP ?L13
?L10:	EQUAL? CNT,COMP-RACK,COMP-SEAT-FRONT,COMP-SEAT-BACK \?L12
	PRINTI "One of the guards, who had been searching the "
	ICALL2 DPRINT,CNT
	PRINTI ", finds the "
	ICALL2 DPRINT,ITM
	PRINTI " there and hands it"
	JUMP ?L13
?L12:	PRINTI "The guard searches for a moment, then finds the "
	ICALL2 DPRINT,ITM
	PRINTI " which he hands"
?L13:	EQUAL? CNT,WINNER,HERE \?L14
	ZERO? BAD-INTERVIEW-FLAG /?L14
	PRINTI " He looks it over and shakes his head. ""I am afraid we shall have to discuss this at length,"" he says. He assigns a guard to watch over you until the train reaches the station. Once there, you are led into a holding room, where you undergo a few hours of detailed interrogation. You are finally released, but not before missing your rendezvous."
	CRLF
	CRLF
	ICALL2 PRINT-ID,STR?281
	ICALL2 JIGS-UP,EPILOGUE-ASS
	JUMP ?L16
?L14:	PRINTI " to the man in the coat, who shakes his head back and forth. "
?L16:	EQUAL? CNT,TOWEL-DISPENSER,LAV-TOILET \?L17
	PRINTI """In the "
	ICALL2 DPRINT,CNT
	PRINTI ", how very clever,"" the man begins. "
?L17:	PRINT BAD-END
	CRLF
	CRLF
	ICALL2 PRINT-ID,STR?282
	CALL2 JIGS-UP,EPILOGUE-ASS >STACK
	RSTACK

	.FUNCT BAD-SEARCH,OBJ,FND
	SET 'FND,0
	IN? SHREDS,OBJ \?L1
	SET 'FND,SHREDS
	JUMP ?L4
?L1:	IN? DOCUMENT,OBJ \?L3
	SET 'FND,DOCUMENT
	JUMP ?L4
?L3:	IN? SHRED,OBJ \?L4
	SET 'FND,SHRED
?L4:	ZERO? FND /FALSE
	ICALL BAD-FOUND,FND,OBJ
	RTRUE

	.FUNCT REMOVE-TO-BOTTOM,OBJ,N,F
	FIRST? OBJ >F /?L4
	JUMP ?L3
?L1:	ZERO? F /?L3
?L4:	NEXT? F >N /?L7
?L7:	FIRST? F >STACK \?L8
	ICALL2 REMOVE-TO-BOTTOM,F
	JUMP ?L10
?L8:	REMOVE F
?L10:	SET 'F,N
	JUMP ?L1
?L3:	REMOVE OBJ
	RTRUE

	.FUNCT BY-GUN-F
	EQUAL? PRSA,V?TAKE \?L1
	PRINTI "You're likely to get only the bullets."
	CRLF
	CALL2 PRINT-ID,STR?283 >STACK
	RSTACK
?L1:	PRINTR "There's nothing useful for you to do with the gun."

	.FUNCT BY-GUARDS-F
	EQUAL? PRSA,V?PHOTOGRAPH \?L1
	PRINTR "As you raise your camera, the guard raises his weapon. It would be a shame to waste your last picture on him."
?L1:	EQUAL? PRSA,V?BRIBE \?L3
	PRINTI "It's too risky; you'd probably end up in jail."
	CRLF
	CALL2 PRINT-ID,STR?284 >STACK
	RSTACK
?L3:	CALL2 HURT?,PRSO >STACK
	ZERO? STACK /?L4
	PRINTI "Don't be ridiculous! You'd only get thrown in jail, and an iron-curtain jail at that!"
	CRLF
	CALL2 PRINT-ID,STR?285 >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?EXAMINE \?L5
	ZERO? AT-STATION /?L6
	PRINTR "The guard is standing just north of your position, and he motions for you to exit the train to the south."
?L6:	PRINTR "The guards are in uniform and appear to be heavily armed. There is one at each end of the passageway; although this train is always heavily guarded, today's showing is somewhat unnerving."
?L5:	EQUAL? PRSA,V?GIVE,V?SHOW \FALSE
	EQUAL? PRSO,DOCUMENT,SHRED,SHREDS \FALSE
	ICALL PERFORM,V?GIVE,PRSO,BAD-SPY
	RTRUE

	.FUNCT SAY-IT-IN-FROBNIAN-F
	EQUAL? PRSA,V?OPEN,V?READ,V?EXAMINE \FALSE
	CALL1 CAN-BE-FOUND >STACK
	RSTACK

	.FUNCT PASSPORT-F
	EQUAL? PRSA,V?READ,V?EXAMINE \FALSE
	PRINTR "It's yours, all right, and it hasn't changed since you last looked at it."

	.FUNCT TICKET-F
	EQUAL? PRSA,V?READ,V?EXAMINE \FALSE
	PRINTR "It's your ticket out of the country, and is printed in Frobnian."

	.FUNCT PLAT-TRAIN-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "The train is stopped here at the station. There are four cars in all, and a guard is posted at each entrance to prevent the passengers from reboarding until the train is ready to get underway again. You've never understood this procedure, but that's nothing new in Frobnia."
?L1:	EQUAL? PRSA,V?CLIMB-ON,V?ENTER,V?BOARD \FALSE
	PRINTR "You are stopped by one of the guards. ""Nye mneshna pletska bli!"""

	.FUNCT I-GORMNASH
	HLIGHT H-BOLD
	CRLF
	PRINTI "The train's conductor cries ""Gormnash floogle nomnetz!"" indicating that the train is ready to leave. "
	FSET? HERE,PLATFORMBIT \?L1
	PRINTI "Not wishing to remain here with an invalid ticket, you return to the train,"
	JUMP ?L3
?L1:	PRINTI "A minute later, the train pulls away from the station, and you kick yourself for"
?L3:	PRINTI " having failed to make contact with the friendly agent."
	CRLF
	ICALL2 PRINT-ID,STR?286
	HLIGHT H-NORMAL
	CRLF
	CALL2 JIGS-UP,EPILOGUE-ASS >STACK
	RSTACK

	.FUNCT I-PLATFORM
	ZERO? CONTACT-WAIT /?L1
	SET 'CONTACT-WAIT,0
	RFALSE
?L1:	ZERO? BUMPER-FLAG /?L3
	SET 'I-FATAL,1
	HLIGHT H-BOLD
	CRLF
	EQUAL? BUMPER-FLAG,CONTACT \?L4
	LOC BUMPER-FLAG >STACK
	IN? COLOR-ROLL,STACK \?L6
	ZERO? PASSWORD-GIVEN /?L6
	LESS? SUSPICION,2 \?L8
	ICALL2 SCENE-1-FINISH,COLOR-ROLL
	RTRUE
?L8:	PRINTI "The "
	ICALL2 DPRINT,BUMPER-FLAG
	PRINTI " bends down to pick up the roll of film when two men approach, guns raised."
	ICALL1 SCENE-1-ARREST
	RTRUE
?L6:	PRINTI "Your contact looks around nervously, then darts off and out of sight."
	CRLF
	CRLF
	PRINTI "Having lost sight of your contact, you have failed in your mission, and you return to your train dejectedly."
	CRLF
	CRLF
	ICALL2 PRINT-ID,STR?287
	ICALL2 JIGS-UP,EPILOGUE-ASS
	JUMP ?L13
?L4:	IN? BUMPER-FLAG,HERE /?L12
	PRINTI "You have walked away from the "
	ICALL2 DPRINT,BUMPER-FLAG
	PRINTI ", who barely seems to have noticed."
	JUMP ?L13
?L12:	PRINTI "The "
	ICALL2 DPRINT,BUMPER-FLAG
	PRINTI " walks off and is lost in the crowd."
?L13:	REMOVE BUMPER-FLAG
	SET 'BUMPER-FLAG,0
	HLIGHT H-NORMAL
	CRLF
	RTRUE
?L3:	IN? CARNATION,BYSTANDER-CLOTHES \?L14
	RANDOM 100 >STACK
	LESS? CONTACT-PROB,STACK /?L14
	SET 'I-FATAL,1
	HLIGHT H-BOLD
	CRLF
	GETP CONTACT,P?BUMPER >STACK
	PRINT STACK
	PRINTI " """
	GETP CONTACT,P?FROBNIAN >STACK
	GET STACK,0 >STACK
	PRINT STACK
	PRINTI """"
	HLIGHT H-NORMAL
	CRLF
	SET 'BUMPER-FLAG,CONTACT
	MOVE BUMPER-FLAG,HERE
	RTRUE
?L14:	RANDOM 100 >STACK
	LESS? 50,STACK /?L15
	ADD CONTACT-PROB,10 >CONTACT-PROB
	SET 'I-FATAL,1
	CALL1 PICK-WRONG-BUMPER >BUMPER-FLAG
	FSET BUMPER-FLAG,TOUCHBIT
	HLIGHT H-BOLD
	CRLF
	GETP BUMPER-FLAG,P?BUMPER >STACK
	PRINT STACK
	PRINTI " """
	GETP BUMPER-FLAG,P?FROBNIAN >STACK
	GET STACK,0 >STACK
	PRINT STACK
	PRINTI """"
	HLIGHT H-NORMAL
	CRLF
	MOVE BUMPER-FLAG,HERE
	RTRUE
?L15:	ADD CONTACT-PROB,10 >CONTACT-PROB
	RFALSE

	.FUNCT PICK-WRONG-BUMPER,TMP
?L1:	CALL2 PICK-ONE,BUMPERS >TMP
	EQUAL? TMP,CONTACT /?L1
	RETURN TMP

	.FUNCT SCENE-1-ARREST
	PRINTI " ""Nye yensk. Ouzna gotcha!"" he says. You don't recognize the first sentence, but the second is practically the national motto. A moment later, the man in the trench coat arrives. ""You have been quite clever,"" he begins, ""but I'm afraid you have given yourself away."" He smiles, as the two of you are hustled off to an interrogation room."
	CRLF
	CRLF
	PRINTI "You are charged with espionage, but after a few months and with the intervention of the American consulate, you are finally released."
	CRLF
	CRLF
	ICALL2 PRINT-ID,STR?288
	CALL1 FINISH >STACK
	RSTACK

	.FUNCT BUMPER-F
	EQUAL? PRSA,V?FOLLOW \?L1
	IN? PRSO,HERE /?L1
	FSET? PRSO,TOUCHBIT \?L3
	PRINTI "It's no good; you've lost sight of the "
	ICALL2 DPRINT,PRSO
	PRINTR "."
?L3:	PRINTR "You haven't seen that person, at least not yet."
?L1:	EQUAL? PRSA,V?SHOW,V?GIVE \?L6
	GETP PRSI,P?BUMPER >STACK
	ZERO? STACK /?L6
	GRTR? SUSPICION,0 \?L7
	PRINTI "You start to hand the "
	ICALL2 DPRINT,PRSO
	PRINTI " to the "
	ICALL2 DPRINT,PRSI
	PRINTI ", when a man steps up behind you and places a gun in the small of your back."
	CALL1 SCENE-1-ARREST >STACK
	RSTACK
?L7:	EQUAL? BUMPER-FLAG,CONTACT \?L9
	ZERO? PASSWORD-GIVEN /?L9
	CALL2 WEIGHT,PRSO >STACK
	LESS? STACK,20 \?L10
	ICALL1 SCENE-1-FINISH
	RTRUE
?L10:	PRINTI "The "
	ICALL2 DPRINT,BUMPER-FLAG
	PRINTI " looks horrified at the size of your delivery, waving you off and moving away; so near to your goal, but you have failed!"
	CRLF
	CRLF
	ICALL2 PRINT-ID,STR?289
	ICALL2 JIGS-UP,EPILOGUE-ASS
	RTRUE
?L9:	PRINTI "The "
	ICALL2 DPRINT,BUMPER-FLAG
	PRINTI " looks at you suspiciously, and fends you off with a wave of the hand and the words ""Nyep. Prep tipna."""
	CRLF
	ICALL1 BAD-ARREST?
	RTRUE
?L6:	EQUAL? PRSA,V?EXAMINE \FALSE
	GETP PRSO,P?BDESC >STACK
	ZERO? STACK /FALSE
	GETP PRSO,P?BDESC >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT SCENE-1-FINISH,OBJ,PHOTO
	ASSIGNED? 'OBJ /?L9
	SET 'OBJ,0
?L9:	ZERO? OBJ \?L1
	SET 'OBJ,PRSO
?L1:	PRINTI "The "
	ICALL2 DPRINT,CONTACT
	PRINTI " surreptitiously takes the "
	ICALL2 DPRINT,OBJ
	PRINTI " and hides it under some clothes. A moment later, your contact is gone, lost in the crowd."
	CRLF
	EQUAL? OBJ,COLOR-ROLL /?L6
	IN? COLOR-ROLL,OBJ \?L4
?L6:	GETP COLOR-ROLL,P?PHOTO >PHOTO
	GET PHOTO,0 >STACK
	EQUAL? STACK,DOCUMENT /?L7
	GET PHOTO,1 >STACK
	EQUAL? STACK,DOCUMENT \?L4
?L7:	ZERO? FILM-RUINED \?L4
	CRLF
	PRINTI "You congratulate yourself on your good work, and happily reboard the train for Vienna, wondering what it was all about and what, if any, fruits your efforts have borne."
	CRLF
	CRLF
	ICALL JIGS-UP,STR?290,2
	CALL2 PRINT-ID,STR?291 >STACK
	RSTACK
?L4:	ICALL2 PRINT-ID,STR?292
	ICALL2 JIGS-UP,EPILOGUE-ASS
	RTRUE

	.FUNCT BAD-ARREST?
	INC 'BUMPER-ACTIONS
	GRTR? SUSPICION,1 \FALSE
	SUB 4,SUSPICION >STACK
	GRTR? BUMPER-ACTIONS,STACK \FALSE
	CRLF
	PRINTI "A man walks up behind you, shoves a gun into the small of your back, and asks you to walk with him. You can hardly refuse, and you are led to a small back room at the station where you are greeted by the man in the trench coat. ""We meet again,"" he says, ""and it appears that you have been "
	ZERO? BAD-SPEAKING /?L3
	RANDOM 100 >STACK
	LESS? 50,STACK /?L3
	PRINTI "conversing"
	JUMP ?L6
?L3:	RANDOM 100 >STACK
	LESS? 60,STACK /?L5
	PRINTI "consorting"
	JUMP ?L6
?L5:	PRINTI "molesting"
?L6:	PRINTI " with Frobnian nationals. This is not allowed, as you must know."""
	CRLF
	CRLF
	PRINTI "You are questioned continuously just until your train is ready to depart, and as an added security measure, you are escorted back to your compartment. You realize that you must have done something to have raised the Frobnians' suspicion of you, but it is too late now. You have missed your rendezvous!"
	CRLF
	CRLF
	ICALL2 PRINT-ID,STR?293
	CALL1 FINISH >STACK
	RSTACK

	.FUNCT FZ-EXCUSES
	ZERO? BUMPER-FLAG /?L1
	PRINTI "The "
	ICALL2 DPRINT,BUMPER-FLAG
	PRINTI " seems to understand your apology and nods in acknowledgement."
	CRLF
	ICALL1 BAD-ARREST?
	SET 'BAD-SPEAKING,1
	RTRUE
?L1:	PRINT NO-FROBNIAN
	CRLF
	RTRUE

	.FUNCT FZ-MY-FAULT
	IN? CONTACT,HERE \?L1
	SET 'CONTACT-WAIT,1
	SET 'PASSWORD-GIVEN,1
	PRINTI "The "
	ICALL2 DPRINT,CONTACT
	PRINTI " makes eye contact, then looks away, nervously. You are evidently not what was expected.[RWD_ID: bystander:2908, VAL: 2]"
	CRLF
	CALL1 BAD-ARREST? >STACK
	RSTACK
?L1:	CALL1 FZ-EXCUSES >STACK
	RSTACK

	.FUNCT SIIF,PTR,LEN,FLEN,FOFF,FEXP,TMP,FWRD,FWLEN
	SET 'LEN,0
	SET 'FOFF,0
	GET OOPS-TABLE,O-CONT >PTR
	GET OOPS-TABLE,O-LEN >TMP
?L1:	GET P-LEXV,PTR >STACK
	EQUAL? STACK,W?$QUOTE /?L2
	DLESS? 'TMP,0 /?L2
	INC 'LEN
	ADD PTR,2 >PTR
	JUMP ?L1
?L2:	GET FROBNIAN,0 >FLEN
?L7:	IGRTR? 'FOFF,FLEN \?L9
	ZERO? BUMPER-FLAG /?L11
	PRINTI "The "
	ICALL2 DPRINT,BUMPER-FLAG
	PRINTI " looks confused. It doesn't appear that your Frobnian has made a big impression."
	CRLF
	SET 'BAD-SPEAKING,1
	ICALL1 BAD-ARREST?
	RTRUE
?L11:	PRINT NO-FROBNIAN
	CRLF
	RTRUE
?L9:	GET FROBNIAN,FOFF >FEXP
	GET FEXP,0 >FWRD
	GET FWRD,0 >FWLEN
	EQUAL? FWLEN,LEN \?L23
	SET 'TMP,0
	GET OOPS-TABLE,O-CONT >PTR
?L17:	IGRTR? 'TMP,FWLEN \?L19
	SET 'TMP,-1
	JUMP ?L18
?L19:	GET P-LEXV,PTR >STACK
	GET FWRD,TMP >STACK
	EQUAL? STACK,STACK \?L18
	ADD PTR,2 >PTR
	JUMP ?L17
?L18:	LESS? TMP,0 \?L23
	SET 'FOFF,-1
?L23:	LESS? FOFF,0 \?L7
	GET FEXP,1 >STACK
	ICALL1 STACK
	RTRUE

	.FUNCT TOPAZ-THOUGHT,CR
	ASSIGNED? 'CR /?L8
	SET 'CR,0
?L8:	ZERO? TOPAZ-THOUGHT-STR /FALSE
	EQUAL? CR,1 \?L3
	CRLF
	JUMP ?L5
?L3:	ZERO? CR \?L5
	PRINTI " "
?L5:	PRINT TOPAZ-THOUGHT-STR
	SET 'TOPAZ-THOUGHT-STR,0
	RTRUE

	.FUNCT BAD-GUN-F
	EQUAL? PRSA,V?POINT \?L1
	CALL1 GUN-POINT >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?PUT,V?THROW,V?DROP \?L3
	PRINTI "You might need it later. Better keep it around."
	CRLF
	CALL2 PRINT-ID,STR?294 >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "It's your Russian-made Gurthark Mark VI 45-caliber revolver. Not exactly standard issue, but clearly a Soviet product."

	.FUNCT BAD-WATCH-F
	EQUAL? PRSA,V?TAKE-OFF,V?DROP \?L1
	PRINTR "Time is critical - it would be foolish to be without your watch."
?L1:	EQUAL? PRSA,V?EXAMINE \?L3
	PRINTR "It's a Frotzni, a brand almost as popular in Frobnia as the Urbak."
?L3:	EQUAL? PRSA,V?READ \FALSE
	PRINTR "You can read the time on your status line."

	.FUNCT I-ASSASSINATION
	HLIGHT H-BOLD
	CRLF
	ICALL2 PRINT-ID,STR?295
	EQUAL? HERE,SNIPER-ROOM \?L1
	CALL2 JIGS-UP,STR?296 >STACK
	RSTACK
?L1:	CALL1 SQUARE-VIEW? >STACK
	ZERO? STACK /?L3
	CALL2 JIGS-UP,STR?297 >STACK
	RSTACK
?L3:	CALL2 JIGS-UP,STR?298 >STACK
	RSTACK

	.FUNCT I-FESTIVITIES,STR,FC
	DIV CLOCK-TIME,60 >STACK
	ADD STACK,1 >FC
	ZERO? FIGHT-IN-PROGRESS /?L1
	GET FESTIVITIES-F,FC >STR
	JUMP ?L3
?L1:	CALL1 SQUARE-VIEW? >STACK
	ZERO? STACK \?L4
	GET FESTIVITIES,FC >STR
	EQUAL? STR,-1 \?L3
?L4:	GET FESTIVITIES-SQ,FC >STR
?L3:	ZERO? STR /FALSE
	CALL2 BOLDTELL,STR >STACK
	RSTACK

	.FUNCT SQUARE-VIEW?
	GET SQUARE-VIEWS,0 >STACK
	ADD SQUARE-VIEWS,2 >STACK
	INTBL? HERE,STACK,STACK >STACK /?L1
?L1:	RSTACK

	.FUNCT MATCHES-F
	EQUAL? PRSA,V?REMOVE,V?KILL,V?ON \?L1
	PRINTR "You've tried this before on the train - the matches don't work; perhaps that's why they're given out for free. The mystery is why you're still holding on to them."
?L1:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L3
	PRINTR "The matchbook has no cover; anyone concerned about safety wouldn't be riding the Frobnian National Railroad anyway."
?L3:	EQUAL? PRSA,V?EXAMINE,V?READ \FALSE
	PRINTR "The matchbook bears the logo of the Frobnian National Railway with its motto, ""You will ride with us."""

	.FUNCT CIGARETTE-F
	EQUAL? PRSA,V?ON \?L1
	PRINTR "You haven't a lighter and the matches you're carrying have proven themselves useless; there'll be more time for a smoke after you finish your mission."
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "This cigarette is your last; you haven't had enough time to buy another pack since the fiasco on the train."

	.FUNCT BB2-MOVE
	CALL2 BB1-MOVE,BEHIND-BLDG-2 >STACK
	RSTACK

	.FUNCT BB1-MOVE,RM
	ASSIGNED? 'RM /?L4
	SET 'RM,BEHIND-BLDG-1
?L4:	PRINTI "You continue down Fremzi street, stopping behind the "
	EQUAL? RM,BEHIND-BLDG-1 \?L1
	PRINTI "apartment"
	JUMP ?L3
?L1:	PRINTI "office"
?L3:	PRINTI " building whose entrance would be on Ostnitz Street. There is no entrance here. Across the street, to the west, lies a vacant lot."
	CRLF
	SET 'DONT-DESCRIBE-ROOM,1
	RETURN RM

	.FUNCT BUILDING-F
	EQUAL? PRSA,V?ENTER \?L1
	EQUAL? HERE,BLDG-8,BLDG-3,BLDG-4 \?L3
	CALL2 DO-WALK,P?SOUTH >STACK
	RSTACK
?L3:	EQUAL? HERE,BLDG-7,BLDG-6,BLDG-5 \?L5
	CALL2 DO-WALK,P?NORTH >STACK
	RSTACK
?L5:	EQUAL? HERE,BLDG-1,BLDG-2 \?L6
	CALL2 DO-WALK,P?WEST >STACK
	RSTACK
?L6:	EQUAL? HERE,BEHIND-BLDG-1,BEHIND-BLDG-2 \?L7
	CALL2 DO-WALK,P?EAST >STACK
	RSTACK
?L7:	FSET? HERE,PENBIT \?L8
	CALL2 DO-WALK,P?IN >STACK
	RSTACK
?L8:	EQUAL? HERE,HALL-2,HALL-3,HALL-4 \?L9
	PRINTR "There are apartments to the east and west; which one do you want to enter?"
?L9:	PRINTI "There's no "
	EQUAL? HERE,HALL-1 /?L11
	PRINTI "building"
	JUMP ?L13
?L11:	PRINTI "apartment"
?L13:	PRINTR " to enter here."
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \?L14
	EQUAL? HERE,BLDG-8 \?L15
	PRINTI "It's hard to tell much from here, though it appears that "
	ZERO? ANTIQUE-FLAG /?L17
	PRINTI "the shop is closed"
	JUMP ?L20
?L17:	PRINTI "Riznik is inside"
	IN? CUSTOMER,ANTIQUE-SHOP \?L20
	PRINTI ", talking to a customer"
?L20:	PRINT PERIOD-CR
	RTRUE
?L15:	PRINTR "You'll have to get closer, and perhaps even enter the building for that."
?L14:	EQUAL? PRSA,V?EXAMINE \FALSE
	GET P-ADJW,0 >STACK
	EQUAL? STACK,W?APARTMENT \FALSE
	PRINTR "You'd get the best view of the apartment building from the town square."

	.FUNCT ANTIQUE-SIGN-F
	EQUAL? PRSA,V?EXAMINE,V?READ \FALSE
	PRINTR "
   Riznik's Antiques
 Rare Books and Curios"

	.FUNCT ANTIQUE-SHOP-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "The shop appears disorganized, with assorted antiques and bric-a-brac seemingly strewn haphazardly around the floor. What better cover for Riznik, one of the most meticulous and methodical agents it has been your pleasure to know. He stands at the counter now, "
	IN? CUSTOMER,HERE \?L3
	PRINTR "talking to a customer whose back is to you; he averts his gaze - something's wrong!"
?L3:	PRINTR "waving you toward him with a benevolent smile."

	.FUNCT CROWD-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	EQUAL? HERE,SNIPER-ROOM \?L3
	PRINTR "You look down at the square and nearby streets, which are practically overflowing with people pressed up against the barricades."
?L3:	CALL1 IN-PUBLIC? >STACK
	ZERO? STACK \?L5
	PRINTR "You can't see the crowd from here."
?L5:	PRINTR "The people are everywhere - tourists, businessmen, families - all turned out to witness the days' festivities."

	.FUNCT ANTIQUE-STORAGE-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTR "The room is small, dark, and cluttered. The door to the counter area is slightly ajar, and through it you can hear the police questioning your friend. He's doing his best, but they are persistent. A side door to the street lies to the west."

	.FUNCT CURIOS-F,FOO
	ASSIGNED? 'FOO /?L7
	SET 'FOO,0
?L7:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "You don't know much about "
	ZERO? FOO \?L3
	PRINTI "antiques"
	JUMP ?L5
?L3:	PRINTI "rare books"
?L5:	PRINTR ", but some of the pieces look quite rare and valuable. Someday, you will have to come here under more pleasant circumstances."

	.FUNCT RARE-BOOKS-F
	CALL2 CURIOS-F,1 >STACK
	RSTACK

	.FUNCT ANTIQUE-COUNTER-DOOR-F
	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	PRINTI "The sound of the door "
	EQUAL? PRSA,V?OPEN \?L3
	PRINTI "open"
	JUMP ?L5
?L3:	PRINTI "clos"
?L5:	PRINTI "ing alerts the police, who storm into the back room and take you into custody."
	CRLF
	ICALL2 PRINT-ID,STR?299
	CALL2 JIGS-UP,EPILOGUE-BAD-FAILS >STACK
	RSTACK

	.FUNCT ANTIQUE-CONVERSATION-F
	EQUAL? PRSA,V?EXAMINE,V?FOLLOW,V?LISTEN \?L1
	PRINTR "You can't make out every word, but the police are questioning your friend about certain acquaintences, affiliations, and the like."
?L1:	PRINTR "Bizarre."

	.FUNCT POLICE-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "They are ordinary policemen, here to provide extra security for the day's events."
?L1:	EQUAL? PRSA,V?YELL,V?CALL,V?TELL /?L4
	EQUAL? PRSA,V?HELLO \FALSE
?L4:	PRINTI "There is no reason to call attention to yourself; you're famous enough that they might recognize you and take you in for questioning."
	CRLF
	EQUAL? PRSA,V?TELL \TRUE
	ICALL1 STOP
	RTRUE

	.FUNCT ANTIQUE-STREET-DOOR-F
	EQUAL? PRSA,V?OPEN,V?UNLOCK \?L1
	PRINTR "You can't unlock or open the door from this side."
?L1:	EQUAL? PRSA,V?KNOCK \FALSE
	PRINTR "You bang on the door for a while and get no response; it occurs to you that Riznik, the antique dealer, and your contact, is hard of hearing."

	.FUNCT I-CUSTOMER-LEAVES
	ICALL1 DE-RT-QUEUE
	EQUAL? HERE,ANTIQUE-SHOP \?L1
	CRLF
	HLIGHT H-BOLD
	SET 'P-WALK-DIR,0
	ICALL PERFORM,V?TELL,CUSTOMER
	RTRUE
?L1:	EQUAL? HERE,BLDG-8 \?L3
	ICALL2 BOLDTELL,STR?300
?L3:	REMOVE CUSTOMER
	RTRUE

	.FUNCT COUNTER-ENTER
	PRINTI "You approach the counter "
	IN? CUSTOMER,ANTIQUE-SHOP \?L1
	PRINTI "and the proprietor turns away anxiously."
	CRLF
	SET 'P-WALK-DIR,0
	ICALL PERFORM,V?TELL,CUSTOMER
	RFALSE
?L1:	SET 'ANTIQUE-FLAG,1
	PRINTI "and the proprietor comes out from behind it to greet you. ""Welcome, my friend! How may I assist you? A clock, perhaps? A music box?"" He smiles warmly, but, sensing your urgency, stops abruptly. ""You are right to look worried. I am being watched. We must be very careful now."" You talk quickly, giving him a condensed version of what has happened, and why you are in need of information. He nods grimly, and draws closer. ""Then the businessman on the train must have smuggled the document across the border. You've seen the extra security, no doubt - the authorities must know about our plan! The 'event' is at noon, as the ambassador is speaking to the crowd. If you're going to get near our sniper, you'll need the password[RWD_ID: bad:707, VAL: 2] - """
	GET SNIPER-PASSWORD-TBL,SNIPER-CODE >STACK
	PRINT STACK
	PRINTI """; he is positioned in a window on the...

At just this moment, two uniformed policemen enter. ""You must go. Through the back!"" He shoves you forcibly through the door to the back room as the men approach.

The back room itself is small, dark, and cluttered. It's hard to tell the difference, in fact, between what lies out front and what lies in here. The door to the counter area is slightly ajar, and through it you can hear the police questioning your friend. He's doing his best, but they are persistent. It is not safe here any longer; the door to the street lies to the west."
	ICALL RT-QUEUE,I-POLICE-ENTER,95
	CRLF
	SET 'DONT-DESCRIBE-ROOM,1
	ZERO? CHASE-FLAG /?L4
	CRLF
	PRINTI "A moment later, Topaz bursts into the shop and alerts the police to your presence. Despite the protests of Riznik, they enter and take you into custody."
	CRLF
	ICALL2 PRINT-ID,STR?301
	ICALL2 JIGS-UP,EPILOGUE-BAD-FAILS
?L4:	RETURN ANTIQUE-STORAGE

	.FUNCT I-POLICE-ENTER
	ICALL1 DE-RT-QUEUE
	EQUAL? HERE,ANTIQUE-STORAGE \FALSE
	HLIGHT H-BOLD
	CRLF
	PRINTI "The proprietor, unable to hold off the policemen any longer, reluctantly lets them past the counter and into your hiding place. Finding you there, they take you into custody."
	CRLF
	ICALL2 PRINT-ID,STR?302
	CALL2 JIGS-UP,EPILOGUE-BAD-FAILS >STACK
	RSTACK

	.FUNCT COUNTER-F
	EQUAL? PRSA,V?WALK-TO \?L1
	ICALL2 DO-WALK,P?SOUTH
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "The counter is clear of the odds-and-ends which are scattered around the shop; the proprietor, your contact, is standing behind it."

	.FUNCT PROPRIETOR-F
	EQUAL? PRSA,V?WALK-TO \?L1
	ICALL2 DO-WALK,P?SOUTH
	RTRUE
?L1:	EQUAL? PRSA,V?HELLO,V?TELL \?L3
	IN? CUSTOMER,HERE \?L4
	ICALL PERFORM,V?TELL,CUSTOMER
	RTRUE
?L4:	PRINTI "It would be best to approach the man before talking."
	CRLF
	CALL1 STOP >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "The proprietor is well-known to you; he has been the KGB's local contact here for over a dozen years. On the surface a warm, though bookish man, he is in fact hard as nails."

	.FUNCT CUSTOMER-F
	EQUAL? PRSA,V?WALK-TO \?L1
	ICALL2 DO-WALK,P?SOUTH
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \?L3
	PRINTR "From here, it's difficult to tell much. Medium height, medium build, nothing special. Could be anyone."
?L3:	EQUAL? PRSA,V?HELLO,V?TELL-ABOUT,V?TELL \FALSE
	PRINTI "The customer turns around - his face doesn't register, but yours apparently does. He reaches under his coat and pulls out a revolver. ""You will come with me quietly,"" he begins. ""We do not wish any trouble here today."" With his free hand, he takes out his identification - local police. Could they have been tipped off? Could Topaz have gotten word across the border?"
	CRLF
	ICALL2 PRINT-ID,STR?303
	CALL2 JIGS-UP,EPILOGUE-BAD-FAILS >STACK
	RSTACK

	.FUNCT ANTIQUE-ENTER
	ZERO? ANTIQUE-FLAG /?L1
	PRINTI "The shop has been closed up; Riznik must have gotten out in a hurry."
	CRLF
	RFALSE
?L1:	PRINTI "A jingling of bells announces your presence in the antique shop.[RWD_ID: bad:837, VAL: 1] You close the door behind you, and find yourself in the midst of untold thousands of antiques, curios, and just plain junk. Just south of your position is the sales counter, behind which the proprietor is standing. You recognize him at once; Riznik, your local contact in Ostnitz - KGB through and through. He looks up at you"
	IN? CUSTOMER,ANTIQUE-SHOP \?L4
	PRINTI " nervously, and then starts talking again with a customer whose back is toward you"
	JUMP ?L6
?L4:	PRINTI ", your face registering at once, and waves you toward him with a smile"
?L6:	PRINT PERIOD-CR
	SET 'DONT-DESCRIBE-ROOM,1
	RETURN ANTIQUE-SHOP

	.FUNCT GLOBAL-WINDOW-F
	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \FALSE
	EQUAL? HERE,BLDG-8,BLDG-7,BLDG-6 /?L5
	EQUAL? HERE,BLDG-5,BLDG-4,BLDG-3 /?L5
	EQUAL? HERE,BLDG-2,BLDG-1 \?L3
?L5:	ICALL PERFORM,V?LOOK-INSIDE,BUILDING
	RTRUE
?L3:	ICALL PERFORM,V?EXAMINE,GLOBAL-BLDGS
	RTRUE

	.FUNCT GLOBAL-BLDGS-F
	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \FALSE
	CALL1 IN-PUBLIC? >STACK
	ZERO? STACK /?L3
	PRINTR "You look around at the various buildings and windows, and see nothing of interest. Perhaps the best spot to survey the entire area would be from the town square."
?L3:	PRINTR "You can't see much from where you're standing."

	.FUNCT SQUARE-BUILDINGS-F
	EQUAL? PRSA,V?LOOK-UP,V?WATCH,V?EXAMINE \FALSE
	PRINTI "You scan the buildings, looking for something, anything, that might help you locate the assassin. The only remarkable observation you can make is that, despite the winter weather, the apartment building has three open windows: "
	ICALL1 PRINT-OPEN-WINDOWS
	PRINTR ". It could be nothing - people watching the ceremonies from their room, health fanatics in need of fresh air, or just maybe a sniper lying in wait..."

	.FUNCT COLUMN-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "The column is tall and graceful, rising seventy feet into the air. It stands here to commemorate the War of Independence in which tens of thousands of Litzenburgers gave their lives in the cause of freedom."

	.FUNCT DAIS-F
	EQUAL? PRSA,V?CLIMB-ON,V?BOARD,V?ENTER \FALSE
	PRINTR "With the barricades and the police, you can't get near enough."

	.FUNCT HUTTINGER-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "Huttinger is an imposing figure, tall and broad-shouldered, his white mustache glistening in the sun. Everyone here reveres the man, and his appearance, despite his advancing years, is as grand as his reputation."
?L1:	CALL1 DIGNITARIES-F >STACK
	RSTACK

	.FUNCT MAYOR-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "You don't recognize the mayor of Ostnitz, though he is obvious from his ceremonial uniform."
?L1:	CALL1 DIGNITARIES-F >STACK
	RSTACK

	.FUNCT DIGNITARIES-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "You don't recognize them, but many are in uniform, representing the armed forces of Litzenburg. Others, no doubt, are foreigners who, like Ambassador Huttinger, are taking part in the events of the day."
?L1:	EQUAL? PRSA,V?MUNG,V?HIT,V?KILL /?L4
	EQUAL? PRSA,V?HELLO,V?TELL \FALSE
?L4:	PRINTI "You'd never get close enough for that."
	CRLF
	CALL1 KILL-VERB? >STACK
	ICALL PRINT-ID,STR?304,STACK
	CALL1 HARM-VERB? >STACK
	ICALL PRINT-ID,STR?305,STACK
	EQUAL? PRSA,V?HELLO,V?TELL /?L5
	PUSH 0
	JUMP ?L6
?L5:	PUSH 1
?L6:	ICALL PRINT-ID,STR?306,STACK
	EQUAL? PRSA,V?TELL \TRUE
	ICALL1 STOP
	RTRUE

	.FUNCT APARTMENT-GUARDS-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "They are evidently part of the beefed-up security that the police have put in place for today's events."
?L1:	EQUAL? PRSA,V?YELL,V?WAVE-AT,V?CALL \FALSE
	PRINTR "No sense calling attention to yourself."

	.FUNCT DIRECTORY-F
	EQUAL? PRSA,V?READ,V?EXAMINE \FALSE
	CALL1 PRINT-APT-DIR >STACK
	RSTACK

	.FUNCT APARTMENT-LOBBY-F,RARG
	EQUAL? RARG,M-ENTER \FALSE
	SET 'HALL-FLOOR,1
	RETURN HALL-FLOOR

	.FUNCT ELEVATOR-F
	EQUAL? PRSA,V?CALL \?L1
	FSET? ELEVATOR-DOOR,OPENBIT \?L3
	CALL1 TOO-LATE >STACK
	RSTACK
?L3:	EQUAL? HERE,HALL-1,HALL-2,HALL-3 \?L5
	PRINTR "You'll have to do that from the end of the hallway."
?L5:	ICALL PERFORM,V?PUSH,ELEVATOR-BUTTON
	RTRUE
?L1:	EQUAL? PRSA,V?BOARD,V?WALK-TO,V?ENTER \?L7
	ICALL2 DO-WALK,P?NORTH
	RTRUE
?L7:	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \FALSE
	FSET? ELEVATOR-DOOR,OPENBIT /?L11
	EQUAL? HERE,APARTMENT-LOBBY \?L9
?L11:	PRINTR "The elevator door is open; an older woman, the operator, is standing inside."
?L9:	PRINTR "The elevator isn't here now; you might try calling it."

	.FUNCT ELEVATOR-OPERATOR-F,?TMP
	EQUAL? HERE,APARTMENT-LOBBY /?L1
	FSET? ELEVATOR-DOOR,OPENBIT /?L1
	PRINTR "You can't see the elevator operator here. Perhaps if you called the elevator you'd have better luck."
?L1:	EQUAL? PRSA,V?EXAMINE \?L3
	PRINTR "She is an elderly woman, seventy years or more, wearing simple clothes. She looks at you expectantly, waiting for you to enter."
?L3:	PRINTI "No use doing that."
	CRLF
	CALL1 KILL-VERB? >STACK
	ICALL PRINT-ID,STR?307,STACK
	CALL1 HARM-VERB? >?TMP
	ZERO? ?TMP /?L6
	PUSH ?TMP
	JUMP ?L8
?L6:	EQUAL? PRSA,V?KISS /?L7
	PUSH 0
	JUMP ?L8
?L7:	PUSH 1
?L8:	CALL PRINT-ID,STR?308,STACK >STACK
	RSTACK

	.FUNCT WAITER-F
	EQUAL? PRSA,V?HELLO,V?TELL,V?CALL \?L1
	PRINTI "The help is very busy here and there is a long line for service; it would take a while to get their attention."
	CRLF
	EQUAL? PRSA,V?TELL \TRUE
	ICALL1 STOP
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "The waiters, in ceremonial dress for the occasion, are quite busy and are rushing to and fro trying to keep up with the customers."

	.FUNCT CAFE-FOOD-F
	EQUAL? PRSA,V?BUY,V?EAT,V?TAKE \FALSE
	PRINTR "There is a long line for tables; it would take quite a while to get a meal here."

	.FUNCT CAFE-TABLE-F
	EQUAL? PRSA,V?CLIMB-ON,V?SIT \FALSE
	PRINTR "The tables are all full and there appears to be quite a wait."

	.FUNCT BLDG-2-F,RARG
	EQUAL? RARG,M-ENTER-DESC \?L1
	ZERO? TOPAZ-FIGHT \?L1
	IN? TOPAZ,HERE \?L1
	ICALL RT-QUEUE,I-TOPAZ-SPOTS,5,I-TOPAZ-OFF
	FSET? TOPAZ,TOUCHBIT /?L3
	FSET TOPAZ,TOUCHBIT
	CRLF
	PRINTR "As you scan the cafe scene, you are taken aback by the sight of Topaz, sitting at a table not thirty feet from you, sipping on a tall drink and carefully watching the crowd. His left arm is in a sling, but he appears completely alert and, perhaps, dangerous. It seems he hasn't seen you yet."
?L3:	CRLF
	PRINTR "You look around, noticing that Topaz is still watchfully waiting at his table at the cafe."
?L1:	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "A sidewalk cafe sits here on Ostnitz Street facing the square to the east. Behind it, on office building is guarded by two policemen. Ostnitz Street continues north and south along the western edge of the square. Waiters scurry around, hopelessly trying to keep pace with the crowd that has gathered here looking for a drink and some shade."
	CRLF
	IN? TOPAZ,HERE \FALSE
	FSET? TOPAZ,NDESCBIT \FALSE
	CRLF
	PRINTR "Sitting at a table, not thirty feet away, is Topaz. His eyes take in the crowd, but he hasn't spotted you yet."

	.FUNCT I-TOPAZ-SPOTS
	ZERO? TOPAZ-FIGHT \FALSE
	ZERO? CHASE-FLAG \FALSE
	IGRTR? 'TOPAZ-SPOT-COUNT,6 \?L4
	ICALL2 BOLDTELL,STR?309
	SET 'I-FATAL,1
	ICALL1 START-CHASE
	RTRUE
?L4:	CALL RT-QUEUE,I-TOPAZ-SPOTS,5,I-TOPAZ-OFF >STACK
	RSTACK

	.FUNCT ALLEY-MOVE
	PRINTI "You move around the vendor's cart and enter the alley."
	CRLF
	CRLF
	RETURN ALLEY-2

	.FUNCT ALLEY-1-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	ZERO? CART-TOPPLED? /?L3
	PRINTR "The vendor's cart lies on its side here; soda cans and pretzels lie all over the ground. The street runs north-south here, with the square directly to the east."
?L3:	PRINTR "A street vendor's cart stands here, piled high with his wares - soda cans, mostly, but also hot dogs and pretzels. The street runs from north to south here, and the town square lies directly to your east. People are everywhere, pushing up toward the square and the dais from which the speakers will deliver their addresses."

	.FUNCT BUSINESS-CARD-F
	EQUAL? PRSA,V?READ,V?EXAMINE \FALSE
	CALL1 CAN-BE-FOUND >STACK
	RSTACK

	.FUNCT CAN-BE-FOUND
	PRINTI "The "
	ICALL2 DPRINT,PRSO
	PRINTR " can be found in your BORDER ZONE package."

	.FUNCT START-CHASE
	SET 'CHASE-FLAG,1
	SET 'TOPPLE-CHASE,CART-TOPPLED?
	MOVE TOPAZ,TOPAZ-ROOM
	CALL RT-QUEUE,I-TOPAZ,30,I-TOPAZ-OFF >STACK
	RSTACK

	.FUNCT I-TOPAZ-END
	HLIGHT H-BOLD
	CRLF
	PRINTI "Topaz, sensing your presence, swings around, and "
	ICALL2 PRINT-ID,STR?310
	ICALL1 TOPAZ-KILLS
	CALL2 JIGS-UP,STR?28 >STACK
	RSTACK

	.FUNCT TOPAZ-KILLS
	PRINTI "fires twice, hitting you in the chest with both rounds. You fall backward onto the floor, and Topaz approaches. ""That wasn't so awfully smart, you know, leaving this "
	CALL2 HALL-OBJECT?,SNIPER-HALL >STACK
	ICALL2 DPRINT,STACK
	PRINTI " for me to find."" He chuckles. He puts his gun to your head. ""For old times sake,"" he says, shrugging, and fires."
	RTRUE

	.FUNCT I-TOPAZ,L,TIM,NL
	LOC TOPAZ >L
	ZERO? L /FALSE
	GETP L,P?PATH >L
	MOVE TOPAZ,L
	EQUAL? L,SNIPER-ROOM \?L9
	CALL2 HALL-OBJECT?,SNIPER-HALL >STACK
	ZERO? STACK /?L4
	HLIGHT H-BOLD
	CRLF
	PRINTI "Without warning, Topaz bursts through the door, pistol raised, and fires three rounds at the sniper, who slumps to the floor in a pool of blood. "
	SET 'I-FATAL,1
	ICALL RT-QUEUE,I-TOPAZ-END,20
	ZERO? HIDING-BEHIND-DOOR /?L6
	PRINTI "He pauses, body tensed, and takes a hesitant step toward the window. He stops again; he's not three feet in front of you."
	REMOVE SNIPER
	MOVE SNIPER-CORPSE,HERE
	ICALL2 DE-QUEUE,I-ASSASSINATION-OFF
	HLIGHT H-NORMAL
	CRLF
	RTRUE
?L6:	PRINTI "In the same motion, he turns and "
	ICALL1 TOPAZ-KILLS
	ICALL2 PRINT-ID,STR?311
	CALL2 JIGS-UP,STR?28 >STACK
	RSTACK
?L4:	EQUAL? L,SNIPER-ROOM \?L9
	REMOVE TOPAZ
	SET 'TOPAZ-IN-HALL,1
	ICALL2 DE-QUEUE,I-TOPAZ-OFF
	ICALL1 DE-RT-QUEUE
	ICALL1 DE-SLOW-CLOCK-QUEUE
	CALL2 BOLDTELL,STR?312 >STACK
	RSTACK
?L9:	EQUAL? L,HERE \?L10
	HLIGHT H-BOLD
	CRLF
	PRINTI "Topaz grabs hold of you "
	ZERO? ON-THE-CAN /?L11
	SET 'ON-THE-CAN,0
	PRINTI "by the pants and pulls you down off the trash can."
	JUMP ?L13
?L11:	PRINTI "and spins you around."
?L13:	IN? CUSTOMER,HERE \?L14
	CRLF
	PRINTI "The customer, appearing to recognize Topaz, pulls out a gun and comes to his aid. Within moments, you are subdued."
	CRLF
	ICALL2 PRINT-ID,STR?313
	ICALL2 JIGS-UP,EPILOGUE-BAD-FAILS
?L14:	CRLF
	CRLF
	PRINTI "Before you can react, he lands a quick blow to your ribs, knocking you breathless. He's good, you think, though he lacks experience. You smile fleetingly, knowing yourself to be a damn good teacher."
	HLIGHT H-NORMAL
	CRLF
	ICALL1 DE-RT-QUEUE
	ICALL2 DE-QUEUE,I-TOPAZ-OFF
	SET 'TOPAZ-FIGHT,1
	FSET TOPAZ,OPENBIT
	SET 'CHASE-FLAG,0
	REMOVE CUSTOMER
	FCLEAR TOPAZ,NDESCBIT
	SET 'FIGHT-IN-PROGRESS,1
	ICALL2 I-CLOCKER,60
	ICALL2 BOLDTELL,STR?314
	ICALL2 PRINT-ID,STR?315
	ICALL2 I-CLOCKER,60
	HLIGHT H-BOLD
	CRLF
	PRINTI "You swing around, knocking Topaz to the "
	FSET? HERE,PENBIT /?L19
	FSET? HERE,HUTBIT \?L17
?L19:	PRINTI "floor"
	JUMP ?L20
?L17:	PRINTI "ground"
?L20:	PRINTI ", and then, a quick kick to the head and he's out."
	SET 'FIGHT-IN-PROGRESS,0
	CALL1 IN-PUBLIC? >STACK
	ZERO? STACK /?L21
	PRINTI " You turn to leave, but a small crowd has formed around you. ""It's alright. He tried to run off with my wallet, and I'm afraid I just got carried away. Excuse me."" You straighten yourself up and move away from the onlookers."
?L21:	HLIGHT H-NORMAL
	CRLF
	ICALL1 STATUS-LINE
	CALL2 I-CLOCKER,30 >STACK
	RSTACK
?L10:	GETP L,P?PATH >NL
	GETP L,P?PATH-TIME >TIM
	EQUAL? NL,HALL-1 \?L25
	EQUAL? HERE,SNIPER-ROOM \?L25
	SET 'I-FATAL,1
	HLIGHT H-BOLD
	CRLF
	PRINTI "You can hear Topaz's footsteps racing down the hall."
	CALL2 HALL-OBJECT?,SNIPER-HALL >STACK
	ZERO? STACK \?L27
	PRINTI " His footsteps slow down, then stop. He is being careful now, not knowing where to find his prey."
?L27:	HLIGHT H-NORMAL
	CRLF
	JUMP ?L36
?L25:	FSET? L,HUTBIT \?L30
	EQUAL? HERE,SNIPER-ROOM \?L30
	CALL2 HALL-OBJECT?,L >STACK
	ZERO? STACK /?L30
	EQUAL? L,SNIPER-HALL /?L30
	REMOVE TOPAZ
	ICALL2 DE-QUEUE,I-TOPAZ-OFF
	ICALL1 DE-RT-QUEUE
	ICALL1 DE-SLOW-CLOCK-QUEUE
	ICALL2 BOLDTELL,STR?316
	JUMP ?L36
?L30:	EQUAL? L,ALLEY-1 \?L31
	EQUAL? NL,ALLEY-2 \?L31
	ZERO? CART-TOPPLED? /?L31
	ZERO? TOPPLE-CHASE \?L31
	SET 'I-FATAL,1
	ICALL2 BOLDTELL,STR?317
	SET 'TIM,80
	JUMP ?L36
?L31:	EQUAL? L,ALLEY-3 \?L32
	EQUAL? NL,FIRE-1 \?L32
	CALL1 TOPAZ-VISIBLE? >STACK
	ZERO? STACK /?L33
	SET 'I-FATAL,1
	ICALL2 BOLDTELL,STR?318
?L33:	SET 'TIM,45
	JUMP ?L36
?L32:	CALL1 TOPAZ-VISIBLE? >STACK
	ZERO? STACK /?L36
	SET 'I-FATAL,1
	HLIGHT H-BOLD
	CRLF
	PRINTI "You look behind you; Topaz has just reached the "
	GETP L,P?FDESC >STACK
	PRINT STACK
	PRINTI "."
	HLIGHT H-NORMAL
	CRLF
?L36:	ICALL RT-QUEUE,I-TOPAZ,TIM,I-TOPAZ-OFF
	RFALSE

	.FUNCT REAL-HALL,RM
	GET FLOOR-PROPS,SNIPER-FLOOR >STACK
	GETP RM,STACK >STACK
	RSTACK

	.FUNCT HALL-OBJECT?,RM
	CALL2 REAL-HALL,RM >STACK
	FIRST? STACK >STACK /?L1
?L1:	RSTACK

	.FUNCT IN-PUBLIC?,OBJ,L
	ZERO? OBJ \?L1
	SET 'OBJ,WINNER
?L1:	LOC OBJ >L
	FSET? L,PENBIT /FALSE
	FSET? L,HUTBIT /FALSE
	EQUAL? L,ALLEY-2,ALLEY-3 /FALSE
	EQUAL? L,ANTIQUE-SHOP,ANTIQUE-STORAGE \TRUE
	RFALSE

	.FUNCT FOOD-F
	EQUAL? PRSA,V?BUY \?L1
	PRINTR "You already have one!"
?L1:	EQUAL? PRSA,V?READ,V?EXAMINE \?L3
	EQUAL? PRSO,SODA \?L3
	ICALL PERFORM,V?EXAMINE,SODA-CANS
	RTRUE
?L3:	EQUAL? PRSA,V?TAKE \?L4
	IN? PRSO,TOPAZ-ROOM /?L5
	IN? PRSO,HERE /?L5
	PRINTR "You've taken one of those already; you've got more important things on your mind."
?L5:	MOVE PRSO,WINNER
	PRINTI "You take the "
	ICALL2 DPRINT,PRSO
	PRINTI ". The vendor, in his confusion, will never be the wiser."
	CRLF
	CALL2 PRINT-ID,STR?319 >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?OPEN \?L8
	PRINTR "If you want to drink the soda, and waste precious time, just say so."
?L8:	EQUAL? PRSA,V?DRINK,V?EAT \FALSE
	MOVE PRSO,TOPAZ-ROOM
	SET 'CLOCK-MOVE,45
	PRINTI "You take a moment to finish the "
	ICALL2 DPRINT,PRSO
	EQUAL? PRSO,SODA \?L10
	PRINTI ", and you throw the can away"
?L10:	PRINT PERIOD-CR
	RTRUE

	.FUNCT VENDOR-STUFF-F
	EQUAL? PRSA,V?TAKE \?L1
	ZERO? CART-TOPPLED? \?L3
	PRINTI "The vendor wouldn't be very happy about that. You'll just have to wait your turn."
	CRLF
	CALL2 PRINT-ID,STR?320 >STACK
	RSTACK
?L3:	EQUAL? PRSO,HOT-DOGS \?L5
	PRINTI "They were inside the cart, so there aren't any lying around."
	CRLF
	CALL2 PRINT-ID,STR?321 >STACK
	RSTACK
?L5:	GETP PRSO,P?ACROSS >STACK
	LOC STACK >STACK
	ZERO? STACK \?L6
	PRINTI "Enough with the "
	ICALL2 DPRINT,PRSO
	PRINTI "! You've got more important things to do."
	CRLF
	CALL2 PRINT-ID,STR?322 >STACK
	RSTACK
?L6:	GETP PRSO,P?ACROSS >STACK
	CALL PERFORM,V?TAKE,STACK >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L8
	EQUAL? PRSO,SODA-CANS \?L8
	PRINTR "It's a can of IC Cola; you frown, remembering the businessman on the train and the role he has played in this affair."
?L8:	EQUAL? PRSA,V?BUY \FALSE
	PRINTR "There's quite a wait and you haven't much time."

	.FUNCT VENDOR-F
	EQUAL? PRSA,V?TELL,V?HELLO \?L1
	ICALL1 STOP
	PRINTI "The vendor is quite busy, though he acknowledges you with a brief shake of his "
	ZERO? CART-TOPPLED? /?L3
	PRINTI "fist"
	JUMP ?L5
?L3:	PRINTI "head"
?L5:	PRINT PERIOD-CR
	RTRUE
?L1:	EQUAL? PRSA,V?SHOW,V?GIVE \?L6
	PRINTR "He's very busy at the moment, which is apparently more than can be said about you."
?L6:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "He's your typical European street vendor, specializing in pretzels, soda, and hot dogs. He's got his hands full "
	ZERO? CART-TOPPLED? /?L8
	PRINTI "dealing with the mess of soda cans and pretzels from his toppled cart"
	JUMP ?L10
?L8:	PRINTI "with customers"
?L10:	PRINT PERIOD-CR
	RTRUE

	.FUNCT VENDOR-CART-F
	EQUAL? PRSA,V?EXAMINE \?L1
	ZERO? CART-TOPPLED? /?L3
	PRINTR "The cart is on its side, and its contents are strewn all along the sidewalk, blocking the entrance to the alley."
?L3:	PRINTR "The cart is quite large and piled high with cans of soft drinks and boxes of pretzels. Inside the cart, the vendor keeps his supply of hot dogs."
?L1:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L6
	PRINTR "That's the vendor's job, presumably."
?L6:	EQUAL? PRSA,V?MOVE,V?PUSH,V?TOPPLE \?L7
	ZERO? CART-TOPPLED? /?L8
	ICALL1 TOO-LATE
	RTRUE
?L8:	PUTP CART-DEBRIS,P?TRANSIENT,TOPPLED-CART-TRANSIENT
	ICALL DYNAMIC-DESC,BLDG-1,P?SOUTH,ALLEY-OOPS
	ICALL DYNAMIC-DESC,BLDG-2,P?NORTH,ALLEY-OOPS
	ICALL DYNAMIC-DESC,TOWN-SQUARE,P?WEST,ALLEY-OOPS
	ICALL DYNAMIC-DESC,ALLEY-1,P?WEST,STR?323
	ICALL DYNAMIC-DESC,ALLEY-2,P?EAST,STR?323
	PRINTI "With a hefty push, you manage to topple the entire cart, sending hundreds of cans of soda and dozens of pretzels flying. In the confusion, a few people are knocked to the ground, causing a sort of chain reaction in which dozens fall or are knocked down"
	ICALL2 PRINT-ID,STR?324
	EQUAL? HERE,ALLEY-2 \?L11
	IN? TOPAZ,ALLEY-1 \?L13
	PRINTI ", including Topaz, who is struggling to regain his footing"
	GET CLOCK-TBL,I-TOPAZ-OFF >STACK
	ADD STACK,30 >STACK
	PUT CLOCK-TBL,I-TOPAZ-OFF,STACK
?L13:	PRINT PERIOD-CR
	JUMP ?L16
?L11:	PRINTI ". You manage to sidestep this impending melee and "
	ZERO? CHASE-FLAG /?L17
	PRINTI "hurry"
	JUMP ?L19
?L17:	PRINTI "move"
?L19:	PRINTI " off into the safety of the alley."
	CRLF
	CRLF
	ICALL GOTO,ALLEY-2,0
	PRINTI "You're running down the alley now, just a few steps beyond the vendor's cart. The scene is somewhat comical, with dozens of people trying to regain their footing on a carpet of soda cans, which are acting like ball bearings."
	CRLF
?L16:	SET 'CART-TOPPLED?,1
	RTRUE
?L7:	EQUAL? PRSA,V?CLEAN \FALSE
	ZERO? CART-TOPPLED? /FALSE
	PRINTI "An amusing thought, though the vendor would probably kill you if you approached again."
	CRLF
	CALL2 PRINT-ID,STR?325 >STACK
	RSTACK

	.FUNCT DYNAMIC-DESC,RM,DIR,STR
	GETPT RM,DIR >STACK
	PUT STACK,SEXITSTR,STR
	RTRUE

	.FUNCT ALLEY-23
	ZERO? CHASE-FLAG /?L1
	PRINTI "You run down the alley to the far end. Above you, out of reach, a fire-escape ladder rises to the four stories of apartment building above."
	CRLF
	SET 'DONT-DESCRIBE-ROOM,1
	RETURN ALLEY-3
?L1:	PRINTI "You move down the alley until you reach the end - a high concrete wall."
	CRLF
	CRLF
	RETURN ALLEY-3

	.FUNCT ALLEY-2-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "The alley is narrow and thus somewhat darkened; to the east, people are walking along Ostnitz Street past the street vendor who"
	ZERO? CART-TOPPLED? /?L3
	PRINTI "se toppled cart and scattered wares almost completely block"
	JUMP ?L5
?L3:	PRINTI " partially blocks"
?L5:	PRINTR " the alley's entrance. The alley is bounded on the north and south by buildings; the one to the south is an office building of five stories; to the north lies an apartment building of the same height."

	.FUNCT ALLEY-3-F,RARG
	EQUAL? RARG,M-BEG \?L1
	EQUAL? PRSA,V?LEAP \?L1
	GET P-ITBL,P-PREP1N >STACK
	EQUAL? STACK,W?DOWN \?L3
	ZERO? ON-THE-CAN /?L5
	ICALL PERFORM,V?DISEMBARK,TRASH-CAN
	RTRUE
?L5:	PRINTR "That's nonsense."
?L3:	ZERO? ON-THE-CAN \?L8
	PRINTR "Your best jump leaves you a few feet short of the ladder."
?L8:	ICALL2 DO-WALK,P?UP
	RTRUE
?L1:	EQUAL? RARG,M-LOOK \FALSE
	PRINTR "Here, at the end, the buildings on either side of you rise five stories into the air; the one to the south is an office building, to the north an apartment building. On the side of the apartment building, a fire-escape ladder hangs about a dozen feet above the ground, climbing to windows on all four above ground levels. There is no access at all here to the office building."

	.FUNCT BOXES-F
	EQUAL? PRSA,V?STACK \?L1
	PRINTR "They're too flimsy to be stacked."
?L1:	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L3
	PRINTR "They're typical discarded boxes of different sizes."
?L3:	EQUAL? PRSA,V?PUT,V?MOVE \?L4
	PRINTR "They're so flimsy, they'd probably fall apart if you moved them."
?L4:	EQUAL? PRSA,V?CLIMB-ON,V?STAND-ON,V?BOARD \FALSE
	PRINTR "They're only cardboard; you might try something sturdier."

	.FUNCT TRASH-CAN-F
	EQUAL? PRSA,V?LEAVE,V?DISEMBARK,V?TAKE-OFF /?L3
	EQUAL? PRSA,V?LEAP-OFF,V?LEAP \?L1
?L3:	ZERO? ON-THE-CAN /?L4
	SET 'ON-THE-CAN,0
	PRINTR "You step off the can."
?L4:	CALL1 TOO-LATE >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?STAND-ON,V?BOARD,V?CLIMB-ON /?L8
	EQUAL? PRSA,V?CLIMB-UP \?L7
?L8:	ZERO? ON-THE-CAN /?L9
	CALL1 TOO-LATE >STACK
	RSTACK
?L9:	EQUAL? PRSA,V?BOARD \?L11
	GET P-ITBL,P-PREP1N >STACK
	EQUAL? STACK,W?IN,W?INTO \?L11
	PRINTR "Getting inside the trash can, while amusing, is not helpful."
?L11:	SET 'ON-THE-CAN,1
	PRINTI "You're now standing on top of the trash can"
	FSET TRASH-CAN,TOUCHBIT
	ZERO? CAN-UNDER-LADDER /?L13
	PRINTI ". From here, you can reach the bottom rungs of the ladder which hangs above your head"
	JUMP ?L15
?L13:	EQUAL? HERE,ALLEY-3 \?L15
	PRINTI ". You can't reach the ladder from here; you're high enough, but the can is positioned too far away laterally"
?L15:	PRINT PERIOD-CR
	RTRUE
?L7:	ZERO? ON-THE-CAN /?L17
	PRINTR "You're standing on it!"
?L17:	EQUAL? PRSA,V?PUT \?L18
	EQUAL? PRSI,TRASH-CAN \?L18
	PRINTR "No time for that now."
?L18:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L19
	PRINTR "The can seems to be missing its lid."
?L19:	EQUAL? PRSA,V?TAKE \FALSE
	SET 'CAN-UNDER-LADDER,0
	RFALSE

	.FUNCT FIRE-WINDOW-F,FL
	GETP HERE,P?SIZE >FL
	EQUAL? HERE,ALLEY-3 \?L1
	PRINTR "The windows are all above you."
?L1:	EQUAL? PRSA,V?BOARD,V?ENTER \?L3
	ICALL2 DO-WALK,P?IN
	RTRUE
?L3:	EQUAL? PRSA,V?RAISE,V?OPEN \?L4
	GET FIRE-WINDOW-TBL,FL >STACK
	ZERO? STACK \?L5
	PUT FIRE-WINDOW-TBL,FL,1
	PRINTR "You raise the window just enough to get through."
?L5:	CALL1 TOO-LATE >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?LOWER,V?CLOSE \FALSE
	GET FIRE-WINDOW-TBL,FL >STACK
	ZERO? STACK \?L9
	CALL1 TOO-LATE >STACK
	RSTACK
?L9:	PUT FIRE-WINDOW-TBL,FL,0
	PRINTR "You lower the window to the closed position."

	.FUNCT ALLEY-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "The alley runs east-west between the apartment building to the north and the office building to the south. It is rather narrow and somewhat dark. It ends at a concrete wall to the west and at the street end it is "
	ZERO? CART-TOPPLED? /?L3
	PRINTI "completely blocked by an overturned"
	JUMP ?L5
?L3:	PRINTI "partially blocked by a"
?L5:	PRINTI " street vendor's cart."
	CRLF
	ICALL1 TOPAZ-DESC
	RTRUE

	.FUNCT FIRE-LADDER-F
	EQUAL? PRSA,V?PUT-UNDER \?L1
	EQUAL? PRSO,TRASH-CAN \?L1
	ZERO? CAN-UNDER-LADDER /?L3
	CALL1 TOO-LATE >STACK
	RSTACK
?L3:	SET 'CAN-UNDER-LADDER,1
	PRINTI "You "
	IN? TRASH-CAN,WINNER \?L6
	PRINTI "put down the can and position it"
	JUMP ?L8
?L6:	PRINTI "move the can until it's positioned"
?L8:	MOVE TRASH-CAN,HERE
	PRINTR " just underneath the fire-escape ladder.[RWD_ID: bad:2390, VAL: 1]"
?L1:	EQUAL? PRSA,V?CLIMB-UP,V?CLIMB \?L9
	ICALL2 DO-WALK,P?UP
	RTRUE
?L9:	EQUAL? PRSA,V?CLIMB-DOWN \?L10
	ICALL2 DO-WALK,P?DOWN
	RTRUE
?L10:	EQUAL? PRSA,V?TAKE,V?CLIMB-ON,V?TOUCH \?L11
	EQUAL? HERE,ALLEY-3 \?L11
	ICALL2 DO-WALK,P?UP
	RTRUE
?L11:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "The ladder is made of iron, and it has rusted pretty badly. It runs along the outside of the apartment building, leading to windows on the second through fifth floors."
	EQUAL? HERE,ALLEY-3 \?L13
	PRINTI " The bottom rungs are about twelve feet above ground level, making it all but impossible to reach"
	ZERO? ON-THE-CAN /?L15
	PRINTI " unless, of course, you're standing on the trash can (which you are)"
?L15:	PRINTI "."
?L13:	CRLF
	RTRUE

	.FUNCT FIRE-LADDER-REACH
	ZERO? CAN-UNDER-LADDER /?L1
	ZERO? ON-THE-CAN /?L3
	SET 'ON-THE-CAN,0
	SET 'CAN-UNDER-LADDER,0
	PRINTI "You grab hold of the bottom rungs of the ladder and pull yourself onto the ladder, knocking the can over in the process."
	CRLF
	CRLF
	RETURN FIRE-1
?L1:	ZERO? ON-THE-CAN /?L3
	PRINTI "You're high enough, but the can is positioned too far away from the ladder."
	CRLF
	RFALSE
?L3:	PRINTI "You try jumping, but even then you can't reach the bottom rungs of the ladder."
	CRLF
	RFALSE

	.FUNCT FIRE-1-MOVE
	CALL FIRE-MOVE,FIRE-1,STR?326 >STACK
	RSTACK

	.FUNCT FIRE-2-MOVE
	CALL FIRE-MOVE,FIRE-2,STR?327 >STACK
	RSTACK

	.FUNCT FIRE-3-MOVE
	CALL FIRE-MOVE,FIRE-3,STR?328 >STACK
	RSTACK

	.FUNCT FIRE-4-MOVE
	CALL FIRE-MOVE,FIRE-4,STR?329 >STACK
	RSTACK

	.FUNCT FIRE-5-MOVE
	CALL FIRE-MOVE,FIRE-5,STR?330 >STACK
	RSTACK

	.FUNCT FIRE-MOVE,RM,STR
	PRINTI "You "
	ZERO? CHASE-FLAG /?L1
	PRINTI "scramble"
	JUMP ?L3
?L1:	PRINTI "move"
?L3:	PRINTI " "
	EQUAL? PRSO,P?UP \?L4
	PRINTI "up"
	JUMP ?L6
?L4:	PRINTI "down"
?L6:	PRINTI " the fire-escape ladder until reaching the landing at the "
	PRINT STR
	PRINTI " floor."
	EQUAL? RM,FIRE-5 \?L7
	PRINTI " The ladder ends here; there is no access to the roof."
?L7:	EQUAL? RM,FIRE-1 /?L10
	PRINTI " A window here leads to a hallway along which apartments are arranged on either side."
?L10:	CRLF
	SET 'DONT-DESCRIBE-ROOM,1
	RETURN RM

	.FUNCT LEAVE-HALL
	PRINTI "You crawl through the window and to the fire-escape ladder."
	CRLF
	CRLF
	GET HALL-EXIT-TBL,HALL-FLOOR >STACK
	RSTACK

	.FUNCT ELEVATOR-ROOM-F,RARG
	EQUAL? RARG,M-ENTER \FALSE
	ICALL1 STATUS-LINE
	ICALL2 DE-QUEUE,I-ELEVATOR-OFF
	PRINTI "The elevator operator says, ""Which floor, please?"""
	CRLF
	CRLF
	ZERO? CHASE-FLAG /?L3
	GRTR? HALL-FLOOR,1 \?L5
	LOC TOPAZ >STACK
	FSET? STACK,PENBIT \?L7
	PRINTI "At this moment, Topaz pulls himself through the window at the far end of the hall. Fearful that you are about to give him the slip, he"
	JUMP ?L9
?L7:	PRINTI "Topaz, still down the hall and fearful that you are about to give him the slip,"
?L9:	PRINTI " pulls out his revolver and fires twice, hitting you in the shoulder and leg. Wounded, but not seriously, you are taken to police headquarters, where you are treated and questioned."
	CRLF
	JUMP ?L10
?L5:	PRINTI "At this moment, Topaz bursts into the lobby, and motions to the police guards, who respond by grabbing you. Clearly, they are well aware of Topaz's identity. After a brief discussion between them, you are hustled off for questioning."
	CRLF
	ICALL2 PRINT-ID,STR?331
?L10:	ICALL2 JIGS-UP,EPILOGUE-BAD-FAILS
?L3:	CALL1 ELEVATOR-SEQUENCE >STACK
	ZERO? STACK /FALSE
	PRINTI "The operator closes the door, and the elevator slowly "
	GRTR? P-NUMBER,HALL-FLOOR \?L14
	PRINTI "climb"
	JUMP ?L16
?L14:	PRINTI "descend"
?L16:	PRINTI "s to the "
	GET CARDINALS,P-NUMBER >STACK
	PRINT STACK
	PRINTI " floor; having arrived, the operator opens the door and hustles you out the door."
	EQUAL? P-NUMBER,1 /?L17
	PRINTI " The elevator departs, presumably for the ground floor."
?L17:	CRLF
	CRLF
	SUB P-NUMBER,HALL-FLOOR >STACK
	CALL2 ABS,STACK >STACK
	MUL STACK,5 >STACK
	ADD 15,STACK >CLOCK-MOVE
	SET 'HALL-FLOOR,P-NUMBER
	EQUAL? P-NUMBER,1 \?L20
	ICALL2 GOTO,APARTMENT-LOBBY
	FSET ELEVATOR-DOOR,OPENBIT
	RTRUE
?L20:	FCLEAR ELEVATOR-DOOR,OPENBIT
	CALL2 GOTO,HALL-4 >STACK
	RSTACK

	.FUNCT ELEVATOR-SEQUENCE,PTR
?L0:	PRINTI ">>"
	PUTB P-INBUF,1,0
	READ P-INBUF,P-LEXV >STACK
	SET 'PTR,1
	CALL2 NUMBER?,PTR >STACK
	ZERO? STACK /?L1
	GRTR? P-NUMBER,0 \?L1
	LESS? P-NUMBER,6 \?L1
	EQUAL? HALL-FLOOR,P-NUMBER \TRUE
	PRINTI """We are already there, sir."" She escorts you off the elevator."
	CRLF
	EQUAL? HALL-FLOOR,1 \?L5
	ICALL GOTO,APARTMENT-LOBBY,0
	RFALSE
?L5:	ICALL GOTO,HALL-4,0
	RFALSE
?L1:	PRINTI """Please tell me the floor you wish to go to, from 1 to 5."""
	CRLF
	CRLF
	JUMP ?L0

	.FUNCT I-ELEVATOR-LEAVES
	FSET? HERE,HUTBIT \FALSE
	FCLEAR ELEVATOR-DOOR,OPENBIT
	CALL2 BOLDTELL,STR?332 >STACK
	RSTACK

	.FUNCT ELEVATOR-DOOR-F
	EQUAL? PRSA,V?OPEN \FALSE
	FSET? PRSO,OPENBIT /FALSE
	PRINTR "You might try pushing the call button."

	.FUNCT ELEVATOR-BUTTON-F
	EQUAL? PRSA,V?PUSH \FALSE
	FSET? ELEVATOR-DOOR,OPENBIT \?L3
	ICALL1 TOO-LATE
	RTRUE
?L3:	PRINTI "Click. You hear the sound of the elevator approaching slowly."
	CRLF
	ICALL RT-QUEUE,I-ELEVATOR-ARRIVES,45,I-ELEVATOR-OFF
	RTRUE

	.FUNCT I-ELEVATOR-ARRIVES
	EQUAL? HERE,HALL-4 \?L1
	ICALL2 BOLDTELL,STR?333
	JUMP ?L3
?L1:	FSET? HERE,HUTBIT \?L3
	ICALL2 BOLDTELL,STR?334
?L3:	FSET ELEVATOR-DOOR,OPENBIT
	ICALL RT-QUEUE,I-ELEVATOR-LEAVES,80,I-ELEVATOR-OFF
	RTRUE

	.FUNCT HALL-DOOR-F
	EQUAL? PRSA,V?SHOOT \?L1
	PRINTI "Risky at best; suicidal at worst."
	CRLF
	CALL2 PRINT-ID,STR?335 >STACK
	RSTACK
?L1:	EQUAL? PRSO,HALL-DOOR-W /?L4
	EQUAL? HALL-FLOOR,SNIPER-FLOOR \?L4
	EQUAL? HERE,SNIPER-HALL,SNIPER-ROOM \?L4
	EQUAL? HERE,SNIPER-ROOM /?L29
	GRTR? CLOCK-TIME,1000 \?L3
?L4:	EQUAL? PRSA,V?KNOCK \?L5
	PRINTI "You wait for a few seconds, but there is no answer."
	CRLF
	SET 'CLOCK-MOVE,20
	RETURN CLOCK-MOVE
?L5:	EQUAL? PRSA,V?LISTEN \?L7
	PRINTR "You can't hear anything from inside the apartment; if the sniper were a pro, you probably wouldn't hear him anyway."
?L7:	EQUAL? PRSA,V?KICK,V?UNLOCK,V?OPEN \?L8
	PRINTI "Rather unsubtle, don't you think. Surely you can think of something less likely to get you embarrassed or killed."
	CRLF
	CALL2 PRINT-ID,STR?336 >STACK
	RSTACK
?L8:	EQUAL? PRSA,V?EXAMINE \FALSE
	CALL1 TELL-ROOM-NUMBER >STACK
	RSTACK
?L3:	EQUAL? HERE,SNIPER-ROOM \?L11
?L29:	EQUAL? PRSA,V?EXAMINE \?L12
	PRINTR "The door is closed and locked from the inside."
?L12:	EQUAL? PRSA,V?UNLOCK,V?OPEN \?L14
	IN? SNIPER,HERE \?L14
	PRINTR "You move slowly toward the door, but the sniper's senses are sharper than your own. ""Please stay away from the door. There are enemy agents all around us; we must be on our guard!"" Backing away from the door, you find yourself thinking that your choices are few and unpleasant."
?L14:	EQUAL? PRSA,V?HIDE-BEHIND \?L15
	ZERO? HIDING-BEHIND-DOOR /?L16
	CALL1 TOO-LATE >STACK
	RSTACK
?L16:	SET 'HIDING-BEHIND-DOOR,1
	PRINTR "You move back toward the door a few feet; not enough to alarm the sniper, but enough to be out of the line of fire, should it come to that."
?L15:	EQUAL? PRSA,V?LISTEN \?L19
	PRINTR "You can't hear anything from the hallway."
?L19:	EQUAL? PRSA,V?KNOCK \FALSE
	PRINTR "You think twice; the sniper would probably kill you first."
?L11:	EQUAL? PRSA,V?EXAMINE \?L22
	CALL1 TELL-ROOM-NUMBER >STACK
	RSTACK
?L22:	EQUAL? PRSA,V?KICK \?L23
	PRINTI "This would no doubt alert the sniper, with dangerous results."
	CRLF
	CALL2 PRINT-ID,STR?337 >STACK
	RSTACK
?L23:	EQUAL? PRSA,V?LISTEN \?L24
	PRINTR "You can't hear anything from inside the apartment; if the sniper were a pro, you probably wouldn't hear him anyway."
?L24:	EQUAL? PRSA,V?OPEN \?L25
	PRINTR "You try the knob - the door is locked."
?L25:	EQUAL? PRSA,V?KNOCK \FALSE
	ZERO? AWAITING-PASSWORD \?L26
	SET 'AWAITING-PASSWORD,CLOCK-TIME
	PRINTR "There is a brief pause, then a heavily accented voice answers. There is a distinct tension in his voice as he says ""Say the word, please.[RWD_ID: bad:2897, VAL: 1] Quickly!"""
?L26:	EQUAL? PRSA,V?KNOCK \FALSE
	PRINTR "There is no answer. Your delay in answering the sniper puts you in a very dangerous position."

	.FUNCT CHECK-PASSWORD
	ZERO? AWAITING-PASSWORD /?L12
	SUB CLOCK-TIME,AWAITING-PASSWORD >STACK
	LESS? STACK,100 \?L1
	GET SNIPER-PASSWORD-VOC,SNIPER-CODE >STACK
	GET OOPS-TABLE,O-CONT >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,STACK \?L3
	PRINTI "The door opens slightly, and a small, dark man answers.[RWD_ID: bad:2913, VAL: 2] He waves a pistol in your direction, and glances both ways down the hall. "
	LOC TOPAZ >STACK
	FSET? STACK,HUTBIT \?L5
	ICALL2 PRINT-ID,STR?338
	CALL2 JIGS-UP,STR?339 >STACK
	RSTACK
?L5:	PRINTI "Satisfied that you were not followed, he motions you into the room. Again, reassuring himself that you weren't followed, he "
	CALL1 SNIPER-SPOTS? >STACK
	ZERO? STACK /?L8
	PRINTI "picks up the items on the ground, moves them into his room, "
?L8:	PRINTI "closes and locks the door, then walks back to the window. ""There is not much time,"" he says, blankly."
	CRLF
	CRLF
	PRINTI "The apartment is bare of all furniture. Kneeling in the window, perfectly motionless, the sniper eyes his target through the sights of his high-powered rifle."
	CRLF
	ICALL GOTO,SNIPER-ROOM,0
	RTRUE
?L3:	PRINTR "There is no reply, though you can hear a faint shuffling of feet through the door."
?L1:	ZERO? AWAITING-PASSWORD /?L12
	PRINTR "There is only silence coming from within the room."
?L12:	PRINTR "Nobody here seems interested in your words."

	.FUNCT SNIPER-SPOTS?,OBJ,OFF,F,N,FLG
	SET 'OFF,0
	SET 'FLG,0
	FIRST? SNIPER-HALL >F /?L4
	JUMP ?L3
?L1:	ZERO? F /?L3
?L4:	NEXT? F >N /?L7
?L7:	GETP F,P?SIZE >STACK
	GRTR? STACK,2 \?L8
	EQUAL? F,PROTAGONIST /?L8
	SET 'FLG,1
	JUMP ?L3
?L8:	SET 'F,N
	JUMP ?L1
?L3:	ZERO? FLG /FALSE
	ICALL MOVE-ALL,SNIPER-HALL,SNIPER-ROOM
	RTRUE

	.FUNCT MOVE-ALL,FROM,TO,F,N
	FIRST? FROM >F /?L4
	RTRUE
?L1:	ZERO? F /TRUE
?L4:	NEXT? F >N /?L7
?L7:	MOVE F,TO
	SET 'F,N
	JUMP ?L1

	.FUNCT SNIPER-WINDOW-F
	EQUAL? PRSA,V?EXAMINE,V?LOOK-INSIDE \?L1
	PRINTR "From here, you have a panoramic view of the town square and the ceremonies which will be going on throughout the afternoon."
?L1:	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	PRINTI "The sniper would kill you first."
	CRLF
	CALL2 PRINT-ID,STR?340 >STACK
	RSTACK

	.FUNCT SNIPER-F,WEAPON
	EQUAL? PRSA,V?SHOOT,V?KILL /?L3
	EQUAL? PRSA,V?POINT \?L1
	EQUAL? PRSO,BAD-GUN,REMINGTON \?L1
?L3:	SET 'WEAPON,BAD-GUN
	EQUAL? PRSA,V?POINT \?L4
	SET 'WEAPON,PRSO
	JUMP ?L7
?L4:	ZERO? PRSI /?L34
	SET 'WEAPON,PRSI
	JUMP ?L7
?L34:	IN? REMINGTON,WINNER \?L7
	SET 'WEAPON,REMINGTON
	PRINTI "[Assuming you're using the Remington.]"
	CRLF
	CRLF
?L7:	EQUAL? WEAPON,REMINGTON,BAD-GUN /?L9
	PRINTR "Some weapon..."
?L9:	PRINTI "You pull out "
	EQUAL? WEAPON,REMINGTON \?L12
	PRINTI "Topaz's"
	JUMP ?L14
?L12:	PRINTI "your"
?L14:	PRINTI " gun and fire at the sniper, who collapses to the floor in a bloody heap. The shots will most likely draw some attention, especially in light of the heightened security, so you make a hasty retreat from the room.

"
	ICALL2 PRINT-ID,STR?341
	ZERO? TOPAZ-IN-HALL \?L17
	ZERO? TOPAZ-FIGHT \?L15
	LOC TOPAZ >STACK
	FSET? STACK,HUTBIT \?L15
?L17:	ICALL2 PRINT-ID,STR?342
	CALL2 JIGS-UP,STR?343 >STACK
	RSTACK
?L15:	PRINTI "Epilogue

You return to the Soviet Union to file your report, but news of the incident has already reached the Kremlin, via additional local KGB agents who were on the scene and were friendly with the local police. Between the death of the Iranian by shots fired"
	EQUAL? WEAPON,REMINGTON \?L19
	PRINTI ", as it was painstakingly pieced together, by a gun which was stolen from an American agent,"
	JUMP ?L21
?L19:	PRINTI " from a Russian-made revolver"
?L21:	PRINTI " and the strange happenings on the train ending in the loss of a coded cable "
	EQUAL? WEAPON,REMINGTON \?L22
	PRINTI "to that SAME agent, a cable that had been entrusted to you"
	JUMP ?L24
?L22:	PRINTI "that was entrusted to you"
?L24:	ICALL2 PRINT-ID,STR?344
	CALL2 JIGS-UP,STR?345 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?KICK,V?PUT-THROUGH,V?STRANGLE /?L26
	EQUAL? PRSA,V?HIT,V?BITE /?L26
	EQUAL? PRSA,V?THROW \?L25
	EQUAL? PRSI,SNIPER \?L25
?L26:	ICALL2 PRINT-ID,STR?346
	CALL2 JIGS-UP,STR?347 >STACK
	RSTACK
?L25:	EQUAL? PRSA,V?WALK-TO \?L27
	PRINTR "The sniper notices you approach, and warns you back with his rifle. He's too watchful for you to approach him successfully."
?L27:	EQUAL? PRSA,V?HELLO,V?TELL,V?CALL \?L28
	PRINTI "The sniper motions for you to be quiet. ""I mind little the annoyance of being watched, but stay quiet or I cannot do the work."" He regards you with suspicion and a barely concealed contempt."
	CRLF
	EQUAL? PRSA,V?TELL \TRUE
	ICALL1 STOP
	RTRUE
?L28:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "He is crouching in the window, alternately staring through the sights of his high-powered rifle and at you. He would appear to be of Middle Eastern origin, though his nationality isn't entirely clear."

	.FUNCT SNIPER-RIFLE-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "It appears to be an East German made weapon; very professional. There should be no problem hitting Huttinger from this distance."
?L1:	EQUAL? PRSA,V?KICK,V?WALK-TO,V?TAKE \FALSE
	PRINTI "The sniper, already suspicious of your presence, fends you off as you approach."
	CRLF
	CALL2 PRINT-ID,STR?348 >STACK
	RSTACK

	.FUNCT SNIPER-ROOM-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "The room is bare of furniture; an open window looks out over the square. "
	IN? SNIPER,HERE \?L3
	PRINTI "The sniper is perched in that window; he seems to spend his time alternately looking through the sights and looking with suspicion at you, seemingly as ready to fire in your direction as in Huttinger's, and with as little concern for the outcome."
	JUMP ?L5
?L3:	PRINTI "The motionless body of the sniper is lying in a heap near the window."
?L5:	PRINTR " The door to the hallway lies to the west."
?L1:	EQUAL? RARG,M-BEG \FALSE
	IN? SNIPER,HERE \FALSE
	EQUAL? PRSA,V?TELL,V?SAY \?L7
	PRINTI "The sniper motions you to keep silent."
	CRLF
	CALL1 STOP >STACK
	RSTACK
?L7:	EQUAL? PRSA,V?CALL,V?YELL \FALSE
	PRINTI "The sniper would shoot you in an instant if you tried that."
	CRLF
	CALL2 PRINT-ID,STR?349 >STACK
	RSTACK

	.FUNCT TELL-ROOM-NUMBER,TMP
	PRINTI "The door is solid oak; the number "
	PRINTN HALL-FLOOR
	GETP HERE,P?SIZE >STACK
	DEC 'STACK
	MUL STACK,2 >TMP
	EQUAL? PRSO,HALL-DOOR-E \?L1
	INC 'TMP
?L1:	GET APT-LETTERS,TMP >STACK
	PRINT STACK
	PRINTR " is affixed on it in brass."

	.FUNCT FIRE-ROOM-F,RARG,FL
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "You're standing on the fire-escape ladder at the "
	GETP HERE,P?SIZE >FL
	GET CARDINALS,FL >STACK
	PRINT STACK
	PRINTI " floor. Through the "
	PRINTR "window in front of you, you can see a long corridor stretching out to the north."

	.FUNCT GLOBAL-TOPAZ-F
	EQUAL? PRSA,V?TELL,V?HELLO \?L1
	PRINTI "He's pretty far from you, and couldn't hear you well in this crowd noise."
	CRLF
	EQUAL? PRSA,V?TELL \TRUE
	ICALL1 STOP
	RTRUE
?L1:	EQUAL? PRSA,V?THROW \?L6
	EQUAL? PRSI,GLOBAL-TOPAZ \?L6
	REMOVE PRSO
	EQUAL? PRSO,SODA \?L7
	LOC TOPAZ >STACK
	FSET? STACK,PENBIT \?L9
	PRINTI "The can hits Topaz, causing him to lose his balance on the ladder. It will take him a little while to recover his footing."
	CRLF
	ICALL2 PRINT-ID,STR?350
	GET CLOCK-TBL,I-TOPAZ-OFF >STACK
	ADD STACK,15 >STACK
	PUT CLOCK-TBL,I-TOPAZ-OFF,STACK
	SET 'CLOCK-MOVE,3
	RETURN CLOCK-MOVE
?L9:	PRINTI "Topaz fends off the soda can; it must have hurt, but you haven't gained any time."
	CRLF
	ICALL2 PRINT-ID,STR?351
	SET 'CLOCK-MOVE,2
	RTRUE
?L7:	PRINTI "Topaz dodges the "
	ICALL2 DPRINT,PRSO
	PRINTR ". It wouldn't have done much damage, anyhow."
?L6:	EQUAL? PRSA,V?HELLO,V?CALL \?L13
	PRINTR "There's no time for conversation now; he'd kill you if he got close enough."
?L13:	EQUAL? PRSA,V?HIT,V?KILL,V?SHOOT /?L15
	EQUAL? PRSA,V?POINT \?L14
?L15:	FSET? HERE,PENBIT /?L18
	FSET? HERE,HUTBIT /?L18
	EQUAL? HERE,SNIPER-ROOM \?L16
?L18:	PRINTI "You consider it, but"
	JUMP ?L19
?L16:	PRINTI "At this distance, you'd probably take out a few innocent bystanders as well, and"
?L19:	PRINTI " after all ... he's on your side. Killing him would be a poor outcome indeed, though it might improve your stature with various elements of the KGB."
	CRLF
	CALL2 PRINT-ID,STR?352 >STACK
	RSTACK
?L14:	EQUAL? PRSA,V?SEARCH \?L20
	PRINTR "You wouldn't want to get that close."
?L20:	EQUAL? PRSA,V?EXAMINE \?L21
	CALL1 TOPAZ-VISIBLE? >STACK
	ZERO? STACK /?L22
	SET 'CLOCK-MOVE,3
	ICALL1 TELL-TOPAZ-MOVEMENT
	RTRUE
?L22:	ZERO? CHASE-FLAG /?L24
	PRINTR "You can't see him, but he's surely following you, just a few seconds behind."
?L24:	PRINTR "You can't see Topaz now."
?L21:	PRINTR "You aren't close enough."

	.FUNCT TOPAZ-F
	EQUAL? PRSA,V?SHOOT,V?HIT,V?KILL \?L1
	ZERO? HIDING-BEHIND-DOOR /?L1
	EQUAL? PRSA,V?SHOOT,V?KILL \?L3
	PRINTI "Rather than killing him, y"
	ICALL2 PRINT-ID,STR?353
	JUMP ?L5
?L3:	PRINTI "Y"
	ICALL2 PRINT-ID,STR?354
?L5:	PRINTI "ou hit Topaz on the back of his skull"
	IN? BAD-GUN,WINNER \?L6
	PRINTI " with your pistol"
?L6:	PRINTI ", knocking him out cold. You smile, thinking how neatly everything has worked out. Assassination thwarted. Topaz makes the kill. Viper barely escapes with his life. No bad publicity for the KGB.

Sure there'll be some forms to fill out, and there'll be some questioning, but you'll survive. You smile, and look over the scene - one corpse, one agent with a lot of potential, but a little rough around the edges. His story would be worth hearing someday, but it will have to wait. You walk through the door, tipping your hat to your unconscious counterpart. ""Until we meet again.""


Congratulations.[RWD_ID: bad:3276, VAL: 3] You have successfully completed the final chapter[EVENT: GAME OVER] of Border Zone. If you have enjoyed this game, or if you have comments, good or bad, please send them along to:

Infocom, Inc.
125 CambridgePark Drive
Cambridge, MA  02140
Attn: Topaz

"
	CALL1 FINISH >STACK
	RSTACK
?L1:	EQUAL? HERE,SNIPER-ROOM \?L9
	EQUAL? PRSA,V?TELL,V?YELL,V?CALL /?L12
	EQUAL? PRSA,V?SAY \FALSE
?L12:	ICALL1 STOP
	PRINTR "Unwise; he'd probably turn and shoot you."
?L9:	ZERO? TOPAZ-FIGHT /?L14
	EQUAL? PRSA,V?EXAMINE \?L15
	PRINTI "Topaz is sleeping blissfully at your feet; he should stay that way for quite a while."
	FIRST? TOPAZ >STACK \?L17
	PRINTI " "
	CALL1 V-LOOK-INSIDE >STACK
	RSTACK
?L17:	CRLF
	RTRUE
?L15:	EQUAL? PRSA,V?ENTER,V?BOARD,V?CLIMB-ON \?L20
	PRINTR "In this conservative country, that sort of behavior is frowned upon."
?L20:	EQUAL? PRSA,V?YELL,V?CALL,V?TELL /?L22
	EQUAL? PRSA,V?ALARM \?L21
?L22:	PRINTI "Too late for all that now."
	CRLF
	EQUAL? PRSA,V?TELL \TRUE
	ICALL1 STOP
	RTRUE
?L21:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L26
	PRINTR "A surgeon, you're not."
?L26:	EQUAL? PRSA,V?PUSH,V?MOVE \?L27
	PRINTR "He's OK as he is."
?L27:	EQUAL? PRSA,V?SHOOT \?L28
	PRINTI "He's already unconscious; no need to kill him."
	CRLF
	CALL2 PRINT-ID,STR?355 >STACK
	RSTACK
?L28:	EQUAL? PRSA,V?SEARCH \FALSE
	LOC REMINGTON >STACK
	ZERO? STACK \?L30
	MOVE REMINGTON,WINNER
	PRINTR "You search Topaz, taking his gun, a Remington 38-caliber revolver. He didn't have a scrap of ID on him."
?L30:	PRINTR "You don't find anything else of interest on Topaz."
?L14:	EQUAL? HERE,BLDG-2 \FALSE
	EQUAL? PRSA,V?TELL,V?HELLO \?L35
	ICALL1 STOP
	PRINTR "There's no time for talking to Topaz now, and what could you say now that would make any difference to him."
?L35:	EQUAL? PRSA,V?WALK-TO \?L37
	CALL2 TOPAZ-THOUGHT,2 >STACK
	ZERO? STACK \?L40
	PRINTI "You've already given up that idea."
?L40:	CRLF
	RTRUE
?L37:	EQUAL? PRSA,V?THROW \?L41
	EQUAL? PRSI,TOPAZ \?L41
	REMOVE PRSO
	PRINTI "The "
	ICALL2 DPRINT,PRSO
	PRINTI " misses Topaz, but it comes close enough to grab his attention. He rises from his table, and starts toward you."
	CRLF
	ICALL2 PRINT-ID,STR?356
	ICALL1 START-CHASE
	RTRUE
?L41:	EQUAL? PRSA,V?SHOOT \?L42
	PRINTI "Out here, in public, you'd never get away; and why would you want to shoot Topaz anyway?"
	CRLF
	CALL2 PRINT-ID,STR?357 >STACK
	RSTACK
?L42:	EQUAL? PRSA,V?EXAMINE \?L43
	PRINTR "He is sitting at the cafe, nursing a tall drink and his wounded left arm, and watching the crowd. He hasn't seen you yet."
?L43:	EQUAL? PRSA,V?WAVE-AT,V?YELL,V?CALL \?L44
	PRINTI "You call out for Topaz, who turns in your direction. He gets up and starts to come after you."
	CRLF
	ICALL1 START-CHASE
	RTRUE
?L44:	EQUAL? PRSA,V?POINT \?L45
	PRINTI "He won't see you pointing the gun at him."
	CRLF
	CALL2 PRINT-ID,STR?358 >STACK
	RSTACK
?L45:	PRINTR "You're not close enough for that."

	.FUNCT REMINGTON-F
	EQUAL? PRSA,V?POINT \?L1
	ICALL1 GUN-POINT
	CALL2 PRINT-ID,STR?359 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "It is a standard-issue American weapon."

	.FUNCT GUN-POINT
	PRINTR "Don't bother pointing it; just shoot it at something."

	.FUNCT TOPAZ-VISIBLE?,TL
	LOC TOPAZ >TL
	EQUAL? HERE,SNIPER-ROOM /FALSE
	EQUAL? HERE,ALLEY-1,ALLEY-2,ALLEY-3 /?L4
	FSET? HERE,PENBIT \?L3
?L4:	FSET? TL,PENBIT /TRUE
	EQUAL? TL,ALLEY-1,ALLEY-2,ALLEY-3 /TRUE
?L3:	FSET? HERE,HUTBIT \?L6
	FSET? TL,HUTBIT /TRUE
	GET FIRE-TBL,HALL-FLOOR >STACK
	EQUAL? TL,STACK /TRUE
?L6:	GETP TL,P?PATH >STACK
	EQUAL? STACK,HERE /TRUE
	EQUAL? TL,TOPAZ-ROOM \FALSE
	EQUAL? HERE,BLDG-1,ALLEY-1 /TRUE
	RFALSE

	.FUNCT TELL-TOPAZ-MOVEMENT,TL,NTL
	LOC TOPAZ >TL
	GETP TL,P?PATH >NTL
	CALL2 TOPAZ-DESC,0 >STACK
	ZERO? STACK \FALSE
	ZERO? TOPAZ-FIGHT /?L3
	PRINTR "Presumably, he's on the ground where you left him."
?L3:	PRINTI "Topaz is still following you; he's now between "
	GETP TL,P?FDESC >STACK
	PRINT STACK
	PRINTI " and "
	GETP NTL,P?FDESC >STACK
	PRINT STACK
	PRINT PERIOD-CR
	RTRUE

	.FUNCT TOPAZ-DESC,BOLD,L,NL,TMP,NLT
	ASSIGNED? 'BOLD /?L36
	SET 'BOLD,1
?L36:	LOC TOPAZ >L
	GETP L,P?PATH >NL
	GET CLOCK-TBL,I-TOPAZ-OFF >STACK
	SUB STACK,CLOCK-TIME >NLT
	CALL1 TOPAZ-VISIBLE? >STACK
	ZERO? STACK /FALSE
	EQUAL? L,ALLEY-3 \?L3
	EQUAL? NL,FIRE-1 \?L3
	ZERO? BOLD /?L5
	HLIGHT H-BOLD
	CRLF
?L5:	PRINTI "Topaz has "
	GRTR? NLT,20 \?L8
	PRINTI "arrived at the end of the alley. He is retrieving the trash can."
	JUMP ?L13
?L8:	GRTR? NLT,15 \?L10
	PRINTI "retrieved the trash can and is now positioning it under the ladder."
	JUMP ?L13
?L10:	GRTR? NLT,10 \?L11
	PRINTI "positioned the can and is now climbing on top of it."
	JUMP ?L13
?L11:	GRTR? NLT,5 \?L12
	PRINTI "just about climbed within reach of the ladder."
	JUMP ?L13
?L12:	PRINTI "reached the ladder and is pulling himself up onto it."
?L13:	HLIGHT H-NORMAL
	CRLF
	RTRUE
?L3:	FSET? L,PENBIT \?L14
	FSET? NL,PENBIT \?L14
	FSET? HERE,PENBIT /?L15
	EQUAL? HERE,HALL-1 \?L14
?L15:	ZERO? BOLD /?L16
	HLIGHT H-BOLD
	CRLF
?L16:	PRINTI "Topaz is climbing up the ladder, just "
	GETP L,P?SIZE >STACK
	GETP HERE,P?SIZE >STACK
	SUB STACK,STACK >TMP
	PRINTN TMP
	PRINTI " floor"
	EQUAL? TMP,1 /?L19
	PRINTI "s"
?L19:	PRINTI " beneath you."
	HLIGHT H-NORMAL
	CRLF
	RTRUE
?L14:	EQUAL? L,TOPAZ-ROOM \?L22
	ZERO? BOLD /?L23
	HLIGHT H-BOLD
	CRLF
?L23:	PRINTI "Topaz is entangled in a group of tourists who had been eating at the cafe, but he continues to move in your direction."
	HLIGHT H-NORMAL
	CRLF
	RTRUE
?L22:	LESS? NLT,21 \FALSE
	ZERO? BOLD /?L27
	HLIGHT H-BOLD
	CRLF
?L27:	LESS? NLT,6 \?L30
	PRINTI "Topaz is within a few dozen yards of you; if you don't keep moving, he'll be on top of you in just a few moments."
	JUMP ?L33
?L30:	LESS? NLT,11 \?L32
	PRINTI "Topaz is closing in; he can't be more than ten seconds behind you now."
	JUMP ?L33
?L32:	PRINTI "Topaz is running at full speed in your direction. He's probably only a few dozen seconds behind you now."
?L33:	HLIGHT H-NORMAL
	CRLF
	RTRUE

	.FUNCT PICK-NAME,TBL,ENT,OFF,DIR
?L1:	GET DIR-NAMES,0 >STACK
	DIV STACK,2 >STACK
	RANDOM STACK >STACK
	MUL STACK,2 >STACK
	SUB STACK,1 >OFF
	GET DIR-NAMES,OFF >ENT
	ZERO? ENT /?L1
	PUT TBL,0,ENT
	ADD OFF,1 >STACK
	GET DIR-NAMES,STACK >STACK
	PUT TBL,1,STACK
	PUT DIR-NAMES,OFF,0
	RTRUE

	.FUNCT FILL-DIR,CNT,TBL
	SET 'CNT,24
	ADD APT-DIR,2 >TBL
?L1:	DLESS? 'CNT,0 /TRUE
	ICALL2 PICK-NAME,TBL
	ADD TBL,4 >TBL
	JUMP ?L1

	.FUNCT PRINT-OPEN-WINDOWS,FLR
	SET 'FLR,3
?L1:	PRINTI "on the "
	GET CARDINALS,FLR >STACK
	PRINT STACK
	PRINTI " floor, "
	SUB FLR,2 >STACK
	MUL STACK,12 >STACK
	ADD STACK,8 >STACK
	GET APT-DIR,STACK >STACK
	LESS? STACK,0 \?L3
	PRINTI "near the middle"
	JUMP ?L5
?L3:	PRINTI "at the northern end"
?L5:	PRINTI " of the building"
	IGRTR? 'FLR,5 /TRUE
	EQUAL? FLR,5 \?L8
	PRINTI ", and "
	JUMP ?L1
?L8:	PRINTI ", "
	JUMP ?L1

	.FUNCT PICK-OPEN-WINDOWS,FLR,NUM,H
	SET 'FLR,3
	RANDOM 3 >STACK
	ADD STACK,2 >SNIPER-FLOOR
?L1:	RANDOM 100 >STACK
	LESS? 50,STACK /?L3
	SET 'H,HALL-3
	PUSH 8
	JUMP ?L5
?L3:	SET 'H,HALL-4
	PUSH 4
?L5:	SUB FLR,2 >STACK
	MUL STACK,12 >STACK
	ADD STACK,STACK >NUM
	GET APT-DIR,NUM >STACK
	SUB 0,STACK >STACK
	PUT APT-DIR,NUM,STACK
	EQUAL? FLR,SNIPER-FLOOR \?L6
	SET 'SNIPER-HALL,H
	SUB NUM,1 >STACK
	PUT APT-DIR,STACK,0
?L6:	IGRTR? 'FLR,5 \?L1
	RTRUE

	.FUNCT SNIPER-INIT
	RANDOM 4 >SNIPER-CODE
	ICALL1 FILL-DIR
	ICALL1 PICK-OPEN-WINDOWS
	CALL1 FILL-VACANCIES >STACK
	RSTACK

	.FUNCT FILL-VACANCIES,MAX,CNT,RND
	SET 'CNT,5
	GET APT-DIR,0 >STACK
	DIV STACK,2 >MAX
?L1:	DLESS? 'CNT,0 /TRUE
	RANDOM MAX >RND
	MUL RND,2 >STACK
	GET APT-DIR,STACK >STACK
	LESS? STACK,0 /?L6
	MUL RND,2 >STACK
	DEC 'STACK
	PUT APT-DIR,STACK,0
	JUMP ?L1
?L6:	INC 'CNT
	JUMP ?L1

	.FUNCT PRINT-APT-DIR,CNT,TMP,TBL,LEN
	SET 'CNT,-1
	CRLF
	PRINTI "           Gribnitz Apartments[RWD_ID: bad:3580, VAL: 1]"
	CRLF
	CRLF
	PRINTI "     2nd      3rd      4th      5th"
	CRLF
?L1:	ADD APT-DIR,2 >TBL
	CRLF
	IGRTR? 'CNT,5 /TRUE
	ADD CNT,65 >STACK
	PRINTC STACK
	PRINTI ": "
	MUL CNT,4 >STACK
	ADD TBL,STACK >TBL
	SET 'TMP,0
?L6:	IGRTR? 'TMP,4 /?L1
	GET TBL,0 >STACK
	ZERO? STACK \?L10
	PRINTI "         "
	JUMP ?L11
?L10:	GET TBL,0 >STACK
	PRINT STACK
	GET TBL,1 >LEN
	LESS? LEN,0 \?L12
	SUB 0,LEN >LEN
?L12:	SUB 9,LEN >STACK
	ICALL2 PRINT-SPACES,STACK
?L11:	ADD TBL,24 >TBL
	JUMP ?L6

	.FUNCT START-SCENARIO-1,INT?
	ASSIGNED? 'INT? /?L4
	SET 'INT?,0
?L4:	SET 'START-HOUR,17
	SET 'START-MINUTE,26
	SET 'CLOCK-TBL,CLOCK-TBL-1
	SET 'CLOCK-INTS,CLOCK-INTS-1
	SET 'MAX-WEIGHT,150
	SET 'SCENARIO,S-BYSTANDER
	SET 'HERE,COMP-5
	SET 'WINNER,PROTAGONIST
	REMOVE CLOTHES
	MOVE BYSTANDER-WATCH,WINNER
	MOVE BYSTANDER-CLOTHES,WINNER
	MOVE DOCUMENT,WINNER
	MOVE WINNER,HERE
	ICALL SLOW-CLOCK-QUEUE,I-BAD-SPY,20
	ICALL RT-QUEUE,I-BAD-TUNNEL,900
	ICALL2 INIT-STATUS-LINE,3
	ICALL1 STATUS-LINE
	ICALL1 UPDATE-TIME
	CALL2 PICK-ONE,BUMPERS >CONTACT
	PRINTI "

It is always a pleasure to leave Frobnia, and the ride is never over too soon. Sure, a plane would be faster, but as far as reliability goes, well ... better late than never, that's the best rule.

The train ride from Frzi to Vienna is into its sixth hour, and the train is fast approaching the border of neutral Litzenburg. You can breathe a lot easier there, just knowing that you're out from behind the Iron Curtain. It's even worth the border crossing - guards everywhere, suitcases searched - horrible, really, but there's no use complaining. There are worse countries to be importing goods from - you should know, you've been in most of them.

Just here, a few miles from the border, night is falling, and the lights of the small villages flicker into existence. You're drifting off into sleep when there is a knock on your compartment door, and a man, clutching his left arm, staggers inside. Drops of blood on his sleeve leave no doubt as to the cause.

""Don't be frightened,"" he begins, ""I'm all right."" Before you can speak, he begins his story. He is, it seems, an American agent who has just learned of a sinister plot to assassinate a top-ranking American diplomat tomorrow morning in Ostnitz, the town your train is fast approaching. He hands you a document, which he says must be passed to his contact at the train station there. You look through it, but it's all in Frobnian, and you know barely a handful of words - that's why you always carry your combination tourist guide and phrase book with you on your trips here.

""You must deliver this. I do not know who the contact is - he was supposed to find me. I was to wear this white carnation."" He pulls out the rumpled flower and pins it onto your jacket. ""He will bump into you and greet you with the words '"
	GETP CONTACT,P?FROBNIAN >STACK
	GET STACK,1 >STACK
	PRINT STACK
	PRINTI "' to which you should reply 'It is my fault.' Then, hand him the document and earn our country's thanks.""

He looks quickly over his shoulder - an instinct, perhaps. ""I must be going. You understand."" And with that, he disappears from the compartment."
	CRLF
	CRLF
	ZERO? INT? /TRUE
	ICALL1 V-LOOK
	RTRUE

	.FUNCT START-SCENARIO-2,INT?
	ASSIGNED? 'INT? /?L4
	SET 'INT?,0
?L4:	GETPT ME,P?SYNONYM >STACK
	PUT STACK,3,W?TOPAZ
	SET 'READ-CLOCK,10
	SET 'CLOCK-TIME,0
	REMOVE BYSTANDER-CLOTHES
	REMOVE BYSTANDER-WATCH
	SET 'START-HOUR,17
	SET 'START-MINUTE,49
	SET 'CLOCK-TBL,CLOCK-TBL-2
	SET 'CLOCK-INTS,CLOCK-INTS-2
	SET 'MAX-WEIGHT,40
	SET 'SCENARIO,S-GOOD
	SET 'HERE,B8
	SET 'WINNER,PROTAGONIST
	MOVE EXPLODING-PEN,WINNER
	MOVE NORMAL-SHOES,WINNER
	MOVE TIMING-OBJECT,WINNER
	MOVE CLOTHES,WINNER
	MOVE WINNER,HERE
	SET 'SHOES-WORN,NORMAL-SHOES
	REMOVE LEFT-ARM
	MOVE WOUNDED-LEFT-ARM,PROTAGONIST
	ICALL2 INIT-STATUS-LINE,3
	ICALL1 STATUS-LINE
	ICALL1 UPDATE-TIME
	SET 'CHRONOGRAPH-ON,1
	ICALL UPDATE-CHRONOGRAPH,0,1
	SET 'CHRONOGRAPH-ON,0
	PRINTI "

Cold. Pain.

What happened? I wasn't even active ... just making one of my monthly excursions to Vienna, keeping up the front ... George Bonnard, Vice President - Eastern Europe, IC Cola ... ""Drink It Up, Frobnia!"" What a laugh.

The train, yes ... of course ... Just past Yinsli, I spotted my archenemy ""Viper,"" only it wasn't him, it was a priest. But it "
	ICALL2 HLIGHTELL,STR?360
	PRINTI " him.

He vanished, lost in the crowd ... tourists, a honeymoon couple, something ... moonlight, thank God for that ... pitch black otherwise. OK, stop and think. You found him, his compartment, but he wasn't there. He left the briefcase, not as smart as his reputation, but that's not it. Wait.

Found the document, the assassination of - who? It's here, isn't it? No? Well, where the hell is it? But he came back, yes, Viper, and then the fight. And a shot, and Christ it hurts but at least it's not my "
	ICALL2 HLIGHTELL,STR?137
	PRINTI " arm...

Don't know how I got away ... must have done some damage myself. ""Border Stop! We will be arriving at the border in five minutes!"" But, the document... Oh, yes, the real McCoy ... the real businessman, the one in the dining car -  gave it to him knowing I'd be caught. He's got it, that is if "
	ICALL2 HLIGHTELL,STR?361
	PRINTI " haven't got "
	ICALL2 HLIGHTELL,STR?362
	PRINTI "...

It's clearer now. We went into a tunnel, and it was then that I knew ... the only chance, the only escape ... jumping off the train! The fall must have knocked me out cold for a few moments, but I seem alive enough. It can't be too far to the border, just a little to the north. If I don't die first.

"
	ZERO? INT? /TRUE
	ICALL1 V-LOOK
	RTRUE

	.FUNCT START-SCENARIO-3,INT?
	ASSIGNED? 'INT? /?L4
	SET 'INT?,0
?L4:	GETPT ME,P?SYNONYM >STACK
	PUT STACK,3,W?VIPER
	SET 'G-WATCH,0
	SET 'SL-WATCH,0
	SET 'CHRONOGRAPH-ON,0
	SET 'VERBOSE-CLOCK,0
	SET 'CLOCK-TIME,0
	SET 'READ-CLOCK,10
	SET 'START-HOUR,11
	SET 'START-MINUTE,47
	SET 'CLOCK-TBL,CLOCK-TBL-3
	SET 'CLOCK-INTS,CLOCK-INTS-3
	SET 'MAX-WEIGHT,100
	SET 'SCENARIO,S-BAD
	SET 'HERE,SQUARE-NW
	SET 'WINNER,PROTAGONIST
	ICALL1 SNIPER-INIT
	ICALL RT-QUEUE,I-CUSTOMER-LEAVES,265
	REMOVE CLOTHES
	MOVE BUSINESS-CARD,WINNER
	MOVE BAD-WATCH,WINNER
	MOVE BAD-GUN,WINNER
	MOVE CIGARETTE,WINNER
	MOVE MATCHES,WINNER
	MOVE BAD-CLOTHES,WINNER
	REMOVE CARNATION
	REMOVE WOUNDED-LEFT-ARM
	MOVE LEFT-ARM,PROTAGONIST
	MOVE WINNER,HERE
	ICALL2 INIT-STATUS-LINE,3
	ICALL1 STATUS-LINE
	ICALL1 UPDATE-TIME
	PRINTI "

""Vipna homitz, nimso klamitz."" ""A rotten fish will turn up eventually."" The American ""Murphy"" puts it better, perhaps, but your Frobnian expression seems to fit the circumstances.

Not that it started out that way. No, the Kremlin decided to assassinate the American ambassador to Litzenburg, and it's naturally a very sensitive affair, so they chose you to supervise - that is, keep it clean, keep the KGB and the Kremlin from appearing to be involved. That part wasn't hard - it didn't take long for your Litzenburger friends to find an angry, young Iranian who was more than willing to perform God's work...

No, your problem isn't keeping the job clean ... it's preventing it from happening, without blowing your cover. And you haven't spent the last ten years working your way up the KGB hierarchy just to start taking stupid chances now. Nobody said it would be easy being a double agent. So, coded cable in hand and dressed as a clergyman, you boarded the train to Ostnitz.

Enter a headstrong, street-smart American agent code-named Topaz - didn't have the slightest clue who you were. But smart enough to know that something was up, so he waylaid you, and took the cable. You smile that disturbing smile of yours at nobody in particular - if only he knew the code, he could have done your work for you!

Your first priority was retrieving the document, so the priest's garb had to go - the local authorities would respond better to the trench coat than to the cloth. But Topaz must have jumped - poor guy, doesn't have a chance. And that American businessman... something not quite right there, but nothing solid.

So now your job's doubly hard - knowing only that the assassination is in the Ostnitz town square, a little after noon. Fortunately, the KGB's local man is a good friend of yours, an antique dealer named Riznik. He probably even arranged the plan, so you can get the details from him. But even with the plan in hand, you'll still have your hands full - security is tight here, and some of the local police would find your presence here more than a little disturbing. You take a deep breath, and plunge into the milling crowd.

"
	ZERO? INT? /TRUE
	ICALL1 V-LOOK
	RTRUE

	.FUNCT OPENING-SCREEN,CHR
	CLEAR -1
	HLIGHT H-BOLD
	ICALL1 V-VERSION
	PRINTI "
Welcome to Border Zone. This story of international intrigue has three chapters, each telling a different piece of the story from a different point of view. You can play each chapter independently, but you will enjoy the story more if you play them in the proper order. If at any time you need to ""pause"" the game and cause the real-time clock to stop running (to get a sandwich or to read a long bit of text), use the PAUSE command.

The chapters are:

   Chapter 1: The Train
   Chapter 2: The Border
   Chapter 3: The Assassination
"
?L1:	CRLF
	PRINTI "Which chapter would you like to play: 1, 2, 3, or (R)estore? >"
	SET 'CHR,49
	EQUAL? CHR,49 \?L3
	ICALL1 START-SCENARIO-1
	RTRUE
?L3:	EQUAL? CHR,50 \?L5
	ICALL1 START-SCENARIO-2
	RTRUE
?L5:	EQUAL? CHR,51 \?L6
	ICALL1 START-SCENARIO-3
	RTRUE
?L6:	EQUAL? CHR,82,114 \?L7
	CRLF
	CALL1 V-RESTORE >STACK
	ZERO? STACK \?L1
?L7:	CRLF
	CRLF
	PRINTI "Just press ""1"", ""2"", ""3"", or ""R"" to start the game."
	CRLF
	JUMP ?L1

	.INSERT "annotated_games/borderzone/borderzone_str"
	.END
