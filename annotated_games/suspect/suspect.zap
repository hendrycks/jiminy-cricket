	.TIME
	.INSERT "suspect/suspect_freq"
	.INSERT "suspect/suspect_data"

	.FUNCT PRINT-DESC1,OBJ
	ZERO? OBJ /FALSE
	CALL DPRINT,OBJ >STACK
	RSTACK

	.FUNCT PRINT-ID,ID,CONDITION=1
	ZERO? CONDITION /FALSE
	PRINTI "[ID: "
	PRINT ID
	PRINTI ", PRSO: "
	CALL PRINT-DESC1,PRSO
	PRINTI ", PRSI: "
	CALL PRINT-DESC1,PRSI
	PRINTI "]"
	RTRUE

	.FUNCT PRINT-DEBUG,TEXT,CONDITION=1
	ZERO? CONDITION /FALSE
	PRINTI "DEBUG FLAG: "
	PRINT TEXT
	RTRUE

	.FUNCT IS-THEFT?
	EQUAL? PRSA,V?TAKE \FALSE
	EQUAL? PRSO,FAIRY-MASK,ALICIA-COAT,TRASH-BASKET /TRUE
	EQUAL? PRSO,HAMPER,DISK,SALE-FOLDER /TRUE
	EQUAL? PRSO,SALE-AGREEMENT,TRUST-FOLDER,TRUST-DOCUMENTS /TRUE
	EQUAL? PRSO,INVESTOR-LIST,DEATHMASK-BOOK,PLANTS /TRUE
	EQUAL? PRSO,TOOL-CHEST,CROWBAR,DOG \FALSE
	RTRUE

	.FUNCT IS-OBJECT-OR-PROPERTY?
	EQUAL? PRSO,ALICIA-CAR,ALICIA-COAT,ALICIA-HAIR /TRUE
	EQUAL? PRSO,ASTRONAUT-COSTUME,BACK-DOOR,BALLERINA-COSTUME /TRUE
	EQUAL? PRSO,BAR,BARN-DOOR,BMW /TRUE
	EQUAL? PRSO,BMW-TRUNK,BOOKCASE,BOOKCASES /TRUE
	EQUAL? PRSO,BULLET,BURGLAR-ALARM,CARD /TRUE
	EQUAL? PRSO,CHAIR,CHANDELIER,CHINA-CABINET /TRUE
	EQUAL? PRSO,COMPUTER,CORPSE,COSTUME-SHOP /TRUE
	EQUAL? PRSO,COWBOY-COSTUME,CROWBAR,CURTAINS /TRUE
	EQUAL? PRSO,DEATHMASK-BOOK,DETECTIVE-COAT,DINING-ROOM-TABLE /TRUE
	EQUAL? PRSO,DISCUSSION,DISK,DOGHOUSE /TRUE
	EQUAL? PRSO,DOORBELL,DRINK,DUFFY-COAT /TRUE
	EQUAL? PRSO,EAST-BATH-DOOR,EAST-CLOSET-DOOR,EAST-DOOR /TRUE
	EQUAL? PRSO,END-TABLE,EXPLORER-COSTUME,FAIRY-COSTUME /TRUE
	EQUAL? PRSO,FAIRY-MASK,FILE-CABINET,FIREPLACE /TRUE
	EQUAL? PRSO,FOOD,FRENCH-DOOR,FRONT-DOOR /TRUE
	EQUAL? PRSO,GARAGE-DOOR,GLASS,GLOBAL-BALLROOM /TRUE
	EQUAL? PRSO,GLOBAL-CHAIR,GLOBAL-DOORBELL,GLOBAL-DRINK /TRUE
	EQUAL? PRSO,GLOBAL-PLANTS,GLOBAL-RUG,GLOBAL-SOFA /TRUE
	EQUAL? PRSO,GORILLA-COSTUME,GUNBELT,HAIR /TRUE
	EQUAL? PRSO,HALLWAY,HAMPER,HANDCUFFS /TRUE
	EQUAL? PRSO,HAREM-COSTUME,HARLEQUIN-COSTUME,HOUSE /TRUE
	EQUAL? PRSO,INVESTOR-LIST,KEY,LABEL /TRUE
	EQUAL? PRSO,LARGE-DESK,LH-DOOR,LIBRARY-DOOR /TRUE
	EQUAL? PRSO,LINDA-HAIR,LINEN-CLOSET-DOOR,LIQUID /TRUE
	EQUAL? PRSO,LR-FIREPLACE,MANTEL,MASK /TRUE
	EQUAL? PRSO,MEDIA-OFFICE-DOOR,MEDIA-ROOM-DOOR,MERCEDES /TRUE
	EQUAL? PRSO,MERCEDES-TRUNK,MH-DOOR,MORNING-ROOM-DOOR /TRUE
	EQUAL? PRSO,NORTH-DOOR,NORTH-OFFICE-DOOR,NOTEBOOK /TRUE
	EQUAL? PRSO,OFFICE-JUNK,PEN,PLANTS /TRUE
	EQUAL? PRSO,POLICE-CAR,PORTRAITS,PUMPKIN /TRUE
	EQUAL? PRSO,RECORD-PLAYER,ROPE,SALE-AGREEMENT /TRUE
	EQUAL? PRSO,SALE-FOLDER,SHEIK-COSTUME,SHOWER /TRUE
	EQUAL? PRSO,SIDE-TABLE,SIDEBOARD,SINK /TRUE
	EQUAL? PRSO,SITTING-ROOM-DOOR,SLIDING-DOOR,SMALL-DESK /TRUE
	EQUAL? PRSO,SOUTH-OFFICE-DOOR,STAIN,STAIN-SAMPLE /TRUE
	EQUAL? PRSO,STAIR,SUN-ROOM-DOOR,TAXI /TRUE
	EQUAL? PRSO,TELEPHONE,TELEVISION,TOILET /TRUE
	EQUAL? PRSO,TOOL-CHEST,TRASH,TRASH-BASKET /TRUE
	EQUAL? PRSO,TRUST-DOCUMENTS,TRUST-FOLDER,VAMPIRE-COSTUME /TRUE
	EQUAL? PRSO,VCR,VELVET-RIBBON,VERONICA-HAIR /TRUE
	EQUAL? PRSO,VIDEOTAPE,WALKWAY-DOOR,WASTE-BASKET /TRUE
	EQUAL? PRSO,WEREWOLF-COSTUME,WEST-BATH-DOOR,WEST-CLOSET-DOOR /TRUE
	EQUAL? PRSO,WEST-DOOR,WINDOW,WINDOW-SEAT /TRUE
	EQUAL? PRSO,WORKBENCH,WRITING-DESK /TRUE
	CALL IS-STRUCTURE? >STACK
	RSTACK

	.FUNCT IS-STRUCTURE?
	EQUAL? PRSO,BACK-PORCH,DINING-ROOM,EAST-BATH /TRUE
	EQUAL? PRSO,EAST-COAT-CLOSET,KITCHEN,LIBRARY /TRUE
	EQUAL? PRSO,LINEN-CLOSET,LIVING-ROOM,MEDIA-ROOM /TRUE
	EQUAL? PRSO,MORNING-ROOM,OFFICE,PATIO /TRUE
	EQUAL? PRSO,POLICE-LAB,PORCH,SITTING-ROOM /TRUE
	EQUAL? PRSO,SUN-ROOM,WALKWAY,WEST-BATH /TRUE
	EQUAL? PRSO,WEST-COAT-CLOSET \FALSE
	RTRUE

	.FUNCT IS-PERSON?
	EQUAL? PRSO,ALICIA,BARTENDER,BUTLER /TRUE
	EQUAL? PRSO,COCHRANE,COL-MARSTON,DETECTIVE /TRUE
	EQUAL? PRSO,DUFFY,GLOBAL-ALICIA,GLOBAL-BARTENDER /TRUE
	EQUAL? PRSO,GLOBAL-BUTLER,GLOBAL-COCHRANE,GLOBAL-COL-MARSTON /TRUE
	EQUAL? PRSO,GLOBAL-DETECTIVE,GLOBAL-DUFFY,GLOBAL-LINDA /TRUE
	EQUAL? PRSO,GLOBAL-MICHAEL,GLOBAL-OSTMANN,GLOBAL-RICHARD /TRUE
	EQUAL? PRSO,GLOBAL-SEN-ASHER,GLOBAL-VERONICA,GUEST /TRUE
	EQUAL? PRSO,HIM-HER,JACK,JACKSON /TRUE
	EQUAL? PRSO,LINDA,MICHAEL,OSTMANN /TRUE
	EQUAL? PRSO,POLICE,RICHARD,SEN-ASHER /TRUE
	EQUAL? PRSO,VERONICA,LOCAL-BAND \FALSE
	RTRUE

	.FUNCT IS-ANIMAL?
	EQUAL? PRSO,DOG,HORSE \FALSE
	RTRUE

	.FUNCT IS-SELF?
	EQUAL? PRSO,PLAYER,ME,YOU \FALSE
	RTRUE

	.FUNCT IS-PART-OF-SELF?
	EQUAL? PRSO,HANDS \FALSE
	RTRUE

	.FUNCT IS-SELF-OR-PART-OF-SELF?,?TMP
	CALL IS-SELF? >?TMP
	ZERO? ?TMP /?L2
	RETURN ?TMP
?L2:	CALL IS-PART-OF-SELF? >STACK
	RSTACK

	.FUNCT IS-YOUR-PROPERTY?
	EQUAL? PRSO,YOUR-COAT,PEN,NOTEBOOK \FALSE
	RTRUE

	.FUNCT DANGEROUS-DRINK?
	EQUAL? PRSO,STAIN \FALSE
	RTRUE

	.FUNCT DANGEROUS-FOOD?
	CALL IS-PART-OF-SELF? >STACK
	ZERO? STACK \?L2
	CALL IS-OBJECT-OR-PROPERTY? >STACK
	ZERO? STACK /FALSE
?L2:	EQUAL? PRSO,FOOD,DRINK,LIQUID /FALSE
	EQUAL? PRSO,WATER,STAIN \TRUE
	RFALSE

	.FUNCT IS-OBJ-PROP-ANIMAL?,?TMP
	CALL IS-OBJECT-OR-PROPERTY? >?TMP
	ZERO? ?TMP /?L2
	RETURN ?TMP
?L2:	CALL IS-ANIMAL? >STACK
	RSTACK

	.FUNCT QUEUE,RTN,TICK,CINT
	CALL INT,RTN >CINT
	PUT CINT,C-TICK,TICK
	RETURN CINT

	.FUNCT INT,RTN,E,C,INT?1
	ADD C-TABLE,C-TABLELEN >E
	ADD C-TABLE,C-INTS >C
?L1:	EQUAL? C,E \?L3
	SUB C-INTS,C-INTLEN >C-INTS
	ADD C-TABLE,C-INTS >INT?1
	PUT INT?1,C-RTN,RTN
	RETURN INT?1
?L3:	GET C,C-RTN >STACK
	EQUAL? STACK,RTN \?L5
	RETURN C
?L5:	ADD C,C-INTLEN >C
	JUMP ?L1

	.FUNCT CLOCKER,C,E,TICK,FLG=0,VAL
	ZERO? CLOCK-WAIT /?L1
	SET 'CLOCK-WAIT,0
	RFALSE
?L1:	INC 'PRESENT-TIME
	IGRTR? 'MOVES,59 \?L6
	SET 'MOVES,0
	IGRTR? 'SCORE,23 \?L6
	SET 'SCORE,0
?L6:	ADD C-TABLE,C-INTS >C
	ADD C-TABLE,C-TABLELEN >E
?L10:	EQUAL? C,E \?L12
	RETURN FLG
?L12:	GET C,C-ENABLED? >STACK
	ZERO? STACK /?L20
	GET C,C-TICK >TICK
	ZERO? TICK /?L20
	SUB TICK,1 >STACK
	PUT C,C-TICK,STACK
	GRTR? TICK,1 /?L20
	GET C,C-RTN >STACK
	CALL STACK >VAL
	ZERO? VAL /?L20
	ZERO? FLG /?L22
	EQUAL? VAL,M-FATAL \?L20
?L22:	SET 'FLG,VAL
?L20:	ADD C,C-INTLEN >C
	JUMP ?L10

	.FUNCT DPRINT,O,CAP?=0,S
	FSET? O,THE \?L5
	ZERO? CAP? /?L3
	PRINTI "The "
	JUMP ?L5
?L3:	PRINTI "the "
?L5:	GETP O,P?SDESC >S
	ZERO? S /?L7
	PRINT S
	RTRUE
?L7:	PRINTD O
	RTRUE

	.FUNCT THE-PRINT,O,CAP?=0,S
	FSET? O,THE /?L3
	FSET? O,PERSON /?L6
	FSET? O,FEMALE /?L6
?L3:	ZERO? CAP? /?L4
	PRINTI "The "
	JUMP ?L6
?L4:	PRINTI "the "
?L6:	GETP O,P?SDESC >S
	ZERO? S /?L8
	PRINT S
	RTRUE
?L8:	PRINTD O
	RTRUE

	.FUNCT HE$002fSHE-PRINT,O
	FSET? O,PERSON /?L1
	PRINTI "it"
	RTRUE
?L1:	FSET? O,FEMALE \?L3
	PRINTI "she"
	RTRUE
?L3:	PRINTI "he"
	RTRUE

	.FUNCT HIM$002fHER-PRINT,O,POSSESSIVE?=0
	FSET? O,PERSON /?L1
	ZERO? POSSESSIVE? /?L3
	PRINTI "it's"
	RTRUE
?L3:	PRINTI "it"
	RTRUE
?L1:	FSET? O,FEMALE \?L6
	PRINTI "her"
	RTRUE
?L6:	ZERO? POSSESSIVE? /?L7
	PRINTI "his"
	RTRUE
?L7:	PRINTI "him"
	RTRUE

	.FUNCT PRINTA,O,S
	FSET? O,THE \?L1
	PRINTI "the "
	JUMP ?L4
?L1:	FSET? O,AN \?L3
	PRINTI "an "
	JUMP ?L4
?L3:	FSET? O,PERSON /?L4
	PRINTI "a "
?L4:	GETP O,P?SDESC >S
	ZERO? S /?L6
	PRINT S
	RTRUE
?L6:	PRINTD O
	RTRUE

	.FUNCT PICK-ONE,FROB?1,L,CNT,RND,MSG,RFROB
	GET FROB?1,0 >L
	GET FROB?1,1 >CNT
	DEC 'L
	ADD FROB?1,2 >FROB?1
	MUL CNT,2 >STACK
	ADD FROB?1,STACK >RFROB
	GRTR? PRESENT-TIME,540 \?L1
	SUB L,CNT >STACK
	RANDOM STACK >RND
	JUMP ?L3
?L1:	SET 'RND,1
?L3:	GET RFROB,RND >MSG
	GET RFROB,1 >STACK
	PUT RFROB,RND,STACK
	PUT RFROB,1,MSG
	INC 'CNT
	EQUAL? CNT,L \?L4
	SET 'CNT,0
?L4:	PUT FROB?1,0,CNT
	RETURN MSG

	.FUNCT PROB,BASE
	GRTR? PRESENT-TIME,540 \FALSE
	RANDOM 100 >STACK
	LESS? BASE,STACK \TRUE
	RFALSE

	.FUNCT ABS,NUM
	LESS? NUM,0 \?L1
	SUB 0,NUM >STACK
	RSTACK
?L1:	RETURN NUM

	.FUNCT GO
START::
?L0:	SET 'SCORE,21
	SET 'WINNER,PLAYER
	SET 'HERE,BALLROOM-9
	FSET? HERE,TOUCHBIT /?L1
	CALL QUEUE-MAIN-EVENTS
	CALL START-MOVEMENT
	CALL V-VERSION
	CALL INTRO
?L1:	CALL THIS-IS-S-HE,MICHAEL
	MOVE PLAYER,HERE
	CALL V-LOOK
	CALL I-WAVE
	CALL MAIN-LOOP
	JUMP ?L0

	.FUNCT MAIN-LOOP,ICNT,OCNT,NUM,CNT,OBJ,TBL,V,PTBL,OBJ1,TMP,ACTED
?L1:	SET 'CNT,0
	SET 'OBJ,0
	SET 'PTBL,1
	SET 'ACTED,0
	EQUAL? QCONTEXT-ROOM,HERE /?L3
	SET 'QCONTEXT,0
?L3:	SET 'P-WALK-DIR,0
	CALL PARSER >P-WON
	ZERO? P-WON /?L6
	LOC PLAYER >LAST-PLAYER-LOC
	EQUAL? P-WON,M-FATAL /?L8
	GET P-PRSI,P-MATCHLEN >ICNT
	GET P-PRSO,P-MATCHLEN >OCNT
	ZERO? OCNT \?L10
	SET 'NUM,OCNT
	JUMP ?L17
?L10:	GRTR? OCNT,1 \?L12
	SET 'TBL,P-PRSO
	ZERO? ICNT \?L13
	SET 'OBJ,0
	JUMP ?L15
?L13:	GET P-PRSI,1 >OBJ
?L15:	SET 'NUM,OCNT
	JUMP ?L17
?L12:	GRTR? ICNT,1 \?L16
	SET 'PTBL,0
	SET 'TBL,P-PRSI
	GET P-PRSO,1 >OBJ
	SET 'NUM,ICNT
	JUMP ?L17
?L16:	SET 'NUM,1
?L17:	ZERO? OBJ \?L21
	EQUAL? ICNT,1 \?L21
	GET P-PRSI,1 >OBJ
	JUMP ?L21
?L8:	SET 'NUM,0
?L21:	EQUAL? PRSA,V?WALK \?L22
	ZERO? P-WALK-DIR /?L22
	CALL PERFORM,PRSA,PRSO >V
	JUMP ?L32
?L22:	ZERO? NUM \?L24
	EQUAL? PRSA,V?CONTINUE /?L27
	GETB P-SYNTAX,P-SBITS >STACK
	BAND STACK,P-SONUMS >STACK
	ZERO? STACK \?L25
?L27:	CALL PERFORM,PRSA >V
	SET 'PRSO,0
	JUMP ?L32
?L25:	CALL TELL-NOTHING-TO
	SET 'V,0
	JUMP ?L32
?L24:	ZERO? PTBL /?L29
	GRTR? NUM,1 \?L29
	EQUAL? PRSA,V?EXAMINE,V?COMPARE,V?ARREST \?L29
	CALL PERFORM,PRSA,OBJECT-PAIR >V
	JUMP ?L32
?L29:	SET 'TMP,0
?L31:	IGRTR? 'CNT,NUM \?L33
	GRTR? TMP,0 \?L35
	PRINTI "The other object"
	EQUAL? TMP,1 /?L39
	PRINTI "s"
?L39:	PRINTI " that you mentioned "
	EQUAL? TMP,1 /?L46
	PRINTI "are"
	JUMP ?L50
?L46:	PRINTI "is"
?L50:	PRINTI "n't"
	CALL TELL-HERE
	JUMP ?L32
?L35:	ZERO? ACTED \?L32
	CALL TELL-NOTHING-TO
	JUMP ?L32
?L33:	ZERO? PTBL /?L58
	GET P-PRSO,CNT >OBJ1
	JUMP ?L60
?L58:	GET P-PRSI,CNT >OBJ1
?L60:	GRTR? NUM,1 \?L61
	EQUAL? OBJ1,NOT-HERE-OBJECT \?L63
	INC 'TMP
	JUMP ?L31
?L63:	EQUAL? P-GETFLAGS,P-ALL \?L73
	EQUAL? PRSA,V?TAKE \?L70
	LOC OBJ1 >STACK
	EQUAL? STACK,WINNER,HERE,OBJ /?L69
	LOC OBJ1 >STACK
	FSET? STACK,SURFACEBIT \?L31
?L69:	FSET? OBJ1,TAKEBIT /?L66
	FSET? OBJ1,TRYTAKEBIT \?L31
?L66:	EQUAL? PRSA,V?TAKE \?L70
	ZERO? OBJ /?L70
	EQUAL? OBJ,OBJ1 /?L31
	IN? OBJ1,OBJ \?L31
?L70:	EQUAL? PRSA,V?DROP \?L72
	IN? OBJ1,WINNER \?L31
?L72:	EQUAL? PRSA,V?PUT \?L73
	CALL HELD?,OBJ1,OBJ >STACK
	ZERO? STACK \?L31
?L73:	EQUAL? OBJ1,IT \?L76
	CALL DPRINT,P-IT-OBJECT
	JUMP ?L80
?L76:	CALL DPRINT,OBJ1
?L80:	PRINTI ": "
?L61:	ZERO? PTBL /?L86
	PUSH OBJ
	JUMP ?L88
?L86:	PUSH OBJ1
?L88:	ZERO? PTBL /?L89
	PUSH OBJ1
	JUMP ?L91
?L89:	PUSH OBJ
?L91:	CALL QCONTEXT-CHECK,STACK,STACK >V
	SET 'ACTED,1
	ZERO? PTBL /?L92
	PUSH OBJ
	JUMP ?L94
?L92:	PUSH OBJ1
?L94:	ZERO? PTBL /?L95
	PUSH OBJ1
	JUMP ?L97
?L95:	PUSH OBJ
?L97:	CALL PERFORM,PRSA,STACK,STACK >V
	EQUAL? V,M-FATAL \?L31
?L32:	EQUAL? V,M-FATAL \?L104
	SET 'P-CONT,0
	JUMP ?L104
?L6:	SET 'P-CONT,0
?L104:	ZERO? P-WON /?L1
	EQUAL? PRSA,V?$0024VERIFY,V?TIME,V?SCORE /?L1
	EQUAL? PRSA,V?VERSION,V?UNSCRIPT,V?SCRIPT /?L1
	EQUAL? PRSA,V?UNSPACE,V?SPACE,V?RESTART /?L1
	EQUAL? PRSA,V?RESTORE,V?SAVE,V?VERBOSE /?L1
	EQUAL? PRSA,V?SUPER-BRIEF,V?BRIEF,V?TELL /?L1
	CALL CLOCKER >V
	JUMP ?L1

	.FUNCT TELL-NOTHING-TO,TMP
	PRINTI "There isn't anything to "
	GET P-ITBL,P-VERBN >TMP
	ZERO? P-MERGED /?L3
	GET TMP,0 >STACK
	PRINTB STACK
	JUMP ?L5
?L3:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
?L5:	PRINTR "."

	.FUNCT QCONTEXT-CHECK,PRSO?1,PRSI?1,OTHER,WHO=0,N=0
	EQUAL? PRSA,V?TELL /FALSE
	EQUAL? PRSA,V?WHAT,V?HELP /?L4
	EQUAL? PRSA,V?TELL-ME \?L5
	EQUAL? PRSO?1,PLAYER,ME /?L4
?L5:	EQUAL? PRSA,V?GIVE,V?SHOW \FALSE
	EQUAL? PRSI?1,PLAYER,ME \FALSE
?L4:	FIRST? HERE >OTHER \?L8
?L9:	FSET? OTHER,PERSON \?L11
	INC 'N
	SET 'WHO,OTHER
?L11:	NEXT? OTHER >OTHER /?L9
?L8:	EQUAL? 1,N \?L14
	ZERO? QCONTEXT \?L24
	CALL SAID-TO,WHO
?L14:	ZERO? QCONTEXT /FALSE
?L24:	IN? QCONTEXT,HERE \FALSE
	EQUAL? QCONTEXT-ROOM,HERE \FALSE
	EQUAL? WINNER,PLAYER \FALSE
	SET 'WINNER,QCONTEXT
	PRINTI "(said to "
	CALL DPRINT,QCONTEXT
	PRINTR ")"

	.FUNCT SAID-TO,WHO
	SET 'WINNER,WHO
	SET 'QCONTEXT,WHO
	SET 'QCONTEXT-ROOM,HERE
	RETURN QCONTEXT-ROOM

	.FUNCT FAKE-ORPHAN
	CALL ORPHAN,P-SYNTAX,0
	PRINTI "Be specific: "
	CALL VERB-PRINT,P-OTBL
	SET 'P-OFLAG,1
	SET 'P-WON,0
	PRINTR " what object?"

	.FUNCT NULL-F
	RFALSE

	.FUNCT PERFORM,A,O=0,I=0,V,OA,OO,OI,WALK?,?TMP
	SET 'OA,PRSA
	SET 'OO,PRSO
	SET 'OI,PRSI
	SET 'PRSA,A
	EQUAL? PRSA,V?WALK /?L2
	SET 'WALK?,0
	JUMP ?L1
?L2:	SET 'WALK?,P-WALK-DIR
?L1:	ZERO? WALK? \?L29
	ZERO? P-IT-OBJECT /?L5
	EQUAL? IT,I,O \?L5
	EQUAL? P-IT-LOC,HERE /?L5
	ZERO? I \?L6
	CALL FAKE-ORPHAN
	RETURN 2
?L6:	CALL THE-PRINT,P-IT-OBJECT,1
	PRINT ISNT-HERE
	CRLF
	RETURN 2
?L5:	EQUAL? HIM-HER,I,O \?L13
	CALL META-LOC,P-HIM-HER >STACK
	EQUAL? STACK,HERE /?L13
	CALL CHARACTERIZE,P-HIM-HER >STACK
	CALL THIS-IS-S-HE,STACK
?L13:	ZERO? WALK? \?L29
	EQUAL? O,IT \?L17
	ZERO? P-IT-OBJECT /?L18
	SET 'O,P-IT-OBJECT
	JUMP ?L21
?L18:	SET 'O,P-HIM-HER
	JUMP ?L21
?L17:	EQUAL? O,HIM-HER \?L21
	SET 'O,P-HIM-HER
?L21:	ZERO? WALK? \?L29
	EQUAL? I,IT \?L25
	ZERO? P-IT-OBJECT /?L26
	SET 'I,P-IT-OBJECT
	JUMP ?L29
?L26:	SET 'I,P-HIM-HER
	JUMP ?L29
?L25:	EQUAL? I,HIM-HER \?L29
	SET 'I,P-HIM-HER
?L29:	SET 'PRSO,O
	SET 'PRSI,I
	ZERO? PRSO /?L38
	ZERO? WALK? \?L38
	SET '?TMP,HERE
	CALL META-LOC,WINNER >STACK
	EQUAL? ?TMP,STACK \?L38
	FSET? PRSO,PERSON \?L33
	EQUAL? PRSO,CORPSE \?L35
	CALL THIS-IS-IT,PRSO
?L35:	CALL THIS-IS-S-HE,PRSO
	JUMP ?L38
?L33:	CALL THIS-IS-IT,PRSO
?L38:	EQUAL? PRSA,V?$0024DISCOVER,V?WALK,V?AGAIN /?L40
	EQUAL? WINNER,PLAYER \?L40
	SET 'L-PRSA,A
	SET 'L-PRSO,O
	SET 'L-PRSI,I
?L40:	ZERO? WALK? \?L43
	EQUAL? NOT-HERE-OBJECT,PRSO,PRSI \?L43
	CALL NOT-HERE-OBJECT-F >V
	ZERO? V \?L52
?L43:	SET 'O,PRSO
	ZERO? O /?L45
	SET 'I,PRSI
	ZERO? I /?L45
	CALL NULL-F >STACK
	ZERO? STACK \?L52
?L45:	GETP WINNER,P?ACTION >STACK
	CALL STACK >V
	ZERO? V \?L52
	LOC WINNER >STACK
	GETP STACK,P?ACTION >STACK
	CALL STACK,M-BEG >V
	ZERO? V \?L52
	GET PREACTIONS,A >STACK
	CALL STACK >V
	ZERO? V \?L52
	ZERO? I /?L49
	SET 'NOW-PRSI,1
	GETP I,P?ACTION >STACK
	CALL STACK >V
	ZERO? V \?L52
?L49:	SET 'NOW-PRSI,0
	ZERO? O /?L51
	ZERO? WALK? \?L50
	LOC O >STACK
	ZERO? STACK /?L50
	LOC O >STACK
	GETP STACK,P?CONTFCN >STACK
	ZERO? STACK /?L50
	LOC O >STACK
	GETP STACK,P?CONTFCN >STACK
	CALL STACK >V
	ZERO? V \?L52
?L50:	ZERO? O /?L51
	ZERO? WALK? \?L51
	GETP O,P?ACTION >STACK
	CALL STACK >V
	ZERO? V \?L52
?L51:	GET ACTIONS,A >STACK
	CALL STACK >V
	ZERO? V /?L52
?L52:	EQUAL? V,M-FATAL /?L54
	LOC WINNER >STACK
	EQUAL? STACK,PRSO \?L56
	SET 'PRSO,0
?L56:	LOC WINNER >STACK
	GETP STACK,P?ACTION >STACK
	CALL STACK,M-END >V
?L54:	SET 'PRSA,OA
	SET 'PRSO,OO
	SET 'PRSI,OI
	RETURN V

	.FUNCT THIS-IS-S-HE,PER
	SET 'P-HIM-HER,PER
	LOC PER >P-HIM-HER-LOC
	RETURN P-HIM-HER-LOC

	.FUNCT PARSER,PTR=P-LEXSTART,WORD,VAL=0,VERB=0,LEN,DIR=0,NW=0,LW=0,NUM,SCNT,CNT=-1,OWINNER
?L1:	IGRTR? 'CNT,P-ITBLLEN /?L2
	PUT P-ITBL,CNT,0
	JUMP ?L1
?L2:	SET 'P-NAM,0
	SET 'P-ADJ,0
	SET 'P-MERGED,0
	PUT P-PRSO,P-MATCHLEN,0
	PUT P-PRSI,P-MATCHLEN,0
	PUT P-BUTS,P-MATCHLEN,0
	SET 'OWINNER,WINNER
	ZERO? QUOTE-FLAG \?L8
	EQUAL? WINNER,PLAYER /?L8
	SET 'WINNER,PLAYER
	LOC WINNER >STACK
	FSET? STACK,VEHBIT /?L8
	LOC WINNER >HERE
?L8:	ZERO? P-CONT /?L12
	SET 'PTR,P-CONT
	SET 'P-CONT,0
	EQUAL? PRSA,V?TELL /?L17
	CRLF
	JUMP ?L17
?L12:	SET 'WINNER,PLAYER
	SET 'QUOTE-FLAG,0
	LOC WINNER >STACK
	FSET? STACK,VEHBIT /?L18
	LOC WINNER >HERE
?L18:	SET 'SCNT,P-SPACE
?L21:	DLESS? 'SCNT,0 /?L22
	CRLF
	JUMP ?L21
?L22:	PUTB P-LEXV,0,59
	PRINTI ">"
	READ P-INBUF,P-LEXV
?L17:	GETB P-LEXV,P-LEXWORDS >P-LEN
	ZERO? P-LEN \?L28
	GET GOAL-TABLES,PLAYER-C >STACK
	GET STACK,GOAL-S >STACK
	ZERO? STACK /?L30
	SET 'PRSA,V?CONTINUE
	SET 'PRSO,0
	SET 'PRSI,0
	RETURN 2
?L30:	PRINTI "What?"
	CRLF
	RFALSE
?L28:	GET P-LEXV,PTR >WORD
	EQUAL? WORD,W?WHY,W?HOW,W?WHEN /?L38
	EQUAL? WORD,W?DID \?L37
?L38:	PRINTI "Sorry, but this program can't handle questions like that. Check your manual for more details."
	CRLF
	RFALSE
?L37:	SET 'LEN,P-LEN
	SET 'P-DIR,0
	SET 'P-NCN,0
	SET 'P-GETFLAGS,0
	PUT P-ITBL,P-VERBN,0
?L42:	DLESS? 'P-LEN,0 \?L44
	SET 'QUOTE-FLAG,0
	JUMP ?L43
?L44:	GET P-LEXV,PTR >WORD
	ZERO? WORD \?L47
	CALL NUMBER?,PTR >WORD
	ZERO? WORD /?L46
?L47:	EQUAL? WORD,W?TO \?L48
	EQUAL? VERB,ACT?TELL,ACT?ASK \?L48
	SET 'WORD,W?$QUOTE
	JUMP ?L50
?L48:	EQUAL? WORD,W?THEN \?L50
	ZERO? VERB \?L50
	PUT P-ITBL,P-VERB,ACT?TELL
	PUT P-ITBL,P-VERBN,0
	SET 'WORD,W?$QUOTE
?L50:	CALL ABBREV?,LW,WORD >STACK
	ZERO? STACK /?L52
	SET 'LW,0
	JUMP ?L99
?L52:	EQUAL? WORD,W?THEN,W?$PERIOD /?L55
	EQUAL? WORD,W?$QUOTE \?L54
?L55:	EQUAL? WORD,W?$QUOTE \?L60
	ZERO? QUOTE-FLAG /?L58
	SET 'QUOTE-FLAG,0
	JUMP ?L60
?L58:	SET 'QUOTE-FLAG,1
?L60:	ZERO? P-LEN /?L62
	ADD PTR,P-LEXELEN >P-CONT
?L62:	PUTB P-LEXV,P-LEXWORDS,P-LEN
	JUMP ?L43
?L54:	CALL WT?,WORD,PS?DIRECTION,P1?DIRECTION >VAL
	ZERO? VAL /?L64
	EQUAL? LEN,1 /?L65
	EQUAL? LEN,2 \?L66
	EQUAL? VERB,ACT?WALK /?L65
?L66:	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >NW
	EQUAL? NW,W?THEN,W?$QUOTE \?L67
	GRTR? LEN,2 /?L65
?L67:	EQUAL? NW,W?$PERIOD \?L68
	GRTR? LEN,1 /?L65
?L68:	ZERO? QUOTE-FLAG /?L69
	EQUAL? LEN,2 \?L69
	EQUAL? NW,W?$QUOTE /?L65
?L69:	GRTR? LEN,2 \?L64
	EQUAL? NW,W?$COMMA,W?AND \?L64
?L65:	SET 'DIR,VAL
	EQUAL? NW,W?$COMMA,W?AND \?L70
	ADD PTR,P-LEXELEN >STACK
	PUT P-LEXV,STACK,W?THEN
?L70:	GRTR? LEN,2 /?L99
	SET 'QUOTE-FLAG,0
	JUMP ?L43
?L64:	CALL WT?,WORD,PS?VERB,P1?VERB >VAL
	ZERO? VAL /?L76
	ZERO? VERB /?L77
	EQUAL? VERB,ACT?WHAT \?L76
	EQUAL? WORD,W?IS /?L76
?L77:	SET 'VERB,VAL
	PUT P-ITBL,P-VERB,VAL
	PUT P-ITBL,P-VERBN,P-VTBL
	PUT P-VTBL,0,WORD
	MUL PTR,2 >STACK
	ADD STACK,2 >NUM
	GETB P-LEXV,NUM >STACK
	PUTB P-VTBL,2,STACK
	ADD NUM,1 >STACK
	GETB P-LEXV,STACK >STACK
	PUTB P-VTBL,3,STACK
	JUMP ?L99
?L76:	CALL WT?,WORD,PS?PREPOSITION,0 >VAL
	ZERO? VAL \?L79
	EQUAL? WORD,W?ALL,W?ONE,W?A /?L80
	CALL WT?,WORD,PS?ADJECTIVE >STACK
	ZERO? STACK \?L80
	CALL WT?,WORD,PS?OBJECT >STACK
	ZERO? STACK /?L78
?L80:	SET 'VAL,0
?L79:	GRTR? P-LEN,0 \?L81
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?OF \?L81
	EQUAL? VERB,ACT?ACCUSE,ACT?MAKE /?L81
	ZERO? VAL \?L112
	EQUAL? WORD,W?ALL,W?ONE,W?A \?L99
?L81:	ZERO? VAL /?L83
?L112:	ZERO? P-LEN /?L84
	ADD PTR,2 >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?THEN,W?$PERIOD \?L83
?L84:	LESS? P-NCN,2 \?L99
	PUT P-ITBL,P-PREP1,VAL
	PUT P-ITBL,P-PREP1N,WORD
	JUMP ?L99
?L83:	EQUAL? P-NCN,2 \?L88
	PRINTI "There were more than two nouns in that sentence."
	CRLF
	RFALSE
?L88:	INC 'P-NCN
	CALL CLAUSE,PTR,VAL,WORD >PTR
	ZERO? PTR /FALSE
	LESS? PTR,0 \?L99
	SET 'QUOTE-FLAG,0
	JUMP ?L43
?L78:	CALL WT?,WORD,PS?BUZZ-WORD >STACK
	ZERO? STACK \?L99
	CALL CANT-USE,PTR
	RFALSE
?L46:	CALL UNKNOWN-WORD,PTR
	RFALSE
?L99:	SET 'LW,WORD
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L42
?L43:	ZERO? DIR /?L100
	SET 'PRSA,V?WALK
	SET 'P-WALK-DIR,DIR
	SET 'PRSO,DIR
	SET 'P-OFLAG,0
	RTRUE
?L100:	ZERO? P-OFLAG /?L103
	CALL ORPHAN-MERGE >STACK
	ZERO? STACK /?L103
	SET 'WINNER,OWINNER
?L103:	GET P-ITBL,P-VERB >STACK
	ZERO? STACK \?L106
	PUT P-ITBL,P-VERB,ACT?$0024CALL
?L106:	CALL SYNTAX-CHECK >STACK
	ZERO? STACK /FALSE
	CALL SNARF-OBJECTS >STACK
	ZERO? STACK /FALSE
	CALL TAKE-CHECK >STACK
	ZERO? STACK /FALSE
	CALL MANY-CHECK >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT ABBREV?,LW,WORD
	EQUAL? WORD,W?$PERIOD \FALSE
	EQUAL? LW,W?MRS,W?MR,W?MS /TRUE
	EQUAL? LW,W?SGT,W?COL,W?SEN /TRUE
	RFALSE

	.FUNCT WT?,PTR,BIT,B1=5,OFFSET=P-P1OFF,TYP
	GETB PTR,P-PSOFF >TYP
	BTST TYP,BIT \FALSE
	GRTR? B1,4 /TRUE
	BAND TYP,P-P1BITS >TYP
	EQUAL? TYP,B1 /?L6
	INC 'OFFSET
?L6:	GETB PTR,OFFSET >STACK
	RSTACK

	.FUNCT CLAUSE,PTR,VAL,WORD,OFF,NUM,ANDFLG=0,FIRST??=1,NW,LW=0
	SUB P-NCN,1 >STACK
	MUL STACK,2 >OFF
	ZERO? VAL /?L1
	ADD P-PREP1,OFF >NUM
	PUT P-ITBL,NUM,VAL
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,WORD
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L3
?L1:	INC 'P-LEN
?L3:	ZERO? P-LEN \?L4
	DEC 'P-NCN
	RETURN -1
?L4:	ADD P-NC1,OFF >NUM
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	PUT P-ITBL,NUM,STACK
	GET P-LEXV,PTR >STACK
	EQUAL? STACK,W?THE,W?A,W?AN \?L7
	GET P-ITBL,NUM >STACK
	ADD STACK,4 >STACK
	PUT P-ITBL,NUM,STACK
?L7:	DLESS? 'P-LEN,0 \?L12
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,STACK
	RETURN -1
?L12:	GET P-LEXV,PTR >WORD
	ZERO? WORD \?L17
	CALL NUMBER?,PTR >WORD
	ZERO? WORD /?L15
?L17:	ZERO? P-LEN \?L18
	SET 'NW,0
	JUMP ?L20
?L18:	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >NW
?L20:	EQUAL? WORD,W?OF \?L21
	GET P-ITBL,P-VERB >STACK
	EQUAL? STACK,ACT?ACCUSE,ACT?MAKE \?L21
	PUT P-LEXV,PTR,W?WITH
	SET 'WORD,W?WITH
?L21:	CALL ABBREV?,LW,WORD >STACK
	ZERO? STACK /?L24
	SET 'LW,0
	JUMP ?L45
?L24:	EQUAL? WORD,W?AND,W?$COMMA \?L26
	SET 'ANDFLG,1
	JUMP ?L45
?L26:	EQUAL? WORD,W?ALL,W?ONE \?L27
	EQUAL? NW,W?OF \?L45
	DEC 'P-LEN
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L45
?L27:	EQUAL? WORD,W?THEN,W?$PERIOD /?L32
	CALL WT?,WORD,PS?PREPOSITION >STACK
	ZERO? STACK /?L31
	ZERO? FIRST?? \?L31
?L32:	INC 'P-LEN
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,STACK
	SUB PTR,P-LEXELEN >STACK
	RSTACK
?L31:	ZERO? ANDFLG /?L33
	GET P-ITBL,P-VERBN >STACK
	ZERO? STACK /?L34
	CALL WT?,WORD,PS?DIRECTION >STACK
	ZERO? STACK \?L34
	CALL WT?,WORD,PS?VERB >STACK
	ZERO? STACK /?L33
?L34:	SUB PTR,4 >PTR
	ADD PTR,2 >STACK
	PUT P-LEXV,STACK,W?THEN
	ADD P-LEN,2 >P-LEN
	JUMP ?L45
?L33:	CALL WT?,WORD,PS?OBJECT >STACK
	ZERO? STACK /?L35
	GRTR? P-LEN,0 \?L36
	EQUAL? NW,W?OF \?L36
	EQUAL? WORD,W?ALL,W?ONE \?L45
?L36:	CALL WT?,WORD,PS?ADJECTIVE,P1?ADJECTIVE >STACK
	ZERO? STACK /?L38
	ZERO? NW /?L38
	CALL WT?,NW,PS?OBJECT >STACK
	ZERO? STACK \?L45
?L38:	ZERO? ANDFLG \?L39
	EQUAL? NW,W?BUT,W?EXCEPT,W?AND /?L39
	EQUAL? NW,W?$COMMA /?L39
	ADD PTR,2 >STACK
	MUL STACK,2 >STACK
	ADD P-LEXV,STACK >STACK
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,STACK
	RETURN PTR
?L39:	SET 'ANDFLG,0
	JUMP ?L45
?L35:	CALL WT?,WORD,PS?ADJECTIVE >STACK
	ZERO? STACK \?L45
	CALL WT?,WORD,PS?BUZZ-WORD >STACK
	ZERO? STACK \?L45
	CALL WT?,WORD,PS?PREPOSITION >STACK
	ZERO? STACK \?L45
	CALL CANT-USE,PTR
	RFALSE
?L15:	CALL UNKNOWN-WORD,PTR
	RFALSE
?L45:	SET 'LW,WORD
	SET 'FIRST??,0
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L7

	.FUNCT NUMBER?,PTR,CNT,BPTR,CHR,SUM=0,TIM=0,EXC=0
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	GETB STACK,2 >CNT
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	GETB STACK,3 >BPTR
?L1:	DLESS? 'CNT,0 /?L2
	GETB P-INBUF,BPTR >CHR
	EQUAL? CHR,58 \?L6
	ZERO? EXC \FALSE
	SET 'TIM,SUM
	SET 'SUM,0
	JUMP ?L17
?L6:	EQUAL? CHR,45 \?L11
	ZERO? TIM \FALSE
	SET 'EXC,SUM
	SET 'SUM,0
	JUMP ?L17
?L11:	GRTR? SUM,9999 /FALSE
	LESS? CHR,58 \FALSE
	GRTR? CHR,47 \FALSE
	SUB CHR,48 >STACK
	MUL SUM,10 >STACK
	ADD STACK,STACK >SUM
?L17:	INC 'BPTR
	JUMP ?L1
?L2:	PUT P-LEXV,PTR,W?INTNUM
	GRTR? SUM,9999 /FALSE
	ZERO? EXC /?L20
	SET 'P-EXCHANGE,EXC
	JUMP ?L28
?L20:	ZERO? TIM /?L21
	SET 'P-EXCHANGE,0
	GRTR? TIM,23 /FALSE
	GRTR? TIM,19 /?L27
	GRTR? TIM,12 /FALSE
	GRTR? TIM,7 /?L27
	ADD 12,TIM >TIM
?L27:	MUL TIM,60 >STACK
	ADD SUM,STACK >SUM
	JUMP ?L28
?L21:	SET 'P-EXCHANGE,0
?L28:	SET 'P-NUMBER,SUM
	RETURN W?INTNUM

	.FUNCT ORPHAN-MERGE,CNT=-1,TEMP,VERB,BEG,END,ADJ=0,WRD
	SET 'P-OFLAG,0
	GET P-ITBL,P-VERBN >STACK
	GET STACK,0 >WRD
	CALL WT?,WRD,PS?ADJECTIVE,P1?ADJECTIVE >STACK
	ZERO? STACK /?L1
	SET 'ADJ,1
	JUMP ?L3
?L1:	CALL WT?,WRD,PS?OBJECT,P1?OBJECT >STACK
	ZERO? STACK /?L3
	ZERO? P-NCN \?L3
	PUT P-ITBL,P-VERB,0
	PUT P-ITBL,P-VERBN,0
	ADD P-LEXV,2 >STACK
	PUT P-ITBL,P-NC1,STACK
	ADD P-LEXV,6 >STACK
	PUT P-ITBL,P-NC1L,STACK
	SET 'P-NCN,1
?L3:	GET P-ITBL,P-VERB >VERB
	ZERO? VERB /?L5
	ZERO? ADJ \?L5
	GET P-OTBL,P-VERB >STACK
	EQUAL? VERB,STACK \FALSE
?L5:	EQUAL? P-NCN,2 /FALSE
	GET P-OTBL,P-NC1 >STACK
	EQUAL? STACK,1 \?L8
	GET P-ITBL,P-PREP1 >TEMP
	GET P-OTBL,P-PREP1 >STACK
	EQUAL? TEMP,STACK /?L11
	ZERO? TEMP \FALSE
?L11:	ZERO? ADJ /?L12
	ADD P-LEXV,2 >STACK
	PUT P-OTBL,P-NC1,STACK
	GET P-ITBL,P-NC1L >STACK
	ZERO? STACK \?L14
	ADD P-LEXV,6 >STACK
	PUT P-ITBL,P-NC1L,STACK
?L14:	ZERO? P-NCN \?L20
	SET 'P-NCN,1
	JUMP ?L20
?L12:	GET P-ITBL,P-NC1 >STACK
	PUT P-OTBL,P-NC1,STACK
?L20:	GET P-ITBL,P-NC1L >STACK
	PUT P-OTBL,P-NC1L,STACK
	JUMP ?L41
?L8:	GET P-OTBL,P-NC2 >STACK
	EQUAL? STACK,1 \?L22
	GET P-ITBL,P-PREP1 >TEMP
	GET P-OTBL,P-PREP2 >STACK
	EQUAL? TEMP,STACK /?L25
	ZERO? TEMP \FALSE
?L25:	ZERO? ADJ /?L28
	ADD P-LEXV,2 >STACK
	PUT P-ITBL,P-NC1,STACK
	GET P-ITBL,P-NC1L >STACK
	ZERO? STACK \?L28
	ADD P-LEXV,6 >STACK
	PUT P-ITBL,P-NC1L,STACK
?L28:	GET P-ITBL,P-NC1 >STACK
	PUT P-OTBL,P-NC2,STACK
	GET P-ITBL,P-NC1L >STACK
	PUT P-OTBL,P-NC2L,STACK
	SET 'P-NCN,2
	JUMP ?L41
?L22:	ZERO? P-ACLAUSE /?L41
	EQUAL? P-NCN,1 /?L34
	ZERO? ADJ \?L34
	SET 'P-ACLAUSE,0
	RFALSE
?L34:	GET P-ITBL,P-NC1 >BEG
	ZERO? ADJ /?L37
	ADD P-LEXV,2 >BEG
	SET 'ADJ,0
?L37:	GET P-ITBL,P-NC1L >END
?L40:	GET BEG,0 >WRD
	EQUAL? BEG,END \?L42
	ZERO? ADJ /?L44
	CALL ACLAUSE-WIN,ADJ
	JUMP ?L41
?L44:	SET 'P-ACLAUSE,0
	RFALSE
?L42:	ZERO? ADJ \?L47
	GETB WRD,P-PSOFF >STACK
	BTST STACK,PS?ADJECTIVE /?L48
	EQUAL? WRD,W?ALL,W?ONE \?L47
?L48:	SET 'ADJ,WRD
	JUMP ?L50
?L47:	EQUAL? WRD,W?ONE \?L49
	CALL ACLAUSE-WIN,ADJ
	JUMP ?L41
?L49:	GETB WRD,P-PSOFF >STACK
	BTST STACK,PS?OBJECT \?L50
	EQUAL? WRD,P-ANAM \?L51
	CALL ACLAUSE-WIN,ADJ
	JUMP ?L41
?L51:	CALL NCLAUSE-WIN
	JUMP ?L41
?L50:	ADD BEG,P-WORDLEN >BEG
	ZERO? END \?L40
	SET 'END,BEG
	SET 'P-NCN,1
	SUB BEG,4 >STACK
	PUT P-ITBL,P-NC1,STACK
	PUT P-ITBL,P-NC1L,BEG
	JUMP ?L40
?L41:	GET P-OVTBL,0 >STACK
	PUT P-VTBL,0,STACK
	GETB P-OVTBL,2 >STACK
	PUTB P-VTBL,2,STACK
	GETB P-OVTBL,3 >STACK
	PUTB P-VTBL,3,STACK
	PUT P-OTBL,P-VERBN,P-VTBL
	PUTB P-VTBL,2,0
?L59:	IGRTR? 'CNT,P-ITBLLEN \?L61
	SET 'P-MERGED,1
	RTRUE
?L61:	GET P-OTBL,CNT >STACK
	PUT P-ITBL,CNT,STACK
	JUMP ?L59

	.FUNCT ACLAUSE-WIN,ADJ
	GET P-OTBL,P-VERB >STACK
	PUT P-ITBL,P-VERB,STACK
	PUT P-CCTBL,CC-SBPTR,P-ACLAUSE
	ADD P-ACLAUSE,1 >STACK
	PUT P-CCTBL,CC-SEPTR,STACK
	PUT P-CCTBL,CC-DBPTR,P-ACLAUSE
	ADD P-ACLAUSE,1 >STACK
	PUT P-CCTBL,CC-DEPTR,STACK
	CALL CLAUSE-COPY,P-OTBL,P-OTBL,ADJ
	GET P-OTBL,P-NC2 >STACK
	ZERO? STACK /?L3
	SET 'P-NCN,2
?L3:	SET 'P-ACLAUSE,0
	RTRUE

	.FUNCT NCLAUSE-WIN
	PUT P-CCTBL,CC-SBPTR,P-NC1
	PUT P-CCTBL,CC-SEPTR,P-NC1L
	PUT P-CCTBL,CC-DBPTR,P-ACLAUSE
	ADD P-ACLAUSE,1 >STACK
	PUT P-CCTBL,CC-DEPTR,STACK
	CALL CLAUSE-COPY,P-ITBL,P-OTBL
	GET P-OTBL,P-NC2 >STACK
	ZERO? STACK /?L1
	SET 'P-NCN,2
?L1:	SET 'P-ACLAUSE,0
	RTRUE

	.FUNCT WORD-PRINT,CNT,BUF
?L1:	DLESS? 'CNT,0 /TRUE
	GETB P-INBUF,BUF >STACK
	PRINTC STACK
	INC 'BUF
	JUMP ?L1

	.FUNCT UNKNOWN-WORD,PTR,BUF
	PRINTI "Sorry, but the word """
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >BUF
	GETB BUF,3 >STACK
	GETB BUF,2 >STACK
	CALL WORD-PRINT,STACK,STACK
	PRINTI """ is not in the vocabulary you can use."
	CRLF
	SET 'QUOTE-FLAG,0
	SET 'P-OFLAG,0
	RETURN P-OFLAG

	.FUNCT CANT-USE,PTR,BUF
	PRINTI "Sorry, but you can't use the word """
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >BUF
	GETB BUF,3 >STACK
	GETB BUF,2 >STACK
	CALL WORD-PRINT,STACK,STACK
	PRINTI """ in that sense."
	CRLF
	SET 'QUOTE-FLAG,0
	SET 'P-OFLAG,0
	RETURN P-OFLAG

	.FUNCT SYNTAX-CHECK,SYN,LEN,NUM,OBJ,DRIVE1=0,DRIVE2=0,PREP,VERB
	GET P-ITBL,P-VERB >VERB
	ZERO? VERB \?L1
	PRINT SEEMS-TO-BE
	PRINTI "no verb in that sentence."
	CRLF
	RFALSE
?L1:	SUB 255,VERB >STACK
	GET VERBS,STACK >SYN
	GETB SYN,0 >LEN
	INC 'SYN
?L6:	GETB SYN,P-SBITS >STACK
	BAND STACK,P-SONUMS >NUM
	GRTR? P-NCN,NUM /?L15
	LESS? NUM,1 /?L10
	ZERO? P-NCN \?L10
	GET P-ITBL,P-PREP1 >PREP
	ZERO? PREP /?L11
	GETB SYN,P-SPREP1 >STACK
	EQUAL? PREP,STACK \?L10
?L11:	SET 'DRIVE1,SYN
	JUMP ?L15
?L10:	GET P-ITBL,P-PREP1 >STACK
	GETB SYN,P-SPREP1 >STACK
	EQUAL? STACK,STACK \?L15
	EQUAL? NUM,2 \?L13
	EQUAL? P-NCN,1 \?L13
	SET 'DRIVE2,SYN
	JUMP ?L15
?L13:	GET P-ITBL,P-PREP2 >STACK
	GETB SYN,P-SPREP2 >STACK
	EQUAL? STACK,STACK \?L15
	CALL SYNTAX-FOUND,SYN
	RTRUE
?L15:	DLESS? 'LEN,1 \?L18
	ZERO? DRIVE1 \?L54
	ZERO? DRIVE2 \?L7
	PRINT SORRY-I-DONT
	CRLF
	RFALSE
?L18:	ADD SYN,P-SYNLEN >SYN
	JUMP ?L6
?L7:	ZERO? DRIVE1 /?L27
?L54:	GETB DRIVE1,P-SPREP1 >STACK
	GETB DRIVE1,P-SLOC1 >STACK
	GETB DRIVE1,P-SFWIM1 >STACK
	CALL GWIM,STACK,STACK,STACK >OBJ
	ZERO? OBJ /?L27
	PUT P-PRSO,P-MATCHLEN,1
	PUT P-PRSO,1,OBJ
	CALL SYNTAX-FOUND,DRIVE1 >STACK
	RSTACK
?L27:	ZERO? DRIVE2 /?L29
	GETB DRIVE2,P-SPREP2 >STACK
	GETB DRIVE2,P-SLOC2 >STACK
	GETB DRIVE2,P-SFWIM2 >STACK
	CALL GWIM,STACK,STACK,STACK >OBJ
	ZERO? OBJ /?L29
	PUT P-PRSI,P-MATCHLEN,1
	PUT P-PRSI,1,OBJ
	CALL SYNTAX-FOUND,DRIVE2 >STACK
	RSTACK
?L29:	EQUAL? VERB,ACT?FIND,ACT?WHAT \?L30
	PRINTI "Sorry, but I can't answer that question."
	CRLF
	RFALSE
?L30:	EQUAL? WINNER,PLAYER \?L34
	CALL ORPHAN,DRIVE1,DRIVE2
	PRINTI "What do you want to "
	JUMP ?L38
?L34:	PRINTI "Next time, say what you want "
	CALL DPRINT,WINNER
	PRINTI " to "
?L38:	CALL VERB-PRINT,P-ITBL
	ZERO? DRIVE2 /?L41
	CALL CLAUSE-PRINT,P-NC1,P-NC1L
?L41:	ZERO? DRIVE1 /?L44
	GETB DRIVE1,P-SPREP1 >STACK
	JUMP ?L46
?L44:	GETB DRIVE2,P-SPREP2 >STACK
?L46:	CALL PREP-PRINT,STACK
	EQUAL? WINNER,PLAYER \?L47
	SET 'P-OFLAG,1
	PRINTI "?"
	CRLF
	RFALSE
?L47:	SET 'P-OFLAG,0
	PRINTI "."
	CRLF
	RFALSE

	.FUNCT VERB-PRINT,TBL,TMP
	GET TBL,P-VERBN >TMP
	ZERO? TMP \?L1
	PRINTI "tell"
	RTRUE
?L1:	GETB P-VTBL,2 >STACK
	ZERO? STACK \?L5
	GET TMP,0 >STACK
	PRINTB STACK
	RTRUE
?L5:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
	PUTB P-VTBL,2,0
	RTRUE

	.FUNCT ORPHAN,D1,D2,CNT=-1
	ZERO? P-MERGED \?L1
	PUT P-OCLAUSE,P-MATCHLEN,0
?L1:	GET P-VTBL,0 >STACK
	PUT P-OVTBL,0,STACK
	GETB P-VTBL,2 >STACK
	PUTB P-OVTBL,2,STACK
	GETB P-VTBL,3 >STACK
	PUTB P-OVTBL,3,STACK
?L4:	IGRTR? 'CNT,P-ITBLLEN /?L5
	GET P-ITBL,CNT >STACK
	PUT P-OTBL,CNT,STACK
	JUMP ?L4
?L5:	EQUAL? P-NCN,2 \?L9
	PUT P-CCTBL,CC-SBPTR,P-NC2
	PUT P-CCTBL,CC-SEPTR,P-NC2L
	PUT P-CCTBL,CC-DBPTR,P-NC2
	PUT P-CCTBL,CC-DEPTR,P-NC2L
	CALL CLAUSE-COPY,P-ITBL,P-OTBL
?L9:	LESS? P-NCN,1 /?L12
	PUT P-CCTBL,CC-SBPTR,P-NC1
	PUT P-CCTBL,CC-SEPTR,P-NC1L
	PUT P-CCTBL,CC-DBPTR,P-NC1
	PUT P-CCTBL,CC-DEPTR,P-NC1L
	CALL CLAUSE-COPY,P-ITBL,P-OTBL
?L12:	ZERO? D1 /?L15
	GETB D1,P-SPREP1 >STACK
	PUT P-OTBL,P-PREP1,STACK
	PUT P-OTBL,P-NC1,1
	RTRUE
?L15:	ZERO? D2 /FALSE
	GETB D2,P-SPREP2 >STACK
	PUT P-OTBL,P-PREP2,STACK
	PUT P-OTBL,P-NC2,1
	RTRUE

	.FUNCT CLAUSE-PRINT,BPTR,EPTR,THE??1=1
	GET P-ITBL,EPTR >STACK
	GET P-ITBL,BPTR >STACK
	CALL BUFFER-PRINT,STACK,STACK,THE??1 >STACK
	RSTACK

	.FUNCT BUFFER-PRINT,BEG,END,CP,NOSP=0,WRD,FIRST??=1,PN=0
?L1:	EQUAL? BEG,END /TRUE
	ZERO? NOSP /?L6
	SET 'NOSP,0
	JUMP ?L8
?L6:	PRINTI " "
?L8:	GET BEG,0 >WRD
	EQUAL? WRD,W?$PERIOD \?L11
	SET 'NOSP,1
	JUMP ?L27
?L11:	EQUAL? WRD,W?MRS \?L13
	PRINTI "Mrs."
	SET 'PN,1
	JUMP ?L27
?L13:	EQUAL? WRD,W?MS \?L16
	PRINTI "Ms."
	SET 'PN,1
	JUMP ?L27
?L16:	EQUAL? WRD,W?MR \?L19
	PRINTI "Mr."
	SET 'PN,1
	JUMP ?L27
?L19:	EQUAL? WRD,W?COL \?L22
	PRINTI "Col."
	SET 'PN,1
	JUMP ?L27
?L22:	EQUAL? WRD,W?ASHCROFT,W?WELLMAN /?L26
	EQUAL? WRD,W?DUFFY \?L25
?L26:	CALL CAPITALIZE,BEG
	SET 'PN,1
	JUMP ?L27
?L25:	ZERO? FIRST?? /?L28
	ZERO? PN \?L28
	ZERO? CP /?L28
	PRINTI "the "
?L28:	ZERO? P-OFLAG \?L35
	ZERO? P-MERGED /?L33
?L35:	PRINTB WRD
	JUMP ?L42
?L33:	EQUAL? WRD,W?IT \?L36
	EQUAL? P-IT-LOC,HERE \?L36
	CALL DPRINT,P-IT-OBJECT
	JUMP ?L42
?L36:	EQUAL? WRD,W?HIM,W?HER \?L39
	EQUAL? P-HIM-HER-LOC,HERE \?L39
	CALL DPRINT,P-HIM-HER
	JUMP ?L42
?L39:	GETB BEG,3 >STACK
	GETB BEG,2 >STACK
	CALL WORD-PRINT,STACK,STACK
?L42:	SET 'FIRST??,0
?L27:	ADD BEG,P-WORDLEN >BEG
	JUMP ?L1

	.FUNCT CAPITALIZE,PTR
	GETB PTR,3 >STACK
	GETB P-INBUF,STACK >STACK
	SUB STACK,32 >STACK
	PRINTC STACK
	GETB PTR,3 >STACK
	INC 'STACK
	GETB PTR,2 >STACK
	DEC 'STACK
	CALL WORD-PRINT,STACK,STACK >STACK
	RSTACK

	.FUNCT PREP-PRINT,PREP,WRD
	ZERO? PREP /FALSE
	PRINTI " "
	CALL PREP-FIND,PREP >WRD
	PRINTB WRD
	GET P-ITBL,P-VERBN >STACK
	GET STACK,0 >STACK
	EQUAL? W?SIT,STACK \FALSE
	EQUAL? W?DOWN,WRD \FALSE
	PRINTI " on"
	RTRUE

	.FUNCT CLAUSE-COPY,SRC,DEST,INSRT=0,BEG,END
	GET P-CCTBL,CC-SBPTR >STACK
	GET SRC,STACK >BEG
	GET P-CCTBL,CC-SEPTR >STACK
	GET SRC,STACK >END
	GET P-OCLAUSE,P-MATCHLEN >STACK
	MUL STACK,P-LEXELEN >STACK
	ADD STACK,2 >STACK
	ADD P-OCLAUSE,STACK >STACK
	GET P-CCTBL,CC-DBPTR >STACK
	PUT DEST,STACK,STACK
?L1:	EQUAL? BEG,END \?L3
	GET P-OCLAUSE,P-MATCHLEN >STACK
	MUL STACK,P-LEXELEN >STACK
	ADD STACK,2 >STACK
	ADD P-OCLAUSE,STACK >STACK
	GET P-CCTBL,CC-DEPTR >STACK
	PUT DEST,STACK,STACK
	RTRUE
?L3:	ZERO? INSRT /?L6
	GET BEG,0 >STACK
	EQUAL? P-ANAM,STACK \?L6
	CALL CLAUSE-ADD,INSRT
?L6:	GET BEG,0 >STACK
	CALL CLAUSE-ADD,STACK
	ADD BEG,P-WORDLEN >BEG
	JUMP ?L1

	.FUNCT CLAUSE-ADD,WRD,PTR
	GET P-OCLAUSE,P-MATCHLEN >STACK
	ADD STACK,2 >PTR
	SUB PTR,1 >STACK
	PUT P-OCLAUSE,STACK,WRD
	PUT P-OCLAUSE,PTR,0
	PUT P-OCLAUSE,P-MATCHLEN,PTR
	RTRUE

	.FUNCT PREP-FIND,PREP,CNT=0,SIZE
	GET PREPOSITIONS,0 >STACK
	MUL STACK,2 >SIZE
?L1:	IGRTR? 'CNT,SIZE /FALSE
	GET PREPOSITIONS,CNT >STACK
	EQUAL? STACK,PREP \?L1
	SUB CNT,1 >STACK
	GET PREPOSITIONS,STACK >STACK
	RSTACK

	.FUNCT SYNTAX-FOUND,SYN
	SET 'P-SYNTAX,SYN
	GETB SYN,P-SACTION >PRSA
	RETURN PRSA

	.FUNCT GWIM,GBIT,LBIT,PREP,OBJ
	EQUAL? GBIT,RMUNGBIT \?L1
	RETURN ROOMS
?L1:	SET 'P-GWIMBIT,GBIT
	SET 'P-SLOCBITS,LBIT
	PUT P-MERGE,P-MATCHLEN,0
	CALL GET-OBJECT,P-MERGE,0 >STACK
	ZERO? STACK /?L4
	SET 'P-GWIMBIT,0
	GET P-MERGE,P-MATCHLEN >STACK
	EQUAL? STACK,1 \FALSE
	GET P-MERGE,1 >OBJ
	PRINTI "("
	ZERO? PREP /?L10
	CALL PREP-FIND,PREP >STACK
	PRINTB STACK
	EQUAL? PREP,W?DOWN \?L12
	FSET? OBJ,FURNITURE \?L12
	PRINTI " on"
?L12:	CALL THE?,OBJ
	PRINTI " "
?L10:	CALL DPRINT,OBJ
	PRINTI ")"
	CRLF
	RETURN OBJ
?L4:	SET 'P-GWIMBIT,0
	RFALSE

	.FUNCT SNARF-OBJECTS,PTR
	GET P-ITBL,P-NC1 >PTR
	ZERO? PTR /?L5
	GETB P-SYNTAX,P-SLOC1 >P-SLOCBITS
	GET P-ITBL,P-NC1L >STACK
	CALL SNARFEM,PTR,STACK,P-PRSO >STACK
	ZERO? STACK /FALSE
	GET P-BUTS,P-MATCHLEN >STACK
	ZERO? STACK /?L5
	CALL BUT-MERGE,P-PRSO >P-PRSO
?L5:	GET P-ITBL,P-NC2 >PTR
	ZERO? PTR /TRUE
	GETB P-SYNTAX,P-SLOC2 >P-SLOCBITS
	GET P-ITBL,P-NC2L >STACK
	CALL SNARFEM,PTR,STACK,P-PRSI >STACK
	ZERO? STACK /FALSE
	GET P-BUTS,P-MATCHLEN >STACK
	ZERO? STACK /TRUE
	GET P-PRSI,P-MATCHLEN >STACK
	EQUAL? STACK,1 \?L14
	CALL BUT-MERGE,P-PRSO >P-PRSO
	RTRUE
?L14:	CALL BUT-MERGE,P-PRSI >P-PRSI
	RTRUE

	.FUNCT BUT-MERGE,TBL,LEN,BUTLEN,CNT=1,MATCHES=0,OBJ,NTBL
	GET TBL,P-MATCHLEN >LEN
	PUT P-MERGE,P-MATCHLEN,0
?L1:	DLESS? 'LEN,0 /?L2
	GET TBL,CNT >OBJ
	CALL ZMEMQ,OBJ,P-BUTS >STACK
	ZERO? STACK \?L6
	ADD MATCHES,1 >STACK
	PUT P-MERGE,STACK,OBJ
	INC 'MATCHES
?L6:	INC 'CNT
	JUMP ?L1
?L2:	PUT P-MERGE,P-MATCHLEN,MATCHES
	SET 'NTBL,P-MERGE
	SET 'P-MERGE,TBL
	RETURN NTBL

	.FUNCT SNARFEM,PTR,EPTR,TBL,AND=0,BUT=0,LEN,WV,WORD,NW,WAS-ALL=0
	SET 'P-AND,0
	EQUAL? P-GETFLAGS,P-ALL \?L1
	SET 'WAS-ALL,1
?L1:	SET 'P-GETFLAGS,0
	SET 'P-CSPTR,PTR
	SET 'P-CEPTR,EPTR
	PUT P-BUTS,P-MATCHLEN,0
	PUT TBL,P-MATCHLEN,0
	GET PTR,0 >WORD
?L4:	EQUAL? PTR,EPTR \?L6
?L54:	ZERO? BUT /?L9
	PUSH BUT
	JUMP ?L8
?L9:	PUSH TBL
?L8:	CALL GET-OBJECT,STACK >WV
	ZERO? WAS-ALL /?L10
	SET 'P-GETFLAGS,P-ALL
?L10:	RETURN WV
?L6:	GET PTR,P-LEXELEN >NW
	EQUAL? WORD,W?ALL \?L14
	SET 'P-GETFLAGS,P-ALL
	EQUAL? NW,W?OF \?L49
	ADD PTR,P-WORDLEN >PTR
	JUMP ?L49
?L14:	EQUAL? WORD,W?BUT,W?EXCEPT \?L19
	ZERO? BUT /?L23
	PUSH BUT
	JUMP ?L22
?L23:	PUSH TBL
?L22:	CALL GET-OBJECT,STACK >STACK
	ZERO? STACK /FALSE
	SET 'BUT,P-BUTS
	PUT BUT,P-MATCHLEN,0
	JUMP ?L49
?L19:	EQUAL? WORD,W?A,W?ONE \?L24
	ZERO? P-ADJ \?L25
	SET 'P-GETFLAGS,P-ONE
	EQUAL? NW,W?OF \?L49
	ADD PTR,P-WORDLEN >PTR
	JUMP ?L49
?L25:	SET 'P-NAM,P-ONEOBJ
	ZERO? BUT /?L34
	PUSH BUT
	JUMP ?L33
?L34:	PUSH TBL
?L33:	CALL GET-OBJECT,STACK >STACK
	ZERO? STACK /FALSE
	ZERO? NW /TRUE
	JUMP ?L49
?L24:	EQUAL? WORD,W?AND,W?$COMMA \?L37
	EQUAL? NW,W?AND,W?$COMMA /?L37
	SET 'P-AND,1
	ZERO? BUT /?L41
	PUSH BUT
	JUMP ?L40
?L41:	PUSH TBL
?L40:	CALL GET-OBJECT,STACK >STACK
	ZERO? STACK /FALSE
	JUMP ?L49
?L37:	CALL WT?,WORD,PS?BUZZ-WORD >STACK
	ZERO? STACK \?L49
	EQUAL? WORD,W?AND,W?$COMMA /?L49
	EQUAL? WORD,W?OF \?L44
	ZERO? P-GETFLAGS \?L49
	SET 'P-GETFLAGS,P-INHIBIT
	JUMP ?L49
?L44:	CALL WT?,WORD,PS?ADJECTIVE,P1?ADJECTIVE >WV
	ZERO? WV /?L48
	ZERO? P-ADJ \?L48
	SET 'P-ADJ,WV
	SET 'P-ADJN,WORD
	JUMP ?L49
?L48:	CALL WT?,WORD,PS?OBJECT,P1?OBJECT >STACK
	ZERO? STACK /?L49
	SET 'P-NAM,WORD
	SET 'P-ONEOBJ,WORD
?L49:	EQUAL? PTR,EPTR /?L54
	ADD PTR,P-WORDLEN >PTR
	SET 'WORD,NW
	JUMP ?L4

	.FUNCT TELL-NO-NOUNS
	PRINTR "There aren't enough nouns in that sentence."

	.FUNCT GET-OBJECT,TBL,VRB=1,BITS,LEN,XBITS,TLEN,GCHECK=0,OLEN=0,OBJ
	SET 'XBITS,P-SLOCBITS
	GET TBL,P-MATCHLEN >TLEN
	BTST P-GETFLAGS,P-INHIBIT /TRUE
	ZERO? P-NAM \?L7
	ZERO? P-ADJ /?L4
	CALL WT?,P-ADJN,PS?OBJECT,P1?OBJECT >STACK
	ZERO? STACK /?L4
	SET 'P-NAM,P-ADJN
	SET 'P-ADJ,0
?L4:	ZERO? P-NAM \?L7
	ZERO? P-ADJ \?L7
	EQUAL? P-GETFLAGS,P-ALL /?L55
	ZERO? P-GWIMBIT \?L7
	ZERO? VRB /FALSE
	CALL TELL-NO-NOUNS
	RFALSE
?L7:	EQUAL? P-GETFLAGS,P-ALL \?L15
?L55:	ZERO? P-SLOCBITS \?L13
?L15:	SET 'P-SLOCBITS,-1
?L13:	SET 'P-TABLE,TBL
?L17:	ZERO? GCHECK /?L19
	CALL GLOBAL-CHECK,TBL
	JUMP ?L21
?L19:	FCLEAR PLAYER,TRANSBIT
	CALL DO-SL,HERE,SOG,SIR
	FSET PLAYER,TRANSBIT
	CALL DO-SL,PLAYER,SH,SC
?L21:	GET TBL,P-MATCHLEN >STACK
	SUB STACK,TLEN >LEN
	BTST P-GETFLAGS,P-ALL /?L53
	BTST P-GETFLAGS,P-ONE \?L24
	ZERO? LEN /?L24
	EQUAL? LEN,1 /?L25
	RANDOM LEN >STACK
	GET TBL,STACK >STACK
	PUT TBL,1,STACK
	PRINTI "How about the "
	GET TBL,1 >STACK
	CALL DPRINT,STACK
	PRINTI "?"
	CRLF
?L25:	PUT TBL,P-MATCHLEN,1
	JUMP ?L53
?L24:	GRTR? LEN,1 /?L31
	ZERO? LEN \?L53
	EQUAL? P-SLOCBITS,-1 /?L30
?L31:	EQUAL? P-SLOCBITS,-1 \?L32
	SET 'P-SLOCBITS,XBITS
	SET 'OLEN,LEN
	GET TBL,P-MATCHLEN >STACK
	SUB STACK,LEN >STACK
	PUT TBL,P-MATCHLEN,STACK
	JUMP ?L17
?L32:	ZERO? LEN \?L35
	SET 'LEN,OLEN
?L35:	ZERO? P-NAM /?L38
	ADD TLEN,1 >STACK
	GET TBL,STACK >OBJ
	ZERO? OBJ /?L38
	GETP OBJ,P?GENERIC >STACK
	CALL STACK,P-NAM >OBJ
	ZERO? OBJ /?L38
	EQUAL? OBJ,NOT-HERE-OBJECT /FALSE
	PUT TBL,1,OBJ
	PUT TBL,P-MATCHLEN,1
	SET 'P-NAM,0
	SET 'P-ADJ,0
	RTRUE
?L38:	ZERO? VRB /?L47
	ZERO? P-NAM /?L43
	CALL WHICH-PRINT,TLEN,LEN,TBL
	EQUAL? TBL,P-PRSO \?L44
	SET 'P-ACLAUSE,P-NC1
	JUMP ?L46
?L44:	SET 'P-ACLAUSE,P-NC2
?L46:	SET 'P-AADJ,P-ADJ
	SET 'P-ANAM,P-NAM
	CALL ORPHAN,0,0
	SET 'P-OFLAG,1
	JUMP ?L47
?L43:	ZERO? VRB /?L47
	CALL TELL-NO-NOUNS
?L47:	SET 'P-NAM,0
	SET 'P-ADJ,0
	RFALSE
?L30:	ZERO? LEN \?L53
	ZERO? GCHECK /?L49
	SET 'P-SLOCBITS,XBITS
	ZERO? VRB /?L50
	CALL OBJ-FOUND,NOT-HERE-OBJECT,TBL
	SET 'P-XNAM,P-NAM
	SET 'P-XADJ,P-ADJ
	SET 'P-XADJN,P-ADJN
	SET 'P-NAM,0
	SET 'P-ADJ,0
	SET 'P-ADJN,0
	RTRUE
?L50:	SET 'P-NAM,0
	SET 'P-ADJ,0
	RFALSE
?L49:	ZERO? LEN \?L53
	SET 'GCHECK,1
	JUMP ?L17
?L53:	SET 'P-SLOCBITS,XBITS
	SET 'P-NAM,0
	SET 'P-ADJ,0
	RTRUE

	.FUNCT MOBY-FIND,TBL,FOO,LEN
	SET 'P-MOBY-FLAG,1
	SET 'P-TABLE,TBL
	SET 'P-SLOCBITS,-1
	SET 'P-NAM,P-XNAM
	SET 'P-ADJ,P-XADJ
	PUT TBL,P-MATCHLEN,0
	FIRST? ROOMS >FOO \?L3
?L4:	CALL SEARCH-LIST,FOO,TBL,P-SRCALL
	NEXT? FOO >FOO /?L4
?L3:	GET TBL,P-MATCHLEN >LEN
	ZERO? LEN \?L8
	CALL DO-SL,LOCAL-GLOBALS,1,1
?L8:	GET TBL,P-MATCHLEN >LEN
	ZERO? LEN \?L11
	CALL DO-SL,ROOMS,1,1
?L11:	GET TBL,P-MATCHLEN >LEN
	EQUAL? LEN,1 \?L14
	GET TBL,1 >P-MOBY-FOUND
?L14:	SET 'P-MOBY-FLAG,0
	RETURN LEN

	.FUNCT WHICH-PRINT,TLEN,LEN,TBL,OBJ,RLEN
	SET 'RLEN,LEN
	EQUAL? WINNER,PLAYER \?L1
	PRINTI "Which"
	JUMP ?L5
?L1:	PRINTI "Tell "
	CALL THE-PRINT,WINNER
	PRINTI " which"
?L5:	ZERO? P-OFLAG \?L10
	ZERO? P-MERGED \?L10
	ZERO? P-AND /?L8
?L10:	PRINTI " "
	PRINTB P-NAM
	JUMP ?L14
?L8:	EQUAL? TBL,P-PRSO \?L13
	CALL CLAUSE-PRINT,P-NC1,P-NC1L,0
	JUMP ?L14
?L13:	CALL CLAUSE-PRINT,P-NC2,P-NC2L,0
?L14:	EQUAL? WINNER,PLAYER \?L15
	PRINTI " do"
?L15:	PRINTI " you mean,"
?L22:	INC 'TLEN
	GET TBL,TLEN >OBJ
	PRINTI " "
	CALL THE-PRINT,OBJ
	EQUAL? LEN,2 \?L26
	EQUAL? RLEN,2 /?L28
	PRINTI ","
?L28:	PRINTI " or"
	JUMP ?L35
?L26:	GRTR? LEN,2 \?L35
	PRINTI ","
?L35:	DLESS? 'LEN,1 \?L22
	PRINTR "?"

	.FUNCT GLOBAL-CHECK,TBL,LEN,RMG,RMGL,CNT=0,OBJ,OBITS,FOO
	GET TBL,P-MATCHLEN >LEN
	SET 'OBITS,P-SLOCBITS
	GETPT HERE,P?GLOBAL >RMG
	ZERO? RMG /?L4
	PTSIZE RMG >STACK
	SUB STACK,1 >RMGL
?L3:	GETB RMG,CNT >OBJ
	CALL THIS-IT?,OBJ,TBL >STACK
	ZERO? STACK /?L5
	CALL OBJ-FOUND,OBJ,TBL
?L5:	IGRTR? 'CNT,RMGL \?L3
?L4:	GETPT HERE,P?PSEUDO >RMG
	ZERO? RMG /?L15
	PTSIZE RMG >STACK
	DIV STACK,4 >STACK
	SUB STACK,1 >RMGL
	SET 'CNT,0
?L14:	MUL CNT,2 >STACK
	GET RMG,STACK >STACK
	EQUAL? P-NAM,STACK \?L16
	MUL CNT,2 >STACK
	INC 'STACK
	GET RMG,STACK >STACK
	PUTP PSEUDO-OBJECT,P?ACTION,STACK
	GETPT PSEUDO-OBJECT,P?ACTION >STACK
	SUB STACK,5 >FOO
	GET P-NAM,0 >STACK
	PUT FOO,0,STACK
	GET P-NAM,1 >STACK
	PUT FOO,1,STACK
	CALL OBJ-FOUND,PSEUDO-OBJECT,TBL
	JUMP ?L15
?L16:	IGRTR? 'CNT,RMGL \?L14
?L15:	GET TBL,P-MATCHLEN >STACK
	EQUAL? STACK,LEN \FALSE
	SET 'P-SLOCBITS,-1
	SET 'P-TABLE,TBL
	CALL DO-SL,GLOBAL-OBJECTS,1,1
	SET 'P-SLOCBITS,OBITS
	RETURN P-SLOCBITS

	.FUNCT DO-SL,OBJ,BIT1,BIT2,BITS
	EQUAL? OBJ,ROOMS /?L1
	ADD BIT1,BIT2 >STACK
	BTST P-SLOCBITS,STACK \?L1
	CALL SEARCH-LIST,OBJ,P-TABLE,P-SRCALL >STACK
	RSTACK
?L1:	BTST P-SLOCBITS,BIT1 \?L4
	CALL SEARCH-LIST,OBJ,P-TABLE,P-SRCTOP >STACK
	RSTACK
?L4:	BTST P-SLOCBITS,BIT2 \TRUE
	CALL SEARCH-LIST,OBJ,P-TABLE,P-SRCBOT >STACK
	RSTACK

	.FUNCT SEARCH-LIST,OBJ,TBL,LVL,FLS
	FIRST? OBJ >OBJ \FALSE
?L3:	EQUAL? LVL,P-SRCBOT /?L5
	GETPT OBJ,P?SYNONYM >STACK
	ZERO? STACK /?L5
	CALL THIS-IT?,OBJ,TBL >STACK
	ZERO? STACK /?L5
	CALL OBJ-FOUND,OBJ,TBL
?L5:	EQUAL? LVL,P-SRCTOP \?L10
	FSET? OBJ,SEARCHBIT /?L10
	FSET? OBJ,SURFACEBIT \?L8
?L10:	FIRST? OBJ >STACK \?L8
	EQUAL? OBJ,PLAYER,LOCAL-GLOBALS /?L8
	FSET? OBJ,OPENBIT /?L11
	FSET? OBJ,TRANSBIT /?L11
	ZERO? P-MOBY-FLAG /?L8
?L11:	FSET? OBJ,SURFACEBIT \?L12
	PUSH P-SRCALL
	JUMP ?L15
?L12:	FSET? OBJ,SEARCHBIT \?L14
	PUSH P-SRCALL
	JUMP ?L15
?L14:	PUSH P-SRCTOP
?L15:	CALL SEARCH-LIST,OBJ,TBL,STACK >FLS
?L8:	NEXT? OBJ >OBJ /?L3
	RTRUE

	.FUNCT THIS-IT?,OBJ,TBL,SYNS
	FSET? OBJ,INVISIBLE /FALSE
	ZERO? P-NAM /?L3
	GETPT OBJ,P?SYNONYM >SYNS
	PTSIZE SYNS >STACK
	DIV STACK,2 >STACK
	DEC 'STACK
	CALL ZMEMQ,P-NAM,SYNS,STACK >STACK
	ZERO? STACK /FALSE
?L3:	ZERO? P-ADJ /?L4
	GETPT OBJ,P?ADJECTIVE >SYNS
	ZERO? SYNS /FALSE
	PTSIZE SYNS >STACK
	DEC 'STACK
	CALL ZMEMQB,P-ADJ,SYNS,STACK >STACK
	ZERO? STACK /FALSE
?L4:	ZERO? P-GWIMBIT /TRUE
	FSET? OBJ,P-GWIMBIT /TRUE
	RFALSE

	.FUNCT OBJ-FOUND,OBJ,TBL,PTR
	GET TBL,P-MATCHLEN >PTR
	ADD PTR,1 >STACK
	PUT TBL,STACK,OBJ
	ADD PTR,1 >STACK
	PUT TBL,P-MATCHLEN,STACK
	RTRUE

	.FUNCT TAKE-CHECK
	GETB P-SYNTAX,P-SLOC1 >STACK
	CALL ITAKE-CHECK,P-PRSO,STACK >STACK
	ZERO? STACK /FALSE
	GETB P-SYNTAX,P-SLOC2 >STACK
	CALL ITAKE-CHECK,P-PRSI,STACK >STACK
	RSTACK

	.FUNCT ITAKE-CHECK,TBL,BITS,PTR,OBJ,TAKEN
	GET TBL,P-MATCHLEN >PTR
	ZERO? PTR /TRUE
	BTST BITS,SHAVE /?L3
	BTST BITS,STAKE \TRUE
?L3:	DLESS? 'PTR,0 /TRUE
	ADD PTR,1 >STACK
	GET TBL,STACK >OBJ
	EQUAL? OBJ,IT \?L9
	SET 'OBJ,P-IT-OBJECT
	JUMP ?L11
?L9:	EQUAL? OBJ,HIM-HER \?L11
	SET 'OBJ,P-HIM-HER
?L11:	CALL HELD?,OBJ >STACK
	ZERO? STACK \?L3
	SET 'PRSO,OBJ
	FSET? OBJ,TRYTAKEBIT \?L15
	SET 'TAKEN,1
	JUMP ?L19
?L15:	EQUAL? WINNER,PLAYER /?L17
	SET 'TAKEN,0
	JUMP ?L19
?L17:	BTST BITS,STAKE \?L18
	CALL ITAKE,0 >STACK
	EQUAL? STACK,1 \?L18
	SET 'TAKEN,0
	JUMP ?L19
?L18:	SET 'TAKEN,1
?L19:	ZERO? TAKEN /?L39
	BTST BITS,SHAVE \?L20
	PRINT YOU-DONT-HAVE
	EQUAL? OBJ,NOT-HERE-OBJECT \?L24
	PRINTI "that"
	JUMP ?L28
?L24:	CALL THIS-IS-IT,OBJ
	CALL THE-PRINT,OBJ
?L28:	PRINTI "."
	CRLF
	RFALSE
?L20:	ZERO? TAKEN \?L3
?L39:	EQUAL? WINNER,PLAYER \?L3
	PRINTI "(taking "
	CALL THE-PRINT,OBJ
	PRINTI " first)"
	CRLF
	JUMP ?L3

	.FUNCT MANY-CHECK,LOSS=0,TMP
	GET P-PRSO,P-MATCHLEN >STACK
	GRTR? STACK,1 \?L1
	GETB P-SYNTAX,P-SLOC1 >STACK
	BTST STACK,SMANY /?L1
	SET 'LOSS,1
	JUMP ?L3
?L1:	GET P-PRSI,P-MATCHLEN >STACK
	GRTR? STACK,1 \?L3
	GETB P-SYNTAX,P-SLOC2 >STACK
	BTST STACK,SMANY /?L3
	SET 'LOSS,2
?L3:	ZERO? LOSS /TRUE
	PRINTI "You can't use multiple "
	EQUAL? LOSS,2 \?L9
	PRINTI "in"
?L9:	PRINTI "direct objects with """
	GET P-ITBL,P-VERBN >TMP
	ZERO? TMP \?L16
	PRINTI "tell"
	JUMP ?L22
?L16:	ZERO? P-OFLAG \?L21
	ZERO? P-MERGED /?L20
?L21:	GET TMP,0 >STACK
	PRINTB STACK
	JUMP ?L22
?L20:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
?L22:	PRINTI "."""
	CRLF
	RFALSE

	.FUNCT ZMEMQ,ITM,TBL,SIZE=-1,CNT=1
	ZERO? TBL /FALSE
	LESS? SIZE,0 /?L4
	SET 'CNT,0
	JUMP ?L6
?L4:	GET TBL,0 >SIZE
?L6:	GET TBL,CNT >STACK
	EQUAL? ITM,STACK /TRUE
	IGRTR? 'CNT,SIZE \?L6
	RFALSE

	.FUNCT ZMEMQB,ITM,TBL,SIZE,CNT=0
?L1:	GETB TBL,CNT >STACK
	EQUAL? ITM,STACK /TRUE
	IGRTR? 'CNT,SIZE \?L1
	RFALSE

	.FUNCT V-SCRIPT
	GET 0,8 >STACK
	BOR STACK,1 >STACK
	PUT 0,8,STACK
	CALL SCRIPT-STUFF,STR?46
	CALL V-VERSION
	RTRUE

	.FUNCT V-UNSCRIPT
	CALL SCRIPT-STUFF,STR?47
	GET 0,8 >STACK
	BAND STACK,-2 >STACK
	PUT 0,8,STACK
	RTRUE

	.FUNCT SCRIPT-STUFF,STR
	PRINTI "Script "
	PRINT STR
	PRINTR "."

	.FUNCT V-$0024VERIFY
	EQUAL? PRSO,INTNUM \?L1
	EQUAL? P-NUMBER,1949 \?L1
	PRINTN SERIAL
	CRLF
	RTRUE
?L1:	ZERO? PRSO /?L5
	PRINT SORRY-I-DONT
	CRLF
	RTRUE
?L5:	PRINTI "Verifying disk..."
	CRLF
	VERIFY \?L11
	PRINTR "The disk is correct."
?L11:	CRLF
	PRINTR "** Disk Failure **"

	.FUNCT V-AGAIN,OBJ
	ZERO? L-PRSA \?L1
	PRINTR "Not yet."
?L1:	EQUAL? L-PRSA,V?WALK \?L5
	CALL PERFORM,L-PRSA,L-PRSO >STACK
	RSTACK
?L5:	ZERO? L-PRSO /?L7
	LOC L-PRSO >STACK
	ZERO? STACK \?L7
	SET 'OBJ,L-PRSO
	JUMP ?L8
?L7:	ZERO? L-PRSI /?L9
	LOC L-PRSO >STACK
	ZERO? STACK \?L9
	SET 'OBJ,L-PRSI
	JUMP ?L8
?L9:	SET 'OBJ,0
?L8:	EQUAL? OBJ,0,PSEUDO-OBJECT,ROOMS /?L11
	PRINTI "I can't see "
	CALL THE-PRINT,OBJ
	PRINTI " anymore."
	CRLF
	RETURN 2
?L11:	CALL PERFORM,L-PRSA,L-PRSO,L-PRSI >STACK
	RSTACK

	.FUNCT V-BRIEF
	SET 'VERBOSE,0
	SET 'SUPER-BRIEF,0
	SET 'P-SPACE,1
	PRINTI "Brief"
	PRINT DESCRIPTIONS
	CRLF
	RTRUE

	.FUNCT V-SUPER-BRIEF
	SET 'SUPER-BRIEF,1
	SET 'P-SPACE,0
	PRINTI "Super-brief"
	PRINT DESCRIPTIONS
	CRLF
	RTRUE

	.FUNCT V-VERBOSE
	SET 'VERBOSE,1
	SET 'SUPER-BRIEF,0
	SET 'P-SPACE,1
	PRINTI "Verbose"
	PRINT DESCRIPTIONS
	CRLF
	RTRUE

	.FUNCT V-SPACE
	SET 'P-SPACE,1
	RETURN P-SPACE

	.FUNCT V-UNSPACE
	SET 'P-SPACE,0
	RTRUE

	.FUNCT V-INVENTORY
	FIRST? WINNER >STACK \?L1
	CALL PRINT-CONT,WINNER >STACK
	ZERO? STACK \TRUE
?L1:	PRINT YOU-ARE
	PRINTR "empty-handed."

	.FUNCT V-TIME
	PRINTI "It's now "
	CALL TIME-PRINT,PRESENT-TIME
	CRLF
	RTRUE

	.FUNCT TIME-PRINT,NUM,AMPM=1,HR,AM=0
	DIV NUM,60 >HR
	GRTR? HR,12 \?L1
	SUB HR,12 >HR
	SET 'AM,1
	JUMP ?L3
?L1:	EQUAL? HR,12 \?L3
	SET 'AM,1
?L3:	PRINTN HR
	PRINTI ":"
	MOD NUM,60 >HR
	LESS? HR,10 \?L7
	PRINTI "0"
?L7:	PRINTN HR
	ZERO? AMPM /?L14
	PRINTI " "
	ZERO? AM /?L18
	PUSH STR?48
	JUMP ?L20
?L18:	PUSH STR?49
?L20:	PRINT STACK
?L14:	PRINTI "."
	RTRUE

	.FUNCT QUIT-WARNING
	EQUAL? L-PRSA,V?SAVE /?L1
	PRINTI "If you want to continue from this point at another time, you must ""SAVE"" first. "
?L1:	PRINT DO-YOU-WANT-TO
	PRINTI "stop now?"
	RTRUE

	.FUNCT V-QUIT,ASK?=1,SCOR
	ZERO? ASK? /?L3
	CALL QUIT-WARNING >STACK
	ZERO? STACK /?L4
	CALL YES? >STACK
	ZERO? STACK \?L3
?L4:	ZERO? ASK? \?L1
?L3:	QUIT
?L1:	PRINTR "O.K."

	.FUNCT V-RESTART
	PRINTI "Do you wish to restart the story?"
	CALL YES? >STACK
	ZERO? STACK /FALSE
	RESTART

	.FUNCT TELL-STATUS,STR
	PRINTI "Your "
	PRINT STR
	PRINTI " status couldn't be restored."
	PRINT CONSULT
	CRLF
	RTRUE

	.FUNCT V-RESTORE
	RESTORE \?L1
	PRINTI "O.K."
	CRLF
	CALL V-FIRST-LOOK >STACK
	RSTACK
?L1:	CALL TELL-STATUS,STR?51 >STACK
	RSTACK

	.FUNCT V-FIRST-LOOK
	CALL DESCRIBE-ROOM >STACK
	ZERO? STACK /FALSE
	ZERO? SUPER-BRIEF \FALSE
	CALL DESCRIBE-OBJECTS >STACK
	RSTACK

	.FUNCT V-SAVE
	SAVE \?L1
	PRINTR "O.K."
?L1:	PRINTI "Your story couldn't be saved."
	PRINT CONSULT
	CRLF
	RTRUE

	.FUNCT V-VERSION,CNT=17
	PRINTI "SUSPECT
Infocom interactive fiction - a mystery story
Copyright (c) 1984 Infocom, Inc. All rights reserved.
"
	PRINTI "SUSPECT is a registered trademark of Infocom, Inc.
Release number "
	GET 0,1 >STACK
	BAND STACK,2047 >STACK
	PRINTN STACK
	PRINTI " / Serial number "
?L7:	IGRTR? 'CNT,23 /?L8
	GETB 0,CNT >STACK
	PRINTC STACK
	JUMP ?L7
?L8:	CRLF
	RTRUE

	.FUNCT YES?,RESTORE?=0,W
?L1:	PRINTI " (Answer YES"
	ZERO? RESTORE? /?L3
	PRINTI " or RESTORE"
?L3:	PRINTI " or NO"
	PRINTI ".) >"
	READ Y-INBUF,Y-LEXV
	GETB Y-LEXV,P-LEXWORDS >STACK
	ZERO? STACK /FALSE
	GET Y-LEXV,1 >W
	ZERO? RESTORE? /?L11
	EQUAL? W,W?RESTORE \?L11
	RETURN 2
?L11:	EQUAL? W,W?YES,W?Y /TRUE
	EQUAL? W,W?NO,W?N \?L1
	RFALSE

	.FUNCT DESCRIBE-OBJECT,OBJ,V?,LEVEL,STR=0,AV
	ZERO? LEVEL \?L13
	FSET? OBJ,PERSON \?L1
	CALL IN-MOTION?,OBJ >STACK
	ZERO? STACK \TRUE
?L1:	ZERO? LEVEL \?L13
	GETP OBJ,P?DESCFCN >STACK
	CALL STACK,M-OBJDESC >STACK
	ZERO? STACK \TRUE
	ZERO? LEVEL \?L13
	FSET? OBJ,TOUCHBIT /?L10
	GETP OBJ,P?FDESC >STR
	ZERO? STR \?L9
?L10:	GETP OBJ,P?LDESC >STR
	ZERO? STR /?L7
?L9:	PRINT STR
	JUMP ?L34
?L7:	ZERO? LEVEL \?L13
	FSET? OBJ,PERSON \?L14
	CALL DPRINT,OBJ,1
	PRINTI " is"
	JUMP ?L18
?L14:	PRINTI "There's "
	CALL PRINTA,OBJ
?L18:	PRINTI " here."
	JUMP ?L34
?L13:	GET INDENTS,LEVEL >STACK
	PRINT STACK
	FSET? OBJ,PERSON /?L28
	EQUAL? OBJ,CORPSE \?L26
?L28:	CALL DPRINT,OBJ
	JUMP ?L34
?L26:	CALL PRINTA,OBJ
	FSET? OBJ,WEARBIT \?L34
	PRINTI " (being worn)"
?L34:	ZERO? LEVEL \?L39
	LOC WINNER >AV
	ZERO? AV /?L39
	FSET? AV,VEHBIT \?L39
	FSET? AV,FURNITURE /?L39
	PRINTI " (outside "
	CALL THE-PRINT,AV
	PRINTI ")"
?L39:	CRLF
	CALL SEE-INSIDE?,OBJ >STACK
	ZERO? STACK /FALSE
	FIRST? OBJ >STACK \FALSE
	CALL PRINT-CONT,OBJ,V?,LEVEL >STACK
	RSTACK

	.FUNCT DESCRIBE-OBJECTS,V?=0
	FIRST? HERE >STACK \FALSE
	ZERO? V? \?L3
	SET 'V?,VERBOSE
?L3:	CALL PRINT-CONT,HERE,V?,-1 >STACK
	RSTACK

	.FUNCT DESCRIBE-ROOM,LOOK?=0,V?,F?=0,STR,L
	SET 'V?,LOOK?
	ZERO? V? \?L1
	SET 'V?,VERBOSE
?L1:	FSET? HERE,TOUCHBIT /?L3
	FSET HERE,TOUCHBIT
	SET 'V?,1
	SET 'F?,1
?L3:	GETP HERE,P?LINE >STACK
	EQUAL? STACK,BALLROOM-LINE-C \?L6
	PRINTI "Ballroom, "
?L6:	CALL DPRINT,HERE
	SET 'L,PLAYER-HIDING
	ZERO? L /?L13
	PRINTI ", hiding "
	EQUAL? L,WINDOW-SEAT \?L17
	PRINTI "in "
	JUMP ?L21
?L17:	PRINTI "behind "
?L21:	CALL THE-PRINT,L
	JUMP ?L26
?L13:	LOC WINNER >L
	FSET? L,VEHBIT \?L26
	PRINTI ", "
	EQUAL? L,CHAIR,GLOBAL-CHAIR \?L29
	PRINTI "sitting in"
	JUMP ?L37
?L29:	FSET? L,SURFACEBIT /?L34
	EQUAL? L,GLOBAL-SOFA \?L33
?L34:	PRINTI "sitting on"
	JUMP ?L37
?L33:	PRINTI "standing in"
?L37:	PRINTI " "
	CALL THE-PRINT,L
?L26:	CRLF
	ZERO? LOOK? \?L45
	ZERO? SUPER-BRIEF \?L65
?L45:	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK /?L46
	CALL OUTSIDE?,OHERE >STACK
	ZERO? STACK \?L46
	ZERO? RAIN-STATE /?L46
	EQUAL? RAIN-STATE,1 \?L48
	SET 'SAW-RAIN-SLACK-OFF?,1
	PRINTI "Rain is falling in a light drizzle."
	JUMP ?L52
?L48:	PRINTI "Rain falls in a downpour."
?L52:	CRLF
?L46:	ZERO? V? /?L61
	GETP HERE,P?ACTION >STACK
	CALL STACK,M-LOOK >STACK
	ZERO? STACK \TRUE
	ZERO? V? /?L61
	GETP HERE,P?FDESC >STR
	ZERO? STR /?L58
	PRINT STR
	CRLF
	JUMP ?L64
?L58:	ZERO? V? /?L61
	GETP HERE,P?LDESC >STR
	ZERO? STR /?L61
	PRINT STR
	CRLF
	JUMP ?L64
?L61:	GETP HERE,P?ACTION >STACK
	CALL STACK,M-FLASH >STACK
?L64:	EQUAL? HERE,L /?L65
	GETP L,P?ACTION >STACK
	CALL STACK,M-LOOK >STACK
?L65:	GETP HERE,P?CORRIDOR >STACK
	ZERO? STACK /TRUE
	CALL CORRIDOR-LOOK
	RTRUE

	.FUNCT FIRSTER,OBJ,LEVEL
	EQUAL? OBJ,WINNER \?L1
	PRINT YOU-ARE
	PRINTR "carrying:"
?L1:	IN? OBJ,ROOMS /FALSE
	GRTR? LEVEL,0 \?L6
	GET INDENTS,LEVEL >STACK
	PRINT STACK
?L6:	FSET? OBJ,SURFACEBIT \?L11
	EQUAL? OBJ,WINDOW-SEAT /?L11
	PRINTI "Sitting on "
	CALL THE-PRINT,OBJ
	PRINTR " can be seen:"
?L11:	FSET? OBJ,PERSON \?L15
	CALL DPRINT,OBJ,1
	PRINTR " is holding:"
?L15:	CALL THE-PRINT,OBJ,1
	PRINTR " contains:"

	.FUNCT GONE-CRAZY
	PRINTI "Murder or no murder, this gets you arrested for sure!"
	CRLF
	CALL FINISH >STACK
	RSTACK

	.FUNCT GOTO,RM,V?=1,F,WT,VAL,INSIDE?=0
	ZERO? DUFFY-SNARFED /?L1
	CALL IRON-GRIP
	RTRUE
?L1:	CALL PLAYER-GETS-UP
	GRTR? RAIN-STATE,0 \?L22
	CALL OUTSIDE?,RM >STACK
	ZERO? STACK /?L22
	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK /?L6
	PRINTI "It's"
	JUMP ?L10
?L6:	SET 'INSIDE?,1
	PRINTI "You go outside, where it's"
?L10:	PRINTI " dark and cloudy, and the territory is unfamiliar."
	CRLF
	ZERO? INSIDE? /?L15
	CRLF
	JUMP ?L22
?L15:	CALL INT-WAIT,2 >VAL
	ZERO? VAL \?L17
	PRINTR "You stop."
?L17:	EQUAL? VAL,M-FATAL /TRUE
	ZERO? DUFFY-SNARFED \TRUE
	PRINTI "You finally get there."
	CRLF
	CRLF
?L22:	CALL MOVE-PLAYER,RM
	GETP HERE,P?ACTION >STACK
	CALL STACK,M-ENTER >STACK
	ZERO? V? /FALSE
	CALL V-FIRST-LOOK >STACK
	RSTACK

	.FUNCT MOVE-PLAYER,RM
	SET 'OHERE,HERE
	MOVE PLAYER,RM
	SET 'HERE,RM
	CALL WHERE-UPDATE,PLAYER >STACK
	RSTACK

	.FUNCT HACK-HACK,STR
	IN? PRSO,GLOBAL-OBJECTS \?L1
	CALL NOT-HERE,PRSO >STACK
	RSTACK
?L1:	PRINT STR
	PRINTI " "
	CALL THE-PRINT,PRSO
	CALL PICK-ONE,HO-HUM >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT HELD?,OBJ,CONT=0
	ZERO? CONT \?L1
	SET 'CONT,WINNER
?L1:	ZERO? OBJ /FALSE
	IN? OBJ,CONT /TRUE
	LOC OBJ >STACK
	EQUAL? STACK,ROOMS,GLOBAL-OBJECTS /FALSE
	LOC OBJ >STACK
	CALL HELD?,STACK >STACK
	RSTACK

	.FUNCT IDROP
	FSET? PRSO,PERSON \?L1
	CALL DPRINT,PRSO,1
	PRINTI " wouldn't enjoy that."
	CRLF
	RFALSE
?L1:	IN? PRSO,WINNER /?L8
	LOC PRSO >STACK
	IN? STACK,WINNER /?L5
	PRINT YOU-ARENT
	PRINTI "carrying "
	CALL TELL-PRSO
	RFALSE
?L5:	IN? PRSO,WINNER /?L8
	LOC PRSO >STACK
	FSET? STACK,OPENBIT /?L8
	CALL TELL-CLOSED
	RFALSE
?L8:	FCLEAR PRSO,WEARBIT
	MOVE PRSO,HERE
	RTRUE

	.FUNCT ITAKE,VB=1,CNT,OBJ,?TMP
	FSET? PRSO,TAKEBIT /?L1
	ZERO? VB /FALSE
	CALL TELL-YOU-CANT,STR?52,0
	CALL TELL-PRSO
	RFALSE
?L1:	LOC PRSO >STACK
	IN? STACK,WINNER /?L6
	CALL WEIGHT,PRSO >?TMP
	CALL WEIGHT,WINNER >STACK
	ADD ?TMP,STACK >STACK
	GRTR? STACK,LOAD-ALLOWED \?L6
	ZERO? VB /?L7
	CALL WEIGHT,PRSO >STACK
	GRTR? STACK,LOAD-ALLOWED \?L9
	PRINTI "It's too heavy to carry"
	JUMP ?L13
?L9:	PRINTI "Your load's too heavy"
?L13:	PRINTI "."
	CRLF
?L7:	RETURN 2
?L6:	CALL CCOUNT,WINNER >CNT
	GRTR? CNT,FUMBLE-NUMBER \?L21
	ZERO? VB /?L22
	CALL TELL-YOU-CANT,STR?53
?L22:	RETURN 2
?L21:	MOVE PRSO,WINNER
	FSET PRSO,TOUCHBIT
	FCLEAR PRSO,NDESCBIT
	FCLEAR PRSO,INVISIBLE
	RTRUE

	.FUNCT CCOUNT,OBJ,CNT=0,X
	FIRST? OBJ >X \?L4
?L3:	FSET? X,WEARBIT /?L5
	INC 'CNT
?L5:	NEXT? X >X /?L3
?L4:	RETURN CNT

	.FUNCT NOT-HERE,OBJ
	SET 'P-WON,0
	PRINT YOU-CANT-SEE
	CALL THE-PRINT,OBJ
	CALL TELL-HERE >STACK
	RSTACK

	.FUNCT PRINT-CONT,OBJ,V?=0,LEVEL=0,Y,1ST?,AV,STR=0,PV?=0,INV?=0
	FIRST? OBJ >Y \TRUE
	LOC WINNER >AV
	ZERO? AV /?L4
	FSET? AV,VEHBIT \?L4
	FSET? AV,FURNITURE \?L7
	FSET? AV,OPENBIT /?L7
?L4:	SET 'AV,0
?L7:	SET '1ST?,1
	LOC OBJ >STACK
	EQUAL? WINNER,OBJ,STACK \?L8
	SET 'INV?,1
	JUMP ?L12
?L8:	ZERO? Y \?L13
?L65:	ZERO? 1ST? \?L15
	PUSH 1
	JUMP ?L12
?L15:	PUSH 0
	JUMP ?L12
?L13:	EQUAL? Y,AV \?L17
	SET 'PV?,1
	JUMP ?L31
?L17:	EQUAL? Y,WINNER /?L31
	FSET? Y,INVISIBLE /?L31
	FSET? Y,TOUCHBIT /?L31
	GETP Y,P?FDESC >STR
	ZERO? STR /?L31
	FSET? Y,NDESCBIT /?L28
	SET '1ST?,0
	SET 'LEVEL,0
	ZERO? STR /?L28
	PRINT STR
	CRLF
	SET 'STR,0
	FSET? Y,PERSON \?L26
	CALL THIS-IS-S-HE,Y
	JUMP ?L28
?L26:	CALL THIS-IS-IT,Y
?L28:	CALL SEE-INSIDE?,Y >STACK
	ZERO? STACK /?L31
	LOC Y >STACK
	GETP STACK,P?DESCFCN >STACK
	ZERO? STACK \?L31
	FIRST? Y >STACK \?L31
	CALL PRINT-CONT,Y,V?,0
?L31:	NEXT? Y >Y /?L13
	JUMP ?L65
?L12:	FIRST? OBJ >Y /?L39
?L64:	ZERO? PV? /?L41
	ZERO? AV /?L41
	FIRST? AV >STACK \?L41
	CALL PRINT-CONT,AV,V?,LEVEL
?L41:	ZERO? 1ST? \FALSE
	RTRUE
?L39:	EQUAL? Y,AV,PLAYER /?L60
	FSET? Y,INVISIBLE /?L60
	ZERO? INV? \?L48
	FSET? Y,TOUCHBIT /?L48
	GETP Y,P?FDESC >STACK
	ZERO? STACK \?L60
?L48:	FSET? Y,NDESCBIT /?L49
	ZERO? 1ST? /?L51
	CALL FIRSTER,OBJ,LEVEL >STACK
	ZERO? STACK /?L55
	LESS? LEVEL,0 \?L55
	SET 'LEVEL,0
?L55:	INC 'LEVEL
	SET '1ST?,0
?L51:	CALL DESCRIBE-OBJECT,Y,V?,LEVEL
	JUMP ?L60
?L49:	FIRST? Y >STACK \?L60
	CALL SEE-INSIDE?,Y >STACK
	ZERO? STACK /?L60
	CALL PRINT-CONT,Y,V?,LEVEL
?L60:	NEXT? Y >Y /?L39
	JUMP ?L64

	.FUNCT PRINT-CONTENTS,OBJ,START=0,NOT-OBJ=0,F,N,1ST?=1
	FIRST? OBJ >F \FALSE
?L3:	NEXT? F >N /?L5
?L5:	FSET? F,INVISIBLE /?L32
	EQUAL? F,NOT-OBJ /?L32
	ZERO? 1ST? /?L8
	ZERO? START /?L10
	PRINT START
?L10:	SET '1ST?,0
	JUMP ?L18
?L8:	PRINTI ", "
	ZERO? N \?L18
	PRINTI "and "
?L18:	FSET? F,PERSON \?L23
	CALL DPRINT,F
	JUMP ?L27
?L23:	CALL PRINTA,F
?L27:	FSET? F,PERSON \?L30
	CALL THIS-IS-S-HE,F
	JUMP ?L32
?L30:	CALL THIS-IS-IT,F
?L32:	SET 'F,N
	ZERO? F \?L3
	ZERO? 1ST? \FALSE
	RTRUE

	.FUNCT ROOM-CHECK
	IN? PRSO,ROOMS \?L1
	EQUAL? PRSO,HERE,GLOBAL-HERE \?L3
	CALL PERFORM,PRSA,GLOBAL-ROOM,PRSI
	RTRUE
?L3:	PRINT YOU-ARENT
	PRINTR "in that place!"
?L1:	EQUAL? PRSO,PSEUDO-OBJECT /FALSE
	CALL META-LOC,PRSO >STACK
	EQUAL? STACK,HERE,GLOBAL-OBJECTS /FALSE
	CALL GLOBAL-IN?,PRSO,HERE >STACK
	ZERO? STACK \FALSE
	CALL NOT-HERE,PRSO >STACK
	RSTACK

	.FUNCT META-LOC,OBJ
	EQUAL? OBJ,PLAYER \?L1
	LOC OBJ >STACK
	FSET? STACK,VEHBIT \?L1
	RETURN HERE
?L1:	ZERO? OBJ /FALSE
	EQUAL? OBJ,GLOBAL-OBJECTS,LOCAL-GLOBALS \?L8
	RETURN OBJ
?L8:	IN? OBJ,ROOMS \?L10
	RETURN OBJ
?L10:	LOC OBJ >OBJ
	JUMP ?L1

	.FUNCT SEE-INSIDE?,OBJ
	FSET? OBJ,INVISIBLE /FALSE
	FSET? OBJ,TRANSBIT /TRUE
	FSET? OBJ,OPENBIT /TRUE
	RFALSE

	.FUNCT WEIGHT,OBJ,CONT,WT=0
	FSET? OBJ,WEARBIT /FALSE
	FIRST? OBJ >CONT \?L7
?L6:	CALL WEIGHT,CONT >STACK
	ADD WT,STACK >WT
	NEXT? CONT >CONT /?L6
?L7:	GETP OBJ,P?SIZE >STACK
	ADD WT,STACK >STACK
	RSTACK

	.FUNCT PRE-ACCUSE
	ZERO? PRSI \?L1
	SET 'PRSI,GLOBAL-MURDER
?L1:	EQUAL? PRSI,GLOBAL-MURDER \?L4
	FSET? CORPSE,INVISIBLE \?L4
	PRINTR "Nothing's dead here but your head!"
?L4:	EQUAL? PRSI,GLOBAL-MURDER,GLOBAL-EMBEZZLEMENT /?L8
	PRINTR "What an accusation!"
?L8:	FSET? PRSO,PERSON /FALSE
	PRINTI "Sure! ""Quick, Sergeant! Arrest that "
	CALL DPRINT,PRSO
	PRINTR "!"""

	.FUNCT V-ACCUSE
	CALL DPRINT,PRSO,1
	PRINTR " shrugs off your accusation."

	.FUNCT V-ANALYZE
	PRINT YOU-SHOULD
	PRINTI "leave these tasks to those who can do them best: the police."
	FSET? WINNER,TOLD /?L5
	PRINTI " Perhaps you should call them if you wish assistance."
?L5:	CRLF
	RTRUE

	.FUNCT V-ANSWER
	PRINTI "No one was waiting for your answer."
	CRLF
	SET 'P-CONT,0
	SET 'QUOTE-FLAG,0
	RTRUE

	.FUNCT V-REPLY
	SET 'P-CONT,0
	SET 'QUOTE-FLAG,0
	FSET? PRSO,DOORBIT \?L1
	PRINTI "No one's knocking at "
	CALL TELL-PRSO >STACK
	RSTACK
?L1:	PRINT TOO-BAD
	CALL THE-PRINT,PRSO
	PRINTR " doesn't care."

	.FUNCT PRE-ARREST
	EQUAL? WINNER,PLAYER \FALSE
	PRINTI "A citizen's arrest, eh? Those only happen in the movies. "
	PRINT HAVE-TO
	PRINTI "convince "
	CALL THE-PRINT,DETECTIVE
	PRINTR " to arrest someone."

	.FUNCT V-ARREST
	RTRUE

	.FUNCT PRE-ASK-ABOUT
	FSET? PRSO,PERSON /?L1
	PRINTI "Talking to "
	CALL PRINTA,PRSO
	PRINTR " again, huh?"
?L1:	EQUAL? PRSO,ME \?L5
	PRINTR "Talking to yourself, again, huh?"
?L5:	IN? PRSO,HERE /?L8
	PRINTI "You shouldn't shout: "
	CALL HE$002fSHE-PRINT,PRSO
	PRINTI "'s not"
	CALL TELL-HERE >STACK
	RSTACK
?L8:	SET 'QCONTEXT,PRSO
	SET 'QCONTEXT-ROOM,HERE
	RFALSE

	.FUNCT INTERVIEW-SELF
	PRINTR "Interviewing yourself again, eh?"

	.FUNCT V-ASK-ABOUT
	EQUAL? PRSO,PLAYER \?L1
	CALL INTERVIEW-SELF >STACK
	RSTACK
?L1:	FSET? PRSO,PERSON /?L3
	PRINTI "I've known odd reporters, but none of them ever tried to talk to "
	CALL PRINTA,PRSO
	PRINTR "!"
?L3:	CALL DPRINT,PRSO,1
	PRINTR " doesn't seem to know about that."

	.FUNCT PRE-ASK-CONTEXT-ABOUT,P,?TMP
	ZERO? QCONTEXT /FALSE
	EQUAL? HERE,QCONTEXT-ROOM \FALSE
	SET '?TMP,HERE
	CALL META-LOC,QCONTEXT >STACK
	EQUAL? ?TMP,STACK \FALSE
	CALL PERFORM,V?ASK-ABOUT,QCONTEXT,PRSO
	RTRUE

	.FUNCT V-ASK-CONTEXT-ABOUT
	CALL TELL-ISNT-ANYONE >STACK
	RSTACK

	.FUNCT TELL-ISNT-ANYONE
	PRINT YOU-ARENT
	PRINTR "talking to anyone."

	.FUNCT V-ASK-FOR
	FSET? PRSO,PERSON \?L1
	EQUAL? PRSO,PLAYER /?L1
	CALL DPRINT,PRSO,1
	IN? PRSO,HERE /?L5
	PRINT ISNT-HERE
	CRLF
	RTRUE
?L5:	IN? PRSI,PRSO \?L9
	PRINTR " refuses, somewhat politely."
?L9:	PRINTR " doesn't have that."
?L1:	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT PRE-ASK-CONTEXT-FOR,P,?TMP
	LOC PRSO >P
	FSET? P,PERSON \?L1
	IN? P,HERE \?L1
	CALL PERFORM,V?ASK-FOR,P,PRSO
	RTRUE
?L1:	ZERO? QCONTEXT /FALSE
	EQUAL? HERE,QCONTEXT-ROOM \FALSE
	SET '?TMP,HERE
	CALL META-LOC,QCONTEXT >STACK
	EQUAL? ?TMP,STACK \FALSE
	CALL PERFORM,V?ASK-FOR,QCONTEXT,PRSO
	RTRUE

	.FUNCT V-ASK-CONTEXT-FOR
	CALL TELL-ISNT-ANYONE >STACK
	RSTACK

	.FUNCT V-ATTACK
	CALL IKILL >STACK
	RSTACK

	.FUNCT V-BRUSH
	PRINTR """Cleanliness is next to Godliness,"" but in this case it seems to be next to Impossible."

	.FUNCT V-CALL-LOSE
	PRINT YOU-MUST
	PRINTR "use a verb."

	.FUNCT V-$0024CALL,PER,MOT=0,HERE?=0
	CALL CHARACTERIZE?,PRSO >PER
	ZERO? PER /?L1
	CALL IN-MOTION?,PER >STACK
	ZERO? STACK /?L3
	SET 'MOT,1
?L3:	CALL META-LOC,PER >STACK
	EQUAL? STACK,HERE /?L9
	SET 'HERE?,0
	JUMP ?L10
?L9:	SET 'HERE?,1
	JUMP ?L8
?L10:	CALL NEARBY?,PER >STACK
	ZERO? STACK /?L6
?L8:	CALL DPRINT,PER,1
	ZERO? FLEEING? /?L13
	EQUAL? PER,MICHAEL,ALICIA \?L13
	CALL IN-MOTION?,PER >STACK
	ZERO? STACK /?L13
	CALL TELL-NO-GRAB >STACK
	RSTACK
?L13:	CALL GRAB-ATTENTION,PER >STACK
	ZERO? STACK /?L15
	ZERO? MOT \?L21
	ZERO? HERE? \?L16
	ZERO? MOT /?L19
?L21:	PRINTI " stops and"
?L19:	PRINTR " turns toward you."
?L16:	PRINT LISTENING
	CRLF
	RTRUE
?L15:	CALL TELL-NO-GRAB >STACK
	RSTACK
?L6:	SET 'P-WON,0
	PRINT YOU-DONT
	PRINTI "see "
	CALL DPRINT,PER
	CALL TELL-HERE >STACK
	RSTACK
?L1:	CALL V-CALL-LOSE >STACK
	RSTACK

	.FUNCT TELL-NO-GRAB
	PRINT IGNORES-YOU
	PRINTR " or doesn't hear you."

	.FUNCT THERE-DOESNT-SEEM
	PRINTI "There doesn't seem to be "
	RTRUE

	.FUNCT PRE-PHONE
	ZERO? PLAYER-HIDING /FALSE
	CALL PLAYER-EMERGES
	RFALSE

	.FUNCT V-PHONE,PER
	CALL GLOBAL-IN?,TELEPHONE,HERE >STACK
	ZERO? STACK \?L1
	CALL THERE-DOESNT-SEEM
	CALL PRINTA,TELEPHONE
	CALL TELL-HERE >STACK
	RSTACK
?L1:	FSET? PRSO,PERSON \?L5
	CALL CHARACTERIZE,PRSO >PER
	ZERO? PER /?L5
	CALL NEARBY?,PER >STACK
	ZERO? STACK /?L5
	CALL PERFORM,V?$0024CALL,PRSO
	RTRUE
?L5:	EQUAL? PRSI,0,TELEPHONE /?L6
	PRINT TOO-BAD
	CALL THE-PRINT,PRSI
	PRINTR " isn't a telephone."
?L6:	EQUAL? PRSO,INTNUM \?L9
	CALL INT,I-HANG-UP >STACK
	PUT STACK,0,0
	ZERO? P-EXCHANGE \?L17
	ZERO? P-NUMBER \?L10
	PRINTR "You dial the operator, who suggests you dial 911."
?L10:	ZERO? P-EXCHANGE \?L17
	EQUAL? P-NUMBER,411 \?L14
	PRINTR "The information operator, in a honeyed voice, suggests you consult your directory if you need a number."
?L14:	ZERO? P-EXCHANGE \?L17
	EQUAL? P-NUMBER,911 \?L17
	CALL PERFORM,V?PHONE,POLICE
	RTRUE
?L17:	EQUAL? P-EXCHANGE,555 \?L18
	EQUAL? P-NUMBER,9009 \?L18
	CALL PERFORM,V?PHONE,COSTUME-SHOP >STACK
	RSTACK
?L18:	CALL PROB,50 >STACK
	ZERO? STACK /?L19
	CALL TELL-NO-ANSWER >STACK
	RSTACK
?L19:	CALL PROB,50 >STACK
	ZERO? STACK /?L20
	PRINTR "The telephone is answered. ""Hello? Hello? Hey, what is this, a crank call?"" The telephone hangs up."
?L20:	PRINTR "You get a busy signal."
?L9:	IN? PRSO,ROOMS \?L26
	CALL TELL-YOU-CANT,STR?54 >STACK
	RSTACK
?L26:	FSET? PRSO,PERSON /?L27
	PRINT TOO-BAD
	CALL THE-PRINT,PRSO
	PRINTR " has no telephone."
?L27:	IN? PRSO,HERE \?L30
	CALL DPRINT,PRSO,1
	PRINTR " is right here!"
?L30:	PRINTI "There's no sense in phoning "
	CALL TELL-PRSO >STACK
	RSTACK

	.FUNCT TELL-ALREADY-ARE
	PRINTR "You already are."

	.FUNCT V-CLIMB-ON
	FSET? PRSO,FURNITURE \?L8
	FSET? PRSO,VEHBIT \?L1
	IN? PLAYER,PRSO \?L3
	CALL TELL-ALREADY-ARE >STACK
	RSTACK
?L3:	MOVE PLAYER,PRSO
	PRINT YOU-ARE
	PRINTI "now sitting on "
	CALL TELL-PRSO >STACK
	RSTACK
?L1:	FSET? PRSO,FURNITURE \?L8
	PRINTR "This isn't the kind of thing to sit on!"
?L8:	CALL TELL-YOU-CANT,STR?55,0
	CALL TELL-PRSO
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?56,STACK >STACK
	RSTACK

	.FUNCT V-CLIMB-UP,DIR,OBJ=0,X
	GETPT HERE,DIR >STACK
	ZERO? STACK /?L1
	CALL DO-WALK,DIR
	RTRUE
?L1:	ZERO? OBJ \?L3
	CALL TELL-YOU-CANT,GO-THAT-WAY >STACK
	RSTACK
?L3:	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT TELL-YOU-CANT,STR,DONE=1
	PRINTI "You can't "
	PRINT STR
	ZERO? DONE /FALSE
	PRINTR "."

	.FUNCT V-CLIMB-DOWN
	FSET? PRSO,FURNITURE \?L1
	FSET? PRSO,VEHBIT \?L1
	CALL V-CLIMB-ON
	RTRUE
?L1:	CALL V-CLIMB-UP,P?DOWN >STACK
	RSTACK

	.FUNCT V-CLIMB-FOO
	CALL V-CLIMB-UP,P?UP,1 >STACK
	RSTACK

	.FUNCT V-CLOSE
	FSET? PRSO,CONTBIT /?L1
	FSET? PRSO,DOORBIT /?L4
	FSET? PRSO,WINDOWBIT /?L1
	CALL TELL-MORE-CLEVER >STACK
	RSTACK
?L1:	FSET? PRSO,DOORBIT /?L4
	FSET? PRSO,WINDOWBIT \?L3
?L4:	FSET? PRSO,OPENBIT \?L5
	FSET? PRSO,RMUNGBIT \?L7
	PRINTR "It won't stay closed. The latch is broken."
?L7:	FCLEAR PRSO,OPENBIT
	PRINTI "Okay, "
	CALL THE-PRINT,PRSO
	PRINTR " is now closed."
?L5:	PRINT ITS-ALREADY
	PRINTR "closed."
?L3:	FSET? PRSO,SURFACEBIT /?L17
	GETP PRSO,P?CAPACITY >STACK
	ZERO? STACK /?L17
	CALL OPEN-CLOSE >STACK
	RSTACK
?L17:	CALL TELL-YOU-CANT,STR?57,0
	CALL TELL-PRSO >STACK
	RSTACK

	.FUNCT TELL-UNLOCK-IT,OBJ
	CALL THIS-IS-IT,OBJ
	PRINT HAVE-TO
	PRINTI "unlock "
	CALL THE-PRINT,OBJ
	PRINTR " first."

	.FUNCT OPEN-CLOSE
	EQUAL? PRSA,V?CLOSE \?L1
	FSET? PRSO,OPENBIT \?L3
	FCLEAR PRSO,OPENBIT
	PRINTR "Closed."
?L3:	PRINT ITS-ALREADY
	PRINTR "closed."
?L1:	FSET? PRSO,OPENBIT \?L11
	PRINT ITS-ALREADY
	PRINTR "open."
?L11:	FSET? PRSO,LOCKED \?L15
	CALL TELL-UNLOCK-IT,PRSO >STACK
	RSTACK
?L15:	FSET? PRSO,RMUNGBIT \?L16
	CALL TELL-YOU-CANT,STR?58 >STACK
	RSTACK
?L16:	FSET PRSO,OPENBIT
	FSET? PRSO,DOORBIT /?L20
	FSET? PRSO,WINDOWBIT /?L20
	IN? WINNER,PRSO \?L18
?L20:	PRINTI "Okay, "
	CALL THE-PRINT,PRSO
	PRINTR " is now open."
?L18:	FIRST? PRSO >STACK \?L24
	FSET? PRSO,TRANSBIT \?L23
?L24:	PRINTR "Opened."
?L23:	PRINTI "You open "
	CALL THE-PRINT,PRSO
	PRINTI " and see "
	CALL PRINT-CONTENTS,PRSO
	PRINTR "."

	.FUNCT PRE-COMPARE
	ZERO? PRSI \?L1
	GET P-PRSO,0 >STACK
	EQUAL? 1,STACK \?L1
	PRINTR "Oops! Try typing ""Compare it to (something)."""
?L1:	GET P-PRSO,0 >STACK
	EQUAL? 2,STACK \FALSE
	PUT P-PRSO,0,1
	GET P-PRSO,2 >STACK
	GET P-PRSO,1 >STACK
	CALL PERFORM,PRSA,STACK,STACK
	RTRUE

	.FUNCT V-COMPARE
	EQUAL? PRSO,PRSI \?L1
	PRINTR "They're the same thing!"
?L1:	PRINTR "They're not a bit alike."

	.FUNCT V-CURSES
	CALL PRINT-ID,STR?59
	ZERO? PRSO /?L1
	FSET? PRSO,PERSON \?L3
	PRINTR "Insults like that won't help you solve the case."
?L3:	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE
?L1:	CALL PICK-ONE,OFFENDED >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT V-MUNG
	FSET? PRSO,DOORBIT \?L1
	ZERO? PRSI \?L1
	FSET? PRSO,OPENBIT \?L3
	PRINTI "You'd fly through the open door if you tried."
	CRLF
	CALL PRINT-ID,STR?60 >STACK
	RSTACK
?L3:	FSET? PRSO,LOCKED \?L7
	PRINTI "Oof! All you get is a sore shoulder."
	CRLF
	CALL PRINT-ID,STR?61 >STACK
	RSTACK
?L7:	PRINTI "Why don't you just open it instead?"
	CRLF
	CALL PRINT-ID,STR?62 >STACK
	RSTACK
?L1:	FSET? PRSO,PERSON /?L13
	CALL PRINT-ID,STR?63
	CALL HACK-HACK,TRYING-DESTROY >STACK
	RSTACK
?L13:	ZERO? PRSI /?L15
	FSET? PRSI,WEAPONBIT /?L14
?L15:	PRINT TRYING-DESTROY
	CALL THE-PRINT,PRSO
	PRINTI " with "
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?64,STACK
	CALL IS-SELF-OR-PART-OF-SELF? >STACK
	CALL PRINT-ID,STR?65,STACK
	CALL IS-ANIMAL? >STACK
	CALL PRINT-ID,STR?66,STACK
	ZERO? PRSO \?L18
	PRINTR "your bare hands is suicidal."
?L18:	CALL PRINTA,PRSI
	PRINTR " is silly."
?L14:	CALL TELL-YOU-CANT,STR?67
	CALL IS-OBJECT-OR-PROPERTY? >STACK
	CALL PRINT-ID,STR?68,STACK >STACK
	RSTACK

	.FUNCT V-DROP
	CALL IDROP >STACK
	ZERO? STACK /FALSE
	PRINTI "Okay, "
	CALL THE-PRINT,PRSO
	PRINTI " is now on the "
	GETP HERE,P?LINE >STACK
	EQUAL? STACK,OUTSIDE-LINE-C \?L5
	PRINTI "ground"
	JUMP ?L9
?L5:	PRINTI "floor"
?L9:	PRINTR "."

	.FUNCT V-DRINK
	CALL V-EAT
	CALL DANGEROUS-DRINK? >STACK
	CALL PRINT-ID,STR?69,STACK >STACK
	RSTACK

	.FUNCT V-EAT,EAT?=0,DRINK?=0
	FSET? PRSO,FOODBIT /?L3
	SET 'EAT?,0
	JUMP ?L1
?L3:	SET 'EAT?,1
	IN? PRSO,WINNER \?L5
	EQUAL? PRSA,V?DRINK \?L7
	GRTR? DRINK-COUNT,2 \?L7
	PRINTI "Seems that you've had too much to drink already!"
	CRLF
	CALL PRINT-ID,STR?70 >STACK
	RSTACK
?L7:	PRINTI "Mmm. That really hit the spot."
	CRLF
	CALL PRINT-ID,STR?71 >STACK
	RSTACK
?L5:	PRINT YOU-DONT-HAVE
	PRINTR "that."
?L1:	FSET? PRSO,DRINKBIT /?L18
	SET 'DRINK?,0
	JUMP ?L17
?L18:	SET 'DRINK?,1
	CALL PERFORM,V?DRINK,PRSO
	RTRUE
?L17:	PRINTI "Weren't the hors d'oeuvres enough for you?"
	CRLF
	CALL DANGEROUS-FOOD? >STACK
	CALL PRINT-ID,STR?72,STACK >STACK
	RSTACK

	.FUNCT V-ENTER
	CALL DO-WALK,P?IN
	RTRUE

	.FUNCT V-THROUGH,RM,DIR,?TMP
	IN? PRSO,ROOMS \?L1
	SET '?TMP,PRSO
	CALL META-LOC,PLAYER >STACK
	EQUAL? ?TMP,STACK \?L3
	CALL TELL-ALREADY-ARE >STACK
	RSTACK
?L3:	CALL DIR-FROM,HERE,PRSO >DIR
	ZERO? DIR /?L5
	CALL DO-WALK,DIR
	RTRUE
?L5:	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK /?L6
	PRINTR "It's dark and confusing out here, you'll have to use directions."
?L6:	CALL PLAYER-GETS-UP
	CALL ESTABLISH-GOAL,PLAYER,PRSO
	CALL V-CONTINUE
	RTRUE
?L1:	FSET? PRSO,DOORBIT \?L10
	FSET? PRSO,LOCKED \?L11
	CALL TELL-LOCKED >STACK
	RSTACK
?L11:	CALL DOOR-ROOM,HERE,PRSO >RM
	ZERO? RM /?L13
	CALL OPEN-DOOR,PRSO
	CALL GOTO,RM >STACK
	RSTACK
?L13:	PRINTI "Sorry, but the """
	CALL DPRINT,PRSO
	PRINTR """ must be somewhere else."
?L10:	FSET? PRSO,VEHBIT \?L17
	PRINT YOU-ARE
	IN? PLAYER,PRSO \?L20
	PRINTI "already"
	JUMP ?L24
?L20:	SET 'PLAYER-HIDING,0
	MOVE PLAYER,PRSO
	PRINTI "now"
?L24:	PRINTI " in "
	CALL TELL-PRSO >STACK
	RSTACK
?L17:	FSET? PRSO,PERSON \?L29
	PRINTR "A revolting idea."
?L29:	FSET? PRSO,TAKEBIT /?L32
	PRINTI "You hit your head against "
	CALL THE-PRINT,PRSO
	PRINTI " as you try it."
	CRLF
	CALL PRINT-ID,STR?73 >STACK
	RSTACK
?L32:	IN? PRSO,WINNER \?L35
	PRINT YOU-MUST
	PRINTR "think you're a contortionist!"
?L35:	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT V-CONTINUE,GT,OL,WHERE,OS,OI,GF,DIR
	GET GOAL-TABLES,PLAYER-C >GT
	GET GT,GOAL-S >STACK
	ZERO? STACK /?L1
	GET GT,GOAL-F >GF
	PRINTI "(On your way to "
	CALL THE-PRINT,GF
	PRINTI ".)"
	CRLF
	SET 'OL,HERE
	GET GT,GOAL-I >OI
	CALL FOLLOW-GOAL,PLAYER
	SET 'WHERE,HERE
	EQUAL? OL,WHERE /TRUE
	CALL DIR-FROM,OL,WHERE >DIR
	MOVE PLAYER,OL
	SET 'HERE,OL
	GET GT,GOAL-S >OS
	CALL DO-WALK,DIR
	PUT GT,GOAL-S,OS
	EQUAL? HERE,OL \?L7
	PUT GT,GOAL-I,OI
?L7:	EQUAL? HERE,GF \TRUE
	PUT GT,GOAL-S,0
	RTRUE
?L1:	PRINTR "I suppose you have a destination in mind, but I'm not sure what it is."

	.FUNCT PRE-EXAMINE,OW
	CALL ROOM-CHECK >STACK
	ZERO? STACK \TRUE
	EQUAL? WINNER,PLAYER /FALSE
	SET 'OW,WINNER
	SET 'WINNER,PLAYER
	CALL PERFORM,V?SHOW,PRSO,OW
	SET 'WINNER,OW
	RTRUE

	.FUNCT V-EXAMINE,T
	IN? PRSO,GLOBAL-OBJECTS /?L3
	CALL META-LOC,PRSO >STACK
	EQUAL? STACK,HERE,LOCAL-GLOBALS /?L1
?L3:	CALL NEARBY?,PRSO >STACK
	ZERO? STACK /?L4
	PRINTR "You ought to get closer, you'd get a better look."
?L4:	CALL NOT-HERE,PRSO
	RTRUE
?L1:	GETP PRSO,P?TEXT >T
	ZERO? T /?L9
	PRINT T
	CRLF
	RTRUE
?L9:	FSET? PRSO,CONTBIT \?L12
	CALL V-LOOK-INSIDE,P?IN >STACK
	RSTACK
?L12:	PRINTI "There's nothing special about "
	CALL TELL-PRSO >STACK
	RSTACK

	.FUNCT GLOBAL-IN?,OBJ1,OBJ2,T
	GETPT OBJ2,P?GLOBAL >T
	ZERO? T /FALSE
	PTSIZE T >STACK
	DEC 'STACK
	CALL ZMEMQB,OBJ1,T,STACK >STACK
	RSTACK

	.FUNCT PRE-FIND,CHR,NUM,?TMP
	FSET? PRSO,PERSON \?L1
	GETP PRSO,P?CHARACTER >CHR
	ZERO? CHR /?L1
	GETP WINNER,P?CHARACTER >STACK
	GET WHERE-TABLES,STACK >STACK
	GET STACK,CHR >NUM
	IN? PRSO,GLOBAL-OBJECTS \?L3
	GET CHARACTER-TABLE,CHR >PRSO
?L3:	EQUAL? CHR,VERONICA-C \?L17
	LOC CORPSE >STACK
	ZERO? STACK \?L17
	EQUAL? WINNER,PLAYER \?L8
	PRINT WHAT-DO-YOU-MEAN
	CRLF
	RTRUE
?L8:	EQUAL? WINNER,MICHAEL \?L14
	ZERO? MICHAEL-SEEN-CORPSE? \?L13
?L14:	EQUAL? WINNER,RICHARD \FALSE
	ZERO? RICHARD-SEEN-CORPSE? /FALSE
?L13:	PRINTI """"
	PRINT WHAT-DO-YOU-MEAN
	PRINTR """"
?L17:	EQUAL? WINNER,PLAYER /?L19
	CALL GRAB-ATTENTION,WINNER >STACK
	ZERO? STACK /TRUE
?L19:	CALL META-LOC,WINNER >?TMP
	CALL META-LOC,PRSO >STACK
	EQUAL? ?TMP,STACK \?L22
	EQUAL? WINNER,PLAYER \?L24
	PRINTR "It sounds as though you need your vision checked."
?L24:	PRINTR """Ahem..."""
?L22:	ZERO? NUM \?L31
	EQUAL? WINNER,PLAYER \?L32
	PRINTI "You haven't seen "
	CALL HIM$002fHER-PRINT,PRSO
	PRINTR " yet."
?L32:	PRINTI """I haven't seen "
	CALL HIM$002fHER-PRINT,PRSO
	PRINTR " tonight."""
?L31:	SUB PRESENT-TIME,NUM >NUM
	EQUAL? WINNER,PLAYER \?L40
	PRINTI "You last saw "
	CALL HIM$002fHER-PRINT,PRSO
	PRINTI " "
	JUMP ?L44
?L40:	PRINTI """I last saw "
	CALL HIM$002fHER-PRINT,PRSO
	PRINTI " "
?L44:	EQUAL? PRSO,VERONICA \?L47
	FSET? WINNER,TOLD \?L47
	PRINTI "alive "
?L47:	GRTR? NUM,120 \?L52
	PRINTI "a few hours"
	JUMP ?L71
?L52:	GRTR? NUM,80 \?L56
	PRINTI "an hour or two"
	JUMP ?L71
?L56:	GRTR? NUM,45 \?L59
	PRINTI "about an hour"
	JUMP ?L71
?L59:	GRTR? NUM,20 \?L62
	PRINTI "about half an hour"
	JUMP ?L71
?L62:	GRTR? NUM,10 \?L65
	PRINTI "about 15 minutes"
	JUMP ?L71
?L65:	GRTR? NUM,5 \?L68
	PRINTI "less than 10 minutes"
	JUMP ?L71
?L68:	PRINTI "just a few minutes"
?L71:	PRINTI " ago."
	EQUAL? WINNER,PLAYER /?L76
	PRINTI " I don't know where "
	CALL HE$002fSHE-PRINT,PRSO
	PRINTI " is now."""
?L76:	CRLF
	RTRUE
?L1:	EQUAL? PRSO,YOU \?L83
	EQUAL? PRSI,INTNUM /?L83
	CALL PERFORM,PRSA,PRSI
	RTRUE
?L83:	EQUAL? PRSO,POLICE /FALSE
	FSET? PRSO,PERSON \?L85
	EQUAL? WINNER,PLAYER /?L86
	PRINTI """"
?L86:	PRINTI "I don't remember where "
	EQUAL? PRSO,ME,PLAYER \?L93
	PRINTI "you are"
	JUMP ?L97
?L93:	CALL THE-PRINT,PRSO
	PRINTI " is"
?L97:	PRINTI "."
	EQUAL? WINNER,PLAYER /?L102
	PRINTI """"
?L102:	CRLF
	RTRUE
?L85:	EQUAL? PLAYER,WINNER \FALSE
	IN? PRSO,ROOMS \?L108
	EQUAL? PRSO,HERE \?L109
	CALL TELL-ALREADY-ARE >STACK
	RSTACK
?L109:	FSET? PRSO,TOUCHBIT \?L111
	PRINT YOU-SHOULD
	PRINTR "remember!"
?L111:	PRINTR "I thought reporters always knew their way around!"
?L108:	CALL META-LOC,PRSO >STACK
	EQUAL? STACK,HERE \FALSE
	EQUAL? PRSO,PULSE /FALSE
	LOC PRSO >STACK
	CALL SEE-INSIDE?,STACK >STACK
	ZERO? STACK \FALSE
	CALL NOT-HERE,PRSO >STACK
	RSTACK

	.FUNCT V-FIND,L
	LOC PRSO >L
	EQUAL? PRSO,PLAYER \?L1
	EQUAL? PLAYER,WINNER /?L3
	PRINTI """"
?L3:	PRINTI "You're right here, "
	FSET? L,SURFACEBIT \?L10
	PRINTI "on"
	JUMP ?L14
?L10:	PRINTI "in"
?L14:	PRINTI " "
	CALL THE-PRINT,L
	PRINTI "."
	EQUAL? PLAYER,WINNER /?L19
	PRINTI """"
?L19:	CRLF
	RTRUE
?L1:	EQUAL? PLAYER,WINNER /?L24
	EQUAL? PRSO,YOU \?L25
	EQUAL? PRSI,INTNUM \?L25
	GRTR? P-NUMBER,PRESENT-TIME \?L27
	PRINTI """I don't understand"
	JUMP ?L42
?L27:	PRINTI """I was "
	GRTR? P-NUMBER,555 /?L36
	GRTR? P-NUMBER,480 \?L34
	EQUAL? WINNER,ALICIA /?L34
?L36:	PRINTI "here at the party"
	JUMP ?L42
?L34:	GRTR? P-NUMBER,540 \?L39
	EQUAL? WINNER,ALICIA \?L39
	PRINTI "on my way here"
	JUMP ?L42
?L39:	PRINTI "at home"
?L42:	PRINTR "."""
?L25:	PRINTR """I thought reporters were resourceful."""
?L24:	EQUAL? L,GLOBAL-OBJECTS \?L50
	PRINTR "You're the reporter, can't you find something as simple as that?"
?L50:	IN? PRSO,WINNER \?L53
	PRINTR "You have it."
?L53:	IN? PRSO,HERE /?L57
	EQUAL? PRSO,PSEUDO-OBJECT /?L57
	CALL GLOBAL-IN?,PRSO,HERE >STACK
	ZERO? STACK /?L56
?L57:	PRINTI "It's right"
	CALL TELL-HERE >STACK
	RSTACK
?L56:	FSET? PRSO,INVISIBLE /?L61
	CALL META-LOC,PRSO >STACK
	EQUAL? STACK,HERE /?L60
?L61:	PRINTR "Well, it's not here, anyway."
?L60:	FSET? L,PERSON \?L64
	CALL DPRINT,L,1
	PRINTR " has it."
?L64:	FSET? L,SURFACEBIT \?L67
	PRINTI "It's on "
	CALL THE-PRINT,L
	PRINTR "."
?L67:	FSET? L,CONTBIT \?L70
	PRINTI "It's in "
	CALL THE-PRINT,L
	PRINTR "."
?L70:	PRINTR "You're certainly no investigative reporter!"

	.FUNCT V-FINGERPRINT
	FSET? PRSO,PERSON /?L3
	EQUAL? PRSO,YOU,ME \?L1
?L3:	EQUAL? WINNER,DETECTIVE,DUFFY \?L4
	PRINTR """Everyone will be fingerprinted in due time."""
?L4:	PRINTI "Leave that to the police."
	CRLF
	CALL PRINT-ID,STR?74 >STACK
	RSTACK
?L1:	CALL PERFORM,V?ANALYZE,PRSO,GLOBAL-FINGERPRINTS
	RTRUE

	.FUNCT V-FOLLOW,CN,CHR,COR,PCOR,L=0,?TMP
	EQUAL? PRSO,PLAYER \?L1
	PRINTR "It's not clear who you're talking to."
?L1:	FSET? PRSO,PERSON /?L5
	PRINTI "How tragic to see a respected news writer stalking "
	CALL PRINTA,PRSO
	PRINTR "!"
?L5:	CALL CHARACTERIZE?,PRSO >CHR
	ZERO? CHR /?L8
	SET '?TMP,HERE
	CALL META-LOC,CHR >L
	EQUAL? ?TMP,L \?L8
	PRINTI "You're in the same place as "
	CALL DPRINT,PRSO
	PRINTR "!"
?L8:	ZERO? L \?L11
	PRINTI "You seem to have lost track of "
	CALL DPRINT,PRSO
	PRINTR "."
?L11:	CALL IN-BALLROOM?,CHR >STACK
	ZERO? STACK /?L14
	CALL IN-BALLROOM?,WINNER >STACK
	ZERO? STACK /?L14
	CALL DIR-FROM,HERE,L >CN
	ZERO? CN /?L15
	CALL DO-WALK,CN >STACK
	RSTACK
?L15:	CALL DIR-FROM,HERE,BALLROOM-5 >CN
	ZERO? CN /?L17
	CALL DO-WALK,CN >STACK
	RSTACK
?L17:	PRINT HAVE-TO
	PRINTR "give a direction."
?L14:	CALL DIR-FROM,HERE,L >CN
	ZERO? CN /?L21
	CALL DO-WALK,CN >STACK
	RSTACK
?L21:	GETP HERE,P?CORRIDOR >COR
	ZERO? COR /?L22
	GETP L,P?CORRIDOR >PCOR
	ZERO? PCOR /?L22
	BAND COR,PCOR >STACK
	ZERO? STACK /?L22
	CALL COR-DIR,HERE,L >PRSO
	CALL DO-WALK,PRSO >STACK
	RSTACK
?L22:	PRINTI "You seem to have lost track of "
	CALL DPRINT,PRSO
	PRINTR "."

	.FUNCT OUTSIDE?,L
	GETP L,P?LINE >STACK
	EQUAL? STACK,OUTSIDE-LINE-C /TRUE
	EQUAL? L,WALKWAY,BACK-PORCH /TRUE
	RFALSE

	.FUNCT PRE-GIVE
	CALL HELD?,PRSO >STACK
	ZERO? STACK \FALSE
	PRINTR "That's easy for you to say, since you don't even have it."

	.FUNCT V-GIVE
	FSET? PRSI,PERSON /?L1
	CALL TELL-YOU-CANT,STR?75,0
	CALL PRINTA,PRSO
	PRINTI " to "
	CALL PRINTA,PRSI
	PRINTR "!"
?L1:	CALL DPRINT,PRSI,1
	PRINTR " refuses your offer."

	.FUNCT PRE-SGIVE
	CALL PERFORM,V?GIVE,PRSI,PRSO
	RTRUE

	.FUNCT V-SGIVE
	RTRUE

	.FUNCT V-GOODBYE
	CALL V-HELLO,0 >STACK
	RSTACK

	.FUNCT V-HANDCUFF
	IN? HANDCUFFS,PLAYER \?L1
	CALL PERFORM,V?TIE-WITH,PRSO,HANDCUFFS
	RTRUE
?L1:	PRINT YOU-DONT-HAVE
	CALL THE-PRINT,HANDCUFFS
	PRINTR "."

	.FUNCT V-HELLO,HELL=1,P
	SET 'P,PRSO
	ZERO? P \?L24
	SET 'P,QCONTEXT
	ZERO? P /?L1
?L24:	IN? P,HERE /?L5
	CALL TELL-ISNT-HERE,P >STACK
	RSTACK
?L5:	FSET? P,PERSON \?L7
	ZERO? HELL /?L8
	CALL DPRINT,P,1
	PRINTR " nods at you."
?L8:	PRINTR """Don't tell me you're leaving already!"""
?L7:	PRINTI "Only nuts say """
	ZERO? HELL /?L18
	PUSH STR?76
	JUMP ?L20
?L18:	PUSH STR?77
?L20:	PRINT STACK
	PRINTI """ to "
	CALL PRINTA,P
	PRINTR "."
?L1:	PRINTR "It's not clear who you're talking to."

	.FUNCT V-HELP
	ZERO? PRSO \?L1
	PRINTR "You'll find help in your manual."
?L1:	CALL TELL-SPECIFIC >STACK
	RSTACK

	.FUNCT TELL-SPECIFIC
	PRINT HAVE-TO
	PRINTR "be more specific."

	.FUNCT PRE-HIDE
	ZERO? PLAYER-HIDING /?L1
	CALL TELL-HIDING >STACK
	RSTACK
?L1:	CALL INHABITED?,HERE >STACK
	ZERO? STACK /FALSE
	CALL TELL-YOU-CANT,STR?78 >STACK
	RSTACK

	.FUNCT V-HIDE
	ZERO? PRSO /?L1
	PRINTI "That's not a"
	JUMP ?L5
?L1:	PRINT HAVE-TO
	PRINTI "suggest a specific"
?L5:	CALL TELL-HIDING-PLACE >STACK
	RSTACK

	.FUNCT TELL-HIDING-PLACE
	PRINTR " hiding place."

	.FUNCT V-HIDE-INSIDE
	ZERO? PLAYER-HIDING /?L1
	CALL TELL-HIDING >STACK
	RSTACK
?L1:	CALL TELL-YOU-CANT,STR?79,0
	CALL TELL-PRSO >STACK
	RSTACK

	.FUNCT TELL-PRSO
	CALL THE-PRINT,PRSO
	PRINTR "."

	.FUNCT V-HIDE-BEHIND
	ZERO? PLAYER-HIDING /?L1
	CALL TELL-HIDING >STACK
	RSTACK
?L1:	CALL TELL-YOU-CANT,STR?80,0
	CALL TELL-PRSO >STACK
	RSTACK

	.FUNCT TELL-HIDING
	PRINTR "You're already hiding. Are you getting scared?"

	.FUNCT V-KICK,?TMP
	FSET? PRSO,PERSON \?L1
	PRINTI "What terrible manners!"
	CRLF
	CALL IS-PERSON? >?TMP
	ZERO? ?TMP /?L6
	PUSH ?TMP
	JUMP ?L5
?L6:	CALL IS-ANIMAL? >STACK
?L5:	CALL PRINT-ID,STR?81,STACK
	CALL IS-SELF? >STACK
	CALL PRINT-ID,STR?82,STACK >STACK
	RSTACK
?L1:	CALL IS-OBJECT-OR-PROPERTY? >STACK
	CALL PRINT-ID,STR?83,STACK
	CALL HACK-HACK,STR?84 >STACK
	RSTACK

	.FUNCT V-CUT
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?85,STACK
	CALL IS-OBJ-PROP-ANIMAL? >STACK
	CALL PRINT-ID,STR?86,STACK
	CALL IS-SELF-OR-PART-OF-SELF? >STACK
	CALL PRINT-ID,STR?87,STACK
	ZERO? PRSI \?L1
	PRINTR "With your cutting wit, I suppose?"
?L1:	CALL META-LOC,PRSO >STACK
	EQUAL? STACK,HERE /?L5
	CALL HELD?,PRSO >STACK
	ZERO? STACK \?L5
	CALL TELL-ISNT-HERE,PRSO >STACK
	RSTACK
?L5:	GETP PRSO,P?CHARACTER >STACK
	ZERO? STACK /?L6
	CALL GONE-CRAZY >STACK
	RSTACK
?L6:	FSET? PRSO,PERSON \?L7
	PRINTI "You think better of it and don't slice "
	CALL TELL-PRSO >STACK
	RSTACK
?L7:	PRINTR "The result is unexciting."

	.FUNCT V-KILL
	CALL IKILL >STACK
	RSTACK

	.FUNCT IKILL
	ZERO? PRSO \?L1
	PRINTR "There's nothing here to kill."
?L1:	ZERO? PRSI \?L5
	FSET? PRSO,WEAPONBIT \?L5
	PRINTR "You didn't say what to kill."
?L5:	FSET? PRSO,DOORBIT \?L8
	FSET PRSO,RMUNGBIT
	PRINTI "Hey, this isn't a TV crime show! You just broke the lock beyond repair."
	CRLF
	CALL PRINT-ID,STR?88 >STACK
	RSTACK
?L8:	FSET? PRSO,PERSON /?L11
	PRINTI "Sure, destroy "
	CALL THE-PRINT,PRSO
	PRINTI ". Your manners are atrocious! I doubt you'll ever be invited back."
	CRLF
	CALL IS-OBJECT-OR-PROPERTY? >STACK
	CALL PRINT-ID,STR?89,STACK >STACK
	RSTACK
?L11:	ZERO? PRSI \?L14
	EQUAL? PRSO,DUFFY,DETECTIVE \?L15
	PRINTI "That was a bad move. These officers are trained to defend themselves. They do. You lose, and quickly."
	CRLF
	CALL PRINT-ID,STR?90
	CALL GONE-CRAZY >STACK
	RSTACK
?L15:	CALL PROB,50 >STACK
	ZERO? STACK /?L19
	CALL TELL-WISE-UP
	CALL PRINT-ID,STR?91 >STACK
	RSTACK
?L19:	PRINTI "With all your ability (which is to say, nearly none), you kill "
	CALL DPRINT,PRSO
	PRINTI " with one lucky blow."
	CRLF
	CALL PRINT-ID,STR?92
	CALL GONE-CRAZY >STACK
	RSTACK
?L14:	EQUAL? PRSO,DUFFY,DETECTIVE \?L23
	PRINTI "You've had better ideas tonight. With practiced ease, "
	CALL DPRINT,PRSO
	PRINTI " wrests "
	CALL THE-PRINT,PRSI
	PRINTI " from your grasp, slaps on the cuffs, and reads you your rights."
	CRLF
	CALL PRINT-ID,STR?93
	CALL GONE-CRAZY >STACK
	RSTACK
?L23:	CALL PROB,50 >STACK
	ZERO? STACK /?L26
	CALL TELL-WISE-UP
	CALL PRINT-ID,STR?94 >STACK
	RSTACK
?L26:	PRINTI "With lethal facility, you use "
	CALL THE-PRINT,PRSI
	PRINTI " on "
	CALL DPRINT,PRSO
	PRINTI ", who dies."
	CRLF
	CALL PRINT-ID,STR?95
	CALL GONE-CRAZY >STACK
	RSTACK

	.FUNCT TELL-WISE-UP
	PRINTR "You think it over and think better of it."

	.FUNCT V-KISS
	FSET? PRSO,PERSON \?L1
	PRINTI "This isn't Hollywood; you can't go around kissing at random."
	CRLF
	CALL PRINT-ID,STR?96 >STACK
	RSTACK
?L1:	PRINTR "What a (ahem!) strange idea!"

	.FUNCT TELL-NO-ANSWER
	PRINTR "There's no answer."

	.FUNCT V-KNOCK
	FSET? PRSO,DOORBIT \?L1
	CALL DOOR-ROOM,HERE,PRSO >STACK
	CALL INHABITED?,STACK >STACK
	ZERO? STACK /?L3
	PRINTR "Someone shouts ""Go away!"""
?L3:	CALL TELL-NO-ANSWER >STACK
	RSTACK
?L1:	FSET? PRSO,WINDOWBIT \?L8
	CALL TELL-NO-ANSWER >STACK
	RSTACK
?L8:	PRINTI "Why knock on "
	CALL PRINTA,PRSO
	PRINTI "?"
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?97,STACK >STACK
	RSTACK

	.FUNCT DOOR-ROOM,HERE?1,OBJ,P=0,L,T,O
?L1:	NEXTP HERE?1,P >P
	ZERO? P /FALSE
	LESS? P,P?OUT /?L1
	GETPT HERE?1,P >T
	PTSIZE T >L
	EQUAL? L,DEXIT \?L1
	GETB T,DEXITOBJ >STACK
	EQUAL? STACK,OBJ \?L1
	GETB T,REXIT >STACK
	RSTACK

	.FUNCT V-STAND,P
	ZERO? PLAYER-HIDING /?L1
	CALL PLAYER-GETS-UP
	RTRUE
?L1:	LOC WINNER >STACK
	FSET? STACK,SURFACEBIT /?L4
	LOC WINNER >STACK
	FSET? STACK,FURNITURE \?L3
?L4:	MOVE WINNER,HERE
	SET 'PLAYER-HIDING,0
	PRINT YOU-ARE
	PRINTR "on your own feet again."
?L3:	CALL TELL-ALREADY-ARE >STACK
	RSTACK

	.FUNCT PRE-LEAVE,?TMP
	EQUAL? PRSO,0,PARTY /FALSE
	FSET? PRSO,PERSON \?L5
	EQUAL? PRSO,CORPSE /?L5
	CALL DO-WALK,P?OUT
	RTRUE
?L5:	SET '?TMP,PRSO
	CALL META-LOC,WINNER >STACK
	EQUAL? ?TMP,STACK,GLOBAL-ROOM \?L6
	CALL DO-WALK,P?OUT
	RTRUE
?L6:	CALL PERFORM,V?DROP,PRSO
	RTRUE

	.FUNCT V-LEAVE
	CALL DO-WALK,P?OUT >STACK
	RSTACK

	.FUNCT V-LISTEN
	ZERO? PRSO /?L3
	EQUAL? PRSO,DISCUSSION \?L1
?L3:	GRTR? ARGUMENT-COUNT,0 \?L4
	EQUAL? HERE,BALLROOM-9 \?L4
	CALL THE-PRINT,DISCUSSION,1
	PRINTR " intensifies."
?L4:	PRINTR "It's pretty one-sided."
?L1:	FSET? PRSO,PERSON \?L11
	EQUAL? PRSO,VERONICA \?L12
	CALL IN-MOTION?,VERONICA >STACK
	ZERO? STACK /?L14
	CALL TELL-YOU-CANT,STR?98 >STACK
	RSTACK
?L14:	PRINTR "She is talking, as usual, about horses."
?L12:	GRTR? ARGUMENT-COUNT,0 \?L19
	EQUAL? HERE,BALLROOM-9 \?L19
	EQUAL? PRSO,MICHAEL,COL-MARSTON,COCHRANE \?L19
	CALL DPRINT,PRSO,1
	PRINTI " is taking part in "
	CALL PRINTA,DISCUSSION
	PRINTR "."
?L19:	PRINTR "This conversation doesn't appear to be going anywhere, does it?"
?L11:	PRINT TOO-BAD
	CALL THE-PRINT,PRSO
	PRINTR " makes no sound."

	.FUNCT TELL-MORE-CLEVER
	PRINTI "You'd have to be more clever to do that to "
	CALL TELL-PRSO >STACK
	RSTACK

	.FUNCT V-LOCK
	FSET? PRSO,CONTBIT /?L1
	FSET? PRSO,DOORBIT /?L4
	CALL TELL-MORE-CLEVER >STACK
	RSTACK
?L1:	FSET? PRSO,DOORBIT /?L4
	GETP PRSO,P?CAPACITY >STACK
	ZERO? STACK /?L3
?L4:	FSET? PRSO,OPENBIT \?L5
	PRINT HAVE-TO
	PRINTR "close it first."
?L5:	FSET? PRSO,LOCKED \?L9
	PRINT ITS-ALREADY
	PRINTR "locked."
?L9:	FSET? PRSO,RMUNGBIT \?L12
	CALL TELL-YOU-CANT,STR?99 >STACK
	RSTACK
?L12:	GETP PRSO,P?UNLOCK >STACK
	EQUAL? STACK,ROOMS \?L13
	PRINTR "This door doesn't have a lock."
?L13:	GETP PRSO,P?UNLOCK >STACK
	EQUAL? STACK,HERE /?L16
	CALL TELL-YOU-CANT,STR?100 >STACK
	RSTACK
?L16:	FSET PRSO,LOCKED
	PRINTI "Okay, "
	CALL THE-PRINT,PRSO
	PRINTR " is now locked."
?L3:	CALL TELL-YOU-CANT,STR?101,0
	CALL TELL-PRSO >STACK
	RSTACK

	.FUNCT V-LOOK
	CALL DESCRIBE-ROOM,1 >STACK
	ZERO? STACK /FALSE
	CALL DESCRIBE-OBJECTS,1 >STACK
	RSTACK

	.FUNCT V-LOOK-BEHIND
	PRINTI "There's nothing behind "
	CALL TELL-PRSO >STACK
	RSTACK

	.FUNCT V-LOOK-DOWN
	EQUAL? PRSO,ROOMS \?L1
	GETP HERE,P?LINE >STACK
	EQUAL? STACK,OUTSIDE-LINE-C \?L3
	PRINTR "There's mud and grass there, mostly."
?L3:	CALL TELL-BORING >STACK
	RSTACK
?L1:	EQUAL? PRSO,HALLWAY \?L8
	CALL CORRIDOR-LOOK >STACK
	ZERO? STACK \FALSE
	PRINTR "There's no one there."
?L8:	CALL TELL-LONG-WEEK >STACK
	RSTACK

	.FUNCT TELL-LONG-WEEK
	PRINTR "It has been a long week, hasn't it?"

	.FUNCT TELL-CLOSED
	PRINT TOO-BAD
	CALL THE-PRINT,PRSO
	PRINTR " is closed."

	.FUNCT PRE-LOOK-INSIDE
	CALL ROOM-CHECK >STACK
	RSTACK

	.FUNCT V-LOOK-INSIDE,DIR,RM
	FSET? PRSO,DOORBIT \?L1
	FSET? PRSO,OPENBIT \?L3
	CALL DOOR-ROOM,HERE,PRSO >RM
	ZERO? RM /?L5
	CALL ROOM-PEEK,RM >STACK
	RSTACK
?L5:	CALL THE-PRINT,PRSO,1
	PRINTR " is open, but you can't tell what's beyond it."
?L3:	CALL TELL-CLOSED >STACK
	RSTACK
?L1:	FSET? PRSO,WINDOWBIT \?L11
	CALL TELL-YOU-CANT,STR?102,0
	CALL TELL-PRSO >STACK
	RSTACK
?L11:	FSET? PRSO,CONTBIT \?L12
	CALL SEE-INSIDE?,PRSO >STACK
	ZERO? STACK /?L13
	FIRST? PRSO >STACK \?L15
	CALL PRINT-CONT,PRSO >STACK
	ZERO? STACK \TRUE
?L15:	FSET? PRSO,SURFACEBIT \?L17
	PRINTI "There's nothing on "
	CALL TELL-PRSO >STACK
	RSTACK
?L17:	CALL THE-PRINT,PRSO,1
	PRINTR " is empty."
?L13:	CALL TELL-CLOSED >STACK
	RSTACK
?L12:	FSET? PRSO,PERSON \?L24
	PRINTR "You forgot to bring your X-ray glasses."
?L24:	CALL TELL-YOU-CANT,STR?103,0
	EQUAL? DIR,P?IN \?L28
	PRINTI "inside "
	CALL TELL-PRSO >STACK
	RSTACK
?L28:	EQUAL? DIR,P?OUT \?L32
	PRINTI "outside "
	CALL TELL-PRSO >STACK
	RSTACK
?L32:	PRINTR "inside that."

	.FUNCT ROOM-PEEK,RM,OHERE?1
	SET 'OHERE?1,HERE
	CALL SEE-INTO?,RM >STACK
	ZERO? STACK /FALSE
	SET 'HERE,RM
	PRINTI "You take a quick peek into "
	CALL THE-PRINT,RM
	PRINTI ":"
	CRLF
	CALL DESCRIBE-OBJECTS,1 >STACK
	ZERO? STACK \?L5
	CALL TELL-BORING
?L5:	SET 'HERE,OHERE?1
	RETURN HERE

	.FUNCT SEE-INTO?,THERE,P,L,T,O
	SET 'P,0
?L1:	NEXTP HERE,P >P
	ZERO? P \?L3
	CALL TELL-CANT-FIND
	RFALSE
?L3:	EQUAL? P,P?IN,P?OUT /?L1
	LESS? P,P?OUT /?L1
	GETPT HERE,P >T
	PTSIZE T >L
	EQUAL? L,UEXIT \?L7
	GETB T,REXIT >STACK
	EQUAL? STACK,THERE /TRUE
?L7:	EQUAL? L,DEXIT \?L9
	GETB T,REXIT >STACK
	EQUAL? STACK,THERE \?L9
	GETB T,DEXITOBJ >STACK
	FSET? STACK,OPENBIT /TRUE
	PRINTI "The door to that room is closed."
	CRLF
	RFALSE
?L9:	EQUAL? L,CEXIT \?L1
	GETB T,REXIT >STACK
	EQUAL? STACK,THERE \?L1
	GETB T,CEXITFLAG >STACK
	VALUE STACK >STACK
	ZERO? STACK \TRUE
	CALL TELL-CANT-FIND
	RFALSE

	.FUNCT TELL-CANT-FIND
	CALL TELL-YOU-CANT,STR?104 >STACK
	RSTACK

	.FUNCT V-LOOK-ON
	FSET? PRSO,SURFACEBIT \?L1
	CALL V-LOOK-INSIDE,P?IN >STACK
	RSTACK
?L1:	PRINTI "There's no good surface on "
	CALL TELL-PRSO >STACK
	RSTACK

	.FUNCT V-LOOK-OUTSIDE
	CALL V-LOOK-INSIDE,P?OUT >STACK
	RSTACK

	.FUNCT V-LOOK-UNDER
	FSET? PRSO,FURNITURE \?L1
	PRINTI "You twist your head to look under "
	CALL THE-PRINT,PRSO
	PRINTR " but find nothing."
?L1:	FSET? PRSO,PERSON \?L5
	PRINTI "Nope. Nothing hiding under "
	CALL DPRINT,PRSO
	PRINTR "."
?L5:	LOC PRSO >STACK
	EQUAL? STACK,HERE,LOCAL-GLOBALS,GLOBAL-OBJECTS \?L8
	PRINTR "There's nothing there but dust."
?L8:	PRINTR "That's not a bit useful."

	.FUNCT V-LOOK-UP
	FSET? PRSO,PERSON \?L1
	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE
?L1:	EQUAL? PRSO,ROOMS /?L5
	CALL TELL-LONG-WEEK >STACK
	RSTACK
?L5:	GETP HERE,P?LINE >STACK
	EQUAL? STACK,OUTSIDE-LINE-C \?L6
	CALL PERFORM,V?EXAMINE,WEATHER
	RTRUE
?L6:	PRINTR "You see the ceiling. It's a nice ceiling. It's smoothly plastered, but if you don't stop looking at it, people will think you're just plastered."

	.FUNCT V-MAKE
	ZERO? PRSI \?L1
	CALL PERFORM,V?MAKE,PLAYER,PRSO >STACK
	RSTACK
?L1:	PRINTR """Eat, drink, and be merry,"" eh?"

	.FUNCT PRE-MOVE
	CALL HELD?,PRSO >STACK
	ZERO? STACK /FALSE
	PRINTR "Juggling isn't one of your talents."

	.FUNCT V-MOVE
	FSET? PRSO,TAKEBIT \?L1
	PRINTI "Moving "
	CALL THE-PRINT,PRSO
	PRINTR " reveals nothing."
?L1:	CALL TELL-YOU-CANT,STR?105,0
	CALL TELL-PRSO >STACK
	RSTACK

	.FUNCT V-OPEN,F,STR
	FSET? PRSO,CONTBIT /?L1
	FSET? PRSO,DOORBIT /?L4
	FSET? PRSO,WINDOWBIT /?L1
	CALL TELL-MORE-CLEVER >STACK
	RSTACK
?L1:	FSET? PRSO,DOORBIT /?L4
	FSET? PRSO,WINDOWBIT /?L4
	GETP PRSO,P?CAPACITY >STACK
	ZERO? STACK /?L3
?L4:	CALL OPEN-CLOSE >STACK
	RSTACK
?L3:	CALL TELL-YOU-CANT,STR?106,0
	CALL TELL-PRSO >STACK
	RSTACK

	.FUNCT V-PICK
	CALL TELL-YOU-CANT,STR?107
	FSET? PRSO,DOORBIT /?L2
	PUSH 0
	JUMP ?L4
?L2:	FSET? PRSO,LOCKED /?L3
	PUSH 0
	JUMP ?L4
?L3:	PUSH 1
?L4:	CALL PRINT-ID,STR?108,STACK >STACK
	RSTACK

	.FUNCT V-PUSH
	CALL HACK-HACK,STR?109 >STACK
	RSTACK

	.FUNCT V-PUT-UNDER
	PRINTR "There's not enough room."

	.FUNCT PRE-PUT
	EQUAL? PRSO,HANDCUFFS \?L1
	CALL PERFORM,V?TIE-WITH,PRSI,HANDCUFFS
	RTRUE
?L1:	FSET? PRSO,TAKEBIT /FALSE
	PRINTR "You can't do that."

	.FUNCT V-PUT,?TMP
	FSET? PRSI,OPENBIT /?L4
	FSET? PRSI,DOORBIT /?L4
	FSET? PRSI,CONTBIT /?L4
	FSET? PRSI,VEHBIT /?L4
	CALL TELL-YOU-CANT,STR?67
	RTRUE
?L4:	FSET? PRSI,PERSON \?L5
	CALL DPRINT,PRSI,1
	PRINTR " won't let you."
?L5:	FSET? PRSI,FURNITURE /?L9
	FSET? PRSI,OPENBIT /?L9
	PRINT TOO-BAD
	CALL THE-PRINT,PRSI
	PRINTR " isn't open."
?L9:	EQUAL? PRSI,PRSO \?L12
	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE
?L12:	IN? PRSO,PRSI \?L15
	PRINT TOO-BAD
	CALL THE-PRINT,PRSO
	PRINTI " is already in "
	CALL THE-PRINT,PRSI
	PRINTR "."
?L15:	CALL WEIGHT,PRSI >?TMP
	CALL WEIGHT,PRSO >STACK
	ADD ?TMP,STACK >?TMP
	GETP PRSI,P?SIZE >STACK
	SUB ?TMP,STACK >?TMP
	GETP PRSI,P?CAPACITY >STACK
	GRTR? ?TMP,STACK \?L18
	PRINTR "There's no room."
?L18:	CALL HELD?,PRSO >STACK
	ZERO? STACK \?L21
	CALL ITAKE >STACK
	ZERO? STACK /TRUE
?L21:	MOVE PRSO,PRSI
	FCLEAR PRSO,WEARBIT
	FSET PRSO,TOUCHBIT
	PRINTR "Okay."

	.FUNCT V-RAISE
	CALL HACK-HACK,STR?110 >STACK
	RSTACK

	.FUNCT V-RAPE
	FSET? PRSO,PERSON \?L1
	CALL PROB,75 >STACK
	ZERO? STACK /?L3
	PRINTI "Section 29A of the United States Criminal Code, whose provisions come to your unhealthy mind, forbids it."
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?111,STACK
	CALL IS-ANIMAL? >STACK
	CALL PRINT-ID,STR?112,STACK >STACK
	RSTACK
?L3:	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?113,STACK
	CALL IS-ANIMAL? >STACK
	CALL PRINT-ID,STR?114,STACK
	CALL GONE-CRAZY >STACK
	RSTACK
?L1:	PRINTR "What a (ahem!) strange idea!"

	.FUNCT PRE-READ,VAL
	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK /?L1
	PRINTR "It's impossible to read in the dark."
?L1:	ZERO? PRSI /?L5
	FSET? PRSI,TRANSBIT /?L5
	EQUAL? PRSI,INTNUM /?L5
	PRINT YOU-MUST
	PRINTI "have a swell method of looking through "
	CALL THE-PRINT,PRSI
	PRINTR "."
?L5:	LOC PRSO >STACK
	EQUAL? STACK,WINNER,ROOMS /FALSE
	IN? PRSO,GLOBAL-OBJECTS /?L10
	LOC PRSO >STACK
	CALL SEE-INSIDE?,STACK >STACK
	ZERO? STACK \FALSE
?L10:	CALL NOT-HERE,PRSO >STACK
	RSTACK

	.FUNCT V-READ
	FSET? PRSO,READBIT /?L1
	CALL TELL-YOU-CANT,STR?115,0
	CALL TELL-PRSO >STACK
	RSTACK
?L1:	IN? PRSO,PLAYER /?L3
	LOC PRSO >STACK
	FSET? STACK,PERSON \?L3
	PRINTI "Trying to read over "
	LOC PRSO >STACK
	CALL DPRINT,STACK
	PRINTR "'s shoulder?"
?L3:	GETP PRSO,P?TEXT >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT V-REVIVE
	FSET? PRSO,PERSON \?L1
	CALL DPRINT,PRSO,1
	PRINTR " doesn't need reviving."
?L1:	CALL HACK-HACK,STR?116 >STACK
	RSTACK

	.FUNCT V-RING
	CALL HACK-HACK,STR?117 >STACK
	RSTACK

	.FUNCT V-RUB
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?118,STACK
	CALL HACK-HACK,STR?119 >STACK
	RSTACK

	.FUNCT V-SAY,V
	SET 'QUOTE-FLAG,0
	SET 'P-CONT,0
	PRINTR "Try instead: Michael, Tell me about Veronica."

	.FUNCT PRE-SEARCH
	CALL ROOM-CHECK >STACK
	RSTACK

	.FUNCT V-SEARCH
	FSET? PRSO,PERSON \?L1
	CALL TELL-REFUSES >STACK
	RSTACK
?L1:	FSET? PRSO,CONTBIT \?L3
	FSET? PRSO,OPENBIT /?L3
	PRINT HAVE-TO
	PRINTR "open it first."
?L3:	PRINTR "You find nothing unusual."

	.FUNCT PRE-SEARCH-OBJECT-FOR,OBJ
	CALL ROOM-CHECK >STACK
	ZERO? STACK \TRUE
	EQUAL? PRSO,GLOBAL-ROOM,GLOBAL-HERE \FALSE
	SET 'PRSO,HERE
	RFALSE

	.FUNCT TELL-REFUSES
	CALL DPRINT,PRSO,1
	PRINTI " refuses to let you search "
	CALL HIM$002fHER-PRINT,PRSO
	PRINTR "."

	.FUNCT V-SEARCH-OBJECT-FOR
	FSET? PRSO,PERSON \?L1
	CALL TELL-REFUSES >STACK
	RSTACK
?L1:	FSET? PRSO,CONTBIT \?L3
	FSET? PRSO,OPENBIT /?L3
	PRINT HAVE-TO
	PRINTI "open "
	CALL THE-PRINT,PRSO
	PRINTR " first."
?L3:	IN? PRSI,PRSO \?L6
	PRINTI "How observant you are! There "
	FSET? PRSI,FEMALE \?L9
	PUSH STR?120
	JUMP ?L12
?L9:	FSET? PRSI,PERSON \?L11
	PUSH STR?121
	JUMP ?L12
?L11:	PUSH STR?122
?L12:	PRINT STACK
	PRINTR " is!"
?L6:	PRINT YOU-DONT
	PRINTI "find "
	CALL THE-PRINT,PRSI
	PRINTR " there."

	.FUNCT PRE-SHOW
	EQUAL? PRSO,PRSI \?L1
	PRINTR "Using a mirror, no doubt?"
?L1:	IN? PRSO,DETECTIVE \?L5
	EQUAL? PRSI,DETECTIVE /?L5
	CALL PERFORM,V?TAKE,PRSO
	RTRUE
?L5:	CALL THIS-IS-S-HE,PRSO
	RFALSE

	.FUNCT V-SHOW
	EQUAL? PRSI,PLAYER \?L1
	PRINTR "Do you often talk to yourself?"
?L1:	FSET? PRSI,PERSON /?L5
	PRINTI "Don't wait for "
	CALL THE-PRINT,PRSI
	PRINTR " to applaud."
?L5:	CALL DPRINT,PRSI,1
	CALL PICK-ONE,WHO-CARES >STACK
	PRINT STACK
	PRINTR "."

	.FUNCT PRE-SSHOW
	SET 'P-MERGED,1
	CALL PERFORM,V?SHOW,PRSI,PRSO
	RTRUE

	.FUNCT V-SSHOW
	RTRUE

	.FUNCT V-SIT,F
	FSET? PRSO,FURNITURE \?L1
	FSET? PRSO,VEHBIT \?L1
	IN? PLAYER,PRSO \?L3
	CALL TELL-ALREADY-ARE >STACK
	RSTACK
?L3:	FIRST? PRSO >F \?L5
	PRINTI "You might crush "
	CALL THE-PRINT,F
	PRINTR "."
?L5:	MOVE PLAYER,PRSO
	SET 'PLAYER-HIDING,0
	PRINT YOU-ARE
	PRINTI "now sitting on "
	CALL TELL-PRSO >STACK
	RSTACK
?L1:	PRINTR "That isn't something to sit on!"

	.FUNCT V-SLAP
	IN? PRSO,HERE /?L1
	PRINTI "What "
	PRINT PRSO
	PRINTR "?"
?L1:	FSET? PRSO,PERSON \?L5
	CALL DPRINT,PRSO,1
	PRINTI " slaps you right back. It hurts, too."
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?123,STACK >STACK
	RSTACK
?L5:	PRINTI "Your hand stings something fierce now!"
	CRLF
	CALL PRINT-ID,STR?124 >STACK
	RSTACK

	.FUNCT V-SMELL
	FSET? PRSO,PERSON \?L1
	FSET? PRSO,FEMALE \?L3
	PRINTI "She"
	JUMP ?L10
?L3:	PRINTI "He"
	JUMP ?L10
?L1:	PRINTI "It"
?L10:	PRINTI " smells just like "
	CALL PRINTA,PRSO
	PRINTR "."

	.FUNCT PRE-TAKE,P
	LOC PRSO >P
	EQUAL? PRSO,PULSE,FAIRY-COSTUME,NOT-ROPE /FALSE
	EQUAL? PRSO,NOTEBOOK,SALE-AGREEMENT,TRUST-DOCUMENTS /FALSE
	IN? PRSO,WINNER \?L4
	PRINTR "You already have it."
?L4:	ZERO? PRSI \?L7
	IN? PRSO,GLOBAL-OBJECTS /?L7
	FSET? P,PERSON \?L7
	EQUAL? P,CORPSE /?L7
	CALL PERFORM,V?TAKE,PRSO,P
	RTRUE
?L7:	FSET? P,CONTBIT \?L8
	FSET? P,OPENBIT /?L8
	FSET? P,PERSON /?L8
	CALL TELL-YOU-CANT,STR?125
	RTRUE
?L8:	ZERO? PRSI /?L9
	CALL META-LOC,PRSI >STACK
	EQUAL? STACK,HERE /?L10
	CALL TELL-ISNT-HERE,PRSI >STACK
	RSTACK
?L10:	EQUAL? PRSI,P /?L12
	CALL THE-PRINT,PRSI,1
	PRINTI " doesn't have "
	CALL TELL-PRSO >STACK
	RSTACK
?L12:	FSET? PRSI,PERSON \?L15
	EQUAL? PRSI,CORPSE,VERONICA /?L15
	PRINTI "Politeness dictates that you ask "
	CALL DPRINT,PRSI
	PRINTI " for it."
	CRLF
	CALL PRINT-ID,STR?126 >STACK
	RSTACK
?L15:	SET 'PRSI,0
	RFALSE
?L9:	LOC WINNER >STACK
	EQUAL? PRSO,STACK \FALSE
	PRINTR "You're in it, nitwit!"

	.FUNCT V-TAKE
	CALL ITAKE >STACK
	EQUAL? STACK,1 \FALSE
	PRINT YOU-ARE
	PRINTI "now carrying "
	CALL PRINT-ID,STR?127
	CALL TELL-PRSO >STACK
	RSTACK

	.FUNCT PRE-TAKEOUT
	PRINT SORRY-I-DONT
	CRLF
	RTRUE

	.FUNCT V-TAKEOUT
	RTRUE

	.FUNCT V-DISEMBARK
	LOC PRSO >STACK
	EQUAL? STACK,WINNER \?L1
	PRINT YOU-DONT
	PRINTI "need to take out "
	CALL THE-PRINT,PRSO
	PRINTR " to use it."
?L1:	LOC WINNER >STACK
	EQUAL? STACK,PRSO /?L5
	PRINT YOU-ARENT
	PRINTI "in that!"
	CRLF
	RETURN 2
?L5:	PRINT YOU-ARE
	PRINTI "on your own feet again."
	CRLF
	MOVE WINNER,HERE
	RTRUE

	.FUNCT V-TELL
	EQUAL? PRSO,PLAYER \?L1
	PRINTI "Talking to yourself is a sign of impending looniness."
	CRLF
	SET 'QUOTE-FLAG,0
	SET 'P-CONT,0
	RETURN 2
?L1:	EQUAL? PRSO,VERONICA \?L7
	CALL IN-MOTION?,VERONICA >STACK
	ZERO? STACK /?L7
	IN? VERONICA,BALLROOM-8 /?L7
	CALL TELL-IGNORES
	SET 'QUOTE-FLAG,0
	SET 'P-CONT,0
	RETURN 2
?L7:	FSET? PRSO,PERSON \?L10
	CALL META-LOC,PRSO >STACK
	EQUAL? STACK,HERE /?L11
	CALL TELL-ISNT-HERE,PRSO
	SET 'P-CONT,0
	SET 'QUOTE-FLAG,0
	RETURN 2
?L11:	ZERO? P-CONT /?L15
	SET 'WINNER,PRSO
	JUMP ?L16
?L15:	CALL DPRINT,PRSO,1
	PRINT LISTENING
	CRLF
?L16:	SET 'QCONTEXT,PRSO
	SET 'QCONTEXT-ROOM,HERE
	RETURN QCONTEXT-ROOM
?L10:	CALL TELL-YOU-CANT,STR?128,0
	CALL TELL-PRSO
	SET 'QUOTE-FLAG,0
	SET 'P-CONT,0
	RETURN 2

	.FUNCT PRE-TELL-ME,P,OW,?TMP
	SET 'OW,WINNER
	ZERO? QCONTEXT /FALSE
	EQUAL? HERE,QCONTEXT-ROOM \FALSE
	SET '?TMP,HERE
	CALL META-LOC,QCONTEXT >STACK
	EQUAL? ?TMP,STACK \FALSE
	EQUAL? PRSO,PLAYER \FALSE
	SET 'WINNER,PLAYER
	CALL PERFORM,V?ASK-ABOUT,QCONTEXT,PRSI
	SET 'WINNER,OW
	RTRUE

	.FUNCT V-TELL-ME
	EQUAL? PLAYER,WINNER /?L1
	EQUAL? PRSO,PLAYER /?L3
	PRINTI """Tell "
	CALL HIM$002fHER-PRINT,PRSO
	PRINTR " yourself."
?L3:	PRINTI """I haven't any thing to say about "
	CALL THE-PRINT,PRSI
	PRINTR "."
?L1:	EQUAL? PRSO,PLAYER \?L10
	CALL TELL-ISNT-ANYONE >STACK
	RSTACK
?L10:	FSET? PRSO,PERSON /?L11
	CALL THE-PRINT,PRSO,1
	PRINTR " is certainly unlikely to spread the story."
?L11:	CALL DPRINT,PRSO,1
	CALL PICK-ONE,WHO-CARES >STACK
	PRINT STACK
	PRINTR "."

	.FUNCT PRE-TELL-ME-ABOUT,P,?TMP
	ZERO? QCONTEXT /FALSE
	EQUAL? HERE,QCONTEXT-ROOM \FALSE
	SET '?TMP,HERE
	CALL META-LOC,QCONTEXT >STACK
	EQUAL? ?TMP,STACK \FALSE
	EQUAL? WINNER,PLAYER \?L3
	PUSH V?TELL-ME
	JUMP ?L5
?L3:	PUSH V?ASK-ABOUT
?L5:	CALL PERFORM,STACK,QCONTEXT,PRSO
	RTRUE

	.FUNCT V-TELL-ME-ABOUT
	CALL TELL-ISNT-ANYONE >STACK
	RSTACK

	.FUNCT V-THANKS,P
	PRINTR "You're more than welcome."

	.FUNCT V-THROW
	CALL IDROP >STACK
	ZERO? STACK /FALSE
	PRINTR "Thrown."

	.FUNCT V-THROW-AT
	CALL IDROP >STACK
	ZERO? STACK /TRUE
	FSET? PRSI,PERSON \?L3
	CALL DPRINT,PRSI,1
	PRINTI ", puzzled by your unusual methods, ducks as "
	CALL THE-PRINT,PRSO
	PRINTI " flies by."
	CRLF
	CALL PRINT-ID,STR?129 >STACK
	RSTACK
?L3:	PRINTR "Maybe you aren't feeling well."

	.FUNCT V-THROW-THROUGH
	FSET? PRSO,PERSON /?L1
	PRINTI "Let's not resort to violence, please."
	CRLF
	CALL PRINT-ID,STR?130 >STACK
	RSTACK
?L1:	CALL V-THROW >STACK
	RSTACK

	.FUNCT PRE-TIE-TO
	FSET? PRSO,PERSON \?L3
	FSET? PRSI,FURNITURE /FALSE
?L3:	PRINTR "That won't do any good."

	.FUNCT V-TIE-TO
	CALL TELL-YOU-CANT,STR?131,0
	CALL DPRINT,PRSO
	PRINTI " to that."
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?132,STACK >STACK
	RSTACK

	.FUNCT PRE-TIE-WITH
	FSET? PRSO,PERSON \?L3
	FSET? PRSI,TOOLBIT /FALSE
?L3:	PRINTR "That won't do any good."

	.FUNCT V-TIE-WITH
	FSET? PRSO,PERSON \?L1
	PRINTI """I'll sue!"""
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?133,STACK >STACK
	RSTACK
?L1:	EQUAL? PRSI,HANDCUFFS \?L6
	PUSH STR?134
	JUMP ?L8
?L6:	PUSH STR?131
?L8:	CALL TELL-YOU-CANT,STACK,0
	CALL DPRINT,PRSO
	PRINTR " with that."

	.FUNCT V-TURN
	PRINTR "This has no effect."

	.FUNCT V-LAMP-ON
	EQUAL? PRSO,SINK,WATER \?L1
	PRINTR "You turn the handle and lo! The water starts to run. Impressed with yourself, you turn the handle once again, and the water stops running! You try it once more, just to make sure. Bravo!"
?L1:	FSET? PRSO,PERSON \?L5
	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CALL PRINT-ID,STR?135 >STACK
	PRINT STACK
	CRLF
	RTRUE
?L5:	CALL TELL-YOU-CANT,STR?136,0
	CALL TELL-PRSO >STACK
	RSTACK

	.FUNCT V-LAMP-OFF
	FSET? PRSO,PERSON \?L1
	PRINTR "Your vulgar ways would turn anyone off."
?L1:	CALL TELL-YOU-CANT,STR?137,0
	CALL TELL-PRSO >STACK
	RSTACK

	.FUNCT PRE-UNLOCK
	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK /FALSE
	FSET? PRSO,DOORBIT \FALSE
	ZERO? PRSI \FALSE
	PRINT YOU-DONT-HAVE
	PRINTR "the right key."

	.FUNCT V-UNLOCK
	ZERO? PRSI /?L1
	CALL TELL-YOU-CANT,STR?138,0
	CALL PRINTA,PRSO
	PRINTI " with "
	CALL PRINTA,PRSI
	PRINTR "."
?L1:	FSET? PRSO,CONTBIT /?L5
	FSET? PRSO,DOORBIT /?L7
	CALL TELL-MORE-CLEVER >STACK
	RSTACK
?L5:	FSET? PRSO,DOORBIT /?L7
	GETP PRSO,P?CAPACITY >STACK
	ZERO? STACK /?L6
?L7:	FSET? PRSO,LOCKED /?L8
	PRINT ITS-ALREADY
	PRINTR "unlocked."
?L8:	FSET? PRSO,OPENBIT \?L12
	PRINT ITS-ALREADY
	PRINTR "open."
?L12:	GETP PRSO,P?UNLOCK >STACK
	EQUAL? STACK,ROOMS \?L15
	PRINTR "This door doesn't have a lock."
?L15:	FSET? PRSO,RMUNGBIT \?L18
	CALL TELL-YOU-CANT,STR?139 >STACK
	RSTACK
?L18:	GETP PRSO,P?UNLOCK >STACK
	ZERO? STACK \?L19
	CALL TELL-YOU-CANT,STR?140,0
	CALL UNLESS-HAVE-KEY >STACK
	RSTACK
?L19:	GETP PRSO,P?UNLOCK >STACK
	EQUAL? STACK,HERE /?L20
	PRINT HAVE-TO
	PRINTI "unlock it from the other side"
	CALL UNLESS-HAVE-KEY >STACK
	RSTACK
?L20:	FCLEAR PRSO,LOCKED
	PRINTI "Okay, "
	CALL THE-PRINT,PRSO
	PRINTR " is now unlocked.[RWD_ID: verbs:2201, VAL: 1]"
?L6:	CALL TELL-YOU-CANT,STR?138,0
	CALL TELL-PRSO >STACK
	RSTACK

	.FUNCT UNLESS-HAVE-KEY
	PRINTR " unless you have the key."

	.FUNCT V-UNTIE
	CALL TELL-YOU-CANT,STR?141 >STACK
	RSTACK

	.FUNCT V-USE
	CALL TELL-SPECIFIC >STACK
	RSTACK

	.FUNCT V-WAIT,NUM=10,WHO=0,INT?1=0,VAL,HR,RESULT=1
	SET 'HR,HERE
	SET 'WHO-WAIT,0
	ZERO? INT?1 \?L1
	PRINTI "Time passes..."
	CRLF
?L1:	DLESS? 'NUM,0 /?L7
	CALL CLOCKER >VAL
	ZERO? VAL /?L10
	EQUAL? VAL,M-FATAL /?L13
	EQUAL? HR,HERE /?L11
?L13:	SET 'RESULT,M-FATAL
	JUMP ?L7
?L11:	ZERO? WHO /?L14
	IN? WHO,HERE \?L14
	CALL DPRINT,WHO,1
	PRINTI ", for whom you are waiting, has arrived."
	CRLF
	JUMP ?L7
?L14:	INC 'WHO-WAIT
	GETB 0,1 >STACK
	BTST STACK,16 \?L18
	PRINTI "("
	CALL TIME-PRINT,PRESENT-TIME
	PRINTI ") "
?L18:	PRINT DO-YOU-WANT-TO
	ZERO? INT?1 /?L27
	PRINTI "continue what you were doing?"
	JUMP ?L31
?L27:	PRINTI "keep waiting?"
?L31:	CALL YES? >STACK
	ZERO? STACK \?L34
	SET 'RESULT,0
	JUMP ?L7
?L34:	USL
	CRLF
	JUMP ?L1
?L10:	ZERO? WHO /?L42
	IN? WHO,HERE \?L39
	CALL DPRINT,WHO,1
	PRINTI ", for whom you are waiting, has arrived."
	CRLF
	JUMP ?L7
?L39:	ZERO? WHO /?L42
	IGRTR? 'WHO-WAIT,40 \?L42
	CALL DPRINT,WHO,1
	PRINTI " still hasn't arrived. "
	PRINT DO-YOU-WANT-TO
	PRINTI "keep waiting?"
	CALL YES? >STACK
	ZERO? STACK \?L45
	SET 'RESULT,0
	JUMP ?L7
?L45:	SET 'WHO-WAIT,0
	USL
	CRLF
	JUMP ?L1
?L42:	USL
	CRLF
	JUMP ?L1
?L7:	SET 'CLOCK-WAIT,1
	ZERO? INT?1 \?L53
	CALL V-TIME
?L53:	RETURN RESULT

	.FUNCT INT-WAIT,N
	MUL N,2 >STACK
	CALL V-WAIT,STACK,0,1 >STACK
	RSTACK

	.FUNCT V-WAIT-FOR,WHO
	EQUAL? PRSO,INTNUM \?L1
	GRTR? P-NUMBER,PRESENT-TIME \?L3
	CALL V-WAIT-UNTIL
	RTRUE
?L3:	GRTR? P-NUMBER,180 \?L5
	PRINTR "That's too long to wait."
?L5:	CALL V-WAIT,P-NUMBER >STACK
	RSTACK
?L1:	EQUAL? PRSO,GLOBAL-HERE \?L9
	CALL V-WAIT
	RTRUE
?L9:	EQUAL? PRSO,MIDNIGHT \?L10
	CALL V-WAIT-UNTIL
	RTRUE
?L10:	FSET? PRSO,PERSON \?L11
	CALL CHARACTERIZE?,PRSO >WHO
	ZERO? WHO /?L12
	IN? WHO,HERE \?L14
	PRINTI "That person's"
	PRINT ALREADY-HERE
	CRLF
	RTRUE
?L14:	CALL V-WAIT,10000,WHO >STACK
	RSTACK
?L12:	PRINTR "You would be better off not waiting."
?L11:	EQUAL? PRSO,PLAYER \?L22
	PRINTI "You're"
	PRINT ALREADY-HERE
	CRLF
	RTRUE
?L22:	PRINTR "Not a good idea. You might wait all night."

	.FUNCT V-WAIT-UNTIL
	EQUAL? PRSO,MIDNIGHT \?L1
	SET 'P-NUMBER,720
	SET 'PRSO,INTNUM
	JUMP ?L4
?L1:	LESS? P-NUMBER,8 \?L3
	ADD P-NUMBER,12 >STACK
	MUL STACK,60 >P-NUMBER
	JUMP ?L4
?L3:	LESS? P-NUMBER,13 \?L4
	MUL P-NUMBER,60 >P-NUMBER
?L4:	EQUAL? PRSO,INTNUM \?L6
	GRTR? P-NUMBER,PRESENT-TIME \?L8
	SUB P-NUMBER,PRESENT-TIME >STACK
	CALL V-WAIT,STACK >STACK
	RSTACK
?L8:	PRINT YOU-ARE
	PRINTR "clearly ahead of your time."
?L6:	PRINTR "It has been a long week, hasn't it?"

	.FUNCT V-ALARM
	FSET? PRSO,PERSON \?L1
	PRINTI "He's wide awake, or haven't you noticed?"
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?142,STACK >STACK
	RSTACK
?L1:	PRINT TOO-BAD
	CALL THE-PRINT,PRSO
	PRINTR " isn't asleep."

	.FUNCT V-WALK,PT,PTS,STR,OBJ,RM
	EQUAL? WINNER,PLAYER \?L1
	GET GOAL-TABLES,PLAYER-C >STACK
	PUT STACK,GOAL-S,0
?L1:	ZERO? PRSO \?L4
	CALL TELL-YOU-CANT,GO-THAT-WAY >STACK
	RSTACK
?L4:	GETPT HERE,PRSO >PT
	ZERO? PT /?L6
	SET 'P-WALK-DIR,PRSO
	PTSIZE PT >PTS
	EQUAL? PTS,UEXIT \?L7
	GETB PT,REXIT >RM
	CALL GOTO,RM >STACK
	RSTACK
?L7:	EQUAL? PTS,NEXIT \?L9
	GET PT,NEXITSTR >STACK
	PRINT STACK
	CRLF
	RETURN 2
?L9:	EQUAL? PTS,FEXIT \?L14
	GET PT,FEXITFCN >STACK
	CALL STACK >RM
	ZERO? RM /?L15
	CALL GOTO,RM >STACK
	RSTACK
?L15:	RETURN 2
?L14:	EQUAL? PTS,CEXIT \?L20
	GETB PT,CEXITFLAG >STACK
	VALUE STACK >STACK
	ZERO? STACK /?L21
	GETB PT,REXIT >STACK
	CALL GOTO,STACK >STACK
	RSTACK
?L21:	GET PT,CEXITSTR >STR
	ZERO? STR /?L23
	PRINT STR
	CRLF
	RETURN 2
?L23:	CALL TELL-YOU-CANT,GO-THAT-WAY
	RETURN 2
?L20:	EQUAL? PTS,DEXIT \FALSE
	GETB PT,DEXITOBJ >OBJ
	FSET? OBJ,OPENBIT \?L32
	GETB PT,REXIT >STACK
	CALL GOTO,STACK >STACK
	RSTACK
?L32:	FSET? OBJ,LOCKED /?L34
	CALL OPEN-DOOR,OBJ
	GETB PT,REXIT >STACK
	CALL GOTO,STACK >STACK
	RSTACK
?L34:	GETP OBJ,P?UNLOCK >STACK
	EQUAL? STACK,HERE \?L35
	CALL TELL-UNLOCK-IT,OBJ >STACK
	RSTACK
?L35:	FSET? OBJ,INVISIBLE \?L36
	CALL TELL-YOU-CANT,GO-THAT-WAY >STACK
	RSTACK
?L36:	GET PT,DEXITSTR >STR
	ZERO? STR /?L37
	PRINT STR
	CRLF
	RETURN 2
?L37:	PRINT TOO-BAD
	CALL THE-PRINT,OBJ
	PRINTI " is locked."
	CRLF
	CALL THIS-IS-IT,OBJ
	RETURN 2
?L6:	EQUAL? PRSO,P?IN \?L48
	PRINTI "What compass direction do you want to go in?"
	CRLF
	RETURN 2
?L48:	CALL TELL-YOU-CANT,GO-THAT-WAY
	RETURN 2

	.FUNCT PLAYER-EMERGES
	PRINTI "You emerge from the concealment of "
	CALL THE-PRINT,PLAYER-HIDING
	PRINTI "."
	CRLF
	SET 'PLAYER-HIDING,0
	RETURN PLAYER-HIDING

	.FUNCT PLAYER-GETS-UP
	ZERO? PLAYER-HIDING /?L1
	CALL PLAYER-EMERGES
	MOVE PLAYER,HERE
	RTRUE
?L1:	LOC PLAYER >STACK
	FSET? STACK,VEHBIT \FALSE
	PRINTI "You get out of "
	LOC PLAYER >STACK
	CALL THE-PRINT,STACK
	PRINTI "."
	CRLF
	MOVE PLAYER,HERE
	RTRUE

	.FUNCT OPEN-DOOR,OBJ
	CALL PLAYER-GETS-UP
	FSET OBJ,OPENBIT
	EQUAL? WINNER,PLAYER \?L1
	PRINTI "You open"
	JUMP ?L5
?L1:	FCLEAR OBJ,LOCKED
	CALL DPRINT,WINNER,1
	PRINTI " opens"
?L5:	PRINTI " "
	CALL THE-PRINT,OBJ
	PRINTR "."

	.FUNCT DO-WALK,DIR
	SET 'P-WALK-DIR,DIR
	CALL PERFORM,V?WALK,DIR >STACK
	RSTACK

	.FUNCT IRON-GRIP
	PRINTD DUFFY
	PRINTR " holds you in a grip of iron. You cannot escape!"

	.FUNCT V-WALK-TO,WHO,RM
	ZERO? DUFFY-SNARFED /?L1
	CALL IRON-GRIP
	RTRUE
?L1:	FSET? PRSO,DOORBIT \?L3
	GETP PRSO,P?UNLOCK >RM
	EQUAL? RM,0,ROOMS /?L3
	SET 'PRSO,RM
	CALL V-THROUGH >STACK
	RSTACK
?L3:	CALL META-LOC,PRSO >STACK
	EQUAL? STACK,HERE /?L5
	CALL GLOBAL-IN?,PRSO,HERE >STACK
	ZERO? STACK /?L4
?L5:	CALL TELL-CLOSE-ENOUGH >STACK
	RSTACK
?L4:	IN? PRSO,GLOBAL-OBJECTS \?L6
	FSET? PRSO,PERSON \?L6
	CALL CHARACTERIZE,PRSO >WHO
	CALL NEARBY?,WHO >STACK
	ZERO? STACK /?L7
	CALL META-LOC,WHO >PRSO
	CALL V-THROUGH >STACK
	RSTACK
?L7:	CALL TELL-YOU-CANT,STR?143,0
	CALL DPRINT,PRSO
	PRINTR "!"
?L6:	EQUAL? PRSO,HALLWAY \?L12
	SET 'PRSO,HALL
	CALL V-THROUGH >STACK
	RSTACK
?L12:	CALL META-LOC,PRSO >STACK
	IN? STACK,ROOMS \?L13
	CALL META-LOC,PRSO >PRSO
	CALL V-THROUGH >STACK
	RSTACK
?L13:	CALL TELL-YOU-CANT,STR?144 >STACK
	RSTACK

	.FUNCT V-RUN-OVER
	PRINTR "That doesn't make much sense."

	.FUNCT V-WHAT,OW,OBJ
	SET 'OW,WINNER
	EQUAL? WINNER,PLAYER /?L1
	EQUAL? PRSO,YOU \?L3
	SET 'OBJ,WINNER
	JUMP ?L5
?L3:	SET 'OBJ,PRSO
?L5:	SET 'WINNER,PLAYER
	CALL PERFORM,V?ASK-ABOUT,OW,OBJ
	SET 'WINNER,OW
	RTRUE
?L1:	FSET? PRSO,PERSON \?L6
	PRINTR "Try asking that person."
?L6:	PRINTR "Are you talking to yourself again?"

	.FUNCT V-YN,?TMP
	ZERO? QCONTEXT /?L1
	EQUAL? HERE,QCONTEXT-ROOM \?L1
	SET '?TMP,HERE
	CALL META-LOC,QCONTEXT >STACK
	EQUAL? ?TMP,STACK \?L1
	CALL DPRINT,QCONTEXT,1
	PRINT IGNORES-YOU
	PRINTR " completely."
?L1:	PRINTR "That deserves to be ignored."

	.FUNCT V-UNMASK
	ZERO? PRSO \?L1
	CALL PERFORM,V?TAKE,MASK
	RTRUE
?L1:	FSET? PRSO,PERSON \?L3
	CALL DPRINT,PRSO,1
	PRINTR " isn't wearing a mask! (Well, that's what they always say in horror movies)."
?L3:	PRINTR "You have an odd idea of what constitutes a costume."

	.FUNCT V-HANG-UP
	EQUAL? PRSO,ALICIA-COAT,YOUR-COAT,GUNBELT \?L1
	EQUAL? HERE,EAST-COAT-CLOSET,WEST-COAT-CLOSET \?L3
	IN? PRSO,HERE \?L5
	PRINTR "It already is."
?L5:	MOVE PRSO,HERE
	PRINTR "Hung."
?L3:	PRINTR "This isn't a closet."
?L1:	PRINTR "It's not a picture, and it's not a telephone, so how can you?"

	.FUNCT V-SCORE
	PRINTR "It's not so much a question of your score, but of whether or not you get the story."

	.FUNCT V-DANCE,OW
	EQUAL? WINNER,PLAYER /?L1
	EQUAL? PRSO,0,ME,PLAYER \?L1
	SET 'OW,WINNER
	SET 'WINNER,PLAYER
	CALL PERFORM,V?DANCE,OW
	SET 'WINNER,OW
	RTRUE
?L1:	CALL IN-BALLROOM?,WINNER >STACK
	ZERO? STACK \?L3
	PRINT YOU-ARENT
	PRINTR "even in the Ballroom."
?L3:	ZERO? PRSO \?L6
	PRINTR "You dance by yourself for a while."
?L6:	FSET? PRSO,PERSON \?L9
	CALL IN-MOTION?,PERSON >STACK
	ZERO? STACK /?L10
	CALL DPRINT,PRSO,1
	PRINTR " seems to be too busy to dance right now."
?L10:	ZERO? DANCE-WITH-FEMALE? \?L29
	ZERO? DANCE-WITH-MALE? /?L15
	ZERO? DANCE-WITH-FEMALE? /?L17
?L29:	FSET? PRSO,FEMALE /?L30
?L17:	ZERO? DANCE-WITH-MALE? /?L14
	FSET? PRSO,FEMALE /?L14
?L15:	FSET? PRSO,FEMALE \?L18
?L30:	SET 'DANCE-WITH-FEMALE?,1
	JUMP ?L20
?L18:	SET 'DANCE-WITH-MALE?,1
?L20:	PRINTI "You and "
	CALL DPRINT,PRSO
	PRINTI " dance for a while."
	CRLF
	CALL PRINT-ID,STR?145 >STACK
	RSTACK
?L14:	CALL DPRINT,PRSO,1
	PRINTR " doesn't want to dance with you."
?L9:	PRINTI "Dancing with "
	CALL PRINTA,PRSO
	PRINTR ", eh? Some see that as a sign of impending mental collapse."

	.FUNCT V-WAVE
	EQUAL? HERE,BALLROOM-9 \?L1
	IN? VERONICA,BALLROOM-8 \?L1
	EQUAL? PRSO,0,GLOBAL-MICHAEL,GLOBAL-VERONICA \?L1
	CALL THIS-IS-S-HE,MICHAEL
	PRINTD MICHAEL
	PRINTR " waves you over again."
?L1:	ZERO? PRSO \?L5
	PRINTR "Calling a taxi, eh?"
?L5:	FSET? PRSO,PERSON \?L8
	CALL NEARBY?,PRSO >STACK
	ZERO? STACK \?L9
	CALL TELL-ISNT-HERE,PRSO >STACK
	RSTACK
?L9:	CALL PROB,50 >STACK
	ZERO? STACK /?L11
	CALL DPRINT,PRSO,1
	PRINTR " waves back, puzzled."
?L11:	CALL DPRINT,PRSO,1
	PRINTR " doesn't seem overly interested."
?L8:	PRINTI "Waving at "
	CALL PRINTA,PRSO
	PRINTR " again, eh?"

	.FUNCT NEARBY?,PER
	IN? PER,HERE /TRUE
	CALL IN-BALLROOM?,PER >STACK
	ZERO? STACK /?L3
	CALL IN-BALLROOM?,PLAYER >STACK
	ZERO? STACK \TRUE
?L3:	CALL CORRIDOR-LOOK,PER >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT V-WHAT-IS-WAS
	CALL TELL-DONT-KNOW
	CRLF
	RTRUE

	.FUNCT V-DIAGNOSE
	ZERO? DRINK-COUNT \?L1
	PRINT YOU-ARE
	PRINTI "healthy and sober."
	JUMP ?L8
?L1:	EQUAL? DRINK-COUNT,1 \?L5
	PRINTI "You've had one drink. The effect has been minimal."
	JUMP ?L8
?L5:	PRINTI "You've had "
	GRTR? DRINK-COUNT,3 \?L11
	PUSH 4
	JUMP ?L13
?L11:	PUSH DRINK-COUNT
?L13:	GET NUMBERS,STACK >STACK
	PRINT STACK
	PRINTI " drinks. I would think twice about driving home if I were you. You might call a taxi instead."
?L8:	FSET? DOG,RMUNGBIT \?L14
	PRINTI " You've been bitten by a dog, but I think he had a rabies tag, so you're safe."
?L14:	CRLF
	RTRUE

	.FUNCT V-REVEAL
	FSET? PRSI,PERSON \?L1
	PRINTI "Your revelation of "
	CALL DPRINT,PRSO
	PRINTI " does not seem to interest "
	CALL DPRINT,PRSI
	PRINTR "."
?L1:	PRINT YOU-MUST
	PRINTI "be pretty anxious to talk about it, if you're telling "
	CALL THE-PRINT,PRSI
	PRINTR "."

	.FUNCT V-$0024REVEAL
	RTRUE

	.FUNCT V-$0024DISCOVER
	IN? CORPSE,PLAYER \?L1
	SET 'PLAYER-SEEN-WITH-BODY?,1
?L1:	EQUAL? PRSI,PLAYER,VERONICA /TRUE
	FSET? PRSI,TOLD /?L6
	CALL REVEAL-MURDER,PRSI
	IN? PRSI,HERE \TRUE
	CALL DPRINT,PRSI,1
	PRINTI " sees the body and recoils in horror. ""That's "
	PRINTD VERONICA
	PRINTI "!"" "
	CALL HE$002fSHE-PRINT,PRSI
	PRINTR " exclaims in shock and surprise."
?L6:	IN? PRSI,HERE \FALSE
	EQUAL? PRSI,DETECTIVE,DUFFY /FALSE
	CALL DPRINT,PRSI,1
	PRINTR " stares, horrified, at the body."

	.FUNCT V-ORDER
	IN? BARTENDER,HERE \?L1
	CALL PERFORM,V?ASK-FOR,BARTENDER,PRSO
	RTRUE
?L1:	PRINT THERE-IS
	PRINTI "no one here to give you "
	CALL PRINTA,PRSO
	PRINTR "."

	.FUNCT V-POUR-ON
	FSET? PRSO,DRINKBIT \?L1
	FSET? PRSI,PERSON \?L3
	CALL THE-PRINT,PRSI,1
	PRINTI " gets away from you and "
	CALL THE-PRINT,PRSO
	PRINTR " pours on the ground."
?L3:	CALL THE-PRINT,PRSI,1
	PRINTI " is now wet with some of "
	CALL TELL-PRSO >STACK
	RSTACK
?L1:	CALL PERFORM,V?DROP,PRSO
	RTRUE

	.FUNCT PRE-WEAR
	EQUAL? PRSO,GUNBELT,YOUR-COAT,MASK /FALSE
	EQUAL? PRSO,ALICIA-COAT,FAIRY-MASK \?L3
	CALL IT-DOESNT-FIT >STACK
	RSTACK
?L3:	CALL TELL-YOU-CANT,STR?146 >STACK
	RSTACK

	.FUNCT IT-DOESNT-FIT
	PRINTR "It doesn't fit."

	.FUNCT V-WEAR
	FSET? PRSO,WEARBIT \?L1
	PRINTI "You already are wearing the "
	CALL DPRINT,PRSO
	PRINTR "."
?L1:	FSET PRSO,WEARBIT
	PRINTR "Okay."

	.FUNCT V-TAKE-OFF
	FSET? PRSO,WEARBIT \?L1
	FCLEAR PRSO,WEARBIT
	PRINTI "Okay, you're no longer wearing the "
	CALL DPRINT,PRSO
	PRINTR "."
?L1:	CALL META-LOC,PRSO >STACK
	EQUAL? STACK,PLAYER \?L5
	PRINT YOU-ARENT
	PRINTR "wearing that."
?L5:	CALL PERFORM,V?TAKE,PRSO
	RTRUE

	.FUNCT V-COUNT
	PRINTR "I don't think it's important, and as I recall, you failed ""Math for Journalists."" Certainly your expense accounts reveal little mathematical ability (but a lot of creativity)."

	.FUNCT V-FLUSH
	CALL TELL-YOU-CANT,STR?147 >STACK
	RSTACK

	.FUNCT V-TIP
	PRINTR "How gauche."

	.FUNCT V-WRITE
	PRINTI "Trying to deface "
	CALL THE-PRINT,PRSO
	PRINTR ", huh?"

	.FUNCT V-LEAP
	PRINTR "Jumping for joy, eh?"

	.FUNCT V-BURN
	ZERO? PRSI \?L1
	EQUAL? HERE,BALLROOM-8 \?L3
	CALL PERFORM,V?PUT,PRSO,FIREPLACE
	RTRUE
?L3:	PRINT THERE-IS
	PRINTI "no fire"
	CALL TELL-HERE
	RTRUE
?L1:	FSET? PRSO,BURNBIT /FALSE
	PRINTI "That won't burn."
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?148,STACK
	CALL IS-OBJ-PROP-ANIMAL? >STACK
	CALL PRINT-ID,STR?149,STACK
	CALL IS-SELF-OR-PART-OF-SELF? >STACK
	CALL PRINT-ID,STR?150,STACK >STACK
	RSTACK

	.FUNCT V-IS
	PRINTR "Oh?"

	.FUNCT V-INTERVIEW
	CALL PERFORM,V?ASK-ABOUT,PRSO,PRSO
	RTRUE

	.FUNCT INTRO
	PRINTI "
It's Halloween night. "
	PRINTD VERONICA
	PRINTI " Ashcroft and her mania for Halloween parties are putting new twists on a 110-year-old tradition. It isn't a very nice night for a party. The rain has been pelting down since early morning, but the weather hasn't deterred many guests. The ballroom at Ashcroft Farm is filled with oddly costumed visitors. The rather ridiculous "
	PRINTD COWBOY-COSTUME
	PRINTR " you are wearing was the only thing you could find at the costumer's on such short notice, but it's out of place only for its relative sobriety and taste in this crowd.
"

	.FUNCT QUEUE-MAIN-EVENTS
	SUB 550,PRESENT-TIME >STACK
	CALL QUEUE,I-RAIN-SLOWS,STACK >STACK
	PUT STACK,0,1
	SUB 570,PRESENT-TIME >STACK
	CALL QUEUE,I-RAIN-POURS,STACK >STACK
	PUT STACK,0,1
	SUB 630,PRESENT-TIME >STACK
	CALL QUEUE,I-RAIN-STOPS,STACK >STACK
	PUT STACK,0,1
	SUB 750,PRESENT-TIME >STACK
	CALL QUEUE,I-PARTY-OVER,STACK >STACK
	PUT STACK,0,1
	CALL QUEUE,I-MUSIC,9 >STACK
	PUT STACK,0,1
	SET 'BAND-PLAYING?,STR?151
	CALL QUEUE,I-WAVE-2,1 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-SPILL,2 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-GAME-OVER,720 >STACK
	PUT STACK,0,1
	RTRUE

	.FUNCT I-WAVE
	CRLF
	CALL THIS-IS-S-HE,MICHAEL
	PRINTI "A sheik, whom you can recognize as "
	PRINTD MICHAEL
	PRINTI " Wellman, and a fairy queen, presumably "
	PRINTD VERONICA
	PRINTR " Ashcroft under her ornate mask, are discussing something with a small group of guests near the fireplace. The sheik notices you and waves for you to join them."

	.FUNCT I-WAVE-2
	EQUAL? HERE,BALLROOM-8 /FALSE
	CALL THIS-IS-S-HE,MICHAEL
	CRLF
	PRINTR "The sheik, seeing your reluctance to join them, shrugs his shoulders and rejoins the conversation, a proprietary hand on the fairy's shoulder."

	.FUNCT I-SPILL
	SET 'SLAPSTICK?,0
	CALL ESTABLISH-GOAL,VERONICA,OFFICE
	MOVE GLASS,BALLROOM-8
	EQUAL? HERE,BALLROOM-8 \?L1
	CALL THIS-IS-S-HE,VERONICA
	CRLF
	PRINTD VERONICA
	PRINTI " is discussing an upcoming horse show. One of her horses, named ""Lurking Grue,"" will appear, and she describes its attributes in glowing detail, muffled only by the ornate mask covering her face and slurred by the effects of whatever liquid it is she has in a large glass. Emphasizing a point, she waves the glass on high, but it's affected her coordination as well as her speech. A bright red liquid punctuated with ice cubes pours out of the glass and all over her dress. As might be expected, the gown is white. She utters a word that silver-winged fairies aren't usually expected to know, and throws the glass to the floor. "
	PRINTD MICHAEL
	PRINTI " reaches under his robes and takes out a handkerchief, dabbing futilely at the stain. "
	PRINTD VERONICA
	PRINTR " snorts in exasperation and pushes him away. ""I'm going to go clean this up. You just stay here."""
?L1:	CALL IN-BALLROOM?,PLAYER >STACK
	ZERO? STACK /FALSE
	CALL THIS-IS-S-HE,VERONICA
	CRLF
	PRINTR "Off near the fireplace, the sheik and the fairy queen are conversing with a small group. The fairy is emphasizing some point when suddenly, she manages to spill her drink on her gown. Her reaction is audible even where you are standing, and she stalks off."

	.FUNCT IN-BALLROOM?,P
	GETP P,P?LINE >STACK
	EQUAL? STACK,BALLROOM-LINE-C /TRUE
	LOC P >STACK
	ZERO? STACK /FALSE
	LOC P >STACK
	GETP STACK,P?LINE >STACK
	EQUAL? STACK,BALLROOM-LINE-C /TRUE
	RFALSE

	.FUNCT TELL-MICHAELS-ALIBI
	PRINTI " "
	PRINTD MICHAEL
	PRINTI " has a perfect alibi, as he was in the Ballroom from the time "
	PRINTD VERONICA
	PRINTI " left to when the body was discovered."
	RTRUE

	.FUNCT ARREST,PER,HELPER=0,FLG,CORRECT?
	ZERO? HELPER /?L61
	EQUAL? PER,VERONICA,DETECTIVE,DUFFY /?L5
	EQUAL? HELPER,VERONICA,DETECTIVE,DUFFY \?L3
?L5:	PRINTR """Working on your insanity defense, eh?"""
?L3:	EQUAL? HELPER,ALICIA \?L10
	EQUAL? PER,MICHAEL /?L9
?L10:	EQUAL? PER,ALICIA \?L8
	EQUAL? HELPER,MICHAEL \?L8
?L9:	SET 'PER,MICHAEL
	SET 'HELPER,ALICIA
	LESS? DETECTIVE-SEEN,DETECTIVE-CONVINCED \?L57
	PRINTI """I don't think there's enough evidence to obtain a conviction."
	ZERO? DETECTIVE-SEEN-LIST? \?L15
	PRINTI " What's Michael's motive?"
?L15:	ZERO? DETECTIVE-SEEN-COAT? \?L145
	ZERO? DETECTIVE-TOLD-ABOUT-RAIN? \?L20
	PRINTI " She wasn't even here until after the murder."
	JUMP ?L24
?L20:	ZERO? DETECTIVE-SEEN-COAT? /?L25
?L145:	ZERO? DETECTIVE-TOLD-ABOUT-RAIN? \?L24
?L25:	PRINTI " If only the evidence was more conclusive that "
	PRINTD ALICIA
	PRINTI " was already here at the time of the murder."
?L24:	ZERO? GLASS-ANALYZED-FOR-PRINTS? \?L33
	PRINTI " What part do you think "
	PRINTD ALICIA
	PRINTI " played?"
	ZERO? DETECTIVE-SEEN-HAIR? \?L33
	ZERO? DETECTIVE-TOLD-ABOUT-RAIN? \?L33
	ZERO? DETECTIVE-SEEN-COAT? \?L33
	PRINTI " She seems guiltless."
?L33:	ADD DETECTIVE-SEEN,2 >STACK
	EQUAL? STACK,DETECTIVE-CONVINCED \?L39
	PRINTI " But I think we're very close."
?L39:	PRINTI """"
	CRLF
	JUMP ?L57
?L8:	ZERO? DETECTIVE-SEEN-LIST? /?L47
	EQUAL? PER,MICHAEL /?L48
	EQUAL? HELPER,COL-MARSTON \?L47
?L48:	EQUAL? HELPER,MICHAEL /?L49
	EQUAL? PER,COL-MARSTON \?L47
?L49:	PRINTI """That's a plausible idea. Unfortunately, it doesn't tell us how the murder was committed."
	ZERO? GLASS-ANALYZED-FOR-PRINTS? \?L52
	CALL TELL-MICHAELS-ALIBI
?L52:	PRINTR " Motive doesn't equal guilt."""
?L47:	CALL THE-PRINT,DETECTIVE,1
	PRINTR " ruminates a moment. ""It only casts suspicion back on you to suggest such a thing."""
?L57:	ZERO? HELPER \?L133
?L61:	EQUAL? PER,DUFFY,DETECTIVE \?L63
	PRINTR """You think you're some sort of comedian, eh?"""
?L63:	EQUAL? PER,MICHAEL \?L66
	ZERO? GLASS-ANALYZED-FOR-PRINTS? \?L67
	PRINTI """No."
	CALL TELL-MICHAELS-ALIBI
	PRINTR """"
?L67:	ZERO? DETECTIVE-SEEN-LIST? /?L73
	LESS? DETECTIVE-SEEN,DETECTIVE-CONVINCED \?L74
	PRINTI """You may be right, but while he may have been in with "
	PRINTD COL-MARSTON
	PRINTI ", that doesn't make him guilty of murder."""
	CRLF
	JUMP ?L133
?L74:	PRINTI """He couldn't have done it by himself."""
	CRLF
	JUMP ?L133
?L73:	PRINTR """You've produced no evidence he did it. Do you merely dislike him?"""
?L66:	EQUAL? PER,ALICIA \?L84
	ZERO? GLASS-ANALYZED-FOR-PRINTS? \?L85
	ZERO? DETECTIVE-SEEN-COAT? \?L85
	ZERO? DETECTIVE-SEEN-HAIR? \?L85
	PRINTI """She wasn't even in the house when the murder was committed. I don't buy it."""
	CRLF
	JUMP ?L133
?L85:	PRINTI """I agree that she must have been involved, but it seems unlikely she did it by herself. For one thing, what's her motive?"""
	CRLF
	JUMP ?L133
?L84:	EQUAL? PER,SEN-ASHER \?L92
	PRINTR """He was in the next room, it's true, but what motive did he have? How did he do it?"""
?L92:	EQUAL? PER,COCHRANE \?L95
	ZERO? DETECTIVE-SEEN-AGREEMENT? /?L96
	ZERO? DETECTIVE-SEEN-CARD? /?L98
	PRINTI """The combination of the threat in that "
	PRINTD CARD
	PRINTI " and his anger over the sale of the farm certainly present a strong circumstantial case, at least as far as motive goes, but there is no direct evidence."""
	CRLF
	JUMP ?L133
?L98:	PRINTI """It's clear he felt aggrieved by her behavior regarding the sale of the farm, but murder? He seems like a mostly harmless drunk to me."""
	CRLF
	JUMP ?L133
?L96:	ZERO? DETECTIVE-SEEN-CARD? /?L105
	PRINTI """That card certainly looks like a veiled threat to me, but what does it refer to?"""
	CRLF
	JUMP ?L133
?L105:	PRINTR """Just because he's a boor doesn't make him guilty."""
?L95:	EQUAL? PER,BUTLER \?L111
	PRINTI """I suppose you think the butler always does it?"
	ZERO? DETECTIVE-SEEN-AGREEMENT? /?L114
	PRINTI " Even if he knew about the sale of the farm, I don't see any likelihood he could have done it."
?L114:	PRINTR """"
?L111:	EQUAL? PER,RICHARD \?L121
	PRINTR """If everyone who hated a relative was guilty of murder, we'd have to build a lot more prisons."""
?L121:	EQUAL? PER,COL-MARSTON \?L124
	ZERO? DETECTIVE-SEEN-TRUST-DOCUMENTS? \?L127
	ZERO? DETECTIVE-SEEN-LIST? /?L125
?L127:	PRINTI """You've certainly shown a pattern of theft on his part, which may well establish a motive, but what about the method and opportunity? Theft for sure, but we're looking at murder here."""
	CRLF
	JUMP ?L133
?L125:	PRINTR """I don't see it, where's the motive?"""
?L124:	PRINTR """Aside from motive, method, and opportunity, you seem to have a perfect case."""
?L133:	EQUAL? PER,MICHAEL /?L137
	SET 'CORRECT?,0
	JUMP ?L139
?L137:	EQUAL? HELPER,ALICIA /?L138
	SET 'CORRECT?,0
	JUMP ?L139
?L138:	SET 'CORRECT?,1
?L139:	ZERO? CORRECT? /?L140
	ZERO? FLEEING? /?L140
	LOC MICHAEL >STACK
	CALL OUTSIDE?,STACK >STACK
	ZERO? STACK /?L140
	LOC ALICIA >STACK
	LOC MICHAEL >STACK
	EQUAL? HERE,STACK,STACK /?L140
	MOVE DUFFY,HERE
	CALL ESTABLISH-GOAL,DUFFY,HERE
	PRINTD DUFFY
	PRINTR " runs up, out of breath. ""I can't find them anywhere!"""
?L140:	CALL DUFFY-PERFORMS-ARREST,PER,HELPER
	CALL CASE-OVER,CORRECT?
	RTRUE

	.FUNCT TELL-ONE-HERE-ONE-NOT,INHERE,NOTHERE
	PRINTD DUFFY
	PRINTI " appears with "
	CALL DPRINT,NOTHERE
	PRINTI " in tow."
	CALL DUFFY-HANDCUFFS,INHERE >STACK
	RSTACK

	.FUNCT TELL-ALL-HERE,PER,HELPER=0
	PRINTD DUFFY
	PRINTI " appears with a solemn look."
	CALL DUFFY-HANDCUFFS,PER,HELPER >STACK
	RSTACK

	.FUNCT TELL-NONE-HERE,PER,HELPER=0
	PRINTD DUFFY
	PRINTI " seems to read your thoughts, as he appears with "
	CALL DPRINT,PER
	ZERO? HELPER /?L3
	PRINTI " and "
	CALL DPRINT,HELPER
?L3:	PRINTI " in handcuffs."
	RTRUE

	.FUNCT DUFFY-HANDCUFFS,PER,HELPER=0
	PRINTI " He puts handcuffs on the wrists of "
	ZERO? HELPER /?L3
	PRINTI "both "
?L3:	CALL DPRINT,PER
	ZERO? HELPER /?L10
	PRINTI " and "
	CALL DPRINT,HELPER
?L10:	PRINTI ", who stand"
	ZERO? HELPER \?L17
	PRINTI "s"
?L17:	PRINTI " stiff and quiet."
	RTRUE

	.FUNCT DUFFY-PERFORMS-ARREST,PER,HELPER,?TMP
	CRLF
	ZERO? MICHAEL-DEAD? /?L1
	CALL TELL-ALL-HERE,ALICIA
	PRINTI " """
	PRINT AMBULANCE-COMING
	PRINTI ","" he tells her."
	JUMP ?L12
?L1:	ZERO? HELPER /?L5
	IN? HELPER,HERE \?L8
	IN? PER,HERE \?L6
	CALL TELL-ALL-HERE,PER,HELPER
	JUMP ?L12
?L6:	IN? HELPER,HERE \?L8
	CALL TELL-ONE-HERE-ONE-NOT,HELPER,PER
	JUMP ?L12
?L8:	IN? PER,HERE \?L9
	CALL TELL-ONE-HERE-ONE-NOT,PER,HELPER
	JUMP ?L12
?L9:	CALL TELL-NONE-HERE,PER,HELPER
	JUMP ?L12
?L5:	SET '?TMP,HERE
	CALL META-LOC,PER >STACK
	EQUAL? ?TMP,STACK \?L11
	CALL TELL-ALL-HERE,PER
	JUMP ?L12
?L11:	CALL TELL-NONE-HERE,PER
?L12:	PRINTI " ""Let's not have any trouble, now,"" says "
	PRINTD DUFFY
	PRINTR ", in his unique way. They head for the driveway, where a police car waits with engine purring."

	.FUNCT CASE-OVER,CORRECT?
	CRLF
	ZERO? CORRECT? /?L1
	EQUAL? DETECTIVE-SEEN,DETECTIVE-CONVINCED \?L1
	ZERO? MICHAEL-DEAD? /?L3
	PRINTI "Well, they got "
	PRINTD ALICIA
	PRINTI ", but not "
	PRINTD MICHAEL
	PRINTI ". He's beyond the reach of justice now. Too bad you didn't figure it all out sooner."
	JUMP ?L10
?L3:	PRINTI "Congratulations! Your testimony as star witness for the prosecution secures the conviction of "
	PRINTD MICHAEL
	PRINTI " for the first degree murder of his wife, and of "
	PRINTD ALICIA
	PRINTI " as his accomplice. Not only are they sent to prison with the proverbial key thrown away, but "
	PRINTD COL-MARSTON
	PRINTI " is convicted in a parallel case of embezzlement and grand theft for his role in the milking of the family Trust.

Best of all, your syndicated twelve-part story of the tangled plot and its aftermath wins the Pulitzer Prize, and the book is number one on the[RWD_ID: events:324, VAL: 5] bestseller lists for 42 weeks! (Not to mention the movie and book club sales.)

As your book explains, the murder was triggered by "
	PRINTD VERONICA
	PRINTI "'s desire to sell the farm and move to a more rural area. Even with the proceeds of the sale, still more funds from the family Trust would have been required to purchase the new property and build on it. "
	PRINTD MICHAEL
	PRINTI " and "
	PRINTD COL-MARSTON
	PRINTI " were alarmed, as they had been milking the Trust by investing in dummy corporations under their control. After a time, "
	PRINTD VERONICA
	PRINTI " grew suspicious and had the Trust's dealings investigated. She expected that "
	PRINTD COL-MARSTON
	PRINTI " would be implicated, but was surprised to find that "
	PRINTD MICHAEL
	PRINTI " was an equal partner in the scheme. For "
	PRINTD MICHAEL
	PRINTI ", time was running out. He wanted out of the marriage, but not the Ashcroft fortune, and enlisted "
	PRINTD ALICIA
	PRINTI "'s help in the bizarre scheme. "
	PRINTD ALICIA
	PRINTI " would impersonate the murdered "
	PRINTD VERONICA
	PRINTI " to establish an alibi. Your appearance on the scene as an old friend suggested another red herring. A few pieces of evidence planted, and you might be framed. Fortunately for all but the plotters, the plans were for naught."
	CALL PRINT-ID,STR?152
	JUMP ?L10
?L1:	PRINT TOO-BAD
	PRINTI "your testimony fails to convince the jury, for precisely the reasons outlined by "
	CALL THE-PRINT,DETECTIVE
	PRINTI " before the arrest. Your editor demotes you to covering flower shows and computer software conventions. As a final blow, when "
	CALL THE-PRINT,DETECTIVE
	PRINTI " solves the case and makes the arrest, you realize how simple it all should have been."
	CALL PRINT-ID,STR?153
?L10:	CRLF
	CALL FINISH >STACK
	RSTACK

	.FUNCT FINISH,Y
	PRINTI "
The story has come to an end.
"
?L3:	PRINTI "
[EVENT: GAME OVER]Would you like to start over from scratch or restore a saved position?"
	CALL YES?,1 >Y
	ZERO? Y \?L7
	QUIT
?L7:	EQUAL? Y,M-FATAL \?L9
	CALL V-RESTORE
	JUMP ?L3
?L9:	RESTART

	.FUNCT I-PARTY-OVER,STR
	INC 'OVER-COUNT
	GET OVER-TABLE,OVER-COUNT >STR
	ZERO? STR /?L1
	RANDOM 10 >STACK
	ADD 10,STACK >STACK
	CALL QUEUE,I-PARTY-OVER,STACK
	JUMP ?L3
?L1:	SET 'OFFICE-EXPEDITION?,1
	ZERO? FLEEING? \?L4
	CALL ESTABLISH-GOAL,MICHAEL,BALLROOM-9
	CALL ESTABLISH-GOAL,ALICIA,BALLROOM-9
?L4:	CALL ESTABLISH-GOAL,RICHARD,BALLROOM-9
	CALL ESTABLISH-GOAL,LINDA,BALLROOM-9
	CALL ESTABLISH-GOAL,COL-MARSTON,BALLROOM-9
	CALL ESTABLISH-GOAL,SEN-ASHER,BALLROOM-9
	CALL ESTABLISH-GOAL,COCHRANE,BALLROOM-9
	CALL ESTABLISH-GOAL,OSTMANN,BALLROOM-9
	CALL ESTABLISH-GOAL,BUTLER,BALLROOM-9
	CALL ESTABLISH-GOAL,DETECTIVE,BALLROOM-9
	CALL ESTABLISH-GOAL,DUFFY,BALLROOM-9
	SET 'ON-DANCE-FLOOR?,0
	SET 'PARTY-OVER,1
?L3:	CALL IN-BALLROOM?,PLAYER >STACK
	ZERO? STACK \?L9
	EQUAL? HERE,HALLWAY-12,HALLWAY-11,HALLWAY-10 /?L9
	EQUAL? HERE,HALLWAY-9,HALL \FALSE
?L9:	ZERO? STR /?L10
	PRINT STR
	CRLF
	RTRUE
?L10:	PRINTI "The last of the guests has left. No one is left but the suspects"
	LOC CORPSE >STACK
	ZERO? STACK /?L17
	PRINTI " and the victim"
?L17:	PRINTR "."

	.FUNCT DISCOVER-BODY,LISTENER,OW,L
	LOC LISTENER >L
	CALL META-LOC,CORPSE >STACK
	EQUAL? STACK,L \FALSE
	IN? CORPSE,L /?L3
	LOC CORPSE >STACK
	FSET? STACK,OPENBIT /?L3
	LOC CORPSE >STACK
	FSET? STACK,PERSON \FALSE
?L3:	SET 'OW,WINNER
	SET 'WINNER,PLAYER
	CALL PERFORM,V?$0024DISCOVER,CORPSE,LISTENER
	SET 'WINNER,OW
	RETURN WINNER

	.FUNCT MURDER-TELL,LISTENER,TELLER,OW
	SET 'OW,WINNER
	EQUAL? PLAYER,TELLER \?L4
	CALL DISCOVER-BODY,LISTENER
	EQUAL? PLAYER,TELLER /FALSE
?L4:	FSET? LISTENER,TOLD /FALSE
	EQUAL? LISTENER,PLAYER \?L7
	ZERO? PLAYER-HIDING \FALSE
	EQUAL? TELLER,MICHAEL \?L11
	PRINTD MICHAEL
	PRINTI " notices you. He looks very distraught, almost in shock. """
	PRINTD VERONICA
	PRINTI "'s been murdered!"" he says. He chokes back a sob as a tremor travels through his body."
	CRLF
	JUMP ?L24
?L11:	CALL DPRINT,TELLER,1
	PRINTI " notices you and approaches. "
	EQUAL? TELLER,DETECTIVE,DUFFY \?L17
	PRINTI """There has been a murder. "
	PRINTD VERONICA
	PRINTI " Ashcroft has been killed. I must warn you that everyone here is a suspect, and you aren't to leave the premises without permission."""
	CRLF
	JUMP ?L24
?L17:	PRINTI """Did you hear?"" "
	CALL HE$002fSHE-PRINT,TELLER
	PRINTI " says quietly. ""Someone has murdered "
	PRINTD VERONICA
	PRINTI "! They found the body, she was strangled. The office was ransacked! Someone said it was a prowler, but no one's been caught yet."""
	CRLF
	JUMP ?L24
?L7:	SET 'WINNER,TELLER
	CALL PERFORM,V?$0024REVEAL,GLOBAL-MURDER,LISTENER
	SET 'WINNER,OW
?L24:	FSET LISTENER,TOLD
	RTRUE

	.FUNCT I-GAME-OVER
	PRINTI "Sorry, you have missed the morning edition deadline."
	CRLF
	CALL FINISH >STACK
	RSTACK

	.FUNCT DIR-PRINT,DIR,CNT=0
?L1:	GET DIR-STRINGS,CNT >STACK
	EQUAL? STACK,DIR \?L3
	EQUAL? DIR,P?UP,P?DOWN /?L5
	PRINTI "the "
?L5:	ADD CNT,1 >STACK
	GET DIR-STRINGS,STACK >STACK
	PRINT STACK
	RTRUE
?L3:	INC 'CNT
	JUMP ?L1

	.FUNCT GOALS?,PER,VAL
	CALL GET-GOALS,PER >STACK
	PUT STACK,GOAL-ENABLE,VAL
	RTRUE

	.FUNCT FOLLOW-GOAL,PER,HERE?1,LINE,RM,GT,GOAL,FLG,TMP,HERE-FLAG=0,GOAL-FLAG=0,IGOAL=0,LOC,CNT=1,?TMP
	LOC PER >HERE?1
	CALL GET-GOALS,PER >GT
	GET GT,GOAL-F >STACK
	EQUAL? HERE?1,STACK \?L1
	CALL GOAL-REACHED,PER,1 >STACK
	RSTACK
?L1:	GET GT,GOAL-ENABLE >STACK
	ZERO? STACK /FALSE
	GETP HERE?1,P?STATION >LOC
	EQUAL? LOC,HERE?1 /?L5
	CALL MOVE-PERSON,PER,LOC >STACK
	RSTACK
?L5:	GET GT,GOAL-I >IGOAL
	GET TRANSFER-TABLE,IGOAL >GOAL
	ZERO? GOAL \?L11
	SET 'IGOAL,0
	GET GT,GOAL-S >GOAL
	ZERO? GOAL /FALSE
?L11:	EQUAL? HERE?1,GOAL \?L17
	ZERO? IGOAL /?L14
	ADD IGOAL,1 >STACK
	GET TRANSFER-TABLE,STACK >STACK
	CALL MOVE-PERSON,PER,STACK >FLG
	GET GT,GOAL-F >STACK
	CALL ESTABLISH-GOAL,PER,STACK
	RETURN FLG
?L14:	GET GT,GOAL-F >STACK
	EQUAL? HERE?1,STACK /?L16
	GET GT,GOAL-F >STACK
	CALL MOVE-PERSON,PER,STACK >FLG
	RETURN FLG
?L16:	CALL GOAL-REACHED,PER >STACK
	RSTACK
?L17:	GETP GOAL,P?LINE >STACK
	CALL GET-LINE,STACK >LINE
?L19:	GET LINE,CNT >RM
	EQUAL? RM,HERE?1 /?L20
	EQUAL? RM,GOAL \?L23
	SET 'GOAL-FLAG,CNT
	JUMP ?L24
?L23:	ADD CNT,1 >STACK
	GET LINE,STACK >STACK
	ZERO? STACK \?L24
	CRLF
	QUIT
?L24:	ADD CNT,3 >CNT
	JUMP ?L19
?L20:	SET 'HERE-FLAG,CNT
	GET LINE,0 >STACK
	GRTR? STACK,0 \?L41
	ZERO? GOAL-FLAG \?L31
?L30:	GET LINE,CNT >RM
	EQUAL? RM,GOAL \?L32
	SET 'GOAL-FLAG,CNT
	JUMP ?L31
?L32:	ADD CNT,3 >CNT
	JUMP ?L30
?L31:	SUB GOAL-FLAG,HERE-FLAG >GOAL-FLAG
	GET LINE,0 >?TMP
	CALL ABS,GOAL-FLAG >STACK
	SUB ?TMP,STACK >TMP
	CALL ABS,GOAL-FLAG >STACK
	GRTR? STACK,TMP \?L36
	LESS? GOAL-FLAG,0 \?L38
	SET 'GOAL-FLAG,0
	JUMP ?L41
?L38:	SET 'GOAL-FLAG,1
	JUMP ?L41
?L36:	GRTR? GOAL-FLAG,0 \?L41
	SET 'GOAL-FLAG,0
?L41:	ZERO? GOAL-FLAG /?L47
	EQUAL? HERE-FLAG,1 \?L44
	GET LINE,0 >STACK
	ADD STACK,1 >HERE-FLAG
?L44:	ZERO? GOAL-FLAG /?L47
	SUB HERE-FLAG,3 >STACK
	JUMP ?L49
?L47:	ADD HERE-FLAG,3 >STACK
?L49:	GET LINE,STACK >LOC
	CALL MOVE-PERSON,PER,LOC >STACK
	RSTACK

	.FUNCT COR-DIR,HERE?1,THERE,COR,RM,PAST=0,CNT=2
	GETP HERE?1,P?CORRIDOR >STACK
	GETP THERE,P?CORRIDOR >STACK
	BAND STACK,STACK >STACK
	CALL GET-COR,STACK >COR
?L1:	GET COR,CNT >RM
	EQUAL? RM,HERE?1 \?L3
	SET 'PAST,1
	JUMP ?L2
?L3:	EQUAL? RM,THERE /?L2
	INC 'CNT
	JUMP ?L1
?L2:	GET COR,PAST >STACK
	RSTACK

	.FUNCT GET-LINE,LN
	ZERO? LN \?L1
	RETURN HALL-LINE
?L1:	EQUAL? LN,1 \?L3
	RETURN BALLROOM-LINE
?L3:	EQUAL? LN,2 \?L4
	RETURN EAST-HALL-LINE
?L4:	EQUAL? LN,3 \?L5
	RETURN GARAGE-LINE
?L5:	EQUAL? LN,4 \?L6
	RETURN OUTSIDE-LINE
?L6:	PRINTI "**UNDEFINED LINE**"
	RTRUE

	.FUNCT GET-COR,NUM
	EQUAL? NUM,1 \?L1
	RETURN COR-1
?L1:	EQUAL? NUM,2 \?L3
	RETURN COR-2
?L3:	EQUAL? NUM,4 \?L4
	RETURN COR-4
?L4:	EQUAL? NUM,8 \?L5
	RETURN COR-8
?L5:	EQUAL? NUM,16 \?L6
	RETURN COR-16
?L6:	EQUAL? NUM,32 \?L7
	RETURN COR-32
?L7:	EQUAL? NUM,64 \?L8
	RETURN COR-64
?L8:	EQUAL? NUM,128 \?L9
	RETURN COR-128
?L9:	RETURN COR-256

	.FUNCT INHABITED?,RM
	IN? MICHAEL,RM /TRUE
	IN? VERONICA,RM /TRUE
	IN? ALICIA,RM /TRUE
	IN? RICHARD,RM /TRUE
	IN? COL-MARSTON,RM /TRUE
	IN? LINDA,RM /TRUE
	IN? SEN-ASHER,RM /TRUE
	IN? COCHRANE,RM /TRUE
	IN? OSTMANN,RM /TRUE
	IN? BUTLER,RM /TRUE
	IN? BARTENDER,RM /TRUE
	IN? DETECTIVE,RM /TRUE
	IN? DUFFY,RM /TRUE
	RFALSE

	.FUNCT CORRIDOR-LOOK,ITM=0,C,Z,COR,VAL,FOUND=0
	GETP HERE,P?CORRIDOR >C
	ZERO? C /FALSE
?L3:	SUB C,256 >Z
	LESS? Z,0 /?L5
	SET 'COR,COR-256
	JUMP ?L15
?L5:	SUB C,128 >Z
	LESS? Z,0 /?L7
	SET 'COR,COR-128
	JUMP ?L15
?L7:	SUB C,64 >Z
	LESS? Z,0 /?L8
	SET 'COR,COR-64
	JUMP ?L15
?L8:	SUB C,32 >Z
	LESS? Z,0 /?L9
	SET 'COR,COR-32
	JUMP ?L15
?L9:	SUB C,16 >Z
	LESS? Z,0 /?L10
	SET 'COR,COR-16
	JUMP ?L15
?L10:	SUB C,8 >Z
	LESS? Z,0 /?L11
	SET 'COR,COR-8
	JUMP ?L15
?L11:	SUB C,4 >Z
	LESS? Z,0 /?L12
	SET 'COR,COR-4
	JUMP ?L15
?L12:	SUB C,2 >Z
	LESS? Z,0 /?L13
	SET 'COR,COR-2
	JUMP ?L15
?L13:	SUB C,1 >Z
	LESS? Z,0 /?L4
	SET 'COR,COR-1
?L15:	CALL CORRIDOR-CHECK,COR,ITM >VAL
	ZERO? FOUND \?L16
	SET 'FOUND,VAL
?L16:	SET 'C,Z
	JUMP ?L3
?L4:	RETURN FOUND

	.FUNCT CORRIDOR-CHECK,COR,ITM,CNT=2,PAST=0,FOUND=0,RM,OBJ
?L1:	GET COR,CNT >RM
	ZERO? RM /FALSE
	EQUAL? RM,HERE \?L5
	SET 'PAST,1
	JUMP ?L24
?L5:	FIRST? RM >OBJ \?L24
?L7:	ZERO? ITM /?L9
	EQUAL? OBJ,ITM \?L14
	GET COR,PAST >FOUND
	JUMP ?L8
?L9:	GETP OBJ,P?CHARACTER >STACK
	ZERO? STACK /?L14
	CALL IN-MOTION?,OBJ >STACK
	ZERO? STACK \?L14
	CALL THE-PRINT,OBJ,1
	PRINTI " is off to "
	GET COR,PAST >STACK
	CALL DIR-PRINT,STACK
	PRINTI "."
	CRLF
?L14:	NEXT? OBJ >OBJ /?L7
?L8:	ZERO? FOUND /?L24
	RETURN FOUND
?L24:	INC 'CNT
	JUMP ?L1

	.FUNCT IN-MOTION?,PER,GT
	CALL GET-GOALS,PER >GT
	ZERO? GT /FALSE
	GET GT,GOAL-ENABLE >STACK
	ZERO? STACK /FALSE
	GET GT,GOAL-S >STACK
	ZERO? STACK /FALSE
	GET GT,GOAL-F >STACK
	LOC PER >STACK
	EQUAL? STACK,STACK /FALSE
	RTRUE

	.FUNCT START-MOVEMENT
	CALL QUEUE,G-MICHAEL,1 >STACK
	PUT STACK,0,1
	CALL QUEUE,G-ALICIA,1 >STACK
	PUT STACK,0,1
	CALL QUEUE,G-RICHARD,1 >STACK
	PUT STACK,0,1
	CALL QUEUE,G-COL-MARSTON,1 >STACK
	PUT STACK,0,1
	CALL QUEUE,G-LINDA,1 >STACK
	PUT STACK,0,1
	CALL QUEUE,G-SEN-ASHER,1 >STACK
	PUT STACK,0,1
	CALL NEW-SCRIPT,COCHRANE,COCHRANE-LOOP
	CALL NEW-SCRIPT,OSTMANN,OSTMANN-LOOP
	CALL NEW-SCRIPT,BUTLER,BUTLER-LOOP
	CALL QUEUE,I-FOLLOW,-1 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-ATTENTION,-1 >STACK
	PUT STACK,0,1
	RTRUE

	.FUNCT GET-GOALS,PER
	GETP PER,P?CHARACTER >PER
	GET GOAL-TABLES,PER >STACK
	RSTACK

	.FUNCT NEW-SCRIPT,PER,SCRIPT,CH,GT
	GETP PER,P?CHARACTER >CH
	PUT MOVEMENT-GOALS,CH,SCRIPT
	GET GOAL-TABLES,CH >GT
	PUT GT,GOAL-QUEUED,0
	GET GT,GOAL-FUNCTION >STACK
	CALL IMOVEMENT,PER,STACK
	RFALSE

	.FUNCT IMOVEMENT,PER,INT?1,TB,VAR,DIS,TIM,ID,RM,GT,FLAG=0
	GETP PER,P?CHARACTER >ID
	GET MOVEMENT-GOALS,ID >TB
	GET GOAL-TABLES,ID >GT
	GET TB,MG-ROOM >RM
	ZERO? RM /?L5
	GET GT,GOAL-QUEUED >STACK
	ZERO? STACK /?L3
	PUT GT,GOAL-QUEUED,RM
	JUMP ?L5
?L3:	CALL ESTABLISH-GOAL,PER,RM
?L5:	GET TB,MG-TIME >TIM
	ZERO? TIM /FALSE
	GET TB,MG-VARIATION >VAR
	LESS? VAR,0 \?L9
	SUB 0,VAR >VAR
	SET 'FLAG,1
?L9:	GRTR? VAR,0 \?L12
	GRTR? PRESENT-TIME,540 \?L12
	MUL VAR,2 >STACK
	RANDOM STACK >DIS
	JUMP ?L14
?L12:	SET 'DIS,0
?L14:	SUB DIS,VAR >STACK
	ADD TIM,STACK >STACK
	CALL QUEUE,INT?1,STACK >STACK
	PUT STACK,0,1
	ADD TB,MG-LENGTH >STACK
	PUT MOVEMENT-GOALS,ID,STACK
	ZERO? FLAG \FALSE
	GET TB,MG-NEXT >STACK
	ZERO? STACK /FALSE
	SUB VAR,DIS >STACK
	GET TB,MG-NEXT >STACK
	ADD STACK,STACK >STACK
	PUT TB,MG-NEXT,STACK
	RFALSE

	.FUNCT I-FOLLOW,FLG=0,CNT=0,GT,VAL
?L1:	IGRTR? 'CNT,CHARACTER-MAX \?L3
	RETURN FLG
?L3:	GET GOAL-TABLES,CNT >GT
	GET GT,GOAL-S >STACK
	ZERO? STACK /?L1
	GET GT,GOAL-ENABLE >STACK
	ZERO? STACK /?L1
	GET CHARACTER-TABLE,CNT >STACK
	CALL FOLLOW-GOAL,STACK >VAL
	ZERO? VAL /?L1
	EQUAL? FLG,M-FATAL /?L1
	SET 'FLG,VAL
	JUMP ?L1

	.FUNCT I-ATTENTION,FLG=0,CNT=0,ATT,GT
?L1:	IGRTR? 'CNT,CHARACTER-MAX \?L3
	RETURN FLG
?L3:	GET GOAL-TABLES,CNT >GT
	GET GT,ATTENTION >ATT
	GRTR? ATT,0 \?L1
	DEC 'ATT
	ZERO? ATT \?L8
	PUT GT,GOAL-ENABLE,1
	JUMP ?L10
?L8:	EQUAL? ATT,1 \?L10
	GET CHARACTER-TABLE,CNT >STACK
	IN? STACK,HERE \?L10
	GET GT,GOAL-FUNCTION >STACK
	CALL STACK,G-IMPATIENT >STACK
	ZERO? STACK /?L10
	SET 'FLG,1
?L10:	PUT GT,ATTENTION,ATT
	JUMP ?L1

	.FUNCT GRAB-ATTENTION,PER,LEN=0,GT,ATT
	CALL GET-GOALS,PER >GT
	GET GT,GOAL-S >STACK
	ZERO? STACK /?L8
	ZERO? LEN /?L3
	SET 'ATT,LEN
	JUMP ?L5
?L3:	GET GT,ATTENTION-SPAN >ATT
?L5:	PUT GT,ATTENTION,ATT
	ZERO? ATT \?L6
	PUT GT,GOAL-ENABLE,1
	RFALSE
?L6:	GET GT,GOAL-ENABLE >STACK
	ZERO? STACK /?L8
	PUT GT,GOAL-ENABLE,0
?L8:	SET 'QCONTEXT,PER
	SET 'QCONTEXT-ROOM,HERE
	RTRUE

	.FUNCT UNPRIORITIZE,PER,GT
	CALL GET-GOALS,PER >GT
	PUT GT,GOAL-ENABLE,1
	GET GT,GOAL-QUEUED >STACK
	ZERO? STACK /FALSE
	GET GT,GOAL-QUEUED >STACK
	CALL ESTABLISH-GOAL,PER,STACK
	PUT GT,GOAL-QUEUED,0
	RTRUE

	.FUNCT ESTABLISH-GOAL,PER,GOAL,PRIORITY=0,H,HL,GL,GT
	EQUAL? PER,PLAYER \?L1
	SET 'H,HERE
	JUMP ?L3
?L1:	LOC PER >H
?L3:	CALL GET-GOALS,PER >GT
	ZERO? PRIORITY /?L6
	PUT GT,ATTENTION,0
	PUT GT,GOAL-ENABLE,1
	GET GT,GOAL-F >STACK
	EQUAL? GOAL,STACK /?L6
	PUT GT,GOAL-QUEUED,H
?L6:	GETP GOAL,P?LINE >STACK
	GETP H,P?LINE >STACK
	MUL STACK,LINES >STACK
	ADD STACK,STACK >STACK
	MUL 2,STACK >STACK
	PUT GT,GOAL-I,STACK
	GETP GOAL,P?STATION >STACK
	PUT GT,GOAL-S,STACK
	PUT GT,GOAL-F,GOAL
	LOC PER >STACK
	RSTACK

	.FUNCT GOAL-REACHED,PER,THERE?=0,GT
	CALL GET-GOALS,PER >GT
	GET GT,GOAL-S >STACK
	ZERO? STACK /FALSE
	PUT GT,GOAL-S,0
	ZERO? THERE? /?L3
	PUSH G-ALREADY
	JUMP ?L5
?L3:	PUSH G-REACHED
?L5:	GET GT,GOAL-FUNCTION >STACK
	CALL STACK,STACK >STACK
	RSTACK

	.FUNCT MOVE-PERSON,PER,WHERE,DIR,GT,OL,COR,PCOR,CD,DF,FLG=0,DR,VAL=0,PB?
	CALL GET-GOALS,PER >GT
	LOC PER >OL
	CALL DIR-FROM,OL,WHERE >DIR
	GETPT OL,DIR >DR
	PTSIZE DR >STACK
	EQUAL? STACK,DEXIT \?L1
	GETB DR,DEXITOBJ >DR
	FSET? DR,OPENBIT /?L3
	EQUAL? PER,PLAYER \?L5
	FSET? DR,LOCKED /?L9
?L5:	FCLEAR DR,LOCKED
	FSET DR,OPENBIT
	JUMP ?L9
?L3:	SET 'DR,0
	JUMP ?L9
?L1:	SET 'DR,0
?L9:	CALL IN-BALLROOM?,PLAYER >PB?
	FSET? PER,INVISIBLE /?L124
	ZERO? PB? /?L12
	CALL IN-BALLROOM?,PER >STACK
	ZERO? STACK \?L13
	CALL IN-BALLROOM?,WHERE >STACK
	ZERO? STACK /?L12
?L13:	GET GT,GOAL-F >STACK
	EQUAL? HERE,STACK /?L124
	SET 'FLG,1
	CALL THE-PRINT,PER,1
	CALL IN-BALLROOM?,WHERE >STACK
	ZERO? STACK \?L18
	PRINTI " leaves the ballroom."
	CRLF
	JUMP ?L124
?L18:	EQUAL? OL,HERE \?L23
	PRINTI " leaves you, and"
?L23:	PRINTI " is now "
	EQUAL? WHERE,HERE \?L30
	PRINTI "with you "
?L30:	GETP WHERE,P?FDESC >STACK
	PRINT STACK
	PRINTI "."
	CRLF
	JUMP ?L124
?L12:	EQUAL? OL,HERE \?L40
	SET 'FLG,1
	CALL THE-PRINT,PER,1
	EQUAL? DIR,P?OUT \?L43
	PRINTI " leaves the room."
	CRLF
	JUMP ?L124
?L43:	EQUAL? DIR,P?IN \?L47
	ZERO? DR /?L48
	PRINTI " opens "
	CALL THE-PRINT,DR
	PRINTI " and"
?L48:	PRINTI " goes into another room."
	CRLF
	JUMP ?L124
?L47:	ZERO? DR /?L56
	PRINTI " opens "
	CALL THE-PRINT,DR
	PRINTI " and"
?L56:	PRINTI " heads off to "
	CALL DIR-PRINT,DIR
	PRINTI "."
	CRLF
	JUMP ?L124
?L40:	EQUAL? WHERE,HERE \?L65
	GET GT,GOAL-F >STACK
	EQUAL? HERE,STACK /?L124
	SET 'FLG,1
	CALL THE-PRINT,PER,1
	ZERO? DR /?L70
	PRINTI " opens "
	CALL THE-PRINT,DR
	PRINTI " and"
?L70:	EQUAL? PRSA,V?WALK \?L75
	EQUAL? DIR,P-WALK-DIR \?L75
	LOC PLAYER >STACK
	EQUAL? STACK,LAST-PLAYER-LOC /?L75
	PRINTI " walks along with"
	JUMP ?L79
?L75:	PRINTI " approaches"
?L79:	PRINTI " you."
	CRLF
	JUMP ?L124
?L65:	GETP HERE,P?CORRIDOR >COR
	ZERO? COR /?L124
	GETP OL,P?CORRIDOR >PCOR
	ZERO? PCOR /?L86
	BAND COR,PCOR >STACK
	ZERO? STACK /?L86
	SET 'FLG,1
	GETP WHERE,P?CORRIDOR >STACK
	ZERO? STACK \?L88
	CALL THE-PRINT,PER,1
	PRINTI ", off to "
	CALL COR-DIR,HERE,OL >STACK
	CALL DIR-PRINT,STACK
	PRINTI ","
	ZERO? DR /?L94
	PRINTI " opens a door and"
?L94:	PRINTI " leaves your view to "
	CALL DIR-FROM,OL,WHERE >STACK
	CALL DIR-PRINT,STACK
	PRINTI "."
	CRLF
	JUMP ?L124
?L88:	GETP WHERE,P?CORRIDOR >STACK
	BAND COR,STACK >STACK
	ZERO? STACK \?L103
	CALL THE-PRINT,PER,1
	PRINTI ", off to "
	CALL COR-DIR,HERE,OL >STACK
	CALL DIR-PRINT,STACK
	PRINTI ", disappears from sight to "
	CALL DIR-FROM,OL,WHERE >PCOR
	CALL DIR-PRINT,PCOR
	PRINTI "."
	CRLF
	JUMP ?L124
?L103:	CALL THE-PRINT,PER,1
	PRINTI " is to "
	CALL COR-DIR,HERE,WHERE >CD
	CALL DIR-PRINT,CD
	PRINTI ", heading "
	CALL DIR-FROM,OL,WHERE >DF
	EQUAL? CD,DF \?L115
	PRINTI "away from you"
	JUMP ?L119
?L115:	PRINTI "toward "
	CALL DIR-PRINT,DF
?L119:	PRINTI "."
	CRLF
	JUMP ?L124
?L86:	GETP WHERE,P?CORRIDOR >PCOR
	ZERO? PCOR /?L124
	BAND COR,PCOR >STACK
	ZERO? STACK /?L124
	SET 'FLG,1
	PRINTI "To "
	CALL COR-DIR,HERE,WHERE >CD
	CALL DIR-PRINT,CD
	PRINTI " "
	CALL THE-PRINT,PER
	PRINTI " comes into view"
	CALL DIR-FROM,OL,WHERE >STACK
	EQUAL? CD,STACK \?L131
	PRINTI " heading toward you"
	JUMP ?L135
?L131:	PRINTI " from "
	CALL DIR-FROM,WHERE,OL >STACK
	CALL DIR-PRINT,STACK
?L135:	PRINTI "."
	CRLF
?L124:	MOVE PER,WHERE
	EQUAL? PER,PLAYER \?L142
	SET 'HERE,WHERE
	RFALSE
?L142:	GET GT,GOAL-F >STACK
	EQUAL? STACK,WHERE \?L145
	CALL GOAL-REACHED,PER >VAL
	ZERO? VAL \?L178
	FSET? PER,INVISIBLE /?L178
	ZERO? FLG \?L178
	EQUAL? HERE,WHERE /?L152
	ZERO? PB? /?L153
	CALL IN-BALLROOM?,WHERE >STACK
	ZERO? STACK \?L152
?L153:	CALL CORRIDOR-LOOK,PER >STACK
	ZERO? STACK /?L178
?L152:	SET 'FLG,1
	CALL THE-PRINT,PER,1
	ZERO? DR /?L156
	PRINTI " opens "
	CALL THE-PRINT,DR
	PRINTI ", enters and"
?L156:	PRINTI " stops"
	EQUAL? HERE,WHERE \?L163
	PRINTI " here"
	JUMP ?L170
?L163:	ZERO? PB? /?L167
	PRINTI " "
	GETP WHERE,P?FDESC >STACK
	PRINT STACK
	JUMP ?L170
?L167:	PRINTI ", to "
	CALL COR-DIR,HERE,WHERE >STACK
	CALL DIR-PRINT,STACK
?L170:	PRINTI "."
	CRLF
	JUMP ?L178
?L145:	GET GT,GOAL-FUNCTION >STACK
	CALL STACK,G-ENROUTE >STACK
	ZERO? STACK /?L178
	SET 'FLG,1
?L178:	CALL WHERE-UPDATE,PER,FLG
	ZERO? VAL \?L181
	RETURN FLG
?L181:	RETURN VAL

	.FUNCT DIR-FROM,HERE?1,THERE,P=0,L,T,O
?L1:	NEXTP HERE?1,P >P
	ZERO? P /FALSE
	EQUAL? P,P?IN,P?OUT /?L1
	LESS? P,P?OUT /?L1
	GETPT HERE?1,P >T
	PTSIZE T >L
	EQUAL? L,DEXIT,UEXIT,CEXIT \?L1
	GETB T,REXIT >STACK
	EQUAL? STACK,THERE \?L1
	RETURN P

	.FUNCT LISTENING?,PER
	CALL GET-GOALS,PER >PER
	ZERO? PER /FALSE
	GET PER,ATTENTION >STACK
	GRTR? STACK,0 /TRUE
	RFALSE

	.FUNCT WHERE-UPDATE,PER,FLG=0,OW,WT,NC,CNT=0,CHR,L,PER?=0
	LOC PER >L
	ZERO? L /FALSE
	GETP PER,P?CHARACTER >NC
	GET WHERE-TABLES,NC >WT
	EQUAL? PER,PLAYER /?L4
	CALL HELD?,CORPSE >STACK
	ZERO? STACK /?L4
	CALL DISCOVER-BODY,PER >PER?
?L4:	GRTR? CNT,CHARACTER-MAX /TRUE
	EQUAL? CNT,NC /?L12
	GET CHARACTER-TABLE,CNT >CHR
	IN? CHR,L /?L27
	ZERO? CNT \?L12
	ZERO? FLG /?L12
	IN? CHR,L \?L22
?L27:	EQUAL? PER,PLAYER /?L16
	FSET? PER,TOLD \?L16
	FSET? CHR,TOLD /?L16
	CALL MURDER-TELL,CHR,PER
	JUMP ?L22
?L16:	EQUAL? CHR,PLAYER /?L18
	FSET? CHR,TOLD \?L18
	FSET? PER,TOLD /?L18
	CALL MURDER-TELL,PER,CHR
	JUMP ?L22
?L18:	LOC CORPSE >STACK
	ZERO? STACK /?L22
	EQUAL? PER,PLAYER \?L20
	CALL DISCOVER-BODY,CHR
	JUMP ?L22
?L20:	ZERO? PER? \?L22
	EQUAL? CHR,PLAYER \?L22
	CALL DISCOVER-BODY,PER
?L22:	PUT WT,CNT,PRESENT-TIME
	GET WHERE-TABLES,CNT >STACK
	PUT STACK,NC,PRESENT-TIME
?L12:	INC 'CNT
	JUMP ?L4

	.FUNCT GLOBAL-PERSON-F,PER
	EQUAL? PRSA,V?$0024CALL \?L1
	CALL CHARACTERIZE,PRSO >PER
	CALL NEARBY?,PER >STACK
	ZERO? STACK /?L3
	CALL PERFORM,V?$0024CALL,PER
	RTRUE
?L3:	CALL TELL-ISNT-HERE,PER >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?GIVE \?L6
	CALL TELL-ISNT-HERE,PRSI >STACK
	RSTACK
?L6:	EQUAL? PRSA,V?LOOK-INSIDE,V?SEARCH,V?ACCUSE /?L8
	EQUAL? PRSA,V?HELP,V?DANCE,V?ATTACK /?L8
	EQUAL? PRSA,V?KILL,V?MUNG,V?SLAP \?L7
?L8:	CALL TELL-ISNT-HERE,PRSO
	EQUAL? PRSA,V?ATTACK,V?KILL,V?MUNG /?L9
	PUSH 0
	JUMP ?L10
?L9:	PUSH 1
?L10:	CALL PRINT-ID,STR?154,STACK
	EQUAL? PRSA,V?SEARCH,V?SLAP /?L11
	PUSH 0
	JUMP ?L12
?L11:	PUSH 1
?L12:	CALL PRINT-ID,STR?155,STACK >STACK
	RSTACK
?L7:	EQUAL? PRSA,V?REVEAL,V?SHOW \?L15
	IN? PRSI,GLOBAL-OBJECTS \?L15
	SET 'PER,PRSI
	ZERO? PER \?L14
?L15:	EQUAL? PRSA,V?TELL-ME,V?ASK-ABOUT \FALSE
	IN? PRSO,GLOBAL-OBJECTS \FALSE
	SET 'PER,PRSO
	ZERO? PER /FALSE
?L14:	EQUAL? PER,ME /FALSE
	CALL NEARBY?,PER >STACK
	ZERO? STACK /?L18
	CALL DPRINT,PER,1
	PRINTR " is waiting for you to come justify your interruption."
?L18:	PRINTR "Your audience isn't listening."

	.FUNCT TELL-ISNT-HERE,PER
	CALL THE-PRINT,PER,1
	PRINT ISNT-HERE
	CRLF
	RTRUE

	.FUNCT YOU-F
	EQUAL? PRSA,V?ASK-ABOUT \?L1
	EQUAL? PRSI,YOU \?L1
	CALL PERFORM,V?ASK-ABOUT,PRSO,PRSO
	RTRUE
?L1:	EQUAL? PRSA,V?TELL-ME \FALSE
	EQUAL? PRSI,YOU \FALSE
	CALL PERFORM,V?TELL-ME,PRSO,WINNER
	RTRUE

	.FUNCT LOCALIZE,P
	FSET? P,PERSON \?L1
	IN? P,GLOBAL-OBJECTS \?L1
	GETP P,P?CHARACTER >STACK
	ZERO? STACK /?L1
	CALL CHARACTERIZE,P >STACK
	RSTACK
?L1:	RETURN P

	.FUNCT CHARACTERIZE,P
	FSET? P,PERSON \FALSE
	GETP P,P?CHARACTER >STACK
	GET CHARACTER-TABLE,STACK >STACK
	RSTACK

	.FUNCT CHARACTERIZE?,P
	GETP P,P?CHARACTER >P
	ZERO? P /FALSE
	GET CHARACTER-TABLE,P >STACK
	RSTACK

	.FUNCT OBJECT-PAIR-F,P1,P2
	EQUAL? PRSA,V?ARREST \?L1
	CALL TELL-YOU-CANT,STR?156
	CALL PRINT-ID,STR?157
	JUMP ?L3
?L1:	GET P-PRSO,P-MATCHLEN >STACK
	GRTR? STACK,2 \?L3
	EQUAL? PRSA,V?COMPARE,V?EXAMINE \TRUE
	PRINTI "That's more than one per eye. "
	PRINT YOU-ARENT
	PRINTR "up to it."
?L3:	GET P-PRSO,1 >P1
	GET P-PRSO,2 >P2
	EQUAL? PRSA,V?COMPARE \?L10
	CALL PERFORM,PRSA,P1,P2
	RTRUE
?L10:	EQUAL? PRSA,V?EXAMINE \FALSE
	FSET? P1,PERSON \?L15
	FSET? P2,PERSON /?L13
?L15:	CALL TELL-BORING >STACK
	RSTACK
?L13:	LOC P2 >STACK
	LOC P1 >STACK
	EQUAL? STACK,STACK \?L16
	CALL TELL-YOU-CANT,STR?158 >STACK
	RSTACK
?L16:	CALL THEY-ARENT,STR?159 >STACK
	RSTACK

	.FUNCT THEY-ARENT,STR
	PRINTI "They aren't "
	PRINT STR
	PRINTR "."

	.FUNCT TELL-BORING
	PRINTR "You see nothing interesting."

	.FUNCT PLAYER-F
	EQUAL? WINNER,PLAYER \FALSE
	EQUAL? PRSA,V?EXAMINE \?L3
	EQUAL? PRSO,PLAYER \?L3
	PRINTI "You look pretty much like you always do, excepting the fact that you are wearing a fairly ridiculous looking "
	PRINTD COWBOY-COSTUME
	PRINTR "."
?L3:	EQUAL? NOT-ROPE,PRSO,PRSI \?L7
	CALL NOT-ROPE-F >STACK
	RSTACK
?L7:	EQUAL? PRSA,V?ARREST,V?ACCUSE \?L8
	EQUAL? PRSO,PLAYER,ME \?L8
	PRINTR "Turning yourself in, eh?"
?L8:	EQUAL? PRSA,V?ATTACK,V?KILL \?L11
	IN? PRSO,HERE \?L11
	EQUAL? PRSO,CORPSE,VERONICA,DOG /?L11
	EQUAL? PRSO,PLAYER \?L12
	PRINTI "Suicide"
	CALL PRINT-ID,STR?160
	JUMP ?L22
?L12:	FSET? PRSO,PERSON \?L16
	FSET? PLAYER,TOLD \?L19
	PUSH STR?161
	JUMP ?L21
?L19:	PUSH STR?162
?L21:	PRINT STACK
	PRINTD GLOBAL-MURDER
	CALL PRINT-ID,STR?163
	JUMP ?L22
?L16:	PRINTI "This"
?L22:	PRINTR " is not the way to clear up this mess."
?L11:	EQUAL? PRSA,V?GIVE \?L27
	EQUAL? PRSI,PLAYER \?L27
	PRINTR "Taking up juggling, eh?"
?L27:	EQUAL? PRSA,V?DANCE,V?TAKE \?L30
	EQUAL? PRSO,PLAYER \?L30
	PRINTR "Usually, you say that to someone else."
?L30:	IN? DETECTIVE,HERE \?L39
	EQUAL? TARGET,PLAYER \?L33
	EQUAL? PRSA,V?SGIVE,V?SSHOW /FALSE
	CALL PLAYER-ARRESTED?,DETECTIVE >STACK
	ZERO? STACK /FALSE
	EQUAL? PRSA,V?THROUGH,V?FOLLOW,V?WALK-TO /TRUE
	EQUAL? PRSA,V?WALK /TRUE
	RFALSE
?L33:	IN? DETECTIVE,HERE \?L39
	CALL LAB-RESULTS-TO-PLAYER >STACK
	ZERO? STACK /?L39
	CRLF
	RFALSE
?L39:	IN? DUFFY,HERE \?L40
	EQUAL? TARGET,PLAYER \?L40
	EQUAL? PRSA,V?SGIVE,V?SSHOW /FALSE
	CALL PLAYER-ARRESTED?,DUFFY >STACK
	ZERO? STACK /FALSE
	EQUAL? PRSA,V?THROUGH,V?FOLLOW,V?WALK-TO /TRUE
	EQUAL? PRSA,V?WALK /TRUE
	RFALSE
?L40:	EQUAL? PRSA,V?REVEAL \?L48
	EQUAL? PRSI,PLAYER /?L47
?L48:	EQUAL? PRSA,V?$0024CALL,V?TELL,V?TELL-ME \?L46
	EQUAL? PRSO,PLAYER \?L46
?L47:	EQUAL? PRSA,V?TELL \?L49
	SET 'P-CONT,0
	SET 'QUOTE-FLAG,0
?L49:	CALL INTERVIEW-SELF >STACK
	RSTACK
?L46:	EQUAL? PRSA,V?REVEAL \?L54
	EQUAL? PRSO,GLOBAL-MURDER /?L53
?L54:	EQUAL? PRSA,V?ASK-ABOUT,V?TELL-ME \?L52
	EQUAL? PRSI,GLOBAL-MURDER \?L52
?L53:	FSET? PLAYER,TOLD /FALSE
	PRINTI "What murder? "
	PRINT YOU-DONT
	PRINTR "know anything about a murder."
?L52:	EQUAL? PRSA,V?POUR-ON,V?THROW-AT \?L62
	EQUAL? PRSI,PLAYER /?L61
?L62:	EQUAL? PRSA,V?FOLLOW,V?RUB \?L60
	EQUAL? PRSO,PLAYER \?L60
?L61:	PRINT YOU-ARENT
	PRINTR "coordinated enough."
?L60:	EQUAL? PRSA,V?ALARM \FALSE
	EQUAL? PRSO,0,PLAYER,ME \FALSE
	PRINTR "Getting sleepy, huh?"

	.FUNCT ME-F
	EQUAL? PRSA,V?RUB /FALSE
	EQUAL? ME,PRSO,PRSI \FALSE
	EQUAL? PRSI,ME \?L4
	PUSH PLAYER
	JUMP ?L6
?L4:	PUSH PRSI
?L6:	EQUAL? PRSO,ME \?L7
	PUSH PLAYER
	JUMP ?L9
?L7:	PUSH PRSO
?L9:	CALL PERFORM,PRSA,STACK,STACK
	RTRUE

	.FUNCT COWBOY-COSTUME-F
	EQUAL? PRSA,V?EXAMINE \?L1
	LOC PRSO >STACK
	CALL PERFORM,V?EXAMINE,STACK
	RTRUE
?L1:	EQUAL? PRSA,V?DROP,V?TAKE-OFF \FALSE
	PRINTR "The result would be embarrassing."

	.FUNCT GUNBELT-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "This is fine western gunbelt, with a holster for a six-gun and loops with lots of bullets. It's expertly tooled leather and is really the nicest element of your costume."
	FSET? GUNBELT,WEARBIT /?L5
	IN? BULLET,GUNBELT /?L5
	PRINTI " Now that you have it off, you can see that in the back one of the cartridge loops is empty: a bullet is missing."
?L5:	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \?L10
	PRINTR "Don't you remember, you left the gun at home. It was just a toy anyway."
?L10:	EQUAL? PRSA,V?PUT \FALSE
	EQUAL? PRSO,BULLET /FALSE
	EQUAL? PRSI,GUNBELT \FALSE
	CALL TELL-WONT-FIT >STACK
	RSTACK

	.FUNCT PEN-F
	EQUAL? PRSA,V?WRITE \FALSE
	EQUAL? PRSO,PEN \FALSE
	IN? NOTEBOOK,PLAYER \?L3
	CALL PERFORM,V?WRITE,NOTEBOOK,PEN
	RTRUE
?L3:	PRINTR "On your cuff, no doubt."

	.FUNCT NOTEBOOK-F
	EQUAL? PRSA,V?WRITE /?L3
	EQUAL? PRSA,V?TAKE \FALSE
	IN? NOTEBOOK,PLAYER \FALSE
?L3:	IN? PEN,PLAYER \?L4
	PRINTR "The notebook now contains more doodles, phrases, and such than before."
?L4:	PRINT YOU-DONT-HAVE
	PRINTR "a writing implement."

	.FUNCT YOUR-COAT-F
	EQUAL? PRSA,V?THROUGH \?L1
	CALL PERFORM,V?WEAR,YOUR-COAT
	RTRUE
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \?L3
	PRINT THERE-IS
	PRINTR "nothing in the coat."
?L3:	EQUAL? PRSA,V?SMELL \?L6
	PRINTR "It smells slightly damp, which is expected, as it was raining when you arrived."
?L6:	EQUAL? PRSA,V?RUB \FALSE
	PRINTR "It feels slightly damp. It hasn't finished drying off from the rain."

	.FUNCT DONT-HANDLE?
	EQUAL? PRSA,V?THANKS,V?$0024REVEAL,V?IS /TRUE
	EQUAL? PRSA,V?EXAMINE,V?DANCE,V?FIND /TRUE
	EQUAL? PRSA,V?SSHOW,V?SGIVE,V?WHAT /TRUE
	EQUAL? PRSA,V?TELL-ME \FALSE
	EQUAL? PRSO,ME,PLAYER /TRUE
	RFALSE

	.FUNCT MICHAEL-F
	EQUAL? WINNER,MICHAEL \?L1
	EQUAL? PRSA,V?HELLO \?L3
	FSET? MICHAEL,TOLD \?L5
	PRINTI """How could this have happened? "
	PRINT YOU-MUST
	PRINTR "feel lucky, something like this happening when you're here, but it's horrible, horrible!"""
?L5:	PRINTR """Glad you could make it. I don't see where you'll find a story here, but you'll have fun, at least."""
?L3:	CALL DONT-HANDLE? >STACK
	ZERO? STACK \FALSE
	PRINTD MICHAEL
	PRINTR " pays you no heed."
?L1:	EQUAL? PRSA,V?$0024REVEAL \?L16
	EQUAL? PRSO,GLOBAL-MURDER \?L16
	CALL QUEUE,I-MICHAEL-TO-GARAGE,5 >STACK
	PUT STACK,0,1
	CALL REVEAL-MURDER,MICHAEL >STACK
	ZERO? STACK /?L17
	IN? WINNER,HERE \?L19
	CALL DPRINT,WINNER,1
	PRINTI " breaks the news of the murder to "
	PRINTD MICHAEL
	PRINTI ", who responds jokingly, then realizes that "
	CALL DPRINT,WINNER
	PRINTR " is serious. He seems to be in a state of shock."
?L19:	CALL NEARBY?,MICHAEL >STACK
	ZERO? STACK /FALSE
	CALL DPRINT,WINNER,1
	PRINTI " has just told "
	PRINTD MICHAEL
	PRINTR " something that seems to have shocked him terribly."
?L17:	IN? WINNER,HERE \FALSE
	CALL DPRINT,WINNER,1
	PRINTI " breaks the news of the murder to "
	PRINTD MICHAEL
	PRINTR ". He already knows about it, and replies scornfully."
?L16:	EQUAL? PRSA,V?REVEAL \?L33
	EQUAL? PRSO,GLOBAL-MURDER \?L33
	CALL QUEUE,I-MICHAEL-TO-GARAGE,5 >STACK
	PUT STACK,0,1
	CALL REVEAL-MURDER,MICHAEL >STACK
	ZERO? STACK /?L34
	PRINTR """What! You're kidding... No, you're not, are you?"" He seems to be in a state of shock."
?L34:	PRINTR """I already know. You're a cruel person to harp on it."""
?L33:	EQUAL? PRSA,V?EXAMINE \?L41
	PRINTD MICHAEL
	PRINTR " Wellman is a tall, greying man about forty years of age. He is costumed as an Arab sheik straight out of a bad movie of the twenties."
?L41:	EQUAL? PRSA,V?ASK-ABOUT \?L44
	EQUAL? PRSO,MICHAEL \?L44
	FSET? PRSI,PERSON /?L45
	EQUAL? PRSI,DRINK \?L47
	CALL IN-BALLROOM?,VERONICA >STACK
	ZERO? STACK /?L47
	PRINTI """"
	PRINTD VERONICA
	PRINTR "'s drink? She was drinking a Singapore Sling."""
?L47:	EQUAL? PRSI,HORSE \?L51
	PRINTI """'Lurking Grue' is "
	PRINTD VERONICA
	PRINTR "'s prize show jumper. He's really quite a beautiful animal. He's coal black, you can barely see him in the dark."""
?L51:	EQUAL? PRSI,GLOBAL-MURDER \?L54
	FSET? PRSO,TOLD \?L55
	PRINTR """You reporters have all the sensitivity of buffalo. Can't you leave me alone?"""
?L55:	PRINTR """Murder?"""
?L54:	PRINTI """I'm not sure what I can tell you about "
	CALL THE-PRINT,PRSI
	PRINTR "."""
?L45:	EQUAL? PRSI,PLAYER \?L65
	PRINTI """I thought you were a friend of "
	PRINTD VERONICA
	PRINTR "'s. Didn't you go to school together or something?"""
?L65:	EQUAL? PRSI,MICHAEL,GLOBAL-MICHAEL \?L68
	PRINTR """What can I say? I didn't realize the rich had to serve any function but decoration and public amusement. That's what I do, and I take my job seriously."" He smiles."
?L68:	EQUAL? PRSI,GLOBAL-VERONICA,VERONICA,CORPSE \?L71
	FSET? MICHAEL,TOLD \?L72
	PRINTD MICHAEL
	PRINTR " stares at you. ""What a strange question! She was my wife, and I loved her, and she's dead! Murdered! Why would anyone want to kill her?"" His words trail off. ""I can't understand this. Things were so good for us..."""
?L72:	IN? VERONICA,HERE \?L76
	PRINTD MICHAEL
	PRINTI " hugs "
	PRINTD VERONICA
	PRINTR ". He smiles."
?L76:	CALL IN-BALLROOM?,VERONICA >STACK
	ZERO? STACK /?L79
	PRINTR """That's her over there. I guess she's going to try to get that costume cleaned up."""
?L79:	PRINTI """That's an odd question. She's my wife: I love her."""
	GRTR? PRESENT-TIME,555 \?L85
	PRINTI " He looks around quizzically. ""I wonder where she's gotten off to?"""
?L85:	CRLF
	RTRUE
?L71:	EQUAL? PRSI,ALICIA,GLOBAL-ALICIA \?L90
	PRINTI """She's an excellent horsewoman, and a good friend of "
	PRINTD VERONICA
	PRINTR "'s. She boards her horses here, so she's here a lot."""
?L90:	EQUAL? PRSI,COL-MARSTON,GLOBAL-COL-MARSTON \?L93
	PRINTI """"
	PRINTD COL-MARSTON
	PRINTR "? One of the ablest men I know. He's done a lot with our family trust, and I can always count on his advice."""
?L93:	EQUAL? PRSI,SEN-ASHER,GLOBAL-SEN-ASHER \?L96
	PRINTI """"
	PRINTD VERONICA
	PRINTR " and I are quite fond of him. With a little luck he'll be president some day. The man has a lot on the ball."""
?L96:	EQUAL? PRSI,OSTMANN,GLOBAL-OSTMANN \?L99
	PRINTI """"
	PRINTD OSTMANN
	PRINTI " would love to buy the farm, but we turned him down. Our roots are[RWD_ID: people:463, VAL: 1] here, even though this part of the county is getting so suburban. Some think it's past time to make a move upcounty. Most of the Club has moved already. "
	PRINTD OSTMANN
	PRINTR " wanted to develop the land as town houses. Imagine that!"""
?L99:	IN? PRSI,HERE \?L102
	PRINTD MICHAEL
	PRINTI " glances toward "
	CALL DPRINT,PRSI
	PRINTR ". ""What a rude question! Are you hoping I'll say something derogatory and start a shouting match?"""
?L102:	EQUAL? PRSI,GLOBAL-RICHARD \?L105
	PRINTI """It's common knowledge Richard and I have our disagreements. "
	PRINTD VERONICA
	PRINTR " tries to keep him in line, but you know how it is sometimes between brother and sister. Linda is another problem. She just doesn't fit in this sort of group."""
?L105:	EQUAL? PRSI,GLOBAL-LINDA \?L108
	PRINT I-DONT-KNOW
	PRINTR "why Richard keeps company with her. Well, I suppose I do. But have you ever talked to her? With a good tail wind she has an outside chance at a two-digit IQ."" He shakes his head ruefully. ""Richard is still a bit immature."""
?L108:	EQUAL? PRSI,GLOBAL-COCHRANE \?L111
	PRINTI """The fellow is a crook. I hear he's going up before"
	PRINT REAL-ESTATE-BOARD
	PRINTI " for unethical practices. He and "
	PRINTD OSTMANN
	PRINTR " hate each other, if you believe the stories. I certainly didn't invite him, but I'm not going to throw him out and make a scene."""
?L111:	EQUAL? PRSI,GLOBAL-BUTLER \?L114
	PRINTI """"
	PRINTD BUTLER
	PRINTI " has been with us forever. He worked for "
	PRINTD VERONICA
	PRINTR "'s parents when they were still alive. He's lived on the farm for most of his life."""
?L114:	EQUAL? PRSI,GLOBAL-BARTENDER \?L117
	CALL I-DONT-KNOW-ABOUT,STR?164,0
	PRINTD VERONICA
	PRINTR " hired him from some agency for the party. He mixes a pretty good martini, I can say that."""
?L117:	PRINTR """I can't say much one way or the other."""
?L44:	EQUAL? PRSA,V?SHOW /?L124
	EQUAL? PRSA,V?$0024DISCOVER \FALSE
	IN? MICHAEL,HERE \FALSE
	IN? MICHAEL,OFFICE /FALSE
?L124:	EQUAL? PRSO,CORPSE \?L125
	CALL REVEAL-MURDER,MICHAEL >STACK
	ZERO? STACK /?L127
	PRINTD MICHAEL
	PRINTI " stares at the corpse, stunned. He rushes over, cradles the body in his arms, and seems about to cry. Then, suddenly, he turns to you: ""Did you do this?"
	PRINT CALLING-POLICE
	CALL GLOBAL-IN?,TELEPHONE,HERE >STACK
	ZERO? STACK /?L131
	CALL TELL-MICHAEL-CALLS-POLICE
?L131:	CRLF
	RTRUE
?L127:	PRINTR "He looks away. ""I can't bear it,"" he says, trying to compose himself."
?L125:	FSET? PRSO,MICHAELBIT \FALSE
	FCLEAR PRSO,MICHAELBIT
	INC 'MICHAEL-SEEN
	CALL QUEUE,I-FLEE,5 >STACK
	PUT STACK,0,1
	PRINTR """I have no idea what this has to do with me."""

	.FUNCT TELL-MICHAEL-CALLS-POLICE
	PRINTD MICHAEL
	PRINTI " picks up the telephone and calls the police."
	FSET? MICHAEL,TOLD \TRUE
	PRINTI " His voice breaks towards the end."
	RTRUE

	.FUNCT G-MICHAEL,GARG,L,BODY?=0
	LOC MICHAEL >L
	ZERO? GARG \?L1
	CALL IMOVEMENT,MICHAEL,G-MICHAEL >STACK
	RSTACK
?L1:	EQUAL? GARG,G-IMPATIENT \?L3
	EQUAL? L,HERE,OFFICE /FALSE
	EQUAL? L,LIBRARY \?L6
	FCLEAR LIBRARY-DOOR,LOCKED
	RFALSE
?L6:	PRINTD MICHAEL
	PRINTI " is looking "
	EQUAL? L,GARAGE \?L10
	PRINTR "angry and impatient."
?L10:	FSET? MICHAEL,TOLD \?L14
	PRINTR "impatient, nervous, and distraught."
?L14:	PRINTR "very bored with all this."
?L3:	EQUAL? GARG,G-REACHED,G-ALREADY \FALSE
	EQUAL? L,BALLROOM-5 \?L21
	IN? ALICIA,BALLROOM-5 \?L21
	CALL THEY-DANCE,MICHAEL >STACK
	RSTACK
?L21:	EQUAL? L,BALLROOM-8 \?L23
	ZERO? PARTY-OVER \?L23
	CALL NEW-SCRIPT,MICHAEL,MICHAEL-LOOP
	RFALSE
?L23:	EQUAL? L,BALLROOM-9 \?L24
	ZERO? OFFICE-EXPEDITION? \?L24
	CALL GOALS?,MICHAEL,0
	CALL ESTABLISH-GOAL,COL-MARSTON,BALLROOM-9,1
	CALL ESTABLISH-GOAL,COCHRANE,BALLROOM-9,1
	CALL QUEUE,I-ARGUMENT,5 >STACK
	PUT STACK,0,1
	RFALSE
?L24:	EQUAL? L,GARAGE \?L25
	CALL QUEUE,I-MICHAEL-HIDES-FOLDER,1 >STACK
	PUT STACK,0,1
	RFALSE
?L25:	EQUAL? L,HALLWAY-3 \?L26
	ZERO? THREE-STOOGES-IN-OFFICE? \?L26
	CALL GOALS?,MICHAEL,0
	IN? COCHRANE,HALLWAY-3 \FALSE
	IN? COL-MARSTON,HALLWAY-3 \FALSE
	CALL GANGS-ALL-HERE >STACK
	RSTACK
?L26:	EQUAL? L,OFFICE \?L30
	SET 'THREE-STOOGES-IN-OFFICE?,1
	CALL ESTABLISH-GOAL,MICHAEL,LIVING-ROOM
	CALL GRAB-ATTENTION,MICHAEL
	ZERO? MURDER-PUBLIC? \FALSE
	CALL META-LOC,CORPSE >STACK
	EQUAL? STACK,OFFICE /?L33
	SET 'BODY?,0
	JUMP ?L34
?L33:	SET 'BODY?,1
?L34:	ZERO? BODY? /?L35
	FCLEAR MICHAEL,TOLD
	CALL REVEAL-MURDER,MICHAEL
	JUMP ?L37
?L35:	SET 'MURDER-PUBLIC?,1
	CALL QUEUE,I-POLICE-ARRIVE,25 >STACK
	PUT STACK,0,1
?L37:	EQUAL? L,HERE \FALSE
	ZERO? BODY? /?L40
	CALL TELL-LOOK-AROUND
	PRINTI "The three of them start to search the room, examine the body, and so on. Then "
	PRINTD MICHAEL
	PRINTI " says, ""Wait! This is a job for the police! Don't touch anything!"" The others agree, though "
	CALL DPRINT,COCHRANE
	PRINTI " takes some convincing. "
	CALL TELL-MICHAEL-CALLS-POLICE
	CRLF
	RTRUE
?L40:	CALL TELL-LOOK-AROUND
	PRINTD MICHAEL
	PRINTI " is particularly shocked. ""There must have been a prowler in here, or maybe some kids out for a thrill."" He looks around some more. "
	IN? FAIRY-MASK,L \?L47
	PRINTI """"
	PRINTD VERONICA
	PRINTI "'s mask is here!"" he says. "
?L47:	IN? ROPE,L \?L52
	PRINTI """And isn't that your rope?"" He asks you. "
?L52:	PRINTI "He seems puzzled. ""Nothing seems to be taken."
	PRINT CALLING-POLICE
	PRINTR " He does so."
?L30:	EQUAL? L,LIBRARY \?L61
	IN? COL-MARSTON,LIBRARY \?L62
	CALL LIBRARY-MEETING,MICHAEL >STACK
	RSTACK
?L62:	CALL GOALS?,MICHAEL,0
	RFALSE
?L61:	ZERO? FLEEING? /?L65
	EQUAL? L,SITTING-ROOM \?L65
	CALL UNPRIORITIZE,MICHAEL
	IN? ALICIA,L \?L66
	CALL GOALS?,ALICIA,1
	CALL ESTABLISH-GOAL,ALICIA,BARN,1
	CALL ESTABLISH-GOAL,MICHAEL,BARN,1
	RFALSE
?L66:	CALL GOALS?,MICHAEL,0
	RFALSE
?L65:	EQUAL? L,BARN \FALSE
	CALL GOALS?,MICHAEL,0
	CALL BARN-DANCE,MICHAEL >STACK
	RSTACK

	.FUNCT TELL-LOOK-AROUND
	PRINTD MICHAEL
	PRINTI " and the others look around the room, startled. They see the total wreck of the office. "
	RTRUE

	.FUNCT I-MICHAEL-HIDES-FOLDER
	EQUAL? HERE,GARAGE \?L1
	ZERO? PLAYER-HIDING \?L1
	CALL LISTENING?,MICHAEL >STACK
	ZERO? STACK /?L3
	PRINTI """Get out of here!"" "
	PRINTD MICHAEL
	PRINTR " screams."
?L3:	SET 'MICHAEL-TO-GARAGE?,0
	CALL QUEUE,I-MICHAEL-TO-GARAGE,25 >STACK
	PUT STACK,0,1
	CALL ESTABLISH-GOAL,MICHAEL,BALLROOM-9,1
	CALL GRAB-ATTENTION,MICHAEL
	PRINTD MICHAEL
	PRINTI " eyes you suspiciously. ""What are you doing in here?"" he asks."
	FSET? BMW-TRUNK,OPENBIT /?L12
	IN? CROWBAR,PLAYER /?L12
	FIRST? BMW-TRUNK >STACK \?L10
?L12:	PRINTI " ""Have you been fooling with my car? What are you doing in here! I'll have you thrown out!"" He seems serious."
?L10:	FSET? MICHAEL,TOLD \?L16
	PRINTI " ""Are you trying to hide something? You've been acting pretty oddly. Did you kill my wife?"" He breaks off, torn between several courses of action."
?L16:	PRINTR " Finally he just says ""Get out of here!"""
?L1:	CALL QUEUE,I-LIBRARY-MEETING,20 >STACK
	PUT STACK,0,1
	FIRST? BMW-TRUNK >STACK /?L24
	FSET? BMW-TRUNK,OPENBIT /?L24
	FSET BMW-TRUNK,LOCKED
	MOVE TRUST-FOLDER,BMW-TRUNK
	FCLEAR TRUST-FOLDER,INVISIBLE
	EQUAL? HERE,GARAGE \FALSE
	CALL TELL-MIKE-WALKS
	PRINTR ", and after a few seconds, closes it again. Unfortunately, the trunk lid blocks your view of what he was doing when the trunk was open."
?L24:	REMOVE TRUST-FOLDER
	EQUAL? HERE,GARAGE \FALSE
	CALL TELL-MIKE-WALKS
	PRINTR ", and becomes extremely agitated. He looks around, fails to see you, and stands for a moment, confused."

	.FUNCT TELL-MIKE-WALKS
	PRINTD MICHAEL
	PRINTI " walks to the rear of the BMW, "
	FSET? BMW-TRUNK,OPENBIT \?L3
	PRINTI "notices the trunk is open"
	RTRUE
?L3:	PRINTI "opens the trunk"
	RTRUE

	.FUNCT I-LIBRARY-MEETING
	CALL ESTABLISH-GOAL,MICHAEL,LIBRARY,1
	CALL ESTABLISH-GOAL,COL-MARSTON,LIBRARY,1
	RFALSE

	.FUNCT TELL-THREE-STOOGES
	PRINTD MICHAEL
	PRINTI ", "
	PRINTD COL-MARSTON
	PRINTI ", and "
	PRINTD COCHRANE
	RTRUE

	.FUNCT TELL-THREE-ARRIVE,KNEW?
	EQUAL? HERE,OFFICE,HALLWAY-3 \?L1
	FSET PLAYER,TOLD
	CALL TELL-THREE-STOOGES
	PRINTI " arrive at the office door. "
	PRINTD COL-MARSTON
	PRINTI " glances through the door. ""Look in there!"" he cries. ""The place is a shambles!"
	ZERO? KNEW? /?L5
	PRINTI " It must be true, then!"
?L5:	EQUAL? HERE,OFFICE \?L10
	PRINTI """ They see you"
	JUMP ?L14
?L10:	PRINTI """ "
	PRINTD MICHAEL
	PRINTI " and "
	PRINTD COCHRANE
	PRINTI " look startled as well"
?L14:	PRINT THREE-CROWD
	CRLF
	RTRUE
?L1:	CALL CORRIDOR-LOOK,MICHAEL >STACK
	ZERO? STACK /FALSE
	CALL TELL-THREE-STOOGES
	PRINTI " are down the hall, in front of the office. "
	PRINTD COL-MARSTON
	PRINTI " shouts"
	PRINT THREE-CROWD
	CRLF
	RTRUE

	.FUNCT GANGS-ALL-HERE,KNEW=0
	ZERO? GANG-BEEN-TO-OFFICE? \FALSE
	SET 'GANG-BEEN-TO-OFFICE?,1
	CALL UNPRIORITIZE,MICHAEL
	CALL ESTABLISH-GOAL,MICHAEL,OFFICE,1
	CALL UNPRIORITIZE,COCHRANE
	CALL ESTABLISH-GOAL,COCHRANE,OFFICE,1
	CALL UNPRIORITIZE,COL-MARSTON
	CALL ESTABLISH-GOAL,COL-MARSTON,OFFICE,1
	FSET? MICHAEL,TOLD /?L6
	FSET? COCHRANE,TOLD /?L6
	FSET? COL-MARSTON,TOLD \?L4
?L6:	SET 'KNEW,1
?L4:	CALL META-LOC,CORPSE >STACK
	EQUAL? STACK,OFFICE \?L8
	FSET MICHAEL,TOLD
	FSET COL-MARSTON,TOLD
	FSET COCHRANE,TOLD
?L8:	FSET? SOUTH-OFFICE-DOOR,OPENBIT \?L11
	CALL TELL-THREE-ARRIVE,KNEW >STACK
	RSTACK
?L11:	FCLEAR SOUTH-OFFICE-DOOR,LOCKED
	FSET SOUTH-OFFICE-DOOR,OPENBIT
	EQUAL? HERE,OFFICE \?L14
	PRINTI "Outside, you hear voices. "
	ZERO? KNEW \?L18
	PRINTI " You hear someone say,"
	PRINT LET-ME
	PRINT THERE-IS
	PRINTI "a pause."
	PRINT I-HAD-THEM
	PRINTI "Another pause. The doorknob turns."
	PRINT WAIT-A-MINUTE
?L18:	PRINTI "The door opens, revealing "
	CALL TELL-THREE-STOOGES
	PRINTR ". They crowd forward."
?L14:	EQUAL? HERE,HALLWAY-3 \?L27
	FSET PLAYER,TOLD
	ZERO? KNEW /?L28
	PRINTD MICHAEL
	PRINTR " says, ""If it's true, I can take it, just let me go in."" He opens the door, and the three of them crowd around."
?L28:	PRINTD MICHAEL
	PRINTI " says,"
	PRINT LET-ME
	PRINTI "He roots around underneath his robes for a moment, obviously trying to find his keys. He clearly can't find them."
	PRINT I-HAD-THEM
	PRINTI "He gets more and more frantic."
	PRINT WAIT-A-MINUTE
	PRINTD MICHAEL
	PRINTR " throws open the door of the office, the others crowding closely around him."
?L27:	CALL CORRIDOR-LOOK,MICHAEL >STACK
	ZERO? STACK /FALSE
	PRINTI "You see, at the office door, a group which includes "
	CALL TELL-THREE-STOOGES
	PRINTI ". "
	PRINTD MICHAEL
	ZERO? KNEW \?L40
	PRINTI " is looking for something in his robes, getting more and more frantic. Then, suddenly, he"
?L40:	PRINTR " opens the door, and the other two crowd around him, staring into the office."

	.FUNCT LIBRARY-MEETING,LAST,FIRST
	EQUAL? LAST,MICHAEL \?L1
	SET 'FIRST,COL-MARSTON
	JUMP ?L3
?L1:	SET 'FIRST,MICHAEL
?L3:	FCLEAR LIBRARY-DOOR,OPENBIT
	FCLEAR LH-DOOR,OPENBIT
	FSET LIBRARY-DOOR,LOCKED
	FSET LH-DOOR,LOCKED
	MOVE INVESTOR-LIST,COL-MARSTON
	CALL QUEUE,I-END-MEETING,2 >STACK
	PUT STACK,0,1
	CALL META-LOC,PLAYER >STACK
	EQUAL? STACK,LIBRARY \FALSE
	CALL DPRINT,LAST
	PRINTI " enters the library. "
	EQUAL? PLAYER-HIDING,CHAIR \?L9
	PRINTD MICHAEL
	PRINTI " and "
	PRINTD COL-MARSTON
	PRINTI " greet each other, then glance suspiciously around the room. They do not see you hiding behind the overstuffed chair. "
	PRINTD MICHAEL
	PRINTR " closes and locks the doors. He then passes the Colonel a piece of paper, which the latter avidly scans, then folds up and stuffs into a pocket. Both men grin."
?L9:	CALL META-LOC,PLAYER >STACK
	EQUAL? STACK,LIBRARY \FALSE
	CALL GRAB-ATTENTION,MICHAEL,2
	CALL GRAB-ATTENTION,COL-MARSTON,2
	PRINTI "He seems surprised to see you. "
	CALL DPRINT,FIRST
	PRINTI " looks at him and shrugs his shoulders. ""Please leave us. We have some private business to transact. I'm sure you understand,"" says "
	PRINTD MICHAEL
	PRINTI ". The two of them unceremoniously show you the door."
	CRLF
	CALL GOTO,HALLWAY-16
	RTRUE

	.FUNCT I-END-MEETING
	CALL UNPRIORITIZE,COL-MARSTON
	CALL ESTABLISH-GOAL,COL-MARSTON,BALLROOM-8,1
	CALL UNPRIORITIZE,MICHAEL
	CALL ESTABLISH-GOAL,MICHAEL,BALLROOM-8,1
	RFALSE

	.FUNCT I-ARGUMENT,S,FLG=0
	ZERO? OFFICE-EXPEDITION? \?L1
	FSET? MICHAEL,TOLD /?L20
	IN? MICHAEL,BALLROOM-9 \?L1
	IN? COL-MARSTON,BALLROOM-9 \?L1
	IN? COCHRANE,BALLROOM-9 \?L1
	GET ARGUMENT-TABLE,ARGUMENT-COUNT >S
	EQUAL? HERE,BALLROOM-9 \?L3
	SET 'FLG,1
	PRINT S
	CRLF
	JUMP ?L11
?L3:	CALL IN-BALLROOM?,PLAYER >STACK
	ZERO? STACK /?L7
	SET 'FLG,1
	PRINT SEEMS-TO-BE
	CALL PRINTA,DISCUSSION
	PRINTI " going on at the bar."
	CRLF
	JUMP ?L11
?L7:	ZERO? ARGUMENT-COUNT \?L11
	DEC 'ARGUMENT-POSTPONE
	GRTR? ARGUMENT-POSTPONE,0 \?L11
	CALL QUEUE,I-ARGUMENT,2
	RFALSE
?L11:	INC 'ARGUMENT-COUNT
	GET ARGUMENT-TABLE,ARGUMENT-COUNT >S
	ZERO? S /?L15
	CALL QUEUE,I-ARGUMENT,1
	RETURN FLG
?L15:	SET 'ARGUMENT-COUNT,0
	SET 'OFFICE-EXPEDITION?,1
	CALL THIS-IS-S-HE,MICHAEL
	CALL ESTABLISH-GOAL,MICHAEL,HALLWAY-3,1
	CALL ESTABLISH-GOAL,COL-MARSTON,HALLWAY-3,1
	CALL ESTABLISH-GOAL,COCHRANE,HALLWAY-3,1
	RETURN FLG
?L1:	FSET? MICHAEL,TOLD \?L18
?L20:	SET 'OFFICE-EXPEDITION?,1
	SET 'ARGUMENT-COUNT,0
	RFALSE
?L18:	CALL QUEUE,I-ARGUMENT,5
	RFALSE

	.FUNCT VERONICA-UNMASKED?
	GETP VERONICA,P?SDESC >STACK
	EQUAL? STACK,VERONICA-SDESC \FALSE
	RTRUE

	.FUNCT VERONICA-UNMASKS
	FCLEAR VERONICA,THE
	PUTP VERONICA,P?SDESC,VERONICA-SDESC
	FCLEAR GLOBAL-VERONICA,THE
	PUTP GLOBAL-VERONICA,P?SDESC,VERONICA-SDESC
	RTRUE

	.FUNCT GLOBAL-VERONICA-F
	LOC VERONICA >STACK
	ZERO? STACK \?L1
	CALL META-LOC,CORPSE >STACK
	EQUAL? STACK,HERE \?L1
	EQUAL? PRSA,V?ASK-ABOUT,V?TELL-ME /?L1
	EQUAL? PRSI,GLOBAL-VERONICA \?L3
	PUSH CORPSE
	JUMP ?L5
?L3:	PUSH PRSI
?L5:	EQUAL? PRSO,GLOBAL-VERONICA \?L6
	PUSH CORPSE
	JUMP ?L8
?L6:	PUSH PRSO
?L8:	CALL PERFORM,PRSA,STACK,STACK
	RTRUE
?L1:	CALL GLOBAL-PERSON-F >STACK
	RSTACK

	.FUNCT GENERIC-VERONICA-F,NAM
	EQUAL? NAM,W?COSTUME /?L1
	RETURN VERONICA
?L1:	CALL GENERIC-STUFF-F,NAM >STACK
	RSTACK

	.FUNCT VERONICA-DESC-F,RARG=0
	PRINTI "Titania, Queen of Faery,"
	CALL VERONICA-UNMASKED? >STACK
	ZERO? STACK /?L3
	PRINTI " in the person of "
	PRINTD VERONICA
	PRINTI ","
?L3:	PRINTI " is"
	CALL TELL-HERE >STACK
	RSTACK

	.FUNCT TELL-IGNORES
	PRINTI "She"
	PRINT IGNORES-YOU
	PRINTR "."

	.FUNCT LONG-MASK-DESC
	PRINTR " It covers the entire head with a glittery silver stocking. The hair is silver and gold wire streaming out behind as though blown by the wind. The ears are silvered butterfly wings, and the eyebrows turn up into antennae."

	.FUNCT VERONICA-F
	EQUAL? WINNER,VERONICA \?L1
	EQUAL? PRSA,V?WHAT \?L3
	EQUAL? PRSO,YOU \FALSE
	PRINTR """I'm Queen of Faery, stupid!"" she growls."
?L3:	EQUAL? PRSA,V?HELLO \?L10
	PRINTR "She pauses for a moment and greets you."
?L10:	CALL DONT-HANDLE? >STACK
	ZERO? STACK \FALSE
	CALL TELL-IGNORES >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?WAIT,V?$0024CALL \?L15
	CALL TELL-IGNORES >STACK
	RSTACK
?L15:	EQUAL? PRSA,V?EXAMINE \?L16
	CALL VERONICA-UNMASKED? >STACK
	ZERO? STACK /?L17
	PRINTD VERONICA
	PRINTI " Ashcroft"
	JUMP ?L21
?L17:	PRINTI "Titania, Queen of Faery"
?L21:	PRINTI " is in her early thirties, about 5'3"" in height,[RWD_ID: people:995, VAL: 1] weighing about 100 pounds. She is wearing a voluminous white gown and silvered fairy wings. Her mask is quite striking."
	CALL LONG-MASK-DESC >STACK
	RSTACK
?L16:	EQUAL? PRSA,V?CUT,V?TAKE /?L27
	EQUAL? PRSA,V?KILL,V?ATTACK,V?UNMASK \?L26
?L27:	PRINTI """Stop that! "
	PRINTD MICHAEL
	PRINTI ", help me!"""
	EQUAL? PRSA,V?KILL,V?ATTACK /?L30
	PUSH 0
	JUMP ?L31
?L30:	PUSH 1
?L31:	CALL PRINT-ID,STR?165,STACK
	EQUAL? PRSA,V?CUT,V?TAKE,V?UNMASK /?L32
	PUSH 0
	JUMP ?L33
?L32:	PUSH 1
?L33:	CALL PRINT-ID,STR?166,STACK
	IN? MICHAEL,HERE \?L34
	PRINTI " "
	PRINTD MICHAEL
	PRINTI " restrains you, a quizzical look in his eye."
?L34:	CRLF
	RTRUE
?L26:	EQUAL? PRSA,V?BRUSH,V?RUB,V?HELP \?L39
	PRINTI "She fends you off, angrily. ""I don't need any help from you!"""
	CRLF
	EQUAL? PRSA,V?BRUSH,V?RUB /?L42
	PUSH 0
	JUMP ?L43
?L42:	PUSH 1
?L43:	CALL PRINT-ID,STR?167,STACK >STACK
	RSTACK
?L39:	EQUAL? PRSA,V?ASK-ABOUT \?L44
	EQUAL? PRSO,VERONICA \?L44
	CALL TELL-IGNORES >STACK
	RSTACK
?L44:	EQUAL? PRSA,V?DANCE \FALSE
	PRINTR """Some other time."" You get the impression this will be soon after the first ski resort opens in the infernal regions."

	.FUNCT G-VERONICA,GARG
	ZERO? GARG \?L1
	CALL IMOVEMENT,VERONICA,G-VERONICA >STACK
	RSTACK
?L1:	EQUAL? GARG,G-REACHED,G-ALREADY \FALSE
	IN? VERONICA,OFFICE \FALSE
	MOD PRESENT-TIME,5 >STACK
	SUB PRESENT-TIME,STACK >STACK
	ADD STACK,5 >YELL-TIME
	CALL QUEUE,I-ALICIA-SNEAKS,2 >STACK
	PUT STACK,0,1
	MOVE FAIRY-COSTUME,CORPSE
	MOVE FAIRY-MASK,OFFICE
	FCLEAR FAIRY-MASK,NDESCBIT
	MOVE STAIN,CORPSE
	MOVE HAIR,FAIRY-MASK
	REMOVE VERONICA
	FSET VERONICA,NDESCBIT
	RFALSE

	.FUNCT CORPSE-DESC-F,RARG=0
	FSET WINNER,TOLD
	FSET? CORPSE,TOUCHBIT /?L1
	PRINTI "Slumped behind "
	CALL THE-PRINT,LARGE-DESK
	PRINTI " is the body of "
	PRINTD VERONICA
	PRINTI " Ashcroft."
	IN? FAIRY-MASK,CORPSE /?L5
	PRINTI " Her mask has been pulled off, though the rest of the costume is intact."
?L5:	FSET? ROPE,NDESCBIT \?L10
	REMOVE NOT-ROPE
	PRINTI " Around her neck is the agent of death, a rope. In fact, it's your lariat, which you got tired of carrying around and hung in the closet with your coat."
?L10:	CRLF
	RTRUE
?L1:	PRINTI "Lying in a heap is the body of "
	PRINTD VERONICA
	PRINTI " Ashcroft, strangled"
	FSET? ROPE,NDESCBIT \?L18
	REMOVE NOT-ROPE
	PRINTI " with a cowboy's lariat"
?L18:	PRINTR "."

	.FUNCT TALKING-TO?,PER
	EQUAL? PRSA,V?$0024REVEAL,V?REVEAL,V?SHOW \?L1
	EQUAL? PRSI,PER /TRUE
	RFALSE
?L1:	EQUAL? PRSA,V?HELLO,V?TELL-ME /?L7
	EQUAL? PRSA,V?ASK-FOR,V?ASK-ABOUT,V?$0024CALL \FALSE
?L7:	EQUAL? PRSO,PER /TRUE
	RFALSE

	.FUNCT CORPSE-F
	EQUAL? WINNER,CORPSE /?L3
	EQUAL? PRSA,V?TELL \?L1
	EQUAL? PRSO,CORPSE \?L1
?L3:	SET 'P-CONT,0
	SET 'QUOTE-FLAG,0
	PRINTR "At this point, it would take a seance."
?L1:	CALL TALKING-TO?,CORPSE >STACK
	ZERO? STACK /?L6
	PRINTR "For obvious reasons, there is no response."
?L6:	EQUAL? PRSA,V?SHOW \?L9
	EQUAL? PRSO,CORPSE \?L9
	FSET? PRSI,PERSON \?L9
	EQUAL? PRSI,PLAYER /?L9
	CALL REVEAL-MURDER,PRSI
	CALL DPRINT,PRSI,1
	PRINTI " recoils in horror. ""No!"
	PRINT CALLING-POLICE
	PRINTI " "
	CALL HE$002fSHE-PRINT,PRSI
	PRINTR " says."
?L9:	EQUAL? PRSA,V?DANCE \?L12
	PRINT HAVE-TO
	PRINTR "lead, you can be sure of that."
?L12:	EQUAL? PRSA,V?EXAMINE \?L15
	PRINTD VERONICA
	PRINTI " is still wearing her costume, stained with whatever she was drinking."
	IN? FAIRY-MASK,CORPSE /?L18
	PRINTI " Her mask has been removed."
?L18:	PRINTI " She was obviously strangled"
	IN? CORPSE,OFFICE \?L25
	PRINTI ", but there are few signs of a struggle"
?L25:	PRINTR "."
?L15:	EQUAL? PRSA,V?ALARM,V?BRUSH,V?HELP \?L32
	PRINTI "It's too late to help "
	PRINTD VERONICA
	PRINTR " now."
?L32:	EQUAL? PRSA,V?LISTEN \?L35
	PRINT THERE-IS
	PRINTR "no sign of breathing."
?L35:	EQUAL? PRSA,V?RUB \?L38
	PRINTI "The body is "
	CALL PRINT-ID,STR?168
	LESS? PRESENT-TIME,570 \?L41
	PRINTR "still warm."
?L41:	LESS? PRESENT-TIME,630 \?L45
	PRINTR "cooling off."
?L45:	PRINTR "cold."
?L38:	EQUAL? PRSA,V?SEARCH,V?RAISE,V?LOOK-UNDER \?L51
	IN? BULLET,CORPSE \?L52
	FCLEAR BULLET,INVISIBLE
	MOVE BULLET,HERE
	PRINTR "As you look under the body, you notice a small object on the floor beneath it."
?L52:	EQUAL? PRSA,V?SEARCH \FALSE
	PRINTR "A search reveals nothing beyond what was first apparent."
?L51:	EQUAL? PRSA,V?MOVE,V?TAKE \?L60
	EQUAL? PRSO,CORPSE \?L60
	IN? DETECTIVE,HERE \?L61
	CALL THE-PRINT,DETECTIVE,1
	PRINT STOPS-YOU
	CRLF
	RTRUE
?L61:	IN? DUFFY,HERE \?L65
	PRINTD DUFFY
	PRINT STOPS-YOU
	CRLF
	RTRUE
?L65:	EQUAL? PRSA,V?MOVE /?L72
	CALL ITAKE >STACK
	EQUAL? STACK,M-HANDLED \TRUE
	EQUAL? PRSA,V?MOVE \?L70
?L72:	PRINTI "Moved"
	CALL PRINT-ID,STR?169
	JUMP ?L74
?L70:	SET 'PLAYER-MOVED-BODY?,1
	PRINTI "Taken"
	CALL PRINT-ID,STR?170
?L74:	PRINTI ", but the body is heavy."
	FCLEAR ROPE,NDESCBIT
	IN? BULLET,CORPSE \?L79
	FCLEAR BULLET,INVISIBLE
	MOVE BULLET,HERE
	PRINTI " As you move the body a small object drops to the floor beneath it."
?L79:	CRLF
	RTRUE
?L60:	EQUAL? PRSA,V?DROP \?L85
	MOVE PRSO,HERE
	PRINTR "The body drops like a sack of potatoes."
?L85:	EQUAL? PRSA,V?MUNG,V?THROW,V?POUR-ON \?L88
	PRINTI "That might destroy evidence."
	CRLF
	CALL PRINT-ID,STR?171 >STACK
	RSTACK
?L88:	EQUAL? PRSA,V?TIE-TO,V?TIE-WITH /?L92
	EQUAL? PRSA,V?ATTACK,V?KILL,V?SLAP \?L91
?L92:	EQUAL? PRSO,CORPSE \?L91
	PRINTI "She's quite dead already, you know."
	CRLF
	CALL PRINT-ID,STR?172 >STACK
	RSTACK
?L91:	EQUAL? PRSA,V?THROW-AT \?L95
	EQUAL? PRSI,CORPSE \?L95
	MOVE PRSO,HERE
	PRINTR "That wasn't very sporting."
?L95:	EQUAL? PRSA,V?WALK-TO \?L98
	FSET? WINNER,TOLD /?L98
	PRINTR "What corpse?"
?L98:	EQUAL? PRSA,V?PUT \FALSE
	EQUAL? PRSI,CORPSE \FALSE
	EQUAL? PRSO,FAIRY-MASK /FALSE
	CALL TELL-WONT-FIT >STACK
	RSTACK

	.FUNCT TELL-WONT-FIT
	PRINTR "It won't fit."

	.FUNCT BULLET-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "It looks just like the ones"
	PRINT IN-GUNBELT
	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?COUNT \?L5
	CALL META-LOC,GUNBELT >STACK
	EQUAL? STACK,HERE \?L6
	IN? BULLET,GUNBELT \?L8
	PRINTR "All the loops have bullets in them."
?L8:	PRINT SEEMS-TO-BE
	PRINTI "one empty loop"
	PRINT IN-GUNBELT
	CRLF
	RTRUE
?L6:	PRINTR "One."
?L5:	EQUAL? PRSA,V?PUT \?L18
	EQUAL? PRSI,GUNBELT \?L18
	IN? BULLET,GUNBELT \?L19
	PRINTI "All the bullets are"
	PRINT IN-GUNBELT
	CRLF
	RTRUE
?L19:	FSET BULLET,NDESCBIT
	MOVE BULLET,GUNBELT
	PRINTR "Okay, each loop of the belt now has a bullet in it."
?L18:	EQUAL? PRSA,V?TAKE \?L26
	CALL DONT-TAKE-EVIDENCE,BULLET >STACK
	ZERO? STACK \TRUE
	IN? BULLET,GUNBELT \?L29
	FCLEAR BULLET,NDESCBIT
	JUMP ?L30
?L29:	EQUAL? PRSI,GUNBELT \?L30
	PRINTI "Isn't one enough? "
	PRINT DO-YOU-WANT-TO
	PRINTR "scatter them all over?"
?L30:	FSET BULLET,RMUNGBIT
	RFALSE
?L26:	EQUAL? PRSA,V?BRUSH \FALSE
	FCLEAR BULLET,RMUNGBIT
	PRINTR "It's now shiny clean again."

	.FUNCT FAIRY-COSTUME-F,DEAD?
	IN? FAIRY-COSTUME,CORPSE /?L1
	SET 'DEAD?,0
	JUMP ?L2
?L1:	SET 'DEAD?,1
?L2:	EQUAL? PRSA,V?EXAMINE \?L3
	PRINTI "This is a gossamer "
	PRINTD FAIRY-COSTUME
	PRINTI ", intended to represent Titania, Queen of Faery. It has a silver belt. On the back are fairy wings"
	ZERO? DEAD? /?L7
	PRINTI ", now crushed"
?L7:	PRINTR ". The beauty of the costume is marred by a large red stain on the front."
?L3:	EQUAL? PRSA,V?TAKE \FALSE
	PRINTI "Taking the costume would get you into even deeper trouble than you are in now."
	CRLF
	CALL PRINT-ID,STR?173 >STACK
	RSTACK

	.FUNCT STAIN-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "The large red stain spreads over the front of the costume."

	.FUNCT FAIRY-MASK-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "This is a very ornate and beautiful mask."
	CALL LONG-MASK-DESC >STACK
	RSTACK
?L1:	IN? FAIRY-MASK,VERONICA \?L5
	EQUAL? PRSA,V?MOVE,V?LOOK-BEHIND,V?RUB /?L6
	EQUAL? PRSA,V?LOOK-UNDER,V?LOOK-INSIDE,V?TAKE \?L5
?L6:	PRINTI "As you reach for the mask, "
	PRINTD VERONICA
	PRINTI " pulls back, surprised."
	CALL PRINT-ID,STR?174
	IN? MICHAEL,HERE \?L9
	PRINTI " "
	PRINTD MICHAEL
	PRINTI " knocks your hand away. ""What do you think you're doing?"" he says angrily. ""Are you trying to hurt my wife?"""
?L9:	CRLF
	RTRUE
?L5:	EQUAL? PRSA,V?TAKE \?L14
	FCLEAR FAIRY-MASK,WEARBIT
	RFALSE
?L14:	EQUAL? PRSA,V?PUT \?L15
	EQUAL? PRSI,CORPSE \?L15
	MOVE FAIRY-MASK,CORPSE
	FSET FAIRY-MASK,WEARBIT
	PRINTR "Okay, the mask is on the body."
?L15:	EQUAL? PRSA,V?SEARCH,V?LOOK-INSIDE /?L19
	EQUAL? PRSA,V?SEARCH-OBJECT-FOR \FALSE
	EQUAL? PRSO,FAIRY-MASK \FALSE
?L19:	IN? FAIRY-MASK,WINNER \?L20
	PRINTI "The inside of the mask is slightly damp with sweat.[RWD_ID: people:1306, VAL: 1]"
	IN? HAIR,FAIRY-MASK \?L24
	FSET? HAIR,TOUCHBIT /?L24
	FCLEAR HAIR,INVISIBLE
	PRINTI " Caught in the silver mesh is "
	CALL PRINTA,HAIR
	CALL PRINT-CONTENTS,FAIRY-MASK,STR?175,HAIR
	PRINTR "."
?L24:	CALL PRINT-CONTENTS,FAIRY-MASK,STR?176 >STACK
	ZERO? STACK /?L30
	PRINTI "."
?L30:	CRLF
	RTRUE
?L20:	PRINT YOU-DONT-HAVE
	PRINTR "it."

	.FUNCT HAIR-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "The hair is dark and medium in length."
?L1:	EQUAL? PRSA,V?COMPARE \FALSE
	EQUAL? VERONICA-HAIR,PRSO,PRSI \?L6
	CALL THEY-ARENT,STR?177 >STACK
	RSTACK
?L6:	EQUAL? ALICIA-HAIR,PRSO,PRSI \?L8
	PRINTR "The hairs look very similar in both color and length."
?L8:	EQUAL? LINDA-HAIR,PRSO,PRSI \FALSE
	PRINTR "They don't resemble each other at all."

	.FUNCT VERONICA-HAIR-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTD PRSO
	PRINTR " is short and blonde.[RWD_ID: people:1357, VAL: 1]"

	.FUNCT ALICIA-HAIR-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTD ALICIA-HAIR
	PRINTR " is medium length and dark."
?L1:	EQUAL? PRSA,V?MOVE \FALSE
	PRINTD ALICIA
	PRINTI " fends you off. ""Are you crazy?"""
	CRLF
	CALL PRINT-ID,STR?178 >STACK
	RSTACK

	.FUNCT LINDA-HAIR-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "Linda's hair is long and red."
?L1:	EQUAL? PRSA,V?MOVE \FALSE
	PRINTI "Linda pushes you away. ""Ouch!"""
	CRLF
	CALL PRINT-ID,STR?179 >STACK
	RSTACK

	.FUNCT PULSE-F
	CALL META-LOC,CORPSE >STACK
	EQUAL? STACK,HERE /?L1
	CALL NOT-HERE,PULSE >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?FIND /?L4
	EQUAL? PRSA,V?RUB,V?ANALYZE,V?TAKE \?L3
?L4:	PRINT THERE-IS
	PRINTR "no sign of life in the corpse."
?L3:	EQUAL? PRSA,V?PUT \?L7
	CALL TELL-YOU-CANT,STR?180 >STACK
	RSTACK
?L7:	EQUAL? PRSA,V?LISTEN \FALSE
	PRINTR "You hear nothing."

	.FUNCT REVEAL-MURDER,WHO,N,X,NEWS?
	FSET? WHO,TOLD /?L1
	SET 'NEWS?,1
	JUMP ?L2
?L1:	SET 'NEWS?,0
?L2:	ZERO? NEWS? /?L3
	FSET WHO,TOLD
?L3:	LOC WHO >STACK
	FIRST? STACK >X /?L6
?L6:	ZERO? X /?L8
	NEXT? X >N /?L12
?L12:	FSET? X,PERSON \?L13
	FSET? X,TOLD /?L13
	FSET X,TOLD
?L13:	SET 'X,N
	JUMP ?L6
?L8:	ZERO? MURDER-PUBLIC? \?L16
	SET 'MURDER-PUBLIC?,WHO
	FSET DETECTIVE,TOLD
	FSET DUFFY,TOLD
	CALL QUEUE,I-POLICE-ARRIVE,25 >STACK
	PUT STACK,0,1
?L16:	RETURN NEWS?

	.FUNCT POLICE-F,WHO
	EQUAL? PRSA,V?PHONE \?L1
	CALL GLOBAL-IN?,TELEPHONE,HERE >STACK
	ZERO? STACK \?L3
	PRINTR "If you yell loud enough, perhaps you can overcome the lack of a telephone."
?L3:	PRINTI "A bored desk sergeant answers the telephone. "
	ZERO? MURDER-PUBLIC? /?L10
	PRINTR "You describe the situation, but he says, ""Hey, we're sending someone over, in fact, two of our best officers are on the case."""
?L10:	FSET? OFFICE,TOUCHBIT /?L14
	PRINTR "After a few minutes of listening to you, he asks angrily if you have anything to report. Not getting a reasonable answer to that poser, he hangs up."
?L14:	CALL REVEAL-MURDER,PLAYER
	PRINTR "He becomes considerably less bored as you describe the situation. ""Don't let anyone leave,"" he says. ""There'll be someone there in no time. Don't touch anything!"""
?L1:	EQUAL? PRSA,V?WAIT-FOR \?L20
	CALL PERFORM,V?WAIT-FOR,DETECTIVE
	RTRUE
?L20:	IN? DETECTIVE,HERE \?L23
	SET 'WHO,DETECTIVE
	ZERO? WHO \?L22
?L23:	IN? DUFFY,HERE \?L21
	SET 'WHO,DUFFY
	ZERO? WHO /?L21
?L22:	EQUAL? PRSI,POLICE \?L24
	PUSH WHO
	JUMP ?L26
?L24:	PUSH PRSI
?L26:	EQUAL? PRSO,POLICE \?L27
	PUSH WHO
	JUMP ?L29
?L27:	PUSH PRSO
?L29:	CALL PERFORM,PRSA,STACK,STACK
	RTRUE
?L21:	EQUAL? PRSA,V?TELL-ME,V?ASK-ABOUT \?L30
	EQUAL? PRSI,POLICE /FALSE
?L30:	EQUAL? PRSA,V?FIND \?L31
	PRINTR "You never can find a policeman when you want one, can you?"
?L31:	EQUAL? PRSA,V?TELL \?L35
	SET 'P-CONT,0
	SET 'QUOTE-FLAG,0
?L35:	PRINT HAVE-TO
	PRINTR "find one first."

	.FUNCT ALICIA-DESC-F,RARG=0
	PRINTD ALICIA
	PRINTI ", "
	IN? ALICIA-COAT,ALICIA \?L3
	PRINTI "wearing a wet overcoat"
	JUMP ?L7
?L3:	PRINTI "dressed in harem silks"
?L7:	PRINTI ", is"
	CALL TELL-HERE >STACK
	RSTACK

	.FUNCT ALICIA-COAT-F
	EQUAL? PRSA,V?READ,V?TAKE-OFF,V?TAKE /?L3
	EQUAL? PRSA,V?EXAMINE,V?LOOK-UNDER,V?LOOK-INSIDE \?L1
?L3:	IN? ALICIA-COAT,ALICIA \?L4
	EQUAL? PRSA,V?EXAMINE /?L6
	PRINTD ALICIA
	PRINTI " draws the coat more tightly around herself. ""Just what do you think you're doing?"" she asks, frostily."
	CRLF
	CALL PRINT-ID,STR?181 >STACK
	RSTACK
?L6:	PRINTR "It's a wet overcoat."
?L4:	IN? ALICIA-COAT,BUTLER \?L13
	PRINTR "The butler has the coat now."
?L13:	EQUAL? PRSA,V?TAKE-OFF,V?TAKE /FALSE
	FCLEAR LABEL,INVISIBLE
	GETP LABEL,P?TEXT >STACK
	PRINT STACK
	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?SMELL \?L20
	PRINTR "It smells wet."
?L20:	EQUAL? PRSA,V?RUB \?L23
	PRINTR "It feels wet."
?L23:	EQUAL? PRSA,V?WEAR,V?THROUGH \FALSE
	CALL IT-DOESNT-FIT >STACK
	RSTACK

	.FUNCT ALICIA-F,HADBIT?=0
	EQUAL? WINNER,ALICIA \?L1
	EQUAL? PRSA,V?HELLO \?L3
	PRINTI """Hello. "
	PRINT YOU-MUST
	PRINTI "be the reporter "
	PRINTD VERONICA
	PRINTR " said was coming tonight."""
?L3:	EQUAL? PRSA,V?GIVE \?L7
	EQUAL? PRSO,ALICIA-COAT \?L7
	EQUAL? PRSI,BUTLER \?L7
	MOVE ALICIA-COAT,BUTLER
	FCLEAR ALICIA-COAT,NDESCBIT
	LOC ALICIA >STACK
	EQUAL? HERE,STACK \TRUE
	PRINTD ALICIA
	PRINTI " gives "
	PRINTD BUTLER
	PRINTR " her coat, which is soaking wet. Underneath she is wearing a harem girl costume which leaves little to the imagination."
?L7:	CALL DONT-HANDLE? >STACK
	ZERO? STACK \FALSE
	PRINTR """I beg your pardon?"" she replies."
?L1:	EQUAL? PRSA,V?EXAMINE \?L17
	PRINTD ALICIA
	PRINTI " Barron, a dark-haired young woman about 5'2"" tall, is dressed "
	IN? ALICIA-COAT,ALICIA \?L20
	PRINTI "in a soaking wet overcoat. "
	CALL TELL-YOU-CANT,STR?182 >STACK
	RSTACK
?L20:	PRINTR "as a harem girl. She is a slender, attractive woman. The costume is a revealing one, and she seems to be pleased with the results."
?L17:	EQUAL? PRSA,V?$0024REVEAL \?L27
	EQUAL? PRSO,GLOBAL-MURDER \?L27
	CALL REVEAL-MURDER,ALICIA
	IN? PRSI,HERE \?L28
	CALL SOMEONE-TELLS-ALICIA,1 >STACK
	RSTACK
?L28:	CALL NEARBY?,ALICIA >STACK
	ZERO? STACK /FALSE
	CALL SOMEONE-TELLS-ALICIA,0 >STACK
	RSTACK
?L27:	EQUAL? PRSA,V?REVEAL \?L32
	EQUAL? PRSO,GLOBAL-MURDER \?L32
	CALL REVEAL-MURDER,ALICIA >STACK
	ZERO? STACK /?L33
	CALL ALICIA-HORRIFIED >STACK
	RSTACK
?L33:	PRINTR """Yes, I know, isn't it horrible?"""
?L32:	EQUAL? PRSA,V?ASK-ABOUT \?L38
	EQUAL? PRSO,ALICIA \?L38
	FSET? PRSI,PERSON /?L39
	EQUAL? PRSI,GLOBAL-MURDER \?L41
	FSET? PRSO,TOLD \?L43
	CALL ALICIA-HORRIFIED >STACK
	RSTACK
?L43:	PRINTR """What murder do you mean?"""
?L41:	EQUAL? PRSI,ALICIA-COAT \?L48
	PRINTR """What about it? It's just my wet overcoat."""
?L48:	EQUAL? PRSI,ALICIA-CAR \?L51
	PRINTR """I parked it on the other side of the barn, out of the way of all the other cars."""
?L51:	EQUAL? PRSI,HAIR \?L54
	CALL META-LOC,HAIR >STACK
	EQUAL? STACK,HERE \?L55
	PRINTR "She examines the hair carefully. ""It doesn't look like one of mine to me,"" she says. She doesn't sound terribly convincing."
?L55:	PRINT I-DONT-KNOW
	PRINTR "what you mean."""
?L54:	EQUAL? PRSI,HORSE \?L62
	PRINTI """I'm not the rider that some here are: "
	PRINTD VERONICA
	PRINTI " "
	FSET? ALICIA,TOLD \?L65
	PUSH STR?183
	JUMP ?L67
?L65:	PUSH STR?184
?L67:	PRINT STACK
	PRINTR " a dressage champion several times. I like riding to hounds though. Except at the end when the dogs get the fox. I can't stand the sight of blood."""
?L62:	CALL I-DONT-KNOW-ABOUT,STR?185 >STACK
	RSTACK
?L39:	EQUAL? PRSI,PLAYER \?L69
	PRINTI """"
	PRINTD VERONICA
	PRINTR " mentioned you to me a week or two ago, and I suggested she invite you. She remembers you fondly from school."""
?L69:	EQUAL? PRSI,ALICIA,GLOBAL-ALICIA \?L72
	PRINTR """There's not much to say. I've had a pretty dull life, not anything that would interest your readers."""
?L72:	IN? PRSI,HERE \?L75
	PRINTI """I have nothing but good things to say about "
	CALL HIM$002fHER-PRINT,PRSI
	PRINTR "."""
?L75:	EQUAL? PRSI,GLOBAL-MICHAEL \?L78
	FSET? PRSO,TOLD /?L79
	PRINTI """"
	PRINTD MICHAEL
	PRINTI " is a fine man. I wish I could say that "
	PRINTD VERONICA
	PRINTR " treats him as well as he deserves."""
?L79:	PRINTR """Now he's free of that creature! It serves her right."""
?L78:	EQUAL? PRSI,GLOBAL-VERONICA \?L86
	FSET? PRSO,TOLD /?L87
	PRINTI """"
	PRINTD VERONICA
	PRINTR " and I went to school together. I probably know her as well as anyone. She has her faults. Of course, I suppose we all do."""
?L87:	PRINTR """She was too hard a woman. She must have just pushed someone too hard. I knew it would happen eventually."""
?L86:	EQUAL? PRSI,GLOBAL-RICHARD \?L94
	PRINTI """Poor Richard. He's such a wimp where "
	PRINTD VERONICA
	PRINTR " is concerned."""
?L94:	EQUAL? PRSI,GLOBAL-COL-MARSTON \?L97
	PRINTR """A silly old fool, if you ask me. He has that sinecure job with the trust. I doubt he's had an original thought in his life."""
?L97:	EQUAL? PRSI,GLOBAL-LINDA \?L100
	PRINTR """Isn't she something? I never thought I'd see an Ashcroft hanging around with the likes of her. Richard acts like he's thirteen years old sometimes, especially where women are concerned."""
?L100:	EQUAL? PRSI,GLOBAL-SEN-ASHER \?L103
	PRINTR """I'll vote for him any time. He's so handsome!"""
?L103:	EQUAL? PRSI,GLOBAL-COCHRANE \?L106
	PRINTR """What an oaf! I can't imagine why he's here, unless it's to make trouble of some kind."""
?L106:	EQUAL? PRSI,GLOBAL-OSTMANN \?L109
	PRINTR """A courtly gentleman, isn't he? That black cape makes him look almost cuddly."""
?L109:	EQUAL? PRSI,GLOBAL-BUTLER \?L112
	PRINTI """"
	PRINTD BUTLER
	PRINTR " is so silly in that gorilla suit, and he keeps trying to look dignified. Perhaps I should find him some bananas to carry around."" She giggles."
?L112:	EQUAL? PRSI,GLOBAL-BARTENDER \?L115
	PRINTI """"
	PRINTD VERONICA
	PRINTR " hired him for tonight."""
?L115:	PRINTR """I have no opinion."""
?L38:	EQUAL? PRSA,V?SHOW \FALSE
	FSET? PRSO,ALICIABIT \?L122
	SET 'HADBIT?,1
	FCLEAR PRSO,ALICIABIT
	INC 'ALICIA-SEEN
	CALL QUEUE,I-FLEE,10 >STACK
	PUT STACK,0,1
?L122:	EQUAL? PRSO,MASK \?L125
	PRINTI """That looks like "
	PRINTD VERONICA
	PRINTR "'s mask."""
?L125:	EQUAL? PRSO,HAIR \?L132
	IN? HAIR,FAIRY-MASK \?L129
	PRINTI """I don't see what this has to do with me. "
	PRINTD VERONICA
	PRINTR " probably dyed her hair. I wouldn't put it past her."""
?L129:	EQUAL? PRSO,HAIR \?L132
	PRINTR """Why are you showing me this? It's just a hair."""
?L132:	EQUAL? PRSO,HAIR-ANALYSIS \?L135
	PRINTR """That's silly! You think it's my hair? Millions of women have dark hair! You know those costume places, they don't really clean the costumes very well, the hair's probably been there for months."""
?L135:	EQUAL? PRSO,CORPSE \?L138
	CALL REVEAL-MURDER,ALICIA >STACK
	ZERO? STACK /?L139
	PRINTI "It takes Alicia a few moments to recover from the shock. Then, suddenly, she laughs! ""This is wonderful! Now I can marry "
	PRINTD MICHAEL
	PRINTI "! But why are you doing this?"
	PRINT CALLING-POLICE
	CRLF
	RTRUE
?L139:	PRINTI """Yes, I know. It's horrible, isn't it?"" She chuckles. ""She was my friend, but I'm glad she's dead. Now I can marry "
	PRINTD MICHAEL
	PRINTR "."""
?L138:	ZERO? HADBIT? /FALSE
	PRINT I-DONT-KNOW
	PRINTR "what you hope to accomplish waving these things in my face."""

	.FUNCT ALICIA-HORRIFIED
	PRINTR """It's horrible! She was my best friend. Who could have done such a thing?"""

	.FUNCT SOMEONE-TELLS-ALICIA,HERE?
	CALL DPRINT,WINNER,1
	PRINTI " tells Alicia "
	ZERO? HERE? /?L3
	PUSH STR?186
	JUMP ?L5
?L3:	PUSH STR?187
?L5:	PRINT STACK
	PRINTR ". It horrifies and then elates her."

	.FUNCT I-FLEE
	GRTR? ALICIA-SEEN,2 \?L1
	SET 'FLEEING?,1
	CALL ESTABLISH-GOAL,ALICIA,SITTING-ROOM,1
?L1:	GRTR? MICHAEL-SEEN,1 \FALSE
	SET 'FLEEING?,1
	CALL ESTABLISH-GOAL,MICHAEL,SITTING-ROOM,1
	RFALSE

	.FUNCT NOT-ROPE-F
	REMOVE NOT-ROPE
	PRINTI "Remember, the silly thing was getting in your way, particularly when you danced, so you went back and hung it in the closet with your coat."
	EQUAL? HERE,EAST-COAT-CLOSET \?L3
	PRINTI " But it doesn't seem to be here now."
?L3:	CRLF
	RTRUE

	.FUNCT ROPE-F
	REMOVE NOT-ROPE
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "It's a fairly thin rope, like the sort of rope movie cowboys carry. It looks serviceable, though."
?L1:	EQUAL? PRSA,V?TAKE \FALSE
	CALL DONT-TAKE-EVIDENCE,ROPE >STACK
	ZERO? STACK \TRUE
	FCLEAR ROPE,NDESCBIT
	RFALSE

	.FUNCT DONT-TAKE-EVIDENCE,OBJ,WHO
	IN? DETECTIVE,HERE \?L1
	SET 'WHO,DETECTIVE
	JUMP ?L4
?L1:	IN? DUFFY,HERE \FALSE
	SET 'WHO,DUFFY
?L4:	CALL DPRINT,WHO,1
	PRINTI " stops you. ""That "
	CALL DPRINT,OBJ
	PRINTR " is evidence. Don't take it!"""

	.FUNCT TELL-ALICIA-ARRIVES
	PRINTI "Alicia Barron"
	PRINT ARRIVES
	RTRUE

	.FUNCT TELL-ARRIVES,WHO
	CALL DPRINT,WHO,1
	PRINT ARRIVES
	RTRUE

	.FUNCT G-ALICIA,GARG,L
	LOC ALICIA >L
	ZERO? GARG \?L1
	CALL IMOVEMENT,ALICIA,G-ALICIA >STACK
	RSTACK
?L1:	EQUAL? GARG,G-IMPATIENT \?L3
	PRINTR "Alicia seems to be looking for any excuse to leave you."
?L3:	EQUAL? GARG,G-ENROUTE \?L6
	EQUAL? L,HALLWAY-12 \FALSE
	IN? ALICIA-COAT,ALICIA \FALSE
	FCLEAR ALICIA-COAT,NDESCBIT
	MOVE ALICIA-COAT,EAST-COAT-CLOSET
	CALL CORRIDOR-LOOK,ALICIA >STACK
	ZERO? STACK \?L11
	EQUAL? HERE,EAST-COAT-CLOSET \FALSE
?L11:	PRINTD ALICIA
	PRINTR " deposits her coat in the coat closet."
?L6:	EQUAL? GARG,G-REACHED,G-ALREADY \FALSE
	IN? ALICIA,BALLROOM-5 \?L17
	IN? MICHAEL,BALLROOM-5 \?L17
	SET 'ALICIA-HERE?,1
	CALL THEY-DANCE,ALICIA >STACK
	RSTACK
?L17:	EQUAL? L,PORCH \?L19
	SET 'NEW-ARRIVAL,ALICIA
	CALL ESTABLISH-GOAL,MICHAEL,BALLROOM-5
	CALL ESTABLISH-GOAL,BUTLER,HALL,1
	EQUAL? HERE,PORCH \?L20
	CALL TELL-ALICIA-ARRIVES
	PRINTI "front porch. Her overcoat is soaking wet."
	ZERO? PLAYER-HIDING \?L24
	PRINTI " ""Hi,"" she says. ""Late as usual. I parked back near the barn, there are so many cars out here I'm afraid someone would dent mine."""
?L24:	PRINTI " She rings "
	CALL THE-PRINT,DOORBELL
	PRINTR "."
?L20:	EQUAL? HERE,CIRCLE \?L31
	CALL TELL-ALICIA-ARRIVES
	PRINTD FRONT-DOOR
	PRINTR " and rings the bell."
?L31:	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK \FALSE
	CALL THE-PRINT,DOORBELL,1
	PRINTR " rings."
?L19:	ZERO? FLEEING? /?L38
	EQUAL? L,SITTING-ROOM \?L38
	CALL UNPRIORITIZE,ALICIA
	IN? MICHAEL,L \?L39
	CALL GOALS?,MICHAEL,1
	CALL ESTABLISH-GOAL,ALICIA,BARN,1
	CALL ESTABLISH-GOAL,MICHAEL,BARN,1
	RFALSE
?L39:	CALL GOALS?,ALICIA,0
	RFALSE
?L38:	EQUAL? L,BARN \FALSE
	CALL GOALS?,ALICIA,0
	CALL BARN-DANCE,ALICIA >STACK
	RSTACK

	.FUNCT BARN-DANCE,WHO,FLG=0,?TMP
	CALL QUEUE,I-ESCAPE,20 >STACK
	PUT STACK,0,1
	FSET? BARN-DOOR,LOCKED \?L3
	FCLEAR BARN-DOOR,LOCKED
	EQUAL? HERE,WEST-OF-GARAGE \?L3
	PRINTD WHO
	PRINTI " unlocks the barn door and enters."
	CRLF
	SET 'FLG,1
?L3:	CALL I-SCREAMS >?TMP
	ZERO? ?TMP /?L10
	RETURN ?TMP
?L10:	RETURN FLG

	.FUNCT I-SCREAMS
	CALL QUEUE,I-SCREAMS,1 >STACK
	PUT STACK,0,1
	IN? MICHAEL,BARN \FALSE
	IN? ALICIA,BARN \FALSE
	EQUAL? HERE,WEST-OF-HOUSE,WEST-OF-GARAGE,NORTH-OF-HOUSE \FALSE
	PRINTR "You hear shouting and screams from the direction of the barn."

	.FUNCT I-ESCAPE
	REMOVE ALICIA
	CALL INT,I-SCREAMS >STACK
	PUT STACK,0,0
	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK /FALSE
	PRINTR "You hear a car off behind the barn. The sound grows fainter and fainter."

	.FUNCT I-ALICIA-SNEAKS
	EQUAL? HERE,GARDEN,WALKWAY,HALLWAY-7 /?L1
	EQUAL? HERE,NORTH-OF-HOUSE,HALLWAY-14 /?L1
	CALL START-ALICIA,WALKWAY
	RFALSE
?L1:	EQUAL? HERE,HALLWAY-4,HALLWAY-3,HALLWAY-2 /FALSE
	EQUAL? HERE,HALLWAY-1,WEST-OF-GARAGE /FALSE
	ZERO? ALICIA-WAITED? /?L4
	CALL START-ALICIA,WEST-OF-GARAGE
	RFALSE
?L4:	SET 'ALICIA-WAITED?,1
	CALL QUEUE,I-ALICIA-SNEAKS,3
	RFALSE

	.FUNCT START-ALICIA,RM
	CALL INT,I-ALICIA-SNEAKS >STACK
	PUT STACK,0,0
	MOVE ALICIA,RM
	CALL ESTABLISH-GOAL,ALICIA,PORCH
	FCLEAR CORPSE,INVISIBLE
	FSET NORTH-DOOR,LOCKED
	FSET WEST-DOOR,LOCKED
	FCLEAR NORTH-OFFICE-DOOR,LOCKED
	FCLEAR SOUTH-OFFICE-DOOR,LOCKED
	FCLEAR MEDIA-OFFICE-DOOR,LOCKED
	FCLEAR NORTH-OFFICE-DOOR,OPENBIT
	FCLEAR SOUTH-OFFICE-DOOR,OPENBIT
	FCLEAR MEDIA-OFFICE-DOOR,OPENBIT
	RTRUE

	.FUNCT THEY-DANCE,LAST,FIRST
	CALL QUEUE,I-MICHAEL-TO-GARAGE,5 >STACK
	PUT STACK,0,1
	CALL NEW-SCRIPT,MICHAEL,MICHAEL-LOOP
	CALL IN-BALLROOM?,PLAYER >STACK
	ZERO? STACK /FALSE
	EQUAL? LAST,MICHAEL \?L3
	SET 'FIRST,ALICIA
	JUMP ?L5
?L3:	SET 'FIRST,MICHAEL
?L5:	CALL DPRINT,LAST
	PRINTI " walks up to "
	CALL DPRINT,FIRST
	PRINTR " and they begin to dance."

	.FUNCT I-MICHAEL-TO-GARAGE
	ZERO? MICHAEL-TO-GARAGE? \FALSE
	FSET? MICHAEL,TOLD /?L4
	ZERO? GANG-BEEN-TO-OFFICE? /?L3
?L4:	GET GOAL-TABLES,MICHAEL-C >STACK
	GET STACK,GOAL-F >STACK
	EQUAL? STACK,OFFICE,HALLWAY-3 /?L3
	SET 'MICHAEL-TO-GARAGE?,1
	CALL ESTABLISH-GOAL,ALICIA,BALLROOM-9
	CALL ESTABLISH-GOAL,MICHAEL,GARAGE,1
	RFALSE
?L3:	CALL QUEUE,I-MICHAEL-TO-GARAGE,5 >STACK
	PUT STACK,0,1
	RFALSE

	.FUNCT RICHARD-UNMASKED?
	GETP RICHARD,P?SDESC >STACK
	EQUAL? STACK,RICHARD-SDESC \FALSE
	RTRUE

	.FUNCT RICHARD-UNMASKS
	FCLEAR RICHARD,THE
	PUTP RICHARD,P?SDESC,RICHARD-SDESC
	FCLEAR GLOBAL-RICHARD,THE
	PUTP GLOBAL-RICHARD,P?SDESC,RICHARD-SDESC
	PUTP RICHARD,P?LDESC,STR?188
	RTRUE

	.FUNCT RICHARD-F
	EQUAL? WINNER,RICHARD \?L1
	EQUAL? PRSA,V?UNMASK /?L5
	EQUAL? PRSA,V?WHAT \?L3
	EQUAL? PRSO,YOU \?L3
?L5:	CALL RICHARD-UNMASKED? >STACK
	ZERO? STACK /?L6
	PRINTR """I'm still Richard."""
?L6:	CALL PROB,50 >STACK
	ZERO? STACK /?L10
	PRINTR """None of your business! Grrr!"""
?L10:	CALL RICHARD-UNMASKS
	PRINTR "He answers somewhat gruffly, ""Oh, I'm Richard under all this fur."""
?L3:	EQUAL? PRSA,V?HELLO \?L16
	PRINTR "Richard mumbles a surly greeting."
?L16:	CALL DONT-HANDLE? >STACK
	ZERO? STACK \FALSE
	PRINTR """Not on your life!"" he says angrily."
?L1:	EQUAL? PRSA,V?EXAMINE \?L23
	CALL RICHARD-UNMASKED? >STACK
	ZERO? STACK /?L24
	PRINTI "Richard Ashcroft is "
	PRINTD VERONICA
	PRINTI "'s younger brother, and"
	JUMP ?L28
?L24:	PRINTI "The wearer of the costume"
?L28:	PRINTR " appears as a plump and petulant werewolf, although he has gone to the trouble of smearing something wet and red on his chin which looks authentically bloody."
?L23:	EQUAL? PRSA,V?REVEAL \?L33
	EQUAL? PRSO,GLOBAL-MURDER \?L33
	CALL REVEAL-MURDER,RICHARD >STACK
	ZERO? STACK /?L34
	PRINTR """You're joking, of course. No, you're not, are you?"" He seems shocked, but it's hard to tell if it's just a pose."
?L34:	PRINTR """I already know."""
?L33:	EQUAL? PRSA,V?UNMASK \?L41
	PRINTR """Hey, watch it! I'll bite you!"""
?L41:	EQUAL? PRSA,V?ASK-ABOUT \FALSE
	EQUAL? PRSO,RICHARD \FALSE
	CALL RICHARD-UNMASKED? >STACK
	ZERO? STACK \?L51
	FSET? PRSO,TOLD /?L47
	PRINTR """Grrr!"""
?L47:	CALL RICHARD-UNMASKS
	PRINTI "The werewolf removes his mask, revealing him as Richard, "
	PRINTD VERONICA
	PRINTI "'s younger brother. "
?L51:	EQUAL? PRSI,PLAYER \?L55
	PRINTR """I've never met you before tonight. You work for the paper, right?"""
?L55:	EQUAL? PRSI,RICHARD \?L59
	PRINTR """Me? I'm not interesting enough to write about. Write about my sister instead, she's interesting: she's the Dragon Lady, not the Fairy Queen."""
?L59:	IN? PRSI,HERE \?L62
	PRINTI """Are you trying to cause trouble? "
	PRINT YOU-MUST
	PRINTR "think I'm drunk and will say anything about anyone."""
?L62:	EQUAL? PRSI,GLOBAL-MICHAEL \?L65
	PRINTI """"
	PRINTD MICHAEL
	PRINTR "? He thinks he's pretty wonderful, but he just slides around after my sister, taking whatever he can. I don't think he ever loved her, but then, I don't think anyone ever loved her."""
?L65:	EQUAL? PRSI,GLOBAL-VERONICA \?L68
	FSET? PRSO,TOLD \?L69
	PRINTR """You think I did it, don't you? If I was the sort of person who could kill her, I would have long ago, believe me!"""
?L69:	PRINTR """She's my older sister, but she acts like she's my keeper. I have to account for my every move, like I was still ten years old."""
?L68:	EQUAL? PRSI,GLOBAL-ALICIA \?L76
	PRINTI """She's such a goodie two-shoes, she's been "
	PRINTD VERONICA
	PRINTR "'s friend for years, but you know something? Whenever they're apart, she cuts her up something fierce. I have my suspicions about her."""
?L76:	EQUAL? PRSI,GLOBAL-COL-MARSTON \?L79
	PRINTI """That pompous blowhard! He's been in clover for years, just because he was a crony of my father's. Now he runs the trust and "
	PRINTD VERONICA
	PRINTR " has him in the palm of her hand! But I'll get mine one of these days, just wait!"""
?L79:	EQUAL? PRSI,GLOBAL-LINDA \?L82
	PRINTR """Linda's a perfect example of my sister's interference. She's sweet, and lovely, and I love her, but my sister can't stand her because her family didn't come over on the Mayflower."""
?L82:	EQUAL? PRSI,GLOBAL-SEN-ASHER \?L85
	PRINTI """Our family has known him for years, since he was just on the county council. I'd think more of him if "
	PRINTD VERONICA
	PRINTR " didn't like him so much."""
?L85:	EQUAL? PRSI,GLOBAL-COCHRANE \?L88
	PRINT I-DONT-KNOW
	PRINTI "why "
	PRINTD VERONICA
	PRINTR " invited him. He's making a fool of himself. He's going to have trouble from me if he keeps staring at Linda like that."""
?L88:	EQUAL? PRSI,GLOBAL-OSTMANN \?L91
	PRINTR """Who's he? He seems like a nice enough fellow."""
?L91:	EQUAL? PRSI,GLOBAL-BUTLER \?L94
	PRINTI """He's been here so long he's part of the furniture. He taught me to ride when I was a child. "
	PRINTD VERONICA
	PRINTR ", too. Dad was too busy."""
?L94:	EQUAL? PRSI,GLOBAL-BARTENDER \?L97
	PRINTI """He's somebody "
	PRINTD VERONICA
	PRINTR " hired."""
?L97:	CALL I-WOULDNT-KNOW >STACK
	RSTACK

	.FUNCT G-RICHARD,GARG
	ZERO? GARG \?L1
	CALL IMOVEMENT,RICHARD,G-RICHARD >STACK
	RSTACK
?L1:	EQUAL? GARG,G-IMPATIENT \FALSE
	CALL DPRINT,RICHARD,1
	PRINTR " seems to find you more and more boring as time passes."

	.FUNCT COL-MARSTON-F
	EQUAL? WINNER,COL-MARSTON \?L1
	EQUAL? PRSA,V?HELLO \?L3
	PRINTR "He replies, somewhat curtly."
?L3:	CALL DONT-HANDLE? >STACK
	ZERO? STACK \FALSE
	PRINTD COL-MARSTON
	PRINTR " only scowls at you."
?L1:	EQUAL? PRSA,V?EXAMINE \?L11
	PRINTD COL-MARSTON
	PRINTR " is bedecked as an explorer or perhaps a big-game hunter. From pith helmet down to whipcord trousers, he looks the part. His gaze is steely and his white mustache painstakingly trimmed."
?L11:	EQUAL? PRSA,V?REVEAL \?L14
	EQUAL? PRSO,GLOBAL-MURDER \?L14
	CALL REVEAL-MURDER,COL-MARSTON >STACK
	ZERO? STACK /?L15
	PRINTR """Are you sure? I mean, how terrible!"" He seems to have conflicting feelings about what he has just heard."
?L15:	PRINTR """I already know. Only a reporter would be spreading this like it was some bit of dirty gossip."""
?L14:	EQUAL? PRSA,V?ACCUSE \?L22
	EQUAL? PRSI,GLOBAL-EMBEZZLEMENT \?L23
	ZERO? MARSTON-SEEN-TRUST-DOCUMENTS? /?L25
	PRINTR """You'd have a hard time proving anything, documents or no. At the worst, they would say I've made some bad investments. Of course, you could try to ruin me in the press, but I'll sue if you do. You know most libel suits are found for the plaintiff these days."""
?L25:	PRINTR """What could you mean by that? I've never stolen anything in my life. I've never had to."" He grins."
?L23:	EQUAL? PRSI,GLOBAL-MURDER \FALSE
	PRINTR """What a ridiculous accusation!"""
?L22:	EQUAL? PRSA,V?ASK-ABOUT \?L36
	EQUAL? PRSO,COL-MARSTON \?L36
	FSET? PRSI,PERSON /?L37
	EQUAL? PRSI,GLOBAL-MURDER \?L39
	FSET? PRSO,TOLD \?L41
	PRINTR """Maybe she surprised someone. A sneak thief, probably."""
?L41:	PRINT I-DONT-KNOW
	PRINTR "of any murder."""
?L39:	EQUAL? PRSI,TRUST,TRUST-FOLDER,TRUST-DOCUMENTS \?L48
	ZERO? MARSTON-SEEN-TRUST-DOCUMENTS? /?L49
	PRINTR """What more could I tell you? You'll just write lies anyway!"""
?L49:	PRINTR """I've run the Trust for almost twenty years. I'm proud of what I've done. Sure, there have been some bad years, but the trend is up."" He looks resolved and confident."
?L48:	CALL I-DONT-KNOW-ABOUT,STR?189 >STACK
	RSTACK
?L37:	EQUAL? PRSI,PLAYER \?L57
	PRINTR """I don't like reporters very much, if that's what you're getting at."""
?L57:	EQUAL? PRSI,COL-MARSTON \?L60
	PRINTR """Well, I'm really semi-retired. I run the Ashcroft Family Trust, but it mostly runs itself: I don't need to be involved in day-to-day operations too much. Just a decision now and then."""
?L60:	EQUAL? PRSI,GLOBAL-VERONICA,CORPSE \?L63
	ZERO? MARSTON-SEEN-TRUST-DOCUMENTS? /?L64
	PRINTR """She was conspiring against me! She had some foolish idea that I'm not running the trust properly. That's what those ridiculous documents are about! Now she's dead, and it's only just desserts!"" He turns livid with embarrassment. ""I didn't mean that... I didn't kill her... Don't jump to conclusions..."""
?L64:	FSET? PRSO,TOLD \?L68
	PRINTR """'Nil nisi,' they say, but I never liked her very much. Didn't have the vision a man would have. Home and hearth. Should be a man at the head of a great old family like the Ashcrofts. Of course, Richard's the head now, officially."""
?L68:	PRINTR """I can't say that working with her is as rewarding as working with her father was, still, I can't really complain."""
?L63:	IN? PRSI,HERE \?L74
	PRINTD COL-MARSTON
	PRINTI " glances at "
	CALL DPRINT,PRSI
	PRINTR ", then sniffs disdainfully at you, as though you had asked him to stand on his head."
?L74:	EQUAL? PRSI,GLOBAL-MICHAEL \?L77
	ZERO? MARSTON-SEEN-TRUST-DOCUMENTS? /?L78
	PRINTI """"
	PRINTD MICHAEL
	PRINTI "? Well, sometimes he makes big promises and doesn't follow through... Fundamentally a sound fellow, though."" "
	PRINTD COL-MARSTON
	PRINTR " seems somewhat distracted."
?L78:	FSET? PRSO,TOLD \?L82
	PRINTR """He must be devastated. But he's a strong man, he'll survive it."""
?L82:	PRINTI """A fine man. You can count on him. "
	PRINTD VERONICA
	PRINTR "'s father would have approved of him. He'll get her straightened out one day."""
?L77:	EQUAL? PRSI,GLOBAL-ALICIA \?L88
	PRINTI """She's one of "
	PRINTD VERONICA
	PRINTR "'s cronies. Went to school with her, but then I heard you did too? Anyway, I hardly know her."""
?L88:	EQUAL? PRSI,GLOBAL-RICHARD \?L91
	PRINTI """As Teddy Roosevelt said, 'I could carve a man with more backbone out of a banana.' The only thing he stands up to "
	PRINTD VERONICA
	PRINTR " on is that Linda person. He's never really grown up."""
?L91:	EQUAL? PRSI,GLOBAL-LINDA \?L94
	PRINTR """She's just not our sort. I know that sounds prejudiced, but she's not happy here, you can tell, and she'd be better off if she and Richard stopped seeing each other. It would be kinder to her."""
?L94:	EQUAL? PRSI,GLOBAL-SEN-ASHER \?L97
	PRINTR """A fine Senator. He has plans. You'll hear more from him, mark my words."""
?L97:	EQUAL? PRSI,GLOBAL-COCHRANE \?L100
	PRINTR """The man is clearly an alcoholic. I don't approve of people who can't hold their liquor."""
?L100:	EQUAL? PRSI,GLOBAL-OSTMANN \?L103
	PRINTI """That's a man with a true eye for business. I wonder why he's here tonight? "
	PRINTD VERONICA
	PRINTI " and "
	PRINTD MICHAEL
	PRINTR " don't mix too much with his crowd, and vice versa."""
?L103:	EQUAL? PRSI,GLOBAL-BUTLER \?L106
	PRINTI """"
	PRINTD BUTLER
	PRINTR " is the disproof of the canard that there are no good servants anymore."""
?L106:	EQUAL? PRSI,GLOBAL-BARTENDER \?L109
	PRINTR """He told me he's studying law. Lawyers and accountants! Two professions we would be better off without! We can always use a good bartender."""
?L109:	PRINTR """I have nothing to say about that."""
?L36:	EQUAL? PRSA,V?SHOW \FALSE
	EQUAL? PRSO,SALE-FOLDER,SALE-AGREEMENT \?L116
	PRINTD COL-MARSTON
	PRINTI " glances cursorily through the agreement. "
	PRINT I-DONT-KNOW
	PRINTI "where you got this. It's true, "
	PRINTD VERONICA
	PRINTI " was going to sell the farm and move further upcountry, away from the suburbs. It wasn't supposed to be announced until tomorrow."
	FSET? COL-MARSTON,TOLD \?L120
	PUSH STR?190
	JUMP ?L122
?L120:	PUSH STR?191
?L122:	PRINT STACK
	PRINTR " signed."" He smiles frostily."
?L116:	EQUAL? PRSO,TRUST-DOCUMENTS /?L124
	EQUAL? PRSO,TRUST-FOLDER \FALSE
	IN? TRUST-DOCUMENTS,TRUST-FOLDER \FALSE
?L124:	ZERO? MARSTON-SEEN-TRUST-DOCUMENTS? /?L125
	PRINTR """I have nothing more to say. I've said too much already. If you publish anything you'll hear from my lawyer!"""
?L125:	SET 'MARSTON-SEEN-TRUST-DOCUMENTS?,1
	IN? INVESTOR-LIST,MICHAEL \?L130
	CALL ESTABLISH-GOAL,COL-MARSTON,LIBRARY,1
	CALL ESTABLISH-GOAL,MICHAEL,LIBRARY,1
?L130:	PRINTR "The colonel's composure breaks for a moment, then reforms. ""Where did you get that? I've run that Trust for twenty years, and all my investments have been good: for her. I finally decided I should get something out of it. Do you know what she pays me? Peanuts! And she wallows in luxury, decadence. I wanted a turn. Besides, I did nothing wrong, you can't prove anything, no matter what those accountants say."""

	.FUNCT G-COL-MARSTON,GARG,L
	LOC COL-MARSTON >L
	ZERO? GARG \?L1
	CALL IMOVEMENT,COL-MARSTON,G-COL-MARSTON >STACK
	RSTACK
?L1:	EQUAL? GARG,G-IMPATIENT \?L3
	IN? COL-MARSTON,OFFICE /FALSE
	IN? COL-MARSTON,LIBRARY \?L6
	FCLEAR LIBRARY-DOOR,LOCKED
	RFALSE
?L6:	PRINTD COL-MARSTON
	PRINTR " looks at his watch, and not very surreptitiously."
?L3:	EQUAL? GARG,G-REACHED,G-ALREADY \FALSE
	EQUAL? L,BALLROOM-9 \?L11
	CALL INT,I-ARGUMENT >STACK
	GET STACK,0 >STACK
	ZERO? STACK /?L11
	CALL GOALS?,COL-MARSTON,0
	RFALSE
?L11:	EQUAL? L,HALLWAY-3 \?L13
	ZERO? THREE-STOOGES-IN-OFFICE? \?L13
	CALL GOALS?,COL-MARSTON,0
	IN? COCHRANE,HALLWAY-3 \FALSE
	IN? MICHAEL,HALLWAY-3 \FALSE
	CALL GANGS-ALL-HERE >STACK
	RSTACK
?L13:	EQUAL? L,OFFICE \?L17
	CALL UNPRIORITIZE,COL-MARSTON
	CALL ESTABLISH-GOAL,COL-MARSTON,BALLROOM-9
	CALL GRAB-ATTENTION,COL-MARSTON
	RFALSE
?L17:	EQUAL? L,LIBRARY \?L18
	IN? MICHAEL,LIBRARY \?L19
	CALL LIBRARY-MEETING,COL-MARSTON >STACK
	RSTACK
?L19:	CALL GOALS?,COL-MARSTON,0
	RFALSE
?L18:	IN? INVESTOR-LIST,COL-MARSTON \FALSE
	EQUAL? L,BALLROOM-8 \FALSE
	FCLEAR INVESTOR-LIST,INVISIBLE
	MOVE INVESTOR-LIST,FIREPLACE
	CALL QUEUE,I-BURNED,1 >STACK
	PUT STACK,0,1
	EQUAL? HERE,BALLROOM-8 \?L23
	CALL TELL-ARRIVES,COL-MARSTON
	PRINTR "fireplace, warms his hands briefly, and then turns to warm his back. As he does, you notice a crumpled piece of paper drop from his hands into the fireplace. It doesn't land quite in the fire though. It's beginning to singe a bit."
?L23:	CALL IN-BALLROOM?,PLAYER >STACK
	ZERO? STACK /FALSE
	PRINTD COL-MARSTON
	PRINTR " is now warming his hands and back at the fireplace. You catch an odd movement out of the corner of your eye."

	.FUNCT I-BURNED
	IN? INVESTOR-LIST,FIREPLACE \FALSE
	ZERO? LIST-BURNING? \?L3
	SET 'LIST-BURNING?,1
	CALL QUEUE,I-BURNED,1
	EQUAL? HERE,BALLROOM-8 \FALSE
	PRINTR "The piece of paper is beginning to smolder."
?L3:	MOVE INVESTOR-LIST,POLICE-LAB
	EQUAL? HERE,BALLROOM-8 \FALSE
	PRINTR "The crumpled piece of paper bursts into flame and is reduced to ashes."

	.FUNCT LINDA-F
	EQUAL? WINNER,LINDA \?L1
	EQUAL? PRSA,V?HELLO \?L3
	PRINTR """Hi! What's your sign?"""
?L3:	CALL DONT-HANDLE? >STACK
	ZERO? STACK \FALSE
	PRINTR "Linda bats her eyes and looks confused."
?L1:	EQUAL? PRSA,V?EXAMINE \?L11
	PRINTR "Linda Meade is dressed as a ballerina. Her costume and hair are both flaming red. She is a beautiful woman, and knows it. Eyes follow her every move."
?L11:	EQUAL? PRSA,V?RUB,V?UNMASK \?L14
	PRINTI """Stop that, silly!"" she giggles."
	CRLF
	CALL PRINT-ID,STR?192 >STACK
	RSTACK
?L14:	EQUAL? PRSA,V?REVEAL \?L17
	EQUAL? PRSO,GLOBAL-MURDER \?L17
	CALL REVEAL-MURDER,LINDA >STACK
	ZERO? STACK /?L18
	PRINTR """Yuck! I think I don't feel too well."" She shivers, and then composes herself. ""Now Richard will be out from under her thumb."" She looks at you as though she committed an indiscretion, and then smiles inanely."
?L18:	PRINTR """Everyone will treat it like a juicy piece of gossip! Just wait. She's dead, poor thing. I didn't like her very much, but honestly!"""
?L17:	EQUAL? PRSA,V?ASK-ABOUT \FALSE
	EQUAL? PRSO,LINDA \FALSE
	EQUAL? PRSI,PLAYER \?L26
	PRINTI """I heard you're a reporter. Will you write about me?"""
	JUMP ?L66
?L26:	EQUAL? PRSI,LINDA \?L30
	PRINTI """Until I met Richard I was working at the drug store, checking people out. It wasn't very exciting. Now I'm going to be a model! It's my ambition: I'll be on TV someday!"""
	JUMP ?L66
?L30:	FSET? PRSI,PERSON \?L33
	IN? PRSI,HERE \?L33
	PRINTI """You wouldn't want me to commit a faux pas, would you?"""
	JUMP ?L66
?L33:	EQUAL? PRSI,GLOBAL-MICHAEL \?L36
	PRINTI """He's nasty to me. I don't think he likes Richard much."""
	JUMP ?L66
?L36:	EQUAL? PRSI,GLOBAL-VERONICA \?L39
	PRINTI """She hates me. She hates Richard! I hate her! She thinks she's so great because she's got a lot of money. She treats Richard like a child, doling out an allowance! Really! He's thirty years old! Just because she's got control of the Trust! Confidentially, he hates her, too."""
	JUMP ?L66
?L39:	EQUAL? PRSI,GLOBAL-ALICIA \?L42
	PRINT I-DONT-KNOW
	PRINTI "her."""
	JUMP ?L66
?L42:	EQUAL? PRSI,GLOBAL-RICHARD \?L45
	PRINTI """We're in love! "
	PRINTD VERONICA
	PRINTI " is keeping us from being married, by not giving Richard what's coming to him from the Trust. It's not fair at all!"""
	JUMP ?L66
?L45:	EQUAL? PRSI,GLOBAL-COL-MARSTON \?L48
	PRINTI """That old monster! He hates Richard! He won't make "
	PRINTD VERONICA
	PRINTI " give him what's coming to him lawfully. He says he can't change the rules, but that's silly: doesn't he run it?"""
	JUMP ?L66
?L48:	EQUAL? PRSI,GLOBAL-SEN-ASHER \?L51
	PRINTI """Isn't it exciting? A real Senator. He's even distinguished dressed in that silly costume."""
	JUMP ?L66
?L51:	EQUAL? PRSI,GLOBAL-COCHRANE \?L54
	PRINT I-DONT-KNOW
	PRINTI "him. He's drunk, isn't he?"""
	JUMP ?L66
?L54:	EQUAL? PRSI,GLOBAL-OSTMANN \?L57
	PRINTI """He owns that building company. Their signs are all over the place!"""
	JUMP ?L66
?L57:	EQUAL? PRSI,GLOBAL-BUTLER \?L60
	PRINTI """He hates me. He kicked me out once when I came over without Richard."""
	JUMP ?L66
?L60:	EQUAL? PRSI,GLOBAL-BARTENDER \?L63
	PRINT I-DONT-KNOW
	PRINTI "him. I don't think he usually works here."""
	JUMP ?L66
?L63:	CALL TELL-DONT-KNOW
	RTRUE
?L66:	DEC 'BOOP-CNT
	ZERO? BOOP-CNT \?L67
	SET 'BOOP-CNT,10
	PRINTI " Linda's voice is high and squeaky, a sort of Betty Boop voice."
?L67:	CRLF
	RTRUE

	.FUNCT G-LINDA,GARG
	ZERO? GARG \?L1
	CALL IMOVEMENT,LINDA,G-LINDA >STACK
	RSTACK
?L1:	EQUAL? GARG,G-IMPATIENT \FALSE
	PRINTR "Linda seems increasingly impatient with you."

	.FUNCT SEN-ASHER-DESC-F,RARG=0
	IN? SEN-ASHER,MEDIA-ROOM \?L1
	PRINTD SEN-ASHER
	PRINTR ", dressed in harlequin costume, is relaxing on a sofa, watching the news on CNN."
?L1:	PRINTD SEN-ASHER
	PRINTI ", a distinguished harlequin, is"
	CALL TELL-HERE >STACK
	RSTACK

	.FUNCT SEN-ASHER-F
	EQUAL? WINNER,SEN-ASHER \?L1
	EQUAL? PRSA,V?HELLO \?L3
	PRINTR "The Senator greets you and shakes your hand. His handshake is firm, warm, and dry."
?L3:	CALL DONT-HANDLE? >STACK
	ZERO? STACK \FALSE
	PRINTR """You can't order me around! You reporters have a lot of nerve."""
?L1:	EQUAL? PRSA,V?$0024REVEAL \?L11
	EQUAL? PRSO,GLOBAL-MURDER \?L11
	CALL REVEAL-MURDER,SEN-ASHER
	IN? PRSI,HERE \?L12
	CALL DPRINT,WINNER,1
	PRINTR " tells the Senator of the murder. He looks like he has been hit with a sandbag."
?L12:	CALL NEARBY?,SEN-ASHER >STACK
	ZERO? STACK /FALSE
	CALL DPRINT,WINNER,1
	PRINTR " tells the Senator something that horrifies him."
?L11:	EQUAL? PRSA,V?REVEAL \?L20
	EQUAL? PRSO,GLOBAL-MURDER \?L20
	CALL REVEAL-MURDER,SEN-ASHER >STACK
	ZERO? STACK /?L21
	PRINTR """No! That's ridiculous! Who did it?"" He recoils from the idea as though he had been punched."
?L21:	PRINTR """Horrible, horrible."" The Senator hasn't yet recovered from the revelation."
?L20:	EQUAL? PRSA,V?ACCUSE \?L28
	EQUAL? PRSI,GLOBAL-MURDER \?L28
	PRINTI """"
	PRINT YOU-MUST
	PRINTR "be insane. Sure, I was in the next room when it happened. How do you suppose that makes me feel? I was in love with her once... I suppose I still am. I could no more kill her than, than..."" He chokes back a sob."
?L28:	EQUAL? PRSA,V?EXAMINE \?L31
	PRINTR "Senator Alan Asher is two years into a successful first term, a man the party is already eyeing for higher office. He is tall and not quite so handsome as to be too handsome for a politician. Even dressed as he is in harlequin costume, he manages to look commanding and at ease."
?L31:	EQUAL? PRSA,V?ASK-ABOUT \FALSE
	EQUAL? PRSO,SEN-ASHER \FALSE
	FSET? PRSI,PERSON /?L35
	EQUAL? PRSI,GLOBAL-MURDER \?L37
	FSET? PRSO,TOLD \?L39
	PRINTI """You know, I heard a muffled yell from the office at about "
	CALL TIME-PRINT,YELL-TIME,0
	PRINTR " I didn't really notice it consciously; I was watching television and relaxing."""
?L39:	PRINTR """What murder? Is this some sort of trick question?"""
?L37:	PRINTR """No comment."""
?L35:	EQUAL? PRSI,PLAYER \?L51
	PRINTR """Your paper has always been fair and impartial to me. I appreciate that."""
?L51:	EQUAL? PRSI,SEN-ASHER \?L54
	PRINTR """Tell your readers I'm just a dedicated public servant."" He grins winningly."
?L54:	IN? PRSI,HERE \?L57
	PRINTR """It would be impolitic to say anything."""
?L57:	EQUAL? PRSI,GLOBAL-MICHAEL \?L60
	PRINTI """"
	PRINTD MICHAEL
	PRINTI " is a fine man. He was a lucky man to capture "
	PRINTD VERONICA
	PRINTR "."""
?L60:	EQUAL? PRSI,GLOBAL-VERONICA \?L63
	FSET? PRSO,TOLD \?L64
	PRINTR "The Senator tries to compose himself. ""She was always one of my greatest friends. We knew each other for many years. How could anyone have done this to her?"""
?L64:	PRINTR """She gives a great party. It's always a pleasure to come out here: the pressure's off for a while and I can just relax."""
?L63:	EQUAL? PRSI,GLOBAL-ALICIA \?L71
	PRINTI """She's an old friend of "
	PRINTD VERONICA
	PRINTR "'s. When they were in school together they were roommates. Borrowing each other's clothes, stealing boyfriends back and forth, and all that."""
?L71:	EQUAL? PRSI,GLOBAL-RICHARD \?L74
	PRINTI """He is, unfortunately, not much. "
	PRINTD VERONICA
	PRINTI " despair"
	FSET? PRSO,TOLD \?L77
	PUSH STR?193
	JUMP ?L79
?L77:	PUSH STR?194
?L79:	PRINT STACK
	PRINTR " of him ever amounting to anything."""
?L74:	EQUAL? PRSI,GLOBAL-COL-MARSTON \?L80
	PRINTI """He's a hidebound old reactionary. It's unfortunate. The trust could do so much good with a different administrator. But "
	PRINTD VERONICA
	PRINTR " likes him."""
?L80:	EQUAL? PRSI,GLOBAL-LINDA \?L83
	PRINTR """I've never been introduced. I know Richard is well and truly smitten, though."""
?L83:	EQUAL? PRSI,GLOBAL-COCHRANE \?L86
	PRINTI """Construction is a big business around here. These suburbs are among the fastest growing areas in the country. It's driving the Hunt Club types further out into the country. "
	PRINTD COCHRANE
	PRINTR " is a big force in the industry, not that anyone is terribly pleased at that."""
?L86:	EQUAL? PRSI,GLOBAL-OSTMANN \?L89
	PRINTI """He's done a lot of construction in the area, mostly office buildings, and many of those for the government. You'd be surprised at how little of the space the government occupies is actually government-owned. We're tenants in a lot of places, and "
	PRINTD OSTMANN
	PRINTR " owns a lot of those."""
?L89:	EQUAL? PRSI,GLOBAL-BUTLER \?L92
	PRINTI """"
	PRINTD BUTLER
	PRINTR " is a family retainer. He'll live here for the rest of his life, if he can. They'll let him, too."""
?L92:	EQUAL? PRSI,GLOBAL-BARTENDER \?L95
	PRINTR """Seems a nice kid. He told me he's in Law School."""
?L95:	PRINTR """Nothing to say, not even off-the-record."""

	.FUNCT G-SEN-ASHER,GARG
	ZERO? GARG \?L1
	CALL IMOVEMENT,SEN-ASHER,G-SEN-ASHER >STACK
	RSTACK
?L1:	EQUAL? GARG,G-IMPATIENT \FALSE
	PRINTR "The Senator is becoming bored with you."

	.FUNCT COCHRANE-UNMASKS
	GETP COCHRANE,P?SDESC >STACK
	EQUAL? STACK,COCHRANE-SDESC /FALSE
	FCLEAR COCHRANE,THE
	FCLEAR COCHRANE,AN
	PUTP COCHRANE,P?SDESC,COCHRANE-SDESC
	FCLEAR GLOBAL-COCHRANE,THE
	FCLEAR GLOBAL-COCHRANE,AN
	PUTP GLOBAL-COCHRANE,P?SDESC,COCHRANE-SDESC
	PUTP COCHRANE,P?LDESC,STR?195
	PRINTI "The figure lifts its visor. ""I'm Bill "
	PRINTD COCHRANE
	PRINTI "! This costume is so hot and itchy, I'm sorry I got it."" He wipes his brow. "
	RTRUE

	.FUNCT COCHRANE-F,UNMASKED?
	EQUAL? WINNER,COCHRANE \?L1
	EQUAL? PRSA,V?SAY,V?HELLO \?L3
	PRINTR """Uh, hi."""
?L3:	EQUAL? PRSA,V?WHAT \?L7
	EQUAL? PRSO,YOU \?L7
	CALL COCHRANE-UNMASKS >STACK
	ZERO? STACK /?L8
	CRLF
	RTRUE
?L8:	PRINTI """You know who I am: I'm "
	PRINTD COCHRANE
	PRINTR "!"""
?L7:	CALL DONT-HANDLE? >STACK
	ZERO? STACK \FALSE
	PRINTR """Wha? Whatcha mean?"" he responds, in a slightly slurred voice."
?L1:	EQUAL? PRSA,V?EXAMINE \?L17
	GETP COCHRANE,P?SDESC >STACK
	EQUAL? STACK,COCHRANE-SDESC \?L18
	PRINTI "William "
	PRINTD COCHRANE
	JUMP ?L22
?L18:	PRINTI "The Astronaut"
?L22:	PRINTR " is crammed into an ill-fitting, obviously rented, spacesuit. The helmet is badly attached and bounces as he moves. It's clear he's uncomfortable. It's also clear he has already had quite a lot to drink."
?L17:	EQUAL? PRSA,V?ACCUSE \?L27
	FSET? COCHRANE,TOLD \FALSE
	ZERO? COCHRANE-SEEN-AGREEMENT? /FALSE
	PRINTR """You can't scare me. Sure, I'm just as happy she's dead, but I wouldn't do it. I've hardly been out of the ballroom all night. You can't pin this on me."""
?L27:	EQUAL? PRSA,V?SHOW \?L33
	CALL COCHRANE-UNMASKS
	EQUAL? PRSO,CARD \?L34
	PRINTI """Yeah. I just wanted to keep her from doing something she'd regret. I just want an equal chance to buy this property. If she's going to sell it, why a sweetheart deal with "
	PRINTD OSTMANN
	PRINTI "? I went to her office earlier to try to convince her, but the door was locked and she wouldn't answer."
	FSET? COCHRANE,TOLD \?L38
	PRINTI " That was at about quarter of eight, so you can't pin this on me: she was still alive then, everybody saw her."
?L38:	PRINTR """"
?L34:	EQUAL? PRSO,SALE-FOLDER,SALE-AGREEMENT \FALSE
	ZERO? COCHRANE-SEEN-AGREEMENT? /?L46
	PRINTR """Yeah. I've seen it, remember?"""
?L46:	SET 'COCHRANE-SEEN-AGREEMENT?,1
	FSET? COCHRANE,TOLD \?L51
	PRINTI """What a joke on Sam! He'll never get this property now! "
	PRINTD MICHAEL
	PRINTR " will sell to me, I bet... I mean, well, it's a shame she's dead and all, but you gotta look out for yourself."""
?L51:	SET 'COCHRANE-LOOKS-FOR-OSTMANN?,1
	PRINTI """Ask "
	PRINTD OSTMANN
	PRINTI " about that."" "
	PRINTD COCHRANE
	PRINTR "'s calm covers a less placid interior."
?L33:	EQUAL? PRSA,V?ASK-ABOUT \FALSE
	EQUAL? PRSO,COCHRANE \FALSE
	CALL COCHRANE-UNMASKS >UNMASKED?
	PRINTD COCHRANE
	PRINTI " is a little unsteady, and swallows a little more of his drink before answering. "
	FSET? PRSI,PERSON /?L62
	EQUAL? PRSI,ASTRONAUT-COSTUME \?L64
	ZERO? UNMASKED? \TRUE
	PRINTI """It itches."""
	CRLF
	JUMP ?L129
?L64:	EQUAL? PRSI,GLOBAL-MURDER \?L71
	FSET? PRSO,TOLD \?L72
	PRINTI """I didn't do it! She wasn't giving me a fair shake, but murder? Not me!"""
	JUMP ?L129
?L72:	PRINTI """Murder? No one's been murdered. Is this a joke?"""
	JUMP ?L129
?L71:	EQUAL? PRSI,SALE,SALE-FOLDER,SALE-AGREEMENT \?L79
	PRINTI """That skunk "
	PRINTD OSTMANN
	PRINTI "! He's out to get me. I should have had that sale."""
	JUMP ?L129
?L79:	PRINTI """I dunno."""
	JUMP ?L129
?L62:	EQUAL? PRSI,PLAYER \?L85
	PRINTI """Reporters. Can't stand them. You seem basically okay, though."""
	JUMP ?L129
?L85:	EQUAL? PRSI,COCHRANE \?L88
	PRINTI """I'm just a small businessman trying to make a profit. Dealing with these rich types doesn't make it any easier. Whoever said the rich were free spenders didn't know these people."""
	JUMP ?L129
?L88:	EQUAL? PRSI,GLOBAL-VERONICA,CORPSE \?L91
	FSET? PRSO,TOLD \?L92
	PRINTI """She treated me like dirt, just because she never worked for her money and I did. My hands are clean."""
	JUMP ?L129
?L92:	PRINTI """She's a fancy-pants rich girl, thinks she's too good to deal with me. She's got another think coming!"""
	JUMP ?L129
?L91:	IN? PRSI,HERE \?L99
	PRINTI """I could tell you some things. But "
	CALL HE$002fSHE-PRINT,PRSI
	PRINTI "'s right here."" He grins."
	JUMP ?L129
?L99:	EQUAL? PRSI,GLOBAL-MICHAEL \?L102
	PRINTI """I think he'd deal with me. I can talk to him man-to-man, but that wife of his..."""
	JUMP ?L129
?L102:	EQUAL? PRSI,GLOBAL-ALICIA \?L105
	PRINTI """I never met her. Another one of those society types, like Ms. Ashcroft."""
	JUMP ?L129
?L105:	EQUAL? PRSI,GLOBAL-RICHARD \?L108
	PRINT I-DONT-KNOW
	PRINTI "him. Everybody seems down on him, and given this family, that means he's a good guy."""
	JUMP ?L129
?L108:	EQUAL? PRSI,GLOBAL-COL-MARSTON \?L111
	PRINTI """"
	PRINTD COL-MARSTON
	PRINTI "? I hear he was a colonel in a supply battalion. He never got closer to the front than Georgia. I could tell you a few more things about him if I wanted to..."""
	JUMP ?L129
?L111:	EQUAL? PRSI,GLOBAL-LINDA \?L114
	PRINTI """She's the ballerina, right? You know her? Want to introduce me?"""
	JUMP ?L129
?L114:	EQUAL? PRSI,GLOBAL-SEN-ASHER \?L117
	PRINTI """He's a friend of the family. He and Ms. Ashcroft were an item before she married "
	PRINTD MICHAEL
	PRINTI "."""
	JUMP ?L129
?L117:	EQUAL? PRSI,GLOBAL-OSTMANN \?L120
	PRINTI """That slime! He'll get what's coming to him one of these days. He's got an in with"
	PRINT REAL-ESTATE-BOARD
	PRINTI ", and he's tight with "
	PRINTD VERONICA
	PRINTI ". He's ruining my business!"" He angrily scans the room, looking for "
	PRINTD OSTMANN
	PRINTI "."
	JUMP ?L129
?L120:	EQUAL? PRSI,GLOBAL-BUTLER \?L123
	PRINTI """Thinks he's Jeeves. All stiff-upper-lip and fake British accent."""
	JUMP ?L129
?L123:	EQUAL? PRSI,GLOBAL-BARTENDER \?L126
	PRINTI """Makes a heck of a drink, doesn't he?"""
	JUMP ?L129
?L126:	CALL TELL-DONT-KNOW
?L129:	PRINTR " He steadies himself."

	.FUNCT I-DONT-KNOW-ABOUT,THAT,CR?=1
	PRINT I-DONT-KNOW
	PRINTI "anything about "
	PRINT THAT
	ZERO? CR? /FALSE
	PRINTR "."""

	.FUNCT TELL-DONT-KNOW
	CALL I-DONT-KNOW-ABOUT,STR?185 >STACK
	RSTACK

	.FUNCT G-COCHRANE,GARG,L
	LOC COCHRANE >L
	ZERO? GARG \?L1
	CALL IMOVEMENT,COCHRANE,G-COCHRANE >STACK
	RSTACK
?L1:	EQUAL? GARG,G-IMPATIENT \?L3
	PRINTD COCHRANE
	PRINTR " swallows some of his drink, then says, ""Excuse me, but I think I need a refill."""
?L3:	EQUAL? GARG,G-REACHED,G-ALREADY \FALSE
	EQUAL? L,BALLROOM-9 \?L9
	CALL INT,I-ARGUMENT >STACK
	GET STACK,0 >STACK
	ZERO? STACK /?L7
	CALL GOALS?,COCHRANE,0
	RFALSE
?L7:	EQUAL? L,BALLROOM-9 \?L9
	CALL NEW-SCRIPT,COCHRANE,COCHRANE-LOOP
	CALL PROB,25 >STACK
	ZERO? STACK /?L10
	CALL ESTABLISH-GOAL,COCHRANE,EAST-BATH,1
	EQUAL? HERE,L \FALSE
	CALL TELL-ARRIVES,COCHRANE
	PRINTR "bar, pauses, and gives his empty glass back to the bartender."
?L10:	EQUAL? HERE,L \FALSE
	CALL TELL-ARRIVES,COCHRANE
	PRINTR "bar and orders another drink."
?L9:	EQUAL? L,HALLWAY-3 \?L21
	ZERO? THREE-STOOGES-IN-OFFICE? \?L21
	CALL GOALS?,COCHRANE,0
	IN? MICHAEL,HALLWAY-3 \FALSE
	IN? COL-MARSTON,HALLWAY-3 \FALSE
	CALL GANGS-ALL-HERE >STACK
	RSTACK
?L21:	EQUAL? L,OFFICE \?L25
	SET 'THREE-STOOGES-IN-OFFICE?,1
	CALL UNPRIORITIZE,COCHRANE
	CALL NEW-SCRIPT,COCHRANE,COCHRANE-LOOP
	CALL GRAB-ATTENTION,COCHRANE
	RFALSE
?L25:	EQUAL? L,EAST-BATH \FALSE
	FCLEAR EAST-BATH-DOOR,OPENBIT
	CALL ESTABLISH-GOAL,COCHRANE,BALLROOM-9
	RFALSE

	.FUNCT OSTMANN-DESC-F,RARG=0
	PRINTI "Samuel "
	PRINTD OSTMANN
	PRINTI ", "
	FSET? OSTMANN,TOLD \?L3
	PUSH STR?196
	JUMP ?L5
?L3:	PUSH STR?197
?L5:	PRINT STACK
	PRINTI " as a vampire, is"
	CALL TELL-HERE >STACK
	RSTACK

	.FUNCT OSTMANN-F
	EQUAL? WINNER,OSTMANN \?L1
	EQUAL? PRSA,V?HELLO \?L3
	PRINTI """How do you do. My name is Samuel "
	PRINTD OSTMANN
	PRINTR "."""
?L3:	CALL DONT-HANDLE? >STACK
	ZERO? STACK \FALSE
	PRINTD OSTMANN
	PRINTR " politely demurs."
?L1:	EQUAL? PRSA,V?EXAMINE \?L11
	PRINTI "Samuel "
	PRINTD OSTMANN
	PRINTR " is a very formal, slightly pudgy vampire. He has a black cape with a red lining, but otherwise is in full evening dress; a somewhat old-fashioned tuxedo. The vampire effect is achieved by a realistic set of fangs which he rubs occasionally, as though they itched."
?L11:	EQUAL? PRSA,V?REVEAL \?L14
	EQUAL? PRSO,GLOBAL-MURDER \?L14
	CALL REVEAL-MURDER,OSTMANN >STACK
	ZERO? STACK /?L15
	PRINTR """This is a terrible thing...for all of us."" His tone indicates that the worst thing about murder is that it's a breach of etiquette."
?L15:	PRINTR """Yes. I know."""
?L14:	EQUAL? PRSA,V?SHOW \?L22
	EQUAL? PRSO,SALE-AGREEMENT,SALE-FOLDER \FALSE
	ZERO? OSTMANN-SEEN-AGREEMENT? /?L25
	PRINTR """You showed me that before. What makes you think the situation has changed?"""
?L25:	SET 'OSTMANN-SEEN-AGREEMENT?,1
	PRINTD OSTMANN
	PRINTI " looks surprised. ""Where did you get that? That's the agreement "
	PRINTD VERONICA
	PRINTI " and I were supposed to sign tonight. I wouldn't come to a party like this if I didn't have to. Well, actually I guess I'm having a pretty good time."""
	FSET? OSTMANN,TOLD \?L32
	PRINTI " "
	PRINTD OSTMANN
	PRINTI " is thoughtful for a moment. ""Something struck me as odd. She put me off earlier this evening when I wanted to sign then. She said she had some other business to take care of first. She seemed preoccupied. I tried to change her mind but she was adamant."""
?L32:	CRLF
	RTRUE
?L22:	EQUAL? PRSA,V?ASK-ABOUT \FALSE
	EQUAL? PRSO,OSTMANN \FALSE
	FSET? PRSI,PERSON /?L39
	EQUAL? PRSI,GLOBAL-MURDER \?L41
	FSET? PRSO,TOLD \?L43
	PRINTR """It's terrible! She had agreed to sell me this property, we were going to finalize the deal tonight. Someone must have wanted to stop it!"""
?L43:	PRINT I-DONT-KNOW
	PRINTR "of any murder."""
?L41:	EQUAL? PRSI,SALE,SALE-FOLDER,SALE-AGREEMENT \?L50
	ZERO? OSTMANN-SEEN-AGREEMENT? /?L51
	PRINTR """She told me this area is getting too suburban. It's no longer a proper place to raise horses. She wants to buy up-county, where it's still rural. There'd be a hefty profit from selling this place, but the new one is even more expensive. She said she could raise the money, though."""
?L51:	PRINTR """I'm not sure I know what you're talking about. You do like to pry into other people's business, don't you?"""
?L50:	IN? PRSI,HERE \?L58
	PRINTI """That's an interesting "
	CALL DPRINT,PRSI
	PRINTR "."""
?L58:	PRINTR """I'm not sure what you want me to say."""
?L39:	EQUAL? PRSI,PLAYER \?L64
	PRINTR """I've never met you before, so I don't really have an opinion. You are somewhat impolite."""
?L64:	EQUAL? PRSI,OSTMANN \?L67
	PRINTI """I'm just a businessman trying to make a profit, trying to keep busy.[RWD_ID: people:3015, VAL: 1]"
	ZERO? OSTMANN-SEEN-AGREEMENT? /?L70
	PRINTI " For example, what I planned to do with this property is build mostly condominiums, if I can get the zoning. Some two-acre lots, too. This is really the last undeveloped property in this section of the county."
	CRLF
?L70:	PRINTR """"
?L67:	EQUAL? PRSI,GLOBAL-COCHRANE \?L77
	ZERO? OSTMANN-SEEN-AGREEMENT? /?L78
	PRINTI """That weasel! I've half a mind to sue, after what he tried trying to get this property!"
	JUMP ?L82
?L78:	PRINTI """He's going to be in big trouble before he's done."
?L82:	PRINTI " He's already up before"
	PRINT REAL-ESTATE-BOARD
	PRINTI " for unethical practices: cleaning out the escrow accounts, from what I've heard. He and his agents are a disgrace to the profession! I can't believe "
	PRINTD VERONICA
	PRINTR " invited him. He must be crashing the party. He's certainly got enough gall!"""
?L77:	IN? PRSI,HERE \?L87
	PRINTI """Why don't you ask "
	CALL HIM$002fHER-PRINT,PRSI
	PRINTR " yourself?"""
?L87:	EQUAL? PRSI,GLOBAL-MICHAEL \?L90
	ZERO? OSTMANN-SEEN-AGREEMENT? /?L91
	PRINTI """He's just a parasite. "
	PRINTD VERONICA
	PRINTR " told me he opposed the sale. It's going to cost more to buy the new place and he'll have less to play with."""
?L91:	PRINTR """He's pathetic. What does he do? A man should be doing something, or he's just a parasite."""
?L90:	EQUAL? PRSI,GLOBAL-VERONICA,GLOBAL-MURDER,CORPSE \?L98
	EQUAL? PRSI,GLOBAL-MURDER \?L99
	FSET? OSTMANN,TOLD /?L104
	PRINTR """What murder?"""
?L99:	FSET? OSTMANN,TOLD \?L103
?L104:	PRINTI """I think someone must have wanted to stop the sale! That crook "
	PRINTD COCHRANE
	PRINTR "! I bet he did it!"""
?L103:	PRINTI """"
	PRINTD VERONICA
	PRINTR " is a woman with a sure sense of what she wants, and a good head for business."""
?L98:	EQUAL? PRSI,GLOBAL-ALICIA \?L109
	PRINT I-DONT-KNOW
	PRINTI "her. I understand she's a friend of "
	PRINTD VERONICA
	PRINTR "'s."""
?L109:	EQUAL? PRSI,GLOBAL-RICHARD \?L112
	FSET? PRSO,TOLD \?L113
	PRINTI """"
	PRINTD VERONICA
	PRINTR " told me he hated her. Now he's got the last laugh. He probably inherits it all."""
?L113:	PRINTI """Another parasite. The family is full of them. "
	PRINTD VERONICA
	PRINTR " is the only one who's got any energy."""
?L112:	EQUAL? PRSI,GLOBAL-COL-MARSTON \?L120
	PRINTI """He's an old dinosaur. A toothy one, though. I'd be wary of him. He think's he's 'in loco parentis' to "
	PRINTD VERONICA
	PRINTR " and Richard."""
?L120:	EQUAL? PRSI,GLOBAL-LINDA \?L123
	PRINTI """"
	PRINTD VERONICA
	PRINTR " called her 'Richard's bar girl'."""
?L123:	EQUAL? PRSI,GLOBAL-SEN-ASHER \?L126
	PRINTR """He's done a lot for this state. Has a good understanding of the needs of the businessman. I contributed to his last campaign."""
?L126:	EQUAL? PRSI,GLOBAL-BUTLER \?L129
	PRINTR """He looks uncomfortable."""
?L129:	EQUAL? PRSI,GLOBAL-BARTENDER \?L132
	PRINTR """He's going to be a lawyer, he said."""
?L132:	PRINTR """I haven't any opinion."""

	.FUNCT G-OSTMANN,GARG
	ZERO? GARG \?L1
	CALL IMOVEMENT,OSTMANN,G-OSTMANN >STACK
	RSTACK
?L1:	EQUAL? GARG,G-IMPATIENT \?L3
	PRINTD OSTMANN
	PRINTR " is getting impatient, but is too polite to say so."
?L3:	EQUAL? GARG,G-ENROUTE \?L6
	CALL C$0026D-SNUB >STACK
	RSTACK
?L6:	EQUAL? GARG,G-REACHED,G-ALREADY \FALSE
	LOC OSTMANN >STACK
	EQUAL? STACK,BALLROOM-9 \?L8
	CALL NEW-SCRIPT,OSTMANN,OSTMANN-LOOP
?L8:	CALL C$0026D-SNUB >STACK
	RSTACK

	.FUNCT C$0026D-SNUB
	IN? OSTMANN,HERE \FALSE
	IN? COCHRANE,HERE \FALSE
	ZERO? COCHRANE-LOOKS-FOR-OSTMANN? /?L3
	SET 'COCHRANE-LOOKS-FOR-OSTMANN?,0
	PRINTD COCHRANE
	PRINTI " comes up behind "
	PRINTD OSTMANN
	PRINTI ". ""You've got this coming!"" he yells, and takes a roundhouse swing at his nose. "
	PRINTD OSTMANN
	PRINTI " ducks and returns the blow with surprising skill, right to the solar plexus. "
	PRINTD COCHRANE
	PRINTR " folds up like a house of cards, and drops to the floor with a look of surprise and resentment."""
?L3:	PRINTD OSTMANN
	PRINTI " and "
	CALL DPRINT,COCHRANE
	PRINTI " are here, "
	CALL PICK-ONE,COCHRANE-VS-OSTMANN >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT BUTLER-DESC-F,RARG=0,OBJ
	PRINTD BUTLER
	PRINTI " the butler"
	ZERO? ENTANGLED? /?L3
	PRINTR " appears to be tying his shoelaces with someone else's teeth, or a similar contortion."
?L3:	CALL PRINT-CONTENTS,BUTLER,STR?198,GORILLA-COSTUME >STACK
	ZERO? STACK /?L7
	PRINTR "."
?L7:	IN? BUTLER,EAST-COAT-CLOSET \?L10
	PRINTR " is straightening up some coats."
?L10:	ZERO? SLAPSTICK? \?L13
	CALL IN-MOTION?,VERONICA >STACK
	ZERO? STACK /?L13
	PRINTR " is helping a guest with his coat."
?L13:	PRINTR ", maintaining his regal bearing even though costumed as a gorilla, waits nearby."

	.FUNCT BUTLER-F
	EQUAL? WINNER,BUTLER \?L1
	ZERO? ENTANGLED? /?L3
	PRINTD BUTLER
	PRINTR " is in no condition to talk now."
?L3:	EQUAL? PRSA,V?HELLO \?L7
	PRINTR """How do you do? A lovely evening, isn't it?"""
?L7:	EQUAL? PRSA,V?GIVE \?L10
	EQUAL? PRSO,GLASS \?L11
	PRINTR """I'm sorry, but you might cut yourself. I propose to throw this in the trash."""
?L11:	EQUAL? PRSI,PLAYER \?L15
	MOVE PRSO,PRSI
	PRINTI """If you insist,"" he replies, handing you "
	CALL TELL-PRSO >STACK
	RSTACK
?L15:	PRINTR "He politely refuses."
?L10:	CALL DONT-HANDLE? >STACK
	ZERO? STACK \FALSE
	PRINTD BUTLER
	PRINTR " looks at you calmly through the eyeholes of his gorilla suit."
?L1:	EQUAL? PRSA,V?EXAMINE \?L25
	PRINTI "George "
	PRINTD BUTLER
	PRINTI ", the butler, is resplendent in an all-over gorilla suit, over which he is wearing his butler's uniform (up to and including white gloves). The effect is striking, particularly when he speaks, as "
	PRINTD BUTLER
	PRINTR " has a British accent."
?L25:	EQUAL? PRSA,V?DANCE \?L28
	PRINTR """I beg your pardon? I'm working, as you can see."""
?L28:	EQUAL? PRSA,V?REVEAL \?L31
	EQUAL? PRSO,GLOBAL-MURDER \?L31
	CALL REVEAL-MURDER,BUTLER >STACK
	ZERO? STACK /?L32
	PRINTR """A tragedy."" He seems to be genuinely saddened by the news."
?L32:	PRINTR """It is extremely improper of you to be conveying this news in such a callous way."""
?L31:	EQUAL? PRSA,V?GIVE \?L39
	EQUAL? PRSO,YOUR-COAT,ALICIA-COAT \?L40
	MOVE PRSO,BUTLER
	CALL NEW-SCRIPT,BUTLER,BUTLER-LOOP
	IN? BUTLER,HERE \TRUE
	EQUAL? WINNER,PLAYER /?L44
	CALL DPRINT,WINNER,1
	PRINTI " gives "
	CALL HIM$002fHER-PRINT,WINNER,1
	PRINTI " coat to the butler."
	CRLF
?L44:	PRINTR """Thank you, I'll go hang it up. I believe you know your way to the ballroom? It's down the long hall to the right. I hope you enjoy your evening."""
?L40:	EQUAL? PRSO,GLASS \?L52
	MOVE GLASS,BUTLER
	CALL ESTABLISH-GOAL,BUTLER,KITCHEN,1
	PRINTR "The butler takes it carefully. ""You could have cut yourself,"" he comments."
?L52:	IN? BUTLER,HERE \TRUE
	PRINTI "The butler politely refuses "
	CALL TELL-PRSO
	RTRUE
?L39:	EQUAL? PRSA,V?ASK-ABOUT \FALSE
	EQUAL? PRSO,BUTLER \FALSE
	PRINTD BUTLER
	PRINTR " ignores the question."

	.FUNCT G-BUTLER,GARG,NA=0,OW,COAT,L,FLG=0,HERE?
	LOC BUTLER >L
	EQUAL? HERE,L /?L1
	SET 'HERE?,0
	JUMP ?L2
?L1:	SET 'HERE?,1
?L2:	SET 'OW,WINNER
	ZERO? GARG \?L3
	CALL IMOVEMENT,BUTLER,G-BUTLER >STACK
	RSTACK
?L3:	EQUAL? GARG,G-IMPATIENT \?L5
	PRINTI """Pardon me,"" says "
	PRINTD BUTLER
	PRINTR ", ""but I have work to do."""
?L5:	EQUAL? GARG,G-ENROUTE \?L8
	ZERO? NEW-ARRIVAL \FALSE
	IN? ALICIA,L \?L11
	SET 'NA,ALICIA
	SET 'COAT,ALICIA-COAT
	JUMP ?L15
?L11:	IN? DETECTIVE,L \?L13
	SET 'NA,DETECTIVE
	SET 'COAT,DETECTIVE-COAT
	JUMP ?L15
?L13:	IN? DUFFY,L \?L14
	SET 'NA,DUFFY
	SET 'COAT,DUFFY-COAT
	JUMP ?L15
?L14:	CALL META-LOC,PLAYER >STACK
	EQUAL? STACK,L \?L15
	SET 'NA,PLAYER
	SET 'COAT,YOUR-COAT
?L15:	ZERO? NA /?L17
	IN? COAT,NA \?L35
	FSET? COAT,RMUNGBIT /?L35
	FSET COAT,RMUNGBIT
	ZERO? HERE? /?L21
	PRINTD BUTLER
	PRINTI " says to "
	EQUAL? NA,PLAYER \?L25
	PRINTI "you"
	JUMP ?L29
?L25:	CALL DPRINT,NA
?L29:	PRINTI ", ""If you would be so kind as to give me your coat, I'll hang it up for you."""
	CRLF
?L21:	EQUAL? NA,PLAYER /?L35
	SET 'WINNER,NA
	CALL PERFORM,V?GIVE,COAT,BUTLER
	SET 'WINNER,OW
?L35:	RETURN HERE?
?L17:	IN? GLASS,BALLROOM-8 \FALSE
	CALL IN-MOTION?,VERONICA >STACK
	ZERO? STACK \FALSE
	CALL ESTABLISH-GOAL,BUTLER,BALLROOM-8,1
	RFALSE
?L8:	EQUAL? GARG,G-REACHED,G-ALREADY \FALSE
	CALL UNPRIORITIZE,BUTLER
	IN? BUTLER,HALL \?L45
	ZERO? NEW-ARRIVAL /?L47
	CALL NEW-ARRIVAL-STUFF,BUTLER >FLG
	JUMP ?L49
?L47:	EQUAL? HERE,HALL \?L49
	SET 'FLG,1
	PRINTI "The butler looks out the "
	PRINTD FRONT-DOOR
	PRINTI ", finds no one waiting, and resumes his regular rounds."
	CRLF
?L49:	CALL NEW-SCRIPT,BUTLER,BUTLER-LOOP
	RETURN FLG
?L45:	IN? BUTLER,EAST-COAT-CLOSET \?L53
	CALL DUMP-COATS >STACK
	ZERO? STACK /FALSE
	ZERO? HERE? /FALSE
	PRINTD BUTLER
	PRINTR " hangs the coat in the closet."
?L53:	EQUAL? L,BALLROOM-8 \?L62
	IN? GLASS,BALLROOM-8 \FALSE
	MOVE GLASS,BUTLER
	CALL ESTABLISH-GOAL,BUTLER,KITCHEN,1
	CALL IN-BALLROOM?,PLAYER >STACK
	ZERO? STACK /FALSE
	PRINTD BUTLER
	PRINTI " unobtrusively sweeps up "
	CALL THE-PRINT,GLASS
	PRINTR "."
?L62:	EQUAL? L,KITCHEN \FALSE
	IN? GLASS,BUTLER \FALSE
	EQUAL? HERE,KITCHEN \?L72
	PRINTD BUTLER
	PRINTI " dumps "
	CALL THE-PRINT,GLASS
	PRINTI " in "
?L72:	IN? TRASH-BASKET,KITCHEN \?L77
	MOVE GLASS,TRASH-BASKET
	EQUAL? HERE,KITCHEN \FALSE
	CALL THE-PRINT,TRASH-BASKET
	PRINTR "."
?L77:	REMOVE GLASS
	EQUAL? HERE,KITCHEN \FALSE
	PRINTR "the garbage disposal."

	.FUNCT DUMP-COATS,N,X,ROBBED?=0
	FIRST? BUTLER >X /?L4
	RETURN ROBBED?
?L1:	ZERO? X \?L4
	RETURN ROBBED?
?L4:	NEXT? X >N /?L7
?L7:	FSET? X,TAKEBIT \?L8
	EQUAL? X,GLASS /?L8
	MOVE X,EAST-COAT-CLOSET
	FCLEAR X,NDESCBIT
	SET 'ROBBED?,X
?L8:	SET 'X,N
	JUMP ?L1

	.FUNCT TRASH-BASKET-F
	EQUAL? PRSA,V?SEARCH,V?EXAMINE,V?LOOK-INSIDE \FALSE
	IN? GLASS,TRASH-BASKET \?L3
	PRINTI "A "
	PRINTD GLASS
	PRINTI " is on top"
	JUMP ?L7
?L3:	PRINTI "It's nearly full"
?L7:	PRINTI " of uninteresting garbage"
	CALL PRINT-CONTENTS,TRASH-BASKET,STR?199,GLASS
	PRINTR "."

	.FUNCT BARTENDER-F,OW
	SET 'OW,WINNER
	EQUAL? WINNER,BARTENDER \?L1
	EQUAL? PRSA,V?HELLO \?L3
	PRINT HEY-BARTENDER
	CRLF
	RTRUE
?L3:	EQUAL? PRSA,V?MAKE,V?GIVE \?L7
	ZERO? PRSI /FALSE
	EQUAL? PRSO,DRINK,GLOBAL-DRINK /?L11
	EQUAL? PRSI,DRINK,GLOBAL-DRINK \?L10
?L11:	EQUAL? PRSI,ME,PLAYER /?L14
	EQUAL? PRSO,ME,PLAYER \?L12
?L14:	INC 'DRINK-COUNT
	PRINTI """Sure."
	IN? DRINK,PLAYER \?L17
	PRINTI " Here, let me take your old one."
?L17:	CALL THIS-IS-IT,DRINK
	MOVE DRINK,PLAYER
	PUTP DRINK,P?SIZE,10
	GRTR? DRINK-COUNT,3 \?L22
	PRINTI " Don't you think you've had enough?"""
	CRLF
	CALL PRINT-ID,STR?200 >STACK
	RSTACK
?L22:	PRINTR """ The bartender swiftly and efficiently mixes a drink, then hands it to you."
?L12:	FSET? PRSO,PERSON /?L30
	FSET? PRSI,PERSON \?L29
?L30:	PRINTI """"
	PRINT YOU-SHOULD
	PRINTR "let people order their own drinks."""
?L29:	PRINTR """Pardon?"""
?L10:	PRINTR """I'm afraid I can't make one of those."""
?L7:	CALL DONT-HANDLE? >STACK
	ZERO? STACK \FALSE
	PRINTR """Sorry, I've been hired to mix drinks and that's all I'll do."""
?L1:	EQUAL? PRSA,V?HELLO \?L43
	PRINT HEY-BARTENDER
	CRLF
	RTRUE
?L43:	EQUAL? PRSA,V?TIP \?L46
	PRINTI """Thanks."""
	CRLF
	CALL PRINT-ID,STR?201 >STACK
	RSTACK
?L46:	EQUAL? PRSA,V?ASK-FOR \?L49
	EQUAL? PRSI,DRINK,GLOBAL-DRINK \?L50
	SET 'WINNER,BARTENDER
	CALL PERFORM,V?GIVE,DRINK,PLAYER
	SET 'WINNER,OW
	RTRUE
?L50:	PRINTR """I don't have that."""
?L49:	EQUAL? PRSA,V?REVEAL \?L55
	EQUAL? PRSO,GLOBAL-MURDER \?L55
	CALL REVEAL-MURDER,BARTENDER >STACK
	ZERO? STACK /?L56
	PRINTR """I hope I'll still get paid."" He realizes that wasn't a very tactful remark, and tries to recover. ""It's too bad."""
?L56:	PRINTR """I know. You'd think it would quiet these people down, but it hasn't."""
?L55:	EQUAL? PRSA,V?EXAMINE \?L63
	PRINTR "Jack Johnson, the bartender, is a well-barbered young man wearing a red uniform and, as his only concession to the theme of the party, a simple domino mask."
?L63:	EQUAL? PRSA,V?DANCE \?L66
	PRINTR """Sorry, I'm on duty."""
?L66:	EQUAL? PRSA,V?ASK-ABOUT \FALSE
	EQUAL? PRSO,BARTENDER \FALSE
	EQUAL? PRSI,DRINK,GLOBAL-DRINK,BAR \?L70
	PRINTR """I know a lot about drinks."""
?L70:	EQUAL? PRSI,GLOBAL-MURDER \?L74
	FSET? PRSO,TOLD \?L75
	PRINTR """It certainly puts a damper on the evening for me, but no one else seems too concerned."""
?L75:	PRINTR """What? What murder?"""
?L74:	EQUAL? PRSI,PLAYER \?L82
	PRINTR """I'm interested in things like libel law, and the first amendment. We should talk later, I'm sure your views are interesting."""
?L82:	EQUAL? PRSI,BARTENDER \?L85
	PRINTR """I'm Jack Johnson. I'm trying to pay some of my tuition by working behind bars. Get it? Well, I get quite a view of mankind. It's good practice, I'm going to be a lawyer."""
?L85:	IN? PRSI,HERE \?L88
	PRINTR "Glancing discreetly at the subject of the inquiry, Jack only smiles."
?L88:	EQUAL? PRSI,GLOBAL-MICHAEL \?L91
	PRINTR """Nice guy, sort of the hail-fellow-well-met type. Practically broke my hand shaking it when I first came in. Likes a very dry martini, already had a couple tonight. 'You want dry?' I told him. I pour the gin in, and then I kinda wave the fumes from the vermouth over the glass. He thought that was a good one..."""
?L91:	EQUAL? PRSI,GLOBAL-VERONICA \?L94
	PRINTR """One of her friends told her about me. I worked a party over there a month or so ago, so Ms. Ashcroft asks the agency for me specifically. I can use the dough. Going to Law School, and it ain't cheap."" He looks significantly at the tip glass. ""Anyway, she had a Singapore Sling: most of these women like a sweet drink."""
?L94:	EQUAL? PRSI,GLOBAL-LINDA \?L97
	PRINTR """A knockout, isn't she? She actually drinks sloe gin fizzes. I didn't think anybody over 21 could stand them."""
?L97:	EQUAL? PRSI,GLOBAL-RICHARD \?L100
	PRINTR """He seems sort of beaten down. You see too many of them in this business. Like they're carrying something too heavy."""
?L100:	EQUAL? PRSI,GLOBAL-COL-MARSTON \?L103
	PRINTR """A very distinguished gentleman, and he knows it. Of course, the fact that he knows it spoils the whole effect."""
?L103:	EQUAL? PRSI,GLOBAL-ALICIA \?L106
	ZERO? ALICIA-HERE? /?L107
	PRINTR """Nice harem costume."""
?L107:	PRINTR """I haven't seen her."""
?L106:	EQUAL? PRSI,GLOBAL-SEN-ASHER \?L114
	PRINTR """The man's a true politician. Not even up for election for another four years, and he's doing the whole campaign bit the first time he comes over for a drink. Of course, I guess I'm the closest thing there is to the public here, the average income in this room must be something. He told me he's a teetotaler, too: ordered a soft drink. His father was an alcoholic and the Senator could never bring himself to drink, remembering."""
?L114:	EQUAL? PRSI,GLOBAL-COCHRANE \?L117
	PRINTR """That one? He'll be out before the night's over. Straight bourbon, no ice, and beer chasers. I'm surprised he can stand up now. He's had three already."""
?L117:	EQUAL? PRSI,GLOBAL-OSTMANN \?L120
	FSET? PRSO,TOLD \?L121
	PRINTI """He's taking "
	PRINTD VERONICA
	PRINTR "'s death hard. I wonder why."""
?L121:	PRINTR """He's very pleased with himself, isn't he?"""
?L120:	EQUAL? PRSI,GLOBAL-BUTLER \?L128
	PRINTR """He's been quite helpful. He obviously knows his job."""
?L128:	CALL I-WOULDNT-KNOW >STACK
	RSTACK

	.FUNCT I-WOULDNT-KNOW
	PRINTR """I wouldn't know."""

	.FUNCT DRINK-F,OW
	SET 'OW,WINNER
	EQUAL? PRSA,V?ASK-FOR \?L1
	EQUAL? HERE,BALLROOM-9 \?L3
	SET 'WINNER,BARTENDER
	CALL PERFORM,V?GIVE,DRINK,OW
	SET 'WINNER,OW
	RTRUE
?L3:	PRINTR "Drinks may be obtained at the bar."
?L1:	EQUAL? PRSA,V?POUR-ON,V?THROW \?L8
	PUTP PRSO,P?SIZE,5
	RFALSE
?L8:	EQUAL? PRSA,V?DRINK \?L9
	EQUAL? PRSO,DRINK /?L10
	PRINTI "Perhaps you've had one too many already. There is no drink"
	CALL TELL-HERE >STACK
	RSTACK
?L10:	GETP DRINK,P?SIZE >STACK
	EQUAL? STACK,5 \?L14
	PRINTR "It's empty. If you want more, you'll need a refill."
?L14:	GETP DRINK,P?SIZE >STACK
	DEC 'STACK
	PUTP DRINK,P?SIZE,STACK
	PRINTR "You sip the drink. It's cold and tasty, but perhaps a little stronger than you would like."
?L9:	EQUAL? PRSA,V?TAKE \FALSE
	IN? DRINK,PLAYER \?L21
	PRINTR "You already have one."
?L21:	EQUAL? HERE,BALLROOM-9 \FALSE
	IN? DRINK,HERE /FALSE
	CALL PERFORM,V?ORDER,DRINK
	RTRUE

	.FUNCT G-BARTENDER,GARG
	ZERO? GARG \FALSE
	CALL IMOVEMENT,BARTENDER,G-BARTENDER >STACK
	RSTACK

	.FUNCT DETECTIVE-DESC-F,RARG=0
	CALL THE-PRINT,DETECTIVE,1
	LOC DETECTIVE >STACK
	EQUAL? STACK,BALLROOM-8,BALLROOM-9 \?L3
	PRINTR " stands nearby, weighing evidence."
?L3:	IN? DETECTIVE,OFFICE \?L7
	SET 'LAST-FROB,FROB
	CALL PICK-ONE,OFFICE-FROBS >FROB
	PRINTI " is examining "
	CALL THE-PRINT,FROB
	PRINTR "."
?L7:	PRINTI " is here"
	CALL META-LOC,CORPSE >STACK
	EQUAL? STACK,HERE \?L13
	PRINTI ", examining "
	CALL DPRINT,CORPSE
	JUMP ?L17
?L13:	LESS? DETECTIVE-SEEN,5 \?L17
	ZERO? DETECTIVE-SEEN-CORPSE? \?L18
	ZERO? DETECTIVE-SEEN-ROPE? \?L18
	ZERO? DETECTIVE-SEEN-BULLET? /?L17
?L18:	PRINTI ", eyeing you suspiciously"
?L17:	PRINTR "."

	.FUNCT DETECTIVE-F,OSEEN,?TMP
	EQUAL? WINNER,DETECTIVE \?L1
	EQUAL? PRSA,V?GIVE \?L3
	EQUAL? PRSO,DETECTIVE-COAT \?L3
	EQUAL? PRSI,BUTLER \?L3
	IN? BUTLER,HERE \TRUE
	CALL THE-PRINT,DETECTIVE,1
	PRINTR " politely refuses to yield the trenchcoat."
?L3:	ZERO? DETECTIVE-BEEN-TO-OFFICE? \?L10
	IN? DETECTIVE,HERE \?L10
	EQUAL? PRSA,V?$0024REVEAL,V?$0024DISCOVER /?L10
	PRINTR """Can't this wait until I've visited the scene of the crime?"""
?L10:	EQUAL? PRSA,V?LOOK-INSIDE \?L13
	EQUAL? PRSO,FAIRY-MASK \?L13
	IN? HAIR,FAIRY-MASK \?L14
	FCLEAR HAIR,INVISIBLE
	SET 'WINNER,PLAYER
	CALL PERFORM,V?SHOW,HAIR,DETECTIVE
	SET 'WINNER,DETECTIVE
	RTRUE
?L14:	PRINTR """Yes, I'm looking... What's inside that's so interesting? I don't see any blood or anything."""
?L13:	EQUAL? PRSA,V?ACCUSE,V?ARREST \?L19
	EQUAL? PRSI,GLOBAL-EMBEZZLEMENT \?L20
	PRINTR """We'll worry about that after we've solved the murder, okay?"""
?L20:	EQUAL? PRSO,OBJECT-PAIR \?L24
	GET P-PRSO,P-MATCHLEN >STACK
	GRTR? STACK,2 \?L25
	PRINTR """Sure, why don't I just run them all in?"""
?L25:	GET P-PRSO,1 >STACK
	GETP STACK,P?CHARACTER >STACK
	ZERO? STACK /?L29
	GET P-PRSO,2 >STACK
	GETP STACK,P?CHARACTER >STACK
	ZERO? STACK /?L29
	GET P-PRSO,1 >STACK
	CALL LOCALIZE,STACK >?TMP
	GET P-PRSO,2 >STACK
	CALL LOCALIZE,STACK >STACK
	CALL ARREST,?TMP,STACK >STACK
	RSTACK
?L29:	PRINTR """Arrested development, that's what you've got."""
?L24:	GETP PRSO,P?CHARACTER >STACK
	ZERO? STACK /?L33
	EQUAL? PRSO,VERONICA,GLOBAL-VERONICA /?L33
	GRTR? DETECTIVE-SEEN,4 \?L34
	CALL LOCALIZE,PRSO >STACK
	CALL ARREST,STACK >STACK
	RSTACK
?L34:	PRINTI """Whoa! Who's "
	CALL THE-PRINT,DETECTIVE
	PRINTR " here? If you can give me enough good reasons to arrest someone, I might listen to you, but you haven't given me enough!"""
?L33:	PRINTR """That's the silliest thing I've ever heard."""
?L19:	EQUAL? PRSA,V?ANALYZE \?L42
	CALL META-LOC,PRSO >STACK
	EQUAL? STACK,HERE,POLICE-LAB /?L43
	CALL NOT-HERE,PRSO
	RTRUE
?L43:	EQUAL? PRSO,GLASS \?L45
	CALL CHECK-GLASS >STACK
	RSTACK
?L45:	EQUAL? PRSI,GLOBAL-FINGERPRINTS \?L46
	PRINTI """I doubt we'll find any "
	PRINTD GLOBAL-FINGERPRINTS
	PRINTI " on "
	CALL THE-PRINT,PRSO
	PRINTR "."""
?L46:	EQUAL? PRSO,STAIN \?L49
	CALL THE-PRINT,DETECTIVE,1
	PRINTI " reaches down and snips a small sample of stained cloth from the costume."
	CRLF
	CALL CHECK-JUNK,STAIN-SAMPLE >STACK
	RSTACK
?L49:	EQUAL? PRSO,HAIR \?L52
	IN? HAIR,FAIRY-MASK \?L53
	ZERO? DETECTIVE-SEEN-HAIR? \?L55
	SET 'DETECTIVE-SEEN-HAIR?,1
	INC 'DETECTIVE-SEEN
?L55:	CALL CHECK-JUNK,HAIR >STACK
	RSTACK
?L53:	PRINTR """What's the point of analyzing this hair after you've been fooling around with it?"""
?L52:	EQUAL? PRSO,FAIRY-MASK \?L61
	CALL CHECK-JUNK,FAIRY-MASK >STACK
	RSTACK
?L61:	EQUAL? PRSO,CORPSE \?L62
	PRINTR """I think I'll leave that to the coroner. For the moment, it's enough that she's dead."""
?L62:	PRINTI """I don't think an analysis of "
	CALL THE-PRINT,PRSO
	PRINTR " would reveal any useful information."""
?L42:	EQUAL? PRSA,V?COMPARE \?L68
	EQUAL? PRSO,HAIR,VERONICA-HAIR /?L71
	EQUAL? PRSO,ALICIA-HAIR,LINDA-HAIR \?L69
?L71:	EQUAL? PRSI,HAIR,VERONICA-HAIR /?L72
	EQUAL? PRSI,ALICIA-HAIR,LINDA-HAIR \?L69
?L72:	PRINTI "The detective compares the hairs. ""These hairs are "
	EQUAL? PRSO,PRSI,HAIR \?L75
	EQUAL? PRSI,PRSO,ALICIA-HAIR \?L75
	PRINTI "quite similar"
	JUMP ?L79
?L75:	PRINTI "not alike"
?L79:	PRINTR "."""
?L69:	PRINTR """How about apples and oranges?"""
?L68:	EQUAL? PRSA,V?ASK-ABOUT,V?TELL \?L87
	PRINTR """I'll ask the questions here."""
?L87:	EQUAL? PRSA,V?FIND \?L90
	CALL META-LOC,PRSO >STACK
	EQUAL? STACK,HERE \?L91
	PRINTR """Not too observant, are you?"""
?L91:	PRINTR """It would help if you told me where to look."""
?L90:	CALL DONT-HANDLE? >STACK
	ZERO? STACK \FALSE
	EQUAL? PRSA,V?FINGERPRINT /FALSE
	PRINTR """I'm very busy. There's been a murder, in case you haven't noticed."""
?L1:	EQUAL? PRSA,V?PHONE \?L103
	CALL PERFORM,V?PHONE,POLICE
	RTRUE
?L103:	EQUAL? PRSA,V?EXAMINE \?L104
	EQUAL? PRSO,DETECTIVE \?L104
	CALL THE-PRINT,DETECTIVE,1
	PRINTR " is quiet and intense, wearing a trenchcoat and a crumpled hat. The trenchcoat and hat are still wet from the rain."
?L104:	EQUAL? PRSA,V?GIVE,V?SHOW \?L107
	EQUAL? PRSI,DETECTIVE \?L107
	SET 'OSEEN,DETECTIVE-SEEN
	CALL THE-PRINT,DETECTIVE,1
	EQUAL? PRSO,CORPSE \?L110
	PRINTI " comes over."
	JUMP ?L148
?L110:	ZERO? DETECTIVE-BEEN-TO-OFFICE? \?L114
	PRINTR " says, ""Can't this wait until I've visited the scene of the crime?"""
?L114:	IN? PRSO,DETECTIVE \?L117
	PRINTI " looks at you strangely and then shows "
	CALL THE-PRINT,PRSO
	PRINTR " to you."
?L117:	EQUAL? PRSO,GLASS-ANALYSIS,HAIR-ANALYSIS /?L121
	EQUAL? PRSO,NULL-ANALYSIS,STAIN-ANALYSIS \?L120
?L121:	MOVE PRSO,DETECTIVE
	PRINTR " takes it back. ""Thanks, I hope you found it interesting."""
?L120:	EQUAL? PRSO,HAIR \?L124
	IN? HAIR,FAIRY-MASK \?L124
	IN? FAIRY-MASK,DETECTIVE \?L125
	PRINTI " looks inside the mask."
	JUMP ?L148
?L125:	FSET FAIRY-MASK,TRYTAKEBIT
	MOVE FAIRY-MASK,DETECTIVE
	PRINTI " takes the mask, noting the hair as you point it out."
	JUMP ?L148
?L124:	IN? PRSO,FIREPLACE \?L132
	MOVE PRSO,DETECTIVE
	PRINTI " snatches it from the fireplace."
	JUMP ?L148
?L132:	IN? PRSO,GLOBAL-OBJECTS \?L135
	PRINTR " is confused. ""What are you trying to tell me about?"""
?L135:	FSET? PRSO,PERSON /?L139
	CALL GLOBAL-IN?,PRSO,HERE >STACK
	ZERO? STACK \?L139
	FSET? PRSO,TAKEBIT /?L138
?L139:	PRINTI " looks at "
	CALL THE-PRINT,PRSO
	PRINTI "."
	JUMP ?L148
?L138:	FSET? PRSO,TRYTAKEBIT \?L142
	EQUAL? PRSO,GLASS,BULLET,FAIRY-MASK /?L142
	CALL HELD?,PRSO,PLAYER >STACK
	ZERO? STACK \?L142
	PRINTR " says, ""Would you mind bringing it over?"""
?L142:	EQUAL? PRSA,V?SHOW \?L145
	MOVE PRSO,DETECTIVE
	FSET PRSO,TRYTAKEBIT
	PRINTI " looks at "
	CALL THE-PRINT,PRSO
	PRINTI " for a moment, then takes it."
	JUMP ?L148
?L145:	MOVE PRSO,DETECTIVE
	FSET PRSO,TRYTAKEBIT
	PRINTI " takes "
	CALL THE-PRINT,PRSO
	PRINTI "."
?L148:	EQUAL? JUNK-COUNT,4 \?L151
	PRINTI " ""Go away and stop bothering me!"""
	CRLF
	JUMP ?L272
?L151:	EQUAL? PRSO,CORPSE \?L155
	PRINTI " "
	CALL THE-PRINT,DETECTIVE,1
	ZERO? DETECTIVE-SEEN-CORPSE? /?L158
	PRINTI " looks at the corpse, and replies, ""Show me something I haven't already seen!"""
	CRLF
	JUMP ?L272
?L158:	SET 'DETECTIVE-SEEN-CORPSE?,1
	PRINTI " examines the body."
	CRLF
	JUMP ?L272
?L155:	EQUAL? PRSO,ROPE \?L165
	PRINTI " "
	CALL THE-PRINT,DETECTIVE,1
	PRINTI " examines the rope"
	ZERO? DETECTIVE-SEEN-ROPE? \?L168
	SET 'DETECTIVE-SEEN-ROPE?,1
	INC 'DETECTIVE-SEEN
	PRINTI " with interest"
?L168:	PRINTI "."
	CRLF
	JUMP ?L272
?L165:	EQUAL? PRSO,CARD \?L175
	ZERO? DETECTIVE-SEEN-CARD? /?L176
	PRINTI " ""I've seen that already."""
	CRLF
	JUMP ?L272
?L176:	SET 'DETECTIVE-SEEN-CARD?,1
	INC 'DETECTIVE-SEEN
	ZERO? DETECTIVE-SEEN-AGREEMENT? /?L181
	PRINTI " ""This certainly seems to implicate "
	PRINTD COCHRANE
	PRINTI ". He seems hot-headed enough to commit murder, and the sale provides a motive."""
	CRLF
	JUMP ?L272
?L181:	PRINTI " ""I wonder what this means? What was she doing that she might regret? It certainly casts some suspicion on "
	PRINTD COCHRANE
	PRINTI "."""
	CRLF
	JUMP ?L272
?L175:	EQUAL? PRSO,SALE-AGREEMENT /?L189
	EQUAL? PRSO,SALE-FOLDER \?L188
	IN? SALE-AGREEMENT,SALE-FOLDER \?L188
?L189:	ZERO? DETECTIVE-SEEN-AGREEMENT? \?L190
	SET 'DETECTIVE-SEEN-AGREEMENT?,1
	INC 'DETECTIVE-SEEN
	PRINTI " ""If someone wanted to prevent this sale, it might have been worth committing a murder to do. "
	ZERO? DETECTIVE-SEEN-CARD? /?L194
	PRINTI "Could it have been "
	PRINTD COCHRANE
	JUMP ?L198
?L194:	PRINTI "But who could that have been"
?L198:	PRINTI "?"""
	CRLF
	JUMP ?L272
?L190:	PRINTI " ""Yes, I've seen that. Stop bothering me!"""
	CRLF
	JUMP ?L272
?L188:	EQUAL? PRSO,ALICIA-COAT \?L206
	ZERO? DETECTIVE-SEEN-COAT? \?L207
	SET 'DETECTIVE-SEEN-COAT?,1
	ZERO? DETECTIVE-TOLD-ABOUT-RAIN? \?L209
	PRINTI " ""I don't see the significance of this. It's been raining all night, as far as I know. Everyone's coat is wet."""
	CRLF
	JUMP ?L272
?L209:	ADD DETECTIVE-SEEN,2 >DETECTIVE-SEEN
	PRINTI " ""Hmm. When Alicia arrived it wasn't raining, and this coat is wet! She must have really been outside during the rain."""
	CRLF
	JUMP ?L272
?L207:	PRINTI " ""Yes, it's still wet."""
	CRLF
	JUMP ?L272
?L206:	EQUAL? PRSO,TRUST-DOCUMENTS /?L220
	EQUAL? PRSO,TRUST-FOLDER \?L219
	IN? TRUST-DOCUMENTS,TRUST-FOLDER \?L219
?L220:	ZERO? DETECTIVE-SEEN-TRUST-DOCUMENTS? \?L221
	SET 'DETECTIVE-SEEN-TRUST-DOCUMENTS?,1
	INC 'DETECTIVE-SEEN
	FCLEAR TRUST-DOCUMENTS,NDESCBIT
	PRINTI " ""Where did you get this? It's important![RWD_ID: people:3940, VAL: 1]"
	ZERO? DETECTIVE-SEEN-LIST? /?L225
	PRINTI " This means that "
	PRINTD MICHAEL
	PRINTI " and "
	PRINTD COL-MARSTON
	PRINTI " were embezzling from the family trust. And further, "
	PRINTD VERONICA
	PRINTI " knew it!"
?L225:	PRINTI """"
	CRLF
	JUMP ?L272
?L221:	PRINTI " ""Don't you have anything new to show me?"""
	CRLF
	JUMP ?L272
?L219:	EQUAL? PRSO,GLASS \?L235
	ZERO? DETECTIVE-SEEN-GLASS? \?L236
	PRINTI " "
	CALL CHECK-GLASS
	JUMP ?L272
?L236:	PRINTI " ""It's the same glass, right?"""
	CRLF
	JUMP ?L272
?L235:	EQUAL? PRSO,FAIRY-MASK \?L243
	PRINTI " ""What's so interesting about this mask?"""
	CRLF
	JUMP ?L272
?L243:	EQUAL? PRSO,HAIR \?L246
	IN? HAIR,FAIRY-MASK \?L247
	FSET? HAIR,INVISIBLE /?L247
	ZERO? DETECTIVE-SEEN-HAIR? \?L249
	SET 'DETECTIVE-SEEN-HAIR?,1
	INC 'DETECTIVE-SEEN
	PRINTI " ""A "
	PRINTD HAIR
	PRINTI ", eh? "
	PRINTD VERONICA
	PRINTI "'s hair was blonde. How did a hair this color get into this mask?"""
	CRLF
	JUMP ?L272
?L249:	PRINTI " ""Same old hair, eh?"""
	CRLF
	JUMP ?L272
?L247:	PRINTI " ""It looks like a hair. What is it supposed to prove? You're going to be in deep trouble if you've been disturbing evidence!"""
	CRLF
	JUMP ?L272
?L246:	EQUAL? PRSO,INVESTOR-LIST \?L259
	ZERO? DETECTIVE-SEEN-LIST? \?L260
	SET 'DETECTIVE-SEEN-LIST?,1
	INC 'DETECTIVE-SEEN
	ZERO? DETECTIVE-SEEN-TRUST-DOCUMENTS? /?L262
	PRINTI " "
	CALL THE-PRINT,DETECTIVE,1
	PRINTI " reads the paper with growing excitement. ""This is it! The motive I've been looking for!"""
	CRLF
	JUMP ?L272
?L262:	PRINTI " ""What's the significance of this? "
	PRINTD COL-MARSTON
	PRINTI " and "
	PRINTD MICHAEL
	PRINTI " were co-investors in something?"""
	CRLF
	JUMP ?L272
?L260:	PRINTI " ""Seen it before."""
	CRLF
	JUMP ?L272
?L259:	INC 'JUNK-COUNT
	PRINTI " "
	GET JUNK-STRINGS,JUNK-COUNT >STACK
	PRINT STACK
	CRLF
?L272:	GRTR? DETECTIVE-SEEN,OSEEN \TRUE
	CALL GRAB-ATTENTION,DETECTIVE
	RTRUE
?L107:	EQUAL? PRSA,V?TELL-ME \?L278
	EQUAL? PRSO,DETECTIVE \?L278
	EQUAL? PRSI,WEATHER \?L279
	ZERO? SAW-RAIN-SLACK-OFF? /?L281
	ZERO? DETECTIVE-TOLD-ABOUT-RAIN? \?L283
	SET 'DETECTIVE-TOLD-ABOUT-RAIN?,1
	ZERO? DETECTIVE-SEEN-COAT? \?L285
	PRINTI "You try to explain the significance of the rain, but "
	CALL THE-PRINT,DETECTIVE
	PRINTI " doesn't understand what you're getting at."
	CRLF
	JUMP ?L301
?L285:	ADD DETECTIVE-SEEN,2 >DETECTIVE-SEEN
	CALL THE-PRINT,DETECTIVE,1
	PRINTI " listens as you explain how when Alicia arrived the rain was falling very lightly, but that her overcoat was soaked, which is why you turned it over to the authorities. "
	CALL THE-PRINT,DETECTIVE,1
	PRINTI " says, ""That may mean she was here earlier when the rain was pelting down, that she didn't arrive when she said she did."""
	CRLF
	JUMP ?L301
?L283:	PRINTI """You've already told me this."""
	CRLF
	JUMP ?L301
?L281:	PRINTI "You haven't seen anything significant about the weather, so you can't tell "
	CALL THE-PRINT,DETECTIVE
	PRINTI " about it."
	CRLF
	JUMP ?L301
?L279:	EQUAL? PRSI,BMW \?L298
	ZERO? DETECTIVE-SEEN-TRUST-DOCUMENTS? /?L298
	PRINTI """Ah! Either "
	PRINTD MICHAEL
	PRINTI " or someone with access to his keys must have put the documents there."""
	CRLF
	JUMP ?L301
?L298:	CALL THE-PRINT,DETECTIVE,1
	PRINTI " doesn't seem very interested."
	CRLF
?L301:	GRTR? DETECTIVE-SEEN,OSEEN \TRUE
	CALL GRAB-ATTENTION,DETECTIVE
	RTRUE
?L278:	EQUAL? PRSA,V?ASK-ABOUT \?L307
	EQUAL? PRSO,DETECTIVE \?L307
	EQUAL? PRSI,DETECTIVE \?L308
	PRINTR """I'm a detective. That's all you need to know right now."""
?L308:	EQUAL? PRSI,DUFFY,GLOBAL-DUFFY \?L312
	PRINTI """"
	PRINTD DUFFY
	PRINTR " is my assistant, and a finer public servant you're unlikely to find."""
?L312:	PRINTR """I don't reveal my methods, particularly to potential suspects."""
?L307:	EQUAL? PRSA,V?TAKE \?L318
	IN? PRSO,DETECTIVE \?L318
	PRINTR """You can't have that. It's evidence."""
?L318:	EQUAL? PRSA,V?REPLY \?L321
	CALL THE-PRINT,DETECTIVE,1
	PRINTR " listens intently."
?L321:	CALL CAUGHT-WITH-BODY? >STACK
	ZERO? STACK /FALSE
	ZERO? DETECTIVE-SEEN-CORPSE? \?L325
	SET 'DETECTIVE-SEEN-CORPSE?,1
	INC 'DETECTIVE-SEEN
?L325:	CALL I-START-ARREST
	CALL THE-PRINT,DETECTIVE,1
	PRINTR " sees you carrying the body."

	.FUNCT ITLL-WAIT
	PRINTI """It will have to wait until "
	PRINTD DUFFY
	PRINTR " gets back from the lab."""

	.FUNCT CHECK-GLASS
	IN? DUFFY,POLICE-LAB \?L1
	CALL ITLL-WAIT
	RTRUE
?L1:	ZERO? DETECTIVE-SEEN-GLASS? \?L4
	SET 'DETECTIVE-SEEN-GLASS?,1
	INC 'DETECTIVE-SEEN
?L4:	ZERO? GLASS-ANALYZED? /?L10
	ZERO? PRSI /?L9
?L10:	ZERO? GLASS-ANALYZED-FOR-PRINTS? /?L7
	EQUAL? PRSI,GLOBAL-FINGERPRINTS \?L7
?L9:	PRINTR """That's already been done."""
?L7:	ZERO? GLASS-ANALYZED? \?L14
	SET 'GLASS-ANALYZED?,1
	INC 'DETECTIVE-SEEN
?L14:	CALL TELL-ANALYZE,GLASS
	EQUAL? PRSI,GLOBAL-FINGERPRINTS \?L17
	ZERO? GLASS-ANALYZED-FOR-PRINTS? \?L21
	SET 'GLASS-ANALYZED-FOR-PRINTS?,1
	FSET? GLASS,TOUCHBIT /?L21
	INC 'DETECTIVE-SEEN
?L21:	PRINTI " for "
	PRINTD GLOBAL-FINGERPRINTS
?L17:	CALL DUFFY-TO-LAB,GLASS >STACK
	RSTACK

	.FUNCT CHECK-JUNK,OBJ
	IN? DUFFY,POLICE-LAB \?L1
	CALL ITLL-WAIT
	RTRUE
?L1:	CALL TELL-ANALYZE,OBJ
	CALL DUFFY-TO-LAB,OBJ >STACK
	RSTACK

	.FUNCT TELL-ANALYZE,OBJ
	PRINTI """"
	PRINTD DUFFY
	PRINTI ", analyze "
	CALL THE-PRINT,OBJ >STACK
	RSTACK

	.FUNCT DUFFY-TO-LAB,OBJ,GT
	PRINTI "!"" "
	PRINTD DUFFY
	PRINTI " "
	IN? DUFFY,HERE /?L3
	PRINTI "appears as if out of nowhere and "
?L3:	PRINTI "takes "
	CALL THE-PRINT,OBJ
	PRINTI ". He seems to almost disappear. ""He's a fine public[RWD_ID: people:4113, VAL: 1] servant,"" comments "
	CALL THE-PRINT,DETECTIVE
	PRINTI "."
	CRLF
	GET GOAL-TABLES,DUFFY-C >GT
	PUT GT,GOAL-ENABLE,0
	PUT GT,ATTENTION,0
	MOVE DUFFY,POLICE-LAB
	CALL QUEUE,I-DUFFY-RETURNS,20 >STACK
	PUT STACK,0,1
	MOVE OBJ,POLICE-LAB
	EQUAL? OBJ,GLASS \?L10
	SET 'OBJ,GLASS-ANALYSIS
	ZERO? GLASS-ANALYZED-FOR-PRINTS? /?L21
	FSET? GLASS,TOUCHBIT \?L14
	PUTP GLASS-ANALYSIS,P?TEXT,GLASS-ANALYSIS-Q
	JUMP ?L21
?L14:	FSET GLASS-ANALYSIS,ALICIABIT
	PUTP GLASS-ANALYSIS,P?TEXT,GLASS-ANALYSIS-P
	JUMP ?L21
?L10:	EQUAL? OBJ,HAIR \?L18
	SET 'OBJ,HAIR-ANALYSIS
	JUMP ?L21
?L18:	EQUAL? OBJ,MASK \?L19
	SET 'OBJ,MASK-ANALYSIS
	JUMP ?L21
?L19:	EQUAL? OBJ,STAIN \?L20
	SET 'OBJ,STAIN-ANALYSIS
	JUMP ?L21
?L20:	SET 'OBJ,NULL-ANALYSIS
?L21:	MOVE OBJ,DUFFY
	RTRUE

	.FUNCT I-DUFFY-RETURNS,AOBJ,GT,PRIORITY,FINAL
	LOC DETECTIVE >STACK
	MOVE DUFFY,STACK
	LOC DETECTIVE >STACK
	EQUAL? HERE,STACK /?L1
	PUSH 0
	JUMP ?L2
?L1:	PUSH 1
?L2:	CALL WHERE-UPDATE,DUFFY,STACK
	GET GOAL-TABLES,DUFFY-C >GT
	GET GT,GOAL-F >FINAL
	GET GT,GOAL-QUEUED >PRIORITY
	ZERO? PRIORITY /?L3
	CALL ESTABLISH-GOAL,DUFFY,PRIORITY
?L3:	CALL ESTABLISH-GOAL,DUFFY,FINAL,PRIORITY
	PUT GT,GOAL-ENABLE,1
	FIRST? DUFFY >AOBJ \FALSE
	IN? DETECTIVE,HERE \?L8
	MOVE AOBJ,PLAYER
	PRINTD DUFFY
	PRINTI " returns with the analysis. "
	CALL THE-PRINT,DETECTIVE,1
	PRINTI " reads it, then hands it to you. It reads, omitting the irrelevant details:
"
	CRLF
	GETP AOBJ,P?TEXT >STACK
	PRINT STACK
	CRLF
	RTRUE
?L8:	FSET AOBJ,TOLD
	MOVE AOBJ,DETECTIVE
	RFALSE

	.FUNCT TELL-RINGS
	CALL THE-PRINT,DETECTIVE,1
	PRINTR " rings the doorbell, then stands and waits."

	.FUNCT G-DETECTIVE,GARG,L,FLG=0
	LOC DETECTIVE >L
	ZERO? GARG \?L1
	CALL IMOVEMENT,DETECTIVE,G-DETECTIVE >STACK
	RSTACK
?L1:	EQUAL? GARG,G-IMPATIENT \?L3
	CALL THE-PRINT,DETECTIVE,1
	PRINTR " says, ""If you'll excuse me, I have an investigation to conduct."""
?L3:	EQUAL? GARG,G-REACHED,G-ALREADY \?L6
	EQUAL? TARGET,PLAYER \?L7
	CALL PLAYER-ARRESTED?,DETECTIVE,GARG >FLG
	ZERO? FLG \TRUE
?L7:	IN? DETECTIVE,HERE \?L10
	CALL LAB-RESULTS-TO-PLAYER,GARG >STACK
	ZERO? STACK /?L10
	SET 'GARG,G-ALREADY
?L10:	IN? DETECTIVE,PORCH \?L13
	SET 'NEW-ARRIVAL,DETECTIVE
	CALL ESTABLISH-GOAL,BUTLER,HALL,1
	EQUAL? HERE,PORCH \?L15
	ZERO? PLAYER-HIDING \?L17
	CALL THE-PRINT,DETECTIVE,1
	PRINTI " looks you over suspiciously. No one said that a costume party was in progress. "
?L17:	CALL TELL-RINGS
	JUMP ?L27
?L15:	EQUAL? HERE,CIRCLE \?L22
	CALL TELL-RINGS
	JUMP ?L27
?L22:	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK \?L27
	CALL THE-PRINT,DOORBELL,1
	PRINTI " has just rung."
	CRLF
	JUMP ?L27
?L13:	IN? DETECTIVE,OFFICE \?L27
	SET 'DETECTIVE-BEEN-TO-OFFICE?,1
?L27:	CALL DETECTIVE-FINDS-BODY?,GARG >STACK
	ZERO? STACK /?L29
	SET 'FLG,1
	JUMP ?L37
?L29:	CALL GO-AFTER-BODY?,DETECTIVE >STACK
	ZERO? STACK /?L31
	IN? DETECTIVE,HERE \?L37
	CALL THE-PRINT,DETECTIVE,1
	PRINTI " makes a quick examination of the vicinity."
	CRLF
	JUMP ?L37
?L31:	EQUAL? GARG,G-REACHED \?L37
	IN? DETECTIVE,HERE \?L37
	CALL THE-PRINT,DETECTIVE,1
	PRINTI " stops, looks carefully around, and then begins a detailed examination of the vicinity."
	CRLF
?L37:	CALL DETECTIVE-SEES-ROPE?,L >STACK
	ZERO? STACK /?L43
	EQUAL? L,HERE \?L43
	CALL THE-PRINT,DETECTIVE,1
	PRINTI " looks significantly at the rope. You catch a very suspicious sidelong glance at your costume. You can almost hear the click of the lock on a jail cell."
	CRLF
	SET 'FLG,1
?L43:	IN? DETECTIVE,BALLROOM-8 \?L49
	CALL I-START-ARREST
?L49:	RETURN FLG
?L6:	EQUAL? GARG,G-ENROUTE \FALSE
	EQUAL? TARGET,PLAYER \?L53
	CALL PLAYER-ARRESTED?,DETECTIVE,GARG >STACK
	RSTACK
?L53:	CALL DETECTIVE-FINDS-BODY?,GARG >STACK
	ZERO? STACK \TRUE
	IN? DETECTIVE,HERE \FALSE
	CALL LAB-RESULTS-TO-PLAYER >STACK
	RSTACK

	.FUNCT DETECTIVE-SEES-ROPE?,L
	CALL META-LOC,ROPE >STACK
	EQUAL? STACK,L \FALSE
	ZERO? DETECTIVE-SEEN-ROPE? \FALSE
	SET 'DETECTIVE-SEEN-ROPE?,1
	INC 'DETECTIVE-SEEN
	RETURN DETECTIVE-SEEN

	.FUNCT DETECTIVE-FINDS-BODY?,GARG,L,LC,BULLET?=0
	LOC DETECTIVE >L
	LOC CORPSE >LC
	ZERO? LC /FALSE
	CALL META-LOC,CORPSE >STACK
	EQUAL? STACK,L \FALSE
	ZERO? DETECTIVE-SEEN-CORPSE? \FALSE
	FSET DETECTIVE,TOLD
	SET 'DETECTIVE-SEEN-CORPSE?,1
	INC 'DETECTIVE-SEEN
	CALL OPEN-HIDING-PLACE
	CALL UNPRIORITIZE,DETECTIVE
	CALL GOALS?,DETECTIVE,0
	CALL QUEUE,I-AMBULANCE,20 >STACK
	PUT STACK,0,1
	IN? DETECTIVE,OFFICE \?L5
	LOC BULLET >STACK
	EQUAL? STACK,CORPSE,OFFICE \?L5
	SET 'BULLET?,1
	FCLEAR BULLET,INVISIBLE
	MOVE BULLET,DETECTIVE
	SET 'DETECTIVE-SEEN-BULLET?,1
	FSET? BULLET,RMUNGBIT \?L5
	SET 'DETECTIVE-SEEN-BULLET-PRINTS?,1
?L5:	IN? DUFFY,L /?L9
	IN? DUFFY,POLICE-LAB /?L9
	CALL ESTABLISH-GOAL,DUFFY,L,1
?L9:	EQUAL? L,HERE \FALSE
	CALL THE-PRINT,DETECTIVE,1
	PRINTI " "
	EQUAL? GARG,G-REACHED \?L16
	PRINTI "arrives and "
?L16:	IN? CORPSE,PLAYER /?L23
	IN? LC,PLAYER \?L21
?L23:	SET 'TARGET,PLAYER
	PRINTI "stops short, seeing you carrying the body."
	CRLF
	CALL DETECTIVE-SEES-ROPE?,L
	CALL PLAYER-ARRESTED?,DETECTIVE >STACK
	RSTACK
?L21:	IN? LC,ROOMS /?L26
	IN? DUFFY,L \?L27
	PRINTI "with a nod to "
	PRINTD DUFFY
	PRINTI ", takes over."
	JUMP ?L37
?L27:	CALL TELL-COMES-UPON,LC
	EQUAL? LC,CHAIR /?L32
	PRINTI "With an air of anticipation, "
	CALL THE-PRINT,DETECTIVE
	PRINTI " looks inside. "
?L32:	CALL TELL-BODY-THERE
	JUMP ?L37
?L26:	PRINTI "immediately notices the body."
?L37:	ZERO? BULLET? /?L40
	PRINTI " Seeing a glint of silver, the detective stoops down and carefully retrieves "
	CALL PRINTA,BULLET
	PRINTI "."
?L40:	EQUAL? L,OFFICE /?L45
	IN? DUFFY,L /?L45
	PRINTI " """
	PRINTD DUFFY
	PRINTI ", come here, I want you!"""
?L45:	PRINTI " As first priority, "
	CALL THE-PRINT,DETECTIVE
	PRINTR " checks out the corpse. While you watch, it is efficiently examined, touched, looked at, looked under, fingerprinted, and so on."

	.FUNCT OPEN-HIDING-PLACE,L
	LOC CORPSE >L
	EQUAL? L,HAMPER,WINDOW-SEAT,MERCEDES-TRUNK /?L3
	EQUAL? L,BMW-TRUNK \FALSE
?L3:	FSET L,OPENBIT
	IN? PLAYER,L \FALSE
	MOVE PLAYER,HERE
	RTRUE

	.FUNCT I-START-ARREST
	GRTR? DETECTIVE-SEEN,4 \?L1
	ZERO? PLAYER-SEEN-WITH-BODY? /FALSE
?L1:	ZERO? DETECTIVE-SEEN-CORPSE? \?L4
	ZERO? DUFFY-SEEN-CORPSE? /?L3
?L4:	IN? DUFFY,POLICE-LAB /?L3
	SET 'TARGET,PLAYER
	CALL STALK-PLAYER,DETECTIVE
	CALL STALK-PLAYER,DUFFY
	RFALSE
?L3:	CALL QUEUE,I-START-ARREST,10 >STACK
	PUT STACK,0,1
	RFALSE

	.FUNCT STALK-PLAYER,WHO
	LOC WHO >STACK
	CALL DIR-FROM,HERE,STACK >STACK
	ZERO? STACK /?L1
	MOVE WHO,HERE
	CALL PLAYER-ARRESTED?,WHO,G-REACHED >STACK
	RSTACK
?L1:	CALL ESTABLISH-GOAL,WHO,HERE >STACK
	RSTACK

	.FUNCT LAB-RESULTS-TO-PLAYER,GARG=G-ALREADY,F,N,FIRST=1
	FIRST? DETECTIVE >F /?L4
	JUMP ?L36
?L1:	ZERO? F \?L4
?L36:	ZERO? FIRST \FALSE
	RTRUE
?L4:	NEXT? F >N /?L9
?L9:	FSET? F,TOLD \?L10
	FCLEAR F,TOLD
	MOVE F,PLAYER
	ZERO? FIRST /?L12
	SET 'FIRST,0
	CALL THE-PRINT,DETECTIVE,1
	EQUAL? GARG,G-REACHED \?L16
	PRINTI " comes up to you and"
?L16:	PRINTI " interrupts."
?L12:	CRLF
	PRINTI """"
	EQUAL? F,NULL-ANALYSIS \?L26
	PRINTI "analysis"
	JUMP ?L30
?L26:	CALL THE-PRINT,F,1
?L30:	PRINTI " is back from the lab. I thought you might be interested in what it says."" "
	CALL THE-PRINT,DETECTIVE,1
	PRINTI " hands it to you. It reads, omitting the irrelevant details:
"
	CRLF
	GETP F,P?TEXT >STACK
	PRINT STACK
	CRLF
?L10:	SET 'F,N
	JUMP ?L1

	.FUNCT TELL-ON-SCENE,WHO
	CALL DPRINT,WHO,1
	PRINTI " arrives on the scene"
	RTRUE

	.FUNCT PLAYER-ARRESTED?,WHO,GARG=G-ALREADY
	GRTR? DETECTIVE-SEEN,4 \?L1
	ZERO? PLAYER-SEEN-WITH-BODY? \?L1
	SET 'TARGET,0
	RFALSE
?L1:	EQUAL? WHO,DETECTIVE \?L3
	IN? DETECTIVE,HERE \?L3
	ZERO? DUFFY-SNARFED /?L4
	CALL TELL-ON-SCENE,DETECTIVE
	PRINTI ", surveys the situation, and says ""Good work, Sergeant!"" "
	CALL THE-PRINT,DETECTIVE,1
	PRINTI " eyes you with satisfaction. ""You're under arrest for the murder of "
	PRINTD VERONICA
	PRINTI " Ashcroft."" The standard warnings are given. "
	PRINTD DUFFY
	JUMP ?L8
?L4:	FSET PLAYER,TOLD
	CALL THE-PRINT,DETECTIVE,1
	EQUAL? GARG,G-ALREADY /?L11
	PRINTI " sees you, approaches warily, and"
?L11:	PRINTI " grabs you firmly by the wrist, and with a practiced twist, slips the cuffs on you. ""You're under arrest for the murder of "
	PRINTD VERONICA
	PRINTI " Ashcroft."" The standard warnings are given. "
	PRINTD DUFFY
	PRINTI " appears, as though out of nowhere, and"
?L8:	PRINTI " escorts you out to the waiting police car. All your protests are ignored.

In the subsequent trial, you are "
	ZERO? PLAYER-FOLLOWED-VERONICA? \?L22
	ZERO? PLAYER-BEEN-TO-OFFICE? /?L20
?L22:	PRINTI "convicted of second degree murder. There was damning evidence, such as"
	JUMP ?L25
?L20:	PRINTI "acquitted, in spite of"
?L25:	PRINTI " the fact that"
	ZERO? DETECTIVE-BEEN-TO-OFFICE? /?L30
	ZERO? DETECTIVE-SEEN-ROPE? \?L30
	PRINTI " you attempted to hide the lariat which"
	JUMP ?L34
?L30:	PRINTI " your lariat"
?L34:	PRINTI " was the murder weapon"
	ZERO? DETECTIVE-SEEN-BULLET? /?L39
	PRINTI " and the bullet from your gunbelt"
	ZERO? DETECTIVE-SEEN-BULLET-PRINTS? /?L43
	PRINTI " (with both your "
	PRINTD GLOBAL-FINGERPRINTS
	PRINTI " and "
	PRINTD VERONICA
	PRINTI "'s on it)"
?L43:	PRINTI " was found near the body"
?L39:	PRINTI "."
	ZERO? PLAYER-FOLLOWED-VERONICA? /?L53
	PRINTI " Also, you were presumably the last person to see her alive, since you charged off after her when she spilled her drink."
?L53:	ZERO? PLAYER-SEEN-WITH-BODY? /?L58
	PRINTI " Of course, you were seen moving the body around after the murder."
	JUMP ?L62
?L58:	ZERO? PLAYER-MOVED-BODY? /?L62
	PRINTI " Stupidly, you moved the body after the murder."
?L62:	PRINTI " Finally, several guests testified against you as a nosy and suspicious character."
	CRLF
	PRINTI "
However, "
	CALL THE-PRINT,DETECTIVE
	PRINTI " and "
	PRINTD DUFFY
	PRINTI ", nagged by doubt, continue the investigation on their own time. Their brilliant detective work unravels the tangled mess behind the murder. You are released, and as you leave jail, you can't help but think that if you had been able to figure out what was going on that night, you might have won yourself a Pulitzer Prize by now."
	CRLF
	CALL PRINT-ID,STR?202
	CALL FINISH >STACK
	RSTACK
?L3:	EQUAL? WHO,DUFFY \?L70
	IN? DUFFY,HERE \?L70
	ZERO? DUFFY-SNARFED \?L71
	FSET PLAYER,TOLD
	SET 'DUFFY-SNARFED,1
	GET GOAL-TABLES,PLAYER-C >STACK
	PUT STACK,GOAL-S,0
	GET GOAL-TABLES,DUFFY-C >STACK
	PUT STACK,GOAL-ENABLE,0
	CALL ESTABLISH-GOAL,DETECTIVE,HERE
	PRINTD DUFFY
	ZERO? PLAYER-HIDING /?L75
	PRINTI " immediately penetrates the concealment of "
	CALL THE-PRINT,PLAYER-HIDING
	PRINTI ". He"
	SET 'PLAYER-HIDING,0
?L75:	LOC PLAYER >STACK
	EQUAL? STACK,HERE /?L80
	MOVE PLAYER,HERE
?L80:	PRINTI " grabs you with a grip of iron. """
	CALL THE-PRINT,DETECTIVE,1
	PRINTR " would like a word with you,"" he says."
?L71:	EQUAL? PRSA,V?TELL \?L86
	ZERO? PRSI /FALSE
?L86:	PRINTD DUFFY
	PRINTI " maintains his iron grip as you wait apprehensively for the arrival of "
	CALL THE-PRINT,DETECTIVE
	PRINTR "."
?L70:	CALL I-START-ARREST
	RFALSE

	.FUNCT DUFFY-DESC-F,RARG=0
	PRINTD DUFFY
	ZERO? DUFFY-SNARFED /?L3
	PRINTR " is here, his iron grip immobilizing you."
?L3:	IN? DUFFY,OFFICE \?L7
	ZERO? LAST-FROB /?L7
	PRINTI " is carefully checking over "
	CALL THE-PRINT,LAST-FROB
	PRINTR ", making sure his boss has missed nothing."
?L7:	PRINTR " waits nearby, ready to spring into action to serve his superior officer."

	.FUNCT DUFFY-F
	EQUAL? WINNER,DUFFY \?L1
	EQUAL? PRSA,V?GIVE \?L3
	EQUAL? PRSO,DUFFY-COAT \?L3
	EQUAL? PRSI,BUTLER \?L3
	IN? BUTLER,HERE \TRUE
	PRINTD DUFFY
	PRINTR ", following the example of his boss, refuses to give up his raincoat."
?L3:	EQUAL? PRSA,V?ANALYZE \?L10
	PRINTI """I perform analyses for "
	CALL THE-PRINT,DETECTIVE
	PRINTR ". If you want something analyzed, that's how to do it."""
?L10:	CALL DONT-HANDLE? >STACK
	ZERO? STACK \FALSE
	PRINTD DUFFY
	PRINTR " stands silently, intent upon his business, and ignores your request. You realize that his devotion to duty is so strong that he would be hard to distract."
?L1:	EQUAL? PRSA,V?PHONE \?L17
	CALL PERFORM,V?PHONE,POLICE
	RTRUE
?L17:	EQUAL? PRSA,V?EXAMINE \?L18
	PRINTD DUFFY
	PRINTI " is of medium height, very non-descript, very attentive to his boss, "
	CALL THE-PRINT,DETECTIVE
	PRINTR ". He is in uniform."
?L18:	EQUAL? PRSA,V?ASK-ABOUT \?L21
	EQUAL? PRSO,DUFFY \?L21
	PRINTI """You'd have to ask "
	CALL THE-PRINT,DETECTIVE
	PRINTR ". His opinions are mine."""
?L21:	EQUAL? PRSA,V?SHOW \?L24
	EQUAL? PRSO,CORPSE \?L25
	EQUAL? PRSI,DUFFY \?L25
	PRINTD DUFFY
	PRINTR " approaches."
?L25:	PRINTR """Perhaps that would interest the detective."""
?L24:	CALL CAUGHT-WITH-BODY? >STACK
	ZERO? STACK /FALSE
	SET 'DUFFY-SEEN-CORPSE?,1
	CALL I-START-ARREST
	PRINTD DUFFY
	PRINTR " sees you carrying the body."

	.FUNCT CAUGHT-WITH-BODY?
	EQUAL? PRSA,V?$0024DISCOVER \FALSE
	EQUAL? PRSO,CORPSE \FALSE
	IN? CORPSE,PLAYER \FALSE
	RTRUE

	.FUNCT G-DUFFY,GARG,FLG=0
	ZERO? GARG \?L1
	CALL IMOVEMENT,DUFFY,G-DUFFY >STACK
	RSTACK
?L1:	EQUAL? GARG,G-IMPATIENT \?L3
	ZERO? DUFFY-SNARFED \?L3
	PRINTD DUFFY
	PRINTR " says, ""I have work to do. Goodbye."""
?L3:	EQUAL? GARG,G-REACHED,G-ALREADY \?L6
	EQUAL? GARG,G-REACHED \?L7
	IN? DUFFY,HERE \?L7
	CALL TELL-ON-SCENE,DUFFY
	PRINTI "."
	CRLF
	SET 'FLG,1
?L7:	CALL DUFFY-FINDS-BODY?,GARG >STACK
	ZERO? STACK \TRUE
	RETURN FLG
?L6:	EQUAL? GARG,G-ENROUTE \FALSE
	CALL DUFFY-FINDS-BODY?,GARG >STACK
	RSTACK

	.FUNCT TELL-COMES-UPON,LC
	PRINTI "begins to search the room, and comes upon "
	CALL THE-PRINT,LC
	PRINTI ". "
	RTRUE

	.FUNCT TELL-BODY-THERE
	PRINTD VERONICA
	PRINTI "'s body is there."
	RTRUE

	.FUNCT DUFFY-FINDS-BODY?,GARG,L,LC
	LOC DUFFY >L
	LOC CORPSE >LC
	EQUAL? TARGET,PLAYER \?L1
	CALL PLAYER-ARRESTED?,DUFFY,GARG >STACK
	RSTACK
?L1:	ZERO? LC /FALSE
	CALL META-LOC,CORPSE >STACK
	EQUAL? STACK,L \?L3
	ZERO? DUFFY-SEEN-CORPSE? \?L3
	FSET DUFFY,TOLD
	CALL OPEN-HIDING-PLACE
	SET 'DUFFY-SEEN-CORPSE?,1
	CALL UNPRIORITIZE,DUFFY
	CALL GOALS?,DUFFY,0
	IN? DETECTIVE,L /?L4
	CALL ESTABLISH-GOAL,DETECTIVE,L,1
?L4:	EQUAL? L,HERE \FALSE
	IN? CORPSE,PLAYER /?L11
	IN? LC,PLAYER \?L9
?L11:	CALL I-START-ARREST
	PRINTD DUFFY
	PRINTI "'s eyes widen as he sees you brazenly carrying the corpse."
	CRLF
	CALL PLAYER-ARRESTED?,DUFFY
	RTRUE
?L9:	IN? LC,ROOMS /?L14
	IN? DETECTIVE,L \?L15
	PRINTI "He begins to lend his assistance."
	CRLF
	JUMP ?L29
?L15:	PRINTD DUFFY
	PRINTI " "
	CALL TELL-COMES-UPON,LC
	EQUAL? LC,CHAIR /?L22
	PRINTI "He looks at it suspiciously for a moment, then looks inside. "
?L22:	PRINTI "His eyes widen. "
	CALL TELL-BODY-THERE
	CRLF
	JUMP ?L29
?L14:	EQUAL? GARG,G-REACHED \?L30
	PRINTI "He immediately"
	JUMP ?L34
?L30:	PRINTD DUFFY
	PRINTI " suddenly"
?L34:	PRINTI " notices the body."
	CRLF
?L29:	EQUAL? L,OFFICE /?L40
	IN? DETECTIVE,L /?L40
	PRINTI "He blows a small police whistle several times. """
	PRINTD VERONICA
	PRINTI "'s body is here!"" he yells."
	CRLF
?L40:	PRINTD DUFFY
	ZERO? DETECTIVE-SEEN-CORPSE? \?L47
	PRINTI " makes a preliminary examination of the corpse while he waits for "
	CALL THE-PRINT,DETECTIVE
	PRINTR "."
?L47:	IN? DETECTIVE,L \?L51
	PRINTI " examines the body, making a few comments to "
	CALL THE-PRINT,DETECTIVE
	PRINTR ", who makes a few notes."
?L51:	PRINTR " makes a few observations which he records in his notebook."
?L3:	ZERO? LC /FALSE
	CALL GO-AFTER-BODY?,DUFFY
	RFALSE

	.FUNCT GO-AFTER-BODY?,WHO
	ZERO? DETECTIVE-BEEN-TO-OFFICE? /FALSE
	ZERO? DETECTIVE-SEEN-CORPSE? \FALSE
	ZERO? DUFFY-SEEN-CORPSE? \FALSE
	CALL LISTENING?,WHO >STACK
	ZERO? STACK \FALSE
	FSET? CORPSE,RMUNGBIT /?L5
	ZERO? PLAYER-SEEN-WITH-BODY? \?L5
	CALL PROB,25 >STACK
	ZERO? STACK /FALSE
?L5:	FSET CORPSE,RMUNGBIT
	CALL META-LOC,CORPSE >STACK
	CALL ESTABLISH-GOAL,WHO,STACK,1
	RTRUE

	.FUNCT I-POLICE-ARRIVE
	MOVE DETECTIVE,CIRCLE
	MOVE DUFFY,CIRCLE
	MOVE POLICE-CAR,CIRCLE
	CALL ESTABLISH-GOAL,DETECTIVE,PORCH
	CALL ESTABLISH-GOAL,DUFFY,PORCH
	EQUAL? HERE,PORCH,CIRCLE \?L1
	PRINTR "Up the driveway speeds an unmarked police car with a detachable bubble light blinking on its roof. It parks right in front of you in the circle. The driver and a passenger emerge. The driver is wearing a rain slicker under which you can see a uniform. The passenger is in plain clothes, wearing a trenchcoat."
?L1:	PRINTR "You hear the sound of a police siren approaching. It stops."

	.FUNCT I-AMBULANCE,L
	CALL META-LOC,CORPSE >L
	ZERO? DETECTIVE-BEEN-TO-OFFICE? \?L1
	CALL NEW-SCRIPT,DETECTIVE,DETECTIVE-SCRIPT
	CALL NEW-SCRIPT,DUFFY,DUFFY-SCRIPT
	JUMP ?L4
?L1:	CALL GOALS?,DETECTIVE,1
	IN? DUFFY,POLICE-LAB /?L4
	CALL GOALS?,DUFFY,1
?L4:	FCLEAR ROPE,NDESCBIT
	REMOVE CORPSE
	EQUAL? HERE,L /?L9
	EQUAL? HERE,CIRCLE,PORCH,HALL \FALSE
?L9:	PRINTR "The ambulance has finally arrived, and the attendants remove the body on a stretcher."

	.FUNCT POLICE-CAR-F
	EQUAL? PRSA,V?LOOK-INSIDE \FALSE
	PRINTR "You see the usual equipment that TV has led you to expect."

	.FUNCT MASK-F
	EQUAL? PRSA,V?TAKE-OFF \?L1
	FSET? PRSO,WEARBIT \?L3
	FCLEAR PRSO,WEARBIT
	PRINTR "You remove your mask, revealing your smiling face and twinkling eyes."
?L3:	PRINT ITS-ALREADY
	PRINTR "off."
?L1:	EQUAL? PRSA,V?WEAR \FALSE
	FSET? PRSO,WEARBIT \?L11
	PRINT ITS-ALREADY
	PRINTR "on."
?L11:	FSET PRSO,WEARBIT
	PRINTR "Okay."

	.FUNCT COSTUME-F
	EQUAL? PRSA,V?EXAMINE \?L1
	LOC PRSO >STACK
	CALL PERFORM,V?EXAMINE,STACK
	RTRUE
?L1:	EQUAL? PRSA,V?LOOK-INSIDE /?L4
	EQUAL? PRSA,V?LOOK-UNDER,V?LOOK-BEHIND,V?TAKE \FALSE
?L4:	LOC PRSO >STACK
	CALL PERFORM,V?UNMASK,STACK
	RTRUE

	.FUNCT GENERIC-STUFF-F,NAM
	EQUAL? NAM,W?COSTUME \?L1
	CALL META-LOC,FAIRY-COSTUME >STACK
	EQUAL? STACK,HERE \?L1
	RETURN FAIRY-COSTUME
?L1:	EQUAL? NAM,W?MASK \?L3
	CALL META-LOC,FAIRY-MASK >STACK
	EQUAL? STACK,HERE \?L3
	RETURN FAIRY-MASK
?L3:	CALL TELL-SPECIFIC
	RETURN NOT-HERE-OBJECT

	.FUNCT OAKS-PSEUDO
	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "The oaks are ancient, stately, and wet."

	.FUNCT PUMPKIN-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "There are hundreds of them. Grotesque demon faces conceal themselves in the pile, and leering skulls stare this way and that. Some of the candles have gone out from the rain, and those pumpkins sit forlorn and wet, huddling together for warmth."
?L1:	EQUAL? PRSA,V?TAKE \FALSE
	PRINTR "Taking a pumpkin from the pile could bring them all crashing down."

	.FUNCT FRONT-DOOR-F
	EQUAL? PRSA,V?REPLY,V?OPEN \FALSE
	IN? NEW-ARRIVAL,PORCH \?L3
	EQUAL? HERE,HALL \?L3
	FSET FRONT-DOOR,OPENBIT
	FCLEAR FRONT-DOOR,LOCKED
	CALL NEW-ARRIVAL-STUFF,PLAYER
	RTRUE
?L3:	EQUAL? HERE,PORCH \FALSE
	FSET? FRONT-DOOR,LOCKED \FALSE
	CALL THE-PRINT,FRONT-DOOR,1
	PRINTI " is locked. Perhaps if you rang "
	CALL THE-PRINT,GLOBAL-DOORBELL
	PRINTR " someone would answer it."

	.FUNCT TELL-ABOUT-DUFFY
	PRINTI " A uniformed policeman accompanies "
	CALL THE-PRINT,DETECTIVE
	PRINTI ". ""This is "
	PRINTD DUFFY
	PRINTI ", my assistant. You may say anything to him that you would say to me. "
	PRINT AMBULANCE-COMING
	PRINTI ","" adds "
	CALL THE-PRINT,DETECTIVE
	PRINTI "."
	CRLF
	CALL G-DETECTIVE,G-REACHED
	CALL G-DUFFY,G-REACHED >STACK
	RSTACK

	.FUNCT GLOBAL-DOORBELL-F
	EQUAL? PRSA,V?REPLY \FALSE
	ZERO? NEW-ARRIVAL \?L3
	PRINTR "I didn't realize anyone had rung the doorbell recently."
?L3:	EQUAL? HERE,HALL \?L7
	PRINTI "That's the butler's job. But if you insist..."
	CRLF
	IN? NEW-ARRIVAL,PORCH \?L10
	CALL NEW-ARRIVAL-STUFF,PLAYER
	RTRUE
?L10:	CALL THERE-DOESNT-SEEM
	PRINTR "anyone there."
?L7:	PRINT YOU-ARENT
	PRINTR "at the front door."

	.FUNCT NEW-ARRIVAL-STUFF,WHO,L,FLG=0,DET?=0,ALI?=0,PLA?=0
	ZERO? NEW-ARRIVAL /FALSE
	FCLEAR FRONT-DOOR,LOCKED
	EQUAL? HERE,PORCH \?L3
	ZERO? PLAYER-HIDING \?L3
	SET 'PLA?,1
	SET 'NEW-ARRIVAL,PLAYER
	CALL MOVE-PLAYER,HALL
	USL
?L3:	IN? ALICIA,PORCH \?L6
	SET 'ALI?,1
	SET 'NEW-ARRIVAL,ALICIA
	MOVE ALICIA,HALL
	CALL ESTABLISH-GOAL,ALICIA,BALLROOM-5
?L6:	IN? DETECTIVE,PORCH \?L9
	SET 'DET?,1
	SET 'NEW-ARRIVAL,DETECTIVE
	MOVE DETECTIVE,HALL
	MOVE DUFFY,HALL
	CALL NEW-SCRIPT,DETECTIVE,DETECTIVE-SCRIPT
	CALL NEW-SCRIPT,DUFFY,DUFFY-SCRIPT
?L9:	EQUAL? WHO,PLAYER \?L12
	SET 'FLG,1
	ZERO? DET? /?L14
	CALL THE-PRINT,DETECTIVE,1
	PRINTI " enters the house, looking about cautiously. A few curt words of greeting are uttered."
	CALL TELL-ABOUT-DUFFY
?L14:	ZERO? ALI? /?L52
	CALL ALICIA-DESC-F
	PRINTD ALICIA
	PRINTI " enters the house, thanking you for answering the doorbell."
	CRLF
	CALL WHERE-UPDATE,ALICIA,1
	JUMP ?L52
?L12:	LOC BUTLER >L
	EQUAL? L,HALL,PORCH \?L52
	EQUAL? HERE,HALL,PORCH \?L52
	SET 'FLG,1
	PRINTD BUTLER
	PRINTI " opens the front door."
	ZERO? PLA? /?L29
	PRINTI " He ushers you into the hall. It is clear from his demeanor that he remembers letting you in earlier in the evening, but he suppresses his perplexity reasonably well."
?L29:	ZERO? ALI? \?L36
	ZERO? DET? /?L49
?L36:	PRINTI " He greets "
	ZERO? ALI? /?L39
	ZERO? DET? /?L39
	PRINTI "everyone"
	JUMP ?L43
?L39:	CALL DPRINT,NEW-ARRIVAL
?L43:	PRINTI ", his gorilla costume eliciting a glance of suppressed amusement, and ushers the new arrival into the front hall."
	ZERO? DET? /?L49
	CALL TELL-ABOUT-DUFFY
	JUMP ?L51
?L49:	CRLF
?L51:	ZERO? ALI? /?L52
	CALL WHERE-UPDATE,ALICIA,1
?L52:	SET 'NEW-ARRIVAL,0
	RETURN FLG

	.FUNCT DOORBELL-F
	EQUAL? PRSA,V?RING,V?PUSH \FALSE
	SET 'NEW-ARRIVAL,PLAYER
	CALL ESTABLISH-GOAL,BUTLER,HALL,1
	PRINTR "The doorbell rings."

	.FUNCT VELVET-RIBBON-F
	EQUAL? PRSA,V?CUT,V?THROUGH \FALSE
	PRINTR "That would be bad manners."

	.FUNCT WINDOW-SEAT-DESC-F,RARG=0
	PRINT THERE-IS
	FSET? WINDOW-SEAT,OPENBIT \?L3
	PRINTI "an open "
	JUMP ?L7
?L3:	PRINTI "a closed "
?L7:	PRINTD WINDOW-SEAT
	PRINTR " beneath one of the windows."

	.FUNCT WINDOW-SEAT-F,RARG=0
	EQUAL? RARG,M-BEG \?L1
	EQUAL? PRSA,V?DISEMBARK,V?STAND \?L3
	IN? WINNER,WINDOW-SEAT \?L3
	ZERO? PLAYER-HIDING /?L3
	FSET WINDOW-SEAT,OPENBIT
	RFALSE
?L3:	EQUAL? PRSA,V?EXAMINE,V?LOOK \?L5
	ZERO? PLAYER-HIDING /?L5
	CALL TELL-CANT-SEE,STR?203
	CRLF
	RTRUE
?L5:	EQUAL? PRSA,V?LOOK-INSIDE \FALSE
	ZERO? PLAYER-HIDING /FALSE
	PRINTR "There isn't much to see."
?L1:	ZERO? RARG \FALSE
	EQUAL? PRSA,V?OPEN \?L11
	IN? WINNER,WINDOW-SEAT \?L12
	FSET? WINDOW-SEAT,SURFACEBIT \?L12
	CALL TELL-GET-UP >STACK
	RSTACK
?L12:	FCLEAR PRSO,SURFACEBIT
	ZERO? PLAYER-HIDING /FALSE
	CALL PLAYER-EMERGES
	RFALSE
?L11:	EQUAL? PRSA,V?CLOSE \?L18
	FSET? PRSO,OPENBIT \?L18
	FSET PRSO,SURFACEBIT
	FCLEAR PRSO,OPENBIT
	PRINTR "Closed."
?L18:	EQUAL? PRSA,V?SIT \?L21
	FSET? PRSO,OPENBIT \?L21
	CALL TELL-YOU-CANT,STR?204,0
	CALL DPRINT,PRSO
	PRINTR "."
?L21:	EQUAL? PRSA,V?HIDE-INSIDE,V?THROUGH \?L24
	FSET? PRSO,OPENBIT /?L25
	CALL TELL-YOU-CANT,STR?205,0
	CALL DPRINT,PRSO
	PRINTR "."
?L25:	IN? CORPSE,WINDOW-SEAT \?L29
	PRINTR "That would be too crowded for comfort."
?L29:	ZERO? PLAYER-HIDING \FALSE
	FCLEAR WINDOW-SEAT,OPENBIT
	MOVE PLAYER,WINDOW-SEAT
	SET 'PLAYER-HIDING,WINDOW-SEAT
	PRINT YOU-ARE
	PRINTI "now hiding in the "
	PRINTD WINDOW-SEAT
	PRINTR "."
?L24:	EQUAL? PRSA,V?PUT \?L39
	ZERO? PRSI /?L36
	FSET? PRSI,OPENBIT /?L36
	PRINT YOU-MUST
	PRINTI "open the "
	PRINTD WINDOW-SEAT
	PRINTR " first."
?L36:	EQUAL? PRSA,V?PUT \?L39
	EQUAL? PRSO,CORPSE \?L39
	PRINTI "Your name wouldn't be Brewster, by any chance?"
	CRLF
	RFALSE
?L39:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "A "
	PRINTD WINDOW-SEAT
	PRINTI " is a bench underneath a window that often has storage space inside it. This one overlooks the front of the house and down the hill. In ""Arsenic and Old Lace,"" there were several bodies hidden in "
	CALL PRINTA,WINDOW-SEAT
	PRINTR "."

	.FUNCT HAMPER-F,RARG=0
	EQUAL? PRSA,V?PUT \FALSE
	EQUAL? PRSO,HAMPER \FALSE
	EQUAL? PRSI,WINDOW-SEAT,BMW-TRUNK,MERCEDES-TRUNK \FALSE
	PRINTR "It's too big."

	.FUNCT HAMPER-DESC-F,RARG=0
	PRINT THERE-IS
	PRINTI "a large wicker hamper "
	IN? HAMPER,WEST-COAT-CLOSET \?L3
	PRINTI "at one end of the closet."
	JUMP ?L7
?L3:	PRINTI "here."
?L7:	FSET? HAMPER,OPENBIT \?L10
	PRINTI " The hamper is open."
?L10:	CRLF
	RTRUE

	.FUNCT COATS-PSEUDO
	EQUAL? PRSA,V?EXAMINE,V?SEARCH \?L1
	PRINTI "There are too many. "
	CALL TELL-SPECIFIC >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?TAKE \FALSE
	PRINTR "That would be stealing!"

	.FUNCT I-UNTANGLE
	SET 'ENTANGLED?,0
	MOVE GUEST,GLOBAL-OBJECTS
	GET GOAL-TABLES,BUTLER-C >STACK
	PUT STACK,ATTENTION,0
	CALL ESTABLISH-GOAL,BUTLER,BALLROOM-8,1
	PRINTD BUTLER
	PRINTI " regains his composure, and helps you to your feet, apologizing profusely. ""I've gotten your costume all dirty. Permit me to straighten it."" He removes a small brush from his suit, straightens your vest, and brushes the dirt off. While "
	PRINTD BUTLER
	PRINTR " is ministering to your costume, the other guest speedily and thankfully departs the area."

	.FUNCT HALLWAY-12-F,RARG=0
	EQUAL? RARG,M-END \?L1
	ZERO? SLAPSTICK? \?L1
	IN? BUTLER,HALLWAY-12 \?L1
	CALL IN-MOTION?,VERONICA >STACK
	ZERO? STACK /?L1
	SET 'PLAYER-FOLLOWED-VERONICA?,1
	SET 'SLAPSTICK?,1
	SET 'ENTANGLED?,1
	MOVE GUEST,HALLWAY-12
	CALL ESTABLISH-GOAL,BUTLER,BALLROOM-8
	CALL GRAB-ATTENTION,BUTLER
	CALL QUEUE,I-UNTANGLE,4 >STACK
	PUT STACK,0,1
	PRINTI "You reach the vicinity of the coat closet, but you must weave your way around the butler and a guest. "
	PRINTD BUTLER
	PRINTI " is taking the guest's coat to hang it up, and the two of them are blocking the hall. The guest "
	IN? VERONICA,HERE /?L7
	CALL CORRIDOR-LOOK,VERONICA >STACK
	ZERO? STACK /?L5
?L7:	PRINTI "turns to stare at "
	PRINTD VERONICA
	PRINTI " as she rushes "
	IN? VERONICA,BALLROOM-7 \?L10
	PUSH STR?206
	JUMP ?L13
?L10:	IN? VERONICA,HERE \?L12
	PUSH STR?207
	JUMP ?L13
?L12:	PUSH STR?208
?L13:	PRINT STACK
	PRINTI ", and "
?L5:	PRINTI "bumps you. Now "
	PRINTD BUTLER
	PRINTR ", whose vision is not improved by the gorilla suit he is wearing, becomes entangled in the guest's overcoat. Unfortunately, it's still attached to the guest and the two of them nearly fall to the floor. You are entangled in the confusion."
?L1:	EQUAL? RARG,M-BEG \FALSE
	EQUAL? PRSA,V?STAND,V?WALK,V?FOLLOW \FALSE
	ZERO? ENTANGLED? /FALSE
	GET ENTANGLED-YUKS,ENTANGLED? >STACK
	PRINT STACK
	CRLF
	INC 'ENTANGLED?
	RTRUE

	.FUNCT GUEST-F
	EQUAL? GUEST,WINNER /?L3
	EQUAL? PRSA,V?TELL /?L14
	CALL TALKING-TO?,GUEST >STACK
	ZERO? STACK /?L1
?L3:	EQUAL? PRSA,V?TELL \?L4
?L14:	SET 'P-CONT,0
	SET 'QUOTE-FLAG,0
?L4:	PRINTR "The guest is too busy dealing with his coat, the butler, and you to answer coherently or civilly."
?L1:	EQUAL? PRSA,V?EXAMINE \?L9
	IN? GUEST,HERE \?L15
	PRINTR "The guest is rumpled and crumpled from the recent melee. He appears to be wearing the remains of a devil costume. Fortunately, he has no pitchfork."
?L9:	IN? GUEST,HERE /FALSE
?L15:	EQUAL? PLAYER,WINNER \FALSE
	CALL PERFORM,V?FIND,GUEST
	RTRUE

	.FUNCT TELEVISION-F
	EQUAL? PRSA,V?EXAMINE \?L1
	FSET? PRSO,ONBIT \?L3
	PRINTR "The TV is on, tuned to the Cable News Network."
?L3:	PRINTR "The TV is off."
?L1:	EQUAL? PRSA,V?LAMP-ON \?L10
	PRINTR "It's already on."
?L10:	EQUAL? PRSA,V?LAMP-OFF \FALSE
	PRINTR "Don't you like to watch?"

	.FUNCT VCR-F
	EQUAL? PRSA,V?LAMP-OFF,V?LAMP-ON,V?EXAMINE \FALSE
	PRINTR "This is a kind you've never seen before, and you can't fathom its controls. It's made by the Frobozz Magic VCR Company."

	.FUNCT BOOKCASE-F
	EQUAL? PRSA,V?EXAMINE,V?LOOK-INSIDE \FALSE
	PRINTI "The bookcase contains "
	CALL PRINT-CONTENTS,BOOKCASE,0,VIDEOTAPE >STACK
	ZERO? STACK /?L5
	PRINTI " and "
?L5:	PRINTR "many videotapes."

	.FUNCT OFFICE-F,RARG=0
	EQUAL? RARG,M-LOOK \FALSE
	SET 'PLAYER-BEEN-TO-OFFICE?,1
	PRINTI "This is the farm's office. There are filing cabinets, a large and a[RWD_ID: places:998, VAL: 1] small desk, a personal computer, a telephone, a copier, and other expected office appointments. There are shelves with breeding books and other horsey reference works. Where shelves don't cover the walls, ribbons and prize certificates do. All this is overshadowed by the condition of the room: papers are scattered everywhere, file folders spill their contents on the floor and on every horizontal surface, a file of floppy disks has been bounced off one wall, and copier toner is spilled on the rug. "
	FSET? LARGE-DESK,OPENBIT \?L12
	FSET? SMALL-DESK,OPENBIT \?L5
	FSET? FILE-CABINET,OPENBIT \?L5
	PRINTI "The desks and "
	PRINTD FILE-CABINET
	PRINT HAVE-DRAWERS-OPEN
	JUMP ?L23
?L5:	FSET? LARGE-DESK,OPENBIT \?L12
	FSET? SMALL-DESK,OPENBIT \?L9
	PRINTI "The desks"
	PRINT HAVE-DRAWERS-OPEN
	JUMP ?L23
?L9:	FSET? LARGE-DESK,OPENBIT \?L12
	FSET? FILE-CABINET,OPENBIT \?L12
	CALL THE-PRINT,LARGE-DESK,1
	PRINTI " and "
	CALL THE-PRINT,FILE-CABINET
	PRINT HAVE-DRAWERS-OPEN
	JUMP ?L23
?L12:	FSET? SMALL-DESK,OPENBIT \?L15
	FSET? FILE-CABINET,OPENBIT \?L15
	CALL THE-PRINT,SMALL-DESK,1
	PRINTI " and "
	CALL THE-PRINT,FILE-CABINET
	PRINT HAVE-DRAWERS-OPEN
	JUMP ?L23
?L15:	FSET? LARGE-DESK,OPENBIT \?L18
	CALL TELL-HAS-DRAWER-OPEN,LARGE-DESK
	JUMP ?L23
?L18:	FSET? SMALL-DESK,OPENBIT \?L19
	CALL TELL-HAS-DRAWER-OPEN,SMALL-DESK
	JUMP ?L23
?L19:	FSET? FILE-CABINET,OPENBIT \?L20
	CALL THE-PRINT,FILE-CABINET,1
	PRINTI " has its drawers open."
	JUMP ?L23
?L20:	PRINTI "The desk and file drawers are closed."
?L23:	PRINTR " Doors lead out to the north, west, and south."

	.FUNCT TELL-HAS-DRAWER-OPEN,DESK
	CALL THE-PRINT,DESK,1
	PRINTI " has its drawer open."
	RTRUE

	.FUNCT DESK-F
	EQUAL? PRSA,V?LOOK-INSIDE \?L1
	PRINT THERE-IS
	PRINTI "nothing inside "
	CALL THE-PRINT,PRSO
	PRINTR ". It has all been dumped on the floor."
?L1:	EQUAL? PRSA,V?LOOK-BEHIND \?L5
	EQUAL? PRSO,LARGE-DESK \?L5
	FSET? CORPSE,TOUCHBIT /?L5
	CALL PERFORM,V?EXAMINE,CORPSE
	RTRUE
?L5:	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	CALL OPEN-CLOSE >STACK
	RSTACK

	.FUNCT TRASH-F
	EQUAL? PRSA,V?LOOK-INSIDE,V?SEARCH,V?EXAMINE \FALSE
	PRINTR "An incredible mess has been made of the records in this office. The things on the floor alone would take days to sort out."

	.FUNCT OFFICE-JUNK-F
	EQUAL? PRSA,V?READ,V?EXAMINE \?L1
	PRINTR "Examining it only makes you more aware of what a mess everything is."
?L1:	EQUAL? PRSA,V?TAKE \FALSE
	PRINTR "Carrying such junk would be a waste of effort."

	.FUNCT COMPUTER-F
	EQUAL? PRSA,V?EXAMINE,V?LAMP-ON \?L1
	PRINTR "Whoever smashed things up wrecked this as well."
?L1:	EQUAL? PRSA,V?TAKE \FALSE
	PRINTR "It's attached with a theft prevention bolt."

	.FUNCT DISK-F
	EQUAL? PRSA,V?TAKE \FALSE
	PRINTR "Unfortunately, they are all bent, mangled, and useless."

	.FUNCT SALE-FOLDER-F
	EQUAL? PRSA,V?OPEN /?L3
	EQUAL? PRSA,V?LOOK-INSIDE,V?READ,V?EXAMINE \FALSE
?L3:	PRINTI "[RWD_ID: places:1170, VAL: 1]The folder is labelled ""Sale of Ashcroft Farm."""
	IN? SALE-AGREEMENT,SALE-FOLDER \?L6
	FCLEAR SALE-AGREEMENT,NDESCBIT
	FSET SALE-FOLDER,OPENBIT
	PRINTI " Inside"
	CALL TELL-P$0026S
?L6:	CRLF
	RTRUE

	.FUNCT SALE-AGREEMENT-F
	FSET? SALE-AGREEMENT,NDESCBIT \?L1
	PRINTR "What agreement?"
?L1:	EQUAL? PRSA,V?READ,V?EXAMINE \FALSE
	PRINTI "This document"
	CALL TELL-P$0026S
	CRLF
	RTRUE

	.FUNCT TELL-P$0026S
	PRINTI " is "
	CALL PRINTA,SALE-AGREEMENT
	PRINTI " between the Ashcroft Trust (in the person of "
	PRINTD VERONICA
	PRINTI ") and "
	PRINTD OSTMANN
	PRINTI " Properties, Sam "
	PRINTD OSTMANN
	PRINTI "'s building firm. The agreement is dated today. It is not yet signed by either party."
	RTRUE

	.FUNCT TRUST-FOLDER-F
	EQUAL? PRSA,V?OPEN /?L3
	EQUAL? PRSA,V?LOOK-INSIDE,V?READ,V?EXAMINE \FALSE
?L3:	PRINTI "The folder is labelled ""Ashcroft Family Trust."""
	IN? TRUST-DOCUMENTS,TRUST-FOLDER \?L6
	FCLEAR TRUST-DOCUMENTS,NDESCBIT
	FSET TRUST-FOLDER,OPENBIT
	PRINTI " Inside is a thick "
	PRINTD TRUST-DOCUMENTS
	PRINTI "."
?L6:	CRLF
	RTRUE

	.FUNCT TRUST-DOCUMENTS-F
	FSET? TRUST-DOCUMENTS,NDESCBIT \?L1
	PRINTI "What "
	PRINTD TRUST-DOCUMENTS
	PRINTR "?"
?L1:	EQUAL? PRSA,V?LOOK-INSIDE,V?READ,V?EXAMINE \FALSE
	PRINTR "There are many documents in a stapled bunch. They all concern[RWD_ID: places:1228, VAL: 1] business and financial matters. On top is a letter from an accounting firm. It reads in part: ""While it is difficult to make explicit judgements on the advisability of certain investments by the Ashcroft Family Trust, we find a disturbing pattern. In the past ten years almost twenty percent of the Trust holdings have been placed in four companies, each of which is a poor financial risk. As the accompanying documents show, all four are controlled by Southeast Planning Corporation: privately held, with chief executive officer listed as Colonel Robert Marston."" Curiously, on the back of the bunch there is a paper corner left under the staple where a sheet was torn off."

	.FUNCT LIST-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "The piece of paper has one corner torn from it where it was stapled to something."
?L1:	EQUAL? PRSA,V?READ,V?TAKE \FALSE
	IN? INVESTOR-LIST,FIREPLACE \FALSE
	MOVE INVESTOR-LIST,WINNER
	PRINTR "You reach into the fireplace, heedless of your precious skin, and grab the piece of paper just in time!"

	.FUNCT LR-FIREPLACE-F
	EQUAL? PRSA,V?BURN,V?LOOK-INSIDE,V?EXAMINE \?L1
	FIRST? LR-FIREPLACE >STACK /FALSE
	PRINTR "This fireplace has no fire burning in it."
?L1:	EQUAL? PRSA,V?THROUGH \FALSE
	PRINTR "This is Halloween, not Christmas."

	.FUNCT PORTRAIT-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "There are many generations of Ashcrofts represented here. The family settled in Maryland during the 1600s, and has been here ever since. They've all had their portraits painted at one time or another."

	.FUNCT RUG-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "This is an old and valuable "
	PRINTD PRSO
	EQUAL? PRSO,PSEUDO-OBJECT \?L5
	PRINTI ", now horribly stained by copier toner"
?L5:	PRINTR "."
?L1:	EQUAL? PRSA,V?MOVE,V?LOOK-UNDER \FALSE
	PRINTR "Under the rug you see a wooden trap door... No, sorry! That's another story."

	.FUNCT TOWELS-PSEUDO
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "They are fluffy and soft."
?L1:	EQUAL? PRSA,V?TAKE \FALSE
	PRINTR "You have no need of that."

	.FUNCT JUMPED-OUT?,RM
	ZERO? PLAYER-HIDING /FALSE
	EQUAL? HERE,RM \FALSE
	EQUAL? PRSA,V?PHONE,V?OPEN,V?HELLO /TRUE
	EQUAL? PRSA,V?TAKE,V?STAND,V?$0024CALL /TRUE
	EQUAL? PRSA,V?ASK-ABOUT,V?TELL,V?WALK /TRUE
	RFALSE

	.FUNCT LIBRARY-F,RARG
	EQUAL? RARG,M-BEG \FALSE
	IN? MICHAEL,LIBRARY /?L5
	IN? COL-MARSTON,LIBRARY \FALSE
?L5:	CALL JUMPED-OUT?,LIBRARY >STACK
	ZERO? STACK /FALSE
	SET 'PLAYER-HIDING,0
	PRINTI "As you emerge from concealment, "
	IN? MICHAEL,LIBRARY \?L20
	IN? COL-MARSTON,LIBRARY \?L8
	PRINTD MICHAEL
	PRINTI " and "
	PRINTD COL-MARSTON
	PRINTI " stare at you and then at each other"
	IN? INVESTOR-LIST,MICHAEL \?L12
	PRINTI ", shocked expressions on their faces"
?L12:	PRINTI "."
	CRLF
	JUMP ?L19
?L8:	IN? MICHAEL,LIBRARY \?L20
	PRINTD MICHAEL
	JUMP ?L24
?L20:	PRINTD COL-MARSTON
?L24:	PRINTI " stares at you, surprised."
	CRLF
?L19:	IN? MICHAEL,LIBRARY \?L29
	PUSH MICHAEL
	JUMP ?L31
?L29:	PUSH COL-MARSTON
?L31:	CALL MURDER-TELL,PLAYER,STACK
	RTRUE

	.FUNCT BOOKCASES-F
	EQUAL? PRSA,V?EXAMINE,V?LOOK-INSIDE \FALSE
	PRINTR "The bookcases contain many books."

	.FUNCT TELL-GET-UP
	PRINT HAVE-TO
	PRINTR "get up first."

	.FUNCT VARIOUS-TABLES-F,RARG=0
	EQUAL? PRSA,V?TAKE \?L1
	EQUAL? PRSO,SIDE-TABLE,END-TABLE \?L1
	PRINT RIDICULOUS
	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "On "
	CALL THE-PRINT,PRSO
	PRINTI " sits "
	CALL PRINTA,TELEPHONE
	CALL PRINT-CONTENTS,PRSO,STR?209
	PRINTR "."

	.FUNCT CHAIR-F,RARG=0
	EQUAL? RARG,M-BEG,M-END /FALSE
	EQUAL? PRSA,V?TAKE \?L3
	EQUAL? PRSO,CHAIR \?L3
	PRINT RIDICULOUS
	CRLF
	RTRUE
?L3:	EQUAL? PRSA,V?HIDE-BEHIND \?L6
	ZERO? PLAYER-HIDING \?L6
	IN? PLAYER,CHAIR \?L7
	CALL TELL-GET-UP >STACK
	RSTACK
?L7:	CALL NOW-CONCEALED >STACK
	RSTACK
?L6:	EQUAL? PRSA,V?RUB \FALSE
	PRINTR "It feels very soft and comfy."

	.FUNCT DEATHMASK-BOOK-F
	EQUAL? PRSA,V?OPEN,V?EXAMINE \FALSE
	CALL PERFORM,V?READ,PRSO
	RTRUE

	.FUNCT BOOKS-PSEUDO
	EQUAL? PRSA,V?READ \?L1
	PRINTR "That would take many months, even assuming you are a star pupil of Evelyn Wood."
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "A great many of the books have to do with horses, horse breeding, farm management, and other practical subjects."
	EQUAL? HERE,LIBRARY \?L8
	PRINTI " There is a lot of fiction as well, including the complete works of Dick Francis."
?L8:	CRLF
	RTRUE

	.FUNCT PLANTS-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "There are plants all over the room."
	PRINT DOING-WELL
	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?TAKE \FALSE
	CALL TELL-CARE >STACK
	RSTACK

	.FUNCT TELL-CARE
	PRINTR "After all the care that's been lavished on them? For shame."

	.FUNCT CHINA-PSEUDO
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "It's lovely."
?L1:	EQUAL? PRSA,V?TAKE \FALSE
	PRINTR "It's in a locked cabinet."

	.FUNCT CHANDELIER-F
	EQUAL? PRSA,V?TAKE \FALSE
	PRINTR "It's too high to reach."

	.FUNCT CHINA-CABINET-F
	EQUAL? PRSA,V?EXAMINE,V?LOOK-INSIDE \FALSE
	PRINT THERE-IS
	PRINTI "an exquisite set of antique china and crystal inside "
	CALL THE-PRINT,CHINA-CABINET
	PRINTR "."

	.FUNCT STOVE-PSEUDO
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "This is a gas stove with a kettle boiling on one burner."
?L1:	EQUAL? PRSA,V?LAMP-ON \?L5
	PRINT ITS-ALREADY
	PRINTR "on."
?L5:	EQUAL? PRSA,V?LAMP-OFF \FALSE
	PRINTR "But then the fish won't get done!"

	.FUNCT KETTLE-PSEUDO
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "This is a fine kettle of fish."
?L1:	EQUAL? PRSA,V?TAKE \FALSE
	PRINTR "It's much too hot to take."

	.FUNCT GARAGE-F,RARG
	EQUAL? RARG,M-BEG \FALSE
	IN? MICHAEL,GARAGE \FALSE
	CALL JUMPED-OUT?,GARAGE >STACK
	ZERO? STACK /FALSE
	CALL PLAYER-EMERGES
	SET 'PLAYER-HIDING,0
	PRINTD MICHAEL
	PRINTI " jumps in surprise."
	FSET? PLAYER,TOLD /?L7
	PRINTI " "
	CALL MURDER-TELL,PLAYER,MICHAEL >STACK
	RSTACK
?L7:	CRLF
	RTRUE

	.FUNCT TELL-LOCKED
	CALL THE-PRINT,PRSO,1
	PRINTR " is securely locked."

	.FUNCT CAR-F,RARG=0
	EQUAL? PRSA,V?UNLOCK,V?OPEN,V?THROUGH \?L1
	CALL TELL-LOCKED >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \?L3
	PRINTR "The windows are tinted, but you can see inside well enough to tell there is nothing there."
?L3:	EQUAL? PRSA,V?EXAMINE \?L6
	PRINTI "The car is a late-model "
	CALL DPRINT,PRSO
	PRINTR ". It has Maryland plates."
?L6:	EQUAL? PRSA,V?HIDE-BEHIND \FALSE
	ZERO? PLAYER-HIDING \FALSE
	SET 'PLAYER-HIDING,PRSO
	PRINT YOU-ARE
	PRINTR "now hiding behind the car. It's dim here and you are well concealed."

	.FUNCT TRUNK-F
	EQUAL? PRSA,V?UNLOCK,V?OPEN \FALSE
	FSET? PRSO,LOCKED \FALSE
	CALL TELL-LOCKED >STACK
	RSTACK

	.FUNCT CROWBAR-F
	EQUAL? PRSA,V?UNLOCK \?L1
	EQUAL? PRSI,CROWBAR \?L1
	PRINTR "A crowbar doesn't unlock things, it pries them open."
?L1:	EQUAL? PRSA,V?PICK,V?MUNG,V?OPEN \FALSE
	EQUAL? PRSO,BMW,MERCEDES,POLICE-CAR \?L6
	PRINTR "Turning to car theft since you can't make it in journalism?"
?L6:	EQUAL? PRSO,BMW-TRUNK,MERCEDES-TRUNK \?L10
	IN? MICHAEL,HERE \?L11
	PRINTR "Michael stops you. ""Just what do you think you're doing?"""
?L11:	FSET? PRSO,OPENBIT \?L15
	PRINTR "The trunk is already open."
?L15:	FCLEAR PRSO,LOCKED
	FSET PRSO,OPENBIT
	PRINTI "The trunk lid pops open"
	FIRST? PRSO >STACK \?L21
	PRINTI ", revealing "
	CALL PRINT-CONTENTS,PRSO
?L21:	PRINTR "."
?L10:	FSET? PRSO,DOORBIT /?L29
	FSET? PRSO,WINDOWBIT \FALSE
?L29:	FSET? BURGLAR-ALARM,ONBIT \?L30
	PRINTR "Trying for another B&E, eh?"
?L30:	FSET BURGLAR-ALARM,ONBIT
	CALL QUEUE,I-BURGLAR-ALARM,-1 >STACK
	PUT STACK,0,1
	PRINTI "Your clumsy attempt to "
	EQUAL? PRSA,V?OPEN \?L37
	PUSH STR?210
	JUMP ?L39
?L37:	PUSH STR?211
?L39:	PRINT STACK
	PRINTI " the "
	CALL DPRINT,PRSO
	PRINTI " has set off "
	CALL THE-PRINT,BURGLAR-ALARM
	PRINTR "."

	.FUNCT BURGLAR-ALARM-F
	EQUAL? PRSA,V?LAMP-OFF \?L1
	CALL THE-PRINT,BURGLAR-ALARM,1
	PRINTI " switch"
	PRINT ISNT-HERE
	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?LISTEN \FALSE
	FSET? BURGLAR-ALARM,ONBIT \FALSE
	PRINTR "I take it you are deaf?"

	.FUNCT I-BURGLAR-ALARM
	FSET? BURGLAR-ALARM,ONBIT \FALSE
	IGRTR? 'ALARM-COUNT,30 \?L3
	SET 'ALARM-COUNT,0
	FCLEAR BURGLAR-ALARM,ONBIT
	CALL INT,I-BURGLAR-ALARM >STACK
	PUT STACK,0,0
	RFALSE
?L3:	CALL THE-PRINT,BURGLAR-ALARM,1
	PRINTI " rings stridently."
	CRLF
	RFALSE

	.FUNCT GLOBAL-BALLROOM-F
	EQUAL? PRSA,V?WALK-TO \FALSE
	CALL IN-BALLROOM?,HERE >STACK
	ZERO? STACK /?L3
	CALL TELL-ALREADY-ARE >STACK
	RSTACK
?L3:	CALL PERFORM,V?WALK-TO,BALLROOM-5
	RTRUE

	.FUNCT BALLROOM-5-F,RARG=0
	EQUAL? RARG,M-LOOK \?L1
	CALL BALLROOM-F,RARG >STACK
	RSTACK
?L1:	EQUAL? RARG,M-ENTER \?L3
	LESS? OVER-COUNT,3 \?L3
	SET 'ON-DANCE-FLOOR?,1
	RFALSE
?L3:	EQUAL? RARG,M-BEG \FALSE
	EQUAL? PRSA,V?FOLLOW,V?WALK \?L5
	ZERO? ON-DANCE-FLOOR? /?L5
	SET 'ON-DANCE-FLOOR?,0
	PRINTR "There are quite a few dancers on the floor, and it takes time to pick your way among them. You eventually make some progress, though."
?L5:	EQUAL? PRSA,V?ASK-FOR \?L9
	IN? PRSO,HERE \?L9
	EQUAL? PRSI,BALLROOM-5 \?L9
	CALL PERFORM,V?DANCE,PRSO
	RTRUE
?L9:	EQUAL? PRSA,V?PUT \FALSE
	EQUAL? PRSI,BALLROOM-5 \FALSE
	CALL PERFORM,V?DROP,PRSO
	RTRUE

	.FUNCT BAR-F
	EQUAL? PRSA,V?WALK-TO \FALSE
	EQUAL? HERE,BALLROOM-9 \?L3
	PRINTR "Jack Johnson, the bartender, greets you. He looks at you quizzically, no doubt expecting you to order a drink."
?L3:	CALL PERFORM,V?WALK-TO,BALLROOM-9
	RTRUE

	.FUNCT LOCAL-BAND-DESC-F,RARG=0
	IN? LOCAL-BAND,KITCHEN \?L1
	PRINTR "The band members are on their break. They are sitting around joking, drinking coffee, and wolfing down sandwiches and shrimp cocktail."
?L1:	PRINTR "The band is here, playing their set."

	.FUNCT LOCAL-BAND-F
	EQUAL? LOCAL-BAND,WINNER \?L1
	PRINTI "The band is busy "
	IN? LOCAL-BAND,KITCHEN \?L5
	PRINTI "resting and eating"
	JUMP ?L9
?L5:	PRINTI "performing"
?L9:	PRINTR ", and has no time to talk."
?L1:	EQUAL? PRSA,V?SHOW \?L14
	EQUAL? PRSI,LOCAL-BAND \?L14
	PRINTR "These guys are pretty cool, and react accordingly."
?L14:	EQUAL? PRSA,V?SMELL \?L17
	PRINTR "The band stinks."
?L17:	CALL TALKING-TO?,LOCAL-BAND >STACK
	ZERO? STACK /?L20
	PRINTI "The band is too busy "
	IN? LOCAL-BAND,KITCHEN \?L23
	PUSH STR?212
	JUMP ?L25
?L23:	PUSH STR?213
?L25:	PRINT STACK
	PRINTR " to respond."
?L20:	EQUAL? PRSA,V?EXAMINE \?L26
	GRTR? PRESENT-TIME,764 \?L27
	PRINTR "What band?"
?L27:	PRINTR "The band consists of five guys in checked sport coats. They are very professional, but their repertoire is basically middle-of-the-road, either because they like it that way or because they were asked to play that sort of thing."
?L26:	EQUAL? PRSA,V?FOLLOW,V?FIND \?L34
	GRTR? PRESENT-TIME,764 \?L35
	PRINTR "What band? They've gone home."
?L35:	LOC LOCAL-BAND >STACK
	EQUAL? HERE,STACK \?L39
	PRINTI "They're right"
	CALL TELL-HERE >STACK
	RSTACK
?L39:	PRINTR "They're either in the ballroom or the kitchen."
?L34:	EQUAL? PRSA,V?WALK-TO \?L45
	GRTR? PRESENT-TIME,764 \?L46
	PRINTR "What band? They've gone home."
?L46:	LOC LOCAL-BAND >STACK
	EQUAL? HERE,STACK \?L50
	CALL TELL-CLOSE-ENOUGH >STACK
	RSTACK
?L50:	LOC LOCAL-BAND >STACK
	CALL PERFORM,V?WALK-TO,STACK
	RTRUE
?L45:	EQUAL? PRSA,V?LISTEN \FALSE
	ZERO? BAND-PLAYING? /?L53
	PRINTI "The band is playing """
	PRINT BAND-PLAYING?
	PRINTR "."""
?L53:	GRTR? PRESENT-TIME,764 \?L57
	PRINTR "The band has gone home."
?L57:	PRINTR "The band is on its break."

	.FUNCT RECORD-PLAYER-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "This is a state-of-the-art stereo system, not really "
	CALL PRINTA,RECORD-PLAYER
	PRINTR ". It is actually installed in the wall behind the band. It looks very high-tech and glitzy."
?L1:	EQUAL? PRSA,V?WALK-TO \?L5
	EQUAL? HERE,BALLROOM-2 \?L6
	CALL TELL-CLOSE-ENOUGH >STACK
	RSTACK
?L6:	CALL PERFORM,V?WALK-TO,BALLROOM-2
	RTRUE
?L5:	EQUAL? PRSA,V?LISTEN \FALSE
	CALL THE-PRINT,RECORD-PLAYER,1
	PRINTI " is"
	ZERO? RECORD-PLAYING? /?L12
	PRINTI " playing """
	PRINT RECORD-PLAYING?
	PRINTR "."""
?L12:	ZERO? PARTY-OVER /?L16
	PRINTR " turned off."
?L16:	PRINTR "n't playing anything."

	.FUNCT MUSIC-F
	EQUAL? PRSA,V?LISTEN \FALSE
	CALL IN-BALLROOM?,PLAYER >STACK
	ZERO? STACK /?L3
	ZERO? BAND-PLAYING? /?L5
	CALL PERFORM,V?LISTEN,LOCAL-BAND
	RTRUE
?L5:	ZERO? RECORD-PLAYING? /?L7
	CALL PERFORM,V?LISTEN,RECORD-PLAYER
	RTRUE
?L7:	PRINTR "You hear no music."
?L3:	CALL TELL-YOU-CANT,STR?214 >STACK
	RSTACK

	.FUNCT FIREPLACE-F,RARG=0
	EQUAL? RARG,M-OBJDESC \?L1
	FIRST? FIREPLACE >STACK \TRUE
	PRINT THERE-IS
	PRINTR "something other than logs burning in the fireplace."
?L1:	EQUAL? PRSA,V?TAKE \?L9
	EQUAL? PRSO,FIREPLACE,INVESTOR-LIST /?L9
	FSET? PRSO,BURNBIT \?L11
	PRINTR "You try, but it's aflame and you almost burn yourself."
?L11:	PRINTR "It's too hot from the fire."
?L9:	EQUAL? PRSA,V?POUR-ON \?L18
	EQUAL? PRSO,DRINK \?L18
	EQUAL? PRSI,FIREPLACE \?L18
	PRINTI "Some of "
	CALL THE-PRINT,DRINK
	PRINTR " sizzles away to vapor."
?L18:	EQUAL? PRSA,V?DROP,V?BURN,V?PUT \?L21
	EQUAL? PRSI,FIREPLACE \?L21
	EQUAL? PRSO,ME,PLAYER \?L22
	CALL PERFORM,V?KILL,PLAYER
	RTRUE
?L22:	EQUAL? PRSO,CORPSE,FAIRY-COSTUME \?L24
	PRINTR "You stop short, realizing that it would look very bad and ensure your conviction for the murder."
?L24:	FCLEAR PRSO,WEARBIT
	MOVE PRSO,FIREPLACE
	CALL QUEUE,I-BURN-OBJ,2 >STACK
	PUT STACK,0,1
	CALL THE-PRINT,PRSO,1
	PRINTI " goes into the fire"
	FSET? PRSO,BURNBIT \?L30
	PRINTI ", where it begins to burn"
?L30:	PRINTR "."
?L21:	EQUAL? PRSA,V?LAMP-OFF \?L37
	CALL TELL-YOU-CANT,STR?215 >STACK
	RSTACK
?L37:	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L38
	CALL PRINT-CONTENTS,FIREPLACE,STR?216 >STACK
	ZERO? STACK /?L39
	PRINTR "."
?L39:	PRINT THERE-IS
	PRINTR "a cheery and warm fire burning in the fireplace."
?L38:	EQUAL? PRSA,V?THROUGH \?L46
	PRINTR "It's certainly chilly and damp tonight, but I don't think that's the best way to do something about it."
?L46:	EQUAL? PRSA,V?WALK-TO \FALSE
	EQUAL? HERE,BALLROOM-8 \?L50
	CALL TELL-CLOSE-ENOUGH >STACK
	RSTACK
?L50:	CALL PERFORM,V?WALK-TO,BALLROOM-8
	RTRUE

	.FUNCT TELL-CLOSE-ENOUGH
	PRINT YOU-ARE
	PRINTR "close enough already."

	.FUNCT I-BURN-OBJ,F,BURNED=0
	FIRST? FIREPLACE >F /?L1
?L1:	FSET? F,BURNBIT \?L4
	ZERO? BURNED /?L6
	CALL QUEUE,I-BURN-OBJ,1 >STACK
	PUT STACK,0,1
?L6:	SET 'BURNED,F
?L4:	NEXT? F >F /?L1
	ZERO? BURNED /FALSE
	MOVE BURNED,POLICE-LAB
	EQUAL? HERE,BALLROOM-8 \FALSE
	CALL THE-PRINT,BURNED,1
	PRINTR " has now been consumed by the fire."

	.FUNCT BALLROOM-8-F,RARG=0
	EQUAL? RARG,M-LOOK \?L1
	CALL BALLROOM-F,M-LOOK >STACK
	RSTACK
?L1:	EQUAL? RARG,M-END \FALSE
	CALL IN-MOTION?,VERONICA >STACK
	ZERO? STACK \FALSE
	ZERO? MICHAEL-GREETING? \FALSE
	IN? MICHAEL,HERE \FALSE
	IN? VERONICA,HERE \FALSE
	SET 'MICHAEL-GREETING?,1
	CALL INT,I-WAVE-2 >STACK
	PUT STACK,0,0
	CALL QUEUE,I-SPILL,1 >STACK
	PUT STACK,0,1
	CALL VERONICA-UNMASKS
	CRLF
	PRINTI "The sheik, "
	PRINTD MICHAEL
	PRINTI ", nods a greeting. ""The weather out there is horrible: glad you could make it."" He introduces you to the group around him. ""...and you already know "
	PRINTD VERONICA
	PRINTR "."" The fairy nods in your direction. ""You might find this worth adding to your story,"" he suggests."

	.FUNCT BALLROOM-9-F,RARG=0
	EQUAL? RARG,M-LOOK \?L1
	CALL BALLROOM-F,M-LOOK >STACK
	RSTACK
?L1:	EQUAL? RARG,M-ENTER \FALSE
	GRTR? ARGUMENT-COUNT,0 \FALSE
	PRINTI "You seem to have come in on the midst of "
	CALL PRINTA,DISCUSSION
	PRINTR "."

	.FUNCT BALLROOM-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	GETP HERE,P?LDESC >STACK
	PRINT STACK
	CRLF
	ZERO? PARTY-OVER /?L5
	PRINTI "The ballroom has emptied of the mob that inhabited it a few hours ago. Only a few crushed potato chips and some discarded shoes remain to testify to the revelry."
	JUMP ?L9
?L5:	PRINTI "Elsewhere in this large ballroom, there are "
	ZERO? OVER-COUNT \?L12
	PRINTI "scores of other "
?L12:	PRINTI "party guests dressed in all sorts of outlandish costumes"
	CALL PROB,50 >STACK
	ZERO? STACK /?L19
	PRINTI ", such as "
	CALL PICK-ONE,COSTUMES >STACK
	PRINT STACK
?L19:	PRINTI ". On the dance floor are "
	ZERO? RECORD-PLAYING? /?L26
	PUSH STR?217
	JUMP ?L28
?L26:	PUSH STR?218
?L28:	PRINT STACK
	PRINTI " dancers. "
	ZERO? BAND-PLAYING? /?L29
	PRINTI "The band is playing """
	PRINT BAND-PLAYING?
	PRINTI "."""
	JUMP ?L33
?L29:	PRINTI "A "
	PRINTD RECORD-PLAYER
	PRINTI " is playing """
	PRINT RECORD-PLAYING?
	PRINTI """ (the band is on its break)."
?L33:	CRLF
	PRINTI "On the periphery of the room small groups can be seen, discussing everything from politics to local scandals."
?L9:	CALL WHO-DERE,BALLROOM-1
	CALL WHO-DERE,BALLROOM-2
	CALL WHO-DERE,BALLROOM-3
	CALL WHO-DERE,BALLROOM-4
	CALL WHO-DERE,BALLROOM-5
	CALL WHO-DERE,BALLROOM-6
	CALL WHO-DERE,BALLROOM-7
	IN? VERONICA,BALLROOM-8 /?L38
	CALL WHO-DERE,BALLROOM-8
?L38:	CALL WHO-DERE,BALLROOM-9
	CRLF
	RTRUE

	.FUNCT WHO-DERE,RM,F,CH?=0
	EQUAL? RM,HERE /FALSE
	FIRST? RM >F /?L6
?L36:	GRTR? CH?,1 \?L8
	PRINTI "are"
	JUMP ?L15
?L8:	EQUAL? CH?,1 \TRUE
	PRINTI "is"
?L15:	PRINTI " "
	GETP RM,P?FDESC >STACK
	PRINT STACK
	PRINTI "."
	RTRUE
?L6:	FSET? F,PERSON \?L18
	EQUAL? F,LOCAL-BAND /?L18
	ZERO? CH? \?L19
	PRINTI " "
	JUMP ?L23
?L19:	PRINTI "and "
?L23:	ZERO? CH? \?L26
	CALL DPRINT,F,1
	PRINTI " "
	JUMP ?L30
?L26:	CALL DPRINT,F
	PRINTI " "
?L30:	INC 'CH?
?L18:	NEXT? F >F /?L6
	JUMP ?L36

	.FUNCT I-MUSIC,MINUTES,IB?
	CALL IN-BALLROOM?,WINNER >IB?
	ZERO? PARTY-OVER /?L1
	SET 'BAND-PLAYING?,0
	SET 'RECORD-PLAYING?,0
	RFALSE
?L1:	CALL QUEUE,I-MUSIC,10 >STACK
	PUT STACK,0,1
	MOD PRESENT-TIME,60 >MINUTES
	GRTR? MINUTES,45 /?L6
	GRTR? PRESENT-TIME,764 \?L4
?L6:	CALL PICK-ONE,RECORDS >RECORD-PLAYING?
	ZERO? BAND-PLAYING? /?L7
	GRTR? PRESENT-TIME,764 \?L9
	MOVE LOCAL-BAND,GLOBAL-OBJECTS
	JUMP ?L11
?L9:	MOVE LOCAL-BAND,KITCHEN
?L11:	SET 'BAND-PLAYING?,0
	ZERO? IB? /FALSE
	PRINTI "The band is "
	GRTR? PRESENT-TIME,764 \?L16
	PUSH STR?219
	JUMP ?L18
?L16:	PUSH STR?220
?L18:	PRINT STACK
	PRINTI " now, but to fill the gap, "
	CALL PRINTA,RECORD-PLAYER
	PRINTI " has been started. It's playing """
	PRINT RECORD-PLAYING?
	PRINTI "."""
	CRLF
	RFALSE
?L7:	ZERO? IB? /FALSE
	PRINTI "The record changes. It's now playing """
	PRINT RECORD-PLAYING?
	PRINTI "."""
	CRLF
	RFALSE
?L4:	CALL PICK-ONE,TUNES >BAND-PLAYING?
	ZERO? RECORD-PLAYING? /?L25
	MOVE LOCAL-BAND,BALLROOM-2
	SET 'RECORD-PLAYING?,0
	ZERO? IB? /FALSE
	PRINTI "The band has returned from its break. They start their new set with """
	PRINT BAND-PLAYING?
	PRINTI "."""
	CRLF
	RFALSE
?L25:	ZERO? IB? /FALSE
	PRINTI "After a short pause, the band begins to play """
	PRINT BAND-PLAYING?
	PRINTI "."""
	CRLF
	RFALSE

	.FUNCT POND-PSEUDO
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "It's a small man-made pond."
?L1:	EQUAL? PRSA,V?LEAP,V?THROUGH \FALSE
	PRINTR "You would get all wet and slimy."

	.FUNCT GARDEN-F,RARG=0,?TMP
	EQUAL? RARG,M-ENTER \?L1
	ZERO? DOG-FRIENDLY? /?L3
	PRINTI "As you enter, the dog emerges briefly from his house, recognizes you, and returns."
	CRLF
	CRLF
	RTRUE
?L3:	MOVE DOG,GARDEN
	FCLEAR DOG,NDESCBIT
	CALL QUEUE,I-DOG,5 >STACK
	PUT STACK,0,1
	PRINTI "As you enter the garden, a large, rather vicious sounding dog emerges from "
	CALL THE-PRINT,DOGHOUSE
	PRINTI ". He confronts you, growling and sniffing."
	CRLF
	CRLF
	RTRUE
?L1:	EQUAL? RARG,M-BEG \FALSE
	IN? DOG,HERE \FALSE
	EQUAL? PRSA,V?WALK \FALSE
	ZERO? DOG-FRIENDLY? /?L13
	PRINTI "The dog watches you go, his tail wagging."
	CRLF
	RFALSE
?L13:	ZERO? OHERE /?L17
	SET '?TMP,PRSO
	CALL DIR-FROM,HERE,OHERE >STACK
	EQUAL? ?TMP,STACK \?L17
	PRINTI "The dog somewhat reluctantly allows you to retreat."
	CRLF
	RFALSE
?L17:	PRINTR "The dog bars your way, growling and sniffing. He obviously doesn't trust you. His teeth are bared and his neck hair stands on end."

	.FUNCT I-DOG,D
	LOC DOG >D
	FSET? DOG,RMUNGBIT /FALSE
	MOVE DOG,DOGHOUSE
	FSET DOG,NDESCBIT
	EQUAL? HERE,D \FALSE
	SET 'DOG-FRIENDLY?,1
	PRINTR "Finally the dog decides you mean no harm, gives you one last sniff and returns to his house."

	.FUNCT DOGHOUSE-F,RARG=0
	ZERO? RARG \FALSE
	EQUAL? PRSA,V?THROUGH \?L3
	PRINTI "Your editor may want to send you to "
	CALL THE-PRINT,DOGHOUSE
	PRINTR ", but this is ridiculous!"
?L3:	EQUAL? PRSA,V?EXAMINE \?L7
	CALL THE-PRINT,DOGHOUSE,1
	PRINTR " is a miniature of the main house. It's quite cute. It's also pretty large."
?L7:	EQUAL? PRSA,V?SMELL \?L10
	PRINTR "It smells of wet dog."
?L10:	EQUAL? PRSA,V?LOOK-INSIDE \FALSE
	IN? DOG,DOGHOUSE \?L14
	PRINT THERE-IS
	PRINTI "a large, wet Doberman pinscher in "
	CALL THE-PRINT,DOGHOUSE
	PRINTR "."
?L14:	CALL THE-PRINT,DOGHOUSE,1
	PRINTR " is empty."

	.FUNCT DOG-F
	EQUAL? WINNER,DOG /?L3
	CALL TALKING-TO?,DOG >STACK
	ZERO? STACK /?L1
?L3:	ZERO? DOG-FRIENDLY? /?L4
	PRINTR "The dog listens intently, but doesn't seem to understand you."
?L4:	PRINTR "The dog growls."
?L1:	EQUAL? PRSA,V?SLAP /?L12
	EQUAL? PRSA,V?KICK,V?KILL,V?ATTACK \?L11
?L12:	FSET DOG,RMUNGBIT
	PRINTI "Its "
	ZERO? DOG-FRIENDLY? /?L15
	PRINTI "trust betrayed"
	JUMP ?L19
?L15:	PRINTI "suspicions confirmed"
?L19:	PRINTR ", the dog bites you on the leg. It continues to block the path."
?L11:	EQUAL? PRSA,V?SHOW,V?GIVE \?L24
	PRINTR "The dog sniffs it, but doesn't want it."
?L24:	EQUAL? PRSA,V?MOVE,V?TAKE \?L27
	PRINTR "This dog is as big as you are."
?L27:	EQUAL? PRSA,V?RUB \FALSE
	ZERO? DOG-FRIENDLY? /?L31
	PRINTR "The dog wags his tail, spattering you with water. He enjoys being patted."
?L31:	FSET? DOG,RMUNGBIT \?L35
	PRINTR "The dog bites your hand."
?L35:	PRINTR "As your hand approaches, the dog snaps at it, more as a warning than as a real attack."

	.FUNCT BARN-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	PRINTI "As you enter the barn, you see a horrific sight. Entering in haste, and without light, "
	PRINTD MICHAEL
	PRINTI " and "
	PRINTD ALICIA
	PRINTI " scared "
	PRINTD VERONICA
	PRINTI "'s horse into a state of thrashing, rearing terror. It smashed the door of its stall and trampled Michael, who lies in the straw, apparently dead. "
	PRINTD ALICIA
	PRINTI " is "
	IN? ALICIA,HERE \?L5
	PRINTI "screaming in terror. The poor horse, its flanks heaving, is in a corner looking fearfully from side to side."
	CRLF
	JUMP ?L9
?L5:	PRINTI "nowhere to be seen."
	CRLF
?L9:	SET 'FLEEING?,0
	SET 'DETECTIVE-SEEN,DETECTIVE-CONVINCED
	SET 'DETECTIVE-SEEN-CORPSE?,1
	SET 'DETECTIVE-SEEN-ROPE?,1
	SET 'DETECTIVE-SEEN-COAT?,1
	SET 'DETECTIVE-SEEN-GLASS?,1
	SET 'DETECTIVE-SEEN-HAIR?,1
	SET 'DETECTIVE-SEEN-CARD?,1
	SET 'DETECTIVE-SEEN-AGREEMENT?,1
	SET 'DETECTIVE-SEEN-TRUST-DOCUMENTS?,1
	SET 'DETECTIVE-SEEN-LIST?,1
	SET 'GLASS-ANALYZED?,1
	SET 'GLASS-ANALYZED-FOR-PRINTS?,1
	SET 'DETECTIVE-TOLD-ABOUT-RAIN?,1
	IN? ALICIA,BARN \?L12
	SET 'MICHAEL-DEAD?,1
	CALL ARREST,MICHAEL,ALICIA
	RETURN 2
?L12:	CALL FINISH
	RETURN 2
?L1:	ZERO? RARG \FALSE
	EQUAL? PRSA,V?WALK-TO,V?THROUGH \?L18
	EQUAL? PRSO,PSEUDO-OBJECT \?L18
	CALL PERFORM,V?WALK-TO,BARN
	RTRUE
?L18:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "This is a well-kept, red-and-white-painted horse barn."

	.FUNCT NOT-HERE-OBJECT-F,TBL,PRSO?=1,OBJ
	EQUAL? PRSO,NOT-HERE-OBJECT \?L5
	EQUAL? PRSI,NOT-HERE-OBJECT \?L1
	PRINTI "Those things aren't"
	CALL TELL-HERE
	RTRUE
?L1:	EQUAL? PRSO,NOT-HERE-OBJECT \?L5
	SET 'TBL,P-PRSO
	JUMP ?L6
?L5:	SET 'TBL,P-PRSI
	SET 'PRSO?,0
?L6:	ZERO? PRSO? /?L7
	EQUAL? PRSA,V?FINGERPRINT,V?ANALYZE,V?ACCUSE /?L11
	EQUAL? PRSA,V?ARREST,V?WAIT-FOR,V?WALK-TO /?L11
	EQUAL? PRSA,V?THROUGH,V?MAKE,V?PHONE /?L11
	EQUAL? PRSA,V?WHAT,V?SEARCH-OBJECT-FOR,V?SEARCH /?L11
	EQUAL? PRSA,V?FOLLOW,V?FIND,V?EXAMINE /?L11
	EQUAL? PRSA,V?CLIMB-UP,V?ASK-CONTEXT-FOR,V?ASK-CONTEXT-ABOUT \?L9
?L11:	CALL FIND-NOT-HERE,TBL,PRSO? >OBJ
	ZERO? OBJ /FALSE
	EQUAL? OBJ,NOT-HERE-OBJECT /?L29
	RTRUE
?L9:	EQUAL? PRSA,V?TELL \?L29
	SET 'P-CONT,0
	SET 'QUOTE-FLAG,0
	JUMP ?L29
?L7:	EQUAL? PRSA,V?TELL-ME,V?SGIVE,V?SEARCH-OBJECT-FOR /?L23
	EQUAL? PRSA,V?SAY,V?ASK-FOR,V?ASK-ABOUT \?L29
?L23:	CALL FIND-NOT-HERE,TBL,PRSO? >OBJ
	ZERO? OBJ /FALSE
	EQUAL? OBJ,NOT-HERE-OBJECT \TRUE
?L29:	SET 'P-WON,0
	CALL TELL-CANT-SEE,STR?221
	CALL NOT-HERE-PRINT
	CALL TELL-HERE
	RTRUE

	.FUNCT TELL-CANT-SEE,STR
	PRINT YOU-CANT-SEE
	PRINT STR
	RTRUE

	.FUNCT TELL-HERE
	PRINTR " here."

	.FUNCT FIND-NOT-HERE,TBL,PRSO?,M-F,OBJ,CNT=0,PB?,LOCAL=0
	CALL MOBY-FIND,TBL >M-F
	GRTR? M-F,1 \?L16
	CALL IN-BALLROOM?,PLAYER >PB?
?L3:	IGRTR? 'CNT,M-F /?L4
	GET TBL,CNT >OBJ
	ZERO? PB? /?L11
	CALL IN-BALLROOM?,OBJ >STACK
	ZERO? STACK \?L10
?L11:	CALL CORRIDOR-LOOK,OBJ >STACK
	ZERO? STACK /?L3
?L10:	IGRTR? 'LOCAL,1 /?L4
	SET 'P-MOBY-FOUND,OBJ
	JUMP ?L3
?L4:	EQUAL? LOCAL,1 \?L16
	SET 'M-F,1
?L16:	EQUAL? M-F,1 \?L20
	ZERO? PRSO? /?L22
	SET 'PRSO,P-MOBY-FOUND
	RFALSE
?L22:	SET 'PRSI,P-MOBY-FOUND
	RFALSE
?L20:	GRTR? M-F,1 \?L25
	EQUAL? PRSA,V?EXAMINE \?L26
	RETURN NOT-HERE-OBJECT
?L26:	GET TBL,1 >OBJ
	GETP OBJ,P?GENERIC >STACK
	CALL STACK,OBJ >OBJ
	ZERO? OBJ /?L28
	EQUAL? OBJ,NOT-HERE-OBJECT /TRUE
	ZERO? PRSO? /?L31
	SET 'PRSO,OBJ
	RETURN PRSO
?L31:	SET 'PRSI,OBJ
	RETURN PRSI
?L28:	ZERO? P-NAM \?L33
	CALL TELL-NO-NOUNS
	RTRUE
?L33:	CALL WHICH-PRINT,0,M-F,TBL
	EQUAL? TBL,P-PRSO \?L35
	SET 'P-ACLAUSE,P-NC1
	JUMP ?L37
?L35:	SET 'P-ACLAUSE,P-NC2
?L37:	SET 'P-AADJ,P-ADJ
	SET 'P-ANAM,P-NAM
	CALL ORPHAN,0,0
	SET 'P-OFLAG,1
	RTRUE
?L25:	ZERO? PRSO? \?L61
	FSET? PRSO,PERSON \?L40
	EQUAL? PRSA,V?WHAT-IS-WAS,V?TELL-ME,V?ASK-FOR /?L42
	EQUAL? PRSA,V?ASK-ABOUT /?L42
?L40:	ZERO? PRSO? /?L41
?L61:	EQUAL? PRSA,V?ASK-CONTEXT-FOR,V?ASK-CONTEXT-ABOUT /?L42
?L41:	EQUAL? WINNER,PLAYER /?L38
	EQUAL? PRSA,V?SGIVE,V?GIVE,V?WHAT /?L42
	EQUAL? PRSA,V?FIND,V?FOLLOW,V?WALK-TO \?L38
?L42:	EQUAL? WINNER,PLAYER /?L43
	CALL DPRINT,WINNER,1
	JUMP ?L50
?L43:	EQUAL? PRSA,V?TELL-ME,V?ASK-FOR,V?ASK-ABOUT \?L47
	EQUAL? PRSO,PLAYER,CORPSE /?L47
	CALL DPRINT,PRSO,1
	JUMP ?L50
?L47:	CALL TELL-ISNT-ANYONE
	RTRUE
?L50:	PRINTI " looks confused. "
	CALL I-DONT-KNOW-ABOUT,STR?221,0
	CALL NOT-HERE-PRINT
	PRINTR "!"""
?L38:	ZERO? PRSO? \?L55
	PRINTI "You wouldn't find any"
	CALL NOT-HERE-PRINT
	PRINTR " there."
?L55:	RETURN NOT-HERE-OBJECT

	.FUNCT NOT-HERE-PRINT
	ZERO? P-OFLAG \?L3
	ZERO? P-MERGED /?L1
?L3:	ZERO? P-XADJ /?L4
	PRINTI " "
	PRINTB P-XADJN
?L4:	ZERO? P-XNAM /FALSE
	PRINTI " "
	PRINTB P-XNAM
	RTRUE
?L1:	EQUAL? PRSO,NOT-HERE-OBJECT \?L14
	GET P-ITBL,P-NC1L >STACK
	GET P-ITBL,P-NC1 >STACK
	CALL BUFFER-PRINT,STACK,STACK,0 >STACK
	RSTACK
?L14:	GET P-ITBL,P-NC2L >STACK
	GET P-ITBL,P-NC2 >STACK
	CALL BUFFER-PRINT,STACK,STACK,0 >STACK
	RSTACK

	.FUNCT THE?,NOUN
	EQUAL? NOUN,IT,YOU,HIM-HER /TRUE
	FSET? NOUN,PERSON /TRUE
	PRINTI " the"
	RTRUE

	.FUNCT THIS-IS-IT,OBJ
	SET 'P-IT-OBJECT,OBJ
	SET 'P-IT-LOC,HERE
	RETURN P-IT-LOC

	.FUNCT WEATHER-F
	EQUAL? PRSA,V?LISTEN,V?FIND,V?EXAMINE \?L1
	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK \?L3
	CALL GLOBAL-IN?,WINDOW,HERE >STACK
	ZERO? STACK \?L3
	CALL TELL-YOU-CANT,STR?222 >STACK
	RSTACK
?L3:	LESS? PRESENT-TIME,550 \?L5
	PRINTR "The rain is pouring down. It's a great night for ducks!"
?L5:	LESS? PRESENT-TIME,570 \?L8
	SET 'SAW-RAIN-SLACK-OFF?,1
	PRINTR "The rain has slacked off, it's just a drizzle now."
?L8:	LESS? PRESENT-TIME,630 \?L11
	PRINTI "The rain is coming down in buckets"
	ZERO? SAW-RAIN-SLACK-OFF? /?L14
	PRINTI " again"
?L14:	PRINTR "."
?L11:	PRINTR "The rain is almost stopped, and the storm seems to be passing off to the northeast."
?L1:	EQUAL? PRSA,V?RUB \FALSE
	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK /?L25
	PRINTR "It's wet."
?L25:	CALL TELL-YOU-CANT,STR?223 >STACK
	RSTACK

	.FUNCT I-RAIN-SLOWS
	SET 'RAIN-STATE,1
	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK /FALSE
	SET 'SAW-RAIN-SLACK-OFF?,1
	PRINTI "Now the rain has slowed. It's just a light shower now."
	CRLF
	RFALSE

	.FUNCT I-RAIN-POURS
	SET 'RAIN-STATE,2
	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK /FALSE
	PRINTI "Now the rain is coming down in torrents, a real cloudburst."
	CRLF
	RFALSE

	.FUNCT I-RAIN-STOPS
	SET 'RAIN-STATE,0
	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK /FALSE
	PRINTI "Now the rain has slowed down almost to a stop. Only a few drops are falling now."
	CRLF
	RFALSE

	.FUNCT WATER-F
	EQUAL? PRSA,V?WALK \FALSE
	CALL PERFORM,V?LAMP-ON,WATER
	RTRUE

	.FUNCT TELEPHONE-F
	EQUAL? PRSA,V?REPLY \?L1
	PRINTR "It wasn't ringing."
?L1:	EQUAL? PRSA,V?TAKE \?L5
	PRINTR "You hear a dial tone."
?L5:	EQUAL? PRSA,V?PHONE \?L8
	EQUAL? PRSO,TELEPHONE \?L8
	PRINT YOU-SHOULD
	PRINTR "dial a number, such as 911."
?L8:	EQUAL? PRSA,V?HANG-UP \FALSE
	CALL INT,I-HANG-UP >STACK
	PUT STACK,0,0
	PRINTR "You replace the receiver."

	.FUNCT SINK-F
	EQUAL? PRSA,V?BRUSH \FALSE
	EQUAL? PRSO,HANDS \FALSE
	PRINTI "Your hands are now clean."
	CRLF
	CALL PRINT-ID,STR?224 >STACK
	RSTACK

	.FUNCT SHOWER-F
	EQUAL? PRSA,V?LAMP-ON,V?TAKE \?L1
	PRINTR "You'd get your costume all wet."
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \FALSE
	PRINT THERE-IS
	PRINTR "no blood in the shower."

	.FUNCT TOILET-F,RARG=0
	EQUAL? RARG,M-END /FALSE
	EQUAL? PRSO,TOILET \FALSE
	EQUAL? PRSA,V?USE,V?WALK \?L4
	PRINTI "You now feel refreshed."
	CRLF
	CALL PRINT-ID,STR?225 >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?SMELL,V?LOOK-INSIDE \?L8
	PRINTR "The toilet is immaculate. Nosey, aren't you?"
?L8:	EQUAL? PRSA,V?FLUSH \FALSE
	PRINT YOU-ARE
	PRINTI "a model and considerate guest."
	CRLF
	CALL PRINT-ID,STR?226 >STACK
	RSTACK

	.FUNCT GLOBAL-ROOM-F
	EQUAL? PRSA,V?LOOK-ON,V?EXAMINE \?L1
	CALL PERFORM,V?LOOK
	RTRUE
?L1:	EQUAL? PRSA,V?SEARCH-OBJECT-FOR \?L3
	CALL PERFORM,V?FIND,PRSI
	RTRUE
?L3:	EQUAL? PRSA,V?PUT \FALSE
	EQUAL? PRSI,GLOBAL-ROOM \FALSE
	CALL PERFORM,V?DROP,PRSO
	RTRUE

	.FUNCT GLOBAL-MURDER-F,OW
	EQUAL? PRSA,V?TELL-ME \?L1
	EQUAL? WINNER,PLAYER \?L1
	EQUAL? PRSI,GLOBAL-MURDER \?L1
	CALL PERFORM,V?REVEAL,GLOBAL-MURDER,PRSO
	FSET PLAYER,TOLD
	FSET PRSO,TOLD
	RTRUE
?L1:	EQUAL? PRSA,V?$0024REVEAL \?L3
	EQUAL? PRSO,GLOBAL-MURDER \?L3
	CALL REVEAL-MURDER,PRSI
	FSET WINNER,TOLD
	IN? PRSI,HERE \?L4
	CALL DPRINT,WINNER,1
	PRINTI " sees "
	CALL DPRINT,PRSI
	PRINTI " and they speak for a few moments. "
	CALL DPRINT,PRSI,1
	PRINTI "'s eyes widen as "
	CALL HE$002fSHE-PRINT,PRSI
	PRINTR " is told of the murder. There is an apparent conflict between shock and the desire to immediately tell someone else about it."
?L4:	CALL NEARBY?,PRSI >STACK
	ZERO? STACK /TRUE
	CALL DPRINT,WINNER,1
	PRINTI " is speaking excitedly and urgently to "
	CALL DPRINT,PRSI
	PRINTI " some distance away. You can't hear what is being said, but "
	CALL DPRINT,PRSI
	PRINTI " is very agitated by what "
	CALL HE$002fSHE-PRINT,PRSI
	PRINTR " has heard."
?L3:	EQUAL? PRSA,V?IS \FALSE
	EQUAL? PRSO,VERONICA,CORPSE,GLOBAL-VERONICA \FALSE
	EQUAL? PLAYER,WINNER /FALSE
	SET 'OW,WINNER
	SET 'WINNER,PLAYER
	CALL PERFORM,V?REVEAL,GLOBAL-MURDER,OW
	RTRUE

	.FUNCT GLASS-F,W
	SET 'W,WINNER
	EQUAL? PRSA,V?TAKE \?L1
	IN? GLASS,BUTLER \?L1
	SET 'WINNER,BUTLER
	CALL PERFORM,V?GIVE,GLASS,W
	SET 'WINNER,W
	RETURN WINNER
?L1:	EQUAL? PRSA,V?CUT \?L3
	EQUAL? PRSO,PLAYER \?L3
	PRINTI "Suicide is not the answer."
	CRLF
	CALL PRINT-ID,STR?227 >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?SMELL \?L6
	PRINT THERE-IS
	PRINTI "something on the glass which smells sweet -- probably the remains of "
	PRINTD VERONICA
	PRINTR "'s drink."
?L6:	EQUAL? PRSA,V?EXAMINE \?L9
	PRINTI "This is a large fragment of "
	PRINTD GLASS
	PRINTR " from a highball glass. There is a film of red liquid on the inside."
?L9:	EQUAL? PRSA,V?ANALYZE \FALSE
	EQUAL? PRSI,GLOBAL-FINGERPRINTS \?L13
	PRINT YOU-DONT-HAVE
	PRINTR "the equipment."
?L13:	PRINTR "Since you're not a psychiatrist or a laboratory chemist, your chances of a successful analysis are poor. Perhaps you should get someone more competent to do the job."

	.FUNCT LIQUID-F
	EQUAL? PRSA,V?RUB /?L3
	EQUAL? PRSA,V?SMELL,V?EAT,V?EXAMINE \FALSE
?L3:	PRINTI "This seems to be the remains of "
	PRINTD VERONICA
	PRINTR "'s drink."

	.FUNCT SHOP-F
	EQUAL? PRSA,V?PHONE \FALSE
	GRTR? PRESENT-TIME,600 \?L3
	PRINTR "The telephone rings continuously for as long as you wait."
?L3:	MOVE JACK,HERE
	CALL QUEUE,I-HANG-UP,5 >STACK
	PUT STACK,0,1
	PRINTR "A tired-sounding voice answers. ""Costumes Unlimited, Jack speaking. We're closing at ten. We don't have many costumes left. Better make it quick."""

	.FUNCT I-HANG-UP
	IN? JACK,HERE \FALSE
	REMOVE JACK
	PRINTR "You hear a click as the telephone is hung up at the other end."

	.FUNCT JACK-F
	IN? JACK,HERE /?L1
	PRINTR "He hung up."
?L1:	EQUAL? JACK,WINNER /?L6
	EQUAL? PRSA,V?$0024CALL \?L5
?L6:	EQUAL? PRSA,V?TELL-ME,V?SGIVE /FALSE
	PRINTR """Get to the point, I'm busy."""
?L5:	EQUAL? PRSA,V?EXAMINE,V?TAKE \?L12
	PRINTI "Jack's on the telephone, not"
	CALL TELL-HERE >STACK
	RSTACK
?L12:	EQUAL? PRSA,V?ASK-ABOUT \FALSE
	EQUAL? PRSO,JACK \FALSE
	EQUAL? PRSI,GLOBAL-VERONICA,VERONICA,CORPSE \?L16
	ZERO? JACK-ASKED? \?L18
	SET 'JACK-ASKED?,1
	PRINTI """"
	PRINTD VERONICA
	PRINTI " Ashcroft, eh? Upper crust type, right? Yeah, she rented "
	CALL PRINTA,FAIRY-COSTUME
	PRINTR ". Real expensive. Great costume, though."""
?L18:	PRINT REPEATING-YOURSELF
	CRLF
	RTRUE
?L16:	EQUAL? PRSI,FAIRY-COSTUME \?L25
	ZERO? JACK-ASKED? \?L26
	SET 'JACK-ASKED?,1
	PRINTI """Yeah, we rented one of them. Some society dame rented it. Just a minute, I can tell you who...""  There is a short pause. ""Yeah, here she is. "
	PRINTD VERONICA
	PRINTR " Ashcroft, one Titania costume, a hundred and twenty dollars. We don't get much call for that one. Heck of a costume, though."""
?L26:	PRINT REPEATING-YOURSELF
	CRLF
	RTRUE
?L25:	PRINTR """Get to the point, I'm busy."""

	.FUNCT JACKSON-F
	EQUAL? PRSA,V?PHONE \FALSE
	CALL TELL-NO-ANSWER >STACK
	RSTACK

	.FUNCT WASTE-BASKET-F
	EQUAL? PRSA,V?SEARCH-OBJECT-FOR /?L3
	EQUAL? PRSA,V?SEARCH,V?EXAMINE,V?LOOK-INSIDE \FALSE
?L3:	EQUAL? PRSO,WASTE-BASKET \FALSE
	IN? CARD,WASTE-BASKET \?L4
	FCLEAR CARD,NDESCBIT
	FSET CARD,TAKEBIT
	PRINTI "A crumpled "
	PRINTD CARD
	PRINTI " is on top"
	JUMP ?L8
?L4:	PRINTI "It's nearly full"
?L8:	PRINTI " of boring trash"
	CALL PRINT-CONTENTS,WASTE-BASKET,STR?199,CARD
	PRINTR "."

	.FUNCT TAXI-F
	EQUAL? PRSA,V?PHONE \FALSE
	PRINTR "Since this is late on a rainy, disgusting night, the taxi company has all its telephones off the hook. Too bad."

	.FUNCT HANDS-F
	EQUAL? PRSA,V?BRUSH \FALSE
	CALL GLOBAL-IN?,SINK,HERE >STACK
	ZERO? STACK /?L3
	CALL PERFORM,V?BRUSH,HANDS,SINK
	RTRUE
?L3:	PRINTR "There are sinks in the bathrooms."

	.FUNCT FOOD-F
	EQUAL? PRSA,V?THROW-THROUGH,V?THROW-AT,V?THROW \?L1
	PRINTI "This isn't ""Animal House."""
	CRLF
	CALL PRINT-ID,STR?228 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?TAKE \?L5
	PRINTR "I suppose you plan to take it home in your pockets and eat it later?"
?L5:	EQUAL? PRSA,V?SMELL,V?EAT \FALSE
	PRINTI "Not bad. Obviously "
	PRINTD VERONICA
	PRINTI " found a good caterer."
	CRLF
	CALL PRINT-ID,STR?229 >STACK
	RSTACK

	.FUNCT GLOBAL-CHAIR-F,RARG=0
	EQUAL? RARG,M-BEG,M-END /FALSE
	EQUAL? PRSA,V?TAKE \?L3
	EQUAL? PRSO,GLOBAL-CHAIR \?L3
	PRINT RIDICULOUS
	CRLF
	CALL PRINT-ID,STR?230 >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?PUT \?L6
	EQUAL? PRSI,GLOBAL-CHAIR,GLOBAL-SOFA \?L6
	FCLEAR PRSO,WEARBIT
	MOVE PRSO,HERE
	PRINTI "It seems a shame to mar "
	CALL THE-PRINT,PRSI
	PRINTI " with "
	CALL PRINTA,PRSO
	PRINTR ", so you put it on the floor instead."
?L6:	EQUAL? PRSA,V?SIT \?L9
	EQUAL? PRSO,GLOBAL-CHAIR,GLOBAL-SOFA \?L9
	CALL HELD?,CORPSE >STACK
	ZERO? STACK /?L9
	CALL THE-PRINT,PRSO,1
	PRINTR " can't take that much weight."
?L9:	EQUAL? PRSA,V?HIDE-BEHIND \FALSE
	ZERO? PLAYER-HIDING \FALSE
	CALL NOW-CONCEALED >STACK
	RSTACK

	.FUNCT NOW-CONCEALED
	SET 'PLAYER-HIDING,PRSO
	PRINT YOU-ARE
	PRINTI "now concealed behind "
	CALL TELL-PRSO >STACK
	RSTACK

	.FUNCT CURTAINS-F
	CALL GLOBAL-IN?,CURTAINS,HERE >STACK
	ZERO? STACK \?L1
	PRINTI "There are no curtains"
	CALL TELL-HERE >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \?L5
	FSET? HERE,OPENBIT \?L6
	PRINTR "You see darkness."
?L6:	PRINTR "The curtains are closed."
?L5:	EQUAL? PRSA,V?EXAMINE \?L13
	PRINTI "The curtains are "
	FSET? HERE,OPENBIT \?L16
	PRINTI "open"
	JUMP ?L20
?L16:	PRINTI "closed"
?L20:	PRINTR "."
?L13:	EQUAL? PRSA,V?OPEN \?L25
	FSET? HERE,OPENBIT \?L26
	PRINT THEY-ARE-ALREADY
	PRINTR "open."
?L26:	FSET HERE,OPENBIT
	PRINT CURTAINS-ARE
	PRINTR "open."
?L25:	EQUAL? PRSA,V?CLOSE \FALSE
	FSET? HERE,OPENBIT /?L34
	PRINT THEY-ARE-ALREADY
	PRINTR "closed."
?L34:	FCLEAR HERE,OPENBIT
	PRINT CURTAINS-ARE
	PRINTR "closed."

	.FUNCT WINDOW-F
	EQUAL? PRSA,V?CLOSE,V?OPEN \?L1
	PRINTR "All the windows are closed and locked. The house has a reasonably serious security setup."
?L1:	EQUAL? PRSA,V?LOOK-OUTSIDE,V?LOOK-INSIDE \FALSE
	FSET? HERE,OPENBIT /?L8
	CALL GLOBAL-IN?,CURTAINS,HERE >STACK
	ZERO? STACK \?L6
?L8:	CALL PERFORM,V?EXAMINE,WEATHER
	RTRUE
?L6:	PRINTR "The curtains are drawn."

	.FUNCT GLOBAL-PLANTS-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "These are "
	EQUAL? HERE,PORCH \?L5
	PRINTI "small potted shrubs, bushes"
	JUMP ?L9
?L5:	PRINTI "large shrubs, bushes, trees"
?L9:	PRINTI ", and so on."
	PRINT DOING-WELL
	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?EAT,V?MUNG,V?TAKE \FALSE
	CALL TELL-CARE >STACK
	RSTACK

	.FUNCT HOUSE-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK /?L3
	PRINTR "It's dark, but you know that the Ashcroft house is a large, mostly colonial structure. It was extensively rebuilt in the late nineteenth century. It is partly brick, and partly white-painted wood."
?L3:	PRINTR "The house is in good repair."

	.FUNCT KEY-F
	EQUAL? PRSA,V?FIND \FALSE
	PRINTR "I don't know where the keys are."

	.FUNCT STAIR-F
	EQUAL? PRSA,V?CLIMB-UP,V?CLIMB-FOO \?L1
	CALL DO-WALK,P?UP
	RTRUE
?L1:	EQUAL? PRSA,V?CLIMB-DOWN \FALSE
	CALL DO-WALK,P?DOWN
	RTRUE

	.FUNCT PARTY-F
	EQUAL? PRSA,V?LEAVE \FALSE
	PRINTR "Don't be such a wet blanket!"

	.INSERT "suspect/suspect_str"
	.END
