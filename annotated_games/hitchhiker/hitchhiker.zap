	.INSERT "annotated_games/hitchhiker/hitchhiker_freq"
	.INSERT "annotated_games/hitchhiker/hitchhiker_data"

	.FUNCT PRINT-DESC1,OBJ
	ZERO? OBJ /FALSE
	PRINTD OBJ
	RTRUE

	.FUNCT PRINT-ID,ID,CONDITION=1
	ZERO? CONDITION /FALSE
	PRINTI "[ID: "
	PRINT ID
	PRINTI ", PRSO: "
	CALL PRINT-DESC1,PRSO
	PRINTI ", PRSI: "
	CALL PRINT-DESC1,PRSI
	PRINTI "]"
	RTRUE

	.FUNCT PRINT-DEBUG,TEXT,CONDITION=1
	ZERO? CONDITION /FALSE
	PRINTI "DEBUG FLAG: "
	PRINT TEXT
	RTRUE

	.FUNCT IS-THEFT?
	EQUAL? PRSA,V?TAKE \FALSE
	EQUAL? PRSO,AUTOPILOT-BUTTON,AWL,BANNER /TRUE
	EQUAL? PRSO,BEAST-GUN,BIKE,BLASTER /TRUE
	EQUAL? PRSO,BOARD,BOAT-OBJECT,BULLDOZER /TRUE
	EQUAL? PRSO,CAGE,CASE-SWITCH,CHIPPER /TRUE
	EQUAL? PRSO,CHISEL,CONTROLS,CURTAINS /TRUE
	EQUAL? PRSO,DAMOGRAN,DIGITAL-WATCH,DIPSWITCH /TRUE
	EQUAL? PRSO,DISPENSER,DISPENSER-BUTTON,FLOWERPOT /TRUE
	EQUAL? PRSO,FRUIT,GLASS-CASE,GREEN-BUTTON /TRUE
	EQUAL? PRSO,HANDBAG,HOOK,INTERFACE-BOX /TRUE
	EQUAL? PRSO,JUKEBOX,KEY,KEYBOARD /TRUE
	EQUAL? PRSO,LARGE-PLUG,MAIL,MAIN-DRIVE /TRUE
	EQUAL? PRSO,MINERAL-WATER,NUTRIMAT,PINCER /TRUE
	EQUAL? PRSO,PLANT,PLIERS,PUB-FURNISHINGS /TRUE
	EQUAL? PRSO,RASP,RED-BUTTON,RIFLES /TRUE
	EQUAL? PRSO,ROBOT-PANEL,SATCHEL,SMALL-PLUG /TRUE
	EQUAL? PRSO,SPARE-DRIVE,SPEEDBOAT,STAR-DRIVE /TRUE
	EQUAL? PRSO,SWITCH,TWEEZERS,WINE \FALSE
	RTRUE

	.FUNCT IS-OBJECT-OR-PROPERTY?
	EQUAL? PRSO,AUTOPILOT-BUTTON,AWL,BANNER /TRUE
	EQUAL? PRSO,BAR,BEAST-GUN,BED /TRUE
	EQUAL? PRSO,BEDROOM,BEDROOM-DOOR,BEDROOM-FURNISHINGS /TRUE
	EQUAL? PRSO,BEER,BIKE,BLASTER /TRUE
	EQUAL? PRSO,BOARD,BOAT-OBJECT,BRIDGE /TRUE
	EQUAL? PRSO,BULLDOZER,CAGE,CANOPY /TRUE
	EQUAL? PRSO,CASE-SWITCH,CEILING,CHIPPER /TRUE
	EQUAL? PRSO,CHISEL,CLIFF,CONTROLS /TRUE
	EQUAL? PRSO,CURTAINS,CUSHION-FLUFF,DAMOGRAN /TRUE
	EQUAL? PRSO,DIGITAL-WATCH,DIPSWITCH,DISPENSER /TRUE
	EQUAL? PRSO,DISPENSER-BUTTON,DRAIN,FLOWERPOT /TRUE
	EQUAL? PRSO,FRUIT,GLASS-CASE,GLOBAL-BED /TRUE
	EQUAL? PRSO,GOWN,GREEN-BUTTON,HANDBAG /TRUE
	EQUAL? PRSO,HATCH,HOOK,INTERFACE-BOX /TRUE
	EQUAL? PRSO,JACKET-FLUFF,JUKEBOX,KEY /TRUE
	EQUAL? PRSO,KEYBOARD,LARGE-PLUG,LARGE-RECEPTACLE /TRUE
	EQUAL? PRSO,LIGHT,MAGNIFYING-GLASS,MAIL /TRUE
	EQUAL? PRSO,MAIN-DRIVE,MINERAL-WATER,NUTRIMAT /TRUE
	EQUAL? PRSO,PAD,PEANUTS,PHONE /TRUE
	EQUAL? PRSO,PILOT-SEAT,PINCER,PLANT /TRUE
	EQUAL? PRSO,PLIERS,PLOTTER,POCKET-FLUFF /TRUE
	EQUAL? PRSO,POETRY-APPRECIATION-CHAIR,PUB-FURNISHINGS,RASP /TRUE
	EQUAL? PRSO,RED-BUTTON,RIFLES,ROBOT-PANEL /TRUE
	EQUAL? PRSO,ROSES,SANDWICH,SATCHEL /TRUE
	EQUAL? PRSO,SCREWDRIVER,SINK,SKELETON /TRUE
	EQUAL? PRSO,SLEEVES,SMALL-PLUG,SMALL-RECEPTACLE /TRUE
	EQUAL? PRSO,SPARE-DRIVE,SPEEDBOAT,SPIRE /TRUE
	EQUAL? PRSO,STAR-DRIVE,STUFF-UNDER-BED,SUBSTITUTE /TRUE
	EQUAL? PRSO,SWITCH,TABLET,TEA /TRUE
	EQUAL? PRSO,THING,TOOLBOX,TOOTHBRUSH /TRUE
	EQUAL? PRSO,TOWEL,TWEEZERS,VOGON-CORRIDOR-DOOR /TRUE
	EQUAL? PRSO,VOGON-INNER-DOOR,VOGON-OUTER-DOOR,WALLS /TRUE
	EQUAL? PRSO,WINDOW,WINE,WRENCH \FALSE
	RTRUE

	.FUNCT IS-PERSON?
	EQUAL? PRSO,SCREENING-DOOR,ARTHUR,BARMAN /TRUE
	EQUAL? PRSO,FORD,HOSTESS,PHIL /TRUE
	EQUAL? PRSO,PROSSER,TRILLIAN,VLHURG /TRUE
	EQUAL? PRSO,VOGON-CAPTAIN,ZAPHOD,GUARDS /TRUE
	EQUAL? PRSO,BULLDOZER-DRIVER,EDDIE,MARVIN /TRUE
	EQUAL? PRSO,MICROSCOPIC-FLEET \FALSE
	RTRUE

	.FUNCT DANGEROUS-DRINK?
	RFALSE

	.FUNCT DANGEROUS-FOOD?,?TMP
	CALL IS-PART-OF-SELF? >?TMP
	ZERO? ?TMP /?L2
	RETURN ?TMP
?L2:	CALL IS-OBJECT-OR-PROPERTY? >STACK
	RSTACK

	.FUNCT IS-ANIMAL?
	EQUAL? PRSO,BABEL-FISH,BEAST,DOG /TRUE
	EQUAL? PRSO,WHALE-OBJECT \FALSE
	RTRUE

	.FUNCT IS-OBJ-PROP-ANIMAL?,?TMP
	CALL IS-OBJECT-OR-PROPERTY? >?TMP
	ZERO? ?TMP /?L2
	RETURN ?TMP
?L2:	CALL IS-ANIMAL? >STACK
	RSTACK

	.FUNCT IS-SELF?
	EQUAL? PRSO,ME,BRAIN \FALSE
	RTRUE

	.FUNCT IS-PART-OF-SELF?
	EQUAL? PRSO,HANDS,TEETH,HEAD /TRUE
	EQUAL? PRSO,EYES,EARS \FALSE
	RTRUE

	.FUNCT IS-PART-OF-SELF-OR-SELF?
	EQUAL? PRSO,HANDS,TEETH,HEAD /TRUE
	EQUAL? PRSO,EYES,EARS,ME /TRUE
	EQUAL? PRSO,BRAIN \FALSE
	RTRUE

	.FUNCT PARSER,PTR=P-LEXSTART,WRD,VAL=0,VERB=0,DONT=0,LEN,DIR=0,NW=0,LW=0,NUM,SCNT,CNT=-1
?L1:	IGRTR? 'CNT,P-ITBLLEN /?L2
	PUT P-ITBL,CNT,0
	JUMP ?L1
?L2:	SET 'IN-FRONT-FLAG,0
	SET 'P-ADVERB,0
	SET 'P-MERGED,0
	SET 'P-END-ON-PREP,0
	PUT P-PRSO,P-MATCHLEN,0
	PUT P-PRSI,P-MATCHLEN,0
	PUT P-BUTS,P-MATCHLEN,0
	ZERO? QUOTE-FLAG \?L6
	EQUAL? WINNER,PLAYER /?L6
	SET 'WINNER,PLAYER
	LOC WINNER >STACK
	FSET? STACK,VEHBIT /?L8
	LOC WINNER >HERE
?L8:	CALL LIT?,HERE >LIT
?L6:	ZERO? P-CONT /?L12
	SET 'PTR,P-CONT
	EQUAL? VERBOSITY,1,2 \?L14
	EQUAL? PLAYER,WINNER \?L14
	CRLF
?L14:	SET 'P-CONT,0
	JUMP ?L17
?L12:	SET 'WINNER,PLAYER
	SET 'QUOTE-FLAG,0
	LOC WINNER >STACK
	FSET? STACK,VEHBIT /?L18
	LOC WINNER >HERE
?L18:	CALL LIT?,HERE >LIT
	EQUAL? VERBOSITY,1,2 \?L21
	CRLF
?L21:	PRINTI ">"
	READ P-INBUF,P-LEXV
	GETB P-LEXV,P-LEXWORDS >P-INPUT-WORDS
?L17:	GETB P-LEXV,P-LEXWORDS >P-LEN
	ZERO? P-LEN \?L26
	PRINTI "I beg your pardon?"
	CRLF
	RFALSE
?L26:	SET 'LEN,P-LEN
	SET 'P-NCN,0
	SET 'P-GETFLAGS,0
?L31:	DLESS? 'P-LEN,0 \?L33
	SET 'QUOTE-FLAG,0
	JUMP ?L32
?L33:	GET P-LEXV,PTR >WRD
	ZERO? WRD \?L36
	CALL NUMBER?,PTR >WRD
	ZERO? WRD /?L35
?L36:	EQUAL? WRD,W?TO \?L37
	EQUAL? VERB,ACT?TELL,ACT?ASK \?L37
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	CALL WT?,STACK,PS?VERB,P1?VERB >STACK
	ZERO? STACK /?L37
	PUT P-ITBL,P-VERB,ACT?TELL
	SET 'WRD,W?$QUOTE
	JUMP ?L39
?L37:	EQUAL? WRD,W?THEN \?L39
	ZERO? VERB \?L39
	ZERO? QUOTE-FLAG \?L39
	PUT P-ITBL,P-VERB,ACT?TELL
	PUT P-ITBL,P-VERBN,0
	SET 'WRD,W?$QUOTE
?L39:	EQUAL? WRD,W?$PERIOD \?L41
	EQUAL? LW,W?MR \?L41
	SET 'LW,0
	JUMP ?L95
?L41:	EQUAL? WRD,W?THEN,W?$PERIOD /?L44
	EQUAL? WRD,W?$QUOTE \?L43
?L44:	EQUAL? WRD,W?$QUOTE \?L50
	EQUAL? VERB,ACT?CARVE,ACT?MY \?L47
	PUT P-LEXV,PTR,W?THE
	INC 'P-LEN
	JUMP ?L31
?L47:	ZERO? QUOTE-FLAG /?L49
	SET 'QUOTE-FLAG,0
	JUMP ?L50
?L49:	SET 'QUOTE-FLAG,1
?L50:	ZERO? P-LEN /?L52
	ADD PTR,P-LEXELEN >P-CONT
?L52:	PUTB P-LEXV,P-LEXWORDS,P-LEN
	JUMP ?L32
?L43:	CALL WT?,WRD,PS?DIRECTION,P1?DIRECTION >VAL
	ZERO? VAL /?L54
	EQUAL? VERB,0,ACT?WALK \?L54
	EQUAL? LEN,1 /?L55
	EQUAL? LEN,2 \?L56
	EQUAL? VERB,ACT?WALK /?L55
?L56:	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >NW
	EQUAL? NW,W?THEN,W?$PERIOD,W?$QUOTE \?L57
	LESS? LEN,2 \?L55
?L57:	ZERO? QUOTE-FLAG /?L58
	EQUAL? LEN,2 \?L58
	EQUAL? NW,W?$QUOTE /?L55
?L58:	GRTR? LEN,2 \?L54
	EQUAL? NW,W?$COMMA,W?AND \?L54
?L55:	SET 'DIR,VAL
	EQUAL? NW,W?$COMMA,W?AND \?L59
	ADD PTR,P-LEXELEN >STACK
	PUT P-LEXV,STACK,W?THEN
?L59:	GRTR? LEN,2 /?L95
	SET 'QUOTE-FLAG,0
	JUMP ?L32
?L54:	CALL WT?,WRD,PS?VERB,P1?VERB >VAL
	ZERO? VAL /?L65
	ZERO? VERB \?L65
	SET 'VERB,VAL
	PUT P-ITBL,P-VERB,VAL
	PUT P-ITBL,P-VERBN,P-VTBL
	PUT P-VTBL,0,WRD
	MUL PTR,2 >STACK
	ADD STACK,2 >NUM
	GETB P-LEXV,NUM >STACK
	PUTB P-VTBL,2,STACK
	ADD NUM,1 >STACK
	GETB P-LEXV,STACK >STACK
	PUTB P-VTBL,3,STACK
	JUMP ?L95
?L65:	CALL WT?,WRD,PS?PREPOSITION,0 >VAL
	ZERO? VAL \?L67
	EQUAL? WRD,W?ALL,W?ONE,W?BOTH /?L68
	CALL WT?,WRD,PS?ADJECTIVE >STACK
	ZERO? STACK \?L68
	CALL WT?,WRD,PS?OBJECT >STACK
	ZERO? STACK /?L66
?L68:	SET 'VAL,0
?L67:	GRTR? P-LEN,0 \?L69
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?OF \?L69
	ZERO? VAL \?L106
	EQUAL? WRD,W?ALL,W?ONE,W?A /?L69
	EQUAL? WRD,W?BOTH \?L95
?L69:	ZERO? VAL /?L71
?L106:	ZERO? P-LEN /?L72
	ADD PTR,2 >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?THEN,W?$PERIOD \?L71
?L72:	SET 'P-END-ON-PREP,1
	LESS? P-NCN,2 \?L95
	PUT P-ITBL,P-PREP1,VAL
	PUT P-ITBL,P-PREP1N,WRD
	JUMP ?L95
?L71:	EQUAL? P-NCN,2 \?L76
	PRINTI "There were too many nouns in that sentence."
	CRLF
	RFALSE
?L76:	INC 'P-NCN
	EQUAL? VAL,PR?IN \?L80
	ADD PTR,2 >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?FRONT \?L80
	SET 'IN-FRONT-FLAG,1
	JUMP ?L82
?L80:	EQUAL? VAL,PR?DOWN \?L82
	ADD PTR,2 >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?IN \?L82
	ADD PTR,4 >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?FRONT \?L82
	SET 'IN-FRONT-FLAG,1
?L82:	CALL CLAUSE,PTR,VAL,WRD >PTR
	ZERO? PTR /FALSE
	LESS? PTR,0 \?L95
	SET 'QUOTE-FLAG,0
	JUMP ?L32
?L66:	ZERO? VERB \?L89
	EQUAL? WRD,W?DON$0027T,W?DONT \?L89
	SET 'DONT,1
	JUMP ?L95
?L89:	CALL WT?,WRD,PS?BUZZ-WORD >STACK
	ZERO? STACK \?L95
	EQUAL? VERB,ACT?TELL \?L91
	CALL WT?,WRD,PS?VERB,P1?VERB >STACK
	ZERO? STACK /?L91
	EQUAL? WINNER,PLAYER \?L91
	PRINTI "Please consult your manual for the correct way to talk to characters."
	CRLF
	RFALSE
?L91:	CALL CANT-USE,PTR
	RFALSE
?L35:	CALL UNKNOWN-WORD,PTR
	RFALSE
?L95:	SET 'LW,WRD
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L31
?L32:	ZERO? DIR /?L96
	SET 'PRSA,V?WALK
	SET 'PRSO,DIR
	SET 'P-OFLAG,0
	SET 'P-WALK-DIR,DIR
	SET 'DONT-FLAG,DONT
	RTRUE
?L96:	SET 'P-WALK-DIR,0
	ZERO? P-OFLAG /?L101
	CALL ORPHAN-MERGE >STACK
	ZERO? STACK \?L99
?L101:	SET 'DONT-FLAG,DONT
?L99:	CALL SYNTAX-CHECK >STACK
	ZERO? STACK /FALSE
	CALL SNARF-OBJECTS >STACK
	ZERO? STACK /FALSE
	CALL MANY-CHECK >STACK
	ZERO? STACK /FALSE
	CALL TAKE-CHECK >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT WT?,PTR,BIT,B1=5,OFFS=P-P1OFF,TYP
	GETB PTR,P-PSOFF >TYP
	BTST TYP,BIT \FALSE
	GRTR? B1,4 /TRUE
	BAND TYP,P-P1BITS >TYP
	EQUAL? TYP,B1 /?L6
	INC 'OFFS
?L6:	GETB PTR,OFFS >STACK
	RSTACK

	.FUNCT CLAUSE,PTR,VAL,WRD,OFF,NUM,ANDFLG=0,FIRST??=1,NW,LW=0
	SUB P-NCN,1 >STACK
	MUL STACK,2 >OFF
	ZERO? VAL /?L1
	ADD P-PREP1,OFF >NUM
	PUT P-ITBL,NUM,VAL
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,WRD
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L3
?L1:	INC 'P-LEN
?L3:	ZERO? P-LEN \?L4
	DEC 'P-NCN
	RETURN -1
?L4:	ADD P-NC1,OFF >NUM
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	PUT P-ITBL,NUM,STACK
	GET P-LEXV,PTR >STACK
	EQUAL? STACK,W?THE,W?A,W?AN \?L7
	GET P-ITBL,NUM >STACK
	ADD STACK,4 >STACK
	PUT P-ITBL,NUM,STACK
?L7:	DLESS? 'P-LEN,0 \?L12
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,STACK
	RETURN -1
?L12:	GET P-LEXV,PTR >WRD
	ZERO? WRD \?L17
	CALL NUMBER?,PTR >WRD
	ZERO? WRD /?L15
?L17:	ZERO? P-LEN \?L18
	SET 'NW,0
	JUMP ?L20
?L18:	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >NW
?L20:	EQUAL? WRD,W?$PERIOD \?L21
	EQUAL? LW,W?MR \?L21
	SET 'LW,0
	JUMP ?L42
?L21:	EQUAL? WRD,W?AND,W?$COMMA \?L23
	SET 'ANDFLG,1
	JUMP ?L42
?L23:	EQUAL? WRD,W?ALL,W?ONE,W?BOTH \?L24
	EQUAL? NW,W?OF \?L42
	DEC 'P-LEN
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L42
?L24:	EQUAL? WRD,W?THEN,W?$PERIOD /?L29
	CALL WT?,WRD,PS?PREPOSITION >STACK
	ZERO? STACK /?L28
	GET P-ITBL,P-VERB >STACK
	ZERO? STACK /?L28
	ZERO? FIRST?? \?L28
?L29:	INC 'P-LEN
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,STACK
	SUB PTR,P-LEXELEN >STACK
	RSTACK
?L28:	ZERO? ANDFLG /?L30
	GET P-ITBL,P-VERB >STACK
	ZERO? STACK \?L30
	SUB PTR,4 >PTR
	ADD PTR,2 >STACK
	PUT P-LEXV,STACK,W?THEN
	ADD P-LEN,2 >P-LEN
	JUMP ?L42
?L30:	CALL WT?,WRD,PS?OBJECT >STACK
	ZERO? STACK /?L31
	GRTR? P-LEN,0 \?L32
	EQUAL? NW,W?OF \?L32
	EQUAL? WRD,W?ALL,W?ONE \?L42
?L32:	CALL WT?,WRD,PS?ADJECTIVE,P1?ADJECTIVE >STACK
	ZERO? STACK /?L34
	ZERO? NW /?L34
	CALL WT?,NW,PS?OBJECT >STACK
	ZERO? STACK \?L42
	CALL WT?,NW,PS?ADJECTIVE >STACK
	ZERO? STACK \?L42
?L34:	ZERO? ANDFLG \?L36
	EQUAL? NW,W?BUT,W?EXCEPT,W?AND /?L36
	EQUAL? NW,W?$COMMA /?L36
	ADD PTR,2 >STACK
	MUL STACK,2 >STACK
	ADD P-LEXV,STACK >STACK
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,STACK
	RETURN PTR
?L36:	SET 'ANDFLG,0
	JUMP ?L42
?L31:	CALL WT?,WRD,PS?ADJECTIVE >STACK
	ZERO? STACK \?L42
	CALL WT?,WRD,PS?BUZZ-WORD >STACK
	ZERO? STACK \?L42
	CALL WT?,WRD,PS?PREPOSITION >STACK
	ZERO? STACK \?L42
	CALL CANT-USE,PTR
	RFALSE
?L15:	CALL UNKNOWN-WORD,PTR
	RFALSE
?L42:	SET 'LW,WRD
	SET 'FIRST??,0
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L7

	.FUNCT NUMBER?,PTR,CNT,BPTR,CHR,SUM=0,TIM=0
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	GETB STACK,2 >CNT
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	GETB STACK,3 >BPTR
?L1:	DLESS? 'CNT,0 /?L2
	GETB P-INBUF,BPTR >CHR
	EQUAL? CHR,58 \?L6
	SET 'TIM,SUM
	SET 'SUM,0
	JUMP ?L10
?L6:	GRTR? SUM,10000 /FALSE
	LESS? CHR,58 \FALSE
	GRTR? CHR,47 \FALSE
	SUB CHR,48 >STACK
	MUL SUM,10 >STACK
	ADD STACK,STACK >SUM
?L10:	INC 'BPTR
	JUMP ?L1
?L2:	PUT P-LEXV,PTR,W?INTNUM
	GRTR? SUM,1000 /FALSE
	ZERO? TIM /?L13
	LESS? TIM,8 \?L14
	ADD TIM,12 >TIM
	JUMP ?L16
?L14:	GRTR? TIM,23 /FALSE
?L16:	MUL TIM,60 >STACK
	ADD SUM,STACK >SUM
?L13:	SET 'P-NUMBER,SUM
	RETURN W?INTNUM

	.FUNCT ORPHAN-MERGE,CNT=-1,TEMP,VERB,BEG,END,ADJ=0,WRD
	SET 'P-OFLAG,0
	GET P-ITBL,P-VERBN >STACK
	GET STACK,0 >WRD
	CALL WT?,WRD,PS?ADJECTIVE,P1?ADJECTIVE >STACK
	ZERO? STACK /?L1
	SET 'ADJ,1
	JUMP ?L3
?L1:	CALL WT?,WRD,PS?OBJECT,P1?OBJECT >STACK
	ZERO? STACK /?L3
	ZERO? P-NCN \?L3
	PUT P-ITBL,P-VERB,0
	PUT P-ITBL,P-VERBN,0
	ADD P-LEXV,2 >STACK
	PUT P-ITBL,P-NC1,STACK
	ADD P-LEXV,6 >STACK
	PUT P-ITBL,P-NC1L,STACK
	SET 'P-NCN,1
?L3:	GET P-ITBL,P-VERB >VERB
	ZERO? VERB /?L5
	ZERO? ADJ \?L5
	GET P-OTBL,P-VERB >STACK
	EQUAL? VERB,STACK \FALSE
?L5:	EQUAL? P-NCN,2 /FALSE
	GET P-OTBL,P-NC1 >STACK
	EQUAL? STACK,1 \?L8
	GET P-ITBL,P-PREP1 >TEMP
	GET P-OTBL,P-PREP1 >STACK
	EQUAL? TEMP,STACK /?L11
	ZERO? TEMP \FALSE
?L11:	ZERO? ADJ /?L12
	ADD P-LEXV,2 >STACK
	PUT P-OTBL,P-NC1,STACK
	GET P-ITBL,P-NC1L >STACK
	ZERO? STACK \?L14
	ADD P-LEXV,6 >STACK
	PUT P-ITBL,P-NC1L,STACK
?L14:	ZERO? P-NCN \?L20
	SET 'P-NCN,1
	JUMP ?L20
?L12:	GET P-ITBL,P-NC1 >STACK
	PUT P-OTBL,P-NC1,STACK
?L20:	GET P-ITBL,P-NC1L >STACK
	PUT P-OTBL,P-NC1L,STACK
	JUMP ?L41
?L8:	GET P-OTBL,P-NC2 >STACK
	EQUAL? STACK,1 \?L22
	GET P-ITBL,P-PREP1 >TEMP
	GET P-OTBL,P-PREP2 >STACK
	EQUAL? TEMP,STACK /?L25
	ZERO? TEMP \FALSE
?L25:	ZERO? ADJ /?L28
	ADD P-LEXV,2 >STACK
	PUT P-ITBL,P-NC1,STACK
	GET P-ITBL,P-NC1L >STACK
	ZERO? STACK \?L28
	ADD P-LEXV,6 >STACK
	PUT P-ITBL,P-NC1L,STACK
?L28:	GET P-ITBL,P-NC1 >STACK
	PUT P-OTBL,P-NC2,STACK
	GET P-ITBL,P-NC1L >STACK
	PUT P-OTBL,P-NC2L,STACK
	SET 'P-NCN,2
	JUMP ?L41
?L22:	ZERO? P-ACLAUSE /?L41
	EQUAL? P-NCN,1 /?L34
	ZERO? ADJ \?L34
	SET 'P-ACLAUSE,0
	RFALSE
?L34:	GET P-ITBL,P-NC1 >BEG
	ZERO? ADJ /?L37
	ADD P-LEXV,2 >BEG
	SET 'ADJ,0
?L37:	GET P-ITBL,P-NC1L >END
?L40:	GET BEG,0 >WRD
	EQUAL? BEG,END \?L42
	ZERO? ADJ /?L44
	CALL ACLAUSE-WIN,ADJ
	JUMP ?L41
?L44:	SET 'P-ACLAUSE,0
	RFALSE
?L42:	ZERO? ADJ \?L47
	GETB WRD,P-PSOFF >STACK
	BTST STACK,PS?ADJECTIVE /?L48
	EQUAL? WRD,W?ALL,W?ONE \?L47
?L48:	SET 'ADJ,WRD
	JUMP ?L50
?L47:	EQUAL? WRD,W?ONE \?L49
	CALL ACLAUSE-WIN,ADJ
	JUMP ?L41
?L49:	GETB WRD,P-PSOFF >STACK
	BTST STACK,PS?OBJECT \?L50
	EQUAL? WRD,P-ANAM \?L51
	CALL ACLAUSE-WIN,ADJ
	JUMP ?L41
?L51:	CALL NCLAUSE-WIN
	JUMP ?L41
?L50:	ADD BEG,P-WORDLEN >BEG
	ZERO? END \?L40
	SET 'END,BEG
	SET 'P-NCN,1
	SUB BEG,4 >STACK
	PUT P-ITBL,P-NC1,STACK
	PUT P-ITBL,P-NC1L,BEG
	JUMP ?L40
?L41:	GET P-OVTBL,0 >STACK
	PUT P-VTBL,0,STACK
	GETB P-OVTBL,2 >STACK
	PUTB P-VTBL,2,STACK
	GETB P-OVTBL,3 >STACK
	PUTB P-VTBL,3,STACK
	PUT P-OTBL,P-VERBN,P-VTBL
	PUTB P-VTBL,2,0
?L59:	IGRTR? 'CNT,P-ITBLLEN \?L61
	SET 'P-MERGED,1
	RTRUE
?L61:	GET P-OTBL,CNT >STACK
	PUT P-ITBL,CNT,STACK
	JUMP ?L59

	.FUNCT ACLAUSE-WIN,ADJ
	GET P-OTBL,P-VERB >STACK
	PUT P-ITBL,P-VERB,STACK
	EQUAL? ADJ,W?TEA \?L1
	CALL NCLAUSE-WIN
	JUMP ?L3
?L1:	PUT P-CCTBL,CC-SBPTR,P-ACLAUSE
	ADD P-ACLAUSE,1 >STACK
	PUT P-CCTBL,CC-SEPTR,STACK
	PUT P-CCTBL,CC-DBPTR,P-ACLAUSE
	ADD P-ACLAUSE,1 >STACK
	PUT P-CCTBL,CC-DEPTR,STACK
	CALL CLAUSE-COPY,P-OTBL,P-OTBL,ADJ
?L3:	GET P-OTBL,P-NC2 >STACK
	ZERO? STACK /?L4
	SET 'P-NCN,2
?L4:	SET 'P-ACLAUSE,0
	RTRUE

	.FUNCT NCLAUSE-WIN
	PUT P-CCTBL,CC-SBPTR,P-NC1
	PUT P-CCTBL,CC-SEPTR,P-NC1L
	PUT P-CCTBL,CC-DBPTR,P-ACLAUSE
	ADD P-ACLAUSE,1 >STACK
	PUT P-CCTBL,CC-DEPTR,STACK
	CALL CLAUSE-COPY,P-ITBL,P-OTBL
	GET P-OTBL,P-NC2 >STACK
	ZERO? STACK /?L1
	SET 'P-NCN,2
?L1:	SET 'P-ACLAUSE,0
	RTRUE

	.FUNCT WORD-PRINT,CNT,BUF
?L1:	DLESS? 'CNT,0 /TRUE
	GETB P-INBUF,BUF >STACK
	PRINTC STACK
	INC 'BUF
	JUMP ?L1

	.FUNCT UNKNOWN-WORD,PTR,BUF,?TMP
	PRINTI "I don't know the word """
	MUL PTR,2 >BUF
	ADD P-LEXV,BUF >STACK
	GETB STACK,2 >?TMP
	ADD P-LEXV,BUF >STACK
	GETB STACK,3 >STACK
	CALL WORD-PRINT,?TMP,STACK
	PRINTI """."
	CRLF
	SET 'QUOTE-FLAG,0
	SET 'P-OFLAG,0
	RETURN P-OFLAG

	.FUNCT CANT-USE,PTR,BUF,?TMP
	PRINTI "You used the word """
	MUL PTR,2 >BUF
	ADD P-LEXV,BUF >STACK
	GETB STACK,2 >?TMP
	ADD P-LEXV,BUF >STACK
	GETB STACK,3 >STACK
	CALL WORD-PRINT,?TMP,STACK
	PRINTI """ in a way that I don't understand."
	CRLF
	SET 'QUOTE-FLAG,0
	SET 'P-OFLAG,0
	RETURN P-OFLAG

	.FUNCT SYNTAX-CHECK,SYN,LEN,NUM,OBJ,DRIVE1=0,DRIVE2=0,PREP,VERB,TMP
	GET P-ITBL,P-VERB >VERB
	ZERO? VERB \?L1
	PRINTI "There was no verb in that sentence!"
	CRLF
	RFALSE
?L1:	SUB 255,VERB >STACK
	GET VERBS,STACK >SYN
	GETB SYN,0 >LEN
	INC 'SYN
?L6:	GETB SYN,P-SBITS >STACK
	BAND STACK,P-SONUMS >NUM
	GRTR? P-NCN,NUM /?L15
	LESS? NUM,1 /?L10
	ZERO? P-NCN \?L10
	GET P-ITBL,P-PREP1 >PREP
	ZERO? PREP /?L11
	GETB SYN,P-SPREP1 >STACK
	EQUAL? PREP,STACK \?L10
?L11:	SET 'DRIVE1,SYN
	JUMP ?L15
?L10:	GET P-ITBL,P-PREP1 >STACK
	GETB SYN,P-SPREP1 >STACK
	EQUAL? STACK,STACK \?L15
	EQUAL? NUM,2 \?L13
	EQUAL? P-NCN,1 \?L13
	SET 'DRIVE2,SYN
	JUMP ?L15
?L13:	GET P-ITBL,P-PREP2 >STACK
	GETB SYN,P-SPREP2 >STACK
	EQUAL? STACK,STACK \?L15
	CALL SYNTAX-FOUND,SYN
	RTRUE
?L15:	DLESS? 'LEN,1 \?L18
	ZERO? DRIVE1 \?L56
	ZERO? DRIVE2 \?L7
	CALL V-TELL-TIME
	RFALSE
?L18:	ADD SYN,P-SYNLEN >SYN
	JUMP ?L6
?L7:	ZERO? DRIVE1 /?L25
?L56:	GETB DRIVE1,P-SPREP1 >STACK
	GETB DRIVE1,P-SLOC1 >STACK
	GETB DRIVE1,P-SFWIM1 >STACK
	CALL GWIM,STACK,STACK,STACK >OBJ
	ZERO? OBJ /?L25
	PUT P-PRSO,P-MATCHLEN,1
	PUT P-PRSO,1,OBJ
	CALL SYNTAX-FOUND,DRIVE1 >STACK
	RSTACK
?L25:	ZERO? DRIVE2 /?L27
	GETB DRIVE2,P-SPREP2 >STACK
	GETB DRIVE2,P-SLOC2 >STACK
	GETB DRIVE2,P-SFWIM2 >STACK
	CALL GWIM,STACK,STACK,STACK >OBJ
	ZERO? OBJ /?L27
	PUT P-PRSI,P-MATCHLEN,1
	PUT P-PRSI,1,OBJ
	CALL SYNTAX-FOUND,DRIVE2 >STACK
	RSTACK
?L27:	EQUAL? VERB,ACT?FIND \?L28
	PRINTI "I can't answer that question."
	CRLF
	RFALSE
?L28:	EQUAL? WINNER,PROTAGONIST /?L31
	CALL CANT-ORPHAN >STACK
	RSTACK
?L31:	CALL ORPHAN,DRIVE1,DRIVE2
	PRINTI "What do"
	ZERO? DONT-FLAG /?L35
	PRINTI "n't"
?L35:	PRINTI " you want to "
	GET P-OTBL,P-VERBN >TMP
	ZERO? TMP \?L42
	PRINTI "tell"
	JUMP ?L47
?L42:	GETB P-VTBL,2 >STACK
	ZERO? STACK \?L46
	GET TMP,0 >STACK
	PRINTB STACK
	JUMP ?L47
?L46:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
	PUTB P-VTBL,2,0
?L47:	ZERO? DRIVE2 /?L48
	CALL CLAUSE-PRINT,P-NC1,P-NC1L
?L48:	SET 'P-OFLAG,1
	ZERO? DRIVE1 /?L51
	GETB DRIVE1,P-SPREP1 >STACK
	JUMP ?L53
?L51:	GETB DRIVE2,P-SPREP2 >STACK
?L53:	CALL PREP-PRINT,STACK
	PRINTI "?"
	CRLF
	RFALSE

	.FUNCT CANT-ORPHAN
	EQUAL? WINNER,GUARDS \?L1
	EQUAL? HERE,DAIS \?L1
	PRINTI """We"
	JUMP ?L5
?L1:	PRINTI """I"
?L5:	PRINTI " don't understand! What are you referring to?"""
	CRLF
	RFALSE

	.FUNCT ORPHAN,D1,D2,CNT=-1
	ZERO? P-MERGED \?L1
	PUT P-OCLAUSE,P-MATCHLEN,0
?L1:	GET P-VTBL,0 >STACK
	PUT P-OVTBL,0,STACK
	GETB P-VTBL,2 >STACK
	PUTB P-OVTBL,2,STACK
	GETB P-VTBL,3 >STACK
	PUTB P-OVTBL,3,STACK
?L4:	IGRTR? 'CNT,P-ITBLLEN /?L5
	GET P-ITBL,CNT >STACK
	PUT P-OTBL,CNT,STACK
	JUMP ?L4
?L5:	EQUAL? P-NCN,2 \?L9
	PUT P-CCTBL,CC-SBPTR,P-NC2
	PUT P-CCTBL,CC-SEPTR,P-NC2L
	PUT P-CCTBL,CC-DBPTR,P-NC2
	PUT P-CCTBL,CC-DEPTR,P-NC2L
	CALL CLAUSE-COPY,P-ITBL,P-OTBL
?L9:	LESS? P-NCN,1 /?L12
	PUT P-CCTBL,CC-SBPTR,P-NC1
	PUT P-CCTBL,CC-SEPTR,P-NC1L
	PUT P-CCTBL,CC-DBPTR,P-NC1
	PUT P-CCTBL,CC-DEPTR,P-NC1L
	CALL CLAUSE-COPY,P-ITBL,P-OTBL
?L12:	ZERO? D1 /?L15
	GETB D1,P-SPREP1 >STACK
	PUT P-OTBL,P-PREP1,STACK
	PUT P-OTBL,P-NC1,1
	RTRUE
?L15:	ZERO? D2 /FALSE
	GETB D2,P-SPREP2 >STACK
	PUT P-OTBL,P-PREP2,STACK
	PUT P-OTBL,P-NC2,1
	RTRUE

	.FUNCT CLAUSE-PRINT,BPTR,EPTR,THE?=1
	GET P-ITBL,EPTR >STACK
	GET P-ITBL,BPTR >STACK
	CALL BUFFER-PRINT,STACK,STACK,THE? >STACK
	RSTACK

	.FUNCT BUFFER-PRINT,BEG,END,CP,NOSP=0,WRD,FIRST??=1,PN=0
?L1:	EQUAL? BEG,END /TRUE
	ZERO? NOSP /?L6
	SET 'NOSP,0
	JUMP ?L8
?L6:	PRINTI " "
?L8:	GET BEG,0 >WRD
	EQUAL? WRD,W?$PERIOD \?L11
	SET 'NOSP,1
	JUMP ?L15
?L11:	EQUAL? WRD,W?ME \?L13
	PRINTD ME
	SET 'PN,1
	JUMP ?L15
?L13:	CALL NAME?,WRD >STACK
	ZERO? STACK /?L14
	CALL CAPITALIZE,BEG
	SET 'PN,1
	JUMP ?L15
?L14:	ZERO? FIRST?? /?L16
	ZERO? PN \?L16
	ZERO? CP /?L16
	PRINTI "the "
?L16:	ZERO? P-OFLAG \?L23
	ZERO? P-MERGED /?L21
?L23:	PRINTB WRD
	JUMP ?L25
?L21:	EQUAL? WRD,W?IT \?L24
	CALL ACCESSIBLE?,P-IT-OBJECT >STACK
	ZERO? STACK /?L24
	PRINTD P-IT-OBJECT
	JUMP ?L25
?L24:	GETB BEG,3 >STACK
	GETB BEG,2 >STACK
	CALL WORD-PRINT,STACK,STACK
?L25:	SET 'FIRST??,0
?L15:	ADD BEG,P-WORDLEN >BEG
	JUMP ?L1

	.FUNCT NAME?,WRD
	EQUAL? WRD,W?FORD,W?ZAPHOD,W?BEEBLE /TRUE
	EQUAL? WRD,W?TRILLI,W?TRICIA,W?MCMILL /TRUE
	EQUAL? WRD,W?PROSSE,W?MARVIN,W?ARTHUR /TRUE
	EQUAL? WRD,W?DENT,W?PREFEC,W?PHIL /TRUE
	EQUAL? WRD,W?EDDIE,W?MARV,W?ED \FALSE
	RTRUE

	.FUNCT CAPITALIZE,PTR
	ZERO? P-OFLAG \?L3
	ZERO? P-MERGED /?L1
?L3:	GET PTR,0 >STACK
	PRINTB STACK
	RTRUE
?L1:	GETB PTR,3 >STACK
	GETB P-INBUF,STACK >STACK
	SUB STACK,32 >STACK
	PRINTC STACK
	GETB PTR,3 >STACK
	INC 'STACK
	GETB PTR,2 >STACK
	DEC 'STACK
	CALL WORD-PRINT,STACK,STACK >STACK
	RSTACK

	.FUNCT PREP-PRINT,PREP,WRD
	ZERO? PREP /FALSE
	PRINTI " "
	EQUAL? PREP,PR?THROUGH \?L5
	PRINTI "through"
	RTRUE
?L5:	CALL PREP-FIND,PREP >WRD
	PRINTB WRD
	RTRUE

	.FUNCT CLAUSE-COPY,SRC,DEST,INSRT=0,BEG,END
	GET P-CCTBL,CC-SBPTR >STACK
	GET SRC,STACK >BEG
	GET P-CCTBL,CC-SEPTR >STACK
	GET SRC,STACK >END
	GET P-OCLAUSE,P-MATCHLEN >STACK
	MUL STACK,P-LEXELEN >STACK
	ADD STACK,2 >STACK
	ADD P-OCLAUSE,STACK >STACK
	GET P-CCTBL,CC-DBPTR >STACK
	PUT DEST,STACK,STACK
?L1:	EQUAL? BEG,END \?L3
	GET P-OCLAUSE,P-MATCHLEN >STACK
	MUL STACK,P-LEXELEN >STACK
	ADD STACK,2 >STACK
	ADD P-OCLAUSE,STACK >STACK
	GET P-CCTBL,CC-DEPTR >STACK
	PUT DEST,STACK,STACK
	RTRUE
?L3:	ZERO? INSRT /?L6
	GET BEG,0 >STACK
	EQUAL? P-ANAM,STACK \?L6
	CALL CLAUSE-ADD,INSRT
?L6:	GET BEG,0 >STACK
	CALL CLAUSE-ADD,STACK
	ADD BEG,P-WORDLEN >BEG
	JUMP ?L1

	.FUNCT CLAUSE-ADD,WRD,PTR
	GET P-OCLAUSE,P-MATCHLEN >STACK
	ADD STACK,2 >PTR
	SUB PTR,1 >STACK
	PUT P-OCLAUSE,STACK,WRD
	PUT P-OCLAUSE,PTR,0
	PUT P-OCLAUSE,P-MATCHLEN,PTR
	RTRUE

	.FUNCT PREP-FIND,PREP,CNT=0,SIZE
	GET PREPOSITIONS,0 >STACK
	MUL STACK,2 >SIZE
?L1:	IGRTR? 'CNT,SIZE /FALSE
	GET PREPOSITIONS,CNT >STACK
	EQUAL? STACK,PREP \?L1
	SUB CNT,1 >STACK
	GET PREPOSITIONS,STACK >STACK
	RSTACK

	.FUNCT SYNTAX-FOUND,SYN
	SET 'P-SYNTAX,SYN
	GETB SYN,P-SACTION >PRSA
	RETURN PRSA

	.FUNCT GWIM,GBIT,LBIT,PREP,OBJ
	EQUAL? GBIT,RLANDBIT \?L1
	RETURN ROOMS
?L1:	SET 'P-GWIMBIT,GBIT
	SET 'P-SLOCBITS,LBIT
	PUT P-MERGE,P-MATCHLEN,0
	CALL GET-OBJECT,P-MERGE,0 >STACK
	ZERO? STACK /?L4
	SET 'P-GWIMBIT,0
	GET P-MERGE,P-MATCHLEN >STACK
	EQUAL? STACK,1 \FALSE
	GET P-MERGE,1 >OBJ
	PRINTI "("
	ZERO? PREP /?L21
	ZERO? P-END-ON-PREP \?L21
	CALL PREP-FIND,PREP >PREP
	PRINTB PREP
	EQUAL? PREP,W?OUT \?L12
	PRINTI " of"
?L12:	FSET? OBJ,NARTICLEBIT /?L17
	PRINTI " the "
	JUMP ?L21
?L17:	PRINTI " "
?L21:	PRINTD OBJ
	PRINTI ")"
	CRLF
	RETURN OBJ
?L4:	SET 'P-GWIMBIT,0
	RFALSE

	.FUNCT SNARF-OBJECTS,PTR
	GET P-ITBL,P-NC1 >PTR
	ZERO? PTR /?L5
	GETB P-SYNTAX,P-SLOC1 >P-SLOCBITS
	GET P-ITBL,P-NC1L >STACK
	CALL SNARFEM,PTR,STACK,P-PRSO >STACK
	ZERO? STACK /FALSE
	GET P-BUTS,P-MATCHLEN >STACK
	ZERO? STACK /?L5
	CALL BUT-MERGE,P-PRSO >P-PRSO
?L5:	GET P-ITBL,P-NC2 >PTR
	ZERO? PTR /TRUE
	GETB P-SYNTAX,P-SLOC2 >P-SLOCBITS
	GET P-ITBL,P-NC2L >STACK
	CALL SNARFEM,PTR,STACK,P-PRSI >STACK
	ZERO? STACK /FALSE
	GET P-BUTS,P-MATCHLEN >STACK
	ZERO? STACK /TRUE
	GET P-PRSI,P-MATCHLEN >STACK
	EQUAL? STACK,1 \?L14
	CALL BUT-MERGE,P-PRSO >P-PRSO
	RTRUE
?L14:	CALL BUT-MERGE,P-PRSI >P-PRSI
	RTRUE

	.FUNCT BUT-MERGE,TBL,LEN,BUTLEN,CNT=1,MATCHES=0,OBJ,NTBL
	GET TBL,P-MATCHLEN >LEN
	PUT P-MERGE,P-MATCHLEN,0
?L1:	DLESS? 'LEN,0 /?L2
	GET TBL,CNT >OBJ
	CALL ZMEMQ,OBJ,P-BUTS >STACK
	ZERO? STACK \?L6
	ADD MATCHES,1 >STACK
	PUT P-MERGE,STACK,OBJ
	INC 'MATCHES
?L6:	INC 'CNT
	JUMP ?L1
?L2:	PUT P-MERGE,P-MATCHLEN,MATCHES
	SET 'NTBL,P-MERGE
	SET 'P-MERGE,TBL
	RETURN NTBL

	.FUNCT SNARFEM,PTR,EPTR,TBL,BUT=0,LEN,WV,WRD,NW,WAS-ALL=0
	SET 'P-AND,0
	EQUAL? P-GETFLAGS,P-ALL \?L1
	SET 'WAS-ALL,1
?L1:	SET 'P-GETFLAGS,0
	SET 'P-CSPTR,PTR
	SET 'P-CEPTR,EPTR
	PUT P-BUTS,P-MATCHLEN,0
	PUT TBL,P-MATCHLEN,0
	GET PTR,0 >WRD
?L4:	EQUAL? PTR,EPTR \?L6
?L55:	ZERO? BUT /?L9
	PUSH BUT
	JUMP ?L8
?L9:	PUSH TBL
?L8:	CALL GET-OBJECT,STACK >WV
	ZERO? WAS-ALL /?L10
	SET 'P-GETFLAGS,P-ALL
?L10:	RETURN WV
?L6:	GET PTR,P-LEXELEN >NW
	EQUAL? WRD,W?ALL,W?BOTH \?L14
	SET 'P-GETFLAGS,P-ALL
	EQUAL? NW,W?OF \?L50
	ADD PTR,P-WORDLEN >PTR
	JUMP ?L50
?L14:	EQUAL? WRD,W?BUT,W?EXCEPT \?L19
	ZERO? BUT /?L23
	PUSH BUT
	JUMP ?L22
?L23:	PUSH TBL
?L22:	CALL GET-OBJECT,STACK >STACK
	ZERO? STACK /FALSE
	SET 'BUT,P-BUTS
	PUT BUT,P-MATCHLEN,0
	JUMP ?L50
?L19:	EQUAL? WRD,W?A,W?ONE \?L24
	ZERO? P-ADJ \?L25
	SET 'P-GETFLAGS,P-ONE
	EQUAL? NW,W?OF \?L50
	ADD PTR,P-WORDLEN >PTR
	JUMP ?L50
?L25:	SET 'P-NAM,P-ONEOBJ
	ZERO? BUT /?L34
	PUSH BUT
	JUMP ?L33
?L34:	PUSH TBL
?L33:	CALL GET-OBJECT,STACK >STACK
	ZERO? STACK /FALSE
	ZERO? NW /TRUE
	JUMP ?L50
?L24:	EQUAL? WRD,W?AND,W?$COMMA \?L37
	EQUAL? NW,W?AND,W?$COMMA /?L37
	SET 'P-AND,1
	ZERO? BUT /?L41
	PUSH BUT
	JUMP ?L40
?L41:	PUSH TBL
?L40:	CALL GET-OBJECT,STACK >STACK
	ZERO? STACK /FALSE
	JUMP ?L50
?L37:	CALL WT?,WRD,PS?BUZZ-WORD >STACK
	ZERO? STACK \?L50
	EQUAL? WRD,W?AND,W?$COMMA /?L50
	EQUAL? WRD,W?OF \?L44
	ZERO? P-GETFLAGS \?L50
	SET 'P-GETFLAGS,P-INHIBIT
	JUMP ?L50
?L44:	CALL WT?,WRD,PS?ADJECTIVE,P1?ADJECTIVE >WV
	ZERO? WV /?L48
	CALL ADJ-CHECK,WRD >STACK
	ZERO? STACK /?L48
	EQUAL? WRD,W?TEA \?L49
	EQUAL? P-NAM,W?CUP /?L48
?L49:	SET 'P-ADJ,WV
	SET 'P-ADJN,WRD
	JUMP ?L50
?L48:	CALL WT?,WRD,PS?OBJECT,P1?OBJECT >STACK
	ZERO? STACK /?L50
	SET 'P-NAM,WRD
	SET 'P-ONEOBJ,WRD
?L50:	EQUAL? PTR,EPTR /?L55
	ADD PTR,P-WORDLEN >PTR
	SET 'WRD,NW
	JUMP ?L4

	.FUNCT ADJ-CHECK,WRD
	ZERO? P-ADJ /TRUE
	EQUAL? WRD,W?INNER,W?OUTER /TRUE
	RFALSE

	.FUNCT GET-OBJECT,TBL,VRB=1,GEN,BITS,LEN,XBITS,TLEN,GCHECK=0,OLEN=0,OBJ
	SET 'XBITS,P-SLOCBITS
	GET TBL,P-MATCHLEN >TLEN
	BTST P-GETFLAGS,P-INHIBIT /TRUE
	ZERO? P-NAM \?L7
	ZERO? P-ADJ /?L4
	CALL WT?,P-ADJN,PS?OBJECT,P1?OBJECT >STACK
	ZERO? STACK /?L4
	SET 'P-NAM,P-ADJN
	SET 'P-ADJ,0
?L4:	ZERO? P-NAM \?L7
	ZERO? P-ADJ \?L7
	EQUAL? P-GETFLAGS,P-ALL /?L71
	ZERO? P-GWIMBIT \?L7
	ZERO? VRB /FALSE
	PRINT NOUN-MISSING
	CRLF
	RFALSE
?L7:	EQUAL? P-GETFLAGS,P-ALL \?L17
?L71:	ZERO? P-SLOCBITS \?L15
?L17:	SET 'P-SLOCBITS,-1
?L15:	SET 'P-TABLE,TBL
?L19:	ZERO? GCHECK /?L21
	CALL GLOBAL-CHECK,TBL
	JUMP ?L23
?L21:	ZERO? LIT /?L24
	FCLEAR PLAYER,TRANSBIT
	CALL DO-SL,HERE,SOG,SIR
	FSET PLAYER,TRANSBIT
?L24:	CALL DO-SL,PLAYER,SH,SC
?L23:	GET TBL,P-MATCHLEN >STACK
	SUB STACK,TLEN >LEN
	BTST P-GETFLAGS,P-ALL /?L69
	BTST P-GETFLAGS,P-ONE \?L29
	ZERO? LEN /?L29
	EQUAL? LEN,1 /?L30
	RANDOM LEN >STACK
	GET TBL,STACK >STACK
	PUT TBL,1,STACK
	PRINTI "(How about the "
	GET TBL,1 >STACK
	PRINTD STACK
	PRINTI "?)"
	CRLF
?L30:	PUT TBL,P-MATCHLEN,1
	JUMP ?L69
?L29:	GRTR? LEN,1 /?L38
	ZERO? LEN \?L69
	EQUAL? P-SLOCBITS,-1 /?L37
?L38:	EQUAL? P-SLOCBITS,-1 \?L39
	SET 'P-SLOCBITS,XBITS
	SET 'OLEN,LEN
	GET TBL,P-MATCHLEN >STACK
	SUB STACK,LEN >STACK
	PUT TBL,P-MATCHLEN,STACK
	JUMP ?L19
?L39:	ZERO? LEN \?L42
	SET 'LEN,OLEN
?L42:	GRTR? LEN,1 \?L45
	EQUAL? PRSA,V?WHAT,V?ASK-ABOUT \?L45
	EQUAL? P-NAM,W?FLUFF,W?DRIVE \?L48
	ZERO? P-ADJ /?L47
?L48:	EQUAL? P-NAM,W?TOOLS,W?TOOL \?L49
	EQUAL? P-ADJN,W?PROPER /?L47
?L49:	EQUAL? P-NAM,W?DRIVE \?L45
	EQUAL? P-ADJN,W?IMPROB \?L45
?L47:	GET TBL,LEN >STACK
	GETP STACK,P?GENERIC >GEN
	ADD TLEN,1 >LEN
	PUT TBL,P-MATCHLEN,LEN
	PUT TBL,LEN,GEN
	SET 'P-XNAM,P-NAM
	SET 'P-XADJ,P-ADJ
	SET 'P-XADJN,P-ADJN
	SET 'P-NAM,0
	SET 'P-ADJ,0
	SET 'P-ADJN,0
	RTRUE
?L45:	ZERO? VRB /?L55
	EQUAL? WINNER,PROTAGONIST /?L50
	CALL CANT-ORPHAN
	SET 'P-NAM,0
	SET 'P-ADJ,0
	RFALSE
?L50:	ZERO? VRB /?L55
	ZERO? P-NAM /?L51
	CALL WHICH-PRINT,TLEN,LEN,TBL
	EQUAL? TBL,P-PRSO \?L52
	SET 'P-ACLAUSE,P-NC1
	JUMP ?L54
?L52:	SET 'P-ACLAUSE,P-NC2
?L54:	SET 'P-AADJ,P-ADJ
	SET 'P-ANAM,P-NAM
	CALL ORPHAN,0,0
	SET 'P-OFLAG,1
	JUMP ?L55
?L51:	ZERO? VRB /?L55
	PRINT NOUN-MISSING
	CRLF
?L55:	SET 'P-NAM,0
	SET 'P-ADJ,0
	RFALSE
?L37:	ZERO? LEN \?L69
	ZERO? GCHECK /?L59
	ZERO? VRB /?L65
	SET 'P-SLOCBITS,XBITS
	ZERO? LIT \?L64
	EQUAL? PRSA,V?TELL /?L64
	EQUAL? PRSA,V?WHERE,V?WHAT,V?WHO \?L62
?L64:	CALL OBJ-FOUND,NOT-HERE-OBJECT,TBL
	SET 'P-XNAM,P-NAM
	SET 'P-XADJ,P-ADJ
	SET 'P-XADJN,P-ADJN
	SET 'P-NAM,0
	SET 'P-ADJ,0
	SET 'P-ADJN,0
	RTRUE
?L62:	PRINT TOO-DARK
	CRLF
?L65:	SET 'P-NAM,0
	SET 'P-ADJ,0
	RFALSE
?L59:	ZERO? LEN \?L69
	SET 'GCHECK,1
	JUMP ?L19
?L69:	SET 'P-SLOCBITS,XBITS
	SET 'P-NAM,0
	SET 'P-ADJ,0
	RTRUE

	.FUNCT MOBY-FIND,TBL,FOO,LEN
	SET 'P-MOBY-FLAG,1
	SET 'P-SLOCBITS,-1
	SET 'P-TABLE,TBL
	SET 'P-NAM,P-XNAM
	SET 'P-ADJ,P-XADJ
	PUT TBL,P-MATCHLEN,0
	FIRST? ROOMS >FOO \?L3
?L4:	CALL SEARCH-LIST,FOO,TBL,P-SRCALL
	NEXT? FOO >FOO /?L4
?L3:	CALL DO-SL,LOCAL-GLOBALS,1,1
	CALL SEARCH-LIST,ROOMS,TBL,P-SRCTOP
	GET TBL,P-MATCHLEN >LEN
	EQUAL? LEN,1 \?L8
	GET TBL,1 >P-MOBY-FOUND
?L8:	SET 'P-MOBY-FLAG,0
	SET 'P-NAM,0
	SET 'P-ADJ,0
	RETURN LEN

	.FUNCT WHICH-PRINT,TLEN,LEN,TBL,OBJ,RLEN
	SET 'RLEN,LEN
	PRINTI "Which"
	ZERO? P-OFLAG \?L5
	ZERO? P-MERGED \?L5
	ZERO? P-AND /?L3
?L5:	PRINTI " "
	PRINTB P-NAM
	JUMP ?L9
?L3:	EQUAL? TBL,P-PRSO \?L8
	CALL CLAUSE-PRINT,P-NC1,P-NC1L,0
	JUMP ?L9
?L8:	CALL CLAUSE-PRINT,P-NC2,P-NC2L,0
?L9:	PRINTI " do you mean, "
?L12:	INC 'TLEN
	GET TBL,TLEN >OBJ
	FSET? OBJ,NARTICLEBIT /?L14
	PRINTI "the "
?L14:	PRINTD OBJ
	EQUAL? LEN,2 \?L21
	EQUAL? RLEN,2 /?L23
	PRINTI ","
?L23:	PRINTI " or "
	JUMP ?L30
?L21:	GRTR? LEN,2 \?L30
	PRINTI ", "
?L30:	DLESS? 'LEN,1 \?L12
	PRINTR "?"

	.FUNCT GLOBAL-CHECK,TBL,LEN,RMG,RMGL,CNT=0,OBJ,OBITS,FOO
	GET TBL,P-MATCHLEN >LEN
	SET 'OBITS,P-SLOCBITS
	GETPT HERE,P?GLOBAL >RMG
	ZERO? RMG /?L4
	PTSIZE RMG >STACK
	SUB STACK,1 >RMGL
?L3:	GETB RMG,CNT >OBJ
	CALL THIS-IT?,OBJ,TBL >STACK
	ZERO? STACK /?L5
	CALL OBJ-FOUND,OBJ,TBL
?L5:	IGRTR? 'CNT,RMGL \?L3
?L4:	GETPT HERE,P?PSEUDO >RMG
	ZERO? RMG /?L15
	PTSIZE RMG >STACK
	DIV STACK,4 >STACK
	SUB STACK,1 >RMGL
	SET 'CNT,0
?L14:	MUL CNT,2 >STACK
	GET RMG,STACK >STACK
	EQUAL? P-NAM,STACK \?L16
	SET 'LAST-PSEUDO-LOC,HERE
	MUL CNT,2 >STACK
	INC 'STACK
	GET RMG,STACK >STACK
	PUTP PSEUDO-OBJECT,P?ACTION,STACK
	GETPT PSEUDO-OBJECT,P?ACTION >STACK
	SUB STACK,5 >FOO
	GET P-NAM,0 >STACK
	PUT FOO,0,STACK
	GET P-NAM,1 >STACK
	PUT FOO,1,STACK
	CALL OBJ-FOUND,PSEUDO-OBJECT,TBL
	JUMP ?L15
?L16:	IGRTR? 'CNT,RMGL \?L14
?L15:	GET TBL,P-MATCHLEN >STACK
	EQUAL? STACK,LEN \FALSE
	SET 'P-SLOCBITS,-1
	SET 'P-TABLE,TBL
	CALL DO-SL,GLOBAL-OBJECTS,1,1
	SET 'P-SLOCBITS,OBITS
	RETURN P-SLOCBITS

	.FUNCT DO-SL,OBJ,BIT1,BIT2,BTS
	ADD BIT1,BIT2 >STACK
	BTST P-SLOCBITS,STACK \?L1
	CALL SEARCH-LIST,OBJ,P-TABLE,P-SRCALL >STACK
	RSTACK
?L1:	BTST P-SLOCBITS,BIT1 \?L4
	CALL SEARCH-LIST,OBJ,P-TABLE,P-SRCTOP >STACK
	RSTACK
?L4:	BTST P-SLOCBITS,BIT2 \TRUE
	CALL SEARCH-LIST,OBJ,P-TABLE,P-SRCBOT >STACK
	RSTACK

	.FUNCT SEARCH-LIST,OBJ,TBL,LVL,FLS,NOBJ
	FIRST? OBJ >OBJ \FALSE
?L3:	EQUAL? LVL,P-SRCBOT /?L5
	GETPT OBJ,P?SYNONYM >STACK
	ZERO? STACK /?L5
	CALL THIS-IT?,OBJ,TBL >STACK
	ZERO? STACK /?L5
	CALL OBJ-FOUND,OBJ,TBL
?L5:	EQUAL? LVL,P-SRCTOP \?L10
	FSET? OBJ,SEARCHBIT /?L10
	FSET? OBJ,SURFACEBIT \?L11
?L10:	FIRST? OBJ >NOBJ \?L11
	FSET? OBJ,OPENBIT /?L13
	FSET? OBJ,TRANSBIT /?L13
	ZERO? P-MOBY-FLAG /?L11
?L13:	FSET? OBJ,SURFACEBIT \?L14
	PUSH P-SRCALL
	JUMP ?L17
?L14:	FSET? OBJ,SEARCHBIT \?L16
	PUSH P-SRCALL
	JUMP ?L17
?L16:	PUSH P-SRCTOP
?L17:	CALL SEARCH-LIST,OBJ,TBL,STACK >FLS
?L11:	NEXT? OBJ >OBJ /?L3
	RTRUE

	.FUNCT OBJ-FOUND,OBJ,TBL,PTR
	GET TBL,P-MATCHLEN >PTR
	ADD PTR,1 >STACK
	PUT TBL,STACK,OBJ
	ADD PTR,1 >STACK
	PUT TBL,P-MATCHLEN,STACK
	RTRUE

	.FUNCT TAKE-CHECK
	GETB P-SYNTAX,P-SLOC1 >STACK
	CALL ITAKE-CHECK,P-PRSO,STACK >STACK
	ZERO? STACK /FALSE
	GETB P-SYNTAX,P-SLOC2 >STACK
	CALL ITAKE-CHECK,P-PRSI,STACK >STACK
	RSTACK

	.FUNCT ITAKE-CHECK,TBL,IBITS,PTR,OBJ,TAKEN
	GET TBL,P-MATCHLEN >PTR
	ZERO? PTR /TRUE
	BTST IBITS,SHAVE /?L3
	BTST IBITS,STAKE \TRUE
?L3:	DLESS? 'PTR,0 /TRUE
	ADD PTR,1 >STACK
	GET TBL,STACK >OBJ
	EQUAL? OBJ,IT \?L15
	CALL ACCESSIBLE?,P-IT-OBJECT >STACK
	ZERO? STACK \?L11
	PRINT REFERRING
	CRLF
	RFALSE
?L11:	SET 'OBJ,P-IT-OBJECT
?L15:	CALL HELD?,OBJ >STACK
	ZERO? STACK \?L3
	EQUAL? OBJ,HANDS,SLEEVES,SPEECH /?L3
	EQUAL? OBJ,NO-TEA \?L20
	ZERO? HOLDING-NO-TEA \?L3
?L20:	EQUAL? OBJ,GUARANTEE \?L17
	EQUAL? PRSA,V?SHOW /?L3
?L17:	SET 'PRSO,OBJ
	FSET? OBJ,TRYTAKEBIT \?L22
	SET 'TAKEN,1
	JUMP ?L26
?L22:	EQUAL? WINNER,PROTAGONIST /?L24
	SET 'TAKEN,0
	JUMP ?L26
?L24:	BTST IBITS,STAKE \?L25
	CALL ITAKE,0 >STACK
	EQUAL? STACK,1 \?L25
	SET 'TAKEN,0
	JUMP ?L26
?L25:	SET 'TAKEN,1
?L26:	ZERO? TAKEN /?L55
	BTST IBITS,SHAVE \?L27
	GET TBL,P-MATCHLEN >STACK
	LESS? 1,STACK \?L29
	PRINT NOT-HOLDING
	PRINTI " all those things!"
	CRLF
	RFALSE
?L29:	EQUAL? OBJ,NOT-HERE-OBJECT \?L33
	PRINTI "You can't see that here!"
	CRLF
	RFALSE
?L33:	EQUAL? WINNER,PROTAGONIST \?L37
	PRINT NOT-HOLDING
	JUMP ?L41
?L37:	PRINTI "It doesn't look like"
	CALL ARTICLE,WINNER,1
	PRINTI " is holding"
?L41:	CALL ARTICLE,OBJ,1
	SET 'P-IT-OBJECT,OBJ
	PRINTI "."
	CRLF
	RFALSE
?L27:	ZERO? TAKEN \?L3
?L55:	EQUAL? WINNER,PROTAGONIST \?L3
	PRINTI "(Taking"
	CALL ARTICLE,OBJ,1
	PRINTI " first)"
	CRLF
	JUMP ?L3

	.FUNCT MANY-CHECK,LOSS=0,TMP
	GET P-PRSO,P-MATCHLEN >STACK
	GRTR? STACK,1 \?L1
	GETB P-SYNTAX,P-SLOC1 >STACK
	BTST STACK,SMANY /?L1
	SET 'LOSS,1
	JUMP ?L3
?L1:	GET P-PRSI,P-MATCHLEN >STACK
	GRTR? STACK,1 \?L3
	GETB P-SYNTAX,P-SLOC2 >STACK
	BTST STACK,SMANY /?L3
	SET 'LOSS,2
?L3:	ZERO? LOSS /TRUE
	PRINTI "You can't use multiple "
	EQUAL? LOSS,2 \?L9
	PRINTI "in"
?L9:	PRINTI "direct objects with """
	GET P-ITBL,P-VERBN >TMP
	ZERO? TMP \?L16
	PRINTI "tell"
	JUMP ?L22
?L16:	ZERO? P-OFLAG \?L21
	ZERO? P-MERGED /?L20
?L21:	GET TMP,0 >STACK
	PRINTB STACK
	JUMP ?L22
?L20:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
?L22:	PRINTI """."
	CRLF
	RFALSE

	.FUNCT ZMEMQ,ITM,TBL,SIZE=-1,CNT=1
	ZERO? TBL /FALSE
	LESS? SIZE,0 /?L4
	SET 'CNT,0
	JUMP ?L6
?L4:	GET TBL,0 >SIZE
?L6:	GET TBL,CNT >STACK
	EQUAL? ITM,STACK /TRUE
	IGRTR? 'CNT,SIZE \?L6
	RFALSE

	.FUNCT ZMEMQB,ITM,TBL,SIZE,CNT=0
?L1:	GETB TBL,CNT >STACK
	EQUAL? ITM,STACK /TRUE
	IGRTR? 'CNT,SIZE \?L1
	RFALSE

	.FUNCT LIT?,RM,RMBIT=1,OHERE,LIT?1=0
	SET 'P-GWIMBIT,ONBIT
	SET 'OHERE,HERE
	SET 'HERE,RM
	ZERO? RMBIT /?L1
	FSET? RM,ONBIT \?L1
	SET 'LIT?1,1
	JUMP ?L10
?L1:	PUT P-MERGE,P-MATCHLEN,0
	SET 'P-TABLE,P-MERGE
	SET 'P-SLOCBITS,-1
	EQUAL? OHERE,RM \?L6
	CALL DO-SL,WINNER,1,1
	EQUAL? WINNER,PLAYER /?L6
	IN? PLAYER,RM \?L6
	CALL DO-SL,PLAYER,1,1
?L6:	CALL DO-SL,RM,1,1
	GET P-TABLE,P-MATCHLEN >STACK
	GRTR? STACK,0 \?L10
	SET 'LIT?1,1
?L10:	SET 'HERE,OHERE
	SET 'P-GWIMBIT,0
	RETURN LIT?1

	.FUNCT PRSO-PRINT,PTR
	ZERO? P-MERGED \?L3
	GET P-ITBL,P-NC1 >PTR
	GET PTR,0 >STACK
	EQUAL? STACK,W?IT \?L1
?L3:	PRINTI " "
	PRINTD PRSO
	RTRUE
?L1:	GET P-ITBL,P-NC1L >STACK
	CALL BUFFER-PRINT,PTR,STACK,0 >STACK
	RSTACK

	.FUNCT PRSI-PRINT,PTR
	ZERO? P-MERGED \?L3
	GET P-ITBL,P-NC2 >PTR
	GET PTR,0 >STACK
	EQUAL? STACK,W?IT \?L1
?L3:	PRINTI " "
	PRINTD PRSO
	RTRUE
?L1:	GET P-ITBL,P-NC2L >STACK
	CALL BUFFER-PRINT,PTR,STACK,0 >STACK
	RSTACK

	.FUNCT THIS-IT?,OBJ,TBL,SYNS
	FSET? OBJ,INVISIBLE /FALSE
	ZERO? P-NAM /?L3
	GETPT OBJ,P?SYNONYM >SYNS
	PTSIZE SYNS >STACK
	DIV STACK,2 >STACK
	DEC 'STACK
	CALL ZMEMQ,P-NAM,SYNS,STACK >STACK
	ZERO? STACK /FALSE
?L3:	ZERO? P-ADJ /?L4
	GETPT OBJ,P?ADJECTIVE >SYNS
	ZERO? SYNS /FALSE
	PTSIZE SYNS >STACK
	DEC 'STACK
	CALL ZMEMQB,P-ADJ,SYNS,STACK >STACK
	ZERO? STACK /FALSE
?L4:	ZERO? P-GWIMBIT /TRUE
	FSET? OBJ,P-GWIMBIT /TRUE
	RFALSE

	.FUNCT NOT-HERE-OBJECT-F,TBL,PRSO?=1,OBJ,X=0
	EQUAL? PRSO,NOT-HERE-OBJECT \?L5
	EQUAL? PRSI,NOT-HERE-OBJECT \?L1
	PRINTR "Those things aren't here!"
?L1:	EQUAL? PRSO,NOT-HERE-OBJECT \?L5
	SET 'TBL,P-PRSO
	JUMP ?L6
?L5:	SET 'TBL,P-PRSI
	SET 'PRSO?,0
?L6:	ZERO? PRSO? /?L7
	EQUAL? PRSA,V?FIND,V?FOLLOW,V?CALL /?L11
	EQUAL? PRSA,V?WHAT,V?WHERE,V?WHO /?L11
	EQUAL? PRSA,V?WAIT-FOR,V?WALK-TO,V?WHAT-ABOUT /?L11
	EQUAL? PRSA,V?I-AM,V?CARVE,V?CALL-WITH \?L28
?L11:	SET 'X,1
	CALL FIND-NOT-HERE,TBL,PRSO? >OBJ
	ZERO? OBJ /FALSE
	EQUAL? OBJ,NOT-HERE-OBJECT /?L28
	RTRUE
?L7:	EQUAL? PRSA,V?ASK-ABOUT,V?ASK-FOR,V?TELL-ABOUT /?L22
	EQUAL? PRSA,V?MY-NAME \?L28
?L22:	SET 'X,1
	CALL FIND-NOT-HERE,TBL,PRSO? >OBJ
	ZERO? OBJ /FALSE
	EQUAL? OBJ,NOT-HERE-OBJECT \TRUE
?L28:	ZERO? X /?L30
	PRINTI "You'll have to be more specific, I'm afraid."
	CRLF
	JUMP ?L54
?L30:	EQUAL? WINNER,PROTAGONIST \?L34
	PRINTI "You can't "
	EQUAL? P-XNAM,W?POEM,W?POETRY,W?CONVER \?L37
	PRINTI "hear"
	JUMP ?L41
?L37:	PRINTI "see"
?L41:	CALL NAME?,P-XNAM >STACK
	ZERO? STACK \?L44
	PRINTI " any"
?L44:	CALL NOT-HERE-PRINT,PRSO?
	PRINTI " here!"
	CRLF
	JUMP ?L54
?L34:	EQUAL? WINNER,FORD \?L53
	ZERO? FORD-SLEEPING \FALSE
?L53:	EQUAL? WINNER,BEAST \?L51
	FSET? BEAST,MUNGEDBIT /FALSE
?L51:	PRINTI "Looking confused,"
	CALL ARTICLE,WINNER,1
	PRINTI " says, ""I don't see"
	CALL NAME?,P-XNAM >STACK
	ZERO? STACK \?L59
	PRINTI " any"
?L59:	CALL NOT-HERE-PRINT,PRSO?
	PRINTI " here!"""
	CRLF
?L54:	CALL FUCKING-CLEAR >STACK
	RSTACK

	.FUNCT FIND-NOT-HERE,TBL,PRSO?,M-F,OBJ
	CALL MOBY-FIND,TBL >M-F
	EQUAL? 1,M-F \?L1
	ZERO? PRSO? /?L3
	SET 'PRSO,P-MOBY-FOUND
	RFALSE
?L3:	SET 'PRSI,P-MOBY-FOUND
	RFALSE
?L1:	EQUAL? P-XNAM,W?FLUFF \?L6
	ZERO? PRSO? /?L7
	SET 'PRSO,POCKET-FLUFF
	RFALSE
?L7:	SET 'PRSI,POCKET-FLUFF
	RFALSE
?L6:	EQUAL? P-XNAM,W?TOOL,W?TOOLS \?L10
	ZERO? PRSO? /?L11
	SET 'PRSO,TWEEZERS
	RFALSE
?L11:	SET 'PRSI,TWEEZERS
	RFALSE
?L10:	RETURN NOT-HERE-OBJECT

	.FUNCT NOT-HERE-PRINT,PRSO?
	ZERO? P-OFLAG /?L1
	ZERO? P-XADJ /?L3
	PRINTI " "
	PRINTB P-XADJN
?L3:	ZERO? P-XNAM /FALSE
	PRINTI " "
	PRINTB P-XNAM
	RTRUE
?L1:	ZERO? PRSO? /?L13
	GET P-ITBL,P-NC1L >STACK
	GET P-ITBL,P-NC1 >STACK
	CALL BUFFER-PRINT,STACK,STACK,0 >STACK
	RSTACK
?L13:	GET P-ITBL,P-NC2L >STACK
	GET P-ITBL,P-NC2 >STACK
	CALL BUFFER-PRINT,STACK,STACK,0 >STACK
	RSTACK

	.FUNCT LIGHT-F
	IN? FLEET,HERE /?L3
	EQUAL? HERE,AIRLOCK,INSIDE-WHALE \?L1
?L3:	CALL VISIBLE?,THUMB >STACK
	ZERO? STACK /?L1
	EQUAL? LIGHT,PRSI \?L4
	CALL PERFORM,PRSA,PRSO,THUMB
	RTRUE
?L4:	CALL PERFORM,PRSA,THUMB,PRSI
	RTRUE
?L1:	EQUAL? HERE,GALLEY \?L7
	CALL UNIMPORTANT-THING-F >STACK
	RSTACK
?L7:	EQUAL? LIGHT,PRSO \?L8
	EQUAL? PRSA,V?WHAT,V?FOLLOW,V?FIND /FALSE
	EQUAL? PRSA,V?WHAT-ABOUT,V?WALK-TO,V?WHERE /FALSE
?L8:	EQUAL? LIGHT,PRSI \?L10
	EQUAL? PRSA,V?TELL-ABOUT,V?ASK-ABOUT /FALSE
?L10:	EQUAL? HERE,BEDROOM /?L11
	CALL CANT-SEE,LIGHT >STACK
	RSTACK
?L11:	EQUAL? PRSA,V?LAMP-ON \?L12
	FSET? HERE,ONBIT \?L13
	PRINTR "It is."
?L13:	SET 'LIT,1
	FSET HERE,ONBIT
	FSET DARK-OBJECT,DARKBIT
	MOVE DARK-OBJECT,DARK
	PRINTI "Good start to the day. Pity it's going to be the worst one of your life. The light is now on."
	CRLF
	CRLF
	CALL V-LOOK >STACK
	RSTACK
?L12:	EQUAL? PRSA,V?LAMP-OFF \FALSE
	CALL V-DIG >STACK
	RSTACK

	.FUNCT GLOBAL-SLEEP-F
	EQUAL? PRSA,V?TAKE,V?WALK-TO \FALSE
	CALL PERFORM,V?SLEEP
	RTRUE

	.FUNCT SPEECH-F
	EQUAL? PRSA,V?MAKE,V?GIVE \?L1
	PRINTI "This isn't the time"
	EQUAL? HERE,DAIS /?L5
	PRINTI " or the place"
?L5:	PRINTR " for making speeches."
?L1:	EQUAL? PRSA,V?READ \FALSE
	PRINTR "It's extemporaneous."

	.FUNCT GROUND-F
	EQUAL? PRSA,V?THROUGH \?L1
	EQUAL? HERE,ACCESS-SPACE \?L1
	PRINTR "The mesh is too fine."
?L1:	EQUAL? PRSA,V?CLIMB-FOO,V?CLIMB-ON,V?CLIMB-UP /?L6
	EQUAL? PRSA,V?BOARD \?L5
?L6:	CALL V-DIG >STACK
	RSTACK
?L5:	EQUAL? PRSA,V?LOOK-UNDER \?L7
	CALL V-COUNT >STACK
	RSTACK
?L7:	EQUAL? PRSA,V?LEAVE \?L8
	CALL DO-WALK,P?UP >STACK
	RSTACK
?L8:	EQUAL? PRSA,V?LIE-DOWN \?L9
	IN? PROTAGONIST,BED \?L10
	CALL OUT-OF-FIRST,BED >STACK
	RSTACK
?L10:	ZERO? LYING-DOWN /?L12
	PRINT YOU-ARE
	CRLF
	RTRUE
?L12:	EQUAL? HERE,FRONT-OF-HOUSE \?L15
	CALL PERFORM,V?BLOCK,BULLDOZER
	SET 'P-IT-OBJECT,GROUND
	RTRUE
?L15:	SET 'LYING-DOWN,1
	PRINTR "You are now lying on the ground."
?L9:	EQUAL? PRSA,V?EXAMINE \?L19
	EQUAL? HERE,GUTS-ROOM \?L20
	PRINTR "The walls, floor, and ceiling are covered with little pieces of flesh and bone."
?L20:	EQUAL? HERE,ACCESS-SPACE \FALSE
	PRINTR "The floor is an open metal mesh, like the floor of a catwalk."
?L19:	EQUAL? PRSA,V?LOOK-INSIDE \?L28
	EQUAL? HERE,ACCESS-SPACE \?L28
	CALL PERFORM,V?LOOK-INSIDE,FISH-HOLE
	SET 'P-IT-OBJECT,GROUND
	RTRUE
?L28:	EQUAL? PRSA,V?ENJOY \FALSE
	EQUAL? HERE,FRONT-OF-HOUSE \FALSE
	ZERO? LYING-DOWN /FALSE
	PRINTR "It occurs to you that you've never deliberately lain in any mud before and that it's actually a pleasant sort of squishy sensation. You let the mud ooze between your toes. You may be here for some time, so you may as well make the most of it."

	.FUNCT WALLS-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	EQUAL? HERE,GUTS-ROOM \FALSE
	CALL PERFORM,V?EXAMINE,GROUND
	RTRUE

	.FUNCT CEILING-F
	EQUAL? PRSA,V?LOOK-UNDER \?L1
	CALL PERFORM,V?LOOK
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	EQUAL? HERE,GUTS-ROOM \FALSE
	CALL PERFORM,V?EXAMINE,GROUND
	RTRUE

	.FUNCT WINDOW-F
	ZERO? LIT \?L1
	PRINT TOO-DARK
	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?MUNG \?L5
	CALL PRINT-ID,STR?65
	CALL PERFORM,V?KILL,WINDOW
	RTRUE
?L5:	EQUAL? HERE,BEDROOM \?L6
	EQUAL? PRSA,V?EXAMINE,V?LOOK-INSIDE \?L7
	CALL PERFORM,V?OPEN,CURTAINS
	RTRUE
?L7:	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	PRINTR "The bloody thing's been jammed shut for months, now."
?L6:	EQUAL? PRSA,V?LOOK-INSIDE \?L13
	PRINTR "You see the country lane."
?L13:	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	PRINT BUDGE
	CRLF
	RTRUE

	.FUNCT STAIRS-F
	EQUAL? PRSA,V?CLIMB-FOO,V?CLIMB-UP \?L1
	CALL DO-WALK,P?UP >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?CLIMB-DOWN \FALSE
	CALL DO-WALK,P?DOWN >STACK
	RSTACK

	.FUNCT SKY-F
	FSET? HERE,OUTSIDEBIT /?L1
	CALL CANT-SEE,SKY >STACK
	RSTACK
?L1:	IN? FLEET,HERE \FALSE
	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "The sky is filled with the ships of the "
	PRINTD FLEET
	PRINTR "."

	.FUNCT STAR-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	EQUAL? HERE,WAR-CHAMBER \?L3
	PRINTI "The approaching star is a small, unregarded yellow sun, with nine planets of varying sizes. The "
	PRINTD THIRD-PLANET
	PRINTR " catches your attention."
?L3:	EQUAL? HERE,DAIS,SPEEDBOAT \?L7
	PRINTR "The sun is a smallish orange star."
?L7:	EQUAL? HERE,FRONT-OF-HOUSE,COUNTRY-LANE,BACK-OF-HOUSE \?L10
	PRINTR "The sun is a smallish yellow star."
?L10:	CALL CANT-SEE,STAR >STACK
	RSTACK

	.FUNCT HANDS-F,ACTOR
	EQUAL? PRSA,V?WAVE \?L1
	SET 'PRSO,0
	CALL PERFORM,V?WAVE-AT
	RTRUE
?L1:	EQUAL? PRSA,V?SHAKE \FALSE
	CALL FIND-IN,HERE,ACTORBIT >ACTOR
	ZERO? ACTOR /?L4
	CALL PERFORM,V?THANK,ACTOR
	RTRUE
?L4:	PRINTR "Pleased to meet you."

	.FUNCT EYES-F
	EQUAL? PRSA,V?OPEN \?L1
	PRINTR "They are."
?L1:	EQUAL? PRSA,V?CLOSE \FALSE
	IN? BEAST,HERE \?L6
	PRINTI "The Beast doesn't notice."
	PRINT GETTING-CLOSE
	CRLF
	RTRUE
?L6:	PRINTR "That won't help."

	.FUNCT PROTAGONIST-F
	EQUAL? PRSO,NO-TEA \FALSE
	ZERO? PRSI /FALSE
	CALL NO-TEA-F >STACK
	RSTACK

	.FUNCT ME-F,OLIT
	EQUAL? PRSA,V?TELL \?L1
	PRINTI "Talking to yourself is a sign of impending mental collapse."
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?LISTEN \?L5
	PRINTR "Yes?"
?L5:	EQUAL? PRSA,V?ALARM \?L8
	PRINT YOU-ARE
	CRLF
	RTRUE
?L8:	EQUAL? PRSA,V?GIVE \?L11
	EQUAL? PRSI,ME \?L11
	IN? PRSO,PROTAGONIST \?L12
	EQUAL? PRSO,BABEL-FISH,NO-TEA /?L12
	CALL PRE-TAKE >STACK
	RSTACK
?L12:	CALL PERFORM,V?TAKE,PRSO
	RTRUE
?L11:	EQUAL? PRSA,V?MOVE \?L15
	CALL V-WALK-AROUND >STACK
	RSTACK
?L15:	EQUAL? PRSA,V?SEARCH \?L16
	CALL V-INVENTORY
	RTRUE
?L16:	EQUAL? PRSA,V?MUNG,V?KILL /?L18
	EQUAL? PRSA,V?SHOOT \?L17
	EQUAL? PRSI,BLASTER \?L17
?L18:	CALL PRINT-ID,STR?66
	CALL JIGS-UP,STR?67
	RTRUE
?L17:	EQUAL? PRSA,V?FIND \?L19
	PRINTR "You're right here!"
?L19:	EQUAL? PRSA,V?WHO \?L22
	PRINTI "You are "
	PRINTD IDENTITY-FLAG
	PRINTR "."
?L22:	EQUAL? PRSA,V?EXAMINE \?L25
	EQUAL? HERE,MAZE \?L25
	PRINTR "You look perfectly normal (except that you're two microns tall)."
?L25:	EQUAL? PRSA,V?PULL-TOGETHER \?L28
	PRINT ZEN
	CRLF
	RTRUE
?L28:	EQUAL? PRSA,V?FOLLOW \FALSE
	PRINTR "I'd like to, but like most computers I don't have legs."

	.FUNCT GLOBAL-ROOM-F
	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE,V?LOOK \?L1
	CALL V-LOOK
	RTRUE
?L1:	EQUAL? PRSA,V?WALK-TO,V?THROUGH \?L3
	CALL V-WALK-AROUND >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?EXIT,V?LEAVE \?L4
	CALL DO-WALK,P?OUT >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?WALK-AROUND \?L5
	EQUAL? HERE,CAPTAINS-QUARTERS \?L6
	CALL V-STAND >STACK
	RSTACK
?L6:	PRINTR "Walking around the room reveals nothing new. To move elsewhere, just type the desired direction."
?L5:	EQUAL? PRSA,V?LAMP-ON \FALSE
	CALL PERFORM,V?LAMP-ON,LIGHT
	RTRUE

	.FUNCT OBJECT-OF-GAME-F
	EQUAL? PRSA,V?WHAT \FALSE
	PRINTR "That's for me to know and you to find out."

	.FUNCT CONTROLS-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	EQUAL? HERE,SPEEDBOAT \?L3
	PRINTI "The only control, other than those related to steering the boat, is the large red "
	PRINTD AUTOPILOT-BUTTON
	PRINTI "."
	CALL FINE-PRODUCT
	CRLF
	RTRUE
?L3:	EQUAL? HERE,BRIDGE \FALSE
	PRINTI "Most of the controls are beyond your comprehension. "
	IN? LARGE-RECEPTACLE,HERE \?L10
	PRINTI "The simplest one is a "
	PRINTD LARGE-RECEPTACLE
	PRINTI " of some kind."
	ZERO? DRIVE-TO-CONTROLS /?L14
	PRINTI " "
	CALL PERFORM,V?EXAMINE,LARGE-RECEPTACLE
	RTRUE
?L14:	CRLF
	RTRUE
?L10:	PRINTR "A fused spot shows where a receptacle once was."

	.FUNCT CONVERSATION-F
	EQUAL? PRSA,V?LISTEN \FALSE
	EQUAL? HERE,FRONT-OF-HOUSE \?L3
	PRINTR "You can't hear anything from here."
?L3:	CALL PERFORM,V?LISTEN,VLHURG
	RTRUE

	.FUNCT GUARDS-F
	EQUAL? GUARDS,WINNER \?L1
	EQUAL? PRSA,V?TELL-ABOUT \?L3
	EQUAL? PRSO,ME \?L3
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,GUARDS,PRSI
	SET 'WINNER,GUARDS
	RTRUE
?L3:	EQUAL? PRSA,V?HELLO \?L5
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,GUARDS
	SET 'WINNER,GUARDS
	RTRUE
?L5:	EQUAL? HERE,DAIS \?L6
	IN? RIFLES,GUARDS \?L7
	EQUAL? PRSA,V?SHOOT \?L10
	ZERO? DONT-FLAG \?L9
?L10:	IN? RIFLES,GUARDS \?L7
	EQUAL? PRSA,V?DROP \?L7
	EQUAL? PRSO,RIFLES \?L7
?L9:	FCLEAR RIFLES,NDESCBIT
	CALL QUEUE,I-GUARDS,8 >STACK
	PUT STACK,0,1
	MOVE RIFLES,HERE
	FSET RIFLES,TAKEBIT
	FSET RIFLES,TRYTAKEBIT
	PRINTI "The guards hesitate, then toss their "
	PRINTD RIFLES
	PRINTR "s into a pile in front of you."
?L7:	EQUAL? PRSA,V?SHOOT \?L13
	IN? RIFLES,GUARDS \?L14
	CALL PRINT-ID,STR?68
	CALL JIGS-UP,STR?69 >STACK
	RSTACK
?L14:	PRINTR "Someone around here is being very stupid. Let's say it's the guards, since they're only fictitious characters and therefore not potential Infocom customers. The poor fictitious saps don't understand how they can shoot without rifles."
?L13:	EQUAL? PRSA,V?TAKE \?L19
	EQUAL? PRSO,RIFLES \?L19
	IN? RIFLES,GUARDS \?L20
	PRINTR """We already have them!"""
?L20:	MOVE RIFLES,GUARDS
	CALL QUEUE,I-GUARDS,5 >STACK
	PUT STACK,0,1
	PRINTR "They do so."
?L19:	EQUAL? PRSA,V?LEAVE \?L27
	PRINTR """We can't leave while you're in trouble, Mr. President!"""
?L27:	PRINTI "You have failed to issue one of the small set of commands that the guards' military intelligences are trained to understand."
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L6:	CALL HELD?,BABEL-FISH,PROTAGONIST >STACK
	ZERO? STACK /?L34
	PRINTI """Resistance is useless!"""
	CRLF
	JUMP ?L38
?L34:	PRINTI """I"
	CALL PRODUCE-GIBBERISH,1
	CRLF
?L38:	CALL FUCKING-CLEAR >STACK
	RSTACK
?L1:	EQUAL? HERE,CAPTAINS-QUARTERS \?L42
	EQUAL? PRSA,V?THANK,V?HELLO,V?TELL \?L41
	CALL PERFORM,V?TELL,VOGON-CAPTAIN
	RTRUE
?L41:	EQUAL? HERE,CAPTAINS-QUARTERS \?L42
	EQUAL? PRSA,V?ASK-FOR,V?ASK-ABOUT \?L42
	EQUAL? GUARDS,PRSO \?L42
	CALL PERFORM,V?TELL,VOGON-CAPTAIN
	RTRUE
?L42:	EQUAL? PRSA,V?EXAMINE \?L43
	IN? RIFLES,GUARDS \?L43
	PRINTI "They're holding "
	PRINTD RIFLES
	PRINTR "s."
?L43:	EQUAL? HERE,DAIS \?L46
	EQUAL? PRSA,V?SHOOT \?L46
	CALL BLASTER-HOLD >STACK
	ZERO? STACK \TRUE
	PRINT GUARDS-REALIZE
	CALL PRINT-ID,STR?70
	CALL JIGS-UP,STR?71
	RTRUE
?L46:	EQUAL? PRSA,V?GIVE \?L52
	EQUAL? PRSO,BLASTER \?L52
	PRINTI "The guards are more than glad to disarm you. They"
	CALL PRINT-ID,STR?72
	CALL GUARD-DEATH
	RTRUE
?L52:	EQUAL? PRSA,V?COUNT \FALSE
	EQUAL? HERE,HOLD \?L56
	PRINTR "One."
?L56:	EQUAL? HERE,CAPTAINS-QUARTERS \?L60
	PRINTR "Several."
?L60:	PRINTR "Many."

	.FUNCT WEAPON-PSEUDO
	IN? GUARDS,HERE /?L1
	PRINTR "What weapon?"
?L1:	EQUAL? PRSA,V?SHOOT \FALSE
	PRINT NOT-HOLDING
	PRINTR " it."

	.FUNCT FRUSTRATION-F
	EQUAL? PRSA,V?ENJOY \FALSE
	PRINT ZEN
	CRLF
	RTRUE

	.FUNCT UNIMPORTANT-THING-F
	EQUAL? PRSA,V?ASK-ABOUT \?L1
	EQUAL? PRSO,GUIDE /FALSE
?L1:	PRINTR "That's not important; leave it alone."

	.FUNCT DONT-F
	EQUAL? PRSA,V?PANIC \?L1
	RANDOM 100 >STACK
	LESS? 50,STACK /?L3
	PRINTR "Very clever. It looks like there's a lot you should be panicking about."
?L3:	PRINTR "Why not? Your position appears quite hopeless."
?L1:	EQUAL? PRSA,V?LOOK \?L10
	SET 'DONT-FLAG,0
	CALL PERFORM,V?CLOSE,EYES
	RTRUE
?L10:	EQUAL? PRSA,V?WAIT \?L11
	PRINTR "Time doesn't pass..."
?L11:	EQUAL? PRSA,V?TAKE \?L14
	PRINTR "Not taken."
?L14:	EQUAL? PRSA,V?LISTEN \?L17
	CALL VISIBLE?,POETRY >STACK
	ZERO? STACK /?L17
	SET 'DONT-FLAG,0
	CALL PERFORM,V?LISTEN,POETRY
	RTRUE
?L17:	PRINTR "Not done."

	.FUNCT DARK-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	PUTP PROTAGONIST,P?ACTION,DARK-FUNCTION
	CALL ROB,PROTAGONIST,DARK-OBJECT
	FSET CONVERSATION,INVISIBLE
	SET 'DREAMING,0
	SET 'LYING-DOWN,0
?L3:	RANDOM 100 >STACK
	LESS? HEART-PROB,STACK /?L5
	SET 'HEART-PROB,0
	SET 'VOGON-PROB,10
	SET 'DARK-FLAG,ENTRY-BAY
	SET 'CURRENT-EXIT,3
	JUMP ?L16
?L5:	RANDOM 100 >STACK
	LESS? VOGON-PROB,STACK /?L7
	SET 'VOGON-PROB,0
	SET 'HEART-PROB,100
	SET 'DARK-FLAG,HOLD
	SET 'CURRENT-EXIT,0
	JUMP ?L16
?L7:	RANDOM 100 >STACK
	LESS? TRAAL-PROB,STACK /?L8
	EQUAL? TRAAL-PROB,10 /?L9
	SET 'TRAAL-PROB,10
	SET 'TRILLIAN-PROB,25
	SET 'FORD-PROB,25
	SET 'ZAPHOD-PROB,25
?L9:	SET 'DARK-FLAG,LAIR
	SET 'CURRENT-EXIT,4
	JUMP ?L16
?L8:	RANDOM 100 >STACK
	LESS? TRILLIAN-PROB,STACK /?L12
	SET 'TRILLIAN-PROB,10
	SET 'DARK-FLAG,LIVING-ROOM
	SET 'CURRENT-EXIT,2
	JUMP ?L16
?L12:	RANDOM 100 >STACK
	LESS? FORD-PROB,STACK /?L13
	SET 'FORD-PROB,10
	SET 'DARK-FLAG,COUNTRY-LANE
	SET 'CURRENT-EXIT,1
	JUMP ?L16
?L13:	RANDOM 100 >STACK
	LESS? ZAPHOD-PROB,STACK /?L14
	SET 'ZAPHOD-PROB,10
	SET 'DARK-FLAG,SPEEDBOAT
	SET 'CURRENT-EXIT,5
	JUMP ?L16
?L14:	RANDOM 100 >STACK
	LESS? FLEET-PROB,STACK /?L15
	SET 'FLEET-PROB,10
	SET 'DARK-FLAG,WAR-CHAMBER
	SET 'CURRENT-EXIT,7
	JUMP ?L16
?L15:	RANDOM 100 >STACK
	LESS? WHALE-PROB,STACK /?L16
	PRINTI "Bug #60"
	CRLF
	SET 'DARK-FLAG,INSIDE-WHALE
	SET 'CURRENT-EXIT,6
?L16:	ZERO? DARK-FLAG /?L3
	RFALSE
?L1:	EQUAL? RARG,M-LOOK /TRUE
	RFALSE

	.FUNCT DARK-FUNCTION
	EQUAL? PRSA,V?RESTORE,V?RESTART,V?QUIT /FALSE
	EQUAL? PRSA,V?SAVE,V?VERSION,V?SCORE /FALSE
	EQUAL? PRSA,V?VERBOSE,V?HELP,V?AGAIN /FALSE
	EQUAL? PRSA,V?SCRIPT,V?SUPER-BRIEF,V?BRIEF /FALSE
	EQUAL? PRSA,V?FOOTNOTE,V?UNSCRIPT /FALSE
	ZERO? DONT-FLAG \FALSE
	EQUAL? PRSA,V?YELL,V?PANIC \?L5
	PRINTR "You yell as loudly as you can, but no sound emerges."
?L5:	EQUAL? PRSA,V?RELAX /?L9
	EQUAL? PRSA,V?ENJOY \?L8
	EQUAL? PRSO,DARK-OBJECT \?L8
?L9:	PRINTR "You achieve a state of Negative Capability, and are able to be in uncertainties, mysteries, doubts, without any irritable searching after fact and reason (Footnote 1)."
?L8:	EQUAL? DARK-FLAG,ENTRY-BAY,WAR-CHAMBER \?L12
	EQUAL? PRSA,V?LISTEN \?L12
	EQUAL? PRSO,DARK-OBJECT \?L12
	CALL MISSING? >STACK
	ZERO? STACK /?L12
	MOVE STAR-DRIVE,HERE
	SET 'P-IT-OBJECT,STAR-DRIVE
	PRINTI "You hear the deep and distant hum of a "
	PRINTD STAR-DRIVE
	PRINTI " coming from far "
	EQUAL? DARK-FLAG,ENTRY-BAY \?L15
	PRINTI "above"
	JUMP ?L19
?L15:	PRINTI "below"
?L19:	PRINTR ". There is an exit to port."
?L12:	EQUAL? PRSA,V?WALK \?L24
	CALL MISSING? >STACK
	ZERO? STACK /?L24
	EQUAL? DARK-FLAG,WAR-CHAMBER,ENTRY-BAY \?L24
	IN? STAR-DRIVE,HERE \?L24
	EQUAL? PRSO,P?SOUTH \?L25
	LESS? LYING-COUNTER,4 \?L27
	PRINT LYING-ABOUT-EXIT
?L27:	PRINTI "You emerge from a small doorway..."
	CALL LEAVE-DARK >STACK
	RSTACK
?L25:	PRINT CANT-GO
	EQUAL? PRSO,P?WEST \?L39
	INC 'LYING-COUNTER
	EQUAL? LYING-COUNTER,4 \?L39
	PRINTI " "
	PRINT LYING-ABOUT-EXIT
	PRINTI "There is an exit aft..."
?L39:	CRLF
	RTRUE
?L24:	EQUAL? PRSO,STAR-DRIVE /?L46
	EQUAL? PRSI,STAR-DRIVE \?L45
?L46:	EQUAL? PRSA,V?WALK /?L45
	EQUAL? DARK-FLAG,ENTRY-BAY,WAR-CHAMBER /?L47
	CALL CANT-SEE,STAR-DRIVE >STACK
	RSTACK
?L47:	EQUAL? PRSA,V?LISTEN \FALSE
	PRINTI "The sound comes from far "
	EQUAL? DARK-FLAG,ENTRY-BAY \?L52
	PRINTI "above"
	JUMP ?L56
?L52:	PRINTI "below"
?L56:	PRINTR "."
?L45:	EQUAL? DARK-FLAG,COUNTRY-LANE,SPEEDBOAT \?L62
	EQUAL? PRSA,V?EXAMINE \?L62
	EQUAL? PRSO,DARK-OBJECT \?L62
	CALL MISSING? >STACK
	ZERO? STACK /?L62
	MOVE PAINFUL-LIGHT,HERE
	SET 'P-IT-OBJECT,PAINFUL-LIGHT
	PRINTI "You see a painfully bright light that stabs at the "
	EQUAL? DARK-FLAG,COUNTRY-LANE \?L65
	PRINTI "front"
	JUMP ?L69
?L65:	PRINTI "back"
?L69:	PRINTR " of your eyes."
?L62:	EQUAL? PRSO,PAINFUL-LIGHT /?L75
	EQUAL? PRSI,PAINFUL-LIGHT \?L74
?L75:	EQUAL? PRSA,V?WALK /?L74
	EQUAL? DARK-FLAG,SPEEDBOAT,COUNTRY-LANE /?L76
	CALL CANT-SEE,PAINFUL-LIGHT >STACK
	RSTACK
?L76:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "The light resolves itself into the bright "
	EQUAL? DARK-FLAG,COUNTRY-LANE \?L81
	PRINTI "yellow Sun of Earth"
	JUMP ?L85
?L81:	PRINTI "orange Sun of "
	PRINTD DAMOGRAN
?L85:	PRINTI "."
	CALL LEAVE-DARK >STACK
	RSTACK
?L74:	EQUAL? DARK-FLAG,LIVING-ROOM,INSIDE-WHALE \?L91
	EQUAL? PRSA,V?RUB \?L91
	EQUAL? PRSO,DARK-OBJECT \?L91
	CALL MISSING? >STACK
	ZERO? STACK /?L91
	MOVE LIQUID,HERE
	SET 'P-IT-OBJECT,LIQUID
	PRINTI "It does feel a bit "
	EQUAL? DARK-FLAG,LIVING-ROOM \?L94
	PRINTI "cold"
	JUMP ?L98
?L94:	PRINTI "warm"
?L98:	PRINTR " and wet and squishy. There seems to be some liquid at your fingertips."
?L91:	EQUAL? PRSO,LIQUID /?L104
	EQUAL? PRSI,LIQUID \?L103
?L104:	EQUAL? PRSA,V?WALK /?L103
	EQUAL? DARK-FLAG,LIVING-ROOM,INSIDE-WHALE /?L105
	CALL CANT-SEE,LIQUID >STACK
	RSTACK
?L105:	EQUAL? DARK-FLAG,LIVING-ROOM \?L107
	EQUAL? PRSA,V?RUB,V?EXAMINE \?L108
	PRINTR "It seems coldish."
?L108:	EQUAL? PRSA,V?DRINK,V?TASTE \FALSE
	PRINTI "It tastes just like wine. In fact, you realise with growing embarrassment that "
	PRINTD HANDS
	PRINTI " is sitting in a "
	PRINTD WINE
	PRINTI "."
	CALL LEAVE-DARK >STACK
	RSTACK
?L107:	EQUAL? DARK-FLAG,INSIDE-WHALE \FALSE
	EQUAL? PRSA,V?RUB,V?EXAMINE \?L117
	PRINTR "It seems warmish."
?L117:	EQUAL? PRSA,V?DRINK,V?TASTE \FALSE
	PRINTI "Yucchhh! You are jerked to your senses by the realisation that you are licking the lining of a whale's stomach."
	CALL LEAVE-DARK >STACK
	RSTACK
?L103:	EQUAL? DARK-FLAG,HOLD,LAIR \?L126
	EQUAL? PRSA,V?SMELL \?L126
	EQUAL? PRSO,DARK-OBJECT \?L126
	CALL MISSING? >STACK
	ZERO? STACK /?L126
	MOVE SHADOW,HERE
	SET 'P-IT-OBJECT,SHADOW
	PRINTI "It does smell a bit. There's something pungent "
	EQUAL? DARK-FLAG,HOLD \?L129
	PRINTI "being waved"
	JUMP ?L133
?L129:	PRINTI "waving"
?L133:	PRINTR " under your nose. Your head begins to clear. You can make out a shadow moving in the dark."
?L126:	EQUAL? PRSO,SHADOW /?L139
	EQUAL? PRSI,SHADOW \?L138
?L139:	EQUAL? PRSA,V?WALK /?L138
	EQUAL? DARK-FLAG,HOLD,LAIR /?L140
	CALL CANT-SEE,SHADOW >STACK
	RSTACK
?L140:	EQUAL? PRSA,V?EXAMINE \?L142
	PRINTI "The shadow is vaguely "
	CALL BEAST-GUARD-FORD
	PRINTI "-shaped."
	CALL LEAVE-DARK >STACK
	RSTACK
?L142:	EQUAL? PRSA,V?RUB \?L147
	PRINTI "The shadow turns out to be a solid object of a "
	CALL BEAST-GUARD-FORD
	PRINTI "-like nature."
	CALL LEAVE-DARK >STACK
	RSTACK
?L147:	EQUAL? PRSA,V?SMELL \FALSE
	PRINTI "The shadow has a sort of "
	CALL BEAST-GUARD-FORD
	PRINTI "y smell to it."
	CALL LEAVE-DARK >STACK
	RSTACK
?L138:	INC 'DARK-COUNTER
	ZERO? DARK-CONTROLLED /?L159
	INC 'CURRENT-EXIT
	EQUAL? CURRENT-EXIT,8 \?L161
	SET 'CURRENT-EXIT,0
?L161:	GET DARK-EXIT-TABLE,CURRENT-EXIT >DARK-FLAG
?L159:	EQUAL? PRSA,V?LOOK \?L165
	PRINTI "Dark"
	CRLF
?L165:	RANDOM 100 >STACK
	LESS? 25,STACK /?L170
	CALL DARK-ONE
	CALL FUCKING-CLEAR
	JUMP ?L174
?L170:	RANDOM 100 >STACK
	LESS? 33,STACK /?L172
	CALL DARK-TWO
	CALL FUCKING-CLEAR
	JUMP ?L174
?L172:	RANDOM 100 >STACK
	LESS? 50,STACK /?L173
	CALL DARK-THREE
	CALL FUCKING-CLEAR
	JUMP ?L174
?L173:	CALL DARK-FOUR
	CALL FUCKING-CLEAR
?L174:	EQUAL? DARK-COUNTER,18 \?L175
	CRLF
	PRINTR "When will you come to your senses and solve this puzzle?"
?L175:	EQUAL? DARK-COUNTER,33 \?L179
	CRLF
	PRINTR "4 out of 5 sensitive people solve this puzzle right away."
?L179:	EQUAL? DARK-COUNTER,48 \?L182
	CRLF
	PRINTR "Don't count your senses before they hatch."
?L182:	EQUAL? DARK-COUNTER,63 \TRUE
	EQUAL? DARK-FLAG,HOLD \TRUE
	CRLF
	PRINTR "Something stinks around here, and I'm not just talking about your puzzle-solving ability!"

	.FUNCT LEAVE-DARK
	CRLF
	CRLF
	PUTP PROTAGONIST,P?ACTION,PROTAGONIST-F
	SET 'DARK-COUNTER,0
	SET 'LYING-COUNTER,0
	SET 'DARK-CONTROLLED,0
	CALL ROB,DARK-OBJECT,PROTAGONIST
	CALL ROB,MEMORIAL,PROTAGONIST
	MOVE SHADOW,LOCAL-GLOBALS
	MOVE PAINFUL-LIGHT,LOCAL-GLOBALS
	MOVE LIQUID,LOCAL-GLOBALS
	MOVE STAR-DRIVE,LOCAL-GLOBALS
	ZERO? FLUFF-TO-GOWN /?L1
	MOVE SATCHEL-FLUFF,GOWN
	SET 'FLUFF-TO-GOWN,0
?L1:	EQUAL? DARK-FLAG,WAR-CHAMBER \?L4
	FSET? WAR-CHAMBER,REVISITBIT \?L4
	CALL QUEUE,I-BRAIN-DEATH,6 >STACK
	PUT STACK,0,1
	CALL META-LOC,SPARE-DRIVE >HERE
	MOVE PROTAGONIST,HERE
	MOVE NAME,HERE
	SET 'GUTS-ROOM,HERE
	PRINTI "There is a violent explosion around you, leaving you standing in"
	CALL ARTICLE,HERE,1
	PRINTI ". "
	CALL PERFORM,V?EXAMINE,GROUND
	CRLF
	PRINTI "Apparently, you just materialised inside your own brain. This is very very very nasty. You have two choices: quit now, or experience this materialisation from the other end, in about five turns."
	CRLF
	CALL PRINT-ID,STR?73
	JUMP ?L13
?L4:	EQUAL? DARK-FLAG,SPEEDBOAT \?L12
	FSET? SPEEDBOAT,REVISITBIT \?L12
	CALL GOTO,DAIS
	JUMP ?L13
?L12:	EQUAL? DARK-FLAG,ENTRY-BAY /?L14
	MOVE MAIN-DRIVE,LOCAL-GLOBALS
?L14:	CALL GOTO,DARK-FLAG
?L13:	SET 'DARK-FLAG,0
	RTRUE

	.FUNCT MISSING?
	ZERO? DARK-CONTROLLED \TRUE
	GRTR? DARK-COUNTER,3 \FALSE
	RTRUE

	.FUNCT DARK-ONE
	PRINTI "You can "
	CALL MISSING? >STACK
	ZERO? STACK /?L5
	EQUAL? DARK-FLAG,WAR-CHAMBER,ENTRY-BAY /?L3
?L5:	PRINTI "hear nothing, "
?L3:	CALL MISSING? >STACK
	ZERO? STACK /?L11
	EQUAL? DARK-FLAG,HOLD,LAIR /?L9
?L11:	PRINTI "smell nothing, "
?L9:	PRINTI "taste nothing, "
	CALL MISSING? >STACK
	ZERO? STACK /?L19
	EQUAL? DARK-FLAG,COUNTRY-LANE,SPEEDBOAT /?L17
?L19:	PRINTI "see nothing, "
?L17:	CALL MISSING? >STACK
	ZERO? STACK /?L25
	EQUAL? DARK-FLAG,LIVING-ROOM,INSIDE-WHALE /?L23
?L25:	PRINTI "feel nothing, "
?L23:	PRINTR "and are not even certain who you are."

	.FUNCT DARK-TWO
	PRINTI "You can "
	CALL MISSING? >STACK
	ZERO? STACK /?L5
	EQUAL? DARK-FLAG,COUNTRY-LANE,SPEEDBOAT /?L3
?L5:	PRINTI "see nothing, "
?L3:	CALL MISSING? >STACK
	ZERO? STACK /?L11
	EQUAL? DARK-FLAG,LIVING-ROOM,INSIDE-WHALE /?L9
?L11:	PRINTI "feel nothing, "
?L9:	CALL MISSING? >STACK
	ZERO? STACK /?L17
	EQUAL? DARK-FLAG,WAR-CHAMBER,ENTRY-BAY /?L15
?L17:	PRINTI "hear nothing, "
?L15:	PRINTI "taste nothing, "
	CALL MISSING? >STACK
	ZERO? STACK /?L25
	EQUAL? DARK-FLAG,HOLD,LAIR /?L23
?L25:	PRINTI "smell nothing, "
?L23:	PRINTR "and are not entirely certain who you are."

	.FUNCT DARK-THREE
	PRINTI "You can't "
	CALL MISSING? >STACK
	ZERO? STACK /?L5
	EQUAL? DARK-FLAG,WAR-CHAMBER,ENTRY-BAY /?L3
?L5:	PRINTI "hear anything, "
?L3:	CALL MISSING? >STACK
	ZERO? STACK /?L11
	EQUAL? DARK-FLAG,COUNTRY-LANE,SPEEDBOAT /?L9
?L11:	PRINTI "see anything, "
?L9:	CALL MISSING? >STACK
	ZERO? STACK /?L17
	EQUAL? DARK-FLAG,HOLD,LAIR /?L15
?L17:	PRINTI "smell anything, "
?L15:	CALL MISSING? >STACK
	ZERO? STACK /?L23
	EQUAL? DARK-FLAG,LIVING-ROOM,INSIDE-WHALE /?L21
?L23:	PRINTI "feel anything, "
?L21:	PRINTR "or taste anything, and do not even know where you are or who you are or how you got there."

	.FUNCT DARK-FOUR
	PRINTI "There's nothing you can taste, "
	CALL MISSING? >STACK
	ZERO? STACK /?L5
	EQUAL? DARK-FLAG,COUNTRY-LANE,SPEEDBOAT /?L3
?L5:	PRINTI "nothing you can see, "
?L3:	CALL MISSING? >STACK
	ZERO? STACK /?L11
	EQUAL? DARK-FLAG,WAR-CHAMBER,ENTRY-BAY /?L9
?L11:	PRINTI "nothing you can hear, "
?L9:	CALL MISSING? >STACK
	ZERO? STACK /?L17
	EQUAL? DARK-FLAG,LIVING-ROOM,INSIDE-WHALE /?L15
?L17:	PRINTI "nothing you can feel, "
?L15:	CALL MISSING? >STACK
	ZERO? STACK /?L23
	EQUAL? DARK-FLAG,HOLD,LAIR /?L21
?L23:	PRINTI "nothing you can smell, "
?L21:	PRINTR "you do not even know who you are."

	.FUNCT BEAST-GUARD-FORD
	EQUAL? DARK-FLAG,LAIR \?L1
	PRINTI "Bugblatter Beast"
	RTRUE
?L1:	FSET? HOLD,REVISITBIT \?L5
	PRINTI "guard"
	RTRUE
?L5:	PRINTD FORD
	RTRUE

	.FUNCT I-BRAIN-DEATH
	PRINTI "The "
	PRINTD ARTHUR
	CALL PRINT-ID,STR?74
	CALL JIGS-UP,STR?75
	RTRUE

	.FUNCT TOOTHBRUSH-F
	EQUAL? PRSA,V?TAKE \FALSE
	FSET? TOOTHBRUSH,TOUCHBIT /FALSE
	MOVE TOOTHBRUSH,PROTAGONIST
	FSET TOOTHBRUSH,TOUCHBIT
	FCLEAR TOOTHBRUSH,TRYTAKEBIT
	PRINTI "As you pick up the "
	PRINTD TOOTHBRUSH
	PRINTI " a tree outside the window collapses. There is no causal relationship between these two events."
	FSET? PHONE,TOUCHBIT \?L5
	CALL TWO-TREES
?L5:	CRLF
	RTRUE

	.FUNCT LIQUID-SPILL
	EQUAL? PRSI,PLANT,FLOWERPOT \?L1
	CALL PERFORM,V?WATER,PRSI,PRSO
	RTRUE
?L1:	MOVE PRSO,LOCAL-GLOBALS
	EQUAL? PRSO,BROWNIAN-SOURCE \?L4
	SET 'BROWNIAN-SOURCE,0
	JUMP ?L6
?L4:	EQUAL? PRSO,PANEL-BLOCKER \?L6
	SET 'PANEL-BLOCKER,0
?L6:	PRINTI "It spills all over and then evaporates."
	EQUAL? PRSO,MINERAL-WATER \?L10
	CALL ANTI-LITTER,STR?76
	CRLF
	RTRUE
?L10:	CALL ANTI-LITTER,STR?77
	CRLF
	RTRUE

	.FUNCT ANTI-LITTER,STRING
	PRINTI " The "
	PRINT STRING
	PRINTI " itself vaporises, part of the Galactic Anti-Litter Program."
	RTRUE

	.FUNCT TEA-DESCFCN,X
	CALL DESCRIBE-DRINK,TEA >STACK
	RSTACK

	.FUNCT DESCRIBE-DRINK,DRINK
	PRINTI "There is a nice, hot cup of "
	PRINTD DRINK
	PRINTR " here."

	.FUNCT TEA-F
	EQUAL? PRSA,V?TAKE \?L1
	EQUAL? PRSO,TEA \?L1
	MOVE TEA,PROTAGONIST
	SET 'HOLDING-NO-TEA,0
	PRINTR "no tea: Dropped."
?L1:	EQUAL? PRSA,V?DROP \?L5
	MOVE TEA,HERE
	EQUAL? HERE,ACCESS-SPACE \?L6
	SET 'HOLDING-NO-TEA,1
	CALL V-DROP >STACK
	RSTACK
?L6:	ZERO? HOLDING-NO-TEA /?L8
	PRINTR "Dropped."
?L8:	SET 'HOLDING-NO-TEA,1
	PRINTR "no tea: Taken."
?L5:	EQUAL? PRSA,V?DRINK-FROM,V?ENJOY,V?DRINK \?L14
	CALL HELD?,PRSO >STACK
	ZERO? STACK \?L15
	PRINT NOT-HOLDING
	PRINTR " the cup!"
?L15:	ADD SCORE,100 >SCORE
	MOVE TEA,LOCAL-GLOBALS
	SET 'HOLDING-NO-TEA,1
	EQUAL? TEA,BROWNIAN-SOURCE \?L20
	SET 'BROWNIAN-SOURCE,0
?L20:	PRINTI "It is the finest tea you have ever tasted. It has almost made this entire misadventure seem worthwhile. You experience several moments of complete happiness and relaxation."
	CALL ANTI-LITTER,STR?77
	CRLF
	RTRUE
?L14:	EQUAL? PRSA,V?THROW,V?POUR \?L25
	CALL LIQUID-SPILL >STACK
	RSTACK
?L25:	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \FALSE
	PRINT IT-LOOKS-LIKE
	PRINTI " it has even more"
	PRINT BROWNIAN
	PRINTI " than "
	PRINTD SUBSTITUTE
	PRINTI "!"
	EQUAL? PRSO,BROWNIAN-SOURCE \?L29
	PRINTI " "
	CALL PERFORM,V?EXAMINE,DANGLY-BIT
	RTRUE
?L29:	CRLF
	RTRUE

	.FUNCT NO-TEA-F
	EQUAL? PRSA,V?DROP,V?PICK-UP,V?TAKE \?L1
	EQUAL? PRSO,NO-TEA \?L1
	FSET? PARTICLE,MUNGEDBIT /?L1
	PRINTR "Your common sense tells you that you can't do that."
?L1:	EQUAL? PRSA,V?PICK-UP,V?TAKE \?L5
	EQUAL? PRSO,NO-TEA \?L5
	ZERO? HOLDING-NO-TEA \?L5
	SET 'HOLDING-NO-TEA,1
	PRINTR "no tea: Taken."
?L5:	EQUAL? PRSA,V?GIVE,V?SHOW \?L8
	EQUAL? PRSI,SCREENING-DOOR /FALSE
?L8:	EQUAL? PRSA,V?ASK-ABOUT \?L9
	EQUAL? PRSO,GUIDE /FALSE
?L9:	EQUAL? PRSA,V?ASK-FOR \?L10
	EQUAL? PRSO,NUTRIMAT \?L10
	CALL PERFORM,V?RUB,PAD
	RTRUE
?L10:	PRINTR "You're talking complete nonsense; pull yourself together."

	.FUNCT TEA-PRINT,OBJ
	EQUAL? OBJ,TEA,NO-TEA \TRUE
	EQUAL? PRSA,V?SHOW /TRUE
	EQUAL? OBJ,TEA \?L4
	EQUAL? PRSA,V?TAKE \?L5
	CALL HELD?,TEA >STACK
	ZERO? STACK \TRUE
	ZERO? PRSI /FALSE
	LOC PRSO >STACK
	EQUAL? PRSI,STACK /FALSE
	RTRUE
?L5:	EQUAL? PRSA,V?DROP \FALSE
	ZERO? HOLDING-NO-TEA /FALSE
	RFALSE
?L4:	EQUAL? OBJ,NO-TEA \TRUE
	EQUAL? PRSA,V?TAKE \TRUE
	ZERO? HOLDING-NO-TEA \TRUE
	RFALSE

	.FUNCT THUMB-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "The "
	PRINTD THUMB
	PRINTI " is shaped like a small fist with an extended thumb. Various lights along its ""knuckles"" are currently "
	IN? FLEET,HERE /?L7
	EQUAL? HERE,AIRLOCK,INSIDE-WHALE \?L5
?L7:	PRINTI "blinking wildly, indicating a spaceship in the vicinity"
	JUMP ?L10
?L5:	PRINTI "dark"
?L10:	PRINTI ". It has two small buttons, a red one labelled ""Call Engineer"" and a green one labelled ""Hitchhike."""
	CALL FINE-PRODUCT
	PRINTI " Affixed to the Thumb is a lifetime "
	PRINTD GUARANTEE
	PRINTR "."
?L1:	EQUAL? PRSA,V?TAKE \?L17
	EQUAL? IDENTITY-FLAG,FORD \?L17
	IN? FLEET,HERE \?L17
	IN? THUMB,SATCHEL /?L17
	PRINT DRIVEN-BACK
	CRLF
	RTRUE
?L17:	EQUAL? PRSA,V?LOOK-INSIDE,V?CLOSE,V?OPEN \FALSE
	PRINTR "Impossible."

	.FUNCT RED-BUTTON-F
	EQUAL? PRSA,V?PUSH \FALSE
	CALL HELD?,THUMB >STACK
	ZERO? STACK \?L3
	CALL PERFORM,V?PUSH,GREEN-BUTTON
	RTRUE
?L3:	IN? ENGINEER,HERE \?L5
	PRINTI "Another "
	PRINTD ENGINEER
	PRINTR " zips up, spots the first one, looks confused, and leaves again."
?L5:	MOVE ENGINEER,HERE
	MOVE BIKE,HERE
	CALL QUEUE,I-ENGINEER,2 >STACK
	PUT STACK,0,1
	PRINTI "With a screech of ion brakes a "
	PRINT SCC
	PRINTR " Repair Robot pulls up on a bike from out of the Sub-Etha."

	.FUNCT GREEN-BUTTON-F
	EQUAL? PRSA,V?PUSH \FALSE
	CALL HELD?,THUMB >STACK
	ZERO? STACK \?L3
	PRINT NOT-HOLDING
	PRINTI " the "
	PRINTD THUMB
	PRINTI "."
	CRLF
	SET 'P-IT-OBJECT,THUMB
	RETURN P-IT-OBJECT
?L3:	EQUAL? IDENTITY-FLAG,FORD \?L7
	IN? FLEET,HERE \?L7
	MOVE THUMB,HERE
	PRINT THUMB-FUMBLE
	CRLF
	RTRUE
?L7:	FSET? THUMB,MUNGEDBIT \?L10
	PRINTI "The"
	PRINT THUMB-CLICKS
	CRLF
	RTRUE
?L10:	IN? FLEET,HERE \?L13
	EQUAL? DRUNK-LEVEL,3 \?L14
	PRINTI "Lights whirl sickeningly around your head, the ground arches away beneath your feet, and every atom of your being is scrambled, an experience you're probably going to have to get used to. You are in..."
	CRLF
	CRLF
	CALL LEAVE-EARTH
	CALL GOTO,DARK >STACK
	RSTACK
?L14:	PRINTI "A"
	PRINT BEAM
	CALL PRINT-ID,STR?78
	CALL JIGS-UP,STR?79
	RTRUE
?L13:	EQUAL? HERE,AIRLOCK,INSIDE-WHALE \?L21
	PRINTI "Every molecule in your body gets pulled away from every other molecule. Then suddenly they snap back together again like elastic, and you find, with a dizzy head and very sore molecules, that you are in..."
	CRLF
	CRLF
	SET 'HEART-PROB,100
	CALL GOTO,DARK >STACK
	RSTACK
?L21:	FSET THUMB,MUNGEDBIT
	PRINTR "The Thumb winks and flashes for a second. Nothing further happens."

	.FUNCT GUARANTEE-F
	EQUAL? PRSA,V?EXAMINE,V?READ \FALSE
	PRINTI "The lifetime "
	PRINTD GUARANTEE
	PRINTI " states that the Thumb will be repaired on site by trained "
	PRINT SCC
	PRINTR " Field Engineers."

	.FUNCT ENGINEER-F
	EQUAL? ENGINEER,WINNER \?L1
	CALL QUEUE,I-ENGINEER,2 >STACK
	PUT STACK,0,1
	EQUAL? PRSA,V?TELL-ABOUT \?L3
	EQUAL? PRSO,ME \?L3
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,ENGINEER,PRSI
	SET 'WINNER,ENGINEER
	RTRUE
?L3:	EQUAL? PRSA,V?HELLO \?L5
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,ENGINEER
	SET 'WINNER,ENGINEER
	RTRUE
?L5:	EQUAL? PRSA,V?REPAIR \?L12
	EQUAL? PRSO,THUMB \?L6
	IN? THUMB,ENGINEER \?L7
	PRINTR """I'm doing my best..."""
?L7:	SET 'WINNER,PROTAGONIST
	MOVE THUMB,PROTAGONIST
	CALL PERFORM,V?GIVE,THUMB,ENGINEER
	SET 'WINNER,ENGINEER
	RTRUE
?L6:	EQUAL? PRSA,V?REPAIR \?L12
	PRINTI """I repair only "
	PRINTD THUMB
	PRINTR "s!"""
?L12:	EQUAL? PRSA,V?YES \?L15
	EQUAL? AWAITING-REPLY,12 \?L15
	CALL V-YES >STACK
	RSTACK
?L15:	EQUAL? PRSA,V?NO \?L16
	EQUAL? AWAITING-REPLY,12 \?L16
	CALL V-NO >STACK
	RSTACK
?L16:	PRINTI """Can't chat, pal, I'm attending to an important repair call."""
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?SHOW,V?GIVE \FALSE
	EQUAL? PRSO,THUMB \?L20
	FSET? THUMB,MUNGEDBIT \?L21
	CALL QUEUE,I-ENGINEER,2 >STACK
	PUT STACK,0,1
	SET 'THUMB-SHOWN,1
	MOVE THUMB,ENGINEER
	PRINTI "The "
	PRINTD ENGINEER
	PRINTI " takes it, looks at it with horror, shakes his head, sighs, and says ""Who sold you this then?"""
	CRLF
	CRLF
	PRINTI ">"
	READ P-INBUF,P-LEXV
	PRINTI "The "
	PRINTD ENGINEER
	PRINTR " ignores your reply and shakes the Thumb despondently. ""This is a model 13X,"" he says. ""Not meant for this sort of job. Anyway, it's discontinued. Can't get the parts."""
?L21:	MOVE THUMB,PROTAGONIST
	CALL ENGINEER-LEAVE
	PRINTI "The "
	PRINTD ENGINEER
	PRINTI " takes the Thumb, shakes it, looks it up and down. ""Seems to be working OK to me. Unusual for a 13X."" He hands it back and"
	PRINT ROARS-OFF
	PRINTR "."
?L20:	EQUAL? PRSA,V?SHOW,V?GIVE \FALSE
	EQUAL? PRSO,GUARANTEE \FALSE
	FSET? THUMB,MUNGEDBIT /?L31
	CALL PERFORM,V?GIVE,THUMB,ENGINEER
	RTRUE
?L31:	FCLEAR THUMB,MUNGEDBIT
	CALL ENGINEER-LEAVE
	MOVE THUMB,PROTAGONIST
	ZERO? THUMB-SHOWN \?L34
	PRINTI "The "
	PRINTD ENGINEER
	PRINTI " looks quizzically at the "
	PRINTD GUARANTEE
	PRINTI " and says it's expired but he'll see what he can do. "
	PRINT FIDDLES
	PRINTI """Can't promise anything."" He"
	PRINT ROARS-OFF
	PRINTR "."
?L34:	SET 'THUMB-SHOWN,0
	PRINTI "The "
	PRINTD ENGINEER
	PRINTI " looks at it sceptically. ""Guaranteed to work normally for life,"" he mutters. ""Well, it's perfectly normal for a 13X to break down. And this one's reached the end of its life anyway. But I'll see what I can do."""
	CRLF
	CRLF
	PRINT FIDDLES
	PRINTI """Best I can do for a 13X on an expired "
	PRINTD GUARANTEE
	PRINTI ","" he says. ""Can't promise anything."" He"
	PRINT ROARS-OFF
	PRINTR "."

	.FUNCT ENGINEER-LEAVE
	IN? THUMB,ENGINEER \?L5
	IN? ENGINEER,HERE \?L3
	MOVE THUMB,PROTAGONIST
	JUMP ?L5
?L3:	LOC ENGINEER >STACK
	MOVE THUMB,STACK
?L5:	MOVE ENGINEER,LOCAL-GLOBALS
	MOVE BIKE,LOCAL-GLOBALS
	CALL INT,I-ENGINEER >STACK
	PUT STACK,0,0
	SET 'THUMB-SHOWN,0
	SET 'ENGINEER-COUNTER,0
	RETURN ENGINEER-COUNTER

	.FUNCT I-ENGINEER
	CALL QUEUE,I-ENGINEER,-1 >STACK
	PUT STACK,0,1
	INC 'ENGINEER-COUNTER
	IN? ENGINEER,HERE /?L1
	CALL ENGINEER-LEAVE
	RFALSE
?L1:	CRLF
	EQUAL? THUMB-SHOWN,1 \?L4
	SET 'THUMB-SHOWN,2
	PRINTI "The "
	PRINTD ENGINEER
	PRINTR " ignores you completely. ""See, this is the model with the 5kz booster,"" he says. ""Hopeless."" He shakes his head grimly."
?L4:	EQUAL? THUMB-SHOWN,2 \?L8
	PRINTI "The "
	PRINTD ENGINEER
	PRINTI " ignores you. ""What you want, you see, is one of the new Mk7's. Only you can't get them. Out of stock till Zarkmas. Sorry."" He"
	IN? THUMB,ENGINEER \?L11
	PRINTI " gives the defunct Thumb back and"
?L11:	CALL ENGINEER-LEAVE
	PRINT ROARS-OFF
	PRINTR "."
?L8:	EQUAL? ENGINEER-COUNTER,1 \?L18
	SET 'AWAITING-REPLY,12
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTI "The "
	PRINTD ENGINEER
	PRINTR " looks around. ""Somebody call the repair service?"""
?L18:	EQUAL? ENGINEER-COUNTER,2 \?L21
	PRINTI "The "
	PRINTD ENGINEER
	PRINTR " looks impatient and guns the throttle of his cycle."
?L21:	CALL ENGINEER-LEAVE
	PRINTI """Probably a kid playing around with someone else's Thumb,"" grumbles the "
	PRINTD ENGINEER
	PRINTI " and"
	PRINT ROARS-OFF
	PRINTR "."

	.FUNCT GUIDE-DESCFCN,X
	PRINTI "There is a copy of "
	PRINT GUIDE-NAME
	PRINTR " here."

	.FUNCT GUIDE-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "The Guide is a Mark II model. Its only resemblance to the Mark IV pictured in the brochure in your game package is the large, friendly ""Don't Panic!"" on its cover.

The Guide is a Sub-Etha Relay. You can use it to tap information from a huge and distant data bank by consulting the Guide about some item or subject."
?L1:	EQUAL? PRSA,V?ASK-ABOUT \FALSE
	EQUAL? PRSO,GUIDE \FALSE
	FSET? TOWEL,WORNBIT \?L6
	PRINT WITH-TOWEL
	CRLF
	RTRUE
?L6:	EQUAL? PRSI,ACCESS-SPACE \?L10
	PRINTI "Suddenly, agents of the "
	PRINT AGENCY
	PRINTI " pop in using Sub-Etha belts, rough you up a bit, tell you there's no such thing as the "
	PRINT AGENCY
	PRINTI " and never to consult "
	PRINTD GUIDE
	PRINTI " about the "
	PRINT AGENCY
	PRINTI " again; then they leave."
	CRLF
	CALL PRINT-ID,STR?80
	RTRUE
?L10:	PRINTI "The Guide checks through its Sub-Etha-Net database and eventually comes up with the following entry:"
	CRLF
	CRLF
	EQUAL? PRSI,GUIDE \?L16
	PRINTD GUIDE
	PRINTI " is a wholly remarkable product."
	PRINT ALREADY-KNOW-THAT
	CRLF
	RTRUE
?L16:	EQUAL? PRSI,LARGE-PLUG,SMALL-RECEPTACLE,DANGLY-BIT /?L21
	EQUAL? PRSI,RED-BUTTON,GREEN-BUTTON,SMALL-PLUG \?L20
?L21:	PRINTI "Part of"
	EQUAL? PRSI,LARGE-PLUG \?L24
	IN? LARGE-PLUG,SPARE-DRIVE /?L24
	CALL ARTICLE,SPARE-DRIVE
	JUMP ?L26
?L24:	LOC PRSI >STACK
	CALL ARTICLE,STACK
?L26:	PRINTR "."
?L20:	EQUAL? PRSI,WAR-CHAMBER \?L29
	PRINTR "If you have to consult the Guide about that, you're probably in serious shape. Consult a medic instead."
?L29:	EQUAL? PRSI,DAMOGRAN \?L32
	PRINTD DAMOGRAN
	PRINTI " is a planet whose surface is mostly water. It is a favourite spot for Presidential dedication ceremonies"
	PRINT ALSO-SEE
	PRINTR "France."
?L32:	EQUAL? PRSI,CLIFF \?L35
	PRINTI "France is the largest landmass on the planet "
	PRINTD DAMOGRAN
	PRINTR "."
?L35:	EQUAL? PRSI,HEART-OF-GOLD \?L38
	PRINTI "There is absolutely no such spaceship as "
	PRINTD HEART-OF-GOLD
	PRINTI " and anything you've ever read in this spot to the contrary was just a prank.
   -- "
	PRINT AGENCY
	CRLF
	RTRUE
?L38:	EQUAL? PRSI,POETRY \?L41
	PRINTD POETRY
	PRINTI " is so awful that even the Sarkopsi of Burphon XII, whose religion strictly forbids the taking of one's life, consider suicide a preferable alternative to a "
	PRINTD POETRY
	PRINTR " reading."
?L41:	EQUAL? PRSI,FLEET,VOGON-CAPTAIN \?L44
	PRINTI "Vogons, whose specialties are bureaucracy and planet-smashing, are the most unpleasant race in the Galaxy. They wouldn't think twice about throwing someone into space, and wouldn't lift a finger to save their own grandmother from the "
	PRINTD BEAST
	PRINT ALSO-SEE
	PRINTD POETRY
	PRINTI " and the "
	PRINTD BEAST
	PRINTR "."
?L44:	EQUAL? PRSI,PUB,BEER \?L47
	PRINTI "Alcohol, in addition to its familiar enjoyable effects, also helps cushion the shock of"
	PRINT BEAM
	PRINTR "s."
?L47:	EQUAL? PRSI,BRIDGE \?L50
	PRINTI "The best randomness generator is simple"
	PRINT BROWNIAN
	PRINTR ". Any hot gas or liquid is a good source."
?L50:	EQUAL? PRSI,GALLEY \?L53
	PRINTI "The "
	PRINT SCC
	PRINTR " incompetently produces a wide range of inefficient and unreliable high-tech machinery. However, thanks to SCC's ruthless marketing division, this junk accounts for over 95% of the high-tech machinery sold in the Galaxy. (SCC's marketing division will be the first against the wall when the revolution comes.)"
?L53:	EQUAL? PRSI,PANTRY \?L56
	PRINTI "Thirty million generations of philosophers have debated the definition of intelligence. The most popular definition appears in the "
	PRINT SCC
	PRINTR " android manuals: ""Intelligence is the ability to reconcile totally contradictory situations without going completely bonkers -- for example, having a stomach ache and not having a stomach ache at the same time, holding a hole without the doughnut, having good luck and bad luck simultaneously, or seeing a real estate agent waive his fee."""
?L56:	EQUAL? PRSI,SCREENING-DOOR \?L59
	PRINTI "These "
	PRINT SCC
	PRINTI " doors screen visitors for such qualities as intelligence and ability to time travel"
	PRINT ALSO-SEE
	PRINT SCC
	PRINTI ", "
	PRINT GPP
	PRINTR ", Intelligence, and Time Travel."
?L59:	EQUAL? PRSI,EDDIE,MARVIN,HATCHWAY \?L62
	PRINT GPP
	PRINTI " are a misguided attempt by the "
	PRINT SCC
	PRINTR " to make their machines behave more like people. Among the more miserable failures: paranoid-depressive robots and over-protective computers."
?L62:	EQUAL? PRSI,DARK \?L65
	PRINTR "A must for the serious hitchhiker, peril-sensitive sunglasses darken at the first hint of danger, thus shielding the wearer from seeing anything alarming. Recommended brand: Joo Janta."
?L65:	EQUAL? PRSI,RAMP \?L68
	PRINTI "According to legend, Magrathea was a planet that amassed incredible wealth by manufacturing "
	PRINTD OTHER-PLANETS
	PRINTR ". The legends also mention it as the setting of the very eagerly awaited second Infocom Hitchhiker's game."
?L68:	EQUAL? PRSI,SPARE-DRIVE,MAIN-DRIVE,ENGINE-ROOM \?L71
	PRINTI "Scientists have long known how to produce FINITE amounts of improbability, using a "
	PRINT FIG
	PRINTI ", an "
	PRINTD PLOTTER
	PRINTI " and a good source of"
	PRINT BROWNIAN
	PRINTI ". Recently, however, they have learned to generate INFINITE amounts, thanks to the invention of the In"
	PRINT FIG
	PRINTI ". It is rumored that an"
	PRINT IID
	PRINTI ", based on this new generator, is currently under development"
	PRINT ALSO-SEE
	PRINTD PLOTTER
	PRINTI " and"
	PRINT BROWNIAN
	PRINTR "."
?L71:	EQUAL? PRSI,PLOTTER \?L74
	PRINTI "The "
	PRINTD PLOTTER
	PRINTR " is one of the primary application devices of Improbability Physics."
?L74:	EQUAL? PRSI,HOLD,PEANUTS \?L77
	PRINTI "Sources of protein, such as the common peanut, are carried by all serious hitchhikers. Protein loss occurs in"
	PRINT BEAM
	PRINTR "s and you will become groggy unless you replace it immediately."
?L77:	EQUAL? PRSI,NUT-COM-INTERFACE,NUTRIMAT \?L80
	PRINTI "A typically unreliable "
	PRINT SCC
	PRINTI " product, the "
	PRINTD NUTRIMAT
	PRINTR " analyses the user's neural paths to provide the (supposedly) ideal offering. Its computing power is frankly abysmal, so the optional computer interface is a good thing to go for."
?L80:	EQUAL? PRSI,SATCHEL-FLUFF,JACKET-FLUFF,POCKET-FLUFF /?L84
	EQUAL? PRSI,CUSHION-FLUFF \?L83
?L84:	PRINTR "Fluff is interesting stuff: a deadly poison on Bodega Minor, the diet staple of Frazelon V, the unit of currency on the moons of the Blurfoid system, and the major crop of the laundry supplies planet, Blastus III.
One ancient legend claims that four pieces of fluff lie scattered around the Galaxy; each forming one-quarter of the seedling of a tree with amazing properties, the sole survivor of the tropical planet Fuzzbol (Footnote 8).
The ultimate source of fluff is still a mystery, with the scientific community torn between the Big Lint Bang theory and the White Lint Hole theory."
?L83:	EQUAL? PRSI,ZAPHOD /?L88
	EQUAL? PRSI,ME \?L87
	EQUAL? IDENTITY-FLAG,ZAPHOD \?L87
?L88:	PRINTD ZAPHOD
	PRINTI " is the current"
	PRINT PRESIDENT
	PRINTR "."
?L87:	EQUAL? PRSI,BABEL-FISH \?L91
	PRINTI "A mind-bogglingly improbable creature. A "
	PRINTD BABEL-FISH
	PRINTR ", when placed in one's ear, allows one to understand any language."
?L91:	EQUAL? PRSI,TOWEL \?L94
	PRINTR "A towel is the most useful thing (besides the Guide) a Galactic hitchhiker can have. Its uses include travel, combat, communications, protection from the elements, hand-drying and reassurance. Towels have great symbolic value, with many associated points of honour. Never mock the towel of another, even if it has little pink and blue flowers on it. Never do something to somebody else's towel that you would not want them to do to yours. And, if you borrow the towel of another, you MUST return it before leaving their world."
?L94:	EQUAL? PRSI,GUARANTEE,THUMB \?L97
	PRINTI "The Electronic Sub-Etha Auto Hitching Thumb is a wonderful thing, but should not be mistreated. If used while a ship is near, you will be transported there. If no ship is in the vicinity, you will place a heavy strain on the Thumb's logic circuits, which could lead to malfunction. The Thumb carries the usual "
	PRINT SCC
	PRINTI " lifetime "
	PRINTD GUARANTEE
	PRINTR "s."
?L97:	EQUAL? PRSI,MINERAL-WATER \?L100
	PRINTR "A strong body of opinion holds that this is not water at all, despite the claims on the label about how pure the spring is, and all that tosh about sparkling babbling brooks and so on. There is something highly suspect about the water on Santraginus Five, as anyone who's ever met any of their fish will tell you."
?L100:	EQUAL? PRSI,BEAST \?L103
	PRINTI "The "
	PRINTD BEAST
	PRINTR " is a mind-bogglingly stupid animal. It has almost no capacity for learning from experience and is therefore surprised by virtually everything that happens to it. Here is an example of how stupid it is: it thinks that if you can't see it, it can't see you.
Its behaviour would be quite endearing if it wasn't spoilt by this one thing: it is the most violently carnivorous creature in the Galaxy. Avoid, avoid, avoid."
?L103:	EQUAL? PRSI,FRONT-PORCH \?L106
	PRINTI "A thoroughly unpleasant means of travelling which involves tearing you apart in one place and slamming you back together in another. (Of course, it's better than the older method, where disassembled people would be transmitted down phone lines and arrive in a garbled and sometimes completely disconnected state.) You should have a drink or two or three before going through one"
	PRINT ALSO-SEE
	PRINTR "Galaxia Woonbeam, Alcohol, and Protein."
?L106:	EQUAL? PRSI,FRONT-OF-HOUSE \?L109
	PRINTR "Galaxia Woonbeam is the author of ""Slimmer's Guide to Weightloss During Matter Disassembly Transition."" This text is currently the subject of the biggest suit for criminal negligence damages in history and is unavailable at this time."
?L109:	EQUAL? PRSI,ENTRY-BAY \?L112
	PRINTR "The best drink in existence; somewhat like having your brains smashed out by a slice of lemon wrapped around a large gold brick."
?L112:	EQUAL? PRSI,MAZE,THIRD-PLANET \?L115
	PRINTR "Mostly harmless."
?L115:	EQUAL? PRSI,COUNTRY-LANE \?L118
	PRINT SPACE-TEXT
	CRLF
	RTRUE
?L118:	FSET? PRSI,TOOLBIT \?L121
	PRINTR "The editor responsible for entries under this heading has been out to lunch for a couple of years but is expected back soon, at which point there will be rapid updates. Until then, don't panic, unless your situation is really a life or death one, in which case, sure, go ahead, panic."
?L121:	EQUAL? PRSI,BLASTER,RIFLES,BEDROOM /?L125
	EQUAL? PRSI,BEAST-GUN,NO-TEA,TEA /?L125
	EQUAL? PRSI,AIRLOCK,AFT-CORRIDOR,SUBSTITUTE /?L125
	EQUAL? PRSI,INSIDE-WHALE \?L124
?L125:	PRINTR "Sorry, that portion of our Sub-Etha database was accidentally deleted last night during a wild office party. The lost data will be restored as soon as we find someone who knows where the back-up tapes are kept, if indeed any are kept at all."
?L124:	PRINTR "That is one of the Great Unanswered Questions. For a list of the others, consult the Guide."

	.FUNCT CANT-SEE,OBJ
	PRINTI "You can't see"
	CALL NAME?,OBJ >STACK
	ZERO? STACK \?L3
	PRINTI " any"
?L3:	EQUAL? OBJ,PRSO \?L8
	CALL PRSO-PRINT
	JUMP ?L10
?L8:	CALL PRSI-PRINT
?L10:	PRINTI " here."
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK

	.FUNCT TELL-ME-HOW
	PRINTI "You must tell me how to do that to"
	CALL ARTICLE,PRSO
	PRINTR "."

	.FUNCT OUT-OF-FIRST,VEHICLE
	PRINTI "You'll have to get out of the "
	PRINTD VEHICLE
	PRINTR " first."

	.FUNCT PRIVATE,STRING
	PRINTI "You can't. It's not yours. It's "
	PRINT STRING
	PRINTR "'s and it's private."

	.FUNCT NOT-VERY-GOOD,STRING
	PRINTI "It's not a very good "
	PRINT STRING
	PRINTR ", is it?"

	.FUNCT FACTOR,STRING
	PRINTI " at an improbability factor of 2 to the "
	PRINT STRING
	PRINTI "th power to 1 against."
	RTRUE

	.FUNCT REMOVING-BIT
	PRINTI "(removing the "
	PRINTD DANGLY-BIT
	PRINTR " first)"

	.FUNCT PART-OF
	PRINTI "You can't --"
	CALL ARTICLE,PRSO,1
	PRINTI " is an integral part of"
	LOC PRSO >STACK
	CALL ARTICLE,STACK,1
	PRINTR "."

	.FUNCT BUT-THAT-MAN,STRING
	PRINTI "Pointing toward Prosser, "
	PRINT STRING
	PRINTI " ""But that man "
	ZERO? HOUSE-DEMOLISHED /?L3
	PRINTI "just knocked"
	JUMP ?L7
?L3:	PRINTI "wants to knock"
?L7:	PRINTI " my house down!"""
	RTRUE

	.FUNCT CUSHION
	PRINTI " cushion your system against the coming shock of the"
	PRINT BEAM
	PRINTI "."
	RTRUE

	.FUNCT FINE-PRODUCT
	PRINTI " It bears a small label which reads ""Another fine product of the "
	PRINT SCC
	PRINTI "."""
	RTRUE

	.FUNCT MAKE-WAY-FOR
	PRINTI " a "
	PRINTD FLEET
	PRINTR " unexpectedly arrives and demolishes the Earth to make way for a new hyperspace bypass."

	.FUNCT OWN-FEET
	PRINTR "You are now on your feet."

	.FUNCT V-VERBOSE
	SET 'VERBOSITY,2
	PRINTI "Maximum verbosity."
	CRLF
	CRLF
	CALL V-LOOK >STACK
	RSTACK

	.FUNCT V-BRIEF
	SET 'VERBOSITY,1
	PRINTR "Brief descriptions."

	.FUNCT V-SUPER-BRIEF
	SET 'VERBOSITY,0
	PRINTR "Super-brief descriptions."

	.FUNCT V-DIAGNOSE
	ZERO? HEADACHE /?L1
	PRINTR "You have a big blinding throbber."
?L1:	ZERO? GROGGY /?L5
	PRINTR "You feel weak."
?L5:	EQUAL? IDENTITY-FLAG,ZAPHOD \?L8
	PRINTI "You have two "
	PRINTD HANGOVER
	PRINTR "s."
?L8:	PRINTR "You are in good health."

	.FUNCT V-INVENTORY,SPARE-KLUDGE
	FSET? SPARE-DRIVE,NDESCBIT \?L1
	SET 'SPARE-KLUDGE,1
	FCLEAR SPARE-DRIVE,NDESCBIT
	JUMP ?L3
?L1:	SET 'SPARE-KLUDGE,0
?L3:	EQUAL? IDENTITY-FLAG,ARTHUR /?L4
	FIRST? PROTAGONIST >STACK /?L4
	PRINTI "You are empty-handed."
	CRLF
	JUMP ?L8
?L4:	PRINTI "You have:"
	CRLF
	ZERO? HEADACHE /?L11
	PRINTI "  a "
	PRINTD HANGOVER
	CRLF
?L11:	EQUAL? IDENTITY-FLAG,ARTHUR \?L16
	ZERO? HOLDING-NO-TEA \?L18
	CALL HELD?,TEA >STACK
	ZERO? STACK \?L16
?L18:	SET 'HOLDING-NO-TEA,1
	PRINTI "  no tea"
	CRLF
?L16:	CALL PRINT-CONT,PROTAGONIST
?L8:	ZERO? SPARE-KLUDGE /FALSE
	FSET SPARE-DRIVE,NDESCBIT
	RTRUE

	.FUNCT V-QUIT
	CALL V-SCORE
	PRINTI "Do you wish to leave the game? (Y is affirmative): "
	CALL YES? >STACK
	ZERO? STACK /?L3
	QUIT
?L3:	PRINTR "Ok."

	.FUNCT V-RESTART
	CALL V-SCORE,1
	PRINTI "Do you wish to restart? (Y is affirmative): "
	CALL YES? >STACK
	ZERO? STACK /FALSE
	PRINTI "Restarting."
	CRLF
	RESTART

	.FUNCT FINISH,REPEATING=0
	CRLF
	ZERO? REPEATING \?L1
	CALL V-SCORE
	CRLF
?L1:	PRINTI "[EVENT: GAME OVER]Would you like to start over, restore a saved position, or end this session of the game?
(Type RESTART, RESTORE, or QUIT): >"
	READ P-INBUF,P-LEXV
	GET P-LEXV,1 >STACK
	EQUAL? STACK,W?RESTAR \?L6
	RESTART
?L6:	GET P-LEXV,1 >STACK
	EQUAL? STACK,W?RESTOR \?L10
	RESTORE \?L11
	PRINTR "Ok."
?L11:	PRINTI "Failed."
	CRLF
	CALL FINISH,1 >STACK
	RSTACK
?L10:	GET P-LEXV,1 >STACK
	EQUAL? STACK,W?QUIT,W?Q \?L18
	QUIT
?L18:	CALL FINISH,1 >STACK
	RSTACK

	.FUNCT YES?
	PRINTI ">"
	READ P-INBUF,P-LEXV
	GET P-LEXV,1 >STACK
	EQUAL? STACK,W?YES,W?Y \FALSE
	RTRUE

	.FUNCT V-RESTORE
	RESTORE \?L1
	PRINTR "Ok."
?L1:	PRINTR "Failed."

	.FUNCT V-SAVE
	SAVE \?L1
	PRINTR "Ok."
?L1:	PRINTR "Failed."

	.FUNCT V-SCORE,ASK?=1
	LESS? SCORE,400 \?L1
	PRINTI "We are about to give you your score. Put on your peril-sensitive sunglasses now. (Hit RETURN or ENTER when ready.) "
	PRINTI ">"
	READ P-INBUF,P-LEXV
	SET 'P-CONT,0
	CRLF
?L1:	PRINTI "Your score is "
	PRINTN SCORE
	PRINTI " of a possible 410, in "
	PRINTN MOVES
	EQUAL? MOVES,1 \?L8
	PRINTI " turn."
	JUMP ?L12
?L8:	PRINTI " turns."
?L12:	CRLF
	RETURN SCORE

	.FUNCT V-SCRIPT
	GET 0,8 >STACK
	BOR STACK,1 >STACK
	PUT 0,8,STACK
	CALL COPR-NOTICE,STR?81
	CALL V-VERSION >STACK
	RSTACK

	.FUNCT V-UNSCRIPT
	CALL COPR-NOTICE,STR?82
	CALL V-VERSION
	GET 0,8 >STACK
	BAND STACK,-2 >STACK
	PUT 0,8,STACK
	RTRUE

	.FUNCT COPR-NOTICE,STRING
	PRINTI "Here "
	PRINT STRING
	PRINTI " a transcript of interaction with "
	PRINT GUIDE-NAME
	PRINTR "."

	.FUNCT V-VERSION,CNT=17,V
	GET 0,1 >STACK
	BAND STACK,2047 >V
	PRINTI "THE HITCHHIKER'S GUIDE TO THE GALAXY
Infocom interactive fiction - a science fiction story
Copyright (c) 1984 by Infocom, Inc. All rights reserved.
"
	PRINTI "Release "
	PRINTN V
	PRINTI " / Serial number "
?L5:	IGRTR? 'CNT,23 /?L6
	GETB 0,CNT >STACK
	PRINTC STACK
	JUMP ?L5
?L6:	CRLF
	RTRUE

	.FUNCT V-$0024VERIFY
	EQUAL? PRSO,INTNUM \?L1
	EQUAL? P-NUMBER,469 \?L1
	PRINTN SERIAL
	CRLF
	RTRUE
?L1:	PRINTI "Verifying..."
	CRLF
	VERIFY \?L8
	PRINTR "Good."
?L8:	CRLF
	PRINTR "** Bad **"

	.FUNCT V-AGAIN,OBJ,N=0
	ZERO? L-DONT-FLAG /?L1
	SET 'DONT-FLAG,1
	SET 'PRSA,L-PRSA
	CALL DONT-F
	RTRUE
?L1:	ZERO? L-PRSA \?L4
	PRINTR "Not until you do something."
?L4:	EQUAL? L-PRSA,V?FIND,V?FOLLOW,V?CALL /?L9
	EQUAL? L-PRSA,V?WHAT,V?WHERE,V?WHO /?L9
	EQUAL? L-PRSA,V?WAIT-FOR,V?WALK-TO,V?WHAT-ABOUT /?L9
	EQUAL? L-PRSA,V?ASK-ABOUT,V?ASK-FOR,V?I-AM /?L9
	EQUAL? L-PRSA,V?MY-NAME,V?TELL-ABOUT,V?CALL-WITH /?L9
	EQUAL? L-PRSA,V?CARVE \?L8
?L9:	PRINTI "Sorry, the Galactic Compendium on Interactive Fiction prohibits the use of AGAIN after your previous action."
	CRLF
	SET 'PRSA,V?VERBOSE
	RETURN PRSA
?L8:	EQUAL? NOT-HERE-OBJECT,L-PRSO,L-PRSI \?L12
	PRINTR "You can't see that here."
?L12:	EQUAL? L-PRSA,V?WALK \?L15
	CALL DO-WALK,L-PRSO >STACK
	RSTACK
?L15:	ZERO? L-PRSO /?L17
	CALL VISIBLE?,L-PRSO >STACK
	ZERO? STACK \?L17
	SET 'OBJ,L-PRSO
	JUMP ?L18
?L17:	ZERO? L-PRSI /?L19
	CALL VISIBLE?,L-PRSI >STACK
	ZERO? STACK \?L19
	SET 'OBJ,L-PRSI
	JUMP ?L18
?L19:	SET 'OBJ,0
?L18:	EQUAL? OBJ,0,ROOMS /?L21
	PRINTI "You can't see"
	ZERO? N /?L25
	PRINTI " any "
	PRINTD OBJ
	PRINTI " here."
	CRLF
	RETURN 2
?L25:	CALL ARTICLE,OBJ,1
	PRINTI " anymore."
	CRLF
	RETURN 2
?L21:	ZERO? L-FRONT-FLAG /?L35
	SET 'IN-FRONT-FLAG,1
?L35:	CALL PERFORM,L-PRSA,L-PRSO,L-PRSI >STACK
	RSTACK

	.FUNCT V-ALARM
	EQUAL? PRSO,ROOMS \?L1
	CALL PERFORM,V?ALARM,ME
	RTRUE
?L1:	PRINTI "I don't think"
	CALL ARTICLE,PRSO,1
	PRINTR " is sleeping."

	.FUNCT V-ANSWER
	ZERO? AWAITING-REPLY /?L3
	GET P-LEXV,P-CONT >STACK
	EQUAL? STACK,W?YES \?L1
	CALL V-YES
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L1:	ZERO? AWAITING-REPLY /?L3
	GET P-LEXV,P-CONT >STACK
	EQUAL? STACK,W?NO \?L3
	CALL V-NO
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L3:	IN? BEAST,HERE \?L4
	CALL V-SAY
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L4:	PRINTI "Nobody is awaiting your answer."
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK

	.FUNCT V-APPLAUD
	CALL RUNNING?,I-CAPTAIN >STACK
	ZERO? STACK /?L1
	PRINTR "If you want to enjoy the poetry, just type that."
?L1:	PRINTR "Thank you, thank you."

	.FUNCT V-APPRECIATE
	CALL RUNNING?,I-CAPTAIN >STACK
	ZERO? STACK /?L1
	CALL V-APPLAUD >STACK
	RSTACK
?L1:	PRINTR "Hey, I never get any appreciation! There's absolutely no job satisfaction in being a computer."

	.FUNCT V-ASK-ABOUT
	EQUAL? PRSO,ME \?L1
	CALL PERFORM,V?TELL,ME
	RTRUE
?L1:	FSET? PRSO,ACTORBIT \?L3
	PRINTI "A long silence tells you that"
	CALL ARTICLE,PRSO,1
	PRINTI " isn't interested in talking about"
	IN? PRSI,ROOMS \?L8
	PRINTI " that"
	JUMP ?L12
?L8:	CALL ARTICLE,PRSI,1
?L12:	PRINTR "."
?L3:	CALL PERFORM,V?TELL,PRSO
	RTRUE

	.FUNCT V-ASK-FOR
	PRINTI "Unsurprisingly,"
	CALL ARTICLE,PRSO,1
	PRINTR " doesn't oblige."

	.FUNCT V-BITE,?TMP
	CALL IS-PERSON? >?TMP
	ZERO? ?TMP /?L2
	PUSH ?TMP
	JUMP ?L1
?L2:	CALL IS-ANIMAL? >STACK
?L1:	CALL PRINT-ID,STR?83,STACK
	CALL IS-PART-OF-SELF? >STACK
	CALL PRINT-ID,STR?84,STACK
	CALL HACK-HACK,STR?85 >STACK
	RSTACK

	.FUNCT V-BLOCK
	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-BLOCK-WITH
	CALL V-DIG >STACK
	RSTACK

	.FUNCT PRE-BOARD
	ZERO? IN-FRONT-FLAG /?L1
	CALL PERFORM,V?STAND-BEFORE,PRSO
	RTRUE
?L1:	LOC PROTAGONIST >STACK
	EQUAL? PRSO,STACK \FALSE
	PRINT LOOK-AROUND
	CRLF
	RTRUE

	.FUNCT V-BOARD,AV
	FSET? PRSO,VEHBIT \?L1
	PRINTI "You are now in"
	CALL ARTICLE,PRSO,1
	PRINTI "."
	CRLF
	MOVE WINNER,PRSO
	EQUAL? HERE,SPEEDBOAT /?L7
	SET 'LYING-DOWN,1
?L7:	GETP PRSO,P?ACTION >STACK
	CALL STACK,M-ENTER >STACK
	RTRUE
?L1:	PRINTI "You can't get into"
	CALL ARTICLE,PRSO,1
	PRINTR "!"

	.FUNCT V-BRUSH
	ZERO? PRSI \?L1
	CALL HELD?,TOOTHBRUSH >STACK
	ZERO? STACK /?L3
	PRINTI "(with the "
	PRINTD TOOTHBRUSH
	PRINTI ")"
	CRLF
	CALL PERFORM,V?BRUSH,PRSO,TOOTHBRUSH
	RTRUE
?L3:	PRINTI "You have nothing to brush"
	CALL ARTICLE,PRSO,1
	PRINTR " with."
?L1:	EQUAL? PRSI,TOOTHBRUSH /?L12
	PRINTI "With"
	CALL ARTICLE,PRSI
	PRINTR "!"
?L12:	EQUAL? PRSO,TEETH /?L17
	PRINTI "In general, "
	PRINTD TOOTHBRUSH
	PRINTR "es are meant for teeth."
?L17:	PRINTR "Congratulations on your fine dental hygiene."

	.FUNCT V-BUY
	PRINTI "Sorry,"
	CALL ARTICLE,PRSO,1
	PRINTI " isn't for sale."
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?86,STACK >STACK
	RSTACK

	.FUNCT V-CALL
	EQUAL? HERE,BEDROOM /?L1
	PRINTR "There's no phone here!"
?L1:	ZERO? HEADACHE /?L5
	PRINTI "You reach for the receiver. "
	CALL PICK-ONE,LURCHES >STACK
	PRINT STACK
	CRLF
	RTRUE
?L5:	FSET? PHONE,TOUCHBIT \?L8
	PRINTR "The cable is down, remember?"
?L8:	EQUAL? PRSO,DAIS \?L11
	FSET PHONE,TOUCHBIT
	PRINTI "You explain your situation. The desk sergeant promises to send someone over soon, and says not to try anything crazy in the meantime, like lying down in front of the "
	PRINTD BULLDOZER
	PRINTI "."
	PRINT DIALLING-TONE
	CRLF
	RTRUE
?L11:	EQUAL? PRSO,HOME \?L14
	PRINTR "Who do you think you are, E.T.?"
?L14:	EQUAL? PRSO,MAZE \?L17
	CALL V-HELP >STACK
	RSTACK
?L17:	PRINTR "You don't know the number."

	.FUNCT V-CALL-WITH
	EQUAL? PRSI,PHONE /?L1
	PRINTI "You can't use"
	CALL ARTICLE,PRSI
	PRINTI " as a "
	PRINTD PHONE
	PRINTR "."
?L1:	CALL PERFORM,V?CALL,PRSO
	RTRUE

	.FUNCT PRE-CARVE
	CALL HELD?,STONE >STACK
	ZERO? STACK \FALSE
	PRINTR "You have no carving instrument."

	.FUNCT V-CARVE,?TMP
	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CALL IS-OBJ-PROP-ANIMAL? >?TMP
	ZERO? ?TMP /?L4
	PUSH ?TMP
	JUMP ?L3
?L4:	CALL IS-PERSON? >STACK
?L3:	CALL PRINT-ID,STR?87,STACK >STACK
	PRINT STACK
	CALL IS-PART-OF-SELF-OR-SELF? >STACK
	CALL PRINT-ID,STR?88,STACK >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT V-CARVE-WITH
	EQUAL? HERE,OUTER-LAIR \?L1
	EQUAL? PRSI,STONE \?L3
	CALL PERFORM,V?CARVE,PRSO,MEMORIAL
	RTRUE
?L3:	PRINTI "No luck;"
	CALL ARTICLE,PRSI,1
	PRINTI " doesn't even scratch the "
	PRINTD MEMORIAL
	PRINTR "."
?L1:	PRINTR "Huh?"

	.FUNCT V-CHASTISE
	PRINTR "Use prepositions to indicate precisely what you want to do: LOOK AT the object, LOOK INSIDE it, LOOK UNDER it, etc."

	.FUNCT V-CLEAN
	EQUAL? PRSO,GLOBAL-ROOM,ROOMS \?L1
	EQUAL? HERE,BEDROOM \?L1
	PRINTI "Just as you've got it all spick and span"
	CALL PRINT-ID,STR?89
	CALL BETTER-LUCK >STACK
	RSTACK
?L1:	EQUAL? PRSO,TEETH \?L5
	CALL PERFORM,V?BRUSH,TEETH
	RTRUE
?L5:	EQUAL? PRSO,TOWEL \?L7
	SET 'TOWEL-MUDDY,0
?L7:	PRINTR "It is now much cleaner."

	.FUNCT V-CLIMB-DOWN
	EQUAL? PRSO,ROOMS \?L1
	CALL DO-WALK,P?DOWN >STACK
	RSTACK
?L1:	CALL V-CARVE >STACK
	RSTACK

	.FUNCT V-CLIMB-FOO
	EQUAL? PRSO,ROOMS \?L1
	CALL DO-WALK,P?UP >STACK
	RSTACK
?L1:	CALL V-CARVE >STACK
	RSTACK

	.FUNCT V-CLIMB-ON
	FSET? PRSO,VEHBIT \?L1
	CALL PERFORM,V?BOARD,PRSO
	RTRUE
?L1:	PRINTI "You can't climb onto"
	CALL ARTICLE,PRSO,1
	PRINTR "."

	.FUNCT V-CLIMB-OVER
	CALL V-CARVE >STACK
	RSTACK

	.FUNCT V-CLIMB-UP
	EQUAL? PRSO,ROOMS \?L1
	CALL DO-WALK,P?UP >STACK
	RSTACK
?L1:	CALL V-CARVE >STACK
	RSTACK

	.FUNCT V-CLOSE
	FSET? PRSO,SURFACEBIT \?L1
	CALL V-COUNT >STACK
	RSTACK
?L1:	FSET? PRSO,ACTORBIT \?L3
	EQUAL? PRSO,SCREENING-DOOR,NUTRIMAT /?L3
	CALL V-COUNT >STACK
	RSTACK
?L3:	FSET? PRSO,DOORBIT /?L5
	FSET? PRSO,CONTBIT \?L4
?L5:	FSET? PRSO,OPENBIT \?L6
	PRINTI "Okay,"
	CALL ARTICLE,PRSO,1
	PRINTI " is now closed."
	CRLF
	FCLEAR PRSO,OPENBIT
	RTRUE
?L6:	PRINT ALREADY-CLOSED
	CRLF
	RTRUE
?L4:	CALL TELL-ME-HOW >STACK
	RSTACK

	.FUNCT V-COUNT
	CALL PICK-ONE,IMPOSSIBLES >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT V-CUT
	ZERO? PRSI \?L1
	CALL V-CARVE >STACK
	RSTACK
?L1:	PRINTI "I doubt that the ""cutting edge"" of"
	CALL ARTICLE,PRSI
	PRINTI " is adequate."
	CRLF
	CALL IS-OBJ-PROP-ANIMAL? >STACK
	CALL PRINT-ID,STR?90,STACK
	CALL IS-PART-OF-SELF-OR-SELF? >STACK
	CALL PRINT-ID,STR?91,STACK >STACK
	RSTACK

	.FUNCT V-DIG
	CALL PICK-ONE,WASTES >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT V-DISEMBARK
	FSET? PRSO,TAKEBIT \?L1
	CALL META-LOC,PRSO >STACK
	EQUAL? STACK,HERE \?L1
	IN? PRSO,HERE /?L1
	IN? PRSO,PROTAGONIST /?L1
	CALL PERFORM,V?TAKE,PRSO
	RTRUE
?L1:	LOC WINNER >STACK
	EQUAL? STACK,PRSO /?L3
	PRINT LOOK-AROUND
	CRLF
	RETURN 2
?L3:	CALL OWN-FEET
	SET 'LYING-DOWN,0
	MOVE WINNER,HERE
	RTRUE

	.FUNCT V-DOZE
	PRINTI "You doze for several minutes. "
	CALL V-WAIT >STACK
	RSTACK

	.FUNCT V-DRINK,S
	PRINTI "You can't drink that!"
	CRLF
	CALL DANGEROUS-DRINK? >STACK
	CALL PRINT-ID,STR?92,STACK >STACK
	RSTACK

	.FUNCT V-DRINK-FROM
	CALL V-COUNT >STACK
	RSTACK

	.FUNCT PRE-DROP
	CALL IDROP >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT V-DROP
	EQUAL? HERE,MAZE \?L1
	EQUAL? PRSO,THING /?L3
	SET 'BRAIN-DAMAGED,PRSO
?L3:	MOVE PRSO,LOCAL-GLOBALS
	PRINTI "As you release"
	CALL ARTICLE,PRSO,1
	PRINTR ", it vanishes into the maze of synapses."
?L1:	EQUAL? HERE,ACCESS-SPACE \?L10
	MOVE PRSO,LOCAL-GLOBALS
	PRINTI "If you recall, the floor is just an open mesh, and"
	CALL ARTICLE,PRSO,1
	PRINTR " drops through and disappears."
?L10:	MOVE PRSO,HERE
	PRINTR "Dropped."

	.FUNCT V-EAT
	PRINTI "Stuffing"
	CALL ARTICLE,PRSO,1
	PRINTI " in your mouth would do little to help at this point."
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?93,STACK
	CALL IS-ANIMAL? >STACK
	CALL PRINT-ID,STR?94,STACK
	CALL DANGEROUS-FOOD? >STACK
	CALL PRINT-ID,STR?95,STACK >STACK
	RSTACK

	.FUNCT V-ENJOY
	FSET? PRSO,ACTORBIT \?L1
	CALL PRINT-ID,STR?96
	CALL V-KISS >STACK
	RSTACK
?L1:	PRINTI "Not difficult at all, considering how enjoyable"
	CALL ARTICLE,PRSO,1
	PRINTR " is."

	.FUNCT V-ENTER,VEHICLE
	CALL FIND-IN,HERE,VEHBIT >VEHICLE
	ZERO? VEHICLE /?L1
	CALL PERFORM,V?BOARD,VEHICLE
	RTRUE
?L1:	CALL DO-WALK,P?IN >STACK
	RSTACK

	.FUNCT V-ESCAPE
	SET 'DREAMING,0
	PRINTI "You are so keen on escape that you literally leap through the fabric of the space-time continuum. You wake up in a shack on tenth-century Earth. A dressing gown, a "
	PRINTD TOOTHBRUSH
	CALL PRINT-ID,STR?97
	CALL JIGS-UP,STR?98
	RTRUE

	.FUNCT V-EXAMINE
	FSET? PRSO,DOORBIT \?L1
	CALL V-LOOK-INSIDE >STACK
	RSTACK
?L1:	FSET? PRSO,CONTBIT \?L3
	FSET? PRSO,ACTORBIT /?L3
	FSET? PRSO,OPENBIT \?L4
	CALL V-LOOK-INSIDE >STACK
	RSTACK
?L4:	PRINTR "It's closed."
?L3:	GETP PRSO,P?TEXT >STACK
	ZERO? STACK /?L9
	CALL PERFORM,V?READ,PRSO
	RTRUE
?L9:	EQUAL? PRSO,BROWNIAN-SOURCE \?L10
	CALL PERFORM,V?EXAMINE,DANGLY-BIT
	RTRUE
?L10:	FSET? PRSO,TOOLBIT \?L11
	PRINT IT-LOOKS-LIKE
	PRINTI " every other "
	PRINTD PRSO
	PRINTR " you've ever seen."
?L11:	EQUAL? PRSO,HEAD,TEETH,EYES /?L15
	EQUAL? PRSO,EARS \?L14
?L15:	PRINTR "That would involve quite a contortion."
?L14:	PRINTI "You see nothing special about"
	CALL ARTICLE,PRSO,1
	PRINTR "."

	.FUNCT V-EXAMINE-THROUGH
	PRINTR "This reveals nothing new."

	.FUNCT V-EXIT
	FSET? PRSO,VEHBIT \?L1
	CALL PERFORM,V?DISEMBARK,PRSO
	RTRUE
?L1:	CALL DO-WALK,P?OUT >STACK
	RSTACK

	.FUNCT V-FEED,FOOD
	CALL FIND-IN,PROTAGONIST,EATBIT >FOOD
	ZERO? FOOD /?L1
	PRINTI "(the "
	PRINTD FOOD
	PRINTI ")"
	CRLF
	CALL PERFORM,V?GIVE,FOOD,PRSO
	RTRUE
?L1:	PRINTI "You have nothing to feed"
	CALL ARTICLE,PRSO,1
	PRINTR " with."

	.FUNCT V-FILL
	PRINTR "Phil who?"

	.FUNCT V-FIND,WHERE=0,L
	LOC PRSO >L
	EQUAL? PRSO,EARS,HEAD,HANDS /?L3
	EQUAL? PRSO,EYES,TEETH \?L1
?L3:	PRINTI "Are you sure"
	CALL ARTICLE,PRSO,1
	PRINTR " is lost?"
?L1:	EQUAL? PRSO,ME \?L8
	PRINTI "You're in"
	CALL ARTICLE,HERE,1
	PRINTR "."
?L8:	IN? PRSO,PROTAGONIST \?L13
	PRINTR "You have it!"
?L13:	EQUAL? PRSO,PROSSER \?L16
	EQUAL? IDENTITY-FLAG,FORD \?L16
	ZERO? GONE-AROUND \?L16
	PRINTI "He's "
	PRINT ON-OTHER-SIDE
	PRINTI " of the "
	PRINTD BULLDOZER
	PRINTR "."
?L16:	IN? PRSO,HERE /?L20
	EQUAL? PRSO,PSEUDO-OBJECT /?L20
	EQUAL? PRSO,MECHANISM \?L21
	EQUAL? HERE,ACCESS-SPACE /?L20
?L21:	EQUAL? PRSO,HATCH \?L19
	EQUAL? HERE,HATCHWAY \?L19
?L20:	PRINTR "Right in front of you."
?L19:	CALL GLOBAL-IN?,PRSO,HERE >STACK
	ZERO? STACK /?L24
	PRINTR "You figure it out!"
?L24:	FSET? L,ACTORBIT \?L27
	CALL VISIBLE?,L >STACK
	ZERO? STACK /?L27
	PRINTI "As far as you can tell,"
	CALL ARTICLE,L,1
	PRINTR " has it."
?L27:	FSET? L,CONTBIT \?L32
	CALL VISIBLE?,PRSO >STACK
	ZERO? STACK /?L32
	PRINTI "It's in"
	CALL ARTICLE,L,1
	PRINTR "."
?L32:	ZERO? WHERE /?L37
	PRINTR "Beats me."
?L37:	PRINTR "You'll have to do that yourself."

	.FUNCT V-FIRST-LOOK
	CALL DESCRIBE-ROOM >STACK
	ZERO? STACK /FALSE
	EQUAL? VERBOSITY,1,2 \FALSE
	CALL DESCRIBE-OBJECTS >STACK
	RSTACK

	.FUNCT V-FLIPSWITCH
	FSET? PRSO,SWITCHBIT \?L1
	EQUAL? PRSI,INTNUM \?L1
	LESS? P-NUMBER,9 \?L1
	CALL VISIBLE?,BOARD >STACK
	ZERO? STACK /?L1
	CALL PERFORM,V?TURN,DIPSWITCH
	RTRUE
?L1:	CALL V-TELL-TIME >STACK
	RSTACK

	.FUNCT V-FOLLOW
	IN? PRSO,HERE \?L1
	PRINTI "But"
	CALL ARTICLE,PRSO,1
	PRINTR " is right here!"
?L1:	FSET? PRSO,ACTORBIT /?L7
	CALL V-COUNT >STACK
	RSTACK
?L7:	PRINTI "You have no idea where"
	CALL ARTICLE,PRSO,1
	PRINTR " is."

	.FUNCT I-FOLLOW
	SET 'FOLLOW-FLAG,0
	RFALSE

	.FUNCT V-FOOTNOTE
	ZERO? PRSO /?L3
	EQUAL? PRSO,INTNUM /?L1
?L3:	PRINTR "Specify a number, as in ""FOOTNOTE 6."""
?L1:	EQUAL? P-NUMBER,1 \?L6
	PRINTR "In case anyone is interested, this quotation is from a letter written by John Keats, and thus he becomes the first major 19th Century British poet to feature in a computer game."
?L6:	EQUAL? P-NUMBER,2 \?L9
	PRINTR "Bob Dylan, 1969."
?L9:	EQUAL? P-NUMBER,3 \?L12
	PRINTR "A meaningless coincidence."
?L12:	EQUAL? P-NUMBER,4 \?L15
	PRINTR "The first single they recorded on their own Apple label, and one of their most successful songs ever."
?L15:	EQUAL? P-NUMBER,5 \?L18
	PRINTI "Peacefully for a "
	PRINTD BEAST
	PRINTR " that is. Now and then it snorts or rolls over, and the walls shake a bit."
?L18:	EQUAL? P-NUMBER,6 \?L21
	PRINTR "That was just an example."
?L21:	EQUAL? P-NUMBER,7 \?L24
	SET 'AWAITING-REPLY,13
	CALL QUEUE,I-REPLY,1 >STACK
	PUT STACK,0,1
	CALL NOT-VERY-GOOD,STR?99 >STACK
	RSTACK
?L24:	EQUAL? P-NUMBER,8 \?L25
	SET 'AWAITING-REPLY,13
	CALL QUEUE,I-REPLY,1 >STACK
	PUT STACK,0,1
	CALL NOT-VERY-GOOD,STR?100 >STACK
	RSTACK
?L25:	EQUAL? P-NUMBER,9 \?L26
	PRINTR "Unfortunately, you couldn't hear a word of it, because sound doesn't travel in a vacuum."
?L26:	EQUAL? P-NUMBER,10 \?L29
	PRINTR "I guess it isn't all that dangerous a place after all."
?L29:	EQUAL? P-NUMBER,11 \?L32
	SET 'AWAITING-REPLY,14
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTR "Isn't it fun reading through all the footnotes?"
?L32:	EQUAL? P-NUMBER,12 \?L35
	PRINTR "This is the famous recursive footnote (Footnote 12)."
?L35:	EQUAL? P-NUMBER,13 \?L38
	SET 'AWAITING-REPLY,13
	CALL QUEUE,I-REPLY,1 >STACK
	PUT STACK,0,1
	CALL NOT-VERY-GOOD,STR?101 >STACK
	RSTACK
?L38:	EQUAL? P-NUMBER,14 \?L39
	PRINT GUIDE-NAME
	PRINTI " is also the name of a terrific work of interactive fiction by Douglas Adams and S. Eric Meretzky."
	PRINT ALREADY-KNOW-THAT
	CRLF
	RTRUE
?L39:	EQUAL? P-NUMBER,15 \?L42
	SET 'AWAITING-REPLY,13
	CALL QUEUE,I-REPLY,1 >STACK
	PUT STACK,0,1
	CALL NOT-VERY-GOOD,STR?102 >STACK
	RSTACK
?L42:	PRINTI "There is no Footnote "
	PRINTN P-NUMBER
	PRINTR "."

	.FUNCT V-FRIPPI
	PRINTR "Aaaaaaarggggghhhhhh!"

	.FUNCT V-GET-DRESSED,GARMENT
	EQUAL? PRSO,ROOMS \?L1
	EQUAL? IDENTITY-FLAG,ARTHUR \?L5
	FSET? GOWN,WORNBIT \?L3
?L5:	PRINTR "You are!"
?L3:	CALL HELD?,GOWN >STACK
	ZERO? STACK /?L8
	CALL PERFORM,V?WEAR,GOWN
	RTRUE
?L8:	CALL VISIBLE?,GOWN >STACK
	ZERO? STACK /?L9
	PRINT NOT-HOLDING
	PRINTI " "
	PRINTD GOWN
	PRINTR "."
?L9:	PRINTR "There's nothing to wear here."
?L1:	CALL V-TELL-TIME >STACK
	RSTACK

	.FUNCT V-GET-DRUNK
	EQUAL? PRSO,ROOMS \?L1
	EQUAL? HERE,PUB \?L3
	PRINTI "You get drunk and have a terrific time for twelve minutes, are the life and soul of the Pub, tell some really great stories, make everyone laugh a lot, and they all clap you on the back and tell you what a great chap you are and then the Earth gets unexpectedly demolished"
	CALL PRINT-ID,STR?103
	EQUAL? IDENTITY-FLAG,ARTHUR \?L7
	PRINTI ". You wake up with a hangover which lasts for all eternity."
	CRLF
	CALL FINISH >STACK
	RSTACK
?L7:	CALL JIGS-UP,STR?104 >STACK
	RSTACK
?L3:	EQUAL? HERE,LIVING-ROOM,DINING-ROOM,KITCHEN \?L12
	PRINT YOU-ARE
	CRLF
	RTRUE
?L12:	PRINTR "You can't see any alcohol here!"
?L1:	CALL V-TELL-TIME >STACK
	RSTACK

	.FUNCT V-GET-UNDRESSED
	ZERO? PRSO \?L1
	SET 'PRSO,ROOMS
?L1:	EQUAL? PRSO,ROOMS \?L4
	FSET? GOWN,WORNBIT \?L6
	CALL PERFORM,V?TAKE-OFF,GOWN
	RTRUE
?L6:	EQUAL? IDENTITY-FLAG,ARTHUR \?L8
	PRINTR "You're not wearing anything!"
?L8:	PRINT ARRESTED
	CRLF
	RTRUE
?L4:	CALL V-TELL-TIME >STACK
	RSTACK

	.FUNCT PRE-GIVE
	CALL IDROP >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT V-GIVE
	FSET? PRSI,ACTORBIT \?L1
	PRINTI "Politely,"
	CALL ARTICLE,PRSI,1
	PRINTR " refuses your offer."
?L1:	PRINTI "You can't give"
	CALL ARTICLE,PRSO
	PRINTI " to"
	CALL ARTICLE,PRSI
	PRINTR "!"

	.FUNCT V-GIVE-UP
	EQUAL? PRSO,ROOMS \?L1
	CALL V-QUIT >STACK
	RSTACK
?L1:	CALL V-TELL-TIME >STACK
	RSTACK

	.FUNCT V-HANG
	PRINTI "You can't hang something from"
	CALL ARTICLE,PRSI
	PRINTR "!"

	.FUNCT V-HELLO
	ZERO? PRSO /?L5
	FSET? PRSO,ACTORBIT \?L1
	PRINTR """Hello to you too."""
?L1:	ZERO? PRSO /?L5
	CALL PERFORM,V?TELL,PRSO
	RTRUE
?L5:	CALL PERFORM,V?TELL,ME
	RTRUE

	.FUNCT V-HELP
	PRINTR "If you're really stuck, a complete map and InvisiClues Hint Booklet are available from your dealer, or via mail order with the form that came in your package."

	.FUNCT V-HIDE
	PRINTR "There's no place to hide here."

	.FUNCT V-HITCHHIKE
	CALL PERFORM,V?PUSH,GREEN-BUTTON
	RTRUE

	.FUNCT V-I-AM
	PRINTR "Pleased to meet you. I'm your computer."

	.FUNCT V-IDIOT
	CALL PERFORM,V?TELL,ME
	RTRUE

	.FUNCT V-KICK,?TMP
	CALL HACK-HACK,STR?105
	CALL IS-PERSON? >?TMP
	ZERO? ?TMP /?L2
	PUSH ?TMP
	JUMP ?L1
?L2:	CALL IS-OBJ-PROP-ANIMAL? >STACK
?L1:	CALL PRINT-ID,STR?106,STACK
	CALL IS-PART-OF-SELF-OR-SELF? >STACK
	CALL PRINT-ID,STR?107,STACK >STACK
	RSTACK

	.FUNCT V-KILL,?TMP
	PRINTI "You are obviously letting things get to you. You should learn to relax a little."
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?108,STACK
	CALL IS-ANIMAL? >?TMP
	ZERO? ?TMP /?L4
	PUSH ?TMP
	JUMP ?L3
?L4:	CALL IS-OBJECT-OR-PROPERTY? >STACK
?L3:	CALL PRINT-ID,STR?109,STACK
	CALL IS-SELF? >STACK
	CALL PRINT-ID,STR?110,STACK >STACK
	RSTACK

	.FUNCT V-KNEEL
	CALL V-TASTE >STACK
	RSTACK

	.FUNCT V-KNOCK
	FSET? PRSO,DOORBIT \?L1
	PRINTR "Nobody's home."
?L1:	CALL HACK-HACK,STR?111 >STACK
	RSTACK

	.FUNCT V-KISS
	PRINTI "This is family entertainment, not a video nasty."
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?112,STACK >STACK
	RSTACK

	.FUNCT V-LAMP-OFF
	FSET? PRSO,LIGHTBIT \?L1
	FSET? PRSO,ONBIT /?L1
	PRINTR "It is already off."
?L1:	EQUAL? PRSO,INTNUM \?L5
	LESS? P-NUMBER,9 \?L5
	CALL ACCESSIBLE?,BOARD >STACK
	ZERO? STACK /?L5
	CALL PERFORM,V?TURN,DIPSWITCH
	RTRUE
?L5:	PRINTR "You can't turn that off."

	.FUNCT V-LAMP-ON
	FSET? PRSO,LIGHTBIT \?L1
	FSET? PRSO,ONBIT \?L1
	PRINTR "It is already on."
?L1:	EQUAL? PRSO,INTNUM \?L5
	LESS? P-NUMBER,9 \?L5
	CALL ACCESSIBLE?,BOARD >STACK
	ZERO? STACK /?L5
	CALL PERFORM,V?TURN,DIPSWITCH
	RTRUE
?L5:	PRINTR "You can't turn that on."

	.FUNCT V-LEAP
	ZERO? LYING-DOWN /?L1
	PRINT WHILE-LYING
	CRLF
	RTRUE
?L1:	EQUAL? HERE,CAPTAINS-QUARTERS \?L5
	CALL V-STAND >STACK
	RSTACK
?L5:	ZERO? PRSO /?L11
	IN? PRSO,HERE /?L6
	CALL V-COUNT >STACK
	RSTACK
?L6:	ZERO? PRSO \?L7
?L11:	EQUAL? HERE,SPEEDBOAT \?L7
	PRINT DONT-MIX
	CRLF
	RTRUE
?L7:	CALL V-SKIP >STACK
	RSTACK

	.FUNCT V-LEAVE
	ZERO? PRSO \?L1
	SET 'PRSO,ROOMS
?L1:	EQUAL? PRSO,ROOMS \?L4
	CALL DO-WALK,P?OUT >STACK
	RSTACK
?L4:	LOC WINNER >STACK
	EQUAL? PRSO,STACK \?L6
	CALL PERFORM,V?DISEMBARK,PRSO
	RTRUE
?L6:	CALL PERFORM,V?DROP,PRSO
	RTRUE

	.FUNCT V-LIE-DOWN
	EQUAL? HERE,CAPTAINS-QUARTERS \?L1
	CALL V-STAND >STACK
	RSTACK
?L1:	EQUAL? PRSO,ROOMS \?L3
	EQUAL? HERE,BEDROOM \?L4
	CALL PERFORM,V?LIE-DOWN,BED
	RTRUE
?L4:	CALL PERFORM,V?LIE-DOWN,GROUND
	RTRUE
?L3:	CALL PERFORM,V?BOARD,PRSO
	RTRUE

	.FUNCT V-LISTEN
	PRINTI "At the moment,"
	CALL ARTICLE,PRSO,1
	PRINTR " makes no sound."

	.FUNCT V-LOCK
	CALL V-CARVE >STACK
	RSTACK

	.FUNCT V-LOOK
	FSET? TOWEL,WORNBIT \?L1
	PRINTR "You see a towel."
?L1:	CALL DESCRIBE-ROOM,1 >STACK
	ZERO? STACK /FALSE
	CALL DESCRIBE-OBJECTS,1 >STACK
	RSTACK

	.FUNCT V-LOOK-BEHIND
	PRINTI "There is nothing behind"
	CALL ARTICLE,PRSO,1
	PRINTR "."

	.FUNCT V-LOOK-DOWN
	ZERO? LIT \?L1
	PRINT TOO-DARK
	CRLF
	RTRUE
?L1:	EQUAL? PRSO,ROOMS \?L5
	CALL PERFORM,V?EXAMINE,GROUND
	RTRUE
?L5:	CALL PERFORM,V?LOOK-INSIDE,PRSO
	RTRUE

	.FUNCT V-LOOK-INSIDE
	FSET? PRSO,ACTORBIT \?L1
	EQUAL? PRSO,SCREENING-DOOR /?L1
	PRINTR "There is nothing special to be seen."
?L1:	EQUAL? PRSO,PLOTTER,THUMB,SPARE-DRIVE \?L5
	PRINTR "You can't do that."
?L5:	FSET? PRSO,SURFACEBIT \?L8
	LOC WINNER >STACK
	EQUAL? PRSO,STACK \?L9
	CALL DESCRIBE-VEHICLE
	RTRUE
?L9:	FIRST? PRSO >STACK \?L11
	CALL PRINT-CONT,PRSO >STACK
	RSTACK
?L11:	PRINTI "There is nothing on"
	CALL ARTICLE,PRSO,1
	PRINTR "."
?L8:	FSET? PRSO,DOORBIT \?L17
	PRINTI "All you can tell is that"
	CALL ARTICLE,PRSO,1
	PRINTI " is "
	FSET? PRSO,OPENBIT \?L22
	PRINTR "open."
?L22:	PRINTR "closed."
?L17:	FSET? PRSO,CONTBIT \?L29
	LOC WINNER >STACK
	EQUAL? PRSO,STACK \?L30
	CALL DESCRIBE-VEHICLE
	RTRUE
?L30:	CALL SEE-INSIDE?,PRSO >STACK
	ZERO? STACK /?L32
	FIRST? PRSO >STACK \?L33
	CALL PRINT-CONT,PRSO >STACK
	RSTACK
?L33:	PRINTR "It's empty."
?L32:	FSET? PRSO,OPENBIT /?L38
	FIRST? PRSO >STACK \?L38
	CALL PERFORM,V?OPEN,PRSO
	RTRUE
?L38:	PRINTI "It seems that"
	CALL ARTICLE,PRSO,1
	PRINTR " is closed."
?L29:	PRINTR "You can't do that."

	.FUNCT V-LOOK-UNDER
	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L1
	FSET? PRSO,WORNBIT \?L3
	PRINTR "You're wearing it!"
?L3:	PRINTR "You're holding it!"
?L1:	PRINTI "There is nothing but "
	EQUAL? PRSO,HOOK \?L13
	PRINTI "a "
	PRINTD FISH-HOLE
	JUMP ?L23
?L13:	EQUAL? PRSO,BOAT-OBJECT \?L17
	PRINTI "water"
	JUMP ?L23
?L17:	EQUAL? PRSO,TOWEL \?L20
	FSET? TOWEL,SURFACEBIT \?L20
	PRINTI "a drain"
	JUMP ?L23
?L20:	PRINTI "dust"
?L23:	PRINTR " there."

	.FUNCT V-LOOK-UP
	ZERO? LIT \?L1
	PRINT TOO-DARK
	CRLF
	RTRUE
?L1:	EQUAL? PRSO,ROOMS \?L5
	FSET? HERE,OUTSIDEBIT \?L6
	CALL PERFORM,V?EXAMINE,SKY
	RTRUE
?L6:	CALL PERFORM,V?EXAMINE,CEILING
	RTRUE
?L5:	CALL PERFORM,V?LOOK-INSIDE,PRSO
	RTRUE

	.FUNCT V-LOWER
	CALL V-RAISE >STACK
	RSTACK

	.FUNCT V-MAKE
	PRINTI "You can't make"
	CALL ARTICLE,PRSO
	PRINTR "!"

	.FUNCT V-MOVE
	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L1
	PRINTR "Why juggle objects?"
?L1:	EQUAL? PRSO,PANEL-BLOCKER \?L5
	SET 'PANEL-BLOCKER,0
	PRINTI "Okay, it's no longer in front of the "
	PRINTD ROBOT-PANEL
	PRINTR "."
?L5:	FSET? PRSO,INTEGRALBIT \?L8
	CALL PART-OF >STACK
	RSTACK
?L8:	CALL LOC-CLOSED >STACK
	ZERO? STACK \TRUE
	FSET? PRSO,TAKEBIT \?L10
	PRINTI "Moving"
	CALL ARTICLE,PRSO,1
	PRINTR " reveals nothing."
?L10:	EQUAL? PRSO,INTNUM \?L15
	LESS? P-NUMBER,9 \?L15
	CALL ACCESSIBLE?,BOARD >STACK
	ZERO? STACK /?L15
	CALL PERFORM,V?TURN,DIPSWITCH
	RTRUE
?L15:	PRINTI "You can't move"
	CALL ARTICLE,PRSO,1
	PRINTR "."

	.FUNCT V-MUNG
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?113,STACK
	CALL IS-OBJ-PROP-ANIMAL? >STACK
	CALL PRINT-ID,STR?114,STACK
	CALL IS-PART-OF-SELF-OR-SELF? >STACK
	CALL PRINT-ID,STR?115,STACK
	CALL HACK-HACK,STR?116 >STACK
	RSTACK

	.FUNCT V-MY-NAME
	EQUAL? PRSO,NAME \?L1
	CALL V-I-AM >STACK
	RSTACK
?L1:	CALL V-TELL-TIME >STACK
	RSTACK

	.FUNCT V-NO
	EQUAL? AWAITING-REPLY,1 /FALSE
	EQUAL? AWAITING-REPLY,2 \?L3
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L3:	EQUAL? AWAITING-REPLY,3,10 \?L4
	PRINTR "I should think not."
?L4:	EQUAL? AWAITING-REPLY,4 \?L7
	PRINTR "The word ""no"" is not in our hostess' vocabulary."
?L7:	EQUAL? AWAITING-REPLY,5 \?L10
	SET 'AWAITING-REPLY,3
	CALL V-YES >STACK
	RSTACK
?L10:	EQUAL? AWAITING-REPLY,6,11 \?L11
	SET 'AWAITING-REPLY,6
	CALL V-YES >STACK
	RSTACK
?L11:	EQUAL? AWAITING-REPLY,7,8 /?L13
	EQUAL? AWAITING-REPLY,13,15 \?L12
?L13:	SET 'AWAITING-REPLY,3
	CALL V-YES >STACK
	RSTACK
?L12:	EQUAL? AWAITING-REPLY,9 \?L14
	PRINTR "I disagree."
?L14:	EQUAL? AWAITING-REPLY,12 \?L17
	CALL ENGINEER-LEAVE
	PRINTI """Think you're funny, huh?"" The "
	PRINTD ENGINEER
	PRINT ROARS-OFF
	PRINTR ", making sure to spray you with his Sub-Ethon exhaust."
?L17:	EQUAL? AWAITING-REPLY,14 \?L20
	PRINTR "Then stop."
?L20:	EQUAL? AWAITING-REPLY,16 \?L23
	PRINTR "I didn't think so."
?L23:	EQUAL? AWAITING-REPLY,18,19 \?L26
	CALL V-YES >STACK
	RSTACK
?L26:	PRINTR "You sound rather negative."

	.FUNCT V-OPEN,F,STR
	FSET? PRSO,SURFACEBIT \?L1
	CALL V-COUNT >STACK
	RSTACK
?L1:	FSET? PRSO,ACTORBIT \?L3
	EQUAL? PRSO,NUTRIMAT /?L3
	CALL V-COUNT >STACK
	RSTACK
?L3:	FSET? PRSO,CONTBIT \?L4
	FSET? PRSO,OPENBIT \?L5
	PRINT ALREADY-OPEN
	CRLF
	RTRUE
?L5:	FSET PRSO,OPENBIT
	FSET PRSO,TOUCHBIT
	FIRST? PRSO >STACK \?L12
	FSET? PRSO,TRANSBIT \?L10
?L12:	PRINTR "Opened."
?L10:	PRINTI "Opening"
	CALL ARTICLE,PRSO,1
	PRINTI " reveals"
	CALL PRINT-CONTENTS,PRSO
	PRINTR "."
?L4:	FSET? PRSO,DOORBIT \?L22
	FSET? PRSO,OPENBIT \?L23
	PRINT ALREADY-OPEN
	CRLF
	RTRUE
?L23:	PRINTI "Okay,"
	CALL ARTICLE,PRSO,1
	PRINTI " is now open."
	CRLF
	FSET PRSO,OPENBIT
	RTRUE
?L22:	CALL TELL-ME-HOW >STACK
	RSTACK

	.FUNCT V-PANIC
	PRINTR "Not surprised."

	.FUNCT V-PICK
	CALL V-COUNT >STACK
	RSTACK

	.FUNCT V-PICK-UP
	CALL PERFORM,V?TAKE,PRSO,PRSI
	RTRUE

	.FUNCT V-PLANT
	EQUAL? PRSI,FLOWERPOT \?L1
	CALL PERFORM,V?PUT,PRSO,PRSI
	RTRUE
?L1:	PRINTI "You can't plant something in"
	CALL ARTICLE,PRSI
	PRINTR "."

	.FUNCT V-PLUG
	PRINTI "You can't seem to plug"
	CALL ARTICLE,PRSO,1
	PRINTI " into"
	CALL ARTICLE,PRSI,1
	PRINTR "."

	.FUNCT V-POINT
	EQUAL? HERE,SPEEDBOAT \?L1
	CALL PERFORM,V?STEER,BOAT-OBJECT,PRSO
	RTRUE
?L1:	CALL V-STEER >STACK
	RSTACK

	.FUNCT V-POUR
	CALL V-CARVE >STACK
	RSTACK

	.FUNCT V-PROTEST
	EQUAL? HERE,FRONT-OF-HOUSE \?L1
	CALL RUNNING?,I-BULLDOZER >STACK
	ZERO? STACK /?L1
	PRINTI "Prosser says ""I wouldn't stop the "
	PRINTD BULLDOZER
	PRINTR " even if you were lying in front of it!"""
?L1:	PRINTR "To whom? About what? Why?"

	.FUNCT V-PULL-TOGETHER
	CALL V-TELL-TIME >STACK
	RSTACK

	.FUNCT V-PUSH
	EQUAL? PRSO,INTNUM \?L1
	LESS? P-NUMBER,9 \?L1
	CALL ACCESSIBLE?,BOARD >STACK
	ZERO? STACK /?L1
	CALL PERFORM,V?TURN,DIPSWITCH
	RTRUE
?L1:	CALL HACK-HACK,STR?117 >STACK
	RSTACK

	.FUNCT PRE-PUT
	EQUAL? PRSI,GROUND \?L1
	CALL PERFORM,V?DROP,PRSO
	RTRUE
?L1:	CALL HELD?,PRSI,PRSO >STACK
	ZERO? STACK /?L3
	PRINTI "You can't put"
	CALL ARTICLE,PRSO,1
	PRINTI " in"
	CALL ARTICLE,PRSI,1
	PRINTI " when"
	CALL ARTICLE,PRSI,1
	PRINTI " is already in"
	CALL ARTICLE,PRSO,1
	PRINTR "!"
?L3:	CALL IDROP >STACK
	ZERO? STACK \TRUE
	ZERO? IN-FRONT-FLAG /?L15
	CALL PERFORM,V?PUT-IN-FRONT,PRSO,PRSI
	RTRUE
?L15:	EQUAL? PRSO,TEA \?L16
	CALL PERFORM,V?POUR,TEA,PRSI
	RTRUE
?L16:	EQUAL? PRSO,BROWNIAN-SOURCE \?L17
	SET 'BROWNIAN-SOURCE,0
	CALL REMOVING-BIT
	RFALSE
?L17:	EQUAL? PRSO,PLOTTER \?L21
	ZERO? BROWNIAN-SOURCE /?L18
	SET 'BROWNIAN-SOURCE,0
	CALL REMOVING-BIT
	RFALSE
?L18:	EQUAL? PRSO,PLOTTER \?L21
	ZERO? DRIVE-TO-PLOTTER \?L20
?L21:	EQUAL? PRSO,SPARE-DRIVE \FALSE
	ZERO? DRIVE-TO-PLOTTER \?L20
	EQUAL? PRSO,SPARE-DRIVE \FALSE
	ZERO? DRIVE-TO-CONTROLS /FALSE
?L20:	PRINTR "You'll have to unplug it first."

	.FUNCT V-PUT,?TMP
	FSET? PRSI,OPENBIT /?L1
	FSET? PRSI,DOORBIT /?L1
	FSET? PRSI,CONTBIT /?L1
	FSET? PRSI,SURFACEBIT /?L1
	FSET? PRSI,VEHBIT /?L1
	PRINTI "You can't put"
	CALL ARTICLE,PRSO,1
	PRINTI " in"
	CALL ARTICLE,PRSI
	PRINTR "!"
?L1:	EQUAL? PRSI,PRSO /?L10
	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L11
	FSET? PRSO,TAKEBIT \?L10
?L11:	EQUAL? PRSI,PLOTTER,THUMB,SPARE-DRIVE \?L9
?L10:	PRINTR "How can you do that?"
?L9:	FSET? PRSI,OPENBIT /?L14
	FSET? PRSI,SURFACEBIT /?L14
	PRINTI "Inspection reveals that"
	CALL ARTICLE,PRSI,1
	PRINTI " isn't open."
	CRLF
	SET 'P-IT-OBJECT,PRSI
	RETURN P-IT-OBJECT
?L14:	IN? PRSO,PRSI \?L19
	PRINTI "I think"
	CALL ARTICLE,PRSO,1
	PRINTI " is already in"
	CALL ARTICLE,PRSI,1
	PRINTR "."
?L19:	CALL WEIGHT,PRSI >?TMP
	GETP PRSO,P?SIZE >STACK
	ADD ?TMP,STACK >?TMP
	GETP PRSI,P?SIZE >STACK
	SUB ?TMP,STACK >?TMP
	GETP PRSI,P?CAPACITY >STACK
	GRTR? ?TMP,STACK \?L26
	FSET? PRSI,VEHBIT \?L27
	CALL V-DIG >STACK
	RSTACK
?L27:	PRINTR "There's no room."
?L26:	CALL HELD?,PRSO >STACK
	ZERO? STACK \?L32
	CALL ITAKE >STACK
	EQUAL? STACK,M-FATAL,0 /TRUE
?L32:	MOVE PRSO,PRSI
	FSET PRSO,TOUCHBIT
	PRINTR "Done."

	.FUNCT V-PUT-BEHIND
	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-PUT-IN-FRONT
	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-PUT-ON
	EQUAL? PRSI,ME \?L1
	CALL PERFORM,V?WEAR,PRSO
	RTRUE
?L1:	FSET? PRSI,SURFACEBIT \?L3
	CALL V-PUT >STACK
	RSTACK
?L3:	EQUAL? PRSI,EYES,HEAD \?L4
	PRINTI "You can't cover"
	CALL ARTICLE,PRSI,1
	PRINTR " with that."
?L4:	PRINTI "There's no good surface on"
	CALL ARTICLE,PRSI,1
	PRINTR "."

	.FUNCT V-PUT-UNDER
	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-RAPE
	CALL PRINT-ID,STR?118
	CALL V-KISS >STACK
	RSTACK

	.FUNCT V-RAISE
	CALL HACK-HACK,STR?119 >STACK
	RSTACK

	.FUNCT PRE-READ
	FSET? TOWEL,WORNBIT \?L1
	EQUAL? PRSO,TOWEL /?L1
	PRINT WITH-TOWEL
	CRLF
	RTRUE
?L1:	ZERO? LIT \?L5
	EQUAL? PRSO,HANGOVER /?L5
	PRINT TOO-DARK
	CRLF
	RTRUE
?L5:	ZERO? PRSI /FALSE
	FSET? PRSI,TRANSBIT /FALSE
	PRINTI "How does one look through"
	CALL ARTICLE,PRSI
	PRINTR "?"

	.FUNCT V-READ
	FSET? PRSO,READBIT \?L1
	GETP PRSO,P?TEXT >STACK
	PRINT STACK
	CRLF
	RTRUE
?L1:	PRINTI "How can you read"
	CALL ARTICLE,PRSO
	PRINTR "?"

	.FUNCT V-REFUSE
	SET 'PRSA,V?TAKE
	CALL DONT-F >STACK
	RSTACK

	.FUNCT V-RELAX
	PRINT ZEN
	CRLF
	RTRUE

	.FUNCT V-REMOVE
	FSET? PRSO,WEARBIT \?L1
	CALL PERFORM,V?TAKE-OFF,PRSO
	RTRUE
?L1:	CALL PERFORM,V?TAKE,PRSO
	RTRUE

	.FUNCT V-REPLACE
	PRINTR "It's not in need of replacement."

	.FUNCT V-REPAIR
	EQUAL? PRSO,THUMB \?L4
	FSET? THUMB,MUNGEDBIT /?L3
?L4:	EQUAL? PRSO,HATCH \?L1
	ZERO? LANDED /?L1
?L3:	PRINTR "You have neither the tools nor the expertise."
?L1:	PRINTR "I'm not sure it's broken."

	.FUNCT V-REPLY
	PRINTI "It is hardly likely that"
	CALL ARTICLE,PRSO,1
	PRINTI " is interested."
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK

	.FUNCT V-RUB
	CALL LOC-CLOSED >STACK
	ZERO? STACK \TRUE
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?120,STACK
	CALL HACK-HACK,STR?121 >STACK
	RSTACK

	.FUNCT V-SAVE-SOMETHING
	PRINTI "Sorry, but"
	CALL ARTICLE,PRSO,1
	PRINTR " is beyond help."

	.FUNCT V-SAY,V
	ZERO? AWAITING-REPLY /?L3
	GET P-LEXV,P-CONT >STACK
	EQUAL? STACK,W?YES \?L1
	CALL V-YES
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L1:	ZERO? AWAITING-REPLY /?L3
	GET P-LEXV,P-CONT >STACK
	EQUAL? STACK,W?NO \?L3
	CALL V-NO
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L3:	IN? BEAST,HERE \?L7
	FSET? TOWEL,WORNBIT \?L4
	CALL SAID-WITH-TOWEL
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L4:	IN? BEAST,HERE \?L7
	ZERO? P-CONT \?L5
	CALL PERFORM,V?TELL,BEAST
	RTRUE
?L5:	IN? BEAST,HERE \?L7
	CALL SAID-YOUR-NAME? >STACK
	ZERO? STACK /?L6
	CALL PERFORM,V?SAY-NAME,YOUR-NAME
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L6:	IN? BEAST,HERE \?L7
	CALL PERFORM,V?SAY-NAME,BEAST-NAME
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L7:	CALL FIND-IN,HERE,ACTORBIT >V
	ZERO? V /?L8
	PRINTI "You must address"
	CALL ARTICLE,V,1
	PRINTI " directly."
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L8:	CALL PERFORM,V?TELL,ME
	CALL FUCKING-CLEAR >STACK
	RSTACK

	.FUNCT SAID-YOUR-NAME?,OFFS,LEN,WRD
	SET 'OFFS,P-CONT
	SET 'LEN,P-LEN
?L1:	DLESS? 'LEN,0 /FALSE
	GET P-LEXV,OFFS >WRD
	EQUAL? WRD,W?MY,W?NAME,W?IS /?L10
	EQUAL? WRD,W?I,W?AM,W?I$0027M /?L10
	EQUAL? WRD,W?ARTHUR,W?DENT \FALSE
	RTRUE
?L10:	ADD OFFS,2 >OFFS
	JUMP ?L1

	.FUNCT SAID-WITH-TOWEL
	PRINTI "The Beast is puzzled by a voice coming from something it can't see."
	PRINT SLOWLY-DAWNS
	CRLF
	RTRUE

	.FUNCT V-SAY-NAME
	IN? BEAST,HERE \?L1
	ZERO? NAME-TOLD /?L3
	PRINTR "You already told the Beast your name."
?L3:	FSET? TOWEL,WORNBIT \?L7
	CALL SAID-WITH-TOWEL >STACK
	RSTACK
?L7:	EQUAL? PRSO,NAME,ARTHUR,YOUR-NAME /?L9
	EQUAL? PRSO,ME \?L8
?L9:	CALL QUEUE,I-BEAST,2 >STACK
	PUT STACK,0,1
	SET 'NAME-TOLD,1
	PRINTR "The Beast roars your name with relish, and explains that once it has eaten you, your name will be added to its list of remembrance."
?L8:	PRINTR "There's something about detecting insincerity that transcends even the vast gulf between Humanity and Bugblatter Bestiality. The Beast bellows, obviously convinced that you were lying and that isn't your name nor anything remotely like it."
?L1:	PRINTR "You should use quotes with this verb."

	.FUNCT V-SEARCH
	FSET? PRSO,ACTORBIT \?L1
	PRINTR "That wouldn't be polite."
?L1:	FSET? PRSO,CONTBIT \?L11
	LOC WINNER >STACK
	EQUAL? PRSO,STACK \?L6
	CALL DESCRIBE-VEHICLE
	RTRUE
?L6:	FSET? PRSO,OPENBIT /?L8
	PRINTR "You'll have to open it first."
?L8:	FIRST? PRSO >STACK \?L11
	FIRST? PRSO >STACK /?L12
?L12:	FSET? STACK,NDESCBIT /?L11
	CALL PRINT-CONT,PRSO
	RTRUE
?L11:	PRINTR "You find nothing unusual."

	.FUNCT V-SGIVE
	CALL PERFORM,V?GIVE,PRSI,PRSO
	RTRUE

	.FUNCT V-SHAKE,X
	FSET? PRSO,ACTORBIT \?L1
	PRINTR "Be real."
?L1:	CALL HACK-HACK,STR?122 >STACK
	RSTACK

	.FUNCT V-SHAKE-WITH
	EQUAL? PRSO,HANDS /?L1
	CALL V-TELL-TIME >STACK
	RSTACK
?L1:	FSET? PRSI,ACTORBIT /?L3
	PRINTI "I don't think"
	CALL ARTICLE,PRSI,1
	PRINTR " even has hands."
?L3:	CALL PERFORM,V?THANK,PRSI
	RTRUE

	.FUNCT V-SHOOT,?TMP
	FSET? TOWEL,WORNBIT \?L1
	PRINT WITH-TOWEL
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?123,STACK
	CALL IS-OBJ-PROP-ANIMAL? >STACK
	CALL PRINT-ID,STR?124,STACK
	CALL IS-PART-OF-SELF? >STACK
	ZERO? STACK \?L6
	PUSH 0
	JUMP ?L8
?L6:	EQUAL? PRSO,HEAD /?L7
	PUSH 1
	JUMP ?L8
?L7:	PUSH 0
?L8:	CALL PRINT-ID,STR?125,STACK
	EQUAL? PRSO,ME,BRAIN,HEAD /?L9
	PUSH 0
	JUMP ?L10
?L9:	PUSH 1
?L10:	CALL PRINT-ID,STR?126,STACK
	RTRUE
?L1:	ZERO? PRSO \?L17
	CALL HELD?,BEAST-GUN >STACK
	ZERO? STACK /?L14
	SET 'PRSO,BEAST-GUN
	JUMP ?L17
?L14:	CALL HELD?,BLASTER >STACK
	ZERO? STACK /?L16
	SET 'PRSO,BLASTER
	JUMP ?L17
?L16:	PRINTR "With what? At whom? Why?"
?L17:	ZERO? PRSI \?L21
	EQUAL? PRSO,BLASTER,BEAST-GUN \?L23
	PRINTR "Some rays shoot out of the gun."
?L23:	CALL HELD?,BEAST-GUN >STACK
	ZERO? STACK /?L27
	CALL PERFORM,V?SHOOT,PRSO,BEAST-GUN
	RTRUE
?L27:	CALL HELD?,BLASTER >STACK
	ZERO? STACK /?L28
	CALL PERFORM,V?SHOOT,PRSO,BLASTER
	RTRUE
?L28:	PRINTI "You have nothing to shoot"
	CALL ARTICLE,PRSO,1
	PRINTI " with."
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?127,STACK
	CALL IS-OBJ-PROP-ANIMAL? >STACK
	CALL PRINT-ID,STR?128,STACK
	CALL IS-PART-OF-SELF? >STACK
	ZERO? STACK \?L35
	PUSH 0
	JUMP ?L37
?L35:	EQUAL? PRSO,HEAD /?L36
	PUSH 1
	JUMP ?L37
?L36:	PUSH 0
?L37:	CALL PRINT-ID,STR?129,STACK
	EQUAL? PRSO,ME,BRAIN,HEAD /?L38
	PUSH 0
	JUMP ?L39
?L38:	PUSH 1
?L39:	CALL PRINT-ID,STR?130,STACK >STACK
	RSTACK
?L21:	EQUAL? PRSI,BEAST-GUN \?L40
	PRINTI "Some rays from the gun strike"
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?131,STACK
	CALL IS-OBJ-PROP-ANIMAL? >STACK
	CALL PRINT-ID,STR?132,STACK
	CALL IS-PART-OF-SELF-OR-SELF? >STACK
	CALL PRINT-ID,STR?133,STACK
	CALL ARTICLE,PRSO,1
	PRINTI ", but "
	EQUAL? PRSO,BEAST \?L45
	FSET? BEAST,MUNGEDBIT /?L45
	INC 'GUN-COUNTER
	PRINTI "it only seems to make it madder"
	EQUAL? GUN-COUNTER,3 \?L49
	PRINTI " (Footnote 7)"
?L49:	PRINTR "."
?L45:	PRINTR "nothing else happens."
?L40:	PRINTI "Don't ever bother applying for a job as an armaments expert."
	CRLF
	CALL IS-PERSON? >?TMP
	ZERO? ?TMP /?L63
	PUSH ?TMP
	JUMP ?L62
?L63:	CALL IS-OBJ-PROP-ANIMAL? >STACK
?L62:	CALL PRINT-ID,STR?134,STACK
	CALL IS-PART-OF-SELF-OR-SELF? >STACK
	CALL PRINT-ID,STR?135,STACK >STACK
	RSTACK

	.FUNCT V-SHOW
	PRINTI "I doubt"
	CALL ARTICLE,PRSI,1
	PRINTR " is interested."

	.FUNCT V-SIT,VEHICLE
	CALL FIND-IN,HERE,VEHBIT >VEHICLE
	ZERO? VEHICLE /?L1
	CALL PERFORM,V?BOARD,VEHICLE
	RTRUE
?L1:	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-SKIP
	SET 'AWAITING-REPLY,15
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTR "Wasn't that fun?"

	.FUNCT V-SLEEP,TOLD?=0
	EQUAL? HERE,BEDROOM \?L1
	PRINTI "You nod off and are wakened briefly a few hours later as"
	CALL BETTER-LUCK >STACK
	RSTACK
?L1:	EQUAL? HERE,HOLD \?L5
	PRINTR "You try, but the grubby mattresses are too repulsive."
?L5:	PRINTR "There's no bed here."

	.FUNCT V-SMELL
	PRINTI "It smells just like"
	CALL ARTICLE,PRSO
	PRINTI "."
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?136,STACK >STACK
	RSTACK

	.FUNCT V-SMILE
	EQUAL? HERE,CAPTAINS-QUARTERS \?L1
	IN? POETRY,HERE \?L1
	CALL V-APPLAUD >STACK
	RSTACK
?L1:	PRINTR "How nice."

	.FUNCT V-SPIN
	PRINTR "You can't spin that!"

	.FUNCT V-SPUT-ON
	EQUAL? PRSO,EARS \?L1
	CALL VISIBLE?,POETRY >STACK
	ZERO? STACK /?L1
	CALL PERFORM,V?LISTEN,POETRY
	RTRUE
?L1:	CALL PERFORM,V?PUT-ON,PRSI,PRSO
	RTRUE

	.FUNCT V-SSHOOT
	CALL PERFORM,V?SHOOT,PRSI,PRSO
	RTRUE

	.FUNCT V-SSHOW
	CALL PERFORM,V?SHOW,PRSI,PRSO
	RTRUE

	.FUNCT V-STAND
	LOC WINNER >STACK
	FSET? STACK,VEHBIT \?L1
	LOC WINNER >STACK
	CALL PERFORM,V?DISEMBARK,STACK
	RTRUE
?L1:	ZERO? LYING-DOWN /?L3
	SET 'LYING-DOWN,0
	CALL RUNNING?,I-PROSSER >STACK
	ZERO? STACK /?L4
	PRINTI "You are safe! Prosser heaves a visible sigh of relief, shakes his head and wipes his brow. "
	PRINT BULLDOZER-PILES
	CRLF
	CALL BRICK-DEATH >STACK
	RSTACK
?L4:	EQUAL? HERE,FRONT-OF-HOUSE \?L8
	ZERO? PROSSER-LYING \?L8
	IN? FLEET,HERE /?L8
	PRINTI "The "
	PRINTD BULLDOZER-DRIVER
	PRINTI " gives a quick chew of his gum and slams in the clutch. "
	PRINT BULLDOZER-PILES
	CRLF
	CALL BRICK-DEATH >STACK
	RSTACK
?L8:	CALL OWN-FEET >STACK
	RSTACK
?L3:	ZERO? PRSO /?L12
	FSET? PRSO,TAKEBIT \?L12
	CALL V-DIG >STACK
	RSTACK
?L12:	PRINTR "You are already standing."

	.FUNCT V-STAND-BEFORE
	EQUAL? PRSO,DISPENSER \?L1
	PRINTR "The slot is too wide to block that way."
?L1:	EQUAL? PRSO,HOOK,ROBOT-PANEL,FISH-HOLE \?L5
	PRINTI "You'd never be able to push the "
	PRINTD DISPENSER-BUTTON
	PRINTI " from there."
	PRINT GETTING-CLOSE
	CRLF
	RTRUE
?L5:	EQUAL? PRSO,HOME,HOUSE,BULLDOZER \?L8
	EQUAL? IDENTITY-FLAG,ARTHUR \?L8
	PRINTI "The "
	PRINTD BULLDOZER
	PRINTI " could easily maneuver around you."
	PRINT GETTING-CLOSE
	CRLF
	RTRUE
?L8:	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-STAND-ON
	ZERO? IN-FRONT-FLAG /?L1
	CALL PERFORM,V?STAND-BEFORE,PRSO
	RTRUE
?L1:	CALL V-DIG >STACK
	RSTACK

	.FUNCT V-STEER
	PRINTR "That would be pointless."

	.FUNCT PRE-TAKE
	EQUAL? PRSO,GOWN \?L4
	ZERO? GOWN-HUNG /?L4
	ZERO? LYING-DOWN \?L3
?L4:	EQUAL? PRSO,TOWEL \?L1
	FSET? TOWEL,SURFACEBIT \?L1
	ZERO? LYING-DOWN /?L1
?L3:	PRINT WHILE-LYING
	CRLF
	RTRUE
?L1:	EQUAL? PRSO,BABEL-FISH /FALSE
	CALL LOC-CLOSED >STACK
	ZERO? STACK \TRUE
	EQUAL? PRSO,DANGLY-BIT \?L11
	EQUAL? PRSI,BROWNIAN-SOURCE \?L11
	ZERO? PRSI \?L10
?L11:	EQUAL? PRSO,SMALL-PLUG \?L12
	EQUAL? PRSI,SMALL-RECEPTACLE,PLOTTER \?L12
	ZERO? DRIVE-TO-PLOTTER \?L10
?L12:	EQUAL? PRSO,LARGE-PLUG \?L9
	EQUAL? PRSI,LARGE-RECEPTACLE,CONTROLS \?L9
	ZERO? DRIVE-TO-CONTROLS /?L9
?L10:	CALL PERFORM,V?REMOVE,PRSO
	RTRUE
?L9:	FSET? PRSO,INTEGRALBIT \?L13
	LOC PRSO >STACK
	EQUAL? PRSI,STACK /FALSE
?L13:	IN? PRSO,PROTAGONIST /?L15
	CALL HELD?,PRSO >STACK
	ZERO? STACK /?L14
	FSET? PRSO,TAKEBIT /?L14
?L15:	FSET? PRSO,WORNBIT \?L16
	PRINTR "You are already wearing it."
?L16:	PRINTR "You already have it."
?L14:	ZERO? PRSI /?L23
	EQUAL? PRSI,ME \?L24
	CALL PERFORM,V?DROP,PRSO
	RTRUE
?L24:	EQUAL? PRSO,ITEM-ON-SATCHEL \?L26
	EQUAL? PRSI,SATCHEL /FALSE
?L26:	EQUAL? PRSO,ITEM-DROPPED-AT-PARTY \?L27
	EQUAL? PRSI,HOSTESS /FALSE
?L27:	LOC PRSO >STACK
	EQUAL? PRSI,STACK /?L28
	PRINTI "But"
	CALL ARTICLE,PRSO,1
	PRINTI " isn't "
	FSET? PRSI,ACTORBIT \?L33
	EQUAL? PRSI,SCREENING-DOOR,NUTRIMAT /?L33
	PRINTI "being held by"
	JUMP ?L40
?L33:	FSET? PRSI,SURFACEBIT \?L37
	PRINTI "on"
	JUMP ?L40
?L37:	PRINTI "in"
?L40:	CALL ARTICLE,PRSI,1
	PRINTR "."
?L28:	SET 'PRSI,0
	RFALSE
?L23:	LOC WINNER >STACK
	EQUAL? PRSO,STACK \?L46
	PRINTR "You are in it!"
?L46:	ZERO? HEADACHE /FALSE
	EQUAL? PRSO,GOWN /FALSE
	FSET? PRSO,TAKEBIT \FALSE
	CALL HELD?,PRSO >STACK
	ZERO? STACK \FALSE
	CALL PICK-ONE,LURCHES >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT V-TAKE
	CALL ITAKE >STACK
	EQUAL? STACK,1 \FALSE
	EQUAL? PRSO,JACKET-FLUFF \?L3
	FSET? JACKET-FLUFF,TRYTAKEBIT \?L3
	FCLEAR JACKET-FLUFF,TRYTAKEBIT
	FCLEAR JACKET-FLUFF,NDESCBIT
	SET 'FLUFF-REMOVED,1
	CALL QUEUE,I-ZAPHOD,6 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-ARTHUR,2 >STACK
	PUT STACK,0,1
	PRINTI "You remove the "
	PRINTD JACKET-FLUFF
	PRINTR ", improving Arthur's appearance greatly. He is clearly touched, and starts happily to chat away to you. You discover that he is only slightly more interesting to talk to than an averagely interesting wall."
?L3:	EQUAL? PRSO,ITEM-DROPPED-AT-PARTY \?L8
	FCLEAR ITEM-DROPPED-AT-PARTY,NDESCBIT
	CALL HELD?,WINE >STACK
	ZERO? STACK \?L10
	SET 'ITEM-DROPPED-AT-PARTY,WINE
	FCLEAR HOSTESS,TOUCHBIT
	JUMP ?L16
?L10:	CALL HELD?,HANDBAG >STACK
	ZERO? STACK \?L12
	SET 'ITEM-DROPPED-AT-PARTY,HANDBAG
	FCLEAR HOSTESS,TOUCHBIT
	JUMP ?L16
?L12:	CALL HELD?,APPETIZERS >STACK
	ZERO? STACK \?L13
	SET 'ITEM-DROPPED-AT-PARTY,APPETIZERS
	FCLEAR HOSTESS,TOUCHBIT
	JUMP ?L16
?L13:	SET 'ITEM-DROPPED-AT-PARTY,0
	FCLEAR HOSTESS,NDESCBIT
	JUMP ?L16
?L8:	EQUAL? PRSO,GOWN \?L15
	ZERO? GOWN-HUNG /?L15
	FCLEAR GOWN,TRYTAKEBIT
	FCLEAR GOWN,NDESCBIT
	FSET GOWN,OPENBIT
	SET 'GOWN-HUNG,0
	JUMP ?L16
?L15:	EQUAL? PRSO,PANEL-BLOCKER \?L16
	SET 'PANEL-BLOCKER,0
	FCLEAR PRSO,TRYTAKEBIT
	FCLEAR PRSO,NDESCBIT
?L16:	EQUAL? PRSO,SATCHEL \?L18
	ZERO? ITEM-ON-SATCHEL /?L18
	MOVE ITEM-ON-SATCHEL,HERE
	FCLEAR ITEM-ON-SATCHEL,NDESCBIT
	FCLEAR ITEM-ON-SATCHEL,TRYTAKEBIT
	SET 'ITEM-ON-SATCHEL,0
	JUMP ?L20
?L18:	EQUAL? PRSO,ITEM-ON-SATCHEL \?L20
	FCLEAR ITEM-ON-SATCHEL,NDESCBIT
	FCLEAR ITEM-ON-SATCHEL,TRYTAKEBIT
	SET 'ITEM-ON-SATCHEL,0
?L20:	PRINTI "Taken."
	CRLF
	CALL IS-THEFT? >STACK
	CALL PRINT-ID,STR?137,STACK >STACK
	RSTACK

	.FUNCT V-TAKE-OFF
	FSET? PRSO,WORNBIT \?L1
	FCLEAR PRSO,WORNBIT
	PRINTI "Okay, you're no longer wearing"
	CALL ARTICLE,PRSO,1
	PRINTR "."
?L1:	PRINTR "You aren't wearing that!"

	.FUNCT V-TASTE
	PRINTR "You can't. At least, not in this game you can't."

	.FUNCT V-TELL
	FSET? PRSO,ACTORBIT \?L1
	ZERO? P-CONT /?L3
	SET 'WINNER,PRSO
	LOC WINNER >HERE
	RTRUE
?L3:	PRINTI "Hmmm ..."
	CALL ARTICLE,PRSO,1
	PRINTR " looks at you expectantly, as if you seemed to be about to talk."
?L1:	PRINTI "You can't talk to"
	CALL ARTICLE,PRSO
	PRINTI "!"
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK

	.FUNCT V-TELL-ABOUT
	EQUAL? PRSO,ME \?L1
	CALL PERFORM,V?WHAT,PRSI
	RTRUE
?L1:	PRINTI "It doesn't look like"
	CALL ARTICLE,PRSO,1
	PRINTR " is interested."

	.FUNCT V-TELL-TIME
	PRINTR "That sentence isn't one I recognise."

	.FUNCT V-TELL-NAME
	CALL V-TELL-TIME >STACK
	RSTACK

	.FUNCT V-THANK
	FSET? PRSO,ACTORBIT \?L1
	PRINTI "You do so, but"
	CALL ARTICLE,PRSO,1
	PRINTR " seems less than overjoyed."
?L1:	CALL V-CARVE >STACK
	RSTACK

	.FUNCT V-THROUGH,M
	FSET? PRSO,DOORBIT \?L1
	CALL OTHER-SIDE,PRSO >STACK
	CALL DO-WALK,STACK
	RTRUE
?L1:	FSET? PRSO,VEHBIT \?L3
	CALL PERFORM,V?BOARD,PRSO
	RTRUE
?L3:	FSET? PRSO,TAKEBIT /?L4
	PRINTI "You hit your head against"
	CALL ARTICLE,PRSO,1
	PRINTR " as you attempt this feat."
?L4:	IN? PRSO,WINNER \?L9
	CALL PERFORM,V?EXAMINE,EYES
	RTRUE
?L9:	CALL V-CARVE >STACK
	RSTACK

	.FUNCT PRE-THROW
	EQUAL? PRSO,INTNUM \?L1
	LESS? P-NUMBER,9 \?L1
	CALL ACCESSIBLE?,BOARD >STACK
	ZERO? STACK /?L1
	CALL PERFORM,V?TURN,DIPSWITCH
	RTRUE
?L1:	FSET? PRSO,SWITCHBIT /FALSE
	CALL IDROP >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT V-THROW
	EQUAL? HERE,HOLD \?L1
	MOVE PRSO,LOCAL-GLOBALS
	PRINT ROBOT-FLIES-IN
	PRINTI "collects"
	CALL ARTICLE,PRSO,1
	PRINTR " in mid-air, and flashes away."
?L1:	EQUAL? HERE,MAZE,ACCESS-SPACE \?L7
	CALL PERFORM,V?DROP,PRSO
	RTRUE
?L7:	ZERO? PRSI /?L8
	MOVE PRSO,HERE
	PRINTR "You missed."
?L8:	MOVE PRSO,HERE
	PRINTR "Thrown."

	.FUNCT V-THROW-OFF
	PRINTR "You can't do that!"

	.FUNCT V-THROW-IN-TOWEL
	EQUAL? PRSO,TOWEL \?L1
	CALL V-QUIT >STACK
	RSTACK
?L1:	CALL V-TELL-TIME >STACK
	RSTACK

	.FUNCT V-TIE
	PRINTI "You can't tie"
	CALL ARTICLE,PRSO
	PRINTR "."

	.FUNCT V-TIE-TOGETHER
	EQUAL? PRSO,SLEEVES \?L1
	CALL PERFORM,V?TIE,SLEEVES
	RTRUE
?L1:	CALL V-TELL-TIME >STACK
	RSTACK

	.FUNCT V-TURN
	EQUAL? PRSO,BOAT-OBJECT \?L1
	PRINTR "Try: STEER BOAT TOWARD (something)."
?L1:	EQUAL? PRSO,ROOMS,ME \?L5
	CALL V-SKIP >STACK
	RSTACK
?L5:	EQUAL? PRSO,INTNUM \?L6
	LESS? P-NUMBER,9 \?L6
	CALL ACCESSIBLE?,BOARD >STACK
	ZERO? STACK /?L6
	CALL PERFORM,V?TURN,DIPSWITCH
	RTRUE
?L6:	PRINTR "This has no effect."

	.FUNCT V-TYPE
	EQUAL? HERE,HOLD /?L1
	PRINTI "There's no "
	PRINTD KEYBOARD
	PRINTI " in sight."
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L1:	ZERO? POEM-ENJOYED \?L5
	ZERO? P-CONT /?L5
	CALL PERFORM,V?MUNG,GLASS-CASE
	RTRUE
?L5:	GET P-LEXV,P-CONT >STACK
	EQUAL? STACK,W?FRIPPI \?L6
	EQUAL? LINE-NUMBER,1,2 \?L6
	EQUAL? WORD-NUMBER,1 \?L6
	CALL GLASS-CASE-OPENS >STACK
	RSTACK
?L6:	GET P-LEXV,P-CONT >STACK
	EQUAL? STACK,W?LYSHUS \?L7
	EQUAL? LINE-NUMBER,1,2 \?L7
	EQUAL? WORD-NUMBER,2 \?L7
	CALL GLASS-CASE-OPENS >STACK
	RSTACK
?L7:	GET P-LEXV,P-CONT >STACK
	EQUAL? STACK,W?WIMBGU \?L8
	EQUAL? LINE-NUMBER,1,2 \?L8
	EQUAL? WORD-NUMBER,3 \?L8
	CALL GLASS-CASE-OPENS >STACK
	RSTACK
?L8:	GET P-LEXV,P-CONT >STACK
	EQUAL? STACK,W?GASHEE \?L9
	EQUAL? LINE-NUMBER,3,4 \?L9
	EQUAL? WORD-NUMBER,1 \?L9
	CALL GLASS-CASE-OPENS >STACK
	RSTACK
?L9:	GET P-LEXV,P-CONT >STACK
	EQUAL? STACK,W?MORPHO \?L10
	EQUAL? LINE-NUMBER,3,4 \?L10
	EQUAL? WORD-NUMBER,2 \?L10
	CALL GLASS-CASE-OPENS >STACK
	RSTACK
?L10:	GET P-LEXV,P-CONT >STACK
	EQUAL? STACK,W?THOU \?L11
	EQUAL? LINE-NUMBER,3,4 \?L11
	EQUAL? WORD-NUMBER,3 \?L11
	CALL GLASS-CASE-OPENS >STACK
	RSTACK
?L11:	GET P-LEXV,P-CONT >STACK
	EQUAL? STACK,W?BLEEM \?L12
	EQUAL? LINE-NUMBER,5,6 \?L12
	EQUAL? WORD-NUMBER,1 \?L12
	CALL GLASS-CASE-OPENS >STACK
	RSTACK
?L12:	GET P-LEXV,P-CONT >STACK
	EQUAL? STACK,W?MISERA \?L13
	EQUAL? LINE-NUMBER,5,6 \?L13
	EQUAL? WORD-NUMBER,2 \?L13
	CALL GLASS-CASE-OPENS >STACK
	RSTACK
?L13:	GET P-LEXV,P-CONT >STACK
	EQUAL? STACK,W?VENCHI \?L14
	EQUAL? LINE-NUMBER,5,6 \?L14
	EQUAL? WORD-NUMBER,3 \?L14
	CALL GLASS-CASE-OPENS >STACK
	RSTACK
?L14:	ZERO? P-CONT \?L15
	PRINTR "You didn't specify what you wanted to type."
?L15:	CALL PERFORM,V?MUNG,GLASS-CASE
	RETURN 2

	.FUNCT V-TYPE-ON
	EQUAL? PRSO,KEYBOARD \?L1
	SET 'P-CONT,0
	CALL V-TYPE >STACK
	RSTACK
?L1:	PRINTR "You can't type on that!"

	.FUNCT V-UNLOCK
	CALL V-CARVE >STACK
	RSTACK

	.FUNCT V-UNPLUG
	EQUAL? PRSO,SMALL-PLUG,LARGE-PLUG,SPARE-DRIVE /?L3
	EQUAL? PRSO,PLOTTER \?L1
?L3:	PRINT NOT-PLUGGED
	CRLF
	RTRUE
?L1:	CALL V-COUNT >STACK
	RSTACK

	.FUNCT V-UNTIE
	CALL V-CARVE >STACK
	RSTACK

	.FUNCT V-WALK,PT,PTS,STR,OBJ,RM
	IN? FLEET,HERE \?L1
	EQUAL? PRSO,P?DOWN,P?UP /?L1
	PRINTR "You would be no safer there."
?L1:	ZERO? LYING-DOWN /?L5
	PRINT WHILE-LYING
	CRLF
	RTRUE
?L5:	FSET? TOWEL,WORNBIT \?L8
	SET 'BEARINGS-LOST,1
	PRINTI "You stumble in that direction, but as you can't see where you're going you wander around in circles."
	FSET? BEAST,MUNGEDBIT /?L11
	PRINTI " The Beast is getting puzzled that something it can't see is stumbling around its lair."
	PRINT SLOWLY-DAWNS
?L11:	CRLF
	RTRUE
?L8:	EQUAL? HERE,MAZE /?L16
	EQUAL? IDENTITY-FLAG,ARTHUR \?L16
	ZERO? BRAIN-DAMAGED /?L16
	RANDOM 100 >STACK
	LESS? 30,STACK /?L16
	PRINTI "You notice that you can't remember how to walk. Oddly, as you think about walking, all that comes to mind is an image of"
	CALL ARTICLE,BRAIN-DAMAGED
	PRINTR "."
?L16:	ZERO? P-WALK-DIR \?L21
	CALL PERFORM,V?WALK-TO,PRSO
	RTRUE
?L21:	GETPT HERE,PRSO >PT
	ZERO? PT /?L22
	PTSIZE PT >PTS
	EQUAL? PTS,UEXIT \?L23
	GETB PT,REXIT >STACK
	CALL GOTO,STACK >STACK
	RSTACK
?L23:	EQUAL? PTS,NEXIT \?L25
	GET PT,NEXITSTR >STACK
	PRINT STACK
	CRLF
	RETURN 2
?L25:	EQUAL? PTS,FEXIT \?L30
	GET PT,FEXITFCN >STACK
	CALL STACK >RM
	ZERO? RM /?L31
	CALL GOTO,RM >STACK
	RSTACK
?L31:	EQUAL? HERE,BRIDGE \?L33
	EQUAL? P-WALK-DIR,P?WEST /TRUE
?L33:	RETURN 2
?L30:	EQUAL? PTS,CEXIT \?L37
	GETB PT,CEXITFLAG >STACK
	VALUE STACK >STACK
	ZERO? STACK /?L38
	GETB PT,REXIT >STACK
	CALL GOTO,STACK >STACK
	RSTACK
?L38:	GET PT,CEXITSTR >STR
	ZERO? STR /?L40
	PRINT STR
	CRLF
	RETURN 2
?L40:	PRINT CANT-GO
	CRLF
	RETURN 2
?L37:	EQUAL? PTS,DEXIT \FALSE
	GETB PT,DEXITOBJ >OBJ
	FSET? OBJ,OPENBIT \?L51
	GETB PT,REXIT >STACK
	CALL GOTO,STACK >STACK
	RSTACK
?L51:	GET PT,DEXITSTR >STR
	ZERO? STR /?L53
	PRINT STR
	CRLF
	SET 'P-IT-OBJECT,OBJ
	RETURN 2
?L53:	PRINTI "The "
	PRINTD OBJ
	PRINTI " is closed."
	CRLF
	SET 'P-IT-OBJECT,OBJ
	RETURN 2
?L22:	EQUAL? PRSO,P?IN,P?OUT \?L65
	CALL V-WALK-AROUND
	RETURN 2
?L65:	PRINT CANT-GO
	CRLF
	RETURN 2

	.FUNCT V-WALK-AROUND
	SET 'AWAITING-REPLY,16
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTR "Did you have any particular direction in mind?"

	.FUNCT V-WALK-TO
	IN? PRSO,HERE /?L3
	CALL GLOBAL-IN?,PRSO,HERE >STACK
	ZERO? STACK /?L1
?L3:	EQUAL? PRSO,HOSTESS,TRILLIAN \?L4
	PRINTI "She"
	JUMP ?L11
?L4:	FSET? PRSO,ACTORBIT \?L8
	EQUAL? PRSO,BEAST,SCREENING-DOOR,NUTRIMAT /?L8
	PRINTI "He"
	JUMP ?L11
?L8:	PRINTI "It"
?L11:	PRINTR "'s here!"
?L1:	CALL V-WALK-AROUND >STACK
	RSTACK

	.FUNCT V-WAIT,NUM=3
	PRINTI "Time passes..."
	CRLF
?L3:	DLESS? 'NUM,0 /?L4
	CALL CLOCKER >STACK
	ZERO? STACK /?L3
?L4:	SET 'CLOCK-WAIT,1
	RETURN CLOCK-WAIT

	.FUNCT V-WAIT-FOR
	PRINTR "You may be waiting quite a while."

	.FUNCT V-WATER
	PRINTR "It doesn't need watering."

	.FUNCT V-WAVE
	CALL V-CARVE >STACK
	RSTACK

	.FUNCT V-WAVE-AT
	ZERO? PRSO \?L1
	CALL V-SMILE >STACK
	RSTACK
?L1:	PRINTI "Despite your friendly nature,"
	CALL ARTICLE,PRSO,1
	PRINTR " isn't likely to respond."

	.FUNCT V-WEAR
	FSET? PRSO,WEARBIT /?L1
	PRINTI "You can't wear"
	CALL ARTICLE,PRSO,1
	PRINTR "."
?L1:	FSET? PRSO,WORNBIT \?L7
	PRINTI "You're already wearing"
	CALL ARTICLE,PRSO,1
	PRINTR "!"
?L7:	MOVE PRSO,PROTAGONIST
	FSET PRSO,WORNBIT
	PRINTI "You are now wearing"
	CALL ARTICLE,PRSO,1
	PRINTR "."

	.FUNCT V-WHAT
	PRINTR "Good question."

	.FUNCT V-WHAT-ABOUT
	PRINTR "Well, what about it?"

	.FUNCT V-WHAT-TIME
	CALL V-TELL-TIME >STACK
	RSTACK

	.FUNCT V-WHERE
	CALL V-FIND,1 >STACK
	RSTACK

	.FUNCT V-WHO
	FSET? PRSO,ACTORBIT \?L1
	CALL PERFORM,V?WHAT,PRSO
	RTRUE
?L1:	PRINTR "That's not a person!"

	.FUNCT V-WHY
	PRINTR "Why not?"

	.FUNCT V-YELL
	PRINTR "You begin to get a sore throat."

	.FUNCT V-YES
	EQUAL? AWAITING-REPLY,1 \?L1
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L1:	EQUAL? AWAITING-REPLY,2 /FALSE
	EQUAL? AWAITING-REPLY,3 \?L4
	PRINTR "Well, tough."
?L4:	EQUAL? AWAITING-REPLY,4 \?L7
	CALL PERFORM,V?TAKE,ITEM-DROPPED-AT-PARTY
	RTRUE
?L7:	EQUAL? AWAITING-REPLY,5 \?L8
	PRINTR "So do I."
?L8:	EQUAL? AWAITING-REPLY,6,8,11 /?L12
	EQUAL? AWAITING-REPLY,13,14,15 \?L11
?L12:	PRINTR "That was just a rhetorical question."
?L11:	EQUAL? AWAITING-REPLY,7,9 \?L15
	PRINTR "Well, good for you!"
?L15:	EQUAL? AWAITING-REPLY,10 \?L18
	CALL PERFORM,V?ENJOY,FORD
	RTRUE
?L18:	EQUAL? AWAITING-REPLY,12 \?L19
	CALL QUEUE,I-ENGINEER,2 >STACK
	PUT STACK,0,1
	PRINTR """Well, let's see the malfunctioning equipment."""
?L19:	EQUAL? AWAITING-REPLY,16 \?L22
	PRINTR "Then type it."
?L22:	EQUAL? AWAITING-REPLY,18,19 \?L25
	PRINTR """Well, leave me alone then! I'm busy!"""
?L25:	PRINTR "You sound rather positive."

	.FUNCT ITAKE,VB=1,CNT,OBJ,?TMP
	FSET? PRSO,INTEGRALBIT \?L1
	ZERO? VB /?L3
	CALL PART-OF
?L3:	RETURN 2
?L1:	FSET? PRSO,TAKEBIT /?L8
	ZERO? VB /?L9
	CALL V-CARVE
?L9:	RETURN 2
?L8:	EQUAL? IDENTITY-FLAG,TRILLIAN \?L14
	CALL CCOUNT,PROTAGONIST >STACK
	GRTR? STACK,2 \?L14
	ZERO? VB /?L15
	PRINTI "As is the case so often at parties, you find that you are holding too much and can't pick up anything else."
	CRLF
?L15:	RETURN 2
?L14:	LOC PRSO >STACK
	IN? STACK,WINNER /?L32
	CALL WEIGHT,PRSO >?TMP
	CALL WEIGHT,WINNER >STACK
	ADD ?TMP,STACK >STACK
	GRTR? STACK,100 \?L23
	ZERO? VB /?L25
	PRINTI "Your load is too heavy."
	CRLF
?L25:	RETURN 2
?L23:	CALL CCOUNT,WINNER >CNT
	GRTR? CNT,7 \?L32
	MUL CNT,8 >?TMP
	RANDOM 100 >STACK
	LESS? ?TMP,STACK /?L32
	ZERO? VB /?L33
	PRINTI "You're holding too much already."
	CRLF
?L33:	RETURN 2
?L32:	MOVE PRSO,PROTAGONIST
	FSET PRSO,TOUCHBIT
	RTRUE

	.FUNCT IDROP
	EQUAL? PRSO,HANGOVER /FALSE
	EQUAL? PRSO,NO-TEA \?L3
	ZERO? HOLDING-NO-TEA \FALSE
?L3:	EQUAL? PRSO,SMALL-PLUG,LARGE-PLUG,DANGLY-BIT \?L4
	EQUAL? PRSA,V?PUT-ON,V?PUT /FALSE
?L4:	EQUAL? PRSA,V?GIVE \?L5
	EQUAL? PRSO,SPEECH /FALSE
?L5:	EQUAL? PRSO,SLEEVES \?L6
	CALL V-DIG >STACK
	RSTACK
?L6:	EQUAL? PRSO,HANDS,EARS,EYES /?L8
	EQUAL? PRSO,HEAD \?L7
?L8:	EQUAL? PRSA,V?GIVE,V?THROW,V?DROP \?L9
	CALL V-COUNT >STACK
	RSTACK
?L9:	EQUAL? PRSA,V?PUT-ON \FALSE
	EQUAL? PRSI,SATCHEL \FALSE
	CALL V-COUNT >STACK
	RSTACK
?L7:	EQUAL? PRSO,SPARE-DRIVE \?L13
	EQUAL? PRSI,CONTROLS,SMALL-RECEPTACLE,LARGE-RECEPTACLE /FALSE
	EQUAL? PRSI,PLOTTER /FALSE
?L13:	CALL HELD?,PRSO >STACK
	ZERO? STACK \?L15
	PRINTI "That's easy for you to say since you don't even have"
	CALL ARTICLE,PRSO,1
	PRINTR "."
?L15:	EQUAL? PRSO,PLANT \?L20
	CALL PERFORM,V?DROP,FLOWERPOT
	RTRUE
?L20:	FSET? PRSO,INTEGRALBIT \?L21
	CALL PART-OF >STACK
	RSTACK
?L21:	IN? PRSO,WINNER /?L22
	LOC PRSO >STACK
	FSET? STACK,CONTBIT \?L22
	LOC PRSO >STACK
	FSET? STACK,OPENBIT /?L22
	PRINTI "Impossible because"
	LOC PRSO >STACK
	CALL ARTICLE,STACK,1
	PRINTR " is closed."
?L22:	EQUAL? PRSO,BABEL-FISH \?L29
	EQUAL? PRSA,V?SHOW \?L28
?L29:	FSET? PRSO,WORNBIT \FALSE
?L28:	PRINTR "You'll have to remove it first."

	.FUNCT CCOUNT,OBJ,CNT=0,X
	FIRST? OBJ >X \?L4
?L3:	FSET? X,WORNBIT /?L5
	EQUAL? X,BABEL-FISH /?L5
	INC 'CNT
?L5:	NEXT? X >X /?L3
?L4:	RETURN CNT

	.FUNCT WEIGHT,OBJ,CONT,WT=0
	FIRST? OBJ >CONT \?L4
?L3:	EQUAL? OBJ,PLAYER \?L8
	FSET? CONT,WORNBIT \?L5
	INC 'WT
	JUMP ?L9
?L5:	EQUAL? OBJ,PLAYER \?L8
	LOC CONT >STACK
	FSET? STACK,WORNBIT \?L7
	INC 'WT
	JUMP ?L9
?L7:	EQUAL? OBJ,PLAYER \?L8
	EQUAL? CONT,BABEL-FISH \?L8
	INC 'WT
	JUMP ?L9
?L8:	CALL WEIGHT,CONT >STACK
	ADD WT,STACK >WT
?L9:	NEXT? CONT >CONT /?L3
?L4:	GETP OBJ,P?SIZE >STACK
	ADD WT,STACK >STACK
	RSTACK

	.FUNCT DESCRIBE-ROOM,LOOK?=0,V?,STR,AV
	SET 'V?,LOOK?
	ZERO? V? \?L4
	EQUAL? VERBOSITY,2 /?L3
	SET 'V?,0
	JUMP ?L4
?L3:	SET 'V?,1
?L4:	ZERO? LIT \?L5
	PRINTI "It is pitch black."
	CRLF
	RFALSE
?L5:	FSET? HERE,TOUCHBIT /?L10
	FSET HERE,TOUCHBIT
	SET 'V?,1
?L10:	IN? HERE,ROOMS \?L17
	PRINTD HERE
	LOC WINNER >AV
	ZERO? LYING-DOWN \?L17
	FSET? AV,VEHBIT /?L17
	CRLF
?L17:	ZERO? LOOK? \?L23
	EQUAL? VERBOSITY,1,2 \TRUE
?L23:	FSET? AV,VEHBIT \?L24
	PRINTI ", in the "
	PRINTD AV
	CRLF
	JUMP ?L28
?L24:	ZERO? LYING-DOWN /?L28
	PRINTI ", lying down"
	CRLF
?L28:	ZERO? V? /?L34
	GETP HERE,P?ACTION >STACK
	CALL STACK,M-LOOK >STACK
	ZERO? STACK \TRUE
	ZERO? V? /?L34
	GETP HERE,P?LDESC >STR
	ZERO? STR /?L34
	PRINT STR
	CRLF
	JUMP ?L37
?L34:	GETP HERE,P?ACTION >STACK
	CALL STACK,M-FLASH >STACK
?L37:	EQUAL? HERE,AV /TRUE
	FSET? AV,VEHBIT \TRUE
	GETP AV,P?ACTION >STACK
	CALL STACK,M-LOOK >STACK
	RTRUE

	.FUNCT DESCRIBE-OBJECTS,V?=0
	ZERO? LIT /?L1
	FIRST? HERE >STACK \FALSE
	ZERO? V? \?L8
	EQUAL? VERBOSITY,2 /?L7
	SET 'V?,0
	JUMP ?L8
?L7:	SET 'V?,1
?L8:	CALL PRINT-CONT,HERE,V?,-1 >STACK
	RSTACK
?L1:	PRINT TOO-DARK
	CRLF
	RTRUE

	.FUNCT DESCRIBE-OBJECT,OBJ,V?,LEVEL,STR=0,AV
	ZERO? LEVEL \?L8
	GETP OBJ,P?DESCFCN >STACK
	CALL STACK,M-OBJDESC >STACK
	ZERO? STACK \TRUE
	ZERO? LEVEL \?L8
	FSET? OBJ,TOUCHBIT /?L5
	GETP OBJ,P?FDESC >STR
	ZERO? STR \?L4
?L5:	GETP OBJ,P?LDESC >STR
	ZERO? STR /?L3
?L4:	PRINT STR
	JUMP ?L38
?L3:	ZERO? LEVEL \?L8
	PRINTI "There is"
	CALL ARTICLE,OBJ
	PRINTI " here."
	JUMP ?L38
?L8:	GET INDENTS,LEVEL >STACK
	PRINT STACK
	FSET? OBJ,NARTICLEBIT /?L21
	FSET? OBJ,VOWELBIT \?L18
	PRINTI "an "
	JUMP ?L21
?L18:	PRINTI "a "
?L21:	PRINTD OBJ
	FSET? OBJ,WORNBIT \?L26
	PRINTI " (being worn)"
	JUMP ?L38
?L26:	EQUAL? OBJ,BABEL-FISH \?L30
	PRINTI " (in your ear)"
	JUMP ?L38
?L30:	EQUAL? OBJ,PLOTTER \?L33
	ZERO? BROWNIAN-SOURCE /?L33
	PRINTI " (suspended in"
	CALL ARTICLE,BROWNIAN-SOURCE
	PRINTI ")"
	JUMP ?L38
?L33:	EQUAL? OBJ,SPARE-DRIVE \?L38
	ZERO? DRIVE-TO-PLOTTER \?L39
	ZERO? DRIVE-TO-CONTROLS /?L38
?L39:	PRINTI " (connected to"
	ZERO? DRIVE-TO-PLOTTER /?L46
	PRINTI " the plotter"
	ZERO? DRIVE-TO-CONTROLS /?L52
	PRINTI " and"
?L46:	ZERO? DRIVE-TO-CONTROLS /?L52
	PRINTI " the control console"
?L52:	PRINTI ")"
?L38:	ZERO? LEVEL \?L60
	FSET? OBJ,ACTORBIT /?L60
	LOC WINNER >AV
	ZERO? AV /?L60
	FSET? AV,VEHBIT \?L60
	PRINTI " (outside the "
	PRINTD AV
	PRINTI ")"
?L60:	CRLF
	CALL SEE-INSIDE?,OBJ >STACK
	ZERO? STACK /FALSE
	FIRST? OBJ >STACK \FALSE
	CALL PRINT-CONT,OBJ,V?,LEVEL >STACK
	RSTACK

	.FUNCT PRINT-CONT,OBJ,V?=0,LEVEL=0,Y,1ST?=1,AV=0,STR,PV?=0,INV?=0,SC?1=0
	FIRST? OBJ >Y \TRUE
	LOC WINNER >STACK
	FSET? STACK,VEHBIT \?L4
	LOC WINNER >AV
?L4:	LOC OBJ >STACK
	EQUAL? PROTAGONIST,OBJ,STACK \?L7
	SET 'INV?,1
	JUMP ?L11
?L7:	ZERO? Y \?L12
?L59:	ZERO? 1ST? \?L14
	PUSH 1
	JUMP ?L11
?L14:	PUSH 0
	JUMP ?L11
?L12:	EQUAL? Y,AV \?L16
	SET 'PV?,1
	JUMP ?L24
?L16:	EQUAL? Y,WINNER /?L24
	FSET? Y,INVISIBLE /?L24
	FSET? Y,TOUCHBIT /?L24
	GETP Y,P?FDESC >STR
	ZERO? STR /?L24
	FSET? Y,NDESCBIT /?L19
	PRINT STR
	CRLF
?L19:	CALL SEE-INSIDE?,Y >STACK
	ZERO? STACK /?L24
	LOC Y >STACK
	GETP STACK,P?DESCFCN >STACK
	ZERO? STACK \?L24
	FIRST? Y >STACK \?L24
	CALL PRINT-CONT,Y,V?,0
?L24:	NEXT? Y >Y /?L12
	JUMP ?L59
?L11:	FIRST? OBJ >Y /?L32
?L58:	ZERO? PV? /?L34
	ZERO? AV /?L34
	FIRST? AV >STACK \?L34
	CALL PRINT-CONT,AV,V?,LEVEL
?L34:	ZERO? 1ST? \FALSE
	RTRUE
?L32:	EQUAL? Y,AV,PROTAGONIST /?L54
	FSET? Y,INVISIBLE /?L54
	ZERO? INV? \?L41
	FSET? Y,TOUCHBIT /?L41
	GETP Y,P?FDESC >STACK
	ZERO? STACK \?L54
?L41:	EQUAL? Y,STONE \?L42
	EQUAL? HERE,OUTER-LAIR \?L42
	IN? Y,HERE \?L42
	FSET Y,NDESCBIT
	JUMP ?L54
?L42:	FSET? Y,NDESCBIT /?L44
	ZERO? 1ST? /?L45
	CALL FIRSTER,OBJ,LEVEL >STACK
	ZERO? STACK /?L49
	LESS? LEVEL,0 \?L49
	SET 'LEVEL,0
?L49:	INC 'LEVEL
	SET '1ST?,0
?L45:	CALL DESCRIBE-OBJECT,Y,V?,LEVEL
	JUMP ?L54
?L44:	FIRST? Y >STACK \?L54
	CALL SEE-INSIDE?,Y >STACK
	ZERO? STACK /?L54
	CALL PRINT-CONT,Y,V?,LEVEL
?L54:	NEXT? Y >Y /?L32
	JUMP ?L58

	.FUNCT PRINT-CONTENTS,OBJ,F,N,1ST?=1,IT?=0,TWO?=0
	FIRST? OBJ >F \FALSE
?L3:	NEXT? F >N /?L5
?L5:	ZERO? 1ST? /?L6
	SET '1ST?,0
	JUMP ?L11
?L6:	PRINTI ","
	ZERO? N \?L11
	PRINTI " and"
?L11:	CALL ARTICLE,F
	ZERO? IT? \?L16
	ZERO? TWO? \?L16
	SET 'IT?,F
	JUMP ?L18
?L16:	SET 'TWO?,1
	SET 'IT?,0
?L18:	SET 'F,N
	ZERO? F \?L3
	ZERO? IT? /TRUE
	ZERO? TWO? \TRUE
	SET 'P-IT-OBJECT,IT?
	RTRUE

	.FUNCT FIRSTER,OBJ,LEVEL
	EQUAL? OBJ,WINNER /TRUE
	IN? OBJ,ROOMS /FALSE
	GRTR? LEVEL,0 \?L4
	GET INDENTS,LEVEL >STACK
	PRINT STACK
?L4:	FSET? OBJ,SURFACEBIT \?L9
	PRINTI "Sitting on the "
	PRINTD OBJ
	PRINTR " is:"
?L9:	FSET? OBJ,ACTORBIT \?L13
	EQUAL? OBJ,NUTRIMAT /?L13
	PRINT IT-LOOKS-LIKE
	CALL ARTICLE,OBJ,1
	PRINTR " is holding:"
?L13:	PRINT IT-LOOKS-LIKE
	CALL ARTICLE,OBJ,1
	PRINTR " contains:"

	.FUNCT DESCRIBE-VEHICLE
	MOVE PROTAGONIST,ROOMS
	FIRST? PRSO >STACK \?L1
	CALL PRINT-CONT,PRSO
	JUMP ?L3
?L1:	PRINTI "It's empty (not counting you)."
	CRLF
?L3:	MOVE PROTAGONIST,PRSO
	RTRUE

	.FUNCT GOTO,RM,V?=1
	MOVE PROTAGONIST,RM
	SET 'HERE,RM
	EQUAL? HERE,DARK /?L1
	MOVE NAME,HERE
?L1:	CALL LIT?,HERE >LIT
	CALL UNPLUG-HELD-STUFF
	GETP HERE,P?ACTION >STACK
	CALL STACK,M-ENTER >STACK
	ZERO? V? /TRUE
	EQUAL? HERE,RM \TRUE
	CALL V-FIRST-LOOK
	RTRUE

	.FUNCT UNPLUG-HELD-STUFF
	ZERO? DRIVE-TO-CONTROLS /?L1
	CALL HELD?,SPARE-DRIVE >STACK
	ZERO? STACK /?L1
	SET 'DRIVE-TO-CONTROLS,0
	FCLEAR SPARE-DRIVE,NDESCBIT
	PRINTI "(unplugging the spare drive first)"
	CRLF
?L1:	CALL HOLDING-ONE-BUT-NOT-BOTH?,SPARE-DRIVE,PLOTTER >STACK
	ZERO? STACK /?L6
	ZERO? DRIVE-TO-PLOTTER /?L6
	SET 'DRIVE-TO-PLOTTER,0
	PRINTI "(disconnecting the short cord first)"
	CRLF
?L6:	CALL HOLDING-ONE-BUT-NOT-BOTH?,BROWNIAN-SOURCE,PLOTTER >STACK
	ZERO? STACK /FALSE
	ZERO? BROWNIAN-SOURCE /FALSE
	SET 'BROWNIAN-SOURCE,0
	CALL REMOVING-BIT >STACK
	RSTACK

	.FUNCT JIGS-UP,DESC
	PRINT DESC
	ZERO? DREAMING /?L3
	PRINTI " Everything becomes..."
	CRLF
	CRLF
	EQUAL? IDENTITY-FLAG,FORD \?L7
	CALL ROB,PROTAGONIST,LOCAL-GLOBALS
	GET FORD-TABLE,4 >STACK
	ZERO? STACK /?L9
	FSET THUMB,MUNGEDBIT
?L9:	CALL ROB,MEMORIAL,PROTAGONIST
	GET FORD-TABLE,0 >STACK
	MOVE SATCHEL,STACK
	GET FORD-TABLE,1 >STACK
	MOVE THUMB,STACK
	GET FORD-TABLE,2 >STACK
	MOVE GUIDE,STACK
	GET FORD-TABLE,3 >STACK
	MOVE TOWEL,STACK
	GET FORD-TABLE,5 >STACK
	MOVE MINERAL-WATER,STACK
	FSET? COUNTRY-LANE,REVISITBIT /?L12
	MOVE SATCHEL-FLUFF,SATCHEL
?L12:	FCLEAR SATCHEL,OPENBIT
	FCLEAR COUNTRY-LANE,NDESCBIT
	SET 'TOWEL-OFFERED,0
	SET 'GONE-AROUND,0
	CALL INT,I-ARTHUR >STACK
	PUT STACK,0,0
	CALL LEAVE-EARTH
	JUMP ?L43
?L7:	EQUAL? IDENTITY-FLAG,TRILLIAN \?L15
	GET PARTY-TABLE,0 >STACK
	MOVE HANDBAG,STACK
	IN? TWEEZERS,HANDBAG \?L16
	GET PARTY-TABLE,1 >STACK
	MOVE TWEEZERS,STACK
?L16:	GET PARTY-TABLE,2 >STACK
	ZERO? STACK /?L19
	FSET HANDBAG,OPENBIT
	JUMP ?L21
?L19:	FCLEAR HANDBAG,OPENBIT
?L21:	FSET? LIVING-ROOM,REVISITBIT /?L22
	MOVE JACKET-FLUFF,LOCAL-GLOBALS
	FSET JACKET-FLUFF,TRYTAKEBIT
	FSET JACKET-FLUFF,NDESCBIT
	SET 'FLUFF-REMOVED,0
	FCLEAR HOSTESS,NDESCBIT
?L22:	CALL ROB,RAMP,HANDBAG
	FCLEAR LIVING-ROOM,TOUCHBIT
	FCLEAR HANDBAG,NDESCBIT
	FCLEAR WINE,NDESCBIT
	FCLEAR APPETIZERS,NDESCBIT
	MOVE WINE,LOCAL-GLOBALS
	MOVE APPETIZERS,LOCAL-GLOBALS
	SET 'TRILLIAN-PROB,10
	SET 'ITEM-DROPPED-AT-PARTY,0
	CALL INT,I-ARTHUR >STACK
	PUT STACK,0,0
	CALL INT,I-ZAPHOD >STACK
	PUT STACK,0,0
	CALL INT,I-HOSTESS >STACK
	PUT STACK,0,0
	JUMP ?L43
?L15:	EQUAL? IDENTITY-FLAG,ZAPHOD \?L25
	SET 'BOAT-DOCKED,0
	SET 'BOAT-COUNTER,0
	SET 'CRASH-COUNTER,0
	SET 'DAIS-COUNTER,0
	MOVE GUARDS,LOCAL-GLOBALS
	MOVE BLASTER,LOCAL-GLOBALS
	MOVE RIFLES,LOCAL-GLOBALS
	FCLEAR SPEEDBOAT,TOUCHBIT
	FSET RIFLES,NDESCBIT
	CALL INT,I-GUARDS >STACK
	PUT STACK,0,0
	CALL INT,I-SPEEDBOAT >STACK
	PUT STACK,0,0
	FSET? SPEEDBOAT,REVISITBIT /?L26
	MOVE TOOLBOX,SPEEDBOAT
	MOVE CUSHION-FLUFF,LOCAL-GLOBALS
	MOVE KEY,LOCAL-GLOBALS
?L26:	CALL ROB,PROTAGONIST,LOCAL-GLOBALS
	JUMP ?L43
?L25:	EQUAL? HERE,INSIDE-WHALE \?L29
	CALL ROB,INSIDE-WHALE,BULLDOZER
	MOVE WHALE-OBJECT,INSIDE-WHALE
	CALL HELD?,FLOWERPOT,THING >STACK
	ZERO? STACK \?L30
	MOVE FLOWERPOT,HERE
?L30:	CALL ROB,PROTAGONIST,BULLDOZER
	FCLEAR INSIDE-WHALE,TOUCHBIT
	IN? GOWN,BULLDOZER \?L33
	FSET? GOWN,WORNBIT \?L33
	MOVE GOWN,PROTAGONIST
?L33:	IN? BABEL-FISH,BULLDOZER \?L43
	MOVE BABEL-FISH,PROTAGONIST
	JUMP ?L43
?L29:	EQUAL? HERE,WAR-CHAMBER,MAZE \?L39
	CALL INT,I-DOG >STACK
	PUT STACK,0,0
	FCLEAR WAR-CHAMBER,TOUCHBIT
	MOVE THIRD-PLANET,LOCAL-GLOBALS
	SET 'DOG-COUNTER,0
	EQUAL? HERE,WAR-CHAMBER \?L43
	CALL ROB,WAR-CHAMBER,LOCAL-GLOBALS
	MOVE AWL,HERE
	MOVE GGUGVUNT,HERE
	MOVE VLHURG,HERE
	MOVE CANOPY,HERE
	MOVE MICROSCOPIC-FLEET,HERE
	MOVE OTHER-PLANETS,HERE
	FCLEAR VLHURG,MUNGEDBIT
	JUMP ?L43
?L39:	EQUAL? HERE,LAIR,INNER-LAIR,OUTER-LAIR \?L43
	FCLEAR BEAST,MUNGEDBIT
	SET 'BEAST-COUNTER,0
	SET 'BEARINGS-LOST,0
	SET 'NAME-TOLD,0
	FCLEAR TOWEL,WORNBIT
	FCLEAR LAIR,NDESCBIT
	MOVE STONE,OUTER-LAIR
	MOVE BEAST,LAIR
	CALL INT,I-BEAST >STACK
	PUT STACK,0,0
?L43:	SET 'TEA-COUNTER,0
	MOVE MAIN-DRIVE,GLOBAL-OBJECTS
	SET 'HEART-PROB,100
	CALL GOTO,DARK >STACK
	RSTACK
?L3:	CRLF
	CRLF
	PRINTI "    ****  You have died  ****"
	CRLF
	CRLF
	CALL FINISH >STACK
	RSTACK

	.FUNCT ACCESSIBLE?,OBJ,L
	LOC OBJ >L
	FSET? OBJ,INVISIBLE /FALSE
	EQUAL? OBJ,PSEUDO-OBJECT \?L3
	EQUAL? LAST-PSEUDO-LOC,HERE \FALSE
	RTRUE
?L3:	ZERO? L /FALSE
	EQUAL? L,GLOBAL-OBJECTS /TRUE
	EQUAL? L,LOCAL-GLOBALS \?L9
	CALL GLOBAL-IN?,OBJ,HERE >STACK
	ZERO? STACK \TRUE
?L9:	CALL META-LOC,OBJ >STACK
	EQUAL? STACK,HERE \FALSE
	EQUAL? L,WINNER,HERE /TRUE
	FSET? L,OPENBIT \FALSE
	CALL ACCESSIBLE?,L >STACK
	ZERO? STACK /FALSE
	RTRUE

	.FUNCT VISIBLE?,OBJ,L
	LOC OBJ >L
	CALL ACCESSIBLE?,OBJ >STACK
	ZERO? STACK \TRUE
	CALL SEE-INSIDE?,L >STACK
	ZERO? STACK /FALSE
	CALL VISIBLE?,L >STACK
	ZERO? STACK /FALSE
	RTRUE

	.FUNCT META-LOC,OBJ
?L1:	ZERO? OBJ /FALSE
	IN? OBJ,GLOBAL-OBJECTS \?L5
	RETURN GLOBAL-OBJECTS
?L5:	IN? OBJ,ROOMS \?L7
	RETURN OBJ
?L7:	LOC OBJ >OBJ
	JUMP ?L1

	.FUNCT OTHER-SIDE,DOBJ,P=0,TEE
?L1:	NEXTP HERE,P >P
	LESS? P,P?OUT /FALSE
	GETPT HERE,P >TEE
	PTSIZE TEE >STACK
	EQUAL? STACK,DEXIT \?L1
	GETB TEE,DEXITOBJ >STACK
	EQUAL? STACK,DOBJ \?L1
	RETURN P

	.FUNCT HELD?,OBJ,CONT=0
	ZERO? CONT \?L1
	SET 'CONT,WINNER
?L1:	ZERO? OBJ /FALSE
	IN? OBJ,CONT /TRUE
	IN? OBJ,ROOMS /FALSE
	IN? OBJ,GLOBAL-OBJECTS /FALSE
	LOC OBJ >STACK
	CALL HELD?,STACK,CONT >STACK
	RSTACK

	.FUNCT SEE-INSIDE?,OBJ
	FSET? OBJ,INVISIBLE /FALSE
	FSET? OBJ,TRANSBIT /TRUE
	FSET? OBJ,OPENBIT /TRUE
	RFALSE

	.FUNCT GLOBAL-IN?,OBJ1,OBJ2,TEE
	GETPT OBJ2,P?GLOBAL >TEE
	ZERO? TEE /FALSE
	PTSIZE TEE >STACK
	DEC 'STACK
	CALL ZMEMQB,OBJ1,TEE,STACK >STACK
	RSTACK

	.FUNCT FIND-IN,WHERE,WHAT,W
	FIRST? WHERE >W \FALSE
?L2:	FSET? W,WHAT \?L7
	RETURN W
?L7:	NEXT? W >W /?L2
	RFALSE

	.FUNCT LOC-CLOSED
	LOC PRSO >STACK
	FSET? STACK,CONTBIT \FALSE
	LOC PRSO >STACK
	FSET? STACK,OPENBIT /FALSE
	FSET? PRSO,TAKEBIT \FALSE
	PRINTI "But"
	LOC PRSO >STACK
	CALL ARTICLE,STACK,1
	PRINTR " is closed!"

	.FUNCT DO-WALK,DIR
	SET 'P-WALK-DIR,DIR
	CALL PERFORM,V?WALK,DIR >STACK
	RSTACK

	.FUNCT FUCKING-CLEAR
	SET 'P-CONT,0
	SET 'QUOTE-FLAG,0
	RETURN 2

	.FUNCT ROB,WHO,WHERE=0,N,X
	FIRST? WHO >X /?L4
	RTRUE
?L1:	ZERO? X /TRUE
?L4:	NEXT? X >N /?L7
?L7:	MOVE X,WHERE
	SET 'X,N
	JUMP ?L1

	.FUNCT HOLDING-ONE-BUT-NOT-BOTH?,ONE,TWO
	CALL HELD?,ONE >STACK
	ZERO? STACK /?L1
	CALL HELD?,TWO >STACK
	ZERO? STACK \FALSE
?L1:	CALL HELD?,ONE >STACK
	ZERO? STACK \TRUE
	CALL HELD?,TWO >STACK
	ZERO? STACK /FALSE
	RTRUE

	.FUNCT HACK-HACK,STR
	PRINT STR
	CALL ARTICLE,PRSO,1
	CALL PICK-ONE,HO-HUM >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT ARTICLE,OBJ,THE=0
	ZERO? OBJ \?L1
	SET 'OBJ,NOT-HERE-OBJECT
?L1:	FSET? OBJ,NARTICLEBIT /?L13
	ZERO? THE /?L6
	PRINTI " the"
	JUMP ?L13
?L6:	FSET? OBJ,VOWELBIT \?L10
	PRINTI " an"
	JUMP ?L13
?L10:	PRINTI " a"
?L13:	PRINTI " "
	PRINTD OBJ
	RTRUE

	.FUNCT RUNNING?,RTN,C,E,TICK
	ADD C-TABLE,C-TABLELEN >E
	ADD C-TABLE,C-INTS >C
?L1:	EQUAL? C,E /FALSE
	GET C,C-RTN >STACK
	EQUAL? STACK,RTN \?L9
	GET C,C-ENABLED? >STACK
	ZERO? STACK /FALSE
	GET C,C-TICK >TICK
	ZERO? TICK /FALSE
	GRTR? TICK,1 \TRUE
	RFALSE
?L9:	ADD C,C-INTLEN >C
	JUMP ?L1

	.FUNCT PICK-ONE,FROB
	GET FROB,0 >STACK
	RANDOM STACK >STACK
	GET FROB,STACK >STACK
	RSTACK

	.FUNCT GO
START::
?L0:	PUTB P-LEXV,0,59
	CALL QUEUE,I-HOUSEWRECK,20 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-THING,21 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-VOGONS,50 >STACK
	PUT STACK,0,1
	SET 'WINNER,PROTAGONIST
	SET 'PLAYER,PROTAGONIST
	SET 'HERE,BEDROOM
	SET 'IDENTITY-FLAG,ARTHUR
	MOVE ARTHUR,GLOBAL-OBJECTS
	SET 'LYING-DOWN,1
	MOVE PROTAGONIST,BED
	CALL V-VERSION
	CRLF
	PRINTI "You wake up. The room is spinning very gently round your head. Or at least it would be if you could see it which you can't."
	CRLF
	CRLF
	CALL V-LOOK
	CALL MAIN-LOOP
	JUMP ?L0

	.FUNCT MAIN-LOOP,ICNT,OCNT,NUM,CNT,OBJ,TBL,V,PTBL,OBJ1,TMP
?L1:	SET 'CNT,0
	SET 'OBJ,0
	SET 'PTBL,1
	CALL PARSER >P-WON
	ZERO? P-WON /?L3
	GET P-PRSI,P-MATCHLEN >ICNT
	GET P-PRSO,P-MATCHLEN >OCNT
	ZERO? P-IT-OBJECT /?L5
	CALL ACCESSIBLE?,P-IT-OBJECT >STACK
	ZERO? STACK /?L5
	SET 'TMP,0
?L7:	IGRTR? 'CNT,ICNT /?L8
	GET P-PRSI,CNT >STACK
	EQUAL? STACK,IT \?L7
	PUT P-PRSI,CNT,P-IT-OBJECT
	SET 'TMP,1
?L8:	ZERO? TMP \?L18
	SET 'CNT,0
?L17:	IGRTR? 'CNT,OCNT /?L18
	GET P-PRSO,CNT >STACK
	EQUAL? STACK,IT \?L17
	PUT P-PRSO,CNT,P-IT-OBJECT
?L18:	SET 'CNT,0
?L5:	ZERO? OCNT \?L27
	SET 'NUM,OCNT
	JUMP ?L34
?L27:	GRTR? OCNT,1 \?L29
	SET 'TBL,P-PRSO
	ZERO? ICNT \?L30
	SET 'OBJ,0
	JUMP ?L32
?L30:	GET P-PRSI,1 >OBJ
?L32:	SET 'NUM,OCNT
	JUMP ?L34
?L29:	GRTR? ICNT,1 \?L33
	SET 'PTBL,0
	SET 'TBL,P-PRSI
	GET P-PRSO,1 >OBJ
	SET 'NUM,ICNT
	JUMP ?L34
?L33:	SET 'NUM,1
?L34:	ZERO? OBJ \?L35
	EQUAL? ICNT,1 \?L35
	GET P-PRSI,1 >OBJ
?L35:	EQUAL? PRSA,V?WALK \?L38
	CALL PERFORM,PRSA,PRSO >V
	JUMP ?L63
?L38:	ZERO? NUM \?L40
	GETB P-SYNTAX,P-SBITS >STACK
	BAND STACK,P-SONUMS >STACK
	ZERO? STACK \?L41
	CALL PERFORM,PRSA >V
	SET 'PRSO,0
	JUMP ?L63
?L41:	ZERO? LIT \?L43
	PRINT TOO-DARK
	CRLF
	CALL FUCKING-CLEAR
	JUMP ?L63
?L43:	PRINTI "There isn't anything to "
	GET P-ITBL,P-VERBN >TMP
	EQUAL? PRSA,V?TELL \?L49
	PRINTI "talk to"
	JUMP ?L55
?L49:	ZERO? P-OFLAG \?L54
	ZERO? P-MERGED /?L53
?L54:	GET TMP,0 >STACK
	PRINTB STACK
	JUMP ?L55
?L53:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
?L55:	PRINTI "!"
	CRLF
	SET 'V,0
	CALL FUCKING-CLEAR
	JUMP ?L63
?L40:	SET 'P-NOT-HERE,0
	SET 'P-MULT,0
	GRTR? NUM,1 \?L59
	SET 'P-MULT,1
?L59:	SET 'TMP,0
?L62:	IGRTR? 'CNT,NUM \?L64
	GRTR? P-NOT-HERE,0 \?L66
	PRINTI "The "
	EQUAL? P-NOT-HERE,NUM /?L70
	PRINTI "other "
?L70:	PRINTI "object"
	EQUAL? P-NOT-HERE,1 /?L77
	PRINTI "s"
?L77:	PRINTI " that you mentioned "
	EQUAL? P-NOT-HERE,1 /?L84
	PRINTI "are"
	JUMP ?L88
?L84:	PRINTI "is"
?L88:	PRINTI "n't here."
	CRLF
	JUMP ?L63
?L66:	ZERO? TMP \?L63
	PRINT REFERRING
	CRLF
	JUMP ?L63
?L64:	ZERO? PTBL /?L98
	GET P-PRSO,CNT >OBJ1
	JUMP ?L100
?L98:	GET P-PRSI,CNT >OBJ1
?L100:	ZERO? PTBL /?L101
	SET 'PRSO,OBJ1
	JUMP ?L103
?L101:	SET 'PRSO,OBJ
?L103:	ZERO? PTBL /?L104
	SET 'PRSI,OBJ
	JUMP ?L106
?L104:	SET 'PRSI,OBJ1
?L106:	GRTR? NUM,1 /?L109
	GET P-ITBL,P-NC1 >STACK
	GET STACK,0 >STACK
	EQUAL? STACK,W?ALL \?L125
?L109:	EQUAL? OBJ1,NOT-HERE-OBJECT \?L110
	INC 'P-NOT-HERE
	JUMP ?L62
?L110:	EQUAL? P-GETFLAGS,P-ALL \?L112
	EQUAL? PRSA,V?PICK-UP,V?TAKE \?L115
	LOC OBJ1 >STACK
	EQUAL? STACK,WINNER,HERE,PRSI /?L114
	LOC OBJ1 >STACK
	FSET? STACK,SURFACEBIT \?L62
?L114:	FSET? OBJ1,TAKEBIT /?L112
	FSET? OBJ1,TRYTAKEBIT \?L62
?L112:	EQUAL? PRSA,V?PICK-UP,V?TAKE \?L115
	ZERO? PRSI /?L115
	IN? PRSO,PRSI \?L62
?L115:	EQUAL? P-GETFLAGS,P-ALL \?L118
	EQUAL? PRSA,V?DROP \?L116
	IN? OBJ1,WINNER \?L62
?L116:	EQUAL? P-GETFLAGS,P-ALL \?L118
	ZERO? PRSI /?L117
	EQUAL? PRSO,PRSI /?L62
?L117:	EQUAL? P-GETFLAGS,P-ALL \?L118
	EQUAL? PRSA,V?PUT \?L118
	CALL HELD?,PRSO,PRSI >STACK
	ZERO? STACK \?L62
?L118:	CALL ACCESSIBLE?,OBJ1 >STACK
	ZERO? STACK /?L62
	EQUAL? OBJ1,IT \?L121
	PRINTD P-IT-OBJECT
	JUMP ?L123
?L121:	CALL TEA-PRINT,OBJ1 >STACK
	ZERO? STACK /?L123
	PRINTD OBJ1
?L123:	CALL TEA-PRINT,OBJ1 >STACK
	ZERO? STACK /?L125
	PRINTI ": "
?L125:	SET 'TMP,1
	CALL PERFORM,PRSA,PRSO,PRSI >V
	EQUAL? V,M-FATAL \?L62
?L63:	EQUAL? V,M-FATAL /?L139
	EQUAL? PRSA,V?SUPER-BRIEF,V?BRIEF,V?TELL /?L139
	EQUAL? PRSA,V?VERSION,V?SAVE,V?VERBOSE /?L139
	EQUAL? PRSA,V?UNSCRIPT,V?SCRIPT,V?RESTORE /?L139
	LOC WINNER >STACK
	GETP STACK,P?ACTION >STACK
	CALL STACK,M-END >V
?L139:	EQUAL? PRSA,V?RESTORE,V?SAVE,V?AGAIN /?L145
	EQUAL? PRSA,V?VERBOSE,V?UNSCRIPT,V?SCRIPT /?L145
	EQUAL? PRSA,V?SUPER-BRIEF,V?BRIEF /?L145
	ZERO? P-OFLAG \?L145
	SET 'L-PRSA,PRSA
	SET 'L-PRSO,PRSO
	SET 'L-PRSI,PRSI
?L145:	ZERO? DONT-FLAG /?L146
	SET 'L-DONT-FLAG,1
	JUMP ?L148
?L146:	SET 'L-DONT-FLAG,0
?L148:	ZERO? IN-FRONT-FLAG /?L149
	SET 'L-FRONT-FLAG,1
	JUMP ?L151
?L149:	SET 'L-FRONT-FLAG,0
?L151:	EQUAL? V,M-FATAL \?L155
	SET 'P-CONT,0
	JUMP ?L155
?L3:	SET 'P-CONT,0
?L155:	ZERO? P-WON /?L156
	EQUAL? PRSA,V?SUPER-BRIEF,V?BRIEF,V?TELL /?L165
	EQUAL? PRSA,V?QUIT,V?VERSION,V?VERBOSE /?L165
	EQUAL? PRSA,V?RESTORE,V?SAVE,V?SCORE /?L165
	EQUAL? PRSA,V?FOOTNOTE,V?UNSCRIPT,V?SCRIPT /?L165
	EQUAL? PRSA,V?RESTART,V?HELP /?L165
	EQUAL? PRSA,V?AGAIN \?L161
	EQUAL? L-PRSA,V?FIND,V?FOLLOW,V?CALL /?L165
	EQUAL? L-PRSA,V?WHAT,V?WHERE,V?WAIT-FOR /?L165
	EQUAL? L-PRSA,V?WHO,V?WALK-TO,V?WHAT-ABOUT /?L165
	EQUAL? L-PRSA,V?ASK-ABOUT,V?ASK-FOR,V?I-AM /?L165
	EQUAL? L-PRSA,V?MY-NAME,V?CARVE,V?SCORE /?L165
	EQUAL? L-PRSA,V?VERSION,V?FOOTNOTE,V?HELP /?L165
?L161:	EQUAL? PRSA,V?WAIT \?L163
	ZERO? DONT-FLAG \?L165
?L163:	EQUAL? PRSA,V?AGAIN \?L164
	EQUAL? L-PRSA,V?WAIT \?L164
	ZERO? L-DONT-FLAG \?L165
?L164:	CALL CLOCKER >V
?L165:	SET 'PRSA,0
	SET 'PRSO,0
	SET 'PRSI,0
	JUMP ?L1
?L156:	GETB P-LEXV,P-LEXWORDS >STACK
	GRTR? STACK,3 \?L1
	ZERO? CARELESS-WORDS-FLAG \?L1
	ZERO? EARTH-DEMOLISHED /?L1
	CALL SAVE-INPUT,FIRST-BUFFER >STACK
	ZERO? STACK /?L1
	SET 'CARELESS-WORDS-FLAG,1
	CALL QUEUE,I-CARELESS-WORDS,3 >STACK
	PUT STACK,0,1
	JUMP ?L1

	.FUNCT SAVE-INPUT,TBL,OFFS=0,CNT,TMP,?TMP
	MUL 4,P-INPUT-WORDS >TMP
	GETB P-LEXV,TMP >?TMP
	ADD TMP,1 >STACK
	GETB P-LEXV,STACK >STACK
	ADD ?TMP,STACK >CNT
	ZERO? CNT /FALSE
	DEC 'CNT
?L4:	EQUAL? OFFS,CNT \?L6
	PUTB TBL,OFFS,0
	RTRUE
?L6:	ADD OFFS,1 >STACK
	GETB P-INBUF,STACK >STACK
	PUTB TBL,OFFS,STACK
	INC 'OFFS
	JUMP ?L4

	.FUNCT RESTORE-INPUT,TBL,CHR
?L1:	GETB TBL,0 >CHR
	ZERO? CHR /TRUE
	PRINTC CHR
	INC 'TBL
	JUMP ?L1

	.FUNCT FAKE-ORPHAN,TMP
	CALL ORPHAN,P-SYNTAX,0
	PRINTI "Be specific: what object do"
	ZERO? DONT-FLAG /?L3
	PRINTI "n't"
?L3:	PRINTI " you want to "
	GET P-OTBL,P-VERBN >TMP
	ZERO? TMP \?L10
	PRINTI "tell"
	JUMP ?L15
?L10:	GETB P-VTBL,2 >STACK
	ZERO? STACK \?L14
	GET TMP,0 >STACK
	PRINTB STACK
	JUMP ?L15
?L14:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
	PUTB P-VTBL,2,0
?L15:	SET 'P-OFLAG,1
	SET 'P-WON,0
	GETB P-SYNTAX,P-SPREP1 >STACK
	CALL PREP-PRINT,STACK
	PRINTR "?"

	.FUNCT PERFORM,A,O=0,I=0,V,OA,OO,OI
	SET 'OA,PRSA
	SET 'OO,PRSO
	SET 'OI,PRSI
	SET 'PRSA,A
	EQUAL? IT,I,O \?L1
	ZERO? I \?L3
	CALL FAKE-ORPHAN
	RETURN 2
?L3:	PRINT REFERRING
	CRLF
	RETURN 2
?L1:	SET 'PRSO,O
	ZERO? PRSO /?L11
	EQUAL? PRSA,V?WALK /?L11
	EQUAL? PRSO,NOT-HERE-OBJECT /?L11
	SET 'P-IT-OBJECT,PRSO
?L11:	SET 'PRSI,I
	EQUAL? A,V?WALK /?L14
	EQUAL? NOT-HERE-OBJECT,PRSO,PRSI \?L14
	CALL D-APPLY,STR?138,NOT-HERE-OBJECT-F >V
	ZERO? V /?L14
	SET 'P-WON,0
	JUMP ?L24
?L14:	SET 'O,PRSO
	SET 'I,PRSI
	GETP WINNER,P?ACTION >STACK
	CALL D-APPLY,STR?139,STACK >V
	ZERO? V \?L24
	ZERO? DONT-FLAG /?L19
	CALL DONT-F >V
	ZERO? V \?L24
?L19:	LOC WINNER >STACK
	GETP STACK,P?ACTION >STACK
	CALL D-APPLY,STR?140,STACK,M-BEG >V
	ZERO? V \?L24
	GET PREACTIONS,A >STACK
	CALL D-APPLY,STR?141,STACK >V
	ZERO? V \?L24
	ZERO? I /?L22
	GETP I,P?ACTION >STACK
	CALL D-APPLY,STR?142,STACK >V
	ZERO? V \?L24
?L22:	ZERO? O /?L23
	EQUAL? A,V?WALK /?L23
	GETP O,P?ACTION >STACK
	CALL D-APPLY,STR?143,STACK >V
	ZERO? V \?L24
?L23:	GET ACTIONS,A >STACK
	CALL D-APPLY,0,STACK >V
	ZERO? V /?L24
?L24:	SET 'PRSA,OA
	SET 'PRSO,OO
	SET 'PRSI,OI
	RETURN V

	.FUNCT D-APPLY,STR,FCN,FOO=0,RES
	ZERO? FCN /FALSE
	ZERO? FOO /?L4
	CALL FCN,FOO >RES
	RETURN RES
?L4:	CALL FCN >RES
	RETURN RES

	.FUNCT QUEUE,RTN,TICK,CINT
	CALL INT,RTN >CINT
	PUT CINT,C-TICK,TICK
	RETURN CINT

	.FUNCT INT,RTN,E,C,INT?1
	ADD C-TABLE,C-TABLELEN >E
	ADD C-TABLE,C-INTS >C
?L1:	EQUAL? C,E \?L3
	SUB C-INTS,C-INTLEN >C-INTS
	ADD C-TABLE,C-INTS >INT?1
	PUT INT?1,C-RTN,RTN
	RETURN INT?1
?L3:	GET C,C-RTN >STACK
	EQUAL? STACK,RTN \?L5
	RETURN C
?L5:	ADD C,C-INTLEN >C
	JUMP ?L1

	.FUNCT CLOCKER,C,E,TICK,FLG=0
	ZERO? CLOCK-WAIT /?L1
	SET 'CLOCK-WAIT,0
	RFALSE
?L1:	ZERO? P-WON /?L4
	PUSH C-INTS
	JUMP ?L5
?L4:	PUSH 0
?L5:	ADD C-TABLE,STACK >C
	ADD C-TABLE,C-TABLELEN >E
?L7:	EQUAL? C,E \?L9
	INC 'MOVES
	RETURN FLG
?L9:	GET C,C-ENABLED? >STACK
	ZERO? STACK /?L15
	GET C,C-TICK >TICK
	ZERO? TICK /?L15
	SUB TICK,1 >STACK
	PUT C,C-TICK,STACK
	GRTR? TICK,1 /?L15
	GET C,C-RTN >STACK
	CALL STACK >STACK
	ZERO? STACK /?L15
	SET 'FLG,1
?L15:	ADD C,C-INTLEN >C
	JUMP ?L7

	.FUNCT IN-HEART?,OBJ
	CALL META-LOC,OBJ >STACK
	EQUAL? STACK,ENTRY-BAY,FORE-CORRIDOR,AFT-CORRIDOR /TRUE
	CALL META-LOC,OBJ >STACK
	EQUAL? STACK,GALLEY,BRIDGE,ENGINE-ROOM /TRUE
	CALL META-LOC,OBJ >STACK
	EQUAL? STACK,HATCHWAY,PANTRY,ACCESS-SPACE \FALSE
	RTRUE

	.FUNCT HEART-OF-GOLD-F
	EQUAL? PRSA,V?DISEMBARK,V?EXIT,V?LEAVE \?L1
	EQUAL? HERE,HATCHWAY \?L3
	CALL DO-WALK,P?DOWN >STACK
	RSTACK
?L3:	EQUAL? HERE,DAIS \?L5
	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L5:	CALL V-WALK-AROUND >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?BOARD,V?WALK-TO,V?THROUGH \FALSE
	EQUAL? HERE,DAIS \?L10
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L10:	CALL IN-HEART?,PROTAGONIST >STACK
	ZERO? STACK /FALSE
	PRINT LOOK-AROUND
	CRLF
	RTRUE

	.FUNCT PANTRY-F,RARG
	EQUAL? RARG,M-ENTER \FALSE
	ZERO? LANDED \?L3
	MOVE MARVIN,HERE
	CALL INT,I-MARVIN >STACK
	PUT STACK,0,0
?L3:	FSET? SCREENING-DOOR,MUNGEDBIT \?L6
	PRINTI "As you pass the door, it slams against you, bruising your upper arm, and then opens again. ""Take that, door-kicker."""
	CRLF
	CRLF
	CALL PRINT-ID,STR?144
?L6:	PRINTI "Upon entering the room, you are battered by tidal waves of depression. "
	LESS? SCORE,300 \?L13
	CALL PRINT-ID,STR?145
	CALL JIGS-UP,STR?146
	RTRUE
?L13:	FSET? PANTRY,REVISITBIT /?L16
	FSET PANTRY,REVISITBIT
	ADD SCORE,25 >SCORE
?L16:	PRINTI "However, the happiness derived from your high score and that thoroughly excellent cup of tea you had recently help you to survive."
	CRLF
	CRLF
	RTRUE

	.FUNCT SCREENING-DOOR-F
	EQUAL? SCREENING-DOOR,WINNER \?L1
	EQUAL? PRSA,V?TELL-ABOUT \?L3
	EQUAL? PRSO,ME \?L3
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,SCREENING-DOOR,PRSI
	SET 'WINNER,SCREENING-DOOR
	RTRUE
?L3:	EQUAL? PRSA,V?HELLO \?L5
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,SCREENING-DOOR
	SET 'WINNER,SCREENING-DOOR
	RTRUE
?L5:	EQUAL? PRSA,V?WHAT \?L6
	EQUAL? PRSO,OBJECT-OF-GAME \?L6
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,SCREENING-DOOR,OBJECT-OF-GAME
	SET 'WINNER,SCREENING-DOOR
	RTRUE
?L6:	PRINTI """Unless you're here to show me some clear sign of your intelligence, please leave me alone. I'm a very busy door."""
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L1:	FSET? SCREENING-DOOR,OPENBIT \?L14
	EQUAL? PRSA,V?KNOCK,V?GIVE,V?SHOW /?L11
	EQUAL? PRSA,V?OPEN \?L10
?L11:	PRINTR "You already induced the door to open."
?L10:	FSET? SCREENING-DOOR,OPENBIT \?L14
	EQUAL? PRSA,V?CLOSE \?L14
	PRINTR "The door snaps, ""Hey! I'm resting. I've had a very busy day."""
?L14:	EQUAL? PRSA,V?KICK \?L17
	FSET SCREENING-DOOR,MUNGEDBIT
	PRINTI """I suppose you think that since you have legs and I have not, you can get away with that sort of thing. Well,"" the door continues stiffly, ""maybe you can and maybe you can't."""
	CRLF
	CALL PRINT-ID,STR?147 >STACK
	RSTACK
?L17:	EQUAL? PRSA,V?GIVE,V?SHOW \?L20
	EQUAL? PRSO,NO-TEA,TEA \?L24
	ZERO? TEA-SHOWN /?L21
	CALL HELD?,TEA >STACK
	ZERO? STACK /?L21
	ZERO? HOLDING-NO-TEA /?L21
	EQUAL? PRSO,TEA-SHOWN /?L21
	CALL PERFORM,V?KNOCK,SCREENING-DOOR
	RTRUE
?L21:	EQUAL? PRSO,NO-TEA,TEA \?L24
	SET 'TEA-SHOWN,PRSO
?L24:	RANDOM 100 >STACK
	LESS? 50,STACK /?L27
	PRINTI "The door says ""Big deal. Anyone can have"
	CALL ARTICLE,PRSO
	PRINTR "."""
?L27:	PRINTR "The door yawns."
?L20:	EQUAL? PRSA,V?KNOCK,V?OPEN \?L36
	CALL HELD?,TEA >STACK
	ZERO? STACK /?L37
	ZERO? HOLDING-NO-TEA /?L37
	FSET SCREENING-DOOR,OPENBIT
	PRINTR "The door is almost speechless with admiration. ""Wow. Simultaneous tea and no tea. My apologies. You are clearly a heavy-duty philosopher."" It opens respectfully."
?L37:	PRINTR "The door explains, in a haughty tone, that the room is occupied by a super-intelligent robot and that lesser beings (by which it means you) are not to be admitted. ""Show me some tiny example of your intelligence,"" it says, ""and maybe, just maybe, I might reconsider."""
?L36:	EQUAL? PRSA,V?ASK-ABOUT \?L44
	EQUAL? PRSI,OBJECT-OF-GAME \?L44
	PRINTR """To keep out sub-intelligent beings."""
?L44:	EQUAL? PRSA,V?THROUGH \?L47
	EQUAL? HERE,PANTRY \?L48
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L48:	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L47:	EQUAL? PRSA,V?EXAMINE \FALSE
	FCLEAR SCREENING-DOOR,ACTORBIT
	CALL V-LOOK-INSIDE
	FSET SCREENING-DOOR,ACTORBIT
	RTRUE

	.FUNCT MARVIN-F
	EQUAL? MARVIN,WINNER \?L1
	EQUAL? PRSA,V?TELL-ABOUT \?L3
	EQUAL? PRSO,ME \?L3
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,MARVIN,PRSI
	SET 'WINNER,MARVIN
	RTRUE
?L3:	EQUAL? PRSA,V?HELLO \?L5
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,MARVIN
	SET 'WINNER,MARVIN
	RTRUE
?L5:	EQUAL? PRSA,V?WHAT \?L6
	EQUAL? PRSO,OBJECT-OF-GAME \?L6
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,MARVIN,OBJECT-OF-GAME
	SET 'WINNER,MARVIN
	RTRUE
?L6:	EQUAL? HERE,PANTRY \?L7
	EQUAL? PRSA,V?OPEN,V?REPAIR \?L8
	EQUAL? PRSO,MECHANISM,HATCH \?L8
	ZERO? LANDED \?L10
	PRINTI """"
	PRINT HUMANS
	PRINTR "stupid. Are you aware,"" he asks, ""that this ship is in space, that space is an almost perfect vacuum, and that the hatch is the only thing holding in all the air?"""
?L10:	EQUAL? MARVIN-COUNTER,3 \?L14
	PRINTI """After the help I got last time? "
	PRINT HUMANS
	PRINTR "ungrateful. Go away."""
?L14:	EQUAL? MARVIN-COUNTER,4 \?L17
	PRINTR """I did."""
?L17:	GRTR? MARVIN-COUNTER,0 \?L20
	PRINTI """Yes, I said I'd do it! "
	PRINT HUMANS
	PRINTR "repetitious."""
?L20:	SET 'MARVIN-COUNTER,1
	CALL QUEUE,I-MARVIN,12 >STACK
	PUT STACK,0,1
	PRINTI """"
	PRINT HUMANS
	PRINTI "demanding. Do this. Pick up that. Unjam the opening mechanism of the other. Meet me in the hatchway "
	PRINTD ACCESS-SPACE
	PRINTR " in twelve turns. I suppose,"" he mutters, ""you can count up to twelve. So hard to know with morons. And don't forget to bring the proper tool."""
?L8:	EQUAL? PRSA,V?WHAT \?L26
	EQUAL? PRSO,TWEEZERS \?L26
	GRTR? MARVIN-COUNTER,0 \?L26
	PRINTR "Marvin looks scornful. ""How did you get past my door if you're so primordially benighted that you don't even know which tool is needed for a job like this?"""
?L26:	PRINTI """Please don't feel you have to take any notice of me. I'm just a menial robot."""
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L7:	PRINTI """I think you ought to know I'm feeling very depressed."""
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?ASK-ABOUT \?L35
	EQUAL? PRSI,OBJECT-OF-GAME \?L35
	PRINTR """Being clever doesn't always make you happy, you know. Look at me, brain the size of a planet, how many points do you think I've got? Minus thirty zillion at the last count."""
?L35:	EQUAL? PRSA,V?FOLLOW \?L42
	EQUAL? FOLLOW-FLAG,2 \?L38
	IN? MARVIN,PANTRY \?L39
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L39:	LOC MARVIN >STACK
	CALL GOTO,STACK >STACK
	RSTACK
?L38:	EQUAL? PRSA,V?FOLLOW \?L42
	EQUAL? FOLLOW-FLAG,7 \?L42
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L42:	EQUAL? PRSA,V?GIVE \FALSE
	EQUAL? MARVIN-COUNTER,2 \FALSE
	EQUAL? PRSO,TOOL-REQUIRED \?L44
	ADD SCORE,25 >SCORE
	SET 'MARVIN-COUNTER,4
	SET 'FOLLOW-FLAG,7
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	CALL INT,I-MARVIN >STACK
	PUT STACK,0,0
	FSET HATCH,OPENBIT
	MOVE MARVIN,PANTRY
	MOVE TOOL-REQUIRED,MARVIN
	PRINTI "Marvin fiddles inside the "
	PRINTD MECHANISM
	PRINTI " with the "
	PRINTD TOOL-REQUIRED
	PRINTR " for about three-tenths of a second. You hear the hatchway slide open. ""I don't expect you to be grateful,"" says Marvin, ""or even interested, but that was probably more complicated than every single action you'll ever perform in your entire life put together."" He limps away. ""And me,"" you hear him mutter as he goes, ""with this terrible pain in all the diodes down my left side."""
?L44:	PRINTI """That's not"
	CALL ARTICLE,TOOL-REQUIRED
	PRINTR "."""

	.FUNCT I-MARVIN
	CALL QUEUE,I-MARVIN,-1 >STACK
	PUT STACK,0,1
	EQUAL? MARVIN-COUNTER,2 \?L1
	SET 'MARVIN-COUNTER,3
	CRLF
	EQUAL? HERE,HATCHWAY \?L3
	PRINTI "Marvin emerges from the "
	PRINTD ACCESS-SPACE
	PRINTI ". "
?L3:	PRINTI """"
	CALL MARVIN-BITCH
	SET 'MARVIN-COUNTER,3
	RETURN MARVIN-COUNTER
?L1:	IN? MARVIN,ACCESS-SPACE \?L10
	EQUAL? HERE,ACCESS-SPACE \?L11
	ZERO? TOOL-REQUIRED \?L16
?L15:	CALL PICK-ONE,TOOL-LIST >TOOL-REQUIRED
	CALL HELD?,TOOL-REQUIRED,PROTAGONIST >STACK
	ZERO? STACK \?L15
?L16:	SET 'P-IT-OBJECT,TOOL-REQUIRED
	SET 'MARVIN-COUNTER,2
	PRINTI "Marvin, looking bored, says ""Hand me"
	CALL ARTICLE,TOOL-REQUIRED
	PRINTR "."""
?L11:	CRLF
	PRINTI "Marvin wanders up to you. ""I went to the "
	PRINTD ACCESS-SPACE
	PRINTI " but you never showed up. "
	CALL MARVIN-BITCH
	SET 'MARVIN-COUNTER,3
	RETURN MARVIN-COUNTER
?L10:	EQUAL? MARVIN-COUNTER,1 \?L28
	MOVE MARVIN,ACCESS-SPACE
	EQUAL? HERE,ACCESS-SPACE \FALSE
	PRINTR "Marvin shambles in."
?L28:	IN? MARVIN,HERE \?L34
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	SET 'FOLLOW-FLAG,2
	CRLF
	EQUAL? HERE,HATCHWAY,GALLEY,ENTRY-BAY /?L37
	EQUAL? HERE,FORE-CORRIDOR,ENGINE-ROOM,BRIDGE \?L35
?L37:	PRINTI "Marvin wanders off."
	CRLF
	EQUAL? HERE,FORE-CORRIDOR,ENGINE-ROOM,HATCHWAY \?L40
	MOVE MARVIN,AFT-CORRIDOR
	RTRUE
?L40:	MOVE MARVIN,FORE-CORRIDOR
	RTRUE
?L35:	EQUAL? HERE,AFT-CORRIDOR \?L43
	MOVE MARVIN,PANTRY
	PRINTR "Marvin enters a room to port, and the door closes behind him."
?L43:	PRINTI "Bug #17"
	RTRUE
?L34:	IN? MARVIN,PANTRY /?L49
	MOVE MARVIN,PANTRY
	RFALSE
?L49:	CALL IN-HEART?,PROTAGONIST >STACK
	ZERO? STACK /FALSE
	EQUAL? HERE,ACCESS-SPACE /FALSE
	FSET? SCREENING-DOOR,OPENBIT /FALSE
	ZERO? AWAITING-REPLY \FALSE
	EQUAL? HERE,ENGINE-ROOM \?L52
	LESS? LOOK-COUNTER,3 /FALSE
?L52:	RANDOM 100 >STACK
	LESS? 8,STACK /FALSE
	MOVE MARVIN,HERE
	CRLF
	PRINTR "You feel a wave of depression sweep over you, and you turn to see that Marvin the robot has stalked miserably into the room."

	.FUNCT MARVIN-BITCH
	CALL INT,I-MARVIN >STACK
	PUT STACK,0,0
	MOVE MARVIN,PANTRY
	PRINTI "Ah. I was misled into thinking that you wanted me to open the hatch, probably by the fact that you asked me to. Obviously you changed your mind or I misunderstood you or you are a moronic imbecile. I wonder which"
	EQUAL? HERE,PANTRY /?L3
	PRINTI ". I'm going back to my pantry to be alone with my grief"
?L3:	PRINTR "."" Marvin stalks miserably away."

	.FUNCT FLOWERPOT-F
	EQUAL? PRSA,V?WATER \?L1
	EQUAL? PRSO,FLOWERPOT \?L1
	IN? PLANT,FLOWERPOT \?L1
	CALL PERFORM,V?WATER,PLANT,PRSI
	RTRUE
?L1:	EQUAL? PRSA,V?LOOK-INSIDE,V?READ,V?EXAMINE \?L3
	PRINTI "The pot is filled with fertile soil"
	IN? PLANT,FLOWERPOT \?L6
	PRINTI ", out of which has sprouted a "
	ZERO? PLANT-BLOOMED /?L10
	PRINTI "large, leafy plant"
	JUMP ?L17
?L10:	PRINTI "tiny plant stalk"
	JUMP ?L17
?L6:	PRINTI ". It is inscribed ""Inertial Guidance System -- Magrathean Missile Company."" It must have been created by the same burst of improbability that created the whale itself"
?L17:	PRINTR "."
?L3:	EQUAL? PRSA,V?PUT \?L22
	EQUAL? PRSO,SATCHEL-FLUFF,JACKET-FLUFF,POCKET-FLUFF /?L23
	EQUAL? PRSO,CUSHION-FLUFF \?L22
?L23:	MOVE PRSO,LOCAL-GLOBALS
	INC 'FLUFF-COUNTER
	EQUAL? FLUFF-COUNTER,4 \?L24
	CALL QUEUE,I-PLANT,10 >STACK
	PUT STACK,0,1
?L24:	PRINTI "You dig a "
	PRINTD FISH-HOLE
	PRINTR ", gingerly place the fluff at the bottom, and cover it over."
?L22:	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	EQUAL? PRSO,FLOWERPOT \FALSE
	CALL TELL-ME-HOW >STACK
	RSTACK

	.FUNCT I-PLANT
	MOVE PLANT,FLOWERPOT
	CALL VISIBLE?,FLOWERPOT >STACK
	ZERO? STACK /FALSE
	CRLF
	PRINTI "You notice a tiny movement from the "
	PRINTD FLOWERPOT
	PRINTR ". You look closely, and see a tiny sprout poking out of the soil."

	.FUNCT PLANT-F
	EQUAL? PRSA,V?EXAMINE \?L1
	ZERO? PLANT-BLOOMED /?L3
	PRINTI "The plant is now large and leafy."
	FSET? FRUIT,NDESCBIT \?L7
	CALL VISIBLE?,FRUIT >STACK
	ZERO? STACK /?L7
	PRINTI " Hanging from it is a large, succulent fruit."
?L7:	CRLF
	RTRUE
?L3:	PRINTR "The plant is just a tiny stem."
?L1:	EQUAL? PRSA,V?DROP,V?TAKE \?L15
	EQUAL? PRSO,PLANT \?L15
	ZERO? PRSI /?L16
	CALL PART-OF >STACK
	RSTACK
?L16:	CALL PERFORM,PRSA,FLOWERPOT,PRSI
	RTRUE
?L15:	EQUAL? PRSA,V?WATER \FALSE
	ZERO? PLANT-BLOOMED \FALSE
	EQUAL? PRSI,TEA,SUBSTITUTE,MINERAL-WATER \FALSE
	MOVE PRSI,LOCAL-GLOBALS
	MOVE PLANT,LOCAL-GLOBALS
	PRINTI "After several seconds, the plant shrivels up."
	CALL ANTI-LITTER,STR?77
	CRLF
	RTRUE

	.FUNCT FRUIT-F,X
	EQUAL? PRSA,V?PICK,V?TAKE \?L1
	FSET? FRUIT,TRYTAKEBIT \?L1
	FCLEAR FRUIT,TRYTAKEBIT
	FCLEAR FRUIT,NDESCBIT
	MOVE FRUIT,PROTAGONIST
	PRINTR "Done."
?L1:	EQUAL? PRSA,V?THROW,V?DROP \?L5
	FSET? FRUIT,TRYTAKEBIT \?L5
	FCLEAR FRUIT,TRYTAKEBIT
	FCLEAR FRUIT,NDESCBIT
	MOVE FRUIT,HERE
	EQUAL? PRSA,V?DROP \?L6
	PRINTR "Dropped."
?L6:	PRINTR "Thrown."
?L5:	EQUAL? PRSA,V?EAT \FALSE
?L14:	CALL PICK-ONE,TOOL-LIST >TOOL-REQUIRED
	INC 'X
	CALL IN-HEART?,TOOL-REQUIRED >STACK
	ZERO? STACK /?L15
	GRTR? X,50 \?L14
?L15:	MOVE FRUIT,LOCAL-GLOBALS
	PRINTI "The fruit has a zesty taste, and you devour it greedily. Suddenly, your vision wavers, and you see yourself, as though from a distance, standing near Marvin, who asks you for"
	CALL ARTICLE,TOOL-REQUIRED
	PRINTI ". Then, the image vanishes like a movie when the film breaks, and you find yourself still in"
	CALL ARTICLE,HERE,1
	PRINTR ".

It seems that this plant is a rare horticultural phenomenon long thought to be extinct: The Tree of Foreknowledge."

	.FUNCT GALLEY-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "You are in the Galley area of the ship, containing a machine which is the state of the art in Nutritional Technology, a "
	PRINT SCC
	PRINTI " "
	PRINTD NUTRIMAT
	PRINTR ". There is an exit to starboard."
?L1:	EQUAL? RARG,M-END \FALSE
	CALL RUNNING?,I-TEA >STACK
	ZERO? STACK \FALSE
	RANDOM 100 >STACK
	LESS? 3,STACK /FALSE
	SET 'FOLLOW-FLAG,6
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	CRLF
	PRINTD ZAPHOD
	PRINTI " walks in and presses the "
	PRINTD PAD
	PRINTI ". The "
	PRINTD NUTRIMAT
	PRINTR " produces a huge, ice-cold Pan-Galactic Gargle Blaster. Zaphod heads off toward the sauna, sipping loudly."

	.FUNCT NUTRIMAT-F
	EQUAL? NUTRIMAT,WINNER \?L1
	EQUAL? PRSA,V?TELL-ABOUT \?L3
	EQUAL? PRSO,ME \?L3
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,NUTRIMAT,PRSI
	SET 'WINNER,NUTRIMAT
	RTRUE
?L3:	EQUAL? PRSA,V?HELLO \?L5
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,NUTRIMAT
	SET 'WINNER,NUTRIMAT
	RTRUE
?L5:	EQUAL? PRSA,V?WHAT \?L6
	EQUAL? PRSO,OBJECT-OF-GAME \?L6
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,NUTRIMAT,OBJECT-OF-GAME
	SET 'WINNER,NUTRIMAT
	RTRUE
?L6:	EQUAL? PRSA,V?SGIVE \?L9
	EQUAL? PRSO,ME /?L8
?L9:	EQUAL? PRSA,V?GIVE \?L7
	EQUAL? PRSI,ME \?L7
?L8:	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-FOR,NUTRIMAT,PRSI
	SET 'WINNER,NUTRIMAT
	RTRUE
?L7:	EQUAL? PRSA,V?MAKE \?L10
	EQUAL? PRSO,NO-TEA,TEA \?L10
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?RUB,PAD
	SET 'WINNER,NUTRIMAT
	RTRUE
?L10:	PRINTI "The "
	PRINTD NUTRIMAT
	PRINTI " ignores you."
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L14
	PRINTI "The "
	PRINTD NUTRIMAT
	PRINTI " has a "
	PRINTD PAD
	PRINTI ", a dispensing slot, and a service panel which is "
	FSET? NUTRIMAT,OPENBIT \?L17
	PRINTI "open"
	JUMP ?L21
?L17:	PRINTI "closed"
?L21:	PRINTI "."
	CALL FINE-PRODUCT
	CALL RUNNING?,I-TEA >STACK
	ZERO? STACK /?L26
	PRINTI " "
	CALL PERFORM,V?LISTEN,NUTRIMAT
	RTRUE
?L26:	CRLF
	RTRUE
?L14:	EQUAL? PRSA,V?LISTEN \?L31
	CALL RUNNING?,I-TEA >STACK
	ZERO? STACK /?L31
	PRINTI "The "
	PRINTD NUTRIMAT
	PRINTR " is making a faint whirring noise."
?L31:	EQUAL? PRSA,V?ASK-FOR \?L34
	EQUAL? PRSI,SUBSTITUTE,TEA \?L34
	CALL PERFORM,V?RUB,PAD
	RTRUE
?L34:	EQUAL? PRSA,V?LAMP-ON \?L35
	CALL PERFORM,V?RUB,PAD
	RTRUE
?L35:	EQUAL? PRSA,V?LAMP-OFF \?L36
	CALL RUNNING?,I-TEA >STACK
	ZERO? STACK /?L36
	CALL PERFORM,V?RUB,PAD
	RTRUE
?L36:	EQUAL? PRSA,V?SHAKE,V?KICK,V?KILL \?L37
	ZERO? SUBSTITUTE-DRUNK /?L37
	PRINTI "The "
	PRINTD NUTRIMAT
	PRINTI " says "
	CALL PRINT-ID,STR?148
	RANDOM 100 >STACK
	LESS? 50,STACK /?L40
	PRINTR """Share and Enjoy."""
?L40:	PRINTR """If you have enjoyed the experience of this drink, why not share it with your friends?"""
?L37:	EQUAL? PRSA,V?PLUG,V?PUT \?L47
	EQUAL? PRSI,NUTRIMAT \?L47
	FSET? NUTRIMAT,OPENBIT /?L48
	PRINTR "The panel is closed."
?L48:	FIRST? NUTRIMAT >STACK \?L52
	PRINTR "There's no room."
?L52:	EQUAL? PRSO,NUT-COM-INTERFACE,BOARD \?L55
	MOVE PRSO,NUTRIMAT
	PRINTR "Done."
?L55:	CALL V-PLUG >STACK
	RSTACK
?L47:	EQUAL? PRSA,V?LOOK-INSIDE \?L59
	FSET? NUTRIMAT,OPENBIT /?L60
	CALL PERFORM,V?OPEN,NUTRIMAT
	RTRUE
?L60:	IN? BOARD,NUTRIMAT \?L62
	PRINTI "There is a "
	PRINTD BOARD
	PRINTR " there."
?L62:	IN? NUT-COM-INTERFACE,NUTRIMAT \?L65
	PRINTI "There is a "
	PRINTD NUT-COM-INTERFACE
	PRINTR " there."
?L65:	PRINTI "There's nothing in the "
	PRINTD NUTRIMAT
	PRINTR "."
?L59:	EQUAL? PRSA,V?ASK-ABOUT \FALSE
	EQUAL? PRSI,OBJECT-OF-GAME \FALSE
	PRINTR """To provide a nutritious and flavour-enhanced diet."""

	.FUNCT PAD-F
	EQUAL? PRSA,V?PUSH,V?RUB \FALSE
	IN? NUT-COM-INTERFACE,NUTRIMAT \?L3
	CALL RUNNING?,I-TEA >STACK
	ZERO? STACK /?L5
	PRINTI """Please wait..."
	PRINTD NUTRIMAT
	PRINTR " engaged."""
?L5:	IN? TEA,PAD \?L9
	CALL QUEUE,I-TEA,-1 >STACK
	PUT STACK,0,1
	PRINTI "The "
	PRINTD NUTRIMAT
	PRINTI " is puzzled that you want something made by pouring boiling water on dead leaves and squirting stuff from a cow in it, and says that it will need some help from "
	PRINTD EDDIE
	PRINTR "."
?L9:	PRINTI """I won't go through that again. If "
	PRINTD SUBSTITUTE
	PRINTR " isn't good enough, too bad."""
?L3:	IN? SUBSTITUTE,PAD \?L15
	MOVE SUBSTITUTE,SLOT
	SET 'P-IT-OBJECT,SUBSTITUTE
	PRINTI "The "
	PRINTD NUTRIMAT
	PRINTI " makes an instant but highly detailed examination of your taste buds, a spectroscopic analysis of your metabolism and sends tiny experimental signals down your neural pathways to see what you like.
A cupful of "
	PRINTD SUBSTITUTE
	PRINTR " appears in the dispensing slot."
?L15:	PRINTI """You still haven't drunk the nutritious and flavour-enhanced cupful of "
	PRINTD SUBSTITUTE
	PRINTI " I already gave you,"" scolds the "
	PRINTD NUTRIMAT
	PRINTR "."

	.FUNCT SLOT-F
	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	EQUAL? PRSO,SLOT \FALSE
	CALL TELL-ME-HOW >STACK
	RSTACK

	.FUNCT BOARD-F
	EQUAL? PRSA,V?CLOSE,V?OPEN \?L1
	EQUAL? PRSO,BOARD \?L1
	CALL TELL-ME-HOW >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L3
	PRINTI "The "
	PRINTD PRSO
	PRINTI " is square, about ten inches on each side. It has a number of microchips, some printed circuitry, and a message printed in microscopic letters. There are also eight "
	PRINTD DIPSWITCH
	PRINTR "es, marked:
  1  Cholesterol Register
  2  MSG Specifier
  3  Thiamin Stack
  4  Piquant-O-Mat
  5  Flavour Dump
  6  Vitamin Interrupts
  7  Nose Sequencer
  8  Bouquet Arbitration Bus"
?L3:	EQUAL? PRSA,V?MUNG \?L6
	MOVE BOARD,LOCAL-GLOBALS
	PRINTI "It's all the device deserves. It shatters with a satisfying crunch."
	CRLF
	CALL PRINT-ID,STR?149 >STACK
	RSTACK
?L6:	EQUAL? PRSA,V?EXAMINE-THROUGH,V?READ \?L9
	EQUAL? PRSI,MAGNIFYING-GLASS \?L9
	PRINTR "The message reads ""This is just a satirical device. It has no practical function."""
?L9:	EQUAL? PRSA,V?READ \FALSE
	PRINTR "The message is too small for you to read."

	.FUNCT DIPSWITCH-F
	EQUAL? PRSA,V?LAMP-ON,V?THROW,V?TURN /?L3
	EQUAL? PRSA,V?MOVE,V?PUSH,V?LAMP-OFF \FALSE
?L3:	PRINTI "Switched."
	IN? BOARD,NUTRIMAT \?L6
	PRINTI " Some lights on the "
	PRINTD NUTRIMAT
	PRINTR " flash briefly. A promising hum quickly dies away."
?L6:	CRLF
	RTRUE

	.FUNCT SUBSTITUTE-DESCFCN,X
	CALL DESCRIBE-DRINK,SUBSTITUTE >STACK
	RSTACK

	.FUNCT SUBSTITUTE-F
	EQUAL? PRSA,V?DRINK-FROM,V?ENJOY,V?DRINK \?L1
	CALL HELD?,SUBSTITUTE >STACK
	ZERO? STACK \?L3
	PRINT NOT-HOLDING
	PRINTR " the cup!"
?L3:	GRTR? SCORE,300 \?L7
	PRINTR "You'd rather continue savouring that delicious tea."
?L7:	ZERO? SUBSTITUTE-DRUNK /?L10
	SUB SCORE,30 >SCORE
	SET 'DREAMING,0
	PRINTI "That last gulp of the vile "
	PRINTD SUBSTITUTE
	CALL PRINT-ID,STR?150
	CALL JIGS-UP,STR?151
	RTRUE
?L10:	EQUAL? SUBSTITUTE,BROWNIAN-SOURCE \?L14
	SET 'BROWNIAN-SOURCE,0
?L14:	SET 'SUBSTITUTE-DRUNK,1
	SUB SCORE,30 >SCORE
	MOVE SUBSTITUTE,PAD
	PRINTI "It tastes almost, but not quite, entirely unlike tea. It's absolutely disgusting."
	CALL ANTI-LITTER,STR?77
	EQUAL? HERE,GALLEY \?L19
	PRINTI " "
	CALL PERFORM,V?KILL,NUTRIMAT
	RTRUE
?L19:	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \?L24
	PRINTI "About the only characteristic it shares with tea is that of"
	PRINT BROWNIAN
	PRINTI "."
	EQUAL? PRSO,BROWNIAN-SOURCE \?L27
	PRINTI " "
	CALL PERFORM,V?EXAMINE,DANGLY-BIT
	RTRUE
?L27:	CRLF
	RTRUE
?L24:	EQUAL? PRSA,V?THROW,V?POUR \FALSE
	CALL LIQUID-SPILL >STACK
	RSTACK

	.FUNCT INTERFACE-BOX-F
	EQUAL? PRSA,V?EXAMINE,V?READ \FALSE
	PRINTI "The carton is labelled """
	PRINTD NUT-COM-INTERFACE
	PRINTI "."""
	CRLF
	EQUAL? PRSA,V?EXAMINE \TRUE
	RFALSE

	.FUNCT BEAST-GUN-F
	EQUAL? PRSA,V?READ,V?EXAMINE \FALSE
	PRINTI "The gun has a large label which reads ""Anti-Bugblatter Beast Ray Gun."""
	CALL FINE-PRODUCT
	CRLF
	RTRUE

	.FUNCT I-TEA
	INC 'TEA-COUNTER
	EQUAL? HERE,GALLEY /?L1
	LESS? TEA-COUNTER,7 /FALSE
?L1:	CRLF
	EQUAL? TEA-COUNTER,1 \?L4
	PRINTR "The nutrimat begins to whirr."
?L4:	EQUAL? TEA-COUNTER,2 \?L8
	PRINTR "A red sign lights up saying:
   MEMORY OVERLOAD"
?L8:	EQUAL? TEA-COUNTER,3 \?L11
	PRINTR "Another red sign lights up saying:
   RESERVE MEMORY OVERLOAD"
?L11:	EQUAL? TEA-COUNTER,4 \?L14
	PRINTR "A third sign lights up:
   PROCESSOR OVERLOAD,
   SWITCH TO TERMINAL MODE"
?L14:	EQUAL? TEA-COUNTER,5 \?L17
	PRINTR "A blue sign lights up:
   NUTRIMAT GOING ON LINE"
?L17:	EQUAL? TEA-COUNTER,6 \?L20
	PRINTR "More and more signs light up:
   SHIPBOARD COMPUTER ACCESSED
   MAIN MEMORY OVERLOAD
   RESERVE MEMORY ACCESSED
   PARALLEL PROCESSORS ON LINE

   ****************************
   ** NUMBERS BEING CRUNCHED **
   ****************************"
?L20:	EQUAL? TEA-COUNTER,7 \?L23
	FSET THUMB,MUNGEDBIT
	PRINT ANNOUNCEMENT
	PRINTD EDDIE
	PRINTI ". Emergency situation! Nuclear missiles have just been launched at us from the approaching planet, which my data banks indicate is"
	PRINT LOST-PLANET
	PRINTI ". I cannot perform evasive maneuvers because"
	PRINT ENGAGED
	PRINTD NUTRIMAT
	PRINTR ". The missiles will turn this ship into a huge atomic fireball in approximately eight turns. By the way, somebody didn't finish their spinach at dinner."""
?L23:	LESS? TEA-COUNTER,15 \?L26
	PRINTR "You hear distant sounds of panic: shouts of anger, cries of alarm, pounding feet."
?L26:	CALL INT,I-TEA >STACK
	PUT STACK,0,0
	PRINTI "It seems that the missiles struck "
	PRINTD HEART-OF-GOLD
	CALL PRINT-ID,STR?152
	CALL JIGS-UP,STR?153
	RTRUE

	.FUNCT I-LANDING
	CALL IN-HEART?,PROTAGONIST >STACK
	ZERO? STACK \?L1
	CALL QUEUE,I-LANDING,12 >STACK
	PUT STACK,0,1
	RFALSE
?L1:	MOVE MARVIN,PANTRY
	CALL INT,I-MARVIN >STACK
	PUT STACK,0,0
	SET 'LANDED,1
	CRLF
	PRINT ANNOUNCEMENT
	PRINTD EDDIE
	PRINTI ". We have just landed on"
	PRINT LOST-PLANET
	PRINTR ". I don't want anyone going outside until I've checked the atmosphere, climatic conditions, existence of dangerous wildlife, airborne diseases, volcanic activity, presence of real estate agents, and more than eight thousand other possible dangers. This routine check will take 14.9 years. And don't even think about leaving until I finish, because I'm jamming the hatch."""

	.FUNCT SAUNA-ENTER-F
	CALL UNPLUG-HELD-STUFF
	RANDOM 12 >STACK
	ADD 10,STACK >STACK
	ADD MOVES,STACK >MOVES
	PRINTI "You enter the sauna. After several "
	CALL RUNNING?,I-FORD >STACK
	ZERO? STACK /?L3
	PRINTI "minutes"
	JUMP ?L7
?L3:	PRINTI "hours"
?L7:	PRINTI ", you come out a changed man."
	CALL HELD?,FLOWERPOT >STACK
	ZERO? STACK /?L12
	IN? PLANT,FLOWERPOT \?L12
	ZERO? PLANT-BLOOMED \?L12
	SET 'PLANT-BLOOMED,1
	ADD SCORE,25 >SCORE
	MOVE FRUIT,FLOWERPOT
	PRINTI " You have with you a changed plant."
?L12:	CRLF
	IN? MARVIN,BRIDGE \FALSE
	MOVE MARVIN,PANTRY
	RFALSE

	.FUNCT BRIDGE-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "This is the bridge of "
	PRINTD HEART-OF-GOLD
	PRINTI ". A gangway leads down, and steam comes from an entrance to port. Next to the control console is "
	PRINTD EDDIE
	PRINTI "."
	ZERO? DRIVE-TO-CONTROLS /?L5
	PRINTI " "
	CALL PERFORM,V?EXAMINE,LARGE-RECEPTACLE
	JUMP ?L9
?L5:	CRLF
?L9:	FSET? BRIDGE,NDESCBIT /FALSE
	FSET BRIDGE,NDESCBIT
	CRLF
	PRINTR "At the controls, apparently expecting you and Ford, are a man with more than the usual number of heads (the name ""Zaphod"" is stitched on his shirt) and a dark-haired woman, holding a handbag. Both seem somehow familiar."

	.FUNCT SAUNA-PSEUDO
	EQUAL? PRSA,V?BOARD,V?WALK-TO,V?THROUGH \FALSE
	EQUAL? HERE,BRIDGE \FALSE
	CALL DO-WALK,P?WEST >STACK
	RSTACK

	.FUNCT PEOPLE-PSEUDO
	IN? ZAPHOD,HERE /?L1
	PRINTR "What people?"
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	CALL PERFORM,V?EXAMINE,ZAPHOD
	CALL PERFORM,V?EXAMINE,TRILLIAN
	RTRUE

	.FUNCT EDDIE-F
	EQUAL? EDDIE,WINNER \?L1
	EQUAL? PRSA,V?TELL-ABOUT \?L3
	EQUAL? PRSO,ME \?L3
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,EDDIE,PRSI
	SET 'WINNER,EDDIE
	RTRUE
?L3:	EQUAL? PRSA,V?HELLO \?L5
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,EDDIE
	SET 'WINNER,EDDIE
	RTRUE
?L5:	EQUAL? PRSA,V?WHAT \?L6
	EQUAL? PRSO,OBJECT-OF-GAME \?L6
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,EDDIE,OBJECT-OF-GAME
	SET 'WINNER,EDDIE
	RTRUE
?L6:	EQUAL? PRSA,V?LAMP-ON \?L7
	EQUAL? PRSO,SPARE-DRIVE,MAIN-DRIVE \?L7
	CALL RUNNING?,I-TEA >STACK
	ZERO? STACK /?L8
	PRINTI """Sorry,"
	PRINT ENGAGED
	PRINTD NUTRIMAT
	PRINTR ". I can't do everything, you know."""
?L8:	PRINTI """Sorry, current course for"
	PRINT LOST-PLANET
	PRINTI " can be countermanded only by "
	PRINTD ZAPHOD
	PRINTR "."""
?L7:	EQUAL? PRSA,V?OPEN,V?REPAIR \?L15
	EQUAL? PRSO,HATCH \?L15
	ZERO? LANDED /?L15
	PRINTR """Not until I completely check out the safety of this planet. Please wait approximately fourteen years. In the meantime, have you brushed your teeth lately?"""
?L15:	EQUAL? PRSA,V?YES \?L18
	EQUAL? AWAITING-REPLY,18 \?L18
	CALL V-YES >STACK
	RSTACK
?L18:	EQUAL? PRSA,V?NO \?L19
	EQUAL? AWAITING-REPLY,18 \?L19
	CALL V-NO >STACK
	RSTACK
?L19:	SET 'AWAITING-REPLY,18
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTI "Eddie sighs deeply. ""I can't talk right now. Do you know how difficult it is to pilot a ship as complicated as this one?"""
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?LAMP-OFF \?L23
	PRINTR "You don't know how (fortunately)."
?L23:	EQUAL? PRSA,V?ASK-ABOUT \FALSE
	EQUAL? PRSI,OBJECT-OF-GAME \FALSE
	SET 'AWAITING-REPLY,19
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTI """To pilot "
	PRINTD HEART-OF-GOLD
	PRINTI ", process data requests from the "
	PRINTD NUTRIMAT
	PRINTR " and keep the crew healthy. Read your manual! How do you expect to get anywhere in life? But don't read unless there's enough light."""

	.FUNCT LARGE-RECEPTACLE-F
	ZERO? DRIVE-TO-CONTROLS /FALSE
	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "A "
	PRINTD SPARE-DRIVE
	PRINTR " is plugged into the large receptacle."

	.FUNCT ZAPHOD-F
	EQUAL? IDENTITY-FLAG,ZAPHOD \?L1
	EQUAL? PRSO,PHIL,ZAPHOD \?L3
	CALL PERFORM,PRSA,ME,PRSI
	RTRUE
?L3:	CALL PERFORM,PRSA,PRSO,ME
	RTRUE
?L1:	EQUAL? WINNER,ZAPHOD \?L6
	EQUAL? PRSA,V?TELL-ABOUT \?L7
	EQUAL? PRSO,ME \?L7
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,ZAPHOD,PRSI
	SET 'WINNER,ZAPHOD
	RTRUE
?L7:	EQUAL? PRSA,V?HELLO \?L9
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,ZAPHOD
	SET 'WINNER,ZAPHOD
	RTRUE
?L9:	EQUAL? PRSA,V?WHAT \?L10
	EQUAL? PRSO,OBJECT-OF-GAME \?L10
	PRINT ASK-ABOUT-OBJECT
	CRLF
	RTRUE
?L10:	PRINTI """Shut up, Earthman."""
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L6:	EQUAL? IDENTITY-FLAG,TRILLIAN \?L16
	EQUAL? PRSI,PHIL \?L17
	EQUAL? PRSA,V?GIVE,V?SHOW \?L17
	CALL PERFORM,V?HELLO,PHIL
	RTRUE
?L17:	EQUAL? PRSA,V?TELL,V?HELLO,V?SGIVE /?L20
	EQUAL? PRSA,V?ASK-FOR,V?ASK-ABOUT \?L19
?L20:	EQUAL? PRSO,PHIL \?L19
	IN? PHIL,HERE /?L21
	PRINTR "Phil's not here anymore!"
?L21:	FSET? JACKET-FLUFF,TRYTAKEBIT /?L26
	CALL QUEUE,I-ZAPHOD,3 >STACK
	PUT STACK,0,1
?L26:	PRINTI "Phil must not have noticed you, because he just moved into the "
	EQUAL? HERE,LIVING-ROOM \?L31
	MOVE PHIL,DINING-ROOM
	MOVE CAGE,DINING-ROOM
	PRINTD DINING-ROOM
	JUMP ?L38
?L31:	EQUAL? HERE,DINING-ROOM \?L35
	MOVE PHIL,KITCHEN
	MOVE CAGE,KITCHEN
	PRINTD KITCHEN
	JUMP ?L38
?L35:	MOVE PHIL,LIVING-ROOM
	MOVE CAGE,LIVING-ROOM
	PRINTD LIVING-ROOM
?L38:	PRINTI "."
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L19:	EQUAL? PRSA,V?EXAMINE \?L43
	PRINTR "He is very attractive, if a little weird, and has a slight other-worldly look. You suspect he's a party-crasher, an impression reinforced by his inappropriate garb; he seems clothed for a fancy dress party or something, because he has what appears to be a large birdcage on his shoulder with a black drape over it. The bird inside must be asleep, because you can hear snoring coming from inside it."
?L43:	EQUAL? PRSA,V?PICK-UP \FALSE
	PRINTI "You're not that kind of girl."
	CRLF
	CALL PRINT-ID,STR?154 >STACK
	RSTACK
?L16:	EQUAL? PRSA,V?EXAMINE \?L50
	PRINTR "Zaphod has two heads."
?L50:	EQUAL? PRSA,V?FOLLOW \?L53
	EQUAL? FOLLOW-FLAG,3 \?L54
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L54:	EQUAL? FOLLOW-FLAG,6 \FALSE
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L53:	EQUAL? PRSA,V?ASK-ABOUT \FALSE
	EQUAL? PRSI,OBJECT-OF-GAME \FALSE
	PRINT ASK-ABOUT-OBJECT
	CRLF
	RTRUE

	.FUNCT I-ZAPHOD
	ZERO? ITEM-DROPPED-AT-PARTY /?L1
	CALL QUEUE,I-ZAPHOD,3 >STACK
	PUT STACK,0,1
	CALL RUNNING?,I-HOSTESS >STACK
	ZERO? STACK /FALSE
	MOVE PHIL,HERE
	MOVE CAGE,HERE
	CRLF
	PRINTR "Out of the corner of your eye, you see Phil leering at you. He starts to approach, but then notices the hostess with you and veers away."
?L1:	ADD SCORE,25 >SCORE
	FSET LIVING-ROOM,REVISITBIT
	FSET HOSTESS,NDESCBIT
	CRLF
	CALL PRINT-ID,STR?155
	CALL JIGS-UP,STR?156
	RTRUE

	.FUNCT TRILLIAN-F
	EQUAL? IDENTITY-FLAG,TRILLIAN \?L1
	EQUAL? TRILLIAN,PRSO \?L3
	CALL PERFORM,PRSA,ME,PRSI
	RTRUE
?L3:	CALL PERFORM,PRSA,PRSO,ME
	RTRUE
?L1:	EQUAL? TRILLIAN,WINNER \?L6
	EQUAL? PRSA,V?TELL-ABOUT \?L7
	EQUAL? PRSO,ME \?L7
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,TRILLIAN,PRSI
	SET 'WINNER,TRILLIAN
	RTRUE
?L7:	EQUAL? PRSA,V?HELLO \?L9
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,TRILLIAN
	SET 'WINNER,TRILLIAN
	RTRUE
?L9:	EQUAL? PRSA,V?WHAT \?L10
	EQUAL? PRSO,OBJECT-OF-GAME \?L10
	PRINT ASK-ABOUT-OBJECT
	CRLF
	RTRUE
?L10:	EQUAL? PRSA,V?SHOOT \?L15
	IN? BLASTER,TRILLIAN \?L15
	EQUAL? PRSO,RIFLES /?L14
?L15:	EQUAL? PRSA,V?SSHOOT \?L13
	IN? BLASTER,TRILLIAN \?L13
	EQUAL? PRSI,RIFLES \?L13
?L14:	MOVE BLASTER,PROTAGONIST
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?SHOOT,RIFLES,BLASTER
	SET 'WINNER,TRILLIAN
	MOVE BLASTER,TRILLIAN
	RTRUE
?L13:	EQUAL? IDENTITY-FLAG,ZAPHOD \?L16
	PRINTI """Shut up, you jerk!"" hisses "
	PRINTD TRILLIAN
	PRINTI ". ""Just get on with the plan."""
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L16:	PRINTD TRILLIAN
	PRINTI " smiles disinterestedly at you and looks away."
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L6:	EQUAL? PRSA,V?SHOOT \?L22
	EQUAL? PRSI,BLASTER \?L22
	PRINTI "How heartless! Fortunately, justice prevails as the guards"
	CALL PRINT-ID,STR?157
	CALL GUARD-DEATH
	RTRUE
?L22:	EQUAL? PRSA,V?ASK-ABOUT \?L25
	EQUAL? PRSI,OBJECT-OF-GAME \?L25
	PRINT ASK-ABOUT-OBJECT
	CRLF
	RTRUE
?L25:	EQUAL? FOLLOW-FLAG,3 \?L28
	EQUAL? PRSA,V?FOLLOW \?L28
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L28:	EQUAL? PRSA,V?EXAMINE \FALSE
	IN? BLASTER,TRILLIAN \FALSE
	PRINTR "She's holding a blaster at your head."

	.FUNCT HANDBAG-F
	EQUAL? PRSA,V?THROW,V?DROP \?L1
	EQUAL? IDENTITY-FLAG,TRILLIAN \?L1
	CALL DROP-AT-PARTY >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?TAKE \FALSE
	IN? HANDBAG,TRILLIAN \FALSE
	PRINTD TRILLIAN
	PRINTI " pulls it away."
	CRLF
	CALL PRINT-ID,STR?158 >STACK
	RSTACK

	.FUNCT FORE-CORRIDOR-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "This is one end of a short corridor that continues "
	EQUAL? HERE,FORE-CORRIDOR \?L5
	PRINTI "aft"
	JUMP ?L9
?L5:	PRINTI "fore"
?L9:	PRINTI " along the main deck of "
	PRINTD HEART-OF-GOLD
	PRINTI ". Doorways lead to "
	EQUAL? HERE,FORE-CORRIDOR \?L14
	PRINTI "fore"
	JUMP ?L18
?L14:	PRINTI "aft"
?L18:	PRINTI " and port. In addition, a gangway leads "
	EQUAL? HERE,FORE-CORRIDOR \?L23
	PRINTI "up"
	JUMP ?L27
?L23:	PRINTI "down"
?L27:	PRINTR "ward."

	.FUNCT AFT-CORRIDOR-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	FCLEAR HATCH,DOORBIT
	RFALSE
?L1:	EQUAL? RARG,M-LOOK \FALSE
	CALL FORE-CORRIDOR-F,M-LOOK >STACK
	RSTACK

	.FUNCT I-REPLY
	SET 'AWAITING-REPLY,0
	RFALSE

	.FUNCT ENGINE-ROOM-ENTER-F
	INC 'ARGUMENT-COUNTER
	EQUAL? ARGUMENT-COUNTER,1 \?L1
	SET 'AWAITING-REPLY,1
	CALL QUEUE,I-ARGUMENT,2 >STACK
	PUT STACK,0,1
	PRINTI "That entrance leads to the"
	PRINT IID
	PRINTI " chamber. It's supposed to be a terribly dangerous area of the ship. Are you sure you want to go in there?"
	CRLF
	RFALSE
?L1:	EQUAL? ARGUMENT-COUNTER,2 \?L5
	SET 'AWAITING-REPLY,1
	CALL QUEUE,I-ARGUMENT,2 >STACK
	PUT STACK,0,1
	PRINTI "Absolutely sure?"
	CRLF
	RFALSE
?L5:	EQUAL? ARGUMENT-COUNTER,3 \?L8
	CALL INT,I-ARGUMENT >STACK
	PUT STACK,0,0
	SET 'AWAITING-REPLY,100
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTI "I can tell you don't want to really. You stride away with a spring in your step, wisely leaving the Drive Chamber safely behind you. Telegrams arrive from well-wishers in all corners of the Galaxy congratulating you on your prudence and wisdom, cheering you up immensely."
	CRLF
	RFALSE
?L8:	EQUAL? ARGUMENT-COUNTER,4 \?L11
	CALL QUEUE,I-ARGUMENT,2 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	SET 'AWAITING-REPLY,2
	PRINTI "What? You're joking, of course. Can I ask you to reconsider?"
	CRLF
	RFALSE
?L11:	GRTR? ARGUMENT-COUNTER,4 \FALSE
	CALL INT,I-ARGUMENT >STACK
	PUT STACK,0,0
	SET 'AWAITING-REPLY,0
	RETURN ENGINE-ROOM

	.FUNCT I-ARGUMENT
	EQUAL? PRSA,V?NO \?L4
	EQUAL? AWAITING-REPLY,1 /?L5
?L4:	EQUAL? PRSA,V?YES \?L1
	EQUAL? AWAITING-REPLY,2 /?L5
?L1:	CRLF
?L5:	SET 'AWAITING-REPLY,0
	SET 'ARGUMENT-COUNTER,0
	PRINTR "I knew you weren't serious about entering that extremely dangerous area."

	.FUNCT ENTRY-BAY-F,RARG
	EQUAL? RARG,M-ENTER \FALSE
	SET 'IDENTITY-FLAG,ARTHUR
	MOVE HATCH,GLOBAL-OBJECTS
	MOVE MECHANISM,GLOBAL-OBJECTS
	MOVE ARTHUR,GLOBAL-OBJECTS
	FSET? ENTRY-BAY,NDESCBIT \?L3
	MOVE FORD,LOCAL-GLOBALS
	MOVE TRILLIAN,LOCAL-GLOBALS
	MOVE ZAPHOD,LOCAL-GLOBALS
	RFALSE
?L3:	FSET ENTRY-BAY,NDESCBIT
	CALL QUEUE,I-FORD,1 >STACK
	PUT STACK,0,1
	RFALSE

	.FUNCT SALES-BROCHURE-F
	EQUAL? PRSA,V?READ \FALSE
	PRINTI """Equipped with a sensational breakthrough in Improbability Physics, "
	PRINTD HEART-OF-GOLD
	PRINTI " will make you the envy of every major government. When the ship's"
	PRINT IID
	PRINTI " is activated, "
	PRINTD HEART-OF-GOLD
	PRINTI " passes through every point in the universe simultaneously, making travel to any single location a breeze!""

The "
	PRINTD SALES-BROCHURE
	PRINTI " goes on to describe the ship's complement of "
	PRINT SCC
	PRINTI "-designed robots and computers, all equipped with GPP ("
	PRINT GPP
	PRINTR ")."

	.FUNCT ENGINE-ROOM-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	INC 'LOOK-COUNTER
	EQUAL? LOOK-COUNTER,1 \?L3
	PRINTI "You're in the"
	PRINT IID
	PRINTR " chamber. Nothing happens; there is nothing to see."
?L3:	EQUAL? LOOK-COUNTER,2 \?L7
	PRINTR "I mean it! There's nothing to see here!"
?L7:	GRTR? LOOK-COUNTER,2 \FALSE
	EQUAL? LOOK-COUNTER,3 \?L11
	MOVE MAIN-DRIVE,GLOBAL-OBJECTS
	MOVE SPARE-DRIVE,HERE
	MOVE PLIERS,HERE
	MOVE RASP,HERE
	ADD SCORE,25 >SCORE
	PRINTI "Okay, okay, there are a FEW things to see here. "
?L11:	PRINTI "This is the room that houses the powerful In"
	PRINT FIG
	PRINTI " that drives "
	PRINTD HEART-OF-GOLD
	PRINTR ". An exit lies fore of here."
?L1:	EQUAL? RARG,M-END \FALSE
	EQUAL? LOOK-COUNTER,3 \FALSE
	SET 'LOOK-COUNTER,4
	CRLF
	PRINTR "(Footnote 10)"

	.FUNCT MAIN-DRIVE-F
	EQUAL? PRSA,V?RUB,V?EXAMINE \?L1
	EQUAL? HERE,ENGINE-ROOM /?L1
	CALL CANT-SEE,MAIN-DRIVE >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?LAMP-ON \FALSE
	PRINTI "Only "
	PRINTD EDDIE
	PRINTR " can activate the drive."

	.FUNCT SPARE-DRIVE-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "The "
	PRINTD SPARE-DRIVE
	PRINTI " has a switch"
	IN? LARGE-PLUG,SPARE-DRIVE \?L5
	PRINTI ", a long cord "
	ZERO? DRIVE-TO-CONTROLS /?L9
	PRINTI "plugged into the control console,"
	JUMP ?L16
?L9:	PRINTI "ending with a "
	PRINTD LARGE-PLUG
	PRINTI ","
	JUMP ?L16
?L5:	PRINTI ", a fused spot where a long cord once began,"
?L16:	PRINTI " and a short cord "
	ZERO? DRIVE-TO-PLOTTER /?L21
	PRINTI "plugged into the "
	PRINTD PLOTTER
	JUMP ?L25
?L21:	PRINTI "ending with a "
	PRINTD SMALL-PLUG
?L25:	PRINTI "."
	CALL FINE-PRODUCT
	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?TIE,V?PLUG \?L32
	EQUAL? PRSO,SPARE-DRIVE /?L31
?L32:	EQUAL? PRSA,V?PUT \?L30
	EQUAL? PRSI,SMALL-RECEPTACLE,LARGE-RECEPTACLE \?L30
?L31:	IN? LARGE-PLUG,SPARE-DRIVE \?L33
	PRINTI "In case you hadn't noticed, there are two connections leading from the "
	PRINTD SPARE-DRIVE
	PRINTR "..."
?L33:	CALL PERFORM,V?PLUG,SMALL-PLUG,PRSI
	RTRUE
?L30:	EQUAL? PRSA,V?UNPLUG \?L38
	ZERO? DRIVE-TO-CONTROLS \?L41
	ZERO? DRIVE-TO-PLOTTER /?L39
?L41:	SET 'DRIVE-TO-PLOTTER,0
	SET 'DRIVE-TO-CONTROLS,0
	FCLEAR SPARE-DRIVE,NDESCBIT
	PRINTR "Done."
?L39:	PRINT NOT-PLUGGED
	CRLF
	RTRUE
?L38:	EQUAL? PRSA,V?LAMP-ON \?L47
	CALL PERFORM,V?LAMP-ON,SWITCH
	RTRUE
?L47:	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	CALL V-CARVE >STACK
	RSTACK

	.FUNCT LARGE-PLUG-F
	EQUAL? PRSA,V?TIE,V?PUT,V?PLUG \?L1
	EQUAL? PRSI,CONTROLS,LARGE-RECEPTACLE \?L1
	ZERO? DRIVE-TO-CONTROLS /?L3
	PRINTR "It already is!"
?L3:	SET 'DRIVE-TO-CONTROLS,1
	FSET SPARE-DRIVE,NDESCBIT
	PRINTI "Plugged."
	CALL RUNNING?,I-TEA >STACK
	ZERO? STACK \?L10
	PRINTI " "
	PRINTD EDDIE
	PRINTI " says ""You shouldn't be playing around with a "
	PRINTD SPARE-DRIVE
	PRINTI ". Who knows where it's been?"""
	CRLF
	CRLF
	PRINT ANNOUNCEMENT
	PRINTD EDDIE
	PRINTI ". Someone has connected a "
	PRINTD SPARE-DRIVE
	PRINTI " to"
	PRINT MOP
	PRINTI ". Better be an emergency, that's all I have to say."""
?L10:	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?TAKE \?L15
	EQUAL? PRSI,CONTROLS \?L15
	CALL PERFORM,V?UNPLUG,LARGE-PLUG
	RTRUE
?L15:	EQUAL? PRSA,V?REMOVE,V?UNPLUG \FALSE
	ZERO? DRIVE-TO-CONTROLS /?L17
	SET 'DRIVE-TO-CONTROLS,0
	FCLEAR SPARE-DRIVE,NDESCBIT
	PRINTR "Done."
?L17:	PRINT NOT-PLUGGED
	CRLF
	RTRUE

	.FUNCT SMALL-PLUG-F
	EQUAL? PRSA,V?TIE,V?PUT,V?PLUG \?L1
	EQUAL? PRSI,PLOTTER,SMALL-RECEPTACLE \?L1
	ZERO? DRIVE-TO-PLOTTER /?L3
	PRINTR "It already is!"
?L3:	SET 'DRIVE-TO-PLOTTER,1
	PRINTR "Plugged."
?L1:	EQUAL? PRSA,V?TAKE \?L10
	EQUAL? PRSI,PLOTTER \?L10
	CALL PERFORM,V?UNPLUG,SMALL-PLUG
	RTRUE
?L10:	EQUAL? PRSA,V?REMOVE,V?UNPLUG \FALSE
	ZERO? DRIVE-TO-PLOTTER /?L12
	SET 'DRIVE-TO-PLOTTER,0
	PRINTR "Done."
?L12:	PRINT NOT-PLUGGED
	CRLF
	RTRUE

	.FUNCT SWITCH-F
	EQUAL? PRSA,V?PUSH,V?TURN,V?LAMP-ON /?L3
	EQUAL? PRSA,V?THROW,V?MOVE \FALSE
?L3:	ZERO? DRIVE-TO-PLOTTER /?L4
	ZERO? BROWNIAN-SOURCE /?L4
	MOVE SPARE-DRIVE,HERE
	MOVE PLOTTER,HERE
	MOVE BROWNIAN-SOURCE,HERE
	EQUAL? BROWNIAN-SOURCE,TEA \?L6
	SET 'HOLDING-NO-TEA,1
?L6:	ZERO? DRIVE-TO-CONTROLS /?L9
	PRINTI "As you flip the switch, sparks fly from the large receptacle. "
	CALL PRINT-ID,STR?159
	CALL RUNNING?,I-TEA >STACK
	ZERO? STACK /?L13
	GRTR? TEA-COUNTER,6 \?L13
	PRINTI """My new control console!"" wails "
	PRINTD EDDIE
	PRINTI ". ""This is the thanks I get"
	JUMP ?L17
?L13:	PRINTI """Now look what you've done. You've destroyed"
	PRINT MOP
	PRINTI ". Don't you know it's only for emergencies"
?L17:	PRINTI "?"""
	CRLF
	CRLF
	SET 'DRIVE-TO-CONTROLS,0
	FCLEAR SPARE-DRIVE,NDESCBIT
	MOVE LARGE-PLUG,LOCAL-GLOBALS
	MOVE LARGE-RECEPTACLE,LOCAL-GLOBALS
	CALL RUNNING?,I-TEA >STACK
	ZERO? STACK /?L22
	GRTR? TEA-COUNTER,6 \?L22
	MOVE TEA,SLOT
	CALL INT,I-TEA >STACK
	PUT STACK,0,0
	CALL QUEUE,I-LANDING,24 >STACK
	PUT STACK,0,1
	SET 'FOLLOW-FLAG,3
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	PRINTI "The universe goes crazy for a moment."
	CRLF
	CRLF
	PRINT ANNOUNCEMENT
	PRINTD EDDIE
	PRINTI ". The missiles have turned into a sperm whale"
	CALL FACTOR,STR?160
	PRINTI " The whale is currently plummeting toward"
	PRINT LOST-PLANET
	PRINTI ". I hope this will teach you to listen to me when I say that legendary lost planets can be dangerous. I am proceeding with the pre-set landing instructions.""

Ford, Zaphod, and "
	PRINTD TRILLIAN
	PRINTI " saunter by on their way back to the sauna. ""Good work, kid,"" says Zaphod, slamming you on the back."
	CRLF
	CALL PRINT-ID,STR?161 >STACK
	RSTACK
?L22:	CALL INT,I-TEA >STACK
	PUT STACK,0,0
	SUB SCORE,30 >SCORE
	PRINT ANNOUNCEMENT
	PRINTD EDDIE
	PRINTI ". Someone has activated a "
	PRINTD SPARE-DRIVE
	PRINTI " at"
	PRINT MOP
	PRINTI ", moving us 8 billion parsecs away from our destination, adding seven weeks to our trip. As if that isn't bad enough, all 300 members of the Fronurbdi Planetary Senate appeared in the "
	PRINTD HATCHWAY
	CALL FACTOR,STR?162
	PRINTI " I'm flushing them into space now, but who knows what sort of germs they've dragged into the ship? Everyone should take extra vitamins today."""
	CRLF
	CALL PRINT-ID,STR?163 >STACK
	RSTACK
?L9:	CALL RUNNING?,I-TEA >STACK
	ZERO? STACK /?L33
	SET 'DREAMING,1
	CALL INT,I-TEA >STACK
	PUT STACK,0,0
	CALL PRINT-ID,STR?164
	CALL JIGS-UP,STR?165
	RTRUE
?L33:	EQUAL? BROWNIAN-SOURCE,TEA \?L35
	SET 'DARK-CONTROLLED,1
?L35:	MOVE HATCH,LOCAL-GLOBALS
	MOVE MECHANISM,LOCAL-GLOBALS
	CALL PICK-ONE,DARK-ENTRANCES >STACK
	PRINT STACK
	CRLF
	CRLF
	CALL GOTO,DARK
	RTRUE
?L4:	PRINTR "Nothing happens."

	.FUNCT PLOTTER-DESCFCN,X
	PRINTI "Lying on the deck is a plotter"
	ZERO? DRIVE-TO-PLOTTER /?L3
	PRINTI " connected to a "
	PRINTD SPARE-DRIVE
	PRINTI "."
	JUMP ?L7
?L3:	PRINTI "."
?L7:	ZERO? BROWNIAN-SOURCE /?L10
	PRINTI " The plotter's "
	PRINTD DANGLY-BIT
	PRINTI " is submerged in "
	PRINTD BROWNIAN-SOURCE
	PRINTI "."
?L10:	CRLF
	RTRUE

	.FUNCT PLOTTER-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "The "
	PRINTD PRSO
	PRINTI " has a "
	PRINTD SMALL-RECEPTACLE
	PRINTI " and a "
	PRINTD DANGLY-BIT
	ZERO? BROWNIAN-SOURCE /?L5
	PRINTI " which is sitting in "
	PRINTD BROWNIAN-SOURCE
?L5:	ZERO? DRIVE-TO-PLOTTER /?L10
	PRINTI ". The short cord from the "
	PRINTD SPARE-DRIVE
	PRINTI " is plugged in the receptacle"
?L10:	PRINTI "."
	CALL FINE-PRODUCT
	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?PLUG \?L17
	EQUAL? PRSI,SPARE-DRIVE \?L17
	CALL PERFORM,V?PLUG,SPARE-DRIVE,PLOTTER
	RTRUE
?L17:	EQUAL? PRSA,V?UNPLUG \?L18
	ZERO? DRIVE-TO-PLOTTER /?L19
	SET 'DRIVE-TO-PLOTTER,0
	PRINTR "Unplugged."
?L19:	PRINT NOT-PLUGGED
	CRLF
	RTRUE
?L18:	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	CALL V-CARVE >STACK
	RSTACK

	.FUNCT DANGLY-BIT-F
	EQUAL? PRSA,V?PUT \?L1
	EQUAL? PRSI,TEA,SUBSTITUTE \?L1
	ZERO? BROWNIAN-SOURCE /?L3
	PRINTI "But the "
	PRINTD DANGLY-BIT
	PRINTI " is already in"
	CALL ARTICLE,BROWNIAN-SOURCE,1
	PRINTR "!"
?L3:	SET 'BROWNIAN-SOURCE,PRSI
	EQUAL? PRSI,TEA \?L10
	ZERO? CARELESS-WORDS-FLAG \?L10
	SET 'CARELESS-WORDS-FLAG,1
	CALL SAVE-INPUT,FIRST-BUFFER
	CALL QUEUE,I-CARELESS-WORDS,3 >STACK
	PUT STACK,0,1
?L10:	PRINTR "Done."
?L1:	EQUAL? PRSA,V?EXAMINE \?L15
	ZERO? BROWNIAN-SOURCE /?L15
	PRINTI "The "
	PRINTD DANGLY-BIT
	PRINTI " is suspended in the cup of "
	PRINTD BROWNIAN-SOURCE
	PRINTR "."
?L15:	EQUAL? PRSA,V?REMOVE \FALSE
	ZERO? BROWNIAN-SOURCE /FALSE
	PRINTI "The "
	PRINTD DANGLY-BIT
	PRINTI " is no longer suspended in"
	CALL ARTICLE,BROWNIAN-SOURCE,1
	PRINTI "."
	CRLF
	SET 'BROWNIAN-SOURCE,0
	RTRUE

	.FUNCT HATCHWAY-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "You are at the bottom of a gangway. A hatch below you is "
	FSET? HATCH,OPENBIT \?L5
	PRINTI "open"
	JUMP ?L9
?L5:	PRINTI "closed"
?L9:	PRINTR ". There is a small access space to starboard."
?L1:	EQUAL? RARG,M-ENTER \FALSE
	FSET HATCH,DOORBIT
	RFALSE

	.FUNCT ACCESS-SPACE-ENTER-F
	CALL ACCESS-SPACE-LOOP,PROTAGONIST >STACK
	GRTR? STACK,1 \?L1
	PRINTI "That entrance is so narrow that you probably couldn't pass by holding anything. Well, maybe ONE thing."
	CRLF
	RFALSE
?L1:	FCLEAR HATCH,DOORBIT
	RETURN ACCESS-SPACE

	.FUNCT ACCESS-SPACE-LOOP,CONT,X,NUMBER
	FIRST? CONT >X /?L4
	RETURN NUMBER
?L4:	FSET? X,WORNBIT /?L7
	FSET? X,INTEGRALBIT /?L7
	EQUAL? X,BABEL-FISH /?L7
	INC 'NUMBER
?L7:	FIRST? X >STACK \?L10
	CALL ACCESS-SPACE-LOOP,X >STACK
	ADD NUMBER,STACK >NUMBER
?L10:	NEXT? X >X /?L4
	RETURN NUMBER

	.FUNCT HATCH-F
	EQUAL? HERE,HATCHWAY /?L1
	EQUAL? PRSA,V?EXAMINE,V?CLOSE,V?OPEN /?L3
	EQUAL? PRSA,V?RUB \?L1
?L3:	CALL CANT-SEE,HATCH >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?THROUGH,V?OPEN \FALSE
	ZERO? LANDED \?L4
	PRINTI "Loud sirens blare, fantastically bright red lights flash from all sides, and a soft female voice mentions that opening this hatch in space will evacuate the air from the ship."
	CRLF
	CALL PRINT-ID,STR?166 >STACK
	RSTACK
?L4:	EQUAL? PRSA,V?THROUGH,V?OPEN \FALSE
	FSET? HATCH,OPENBIT /FALSE
	PRINTR "The hatch appears to be jammed shut."

	.FUNCT MECHANISM-F
	EQUAL? HERE,ACCESS-SPACE /?L1
	EQUAL? PRSA,V?RUB,V?SMELL,V?EXAMINE /?L3
	EQUAL? PRSA,V?REPAIR \?L4
?L3:	CALL CANT-SEE,MECHANISM >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?REPAIR \?L4
	CALL PERFORM,V?REPAIR,HATCH
	RTRUE
?L4:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "I don't even understand it, and I'm a computer!"

	.FUNCT ACCESS-SPACE-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "This tiny area, with an exit to port, is for working on the hatch "
	PRINTD MECHANISM
	PRINTI ", which is vastly more complicated than your rather ordinary intelligence can comprehend. "
	CALL PERFORM,V?EXAMINE,GROUND
	RTRUE

	.FUNCT MESH-PSEUDO
	EQUAL? PRSI,PSEUDO-OBJECT \?L1
	CALL PERFORM,PRSA,PRSO,GROUND
	RTRUE
?L1:	CALL PERFORM,PRSA,GROUND,PRSI
	RTRUE

	.FUNCT RAMP-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	PRINTI "You step onto the landing ramp leading down toward the surface of"
	PRINT LOST-PLANET
	PRINTI ". "
	PRINT ANNOUNCEMENT
	PRINTD EDDIE
	PRINTI ". Someone is leaving the ship on a strange planet without wrapping up all nice and warm. It'll all end in tears, I just know it..."" The voice fades behind you."
	CRLF
	CRLF
	RTRUE
?L1:	EQUAL? RARG,M-END \FALSE
	CRLF
	PRINTI "Slowly, nervously, you step downwards, the cold thin air rasping in your lungs. You set one single foot on the ancient dust -- and almost instantly the most incredible adventure starts which you'll have to buy the next game to find out about."
	CRLF
	CRLF
	PRINTI "By the way, there WAS a causal relationship between your taking the "
	PRINTD TOOTHBRUSH
	PRINTI " and the tree collapsing at the very beginning of the game. We apologise for this slight inaccuracy."
	CRLF
	ADD SCORE,10 >SCORE
	CALL FINISH >STACK
	RSTACK

	.FUNCT HOME-F
	ZERO? HOUSE-DEMOLISHED /?L1
	EQUAL? PRSA,V?ENJOY \?L1
	PRINT ZEN
	PRINTI " You can't enjoy a "
	PRINTD RUBBLE
	PRINTR " properly till it's at least a hundred years old. Also, you are haunted by the tragic vision of your favourite teapot lying shattered among the dust.
There is also the matter of all your clothes."
?L1:	EQUAL? PRSA,V?BOARD,V?WALK-TO,V?THROUGH \?L5
	EQUAL? HERE,FRONT-OF-HOUSE,FRONT-PORCH \?L6
	CALL DO-WALK,P?NORTH >STACK
	RSTACK
?L6:	EQUAL? HERE,BEDROOM \?L8
	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L8:	CALL V-WALK-AROUND >STACK
	RSTACK
?L5:	EQUAL? PRSA,V?DISEMBARK,V?EXIT,V?LEAVE \?L12
	EQUAL? HERE,FRONT-PORCH \?L13
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L13:	EQUAL? HERE,BEDROOM \?L15
	CALL V-WALK-AROUND >STACK
	RSTACK
?L15:	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L12:	EQUAL? PRSA,V?LIE-DOWN \?L19
	EQUAL? HERE,FRONT-OF-HOUSE \?L19
	ZERO? IN-FRONT-FLAG /?L19
	CALL PERFORM,V?LIE-DOWN,GROUND
	RTRUE
?L19:	EQUAL? PRSA,V?EXAMINE \?L20
	ZERO? HOUSE-DEMOLISHED /?L20
	PRINTI "It is now a "
	PRINTD RUBBLE
	PRINTR "."
?L20:	EQUAL? IDENTITY-FLAG,FORD \FALSE
	CALL UNIMPORTANT-THING-F >STACK
	RSTACK

	.FUNCT HOUSE-F
	EQUAL? PRSO,HOUSE \?L1
	CALL PERFORM,PRSA,HOME,PRSI
	RTRUE
?L1:	CALL PERFORM,PRSA,PRSO,HOME
	RTRUE

	.FUNCT I-HOUSEWRECK
	EQUAL? HERE,BEDROOM,FRONT-PORCH \FALSE
	CRLF
	PRINTI "Astoundingly, a "
	PRINTD BULLDOZER
	PRINTI " pokes through your wall. However, you have no time for surprise because the ceiling is collapsing on you as"
	CALL PRINT-ID,STR?167
	CALL BETTER-LUCK >STACK
	RSTACK

	.FUNCT BETTER-LUCK
	PRINTI " your home is unexpectedly demolished to make way for a new bypass. You are seriously injured in the process, but on your way to the hospital"
	CALL MAKE-WAY-FOR
	CRLF
	FSET? BEDROOM,ONBIT /?L3
	PRINTI "Next time, try turning on the light."
	CRLF
	JUMP ?L10
?L3:	FSET? GOWN,OPENBIT /?L7
	ZERO? HEADACHE /?L7
	PRINTI "Too bad you never found an aspirin for your hangover."
	CRLF
	JUMP ?L10
?L7:	PRINTI "Better luck next life."
	CRLF
?L10:	CALL FINISH >STACK
	RSTACK

	.FUNCT HANGOVER-F
	EQUAL? PRSA,V?ASK-ABOUT \?L1
	EQUAL? PRSI,HANGOVER /FALSE
?L1:	ZERO? HEADACHE \?L3
	EQUAL? IDENTITY-FLAG,ZAPHOD /?L3
	PRINTI "You can't feel any"
	EQUAL? HANGOVER,PRSO \?L6
	CALL PRSO-PRINT
	JUMP ?L8
?L6:	CALL PRSI-PRINT
?L8:	PRINTR " here."
?L3:	EQUAL? PRSA,V?EXAMINE \?L11
	CALL V-DIAGNOSE >STACK
	RSTACK
?L11:	EQUAL? PRSA,V?DROP,V?THROW,V?GIVE \FALSE
	CALL V-COUNT >STACK
	RSTACK

	.FUNCT BEDROOM-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "The bedroom is a mess.
It is a small bedroom with a faded carpet and old wallpaper. There is a washbasin, a chair"
	FSET? GOWN,NDESCBIT \?L5
	PRINTI " with a tatty dressing gown slung over it"
?L5:	PRINTR ", and a window with the curtains drawn. Near the exit leading south is a phone."

	.FUNCT BEDROOM-EXIT-F
	FSET? BEDROOM-DOOR,OPENBIT /?L1
	PRINTI "The door is closed."
	CRLF
	SET 'P-IT-OBJECT,BEDROOM-DOOR
	RFALSE
?L1:	ZERO? HEADACHE /?L5
	PRINTI "You miss the doorway by a good eighteen inches. The wall jostles you rather rudely."
	CRLF
	RFALSE
?L5:	FSET? BULLDOZER,INVISIBLE \?L8
	PRINTI "You make your way down to the front porch."
	CRLF
	CRLF
	JUMP ?L11
?L8:	PRINTI "You rush down the stairs in panic."
	CRLF
	CRLF
?L11:	FCLEAR LIGHT,LIGHTBIT
	RETURN FRONT-PORCH

	.FUNCT PHONE-F
	EQUAL? PRSA,V?TAKE \?L1
	FSET? PHONE,TOUCHBIT \?L3
	CALL PERFORM,V?CALL,DAIS
	RTRUE
?L3:	FSET PHONE,TOUCHBIT
	PRINTI "You pick up the receiver."
	PRINT DIALLING-TONE
	FSET? TOOTHBRUSH,TOUCHBIT \?L8
	CALL TWO-TREES
?L8:	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?REPLY \FALSE
	PRINTR "It isn't ringing."

	.FUNCT GLOBAL-BED-F
	EQUAL? GLOBAL-BED,PRSO \?L1
	CALL PERFORM,PRSA,BED,PRSI
	RTRUE
?L1:	CALL PERFORM,PRSA,PRSO,BED
	RTRUE

	.FUNCT BED-F,RARG=0
	EQUAL? RARG,M-BEG \?L1
	EQUAL? PRSA,V?TAKE \?L3
	FSET? PRSO,TAKEBIT \?L3
	IN? PRSO,BED /?L3
	CALL HELD?,PRSO >STACK
	ZERO? STACK \?L3
	PRINTI "You can't reach it from the bed."
	ZERO? HEADACHE /?L7
	PRINTI " The effort almost kills you."
?L7:	CRLF
	RTRUE
?L3:	EQUAL? PRSA,V?LOOK-INSIDE,V?OPEN \?L12
	EQUAL? PRSO,CURTAINS \?L12
	CALL PERFORM,V?TAKE,PHONE
	SET 'P-IT-OBJECT,CURTAINS
	RTRUE
?L12:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L13
	EQUAL? PRSO,BEDROOM-DOOR \?L13
	CALL PERFORM,V?TAKE,PHONE
	SET 'P-IT-OBJECT,BEDROOM-DOOR
	RTRUE
?L13:	EQUAL? PRSA,V?WALK \FALSE
	CALL OUT-OF-FIRST,BED >STACK
	RSTACK
?L1:	ZERO? RARG \FALSE
	EQUAL? PRSA,V?DISEMBARK \?L17
	ZERO? HEADACHE /?L17
	LOC PROTAGONIST >STACK
	EQUAL? STACK,BED \?L17
	MOVE PROTAGONIST,HERE
	SET 'LYING-DOWN,0
	PRINTR "Very difficult, but you manage it. The room is still spinning. It dips and sways a little."
?L17:	EQUAL? PRSA,V?LOOK-UNDER \?L20
	MOVE STUFF-UNDER-BED,HERE
	PRINTR "There's nothing there. Well, there are a few soiled handkerchiefs, a book you thought you'd lost, a couple of foreign coins, and something else which can't be fully described in a family game, but nothing you'd actually want."
?L20:	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	EQUAL? PRSO,BED \FALSE
	CALL TELL-ME-HOW >STACK
	RSTACK

	.FUNCT CURTAINS-F
	EQUAL? PRSA,V?LOOK-INSIDE,V?OPEN \FALSE
	FCLEAR BULLDOZER,INVISIBLE
	PRINTI "As you part "
	PRINTD CURTAINS
	PRINTI " you see that i"
	PRINT NICE-DAY
	PRINTI ", and a large yellow "
	PRINTD BULLDOZER
	PRINTI " is advancing on "
	PRINTD HOME
	PRINTR "."

	.FUNCT GOWN-F
	EQUAL? PRSA,V?CLOSE,V?OPEN \?L1
	FSET? GOWN,WORNBIT /?L1
	PRINTR "It's hard to open or close the pocket unless you're wearing the gown."
?L1:	EQUAL? PRSA,V?EXAMINE \?L5
	PRINTI "The dressing gown is faded and battered, and is clearly a garment which has seen better decades. It has a pocket which is "
	FSET? GOWN,OPENBIT \?L8
	PRINTI "open"
	JUMP ?L12
?L8:	PRINTI "closed"
?L12:	ZERO? GOWN-HUNG /?L15
	PRINTI ". It is hanging from a "
	PRINTD HOOK
	PRINTI "."
	JUMP ?L19
?L15:	PRINTI ", and a small loop at the back of the collar."
?L19:	ZERO? SLEEVE-TIED /?L22
	PRINTI " The sleeves are tied closed."
?L22:	CRLF
	RTRUE
?L5:	EQUAL? PRSA,V?TAKE \?L27
	EQUAL? GOWN,PRSO \?L27
	ZERO? HEADACHE /?L27
	FCLEAR GOWN,TRYTAKEBIT
	FCLEAR GOWN,NDESCBIT
	MOVE GOWN,PROTAGONIST
	PRINTR "Luckily, this is large enough for you to get hold of. You notice something in the pocket."
?L27:	EQUAL? PRSA,V?WEAR \?L30
	ZERO? SLEEVE-TIED /?L30
	PRINTR "You'll have to untie the sleeve first."
?L30:	EQUAL? PRSA,V?UNTIE,V?TIE \FALSE
	CALL PERFORM,PRSA,SLEEVES
	RTRUE

	.FUNCT SLEEVES-F
	CALL VISIBLE?,GOWN >STACK
	ZERO? STACK \?L1
	CALL CANT-SEE,SLEEVES >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?TAKE,V?WEAR \?L3
	CALL PERFORM,PRSA,GOWN
	RTRUE
?L3:	EQUAL? PRSA,V?CLOSE,V?TIE \?L4
	SET 'PRSO,GOWN
	CALL IDROP >STACK
	ZERO? STACK \TRUE
	ZERO? SLEEVE-TIED /?L7
	PRINTR "It is."
?L7:	SET 'SLEEVE-TIED,1
	PRINTR "The sleeves are now tied closed."
?L4:	EQUAL? PRSA,V?OPEN,V?UNTIE \FALSE
	ZERO? SLEEVE-TIED /?L14
	SET 'SLEEVE-TIED,0
	PRINTR "Untied."
?L14:	PRINTR "It isn't tied!"

	.FUNCT TWO-TREES
	SET 'AWAITING-REPLY,9
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTI " Shouldn't you be taking more interest in events in the world around you? While you've got it...?"
	RTRUE

	.FUNCT THING-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "Apart from a label on the bottom saying ""Made in Ibiza"" it furnishes you with no clue as to its purpose, if indeed it has one. You are surprised to see it because you thought you'd thrown it away. Like most gifts from your aunt,"
	PRINT GET-RID
	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?DROP \?L5
	EQUAL? HERE,MAZE,ACCESS-SPACE /?L5
	MOVE THING,HERE
	PRINTR "It falls to the ground with a light ""thunk."" It doesn't do anything else at all."
?L5:	EQUAL? PRSA,V?CLOSE \FALSE
	PRINTR "Come to think of it, you vaguely remember an instruction booklet with directions for that. You never read it and lost it months ago."

	.FUNCT I-THING
	RANDOM 4 >STACK
	ADD 4,STACK >STACK
	CALL QUEUE,I-THING,STACK >STACK
	PUT STACK,0,1
	EQUAL? IDENTITY-FLAG,ARTHUR \FALSE
	EQUAL? HERE,ENGINE-ROOM \?L4
	LESS? LOOK-COUNTER,3 /FALSE
?L4:	EQUAL? HERE,DARK,ACCESS-SPACE,MAZE /FALSE
	CALL VISIBLE?,THING >STACK
	ZERO? STACK \FALSE
	CALL HELD?,THING,PROTAGONIST >STACK
	ZERO? STACK \FALSE
	IN? FLEET,HERE /FALSE
	RANDOM 100 >STACK
	LESS? 40,STACK /?L6
	MOVE THING,HERE
	RFALSE
?L6:	FSET? GOWN,WORNBIT \?L8
	FSET? GOWN,OPENBIT \?L8
	RANDOM 100 >STACK
	LESS? 65,STACK /?L8
	MOVE THING,GOWN
	RFALSE
?L8:	MOVE THING,PROTAGONIST
	RFALSE

	.FUNCT TABLET-F
	EQUAL? PRSA,V?DRINK,V?TAKE,V?EAT \FALSE
	MOVE TABLET,LOCAL-GLOBALS
	FCLEAR SCREWDRIVER,TRYTAKEBIT
	FCLEAR TOOTHBRUSH,TRYTAKEBIT
	SET 'HEADACHE,0
	ADD SCORE,10 >SCORE
	PRINTR "You swallow the tablet. After a few seconds the room begins to calm down and behave in an orderly manner. Your terrible headache goes."

	.FUNCT CLOTHES-EXIT-F
	FSET? GOWN,WORNBIT \?L1
	RETURN FRONT-OF-HOUSE
?L1:	SET 'AWAITING-REPLY,10
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINT ARRESTED
	CRLF
	RFALSE

	.FUNCT MAIL-F
	EQUAL? PRSA,V?TAKE \?L1
	FSET? MAIL,TOUCHBIT /?L1
	FSET MAIL,TOUCHBIT
	FCLEAR MAIL,TRYTAKEBIT
	MOVE MAIL,PROTAGONIST
	PRINTR "You gather up the pile of mail."
?L1:	EQUAL? PRSA,V?OPEN \FALSE
	CALL PERFORM,V?READ,MAIL
	RTRUE

	.FUNCT HOUSE-ENTER-F
	ZERO? HOUSE-DEMOLISHED /?L1
	PRINTI "You can't enter a "
	PRINTD RUBBLE
	PRINTI "."
	CRLF
	RFALSE
?L1:	EQUAL? IDENTITY-FLAG,FORD \?L5
	EQUAL? PRSA,V?THROUGH /?L6
	PRINTI "Enter the house? "
?L6:	CALL PRIVATE,STR?168
	RFALSE
?L5:	ZERO? PROSSER-LYING \?L11
	PRINTI "The "
	PRINTD BULLDOZER
	CALL PRINT-ID,STR?169
	CALL JIGS-UP,STR?170
	RFALSE
?L11:	CALL QUEUE,I-HOUSEWRECK,5 >STACK
	PUT STACK,0,1
	RETURN FRONT-PORCH

	.FUNCT FRONT-OF-HOUSE-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	FCLEAR BULLDOZER,INVISIBLE
	IN? DOG,COUNTRY-LANE \?L3
	ZERO? DOG-FED \?L5
	CALL I-DOG
?L5:	CALL QUEUE,I-VOGONS,3 >STACK
	PUT STACK,0,1
	PRINTI "You reach the site of what was "
	EQUAL? IDENTITY-FLAG,FORD \?L10
	PRINTI "Arthur's"
	JUMP ?L14
?L10:	PRINTI "your"
?L14:	PRINTI " home. It is now a "
	PRINTD RUBBLE
	PRINTI ". "
	PRINTD PROSSER
	PRINTI " looks sheepishly triumphant, a trick few people can do, as it requires a lot of technically complex deltoid muscle work."
	CRLF
	CRLF
	RTRUE
?L3:	EQUAL? IDENTITY-FLAG,FORD /FALSE
	ZERO? PROSSER-LYING \FALSE
	CALL QUEUE,I-BULLDOZER,-1 >STACK
	PUT STACK,0,1
	RFALSE
?L1:	EQUAL? RARG,M-LOOK \?L21
	EQUAL? IDENTITY-FLAG,FORD \?L22
	FSET? FRONT-OF-HOUSE,NDESCBIT /?L22
	FSET BEER,NDESCBIT
	SET 'DRUNK-LEVEL,0
	FSET ARTHUR,NDESCBIT
	FSET FRONT-OF-HOUSE,NDESCBIT
	PRINTI "Before you is the house of your friend, "
	PRINTD ARTHUR
	PRINTI ", who is lying in front of a "
	PRINTD BULLDOZER
	PRINTI "; you have no idea why. You have no idea about most things about Arthur, even why you regard him as a friend, but you do, and must therefore return his towel before you leave."
	JUMP ?L26
?L22:	ZERO? HOUSE-DEMOLISHED /?L27
	PRINTI "There is a huge "
	PRINTD RUBBLE
	JUMP ?L34
?L27:	EQUAL? IDENTITY-FLAG,FORD \?L31
	PRINTI "Arthur's house is"
	JUMP ?L34
?L31:	PRINTI "You can enter your home"
?L34:	PRINTI " to the north. A path leads around it to the northeast and northwest, and a country lane is visible to the south."
?L26:	FSET? FRONT-OF-HOUSE,NDESCBIT /?L39
	EQUAL? IDENTITY-FLAG,ARTHUR \?L39
	FSET FRONT-OF-HOUSE,NDESCBIT
	PRINTI " All that lies between your home and the huge yellow "
	PRINTD BULLDOZER
	PRINTI " bearing down on it is a few yards of mud."
?L39:	CRLF
	CRLF
	RTRUE
?L21:	EQUAL? RARG,M-END \FALSE
	EQUAL? IDENTITY-FLAG,FORD \FALSE
	FSET? ARTHUR,NDESCBIT \FALSE
	FCLEAR ARTHUR,NDESCBIT
	RFALSE

	.FUNCT I-BULLDOZER
	ZERO? LYING-DOWN \?L3
	ZERO? HOUSE-DEMOLISHED /?L1
?L3:	CALL INT,I-BULLDOZER >STACK
	PUT STACK,0,0
	RFALSE
?L1:	FSET PROSSER,TOUCHBIT
	IGRTR? 'BULLDOZER-COUNTER,4 \?L5
	CALL INT,I-BULLDOZER >STACK
	PUT STACK,0,0
	PRINT BULLDOZER-PILES
	CRLF
	CALL BRICK-DEATH >STACK
	RSTACK
?L5:	EQUAL? HERE,FRONT-OF-HOUSE \FALSE
	PRINTI "The "
	PRINTD BULLDOZER
	PRINTR " rumbles slowly toward your home."

	.FUNCT BRICK-DEATH
	CRLF
	PRINTI "Your home collapses in a cloud of dust, and a stray flying brick hits you squarely on the back of the head. You try to think of some suitable last words, but what with the confusion of the moment and the spinning of your head, you are unable to compose anything pithy and expire in silence."
	CALL PRINT-ID,STR?171
?L3:	CRLF
	CRLF
	PRINTI ">"
	READ P-INBUF,P-LEXV
	INC 'DEAD-COUNTER
	EQUAL? DEAD-COUNTER,1,2 \?L5
	PRINTI "You keep out of this, you're dead"
	EQUAL? DEAD-COUNTER,1 \?L9
	PRINTI ". An ambulance arrives."
	JUMP ?L3
?L9:	PRINTI " and should be concentrating on developing a good firm rigor mortis. You are put in the ambulance, which drives away."
	JUMP ?L3
?L5:	EQUAL? DEAD-COUNTER,3 \?L3
	PRINTI "For a dead person you are talking too much. As the ambulance reaches the mortuary"
	CALL MAKE-WAY-FOR
	CALL FINISH
	JUMP ?L3

	.FUNCT BULLDOZER-DRIVER-F
	EQUAL? PRSA,V?HELLO,V?TELL \FALSE
	PRINTI "The "
	PRINTD BULLDOZER-DRIVER
	PRINTI ", perusing a booklet of union rules, ignores you."
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK

	.FUNCT BULLDOZER-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "It's one of those really big "
	PRINTD BULLDOZER
	PRINTI "s that can actually crush other "
	PRINTD BULLDOZER
	PRINTR "s, let alone houses."
?L1:	EQUAL? HERE,FRONT-OF-HOUSE /?L5
	EQUAL? PRSA,V?MOVE,V?PUSH,V?RUB /?L6
	EQUAL? PRSA,V?BLOCK,V?KICK,V?TAKE /?L6
	EQUAL? PRSA,V?WALK-AROUND \?L5
?L6:	PRINTI "The "
	PRINTD BULLDOZER
	PRINTR " isn't here."
?L5:	EQUAL? PRSA,V?LIE-DOWN \?L9
	CALL PRINT-ID,STR?172
	CALL PERFORM,V?BLOCK,BULLDOZER
	RTRUE
?L9:	EQUAL? PRSA,V?BLOCK \?L10
	EQUAL? IDENTITY-FLAG,ARTHUR \?L10
	ZERO? HOUSE-DEMOLISHED /?L11
	PRINTR "Too late now."
?L11:	ZERO? LYING-DOWN /?L15
	CALL PERFORM,V?LIE-DOWN,GROUND
	RTRUE
?L15:	ZERO? PROSSER-LYING /?L16
	PRINTR "Prosser's doing that for you."
?L16:	SET 'LYING-DOWN,1
	CALL QUEUE,I-PROSSER,2 >STACK
	PUT STACK,0,1
	PRINTI "You lie down in the path of the advancing "
	PRINTD BULLDOZER
	PRINTR ". Prosser yells at you to for crissake move!!!"
?L10:	EQUAL? PRSA,V?WALK-AROUND \?L22
	EQUAL? IDENTITY-FLAG,ARTHUR \?L23
	CALL V-DIG >STACK
	RSTACK
?L23:	ZERO? TOWEL-OFFERED \?L25
	PRINTR "Didn't you come here for a purpose? Something about a towel?"
?L25:	ZERO? GONE-AROUND /?L28
	PRINTR "You already did. It's not a merry-go-round."
?L28:	SET 'GONE-AROUND,1
	PRINTI "You walk around the "
	PRINTD BULLDOZER
	PRINTR ". Prosser is standing here, looking cross and frustrated. Realising that you are a friend of Arthur's he starts to talk at you. He says that this sort of protest is all very well, but what Mr. Dent must realise is that he's had plenty of time to make a formal protest at the proper time and place, and that spending months going through the appropriate official channels, filling in the appropriate official forms, and going to the appropriate official public hearings is the right way of going about it, and lying around whimsically in the mud is not. He says that he personally hates mud and despises the sort of people who lie in it."
?L22:	EQUAL? PRSA,V?LISTEN \FALSE
	CALL RUNNING?,I-PROSSER >STACK
	ZERO? STACK /FALSE
	PRINTR """Rumble...rumble..."""

	.FUNCT I-PROSSER
	ZERO? LYING-DOWN \?L1
	CALL INT,I-PROSSER >STACK
	PUT STACK,0,0
	CALL I-BULLDOZER
	RTRUE
?L1:	CALL QUEUE,I-PROSSER,-1 >STACK
	PUT STACK,0,1
	INC 'PROSSER-COUNTER
	CRLF
	EQUAL? PROSSER-COUNTER,1 \?L4
	PRINTI "The "
	PRINTD BULLDOZER
	PRINTR " thunders toward you. The ground is shaking beneath you as you lie in the mud."
?L4:	EQUAL? PROSSER-COUNTER,2 \?L8
	PRINTI "The noise of the giant "
	PRINTD BULLDOZER
	PRINTR " is now so violently loud that you can't even hear Prosser yelling to warn you that you will be killed if you don't get the hell out of the way. You just see him gesticulating wildly."
?L8:	EQUAL? PROSSER-COUNTER,3 \FALSE
	CALL INT,I-PROSSER >STACK
	PUT STACK,0,0
	CALL QUEUE,I-FORD,-1 >STACK
	PUT STACK,0,1
	MOVE FORD,HERE
	SET 'P-IT-OBJECT,TOWEL
	PRINTI "With a terrible grinding of gears the "
	PRINTD BULLDOZER
	PRINTI " comes to an abrupt halt just in front of you. It shakes, shudders, and emits noxious substances all over your rose bed. Prosser is incoherent with rage.

Moments later, your friend "
	PRINTD FORD
	PRINTR " arrives. He hardly seems to notice your predicament, but keeps glancing nervously at the sky. He says ""Hello, Arthur,"" takes a towel from his battered leather satchel, and offers it to you."

	.FUNCT PROSSER-DESCFCN,X
	EQUAL? IDENTITY-FLAG,FORD \?L1
	FSET? PROSSER,TOUCHBIT /?L1
	FSET PROSSER,TOUCHBIT
	PRINTR "Nearby stands an impatient man. There seems to be a bit of an atmosphere."
?L1:	PRINTD PROSSER
	PRINTI ", from the local council, is "
	ZERO? PROSSER-LYING /?L8
	PRINTI "lying in front"
	JUMP ?L15
?L8:	ZERO? GONE-AROUND /?L12
	PRINTI "standing at the side"
	JUMP ?L15
?L12:	PRINT ON-OTHER-SIDE
?L15:	PRINTI " of the "
	PRINTD BULLDOZER
	PRINTI ". He seems to be wearing a "
	PRINTD DIGITAL-WATCH
	PRINTI "."
	FSET? PROSSER,TOUCHBIT /?L20
	FSET PROSSER,TOUCHBIT
	PRINTI " He looks startled to see you emerge, and yells at you to get out of the way."
?L20:	CRLF
	RTRUE

	.FUNCT PROSSER-F
	EQUAL? PROSSER,WINNER \?L1
	IN? FLEET,HERE \?L3
	PRINTI "Prosser is too preoccupied with recent events to give your remarks much consideration. He is running off and saying a number of things about his mother in a high voice."
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?TELL-ABOUT \?L7
	EQUAL? PRSO,ME \?L7
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,PROSSER,PRSI
	SET 'WINNER,PROSSER
	RTRUE
?L7:	EQUAL? PRSA,V?HELLO \?L8
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,PROSSER
	SET 'WINNER,PROSSER
	RTRUE
?L8:	EQUAL? PRSA,V?WHAT \?L12
	EQUAL? PRSO,OBJECT-OF-GAME \?L9
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,PROSSER,OBJECT-OF-GAME
	SET 'WINNER,PROSSER
	RTRUE
?L9:	EQUAL? PRSA,V?WHAT \?L12
	EQUAL? PRSO,TIME /?L11
?L12:	EQUAL? PRSA,V?TELL-TIME \?L13
	EQUAL? PRSO,ME \?L13
	EQUAL? PRSI,TIME /?L11
?L13:	EQUAL? PRSA,V?WHAT-TIME \?L10
	EQUAL? PRSO,TIME \?L10
?L11:	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-FOR,PROSSER,TIME
	SET 'WINNER,PROSSER
	RTRUE
?L10:	EQUAL? PRSA,V?WHAT \?L14
	EQUAL? PRSO,OBJECT-OF-GAME \?L14
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,PROSSER,PRSO
	SET 'WINNER,PROSSER
	RTRUE
?L14:	EQUAL? IDENTITY-FLAG,FORD \?L15
	EQUAL? PRSA,V?LIE-DOWN \?L20
	EQUAL? PRSO,BULLDOZER \?L19
	ZERO? IN-FRONT-FLAG \?L18
?L19:	EQUAL? PRSA,V?LIE-DOWN \?L20
	EQUAL? PRSO,ROOMS,GROUND \?L20
	ZERO? HOUSE-DEMOLISHED /?L18
?L20:	EQUAL? PRSA,V?REPLACE \?L16
	EQUAL? PRSO,ARTHUR \?L16
	ZERO? HOUSE-DEMOLISHED \?L16
?L18:	ZERO? PROSSER-LYING /?L21
	PRINTR "He's already lying there!"
?L21:	SET 'PROSSER-LYING,1
	CALL QUEUE,I-ARTHUR,-1 >STACK
	PUT STACK,0,1
	PRINTR "Prosser blinks in astonishment. ""You mean, go and lie in the mud in his place...?"" You explain that Arthur will only move if someone else takes over for him. Prosser shakes his head in such a manner as to suggest that he is very weary of the world, and you tactfully forebear from mentioning that it won't be troubling him much longer. Reluctantly, he follows you back toward Arthur.

You rapidly conclude the business. Prosser lies in the mud. Arthur, bewildered, nevertheless stands up and appears ready to follow you to the Pub."
?L16:	CALL STAND-ASIDE
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L15:	EQUAL? PRSA,V?WHAT-ABOUT \?L29
	EQUAL? PRSO,HOME,HOUSE \?L29
	ZERO? HOUSE-DEMOLISHED /?L29
	PRINTR "Prosser explains the local planning regulations and says, by way of reassurance, that you will probably be rehoused within a couple of years."
?L29:	EQUAL? PRSA,V?BLOCK \?L32
	EQUAL? PRSO,BULLDOZER \?L32
	CALL RUNNING?,I-BULLDOZER >STACK
	ZERO? STACK /?L32
	CALL V-PROTEST >STACK
	RSTACK
?L32:	CALL STAND-ASIDE
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L1:	ZERO? GONE-AROUND \?L34
	EQUAL? IDENTITY-FLAG,FORD \?L34
	EQUAL? PRSA,V?ASK-FOR,V?HELLO,V?TELL /?L35
	EQUAL? PRSA,V?TELL-ABOUT,V?ASK-ABOUT \?L34
?L35:	EQUAL? PRSO,PROSSER \?L34
	IN? FLEET,HERE /?L34
	PRINTI "Prosser can't hear you from here."
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L34:	EQUAL? PRSA,V?SHOW,V?GIVE \?L38
	EQUAL? PRSO,THING \?L39
	PRINTR "He is much impressed and says, ""You must have the same aunt I have."""
?L39:	EQUAL? PRSO,TOWEL \?L43
	SET 'TOWEL-MUDDY,1
	PRINTR "Prosser thanks you, wipes the mud off his boots, and hands it back."
?L43:	EQUAL? PRSO,GUIDE \?L46
	PRINTI "Prosser takes a quick look at "
	PRINTD GUIDE
	PRINTR ", says he doesn't read that kind of rubbish, and hands it back."
?L46:	EQUAL? PRSO,SATCHEL \FALSE
	PRINTR "Prosser says he wouldn't be seen dead with that kind of thing slung over his shoulder."
?L38:	EQUAL? PRSA,V?WALK-TO \?L53
	EQUAL? HERE,FRONT-OF-HOUSE \?L53
	EQUAL? IDENTITY-FLAG,FORD \?L54
	ZERO? GONE-AROUND \?L54
	CALL PERFORM,V?WALK-AROUND,BULLDOZER
	RTRUE
?L54:	PRINTR "You're already as close as any reasonable person would want to get."
?L53:	EQUAL? PRSA,V?KICK,V?KILL \?L59
	ZERO? LYING-DOWN /?L59
	PRINT WHILE-LYING
	CRLF
	CALL PRINT-ID,STR?173 >STACK
	RSTACK
?L59:	EQUAL? PRSA,V?KILL \?L62
	EQUAL? PRSO,PROSSER \?L62
	ZERO? HOUSE-DEMOLISHED /?L62
	PRINTI "You muck up all his fancy facial work. This is the last moment of satisfaction you will experience for some time."
	CRLF
	CALL PRINT-ID,STR?174 >STACK
	RSTACK
?L62:	EQUAL? PRSA,V?KICK,V?KILL \?L65
	EQUAL? PRSO,PROSSER \?L65
	PRINTI "He dodges, insisting that this is incorrect procedure."
	CRLF
	CALL PRINT-ID,STR?175 >STACK
	RSTACK
?L65:	EQUAL? PRSA,V?THROW \?L68
	EQUAL? PRSI,PROSSER \?L68
	MOVE PRSO,HERE
	CALL PERFORM,V?KILL,PROSSER
	RTRUE
?L68:	EQUAL? PRSA,V?EXAMINE \?L69
	CALL PROSSER-DESCFCN >STACK
	RSTACK
?L69:	EQUAL? PRSA,V?LISTEN \?L70
	FSET? CONVERSATION,INVISIBLE /?L70
	CALL PERFORM,V?LISTEN,CONVERSATION
	RTRUE
?L70:	EQUAL? PRSA,V?ASK-ABOUT \?L74
	EQUAL? PRSI,OBJECT-OF-GAME \?L71
	PRINTR "Prosser pulls a booklet out of his back pocket. ""My game manual says that the goal is getting this here house knocked down."""
?L71:	EQUAL? PRSA,V?ASK-ABOUT \?L74
	EQUAL? PRSI,DIGITAL-WATCH \?L74
	CALL PERFORM,V?ASK-FOR,PROSSER,TIME
	RTRUE
?L74:	EQUAL? PRSA,V?ASK-FOR \FALSE
	EQUAL? PRSI,TIME \FALSE
	PRINTI "Prosser shakes the "
	PRINTD DIGITAL-WATCH
	PRINTI ". ""Hasn't worked for months. I keep wearing it only because I think "
	PRINTD DIGITAL-WATCH
	PRINTR "es are neat."""

	.FUNCT STAND-ASIDE
	ZERO? PROSSER-LYING /?L1
	PRINTR """Leave me alone,"" Prosser whimpers miserably."
?L1:	PRINTI """Please step aside as I need to be able to "
	ZERO? HOUSE-DEMOLISHED /?L8
	PRINTI "clear this "
	PRINTD RUBBLE
	PRINTR " away."""
?L8:	PRINTI "knock "
	EQUAL? IDENTITY-FLAG,ARTHUR \?L15
	PRINTI "your"
	JUMP ?L19
?L15:	PRINTI "that"
?L19:	PRINTR " house down."""

	.FUNCT DIGITAL-WATCH-F
	EQUAL? PRSA,V?READ,V?TAKE \FALSE
	CALL PRINT-ID,STR?176
	CALL PRIVATE,STR?177 >STACK
	RSTACK

	.FUNCT FORD-DESCFCN,X
	ZERO? FORD-SLEEPING /?L1
	PRINTR "Ford is in the corner, snoring loudly."
?L1:	PRINTD FORD
	PRINTR " is here."

	.FUNCT FORD-F
	EQUAL? IDENTITY-FLAG,FORD \?L1
	EQUAL? FORD,PRSO \?L3
	CALL PERFORM,PRSA,ME,PRSI
	RTRUE
?L3:	CALL PERFORM,PRSA,PRSO,ME
	RTRUE
?L1:	EQUAL? FORD,WINNER \?L6
	IN? FLEET,HERE \?L7
	PRINT ABOVE-NOISE
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L7:	EQUAL? PRSI,HOUSE /?L12
	EQUAL? PRSO,HOUSE \?L11
?L12:	PRINTI """It's not a house, it's a home."" (Footnote 2)"
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L11:	EQUAL? PRSA,V?TELL-ABOUT \?L15
	EQUAL? PRSO,ME \?L15
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,FORD,PRSI
	SET 'WINNER,FORD
	RTRUE
?L15:	EQUAL? PRSA,V?HELLO \?L16
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,FORD
	SET 'WINNER,FORD
	RTRUE
?L16:	EQUAL? PRSA,V?WHAT \?L17
	EQUAL? PRSO,OBJECT-OF-GAME \?L17
	PRINT ASK-ABOUT-OBJECT
	CRLF
	RTRUE
?L17:	EQUAL? PRSA,V?WHAT-ABOUT \?L23
	LESS? FORD-COUNTER,2 \?L20
	EQUAL? HERE,FRONT-OF-HOUSE \?L20
	EQUAL? PRSO,HOME \?L20
	PRINTI "Ford"
	CALL FORD-DECIDES >STACK
	RSTACK
?L20:	EQUAL? PRSA,V?WHAT-ABOUT \?L23
	EQUAL? PRSO,THIRD-PLANET,HOME \?L23
	ZERO? EARTH-DEMOLISHED /?L86
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,FORD,THIRD-PLANET
	SET 'WINNER,FORD
	RTRUE
?L23:	ZERO? EARTH-DEMOLISHED \?L24
?L86:	LESS? DRUNK-LEVEL,3 \?L25
	EQUAL? HERE,PUB \?L25
	PRINTI """Shut up and drink your beer. You're going to need it."""
	CRLF
	JUMP ?L29
?L25:	PRINTI "Ford, busy "
	EQUAL? FORD-COUNTER,2 \?L32
	PRINTI "talking to Prosser"
	JUMP ?L36
?L32:	PRINTI "scanning the sky "
?L36:	EQUAL? HERE,PUB \?L39
	PRINTI "through the window"
	JUMP ?L43
?L39:	EQUAL? FORD-COUNTER,2 /?L43
	PRINTI "for something"
?L43:	PRINTI ", ignores you."
	CRLF
?L29:	CALL QUEUE,I-FORD,2 >STACK
	PUT STACK,0,1
	RTRUE
?L24:	PRINTI "Ford seems deep in thought."
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L6:	EQUAL? PRSA,V?HELLO,V?TELL-ABOUT,V?TELL /?L53
	EQUAL? PRSA,V?ASK-ABOUT,V?ASK-FOR \?L52
?L53:	EQUAL? PRSO,FORD \?L52
	ZERO? FORD-SLEEPING /?L52
	PRINTI "Ford is sleeping!"
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L52:	EQUAL? PRSA,V?GIVE \?L56
	EQUAL? PRSI,FORD \?L56
	ZERO? FORD-SLEEPING /?L56
	CALL PERFORM,V?HELLO,FORD
	RTRUE
?L56:	EQUAL? FOLLOW-FLAG,1 \?L57
	IN? FORD,HERE /?L57
	EQUAL? PRSA,V?FOLLOW \?L57
	PRINTI "In a state of anxiety and confusion you follow Ford down the lane..."
	CRLF
	CRLF
	LOC FORD >STACK
	CALL GOTO,STACK >STACK
	RSTACK
?L57:	EQUAL? FOLLOW-FLAG,3 \?L60
	EQUAL? PRSA,V?FOLLOW \?L61
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L60:	EQUAL? PRSA,V?FOLLOW \?L61
	EQUAL? FOLLOW-FLAG,5 \?L61
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L61:	EQUAL? PRSA,V?SHAKE,V?ALARM \?L62
	ZERO? FORD-SLEEPING /?L62
	PRINTR "Rather like trying to wake the dead."
?L62:	EQUAL? PRSA,V?ASK-ABOUT \?L68
	EQUAL? PRSI,OBJECT-OF-GAME \?L65
	PRINT ASK-ABOUT-OBJECT
	CRLF
	RTRUE
?L65:	EQUAL? PRSA,V?ASK-ABOUT \?L68
	EQUAL? PRSI,THIRD-PLANET \?L68
	PRINTR "Ford explains that the Earth has been demolished. To cheer you up, he points out that there are an awful lot of little planets like that around, and the Earth wasn't even a particularly nice one."
?L68:	EQUAL? PRSA,V?GIVE \?L71
	EQUAL? PRSO,THUMB \?L71
	IN? FLEET,HERE \?L71
	PRINTR "You can't reach him in this wind."
?L71:	EQUAL? PRSA,V?LISTEN \?L74
	FSET? CONVERSATION,INVISIBLE /?L75
	CALL PERFORM,V?LISTEN,CONVERSATION
	RTRUE
?L75:	ZERO? FORD-SLEEPING /FALSE
	PRINTR """Zzzzzzz..."""
?L74:	EQUAL? PRSA,V?EXAMINE \?L81
	ZERO? FORD-SLEEPING /?L81
	PRINTR "He's sleeping."
?L81:	EQUAL? PRSA,V?ASK-FOR \FALSE
	EQUAL? PRSI,TOWEL \FALSE
	EQUAL? FORD-COUNTER,0,1 \FALSE
	CALL PERFORM,V?TAKE,TOWEL
	RTRUE

	.FUNCT FORD-DECIDES
	FCLEAR CONVERSATION,INVISIBLE
	CALL QUEUE,I-FORD,2 >STACK
	PUT STACK,0,1
	SET 'FORD-COUNTER,2
	PRINTI " looks startled, then guilty. He starts to say something and stops. He starts to say something else and stops. Suddenly he seems to see the "
	PRINTD BULLDOZER
	PRINTI " for the first time, stops starting to say things and starts.

He seems to come to a momentous decision, says he has something of Earth-shattering importance to tell you, and stresses the importance of a quick drink at the Horse 'n Groom.

"
	CALL BUT-THAT-MAN,STR?178
	PRINTI " Ford goes off for a quiet word with Prosser. From where you're lying, you cannot hear what's happening, although they seem deeply engrossed in "
	PRINTD CONVERSATION
	PRINTR "."

	.FUNCT I-FORD
	CALL QUEUE,I-FORD,-1 >STACK
	PUT STACK,0,1
	CALL IN-HEART?,PROTAGONIST >STACK
	ZERO? STACK /?L1
	INC 'HEART-COUNTER
	EQUAL? HEART-COUNTER,1 \?L3
	MOVE FORD,HERE
	CRLF
	PRINTI """This looks like that incredible new"
	PRINT IID
	PRINTI " spaceship, "
	PRINTD HEART-OF-GOLD
	PRINTI "!"" says Ford, with growing excitement."
	CRLF
	CRLF
	PRINT ANNOUNCEMENT
	PRINTD EDDIE
	PRINTI ". We have just picked up two hitchhikers"
	CALL FACTOR,STR?179
	PRINTR """"
?L3:	EQUAL? HEART-COUNTER,2 \?L9
	CRLF
	PRINTI """Come on, let's look for the Bridge."" You follow Ford, and eventually come to the..."
	CRLF
	CRLF
	CALL GOTO,BRIDGE
	MOVE FORD,HERE
	RTRUE
?L9:	EQUAL? HEART-COUNTER,3 \?L12
	EQUAL? HERE,BRIDGE \FALSE
	CRLF
	PRINTI """Hey, Zaphod, how ya doing?"" says Ford. He's cool. ""Not bad, Ford. Great to see you,"" replies Zaphod. He's cooler. You suddenly realise that the woman is Tricia MacMillan (""Call me "
	PRINTD TRILLIAN
	PRINTR """), whom you were trying to pick up at a party in Islington just a few weeks ago, and that Zaphod is the guy she eventually left the party with! Odd."
?L12:	EQUAL? HEART-COUNTER,4 \FALSE
	MOVE FORD,LOCAL-GLOBALS
	MOVE ZAPHOD,LOCAL-GLOBALS
	MOVE TRILLIAN,LOCAL-GLOBALS
	MOVE HANDBAG,BRIDGE
	MOVE SATCHEL,BRIDGE
	FCLEAR HANDBAG,NDESCBIT
	FCLEAR HANDBAG,TRYTAKEBIT
	CALL INT,I-FORD >STACK
	PUT STACK,0,0
	CALL QUEUE,I-MARVIN,-1 >STACK
	PUT STACK,0,1
	EQUAL? HERE,BRIDGE \FALSE
	SET 'FOLLOW-FLAG,3
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	CRLF
	PRINTI """Like my spaceship, Ford?"" Zaphod asks. ""YOUR spaceship?"" says Ford, losing his cool for a second. ""Yeah, I stole it,"" Zaphod admits. ""I'm gonna use it to find"
	PRINT LOST-PLANET
	PRINTI ". Let's go sit in the sauna while I explain."" Zaphod, Ford, and "
	PRINTD TRILLIAN
	PRINTR " all head off to port."
?L1:	EQUAL? HERE,HOLD \?L25
	FSET? CAPTAINS-QUARTERS,TOUCHBIT \?L26
	INC 'GUARDS-COUNTER
	EQUAL? GUARDS-COUNTER,1 \?L28
	CRLF
	PRINTR "The guard releases you and Ford and begins cycling the air in the airlock. ""Hey, guard!"" shouts Ford, ""do you really enjoy this sort of thing? Shouting, stomping around, shooting people, is it really a fulfilling career?"""
?L28:	EQUAL? GUARDS-COUNTER,6 \?L32
	CALL INT,I-FORD >STACK
	PUT STACK,0,0
	MOVE SATCHEL,FORD
	FCLEAR SATCHEL,NDESCBIT
	SET 'PANEL-BLOCKER,0
	FSET HOLD,REVISITBIT
	CRLF
	PRINTI "The guard says, """
	CALL HELD?,BABEL-FISH,PROTAGONIST >STACK
	ZERO? STACK /?L35
	PRINTI "Well, all things considered, I guess I like being a guard. Especially the shouting. Resistance is useless!"""
	JUMP ?L39
?L35:	PRINTI "I"
	CALL PRODUCE-GIBBERISH,3
?L39:	PRINTI " He throws you and Ford into the airlock and closes the door."
	CRLF
	CRLF
	CALL GOTO,AIRLOCK
	MOVE FORD,AIRLOCK
	RTRUE
?L32:	CRLF
	PRINTR "Ford continues trying to talk the guard into a sudden career change."
?L26:	MOVE GUIDE,PROTAGONIST
	CALL INT,I-FORD >STACK
	PUT STACK,0,0
	SET 'FORD-SLEEPING,1
	IN? MINERAL-WATER,FORD \?L48
	MOVE MINERAL-WATER,SATCHEL
?L48:	IN? TOWEL,FORD \?L51
	MOVE TOWEL,HERE
?L51:	MOVE SATCHEL,HERE
	FCLEAR SATCHEL,TRYTAKEBIT
	CRLF
	PRINTI "Ford yawns. ""Matter transference always tires me out. I'm going to take a nap."" He places something on top of his satchel. ""If you have any questions, here's "
	PRINT GUIDE-NAME
	PRINTI """ (Footnote 14). Ford lowers his voice to a whisper. ""I'm not supposed to tell you this, but you'll never be able to finish the game without consulting the Guide about lots of stuff."" As he curls up in a corner and begins snoring, you pick up "
	PRINTD GUIDE
	PRINTR "."
?L25:	ZERO? FORD-COUNTER \?L56
	SET 'FORD-COUNTER,1
	CRLF
	PRINTR "Ford glances uncomfortably at the sky. He offers you the towel again."
?L56:	EQUAL? FORD-COUNTER,1 \?L59
	CRLF
	PRINTI "Ford seems oblivious to your trouble, so you ask ""Ford, what about my home?"" He"
	CALL FORD-DECIDES >STACK
	RSTACK
?L59:	EQUAL? FORD-COUNTER,2 \?L62
	SET 'FORD-COUNTER,3
	SET 'LYING-DOWN,0
	SET 'PROSSER-LYING,1
	CALL QUEUE,I-FORD,2 >STACK
	PUT STACK,0,1
	FSET CONVERSATION,INVISIBLE
	CRLF
	PRINTI "Ford and Prosser stop talking and approach you. Ford says that Prosser has agreed to lie in your place so that the two of you can go off to the Pub. Reluctantly, Prosser steps forward and lies down in front of the "
	PRINTD BULLDOZER
	PRINTR ". You stand up."
?L62:	EQUAL? FORD-COUNTER,3 \?L65
	MOVE FORD,COUNTRY-LANE
	SET 'FORD-COUNTER,4
	EQUAL? HERE,FRONT-OF-HOUSE \?L66
	SET 'FOLLOW-FLAG,1
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	PRINTR "Ford, urging you to follow, hurries toward the country lane."
?L66:	EQUAL? HERE,COUNTRY-LANE \FALSE
	PRINTR "Ford enters from the north."
?L65:	EQUAL? FORD-COUNTER,4 \?L74
	EQUAL? HERE,COUNTRY-LANE \?L74
	FSET? PUB,TOUCHBIT /?L74
	SET 'FORD-COUNTER,5
	SET 'FOLLOW-FLAG,1
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	MOVE FORD,PUB
	CRLF
	PRINTR """Come along, Arthur,"" says Ford impatiently, and enters the Pub."
?L74:	IN? FORD,HERE /?L77
	FSET? PUB,TOUCHBIT \?L77
	MOVE FORD,HERE
	CRLF
	PRINTR "Ford hurries after you."
?L77:	LESS? DRUNK-LEVEL,3 \FALSE
	EQUAL? PRSO,BEER \?L81
	EQUAL? PRSA,V?ENJOY,V?DRINK /FALSE
?L81:	EQUAL? L-PRSO,BEER \?L83
	EQUAL? PRSA,V?AGAIN \?L83
	EQUAL? L-PRSA,V?DRINK,V?ENJOY /FALSE
?L83:	EQUAL? HERE,PUB \FALSE
	FSET? BEER,NDESCBIT /FALSE
	CRLF
	PRINTI """Drink the beer,"" urges Ford. ""It will help"
	CALL CUSHION
	PRINTR """"

	.FUNCT SATCHEL-DESCFCN,X
	PRINTI "There is a satchel here"
	EQUAL? PANEL-BLOCKER,SATCHEL \?L3
	PRINTI ", resting in front of the "
	PRINTD ROBOT-PANEL
?L3:	PRINTI "."
	CALL ITEM-ON-SATCHEL-DESCRIPTION
	CRLF
	RTRUE

	.FUNCT ITEM-ON-SATCHEL-DESCRIPTION
	ZERO? ITEM-ON-SATCHEL /FALSE
	PRINTI " Sitting on top of it is"
	CALL ARTICLE,ITEM-ON-SATCHEL
	PRINTI "."
	RTRUE

	.FUNCT SATCHEL-F
	EQUAL? PRSA,V?OPEN \?L1
	EQUAL? IDENTITY-FLAG,FORD /?L1
	CALL PRIVATE,STR?180 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?PUT-ON \?L3
	EQUAL? SATCHEL,PRSI \?L3
	CALL HELD?,SATCHEL >STACK
	ZERO? STACK /?L4
	PRINTR "Put down the satchel first."
?L4:	ZERO? ITEM-ON-SATCHEL /?L8
	PRINTI "But"
	CALL ARTICLE,ITEM-ON-SATCHEL,1
	PRINTR " is already on the satchel."
?L8:	SET 'ITEM-ON-SATCHEL,PRSO
	MOVE PRSO,HERE
	FSET PRSO,NDESCBIT
	FSET PRSO,TRYTAKEBIT
	PRINTI "Okay,"
	CALL ARTICLE,PRSO,1
	PRINTR " is now sitting on the satchel."
?L3:	EQUAL? PRSA,V?EXAMINE \?L18
	PRINTI "The satchel, which is "
	FSET? SATCHEL,OPENBIT \?L21
	PRINTI "open"
	JUMP ?L25
?L21:	PRINTI "closed"
?L25:	PRINTI ", is fairly bulky."
	CALL ITEM-ON-SATCHEL-DESCRIPTION
	CRLF
	RTRUE
?L18:	EQUAL? PRSA,V?TAKE \FALSE
	IN? SATCHEL,FORD \FALSE
	PRINTI "Ford says, ""Hey, Arthur, keep "
	PRINTD HANDS
	PRINTR "s off my satchel!"""

	.FUNCT TOWEL-F
	EQUAL? PRSA,V?TAKE \?L1
	FSET? TOWEL,TRYTAKEBIT \?L1
	EQUAL? HERE,FRONT-OF-HOUSE \?L1
	ZERO? LYING-DOWN /?L1
	FCLEAR TOWEL,TRYTAKEBIT
	MOVE TOWEL,PROTAGONIST
	MOVE FORD,LOCAL-GLOBALS
	SET 'FORD-GONE,1
	SET 'FOLLOW-FLAG,5
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	CALL INT,I-FORD >STACK
	PUT STACK,0,0
	PRINTI "As you take it, Ford says ""Er, look, thanks for lending me the towel... been nice knowing you... got to go now..."" He smiles oddly and walks down the "
	PRINTD COUNTRY-LANE
	PRINTR "."
?L1:	EQUAL? PRSA,V?MOVE,V?TAKE \?L5
	EQUAL? PRSO,TOWEL \?L5
	FSET? TOWEL,SURFACEBIT \?L5
	FCLEAR TOWEL,TRYTAKEBIT
	FCLEAR TOWEL,SURFACEBIT
	CALL ROB,TOWEL,HERE
	FCLEAR TOWEL,CONTBIT
	FCLEAR TOWEL,OPENBIT
	FCLEAR TOWEL,NDESCBIT
	EQUAL? PRSA,V?MOVE \FALSE
	PRINTR "Okay, it's no longer covering the drain."
?L5:	EQUAL? PRSA,V?TIE,V?PUT-ON \?L14
	EQUAL? PRSI,BEAST \?L11
	PRINTR "The effect is decorative rather than helpful."
?L11:	EQUAL? PRSA,V?TIE,V?PUT-ON \?L14
	EQUAL? PRSI,EYES,HEAD \?L14
	FSET? TOWEL,WORNBIT \?L15
	PRINTR "It already is."
?L15:	IN? BEAST,HERE \?L19
	FSET TOWEL,WORNBIT
	MOVE TOWEL,PROTAGONIST
	CALL QUEUE,I-BEAST,11 >STACK
	PUT STACK,0,1
	PRINTI "The "
	PRINTD BEAST
	PRINTR " is completely bewildered. It is so dim it thinks that if you can't see it, it can't see you. You have a few seconds before it realises its mistake."
?L19:	PRINTI "There's no need for that. It's not like there's a "
	PRINTD BEAST
	PRINTR " around, or something."
?L14:	FSET? TOWEL,WORNBIT \?L25
	EQUAL? PRSA,V?UNTIE,V?REMOVE,V?TAKE-OFF \?L25
	FCLEAR TOWEL,WORNBIT
	PRINTI "You unwrap the towel from your head."
	FSET? BEAST,MUNGEDBIT \?L28
	CRLF
	CRLF
	CALL V-LOOK
	RTRUE
?L28:	ZERO? BEARINGS-LOST /?L31
	PRINTI " You see that you have wandered in circles"
	EQUAL? HERE,OUTER-LAIR \?L35
	PRINTI " and ended right beside the "
	PRINTD MEMORIAL
?L35:	PRINTI "."
?L31:	PRINTI " Unfortunately, the Beast has also caught sight of you again. All this fooling around has made it doubly angry and hungry. "
	CALL PRINT-ID,STR?181
	CALL BEAST-DEATH
	RTRUE
?L25:	EQUAL? PRSA,V?EXAMINE \?L45
	FSET? TOWEL,SURFACEBIT \?L46
	CALL PERFORM,V?EXAMINE,DRAIN
	FIRST? TOWEL >STACK \TRUE
	RFALSE
?L46:	ZERO? TOWEL-MUDDY /?L51
	PRINTR "It is caked with mud."
?L51:	PRINTR "It's covered with little pink and blue flowers."
?L45:	EQUAL? PRSA,V?LIE-DOWN \FALSE
	FSET? TOWEL,SURFACEBIT \FALSE
	CALL PERFORM,V?STAND-BEFORE,HOOK
	RTRUE

	.FUNCT BACK-OF-HOUSE-F,RARG
	EQUAL? RARG,M-END \?L1
	CALL RUNNING?,I-VOGONS >STACK
	ZERO? STACK \?L1
	ZERO? HOUSE-DEMOLISHED /?L1
	CALL I-VOGONS
	CALL QUEUE,I-VOGONS,2 >STACK
	PUT STACK,0,1
	RTRUE
?L1:	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "The rear garden is a pleasant place. I"
	PRINT NICE-DAY
	PRINTR ", and it's a lovely day for a walk. A path leads around the house to the southeast and southwest."

	.FUNCT TREE-PSEUDO
	EQUAL? PRSA,V?CLIMB-FOO,V?CLIMB-UP \FALSE
	PRINTR "You were never very good at that."

	.FUNCT COUNTRY-LANE-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	ZERO? PROSSER-LYING \?L3
	ZERO? HOUSE-DEMOLISHED \?L3
	FSET? HOLD,TOUCHBIT /?L3
	SET 'BULLDOZER-COUNTER,3
	CALL I-BULLDOZER >STACK
	RSTACK
?L3:	EQUAL? IDENTITY-FLAG,FORD \?L5
	ZERO? HOUSE-DEMOLISHED /?L5
	CALL QUEUE,I-DOG,1 >STACK
	PUT STACK,0,1
	RFALSE
?L5:	EQUAL? DRUNK-LEVEL,3 \?L6
	EQUAL? IDENTITY-FLAG,ARTHUR \?L6
	CALL QUEUE,I-DOG,1 >STACK
	PUT STACK,0,1
	RFALSE
?L6:	FSET? HOLD,TOUCHBIT \FALSE
	FSET? COUNTRY-LANE,NDESCBIT /FALSE
	LOC SATCHEL >STACK
	PUT FORD-TABLE,0,STACK
	LOC THUMB >STACK
	PUT FORD-TABLE,1,STACK
	LOC GUIDE >STACK
	PUT FORD-TABLE,2,STACK
	LOC TOWEL >STACK
	PUT FORD-TABLE,3,STACK
	LOC MINERAL-WATER >STACK
	PUT FORD-TABLE,5,STACK
	FSET? THUMB,MUNGEDBIT \?L8
	PUT FORD-TABLE,4,1
	FCLEAR THUMB,MUNGEDBIT
?L8:	FSET COUNTRY-LANE,NDESCBIT
	CALL ROB,PROTAGONIST,MEMORIAL
	MOVE SATCHEL,PROTAGONIST
	MOVE THUMB,SATCHEL
	MOVE GUIDE,SATCHEL
	MOVE TOWEL,SATCHEL
	MOVE MINERAL-WATER,SATCHEL
	MOVE ARTHUR,FRONT-OF-HOUSE
	SET 'IDENTITY-FLAG,FORD
	MOVE FORD,GLOBAL-OBJECTS
	MOVE PEANUTS,PUB
	FSET PEANUTS,TRYTAKEBIT
	FSET PEANUTS,NDESCBIT
	SET 'PEANUTS-BOUGHT,0
	SET 'DREAMING,1
	CALL QUEUE,I-VOGONS,38 >STACK
	PUT STACK,0,1
	PRINTI "You are hurrying up a country lane. The sky is light and clear, but you keep glancing at it with apprehension because you know that it will shortly be torn apart by Vogon ships, and that the hills and trees around you will just burn up and blow away, and you hope there's time for a quick drink beforehand.

You want to hitch a ride aboard the Vogon fleet, but are anxious because it's so long since you were through a"
	PRINT BEAM
	PRINTI "."
	CRLF
	CRLF
	RTRUE
?L1:	EQUAL? RARG,M-END \?L14
	FSET? COUNTRY-LANE,REVISITBIT \?L14
	SET 'DREAMING,1
	PRINTI "Suddenly a shadow passes in front of the sun. You look up. The shadow is a "
	PRINTD FLEET
	PRINTI ". You fumble for "
	CALL PRINT-ID,STR?182
	CALL JIGS-UP,STR?183
	RTRUE
?L14:	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "The road runs from "
	EQUAL? IDENTITY-FLAG,ARTHUR \?L20
	PRINTI "your"
	JUMP ?L24
?L20:	PRINTI "Arthur's"
?L24:	PRINTR " home, to the north, toward the village Pub, to the west."

	.FUNCT I-DOG
	EQUAL? HERE,WAR-CHAMBER \?L1
	INC 'DOG-COUNTER
	LESS? DOG-COUNTER,13 \?L3
	EQUAL? PRSA,V?WAIT /FALSE
?L3:	CRLF
	LESS? DOG-COUNTER,13 \?L6
	PRINTR "The fleet continues to hurtle sunwards."
?L6:	ZERO? DOG-FED /?L10
	SET 'LYING-DOWN,0
	PRINTI "Your simple act of kindness at a moment of great personal anxiety (you fed the dog, remember?) now brings rich rewards. "
	PRINT FLEET-PLUNGES
	PRINTI " spots the dog (which appears to them as a gigantic monster) cheerfully tucking into a "
	PRINTD SANDWICH
	PRINTI ".

The Vl'Hurgs and the G'Gugvunts are moved by this simple picture of happiness, compared with the furious savagery of their own lives. They think back to a day when they used to relax over an odd "
	PRINTD SANDWICH
	PRINTI " themselves, often at sunset after a hearty day working in the fields back in Vl'Hurgon and G'Gugvia, and decide to return and rebuild their homes in a new spirit of harmony and cooperation.

Grateful, they offer to drop you at "
	PRINTD HEART-OF-GOLD
	PRINTI " on the way home. After a brief 900 parsec trip, you are escorted into the Transporter Chamber of the warship. The transporter glows, and your surroundings change..."
	CRLF
	CRLF
	CALL GOTO,MAZE >STACK
	RSTACK
?L10:	PRINT FLEET-PLUNGES
	CALL JIGS-UP,STR?184
	RTRUE
?L1:	EQUAL? IDENTITY-FLAG,FORD \?L16
	MOVE DOG,HERE
	CALL INT,I-DOG >STACK
	PUT STACK,0,0
	PRINTI "You run up the lane after Arthur. You pass a"
	ZERO? DOG-FED /?L19
	PRINTR " serene dog. Fate cannot harm him, he has dined today."
?L19:	PRINTR "n irritable dog who yaps at you."
?L16:	IN? DOG,HERE /?L26
	IN? FLEET,HERE /?L26
	EQUAL? HERE,COUNTRY-LANE \?L26
	MOVE DOG,HERE
	CALL QUEUE,I-DOG,2 >STACK
	PUT STACK,0,1
	PRINTI "You see the huge "
	PRINTD BULLDOZER
	PRINTI " heaving itself among the cloud of brick dust which is all that remains of "
	PRINTD HOME
	PRINTR ". As you start up the lane, a small dog runs up to you, yapping."
?L26:	ZERO? DOG-FED \FALSE
	IN? DOG,HERE \FALSE
	FSET? DOG,TOUCHBIT /FALSE
	FSET DOG,TOUCHBIT
	PRINTR "The dog carries on yapping for a moment and then gulps uncomfortably."

	.FUNCT DOG-F
	EQUAL? PRSA,V?THROW,V?GIVE \?L1
	EQUAL? PRSO,SANDWICH \?L3
	EQUAL? IDENTITY-FLAG,FORD \?L5
	MOVE SANDWICH,HERE
	PRINTI "The dog is in a bad mood and tries to bite "
	PRINTD HANDS
	PRINTI ". The "
	PRINTD SANDWICH
	PRINTR " lies ignored in the roadside dust."
?L5:	FSET? DOG,TOUCHBIT \?L9
	PRINTI "The dog, which seems to have a slight case of indigestion, ignores the "
	PRINTD SANDWICH
	PRINTR "."
?L9:	MOVE SANDWICH,LOCAL-GLOBALS
	SET 'DOG-FED,1
	PRINTI "The dog is deeply moved. With powerful sweeps of its tail it indicates that it regards this "
	PRINTD SANDWICH
	PRINTI " as one of the great "
	PRINTD SANDWICH
	PRINTI "es. Nine out of ten pet owners could happen by at this point expressing any preference they pleased, but this dog would spurn both them and all their tins. This is a dog which has met its main sandwich. It eats"
	PRINT WITH-PASSION
	CRLF
	CALL PRINT-ID,STR?185 >STACK
	RSTACK
?L3:	EQUAL? PRSO,PEANUTS \FALSE
	PRINTR "This is a dog, not an elephant."
?L1:	EQUAL? PRSA,V?EXAMINE \?L19
	ZERO? DOG-FED \?L19
	PRINTR "The mongrel looks hungry."
?L19:	EQUAL? PRSA,V?PUSH,V?KICK,V?RUB \FALSE
	PRINTI "The dog tries to bite your "
	EQUAL? PRSA,V?KICK \?L25
	PRINTI "foot"
	CALL PRINT-ID,STR?186
	JUMP ?L29
?L25:	PRINTI "hand"
?L29:	PRINTR "."

	.FUNCT PUB-OBJECT-F
	EQUAL? PRSA,V?THROUGH,V?WALK-TO \?L1
	EQUAL? HERE,PUB \?L3
	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L3:	EQUAL? HERE,COUNTRY-LANE \?L7
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L7:	CALL V-WALK-AROUND >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?DISEMBARK,V?LEAVE,V?EXIT \FALSE
	EQUAL? HERE,PUB \?L10
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L10:	PRINT LOOK-AROUND
	CRLF
	RTRUE

	.FUNCT PUB-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	ZERO? TOWEL-OFFERED \?L1
	EQUAL? IDENTITY-FLAG,FORD \?L1
	CALL QUEUE,I-UNEASY,-1 >STACK
	PUT STACK,0,1
	RFALSE
?L1:	EQUAL? RARG,M-LOOK \?L3
	PRINTR "The Pub is pleasant and cheerful and full of pleasant and cheerful people who don't know they've got about twelve minutes to live and are therefore having a spot of lunch. Some music is playing on an old jukebox. The exit is east."
?L3:	EQUAL? RARG,M-END \FALSE
	FSET? BEER,NDESCBIT \FALSE
	IN? FORD,HERE \FALSE
	EQUAL? IDENTITY-FLAG,FORD /FALSE
	FCLEAR BEER,NDESCBIT
	CALL QUEUE,I-FORD,2 >STACK
	PUT STACK,0,1
	SET 'FORD-COUNTER,5
	CRLF
	PRINTI "Ford buys "
	PRINTD BEER
	PRINTR " and offers half to you. ""Muscle relaxant..."" he says, impenetrably."

	.FUNCT BAR-F
	EQUAL? PRSA,V?LOOK-BEHIND \FALSE
	CALL PERFORM,V?EXAMINE,PUB-SHELF
	RTRUE

	.FUNCT PUB-SHELF-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	FSET PUB-SHELF,NDESCBIT
	PRINTI "On the shelf behind the bar is the usual array of bottles, glasses and soggy beermats"
	ZERO? PEANUTS-BOUGHT \?L5
	FSET PEANUTS,TAKEBIT
	FSET PEANUTS,TRYTAKEBIT
	ZERO? SANDWICH-BOUGHT /?L7
	PRINTI ", and"
	JUMP ?L11
?L7:	PRINTI ","
?L11:	PRINTI " some packets of peanuts"
?L5:	ZERO? SANDWICH-BOUGHT \?L17
	FSET SANDWICH,TAKEBIT
	FSET SANDWICH,TRYTAKEBIT
	PRINTI ", and a plate of uninviting "
	PRINTD SANDWICH
	PRINTI "es"
?L17:	PRINTR "."

	.FUNCT MUSIC-F
	EQUAL? PRSA,V?ENJOY,V?LISTEN \FALSE
	CALL PERFORM,V?LISTEN,JUKEBOX
	RTRUE

	.FUNCT JUKEBOX-F
	EQUAL? PRSA,V?LISTEN \?L1
	PRINTI "The song is "
	RANDOM 100 >STACK
	LESS? 25,STACK /?L5
	PRINTR "a Walker Brothers single, ""The Sun Ain't Gonna Shine Anymore."""
?L5:	RANDOM 100 >STACK
	LESS? 33,STACK /?L9
	PRINTR """Get Back"" by the Beatles."
?L9:	RANDOM 100 >STACK
	LESS? 50,STACK /?L12
	PRINTR """Hey Jude"" by the Beatles (Footnote 4). It's a particular favourite, and listening to it calms you down, and cheers you up."
?L12:	PRINTI """Tie a Yellow Ribbon."""
	EQUAL? IDENTITY-FLAG,FORD \?L18
	PRINTI " You can't stand it, and are pleased to think that this is probably the last time it will ever be heard."
	CALL PRINT-ID,STR?187
?L18:	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?LAMP-OFF \FALSE
	CALL PRINT-ID,STR?188
	CALL PRIVATE,STR?189 >STACK
	RSTACK

	.FUNCT BARMAN-F
	EQUAL? BARMAN,WINNER \?L1
	EQUAL? PRSA,V?TELL-ABOUT \?L3
	EQUAL? PRSO,ME \?L3
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,BARMAN,PRSI
	SET 'WINNER,BARMAN
	RTRUE
?L3:	EQUAL? PRSA,V?HELLO \?L5
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,BARMAN
	SET 'WINNER,BARMAN
	RTRUE
?L5:	EQUAL? PRSA,V?GIVE \?L6
	EQUAL? PRSO,ME \?L6
	EQUAL? PRSI,PEANUTS,BEER,SANDWICH \?L6
	CALL PERFORM,V?BUY,PRSI
	RTRUE
?L6:	PRINTR "The barman ignores you and keeps polishing the other end of the bar."
?L1:	EQUAL? PRSA,V?ASK-FOR \FALSE
	EQUAL? PRSI,PEANUTS,BEER,SANDWICH \FALSE
	CALL PERFORM,V?BUY,PRSI
	RTRUE

	.FUNCT BEER-F
	EQUAL? PRSA,V?COUNT,V?ENJOY,V?DRINK /?L3
	EQUAL? PRSA,V?TAKE,V?RUB,V?SMELL \?L1
?L3:	FSET? BEER,NDESCBIT \?L1
	PRINTR "You'd better buy some first."
?L1:	EQUAL? PRSA,V?COUNT \?L6
	PRINTR "Lots."
?L6:	EQUAL? PRSA,V?TAKE \?L9
	PRINTR "Just drink it!"
?L9:	EQUAL? IDENTITY-FLAG,FORD \?L12
	EQUAL? PRSA,V?BUY \?L13
	FSET? BEER,NDESCBIT /?L15
	PRINTR "You already did!"
?L15:	FCLEAR BEER,NDESCBIT
	IN? ARTHUR,HERE \?L20
	PRINTI "You order six pints of bitter -- three for you, three for Arthur. According to "
	PRINTD GUIDE
	PRINTI " this should"
	CALL CUSHION
	CRLF
	CRLF
	PRINTR "As you drink the first pint, you mention to Arthur that you are from a different planet, but it makes little impression. This surprises you, because you thought it was the sort of thing that would interest people."
?L20:	PRINTI "You buy yourself three pints, which you calculate you will need to"
	CALL CUSHION
	PRINTI " This is a tip you picked up from "
	PRINTD GUIDE
	PRINTR "."
?L13:	EQUAL? PRSA,V?ENJOY,V?DRINK \FALSE
	INC 'DRUNK-LEVEL
	IN? ARTHUR,HERE /?L32
	PRINT DOWN-WELL
	CRLF
	RTRUE
?L32:	EQUAL? DRUNK-LEVEL,1 \?L36
	ADD SCORE,FORD-POINT >SCORE
	SET 'FORD-POINT,0
	PRINT DOWN-WELL
	PRINTR " At least they managed to get something right on this benighted planet. You decide it's time to tell Arthur that the world is about to end. You tell him. Arthur is completely unperturbed. Curious. You wonder what sort of news it would take to disturb him."
?L36:	EQUAL? DRUNK-LEVEL,2 \?L39
	PRINT DOWN-WELL
	CALL SCENE-THROUGH-WINDOW >STACK
	RSTACK
?L39:	PRINTR "You've had enough."
?L12:	EQUAL? PRSA,V?ENJOY,V?DRINK \?L47
	ADD SCORE,5 >SCORE
	INC 'DRUNK-LEVEL
	EQUAL? DRUNK-LEVEL,4 \?L49
	PRINTI "You can hear the muffled noise of your home being demolished, and the taste of the beer sours in your mouth."
	CRLF
	CRLF
	CALL PERFORM,V?GET-DRUNK,ROOMS
	RTRUE
?L49:	EQUAL? DRUNK-LEVEL,3 \?L53
	CALL QUEUE,I-FORD,-1 >STACK
	PUT STACK,0,1
	SET 'HOUSE-DEMOLISHED,1
	SET 'PROSSER-LYING,0
	PRINTR "There is a distant crash which Ford explains is nothing to worry about, probably just your house being knocked down."
?L53:	EQUAL? DRUNK-LEVEL,2 \?L56
	PRINTR "It is really very pleasant stuff, with a very good dry, nutty flavour, some light froth on top, and a deep colour. It is at exactly room temperature. You reflect that the world cannot be all bad when there are such pleasures in it.

Ford mentions that the world is going to end in about twelve minutes."
?L56:	EQUAL? DRUNK-LEVEL,1 \FALSE
	PRINTR "It's very good beer, brewed by a small local company. You particularly like its flavour, which is why you woke up feeling so wretched this morning. You were at somebody's birthday party here in the Pub last night.

You begin to relax and enjoy yourself, so when Ford mentions that he's from a small planet in the vicinity of Betelgeuse, not from Guildford as he usually claims, you take it in your stride, and say ""Oh yes, which part?"""
?L47:	EQUAL? PRSA,V?BUY \FALSE
	FSET? BEER,NDESCBIT \?L64
	CALL PERFORM,V?BUY,PEANUTS
	RTRUE
?L64:	PRINTD FORD
	PRINTR " has already bought an enormous quantity for you!"

	.FUNCT PEANUTS-F
	EQUAL? IDENTITY-FLAG,FORD \?L1
	EQUAL? PRSA,V?BUY \?L1
	ZERO? PEANUTS-BOUGHT /?L3
	PRINTR "You did!"
?L3:	SET 'PEANUTS-BOUGHT,1
	MOVE PEANUTS,PROTAGONIST
	FCLEAR PEANUTS,TRYTAKEBIT
	FCLEAR PEANUTS,NDESCBIT
	PRINTI "You buy some peanuts, which you'll need to replace protein loss from the"
	PRINT BEAM
	PRINTI ", a tip you picked up from "
	PRINTD GUIDE
	PRINTR "."
?L1:	EQUAL? PRSA,V?OPEN \?L10
	PRINTR "Just eat 'em."
?L10:	EQUAL? PRSA,V?ENJOY,V?EAT \?L13
	ZERO? EARTH-DEMOLISHED /?L13
	ZERO? GROGGY /?L13
	SET 'GROGGY,0
	MOVE PEANUTS,PUB
	FSET PEANUTS,TRYTAKEBIT
	FSET PEANUTS,NDESCBIT
	PRINTI "You feel stronger as the peanuts replace some of the protein you lost in the"
	PRINT BEAM
	PRINTR "."
?L13:	EQUAL? PRSA,V?BUY \?L16
	EQUAL? HERE,PUB \?L16
	PRINTR "However much you clear your throat, wave your forefinger, or wiggle your eyebrows, the barman pays no attention, but carries on wiping another part of the bar."
?L16:	EQUAL? PRSA,V?EAT,V?TAKE \FALSE
	FSET? PEANUTS,TRYTAKEBIT \FALSE
	EQUAL? HERE,PUB \FALSE
	PRINT HANDS-OFF
	CRLF
	CALL PRINT-ID,STR?190 >STACK
	RSTACK

	.FUNCT SANDWICH-F
	EQUAL? PRSA,V?BUY \?L5
	ZERO? SANDWICH-BOUGHT \?L1
	MOVE SANDWICH,PROTAGONIST
	FSET SANDWICH,TAKEBIT
	FCLEAR SANDWICH,TRYTAKEBIT
	FCLEAR SANDWICH,NDESCBIT
	SET 'SANDWICH-BOUGHT,1
	PRINTI "The barman gives you a "
	PRINTD SANDWICH
	PRINTR ". The bread is like the stuff that stereos come packed in, the cheese would be great for rubbing out spelling mistakes, and margarine and pickle have performed an unedifying chemical reaction to produce something that shouldn't be, but is, turquoise. Since it is clearly unfit for human consumption you are grateful to be charged only a pound for it."
?L1:	EQUAL? PRSA,V?BUY \?L5
	PRINTR "You already did."
?L5:	EQUAL? PRSA,V?ENJOY,V?EAT,V?TAKE \?L8
	FSET? SANDWICH,TRYTAKEBIT \?L8
	EQUAL? HERE,PUB \?L8
	PRINT HANDS-OFF
	CRLF
	CALL PRINT-ID,STR?191 >STACK
	RSTACK
?L8:	EQUAL? PRSA,V?ENJOY,V?EAT \FALSE
	MOVE SANDWICH,LOCAL-GLOBALS
	SUB SCORE,30 >SCORE
	EQUAL? IDENTITY-FLAG,FORD \?L12
	PRINTI "You swallow with revulsion, astonished that life forms which have spent 4.6 billion years evolving cannot produce a better "
	PRINTD SANDWICH
	PRINTR " than this."
?L12:	PRINTR "It is one of the least rewarding taste experiences you can recall."

	.FUNCT I-VOGONS
	CALL QUEUE,I-VOGONS,-1 >STACK
	PUT STACK,0,1
	INC 'VOGON-COUNTER
	EQUAL? VOGON-COUNTER,1 \?L1
	EQUAL? HERE,PUB \?L3
	CALL GO-TO-LANE
?L3:	MOVE FLEET,HERE
	CRLF
	EQUAL? IDENTITY-FLAG,FORD \?L6
	MOVE ARTHUR,HERE
	PRINTI "Right on schedule (according to the news you picked up last night on your Sub-Etha Sens-O-Matic), a huge "
	PRINTD FLEET
	PRINTR " hurtles noisily through the sky. Time is very, very short. Storms break in the wake of the ships, the wind whips at you and makes it difficult to stand. You grab hold of a tree."
?L6:	PRINTI "With a noise like a cross between Led Zeppelin's farewell concert and the eruption of Krakatoa, a huge "
	PRINTD FLEET
	PRINTI " flies overhead and announces that the Earth will be demolished to make way for a new hyperspace bypass in ""two of your Earth minutes."""
	CRLF
	IN? FORD,HERE \?L13
	ZERO? FORD-COUNTER \?L13
	MOVE FORD,LOCAL-GLOBALS
	CALL INT,I-FORD >STACK
	PUT STACK,0,0
	SET 'FORD-GONE,1
	MOVE TOWEL,HERE
	FCLEAR TOWEL,TRYTAKEBIT
	CRLF
	PRINTI "Ford drops the towel and dashes away."
	CRLF
?L13:	CALL HELD?,THING >STACK
	ZERO? STACK /FALSE
	MOVE THING,LOCAL-GLOBALS
	CRLF
	PRINTI "In all the turmoil, "
	IN? THING,GOWN \?L22
	PRINTI "the "
	PRINTD THING
	PRINTI " drops out of your pocket and rolls away."
	JUMP ?L26
?L22:	PRINTI "you drop the "
	PRINTD THING
	PRINTI " and it rolls away."
?L26:	PRINTI " It is the least of your worries. Anyway,"
	PRINT GET-RID
	CRLF
	RTRUE
?L1:	EQUAL? VOGON-COUNTER,2 \?L32
	CRLF
	PRINTI "The vast yellow ships thunder across the sky, spreading waves of terror and panic in their wake. The voice of the "
	PRINTD VOGON-CAPTAIN
	PRINTI " slams across the country, insisting that the planning charts and demolition orders have been available at the local planning office in Alpha Centauri for fifty years and it's too late to start making a fuss about it now."
	CRLF
	ZERO? FORD-GONE \TRUE
	CRLF
	EQUAL? IDENTITY-FLAG,FORD \?L38
	CALL HELD?,THUMB,PROTAGONIST >STACK
	ZERO? STACK /?L40
	IN? THUMB,PROTAGONIST \?L42
	PRINTI "The "
	PRINTD THUMB
	PRINTI " in "
	PRINTD HANDS
	PRINTI " begins to whine."
	JUMP ?L46
?L42:	PRINTI "You remove the "
	PRINTD THUMB
	PRINTI " from your satchel."
?L46:	PRINTI " Lights pulsate across its surface. "
	PRINT THUMB-FUMBLE
	MOVE THUMB,HERE
	SET 'P-IT-OBJECT,THUMB
	JUMP ?L51
?L40:	PRINTI "You wish you were holding your "
	PRINTD THUMB
	PRINTI "."
?L51:	PRINTR " Arthur is struggling desperately towards you. The end of this planet is now only seconds away."
?L38:	MOVE THUMB,HERE
	SET 'P-IT-OBJECT,THUMB
	PRINTR "Throughout the noise, Ford is shouting at you. He removes a small black device from his satchel, but accidentally drops it at your feet."
?L32:	EQUAL? VOGON-COUNTER,3 \?L59
	CRLF
	PRINTI "Fierce gales whip across the land, and thunder bangs continuously through the air in the wake of the giant ships. "
	EQUAL? IDENTITY-FLAG,ARTHUR \?L62
	ZERO? FORD-GONE \?L62
	PRINTI "Ford fights to reach you, but the wind is too fierce. Further announcements from the "
	PRINTD VOGON-CAPTAIN
	PRINTR " make it clear that demolition will begin in just a few seconds.

Through the blinding rain, you see lights flickering on the small device."
?L62:	EQUAL? IDENTITY-FLAG,FORD \?L66
	IN? THUMB,HERE \?L66
	ZERO? FLUFF-TO-GOWN /?L67
	FSET COUNTRY-LANE,REVISITBIT
?L67:	PRINT DRIVEN-BACK
	PRINTI " Fortunately, at this point, Arthur picks up the Thumb, and somehow manages to push the right button"
	FSET? THUMB,MUNGEDBIT \?L74
	PRINTI ". Unfortunately, the"
	PRINT THUMB-CLICKS
	SET 'VOGON-COUNTER,4
	PRINTI " "
	CALL I-VOGONS
	RTRUE
?L74:	PRINTI "."
	CRLF
	CRLF
	CALL PRINT-ID,STR?192
	CALL JIGS-UP,STR?193
	RTRUE
?L66:	CRLF
	RTRUE
?L59:	EQUAL? VOGON-COUNTER,5 \FALSE
	PRINTI "The Earth is destroyed by the "
	PRINTD FLEET
	ZERO? FLUFF-TO-GOWN /?L87
	FSET COUNTRY-LANE,REVISITBIT
?L87:	CALL PRINT-ID,STR?194
	CALL JIGS-UP,STR?104
	RTRUE

	.FUNCT GO-TO-LANE
	SET 'LYING-DOWN,0
	CRLF
	PRINTI "You hear sounds of panic from the street. You "
	EQUAL? IDENTITY-FLAG,FORD \?L8
	IN? ARTHUR,HERE /?L3
	PRINTI "leave the Pub and run into Arthur..."
	CRLF
	CRLF
	JUMP ?L7
?L3:	EQUAL? IDENTITY-FLAG,FORD \?L8
	PRINTI "and Arthur"
	JUMP ?L12
?L8:	PRINTI "and Ford"
?L12:	PRINTI " rush outside..."
	CRLF
	CRLF
?L7:	CALL GOTO,COUNTRY-LANE
	EQUAL? IDENTITY-FLAG,FORD \?L17
	MOVE ARTHUR,COUNTRY-LANE
	RTRUE
?L17:	MOVE FORD,COUNTRY-LANE
	RTRUE

	.FUNCT FLEET-F
	EQUAL? PRSA,V?ENJOY \?L1
	PRINT ZEN
	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?THROUGH,V?WALK-TO \?L5
	SET 'AWAITING-REPLY,11
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTR "From here?"
?L5:	EQUAL? PRSA,V?EXAMINE \FALSE
	EQUAL? HERE,HOLD,AIRLOCK,CAPTAINS-QUARTERS /FALSE
	PRINTR "The fleet consists of terrifying numbers of huge, ugly, yellow ships, all scarred with the results of many such past demolition jobs. Chicago's John Hancock tower, knocked about a bit and painted yellow, is what they each look like. That is, knocked about a bit, painted yellow, and flying."

	.FUNCT LEAVE-EARTH
	CALL INT,I-HOUSEWRECK >STACK
	PUT STACK,0,0
	CALL INT,I-BULLDOZER >STACK
	PUT STACK,0,0
	CALL INT,I-PROSSER >STACK
	PUT STACK,0,0
	CALL INT,I-FORD >STACK
	PUT STACK,0,0
	CALL INT,I-VOGONS >STACK
	PUT STACK,0,0
	SET 'HEADACHE,0
	SET 'BULLDOZER-COUNTER,0
	SET 'PROSSER-COUNTER,0
	SET 'PROSSER-LYING,0
	SET 'FORD-COUNTER,0
	SET 'DRUNK-LEVEL,0
	SET 'HOUSE-DEMOLISHED,0
	SET 'VOGON-COUNTER,0
	SET 'EARTH-DEMOLISHED,1
	SET 'IDENTITY-FLAG,ARTHUR
	MOVE ARTHUR,GLOBAL-OBJECTS
	MOVE DOG,LOCAL-GLOBALS
	MOVE FLEET,LOCAL-GLOBALS
	MOVE FORD,LOCAL-GLOBALS
	CALL HELD?,SANDWICH >STACK
	ZERO? STACK \?L1
	ZERO? SANDWICH-BOUGHT /?L1
	MOVE SANDWICH,LOCAL-GLOBALS
?L1:	FSET BEER,NDESCBIT
	FCLEAR PROSSER,TOUCHBIT
	FCLEAR FRONT-OF-HOUSE,NDESCBIT
	FCLEAR FRONT-OF-HOUSE,TOUCHBIT
	FCLEAR COUNTRY-LANE,TOUCHBIT
	RTRUE

	.FUNCT ARTHUR-F
	EQUAL? IDENTITY-FLAG,ARTHUR \?L1
	EQUAL? ARTHUR,PRSO \?L3
	CALL PERFORM,PRSA,ME,PRSI
	RTRUE
?L3:	CALL PERFORM,PRSA,PRSO,ME
	RTRUE
?L1:	EQUAL? ARTHUR,WINNER \?L6
	IN? FLEET,HERE \?L7
	PRINT ABOVE-NOISE
	CRLF
	JUMP ?L23
?L7:	EQUAL? PRSA,V?FOLLOW \?L11
	EQUAL? HERE,FRONT-OF-HOUSE \?L11
	EQUAL? PRSO,ME \?L11
	ZERO? PROSSER-LYING /?L12
	PRINTI "Arthur seems willing to do so."
	CRLF
	JUMP ?L23
?L12:	CALL BUT-THAT-MAN,STR?195
	CRLF
	JUMP ?L23
?L11:	EQUAL? PRSA,V?DRINK \?L17
	EQUAL? PRSO,BEER \?L17
	FSET? BEER,NDESCBIT \?L18
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?DRINK,BEER
	SET 'WINNER,ARTHUR
	RTRUE
?L18:	PRINTI "Arthur seems to be waiting to follow your lead."
	CRLF
	JUMP ?L23
?L17:	PRINTI "Arthur looks too confused to respond."
	CRLF
?L23:	CALL FUCKING-CLEAR >STACK
	RSTACK
?L6:	EQUAL? PRSA,V?ASK-FOR,V?TELL,V?HELLO /?L27
	EQUAL? PRSA,V?TELL-ABOUT,V?ASK-ABOUT \?L26
?L27:	EQUAL? IDENTITY-FLAG,TRILLIAN \?L26
	EQUAL? PRSO,ARTHUR \?L26
	ZERO? FLUFF-REMOVED /?L28
	CALL I-ARTHUR
	JUMP ?L30
?L28:	PRINTI "You approach Arthur. He seems to find your tone a little cool, smiles unhappily, and wanders to the other end of the room."
	CRLF
?L30:	CALL QUEUE,I-ARTHUR,2 >STACK
	PUT STACK,0,1
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L26:	EQUAL? PRSA,V?ASK-FOR,V?ASK-ABOUT,V?TELL-ABOUT \?L33
	EQUAL? PRSO,ARTHUR \?L33
	EQUAL? IDENTITY-FLAG,TRILLIAN \?L33
	CALL PERFORM,V?HELLO,ARTHUR
	RTRUE
?L33:	EQUAL? PRSA,V?CARVE \?L34
	EQUAL? PRSI,MEMORIAL \?L34
	CALL PERFORM,V?CARVE,YOUR-NAME,MEMORIAL
	RTRUE
?L34:	EQUAL? PRSA,V?GIVE \?L35
	EQUAL? PRSO,TOWEL \?L35
	EQUAL? HERE,FRONT-OF-HOUSE \?L35
	ZERO? TOWEL-OFFERED \?L35
	SET 'TOWEL-OFFERED,1
	PRINTI "Inexplicably, Arthur takes no notice of the towel which, magnificently, you are trying to return to him. Instead, he says, ""Ford, what about my home?""

You start guiltily. Does he actually KNOW that the Earth is about to be destroyed? You start to ask him, then stop. If he knows, what the Zark is he doing lying here in the mud in front of...

You look around. You notice the "
	PRINTD BULLDOZER
	PRINTI " properly for the first time. You notice Arthur's house. You notice the workmen. The penny drops. His HOUSE is about to be demolished. You feel like a complete...what's the word?"
	CALL IDIOT? >STACK
	ZERO? STACK /?L38
	PRINTI "Thank you. An idiot is exactly what you feel like."
	JUMP ?L42
?L38:	PRINTI "No, actually, ""idiot"" was the word I was looking for."
?L42:	CRLF
	CRLF
	PRINTI "In a reckless moment you go completely mad and decide that you ought to take Arthur with you. You try to tell Arthur about the importance of getting a drink, but he's rambling on about a man called Prosser."
	CRLF
	RETURN 2
?L35:	EQUAL? PRSO,SANDWICH \?L49
	EQUAL? PRSA,V?GIVE \?L52
	MOVE SANDWICH,ARTHUR
	PRINTR "Arthur takes it, sniffs it suspiciously, and wisely decides that it's safer in his pocket than in his stomach."
?L49:	EQUAL? PRSA,V?GIVE \?L52
	EQUAL? PRSO,SATCHEL-FLUFF \?L52
	ZERO? HOUSE-DEMOLISHED /?L53
	MOVE SATCHEL-FLUFF,LOCAL-GLOBALS
	SET 'FLUFF-TO-GOWN,1
	PRINTR "Arthur hiccups, takes the fluff, and sticks it in his pocket."
?L53:	PRINTR "Arthur blinks several times, but doesn't take the fluff. Perhaps if he had a few drinks in him..."
?L52:	EQUAL? PRSA,V?EXAMINE \?L60
	EQUAL? IDENTITY-FLAG,TRILLIAN \?L60
	PRINTI "Arthur seems nice and well meaning, but also terribly shy."
	ZERO? FLUFF-REMOVED \?L63
	MOVE JACKET-FLUFF,HERE
	CALL QUEUE,I-ARTHUR,-1 >STACK
	PUT STACK,0,1
	PRINTI " He has tried to start a "
	PRINTD CONVERSATION
	PRINTI " with you several times, but still hasn't gotten past ""Hello."" He has an enormous, unsightly ball of fluff on his jacket."
?L63:	CRLF
	RTRUE
?L60:	EQUAL? PRSA,V?FOLLOW \?L68
	EQUAL? FOLLOW-FLAG,4 \?L68
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L68:	EQUAL? PRSA,V?PICK-UP \?L69
	EQUAL? IDENTITY-FLAG,TRILLIAN \?L69
	CALL PERFORM,V?PICK-UP,ZAPHOD
	RTRUE
?L69:	EQUAL? PRSA,V?LISTEN \FALSE
	EQUAL? IDENTITY-FLAG,TRILLIAN \FALSE
	ZERO? FLUFF-REMOVED /FALSE
	PRINTR "Unfortunately, you seem to have no choice."

	.FUNCT IDIOT?
	CRLF
	CRLF
	PRINTI ">"
	READ P-INBUF,P-LEXV
	GET P-LEXV,1 >STACK
	EQUAL? STACK,W?IDIOT \FALSE
	RTRUE

	.FUNCT I-UNEASY
	INC 'UNEASY-COUNTER
	EQUAL? HERE,PUB /?L1
	CALL INT,I-UNEASY >STACK
	PUT STACK,0,0
	RFALSE
?L1:	CRLF
	EQUAL? UNEASY-COUNTER,1 \?L4
	PRINTR "You feel uneasy about something."
?L4:	EQUAL? UNEASY-COUNTER,2,3,4 \?L8
	PRINTR "You still feel uneasy."
?L8:	PRINTI "The sense of uneasiness you've been so busy ignoring now utterly engulfs you, as you realise that you've broken the fundamental rule of time travel: ""Do as you would have done by."" The rational foundation of the Universe crashes and within a few seconds the whole of creation ceases ever to have exis"
	CRLF
	CRLF
	CRLF
	CALL PRINT-ID,STR?196
	QUIT

	.FUNCT I-ARTHUR
	CALL QUEUE,I-ARTHUR,-1 >STACK
	PUT STACK,0,1
	EQUAL? IDENTITY-FLAG,TRILLIAN \?L1
	ZERO? FLUFF-REMOVED /?L3
	CRLF
	IN? ARTHUR,HERE /?L5
	MOVE ARTHUR,HERE
	PRINTR "Arthur follows you like an eager puppy."
?L5:	PRINTI "Arthur tries, unsuccessfully, to interest you by talking about "
	CALL PICK-ONE,BORES >STACK
	PRINT STACK
	CRLF
	RTRUE
?L3:	RANDOM 100 >STACK
	LESS? 20,STACK /FALSE
	MOVE ARTHUR,HERE
	MOVE JACKET-FLUFF,HERE
	CRLF
	PRINTR "Arthur walks up and says ""Hello, again."" He looks shy, embarrassed and stuck for anything else to say, and quickly walks to the other end of the room."
?L1:	IN? ARTHUR,HERE /FALSE
	MOVE ARTHUR,HERE
	PRINTR "Arthur follows you."

	.FUNCT SCENE-THROUGH-WINDOW
	MOVE ARTHUR,FRONT-OF-HOUSE
	CALL INT,I-ARTHUR >STACK
	PUT STACK,0,0
	SET 'HOUSE-DEMOLISHED,1
	SET 'PROSSER-LYING,0
	SET 'FOLLOW-FLAG,4
	CALL QUEUE,I-FOLLOW,2 >STACK
	PUT STACK,0,1
	PRINTI " You hear a muffled crash. It's probably Arthur's little house getting knocked down, which you tell him. This DOES upset him, and he tears out the door.

Through the window, you see him running up the lane. A small dog chases after him, yapping, "
	ZERO? DOG-FED \?L5
	IN? SANDWICH,ARTHUR \?L3
?L5:	SET 'DOG-FED,1
	PRINTI "and he throws it a "
	PRINTD SANDWICH
	PRINTI ". The dog devours the sandwich"
	PRINT WITH-PASSION
	CRLF
	RTRUE
?L3:	PRINTR "but he ignores it. The dog gulps uncomfortably."

	.FUNCT MINERAL-WATER-F
	EQUAL? PRSA,V?DRINK-FROM,V?DRINK \?L1
	PRINTR "Bad idea. Even Santraginus Five seawater is illegal on most planets. (You can imagine what kind of beach communities they have.)"
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \?L5
	CALL PERFORM,V?EXAMINE,PRSO
	RTRUE
?L5:	EQUAL? PRSA,V?CLOSE,V?OPEN \?L6
	PRINTR "This is one of those clever new always-open always-closed bottles."
?L6:	EQUAL? PRSA,V?THROW,V?POUR \FALSE
	CALL LIQUID-SPILL >STACK
	RSTACK

	.FUNCT HOLD-F,RARG
	EQUAL? RARG,M-END \?L5
	FSET? HOLD,NDESCBIT /?L1
	FSET HOLD,NDESCBIT
	FSET PEANUTS,TAKEBIT
	FCLEAR PEANUTS,NDESCBIT
	FCLEAR PEANUTS,TRYTAKEBIT
	FCLEAR TOWEL,TRYTAKEBIT
	MOVE PEANUTS,PROTAGONIST
	MOVE FORD,HERE
	MOVE MINERAL-WATER,FORD
	SET 'GROGGY,1
	CALL QUEUE,I-GROGGY,3 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-FORD,6 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-ANNOUNCEMENT,18 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-GUARDS,36 >STACK
	PUT STACK,0,1
	RANDOM 6 >LINE-NUMBER
	RANDOM 3 >WORD-NUMBER
	ADD SCORE,8 >SCORE
	SET 'P-IT-OBJECT,PEANUTS
	CRLF
	PRINTI "Ford removes the bottle of "
	PRINTD MINERAL-WATER
	PRINTR " which he's been waving under your nose. He tells you that you are aboard a Vogon spaceship, and gives you some peanuts."
?L1:	EQUAL? RARG,M-END \?L5
	FSET? HOLD,REVISITBIT \?L5
	SET 'DREAMING,1
	CALL PRINT-ID,STR?197
	CALL JIGS-UP,STR?198
	RTRUE
?L5:	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "This is a squalid room filled with grubby mattresses, unwashed cups, and unidentifiable bits of smelly alien underwear. A door lies to port, and an airlock lies to starboard."
	ZERO? GOWN-HUNG /?L13
	PRINTI " Your gown is hanging from a hook"
	FSET? TOWEL,SURFACEBIT /?L39
	PRINTI "."
?L13:	FSET? TOWEL,SURFACEBIT \?L19
?L39:	ZERO? GOWN-HUNG /?L21
	PRINTI " and a "
	JUMP ?L25
?L21:	PRINTI " A "
?L25:	PRINTI "towel is draped over a drain on the floor."
?L19:	EQUAL? PANEL-BLOCKER,0,SATCHEL /?L31
	PRINTI " Resting in front of a "
	PRINTD ROBOT-PANEL
	PRINTI " at the base of one wall is"
	CALL ARTICLE,PANEL-BLOCKER
	PRINTI "."
?L31:	CRLF
	RTRUE

	.FUNCT I-GROGGY
	CALL QUEUE,I-GROGGY,-1 >STACK
	PUT STACK,0,1
	INC 'GROGGY-COUNTER
	ZERO? GROGGY \?L1
	CALL INT,I-GROGGY >STACK
	PUT STACK,0,0
	SET 'GROGGY-COUNTER,0
	RFALSE
?L1:	CRLF
	EQUAL? GROGGY-COUNTER,1,2 \?L4
	PRINTI "You begin to feel "
	EQUAL? GROGGY-COUNTER,2 \?L8
	PRINTI "in"
?L8:	PRINTR "distinctly groggy."
?L4:	EQUAL? GROGGY-COUNTER,3 \?L15
	PRINTR "You begin to feel very indistinct."
?L15:	PRINTI "Your serious allergic reaction to protein loss from"
	PRINT BEAM
	PRINTI "s becomes a cause celebre amongst various holistic pressure groups in the Galaxy and leads to a total ban on dematerialisation. Within fifty years, space travel is replaced by a keen interest in old furniture restoration and market gardening. In this new, quieter Galaxy, the art of telepathy flourishes as never before, creating a new universal harmony which brings all life together, converts all matter into thought and brings about the rebirth of the entire Universe on a higher and better plane of existence.

However, none of this affects you, because you are dead."
	CRLF
	CALL PRINT-ID,STR?199
	CALL FINISH >STACK
	RSTACK

	.FUNCT DISPENSER-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "The dispenser is tall, has a button at around eye-level, and says ""Babel Fish"" in large letters. Anything dispensed would probably come out the slot at around knee-level."
	CALL FINE-PRODUCT
	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?PUT-IN-FRONT \?L5
	EQUAL? PRSO,EARS,HEAD \?L5
	SET 'LYING-DOWN,1
	PRINTI "You are now lying down with your ear near the "
	PRINTD DISPENSER
	PRINTR " slot."
?L5:	EQUAL? PRSA,V?LIE-DOWN \FALSE
	ZERO? IN-FRONT-FLAG /FALSE
	CALL PERFORM,V?PUT-IN-FRONT,HEAD,DISPENSER
	RTRUE

	.FUNCT DISPENSER-BUTTON-F
	EQUAL? PRSA,V?PUSH \FALSE
	ZERO? LYING-DOWN /?L3
	PRINTR "You can't reach it from down here."
?L3:	ZERO? FISH-COUNTER \?L7
	PRINTR "Click."
?L7:	DEC 'FISH-COUNTER
	PRINTI "A single "
	PRINTD BABEL-FISH
	PRINTI " shoots out of the slot. It sails across the room and "
	ZERO? GOWN-HUNG \?L13
	PRINTI "through a "
	PRINTD FISH-HOLE
	PRINTI " in the wall, just under a "
	PRINTD HOOK
	PRINTR "."
?L13:	PRINTI "hits the dressing gown. The fish slides down the "
	ZERO? SLEEVE-TIED /?L20
	PRINTI "inside (nice try, though)"
	JUMP ?L24
?L20:	PRINTI "sleeve"
?L24:	PRINTI " of the gown and falls to the floor, "
	FSET? TOWEL,SURFACEBIT /?L29
	PRINTR "vanishing through the grating of a hitherto unnoticed drain."
?L29:	PRINTI "landing on the towel. A split-second later, a tiny cleaning robot whizzes across the floor, grabs the fish, and continues its breakneck pace toward a "
	PRINTD ROBOT-PANEL
	PRINTI " at the base of the wall. "
	ZERO? PANEL-BLOCKER \?L36
	PRINTR "The robot zips through the panel, and is gone."
?L36:	EQUAL? PANEL-BLOCKER,SATCHEL /?L40
	PRINTI "The robot zips around"
	CALL ARTICLE,PANEL-BLOCKER
	PRINTR ", through the panel, and is gone."
?L40:	PRINTI "The robot plows into the satchel, sending the "
	PRINTD BABEL-FISH
	EQUAL? ITEM-ON-SATCHEL,MAIL,0 /?L48
	PRINTI " and"
	CALL ARTICLE,ITEM-ON-SATCHEL,1
?L48:	PRINTI " flying through the air in a graceful arc"
	EQUAL? ITEM-ON-SATCHEL,MAIL /?L77
	PRINTI ". "
	PRINT ROBOT-FLIES-IN
	PRINTI "catches the "
	PRINTD BABEL-FISH
	PRINTI " "
	ZERO? ITEM-ON-SATCHEL /?L59
	MOVE ITEM-ON-SATCHEL,LOCAL-GLOBALS
	PRINTI "and also manages to catch"
	CALL ARTICLE,ITEM-ON-SATCHEL,1
	SET 'ITEM-ON-SATCHEL,0
	JUMP ?L63
?L59:	PRINTI "(which is all the flying junk it can find)"
?L63:	PRINTR ", and exits."
?L77:	MOVE MAIL,LOCAL-GLOBALS
	ADD SCORE,12 >SCORE
	MOVE BABEL-FISH,PROTAGONIST
	CALL RUNNING?,I-ANNOUNCEMENT >STACK
	ZERO? STACK /?L69
	CALL QUEUE,I-GUARDS,4 >STACK
	PUT STACK,0,1
	JUMP ?L71
?L69:	FSET? CAPTAINS-QUARTERS,TOUCHBIT /?L71
	CALL QUEUE,I-ANNOUNCEMENT,4 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-GUARDS,7 >STACK
	PUT STACK,0,1
?L71:	SET 'FISH-COUNTER,0
	SET 'ITEM-ON-SATCHEL,0
	PRINTI " surrounded by a cloud of junk mail. Another robot flies in and begins madly collecting the cluttered plume of mail. The "
	PRINTD BABEL-FISH
	PRINTR " continues its flight, landing with a loud ""squish"" in your ear."

	.FUNCT FISH-HOLE-F
	EQUAL? PRSA,V?LOOK-INSIDE \?L1
	PRINTI "You see only "
	PRINTD DARK-OBJECT
	PRINTR "."
?L1:	EQUAL? PRSA,V?PUT \?L5
	EQUAL? PRSI,FISH-HOLE \?L5
	FSET? PRSO,INTEGRALBIT \?L6
	CALL PART-OF >STACK
	RSTACK
?L6:	GETP PRSO,P?SIZE >STACK
	LESS? STACK,5 \?L8
	MOVE PRSO,LOCAL-GLOBALS
	PRINTR "It falls through the hole and vanishes."
?L8:	PRINTR "It doesn't fit through the hole."
?L5:	EQUAL? PRSA,V?PUT-IN-FRONT,V?PUT-ON \?L14
	EQUAL? PRSI,FISH-HOLE \?L14
	EQUAL? PRSO,ME,EARS,HANDS /?L17
	EQUAL? PRSO,HEAD \?L15
?L17:	CALL PERFORM,V?STAND-BEFORE,FISH-HOLE
	RTRUE
?L15:	CALL PERFORM,V?HANG,PRSO,HOOK
	RTRUE
?L14:	EQUAL? PRSA,V?SPUT-ON,V?BLOCK-WITH \?L19
	EQUAL? PRSO,FISH-HOLE \?L19
	CALL PERFORM,V?HANG,PRSI,HOOK
	RTRUE
?L19:	EQUAL? PRSA,V?BLOCK \?L20
	CALL PERFORM,V?STAND-BEFORE,FISH-HOLE
	RTRUE
?L20:	EQUAL? PRSA,V?LIE-DOWN \FALSE
	ZERO? IN-FRONT-FLAG /FALSE
	CALL PERFORM,V?STAND-BEFORE,FISH-HOLE
	RTRUE

	.FUNCT HOOK-F
	EQUAL? PRSA,V?EXAMINE \?L1
	ZERO? GOWN-HUNG /?L3
	PRINTR "Your gown is hanging from it."
?L3:	PRINTR "The hook is attached to the wall, inches above a tiny hole."
?L1:	EQUAL? PRSA,V?PUT-ON,V?HANG \FALSE
	ZERO? LYING-DOWN /?L11
	PRINT WHILE-LYING
	CRLF
	RTRUE
?L11:	EQUAL? PRSO,GOWN \?L15
	FSET? GOWN,WORNBIT \?L16
	CALL IDROP
	RTRUE
?L16:	SET 'GOWN-HUNG,1
	MOVE GOWN,HERE
	FSET GOWN,NDESCBIT
	FSET GOWN,TRYTAKEBIT
	FCLEAR GOWN,OPENBIT
	PRINTR "The gown is now hanging from the hook, covering a tiny hole."
?L15:	EQUAL? PRSO,HEAD,EARS,HANDS \?L21
	CALL PERFORM,V?STAND-BEFORE,HOOK
	RTRUE
?L21:	FSET? PRSO,TAKEBIT \?L22
	FSET? PRSO,TRYTAKEBIT \?L23
	PRINT NOT-HOLDING
	CALL ARTICLE,PRSO,1
	PRINTR "."
?L23:	MOVE PRSO,HERE
	PRINTR "It slips off the hook."
?L22:	CALL V-COUNT >STACK
	RSTACK

	.FUNCT DRAIN-F
	EQUAL? PRSA,V?PUT-ON \?L1
	FSET? TOWEL,SURFACEBIT \?L3
	PRINTR "The drain is already covered by the towel."
?L3:	ZERO? LYING-DOWN /?L7
	PRINT WHILE-LYING
	CRLF
	RTRUE
?L7:	EQUAL? PRSO,TOWEL \?L10
	FSET TOWEL,CONTBIT
	FSET TOWEL,SURFACEBIT
	FSET TOWEL,OPENBIT
	FSET TOWEL,NDESCBIT
	FSET TOWEL,TRYTAKEBIT
	MOVE TOWEL,HERE
	CALL PERFORM,V?EXAMINE,DRAIN
	RTRUE
?L10:	PRINTI "The drain is too large to be covered by"
	CALL ARTICLE,PRSO,1
	PRINTR "."
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \?L16
	CALL PERFORM,V?LOOK-INSIDE,FISH-HOLE
	RTRUE
?L16:	EQUAL? PRSA,V?EXAMINE \FALSE
	FSET? TOWEL,SURFACEBIT \FALSE
	PRINTR "The towel completely covers the drain."

	.FUNCT ROBOT-PANEL-F
	EQUAL? PRSA,V?CLOSE,V?EXAMINE \?L1
	PRINTR "The panel, only a few inches high, is currently closed."
?L1:	EQUAL? PRSA,V?OPEN \?L5
	PRINT BUDGE
	CRLF
	RTRUE
?L5:	EQUAL? PRSA,V?BLOCK \?L8
	SET 'AWAITING-REPLY,6
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTI "With "
	PRINTD HANDS
	PRINTR "s? By force of will?"
?L8:	EQUAL? PRSA,V?LIE-DOWN \?L11
	ZERO? IN-FRONT-FLAG /?L11
	CALL PERFORM,V?STAND-BEFORE,ROBOT-PANEL
	RTRUE
?L11:	EQUAL? PRSA,V?PUT-ON,V?PUT-IN-FRONT,V?PUT-IN-FRONT \?L12
	EQUAL? PRSI,ROBOT-PANEL \?L12
	CALL PERFORM,V?BLOCK-WITH,ROBOT-PANEL,PRSO
	RTRUE
?L12:	EQUAL? PRSA,V?SPUT-ON,V?BLOCK-WITH \FALSE
	EQUAL? PRSO,ROBOT-PANEL \FALSE
	EQUAL? PRSI,EARS,HANDS,HEAD /?L16
	EQUAL? PRSI,EYES \?L14
?L16:	CALL V-COUNT >STACK
	RSTACK
?L14:	CALL HELD?,PRSI >STACK
	ZERO? STACK \?L17
	PRINT NOT-HOLDING
	CALL ARTICLE,PRSI,1
	PRINTR "."
?L17:	ZERO? PANEL-BLOCKER /?L22
	PRINTI "But"
	CALL ARTICLE,PANEL-BLOCKER,1
	PRINTI " is already in front of the "
	PRINTD ROBOT-PANEL
	PRINTR "."
?L22:	ZERO? LYING-DOWN /?L27
	PRINT WHILE-LYING
	CRLF
	RTRUE
?L27:	MOVE PRSI,HERE
	SET 'PANEL-BLOCKER,PRSI
	FSET PRSI,TRYTAKEBIT
	PRINTI "Okay,"
	EQUAL? PRSI,SATCHEL \?L33
	PRINTI " the satchel is lying on its side"
	JUMP ?L37
?L33:	FSET PRSI,NDESCBIT
	CALL ARTICLE,PRSI,1
	PRINTI " is sitting"
?L37:	PRINTI " in front of the "
	PRINTD ROBOT-PANEL
	PRINTR "."

	.FUNCT BABEL-FISH-F
	EQUAL? PRSA,V?REMOVE,V?TAKE \FALSE
	PRINTI "That would be foolish. Having a "
	PRINTD BABEL-FISH
	PRINTR " in your ear is terribly useful."

	.FUNCT GLASS-CASE-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "The "
	PRINTD GLASS-CASE
	PRINTI " is "
	FSET? GLASS-CASE,OPENBIT \?L5
	PRINTI "open"
	JUMP ?L9
?L5:	PRINTI "closed"
?L9:	PRINTI ". Attached to it are a "
	PRINTD KEYBOARD
	PRINTR " and a switch."
?L1:	EQUAL? PRSA,V?OPEN \?L14
	FSET? GLASS-CASE,OPENBIT /?L14
	PRINT BUDGE
	CRLF
	RTRUE
?L14:	EQUAL? PRSA,V?MUNG \FALSE
	PRINTI "The hold of the Vogon ship is virtually undamaged by the explosion of the "
	PRINTD GLASS-CASE
	CALL PRINT-ID,STR?200
	CALL JIGS-UP,STR?201
	RTRUE

	.FUNCT GLASS-CASE-OPENS
	FSET? GLASS-CASE,OPENBIT \?L1
	PRINTI "Nothing happens."
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L1:	FSET GLASS-CASE,OPENBIT
	PRINTI "The "
	PRINTD GLASS-CASE
	PRINTI " opens."
	CRLF
	FCLEAR PLOTTER,TRYTAKEBIT
	ZERO? GLASS-CASE-SCORE \?L8
	SET 'GLASS-CASE-SCORE,1
	ADD SCORE,25 >SCORE
?L8:	CALL FUCKING-CLEAR >STACK
	RSTACK

	.FUNCT CASE-SWITCH-F
	EQUAL? PRSA,V?PUSH,V?TURN,V?LAMP-ON /?L3
	EQUAL? PRSA,V?THROW,V?MOVE \FALSE
?L3:	CALL HELD?,BABEL-FISH >STACK
	ZERO? STACK /?L4
	PRINTI "A recording plays: ""To open the case, type in the "
	EQUAL? WORD-NUMBER,1 \?L8
	PRINTI "first"
	JUMP ?L15
?L8:	EQUAL? WORD-NUMBER,2 \?L12
	PRINTI "second"
	JUMP ?L15
?L12:	EQUAL? WORD-NUMBER,3 \?L15
	PRINTI "third"
?L15:	PRINTR " word from the second verse of the Captain's current favourite poem. WARNING: An incorrect input will cause the case to explode."""
?L4:	PRINTI "A recording plays: ""A"
	CALL PRODUCE-GIBBERISH,5
	CRLF
	RTRUE

	.FUNCT PRODUCE-GIBBERISH,N,GIBBERISH-COUNTER,SUPER-COUNTER
	SET 'SUPER-COUNTER,0
?L1:	INC 'SUPER-COUNTER
	SET 'GIBBERISH-COUNTER,0
?L3:	INC 'GIBBERISH-COUNTER
	CALL PICK-ONE,GIBBERISH >STACK
	PRINT STACK
	EQUAL? GIBBERISH-COUNTER,10 \?L3
	EQUAL? SUPER-COUNTER,N /?L20
	PRINTI " o"
	EQUAL? SUPER-COUNTER,N \?L1
?L20:	PRINTI "."""
	RTRUE

	.FUNCT I-ANNOUNCEMENT
	CALL QUEUE,I-ANNOUNCEMENT,-1 >STACK
	PUT STACK,0,1
	CRLF
	PRINTI "An announcement is coming over the ship's intercom. """
	CALL HELD?,BABEL-FISH,PROTAGONIST >STACK
	ZERO? STACK /?L3
	PRINTR "This is the Captain. My instruments show that we've picked up a couple of hitchhikers. I hate freeloaders, and when my guards find you I'll have you thrown into space. On second thought, maybe I'll read you some of my poetry first. Repeating..."""
?L3:	PRINTI "E"
	CALL PRODUCE-GIBBERISH,10
	CRLF
	RTRUE

	.FUNCT I-GUARDS
	EQUAL? HERE,HOLD \?L1
	CALL INT,I-ANNOUNCEMENT >STACK
	PUT STACK,0,0
	CRLF
	PRINTI "Guards burst in and grab you and Ford, who comes slowly awake. They drag you down the corridor to a large cabin, where they strap you into large, menacing chairs..."
	CRLF
	CRLF
	SET 'HERE,CAPTAINS-QUARTERS
	MOVE NAME,HERE
	SET 'LYING-DOWN,0
	CALL QUEUE,I-CAPTAIN,2 >STACK
	PUT STACK,0,1
	SET 'FORD-SLEEPING,0
	FSET FORD,NDESCBIT
	MOVE PROTAGONIST,POETRY-APPRECIATION-CHAIR
	CALL V-LOOK
	MOVE FORD,HERE
	MOVE GUARDS,HERE
	RTRUE
?L1:	IN? RIFLES,LOCAL-GLOBALS /FALSE
	CRLF
	PRINT GUARDS-REALIZE
	PRINTI "They"
	CALL PRINT-ID,STR?202
	CALL GUARD-DEATH
	RTRUE

	.FUNCT CAPTAINS-QUARTERS-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "This is the cabin of the "
	PRINTD VOGON-CAPTAIN
	PRINTI ". You and Ford are strapped into "
	PRINTD POETRY-APPRECIATION-CHAIR
	PRINTR "s."

	.FUNCT POETRY-APPRECIATION-CHAIR-F,RARG=0
	ZERO? RARG \FALSE
	EQUAL? PRSA,V?LEAP,V?WALK,V?DISEMBARK /?L4
	EQUAL? PRSA,V?WALK-AROUND \?L3
?L4:	SET 'AWAITING-REPLY,7
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTR "You're strapped in, remember?"
?L3:	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	EQUAL? PRSO,POETRY-APPRECIATION-CHAIR \FALSE
	CALL TELL-ME-HOW >STACK
	RSTACK

	.FUNCT VOGON-CAPTAIN-F
	EQUAL? PRSA,V?THANK,V?HELLO,V?TELL /?L3
	EQUAL? PRSA,V?ASK-FOR,V?ASK-ABOUT \?L1
	EQUAL? VOGON-CAPTAIN,PRSO \?L1
?L3:	PRINTI "One of the guards lightly bashes your skull with the butt of his weapon"
	CALL PRINT-ID,STR?203
	CALL HELD?,BABEL-FISH >STACK
	ZERO? STACK /?L6
	PRINTI ". ""This is a poetry appreciation session, prisoner. No talking!"""
	CRLF
	JUMP ?L10
?L6:	PRINTI " and says, ""A"
	CALL PRODUCE-GIBBERISH,2
	CRLF
?L10:	CALL FUCKING-CLEAR >STACK
	RSTACK
?L1:	IN? POETRY,HERE \FALSE
	EQUAL? PRSA,V?BLOCK \FALSE
	CALL PERFORM,V?LISTEN,POETRY
	RTRUE

	.FUNCT I-CAPTAIN
	CALL QUEUE,I-CAPTAIN,-1 >STACK
	PUT STACK,0,1
	INC 'CAPTAIN-COUNTER
	CRLF
	EQUAL? CAPTAIN-COUNTER,1 \?L1
	PRINTI """If he's going to read us his poetry,"" mutters Ford, sweating profusely, ""just pray he softens us up with some cudgels first..."""
	CRLF
	CRLF
?L1:	CALL HELD?,BABEL-FISH,PROTAGONIST >STACK
	ZERO? STACK \?L6
	PRINTI "The "
	PRINTD VOGON-CAPTAIN
	PRINTI " says, ""O"
	CALL PRODUCE-GIBBERISH,2
	EQUAL? CAPTAIN-COUNTER,6 \?L10
	CALL GUARDS-TO-AIRLOCK >STACK
	RSTACK
?L10:	CRLF
	RTRUE
?L6:	EQUAL? CAPTAIN-COUNTER,1 \?L13
	PRINTI """Hello, hitchhikers!"" begins the "
	PRINTD VOGON-CAPTAIN
	PRINTR ". ""I've decided to read you a verse of my poetry!"""
?L13:	EQUAL? CAPTAIN-COUNTER,2 \?L16
	PRINTR """Oh freddled gruntbuggly, thy nacturations are to me!"""
?L16:	EQUAL? CAPTAIN-COUNTER,3 \?L19
	PRINTR """As plurdled gabbleblotchits on a lurgid bee."""
?L19:	EQUAL? CAPTAIN-COUNTER,4 \?L22
	PRINTR """Groop I implore thee, my foonting turlingdromes."""
?L22:	EQUAL? CAPTAIN-COUNTER,5 \?L25
	PRINTR """And hooptiously drangle me with crinkly bindlewurdles, or I will rend thee in the gobberwarts with my blurglecruncheon, see if I don't!"""
?L25:	EQUAL? CAPTAIN-COUNTER,6 \?L28
	ZERO? POEM-ENJOYED /?L29
	PRINTR """You looked like you enjoyed my poem. I think...yes, I think I'll read the NEXT verse, also!"""
?L29:	PRINTI """You didn't seem to enjoy my poem at all! Guards, toss them out the airlock!"""
	CALL GUARDS-TO-AIRLOCK >STACK
	RSTACK
?L28:	EQUAL? CAPTAIN-COUNTER,7 \?L36
	EQUAL? LINE-NUMBER,1,2 \?L37
	PRINT LINE-A
	CRLF
	RTRUE
?L37:	EQUAL? LINE-NUMBER,3,4 \?L41
	PRINT LINE-B
	CRLF
	RTRUE
?L41:	PRINT LINE-C
	CRLF
	RTRUE
?L36:	EQUAL? CAPTAIN-COUNTER,8 \?L47
	EQUAL? LINE-NUMBER,3,5 \?L48
	PRINT LINE-A
	CRLF
	RTRUE
?L48:	EQUAL? LINE-NUMBER,1,6 \?L52
	PRINT LINE-B
	CRLF
	RTRUE
?L52:	PRINT LINE-C
	CRLF
	RTRUE
?L47:	EQUAL? CAPTAIN-COUNTER,9 \?L58
	EQUAL? LINE-NUMBER,4,6 \?L59
	PRINT LINE-A
	CRLF
	RTRUE
?L59:	EQUAL? LINE-NUMBER,2,5 \?L63
	PRINT LINE-B
	CRLF
	RTRUE
?L63:	PRINT LINE-C
	CRLF
	RTRUE
?L58:	EQUAL? CAPTAIN-COUNTER,10 \?L69
	PRINTR """Gerond withoutitude form into formless bloit, why not then? Moose."""
?L69:	EQUAL? CAPTAIN-COUNTER,11 \FALSE
	PRINTI """Since you have somehow managed to survive two verses of my poetry, I have no choice but to space you. Guards!"""
	CALL GUARDS-TO-AIRLOCK >STACK
	RSTACK

	.FUNCT GUARDS-TO-AIRLOCK
	CALL INT,I-CAPTAIN >STACK
	PUT STACK,0,0
	PRINTI " A guard grabs you and Ford, and drags you toward the hold. Ford whispers, ""Don't worry, I'll think of something!"""
	CRLF
	CRLF
	FCLEAR HOLD,TOUCHBIT
	CALL GOTO,HOLD
	FCLEAR FORD,NDESCBIT
	MOVE GUARDS,HERE
	MOVE FORD,HERE
	CALL QUEUE,I-FORD,1 >STACK
	PUT STACK,0,1
	RTRUE

	.FUNCT POETRY-F
	EQUAL? PRSA,V?LISTEN,V?ENJOY \?L1
	LESS? CAPTAIN-COUNTER,2 \?L1
	PRINTI "The "
	PRINTD VOGON-CAPTAIN
	PRINTR " hasn't begun yet!"
?L1:	EQUAL? PRSA,V?ENJOY \?L5
	CALL HELD?,BABEL-FISH >STACK
	ZERO? STACK \?L6
	PRINTR "You can't even understand it, let alone enjoy it!"
?L6:	ZERO? POEM-ENJOYED /?L10
	SET 'AWAITING-REPLY,8
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTR "Hey, let's not overdo it, okay?"
?L10:	SET 'POEM-ENJOYED,1
	ADD SCORE,15 >SCORE
	PRINTI "You realise that, although the "
	PRINTD POETRY
	PRINTR " is indeed astoundingly bad, worse things happen at sea, and in fact, at school. With an effort for which Hercules himself would have patted you on the back, you grit your teeth and enjoy the stuff."
?L5:	EQUAL? PRSA,V?LISTEN \?L16
	PRINTR "You have no choice. Why not relax and enjoy it?"
?L16:	IN? POETRY,HERE \?L19
	EQUAL? PRSA,V?BLOCK \?L19
	CALL PERFORM,V?LISTEN,POETRY
	RTRUE
?L19:	EQUAL? PRSA,V?EXAMINE,V?READ \FALSE
	PRINTR "You can't see it from here."

	.FUNCT VOGON-CORRIDOR-DOOR-F
	EQUAL? PRSA,V?THROUGH,V?UNLOCK,V?OPEN \FALSE
	CALL DO-WALK,P?WEST >STACK
	RSTACK

	.FUNCT VOGON-AIRLOCK-DOOR-F
	EQUAL? PRSA,V?THROUGH,V?OPEN \FALSE
	PRINT BUDGE
	CRLF
	RTRUE

	.FUNCT AIRLOCK-OBJECT-F
	EQUAL? PRSA,V?WALK-TO,V?THROUGH \?L1
	EQUAL? HERE,AIRLOCK \?L3
	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L3:	EQUAL? HERE,HOLD \FALSE
	CALL DO-WALK,P?WEST >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?DISEMBARK,V?EXIT,V?LEAVE \FALSE
	EQUAL? HERE,AIRLOCK \?L10
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L10:	PRINT LOOK-AROUND
	CRLF
	RTRUE

	.FUNCT AIRLOCK-F,RARG
	EQUAL? RARG,M-END \FALSE
	INC 'AIRLOCK-COUNTER
	CRLF
	EQUAL? AIRLOCK-COUNTER,1 \?L3
	PRINTI "Ford points at the "
	PRINTD VOGON-OUTER-DOOR
	PRINTR ". ""In about two minutes, it will open and we'll be ejected into the vacuum of space. But don't panic, I'll think of something."""
?L3:	EQUAL? AIRLOCK-COUNTER,2 \?L7
	PRINTR "Ford is mumbling to himself."
?L7:	EQUAL? AIRLOCK-COUNTER,3 \?L10
	PRINTR "Ford produces a pencil and begins scribbling equations on the wall."
?L10:	EQUAL? AIRLOCK-COUNTER,4 \FALSE
	PRINTI "Ford's eyes light up. ""Do you still have the Electronic Sub-Etha Auto Hitching Thu..."" At that moment, the airlock door opens, and you and Ford are blown out into space.

"
	CALL HELD?,GUIDE >STACK
	ZERO? STACK /?L16
	PRINTI "Your elbow must have struck some key on "
	PRINTD GUIDE
	PRINTI " because it begins droning out an entry, coincidentally enough the entry on SPACE. """
	PRINT SPACE-TEXT
	PRINTI """ (Footnote 9)"
	CRLF
	CRLF
?L16:	PRINTI "Precisely twenty-nine seconds later, you and Ford are scooped up by a passing ship. Gasping for air, you pass out..."
	CRLF
	CRLF
	SET 'HEART-PROB,100
	CALL GOTO,DARK >STACK
	RSTACK

	.FUNCT LAIR-OBJECT-F
	EQUAL? PRSA,V?DISEMBARK,V?EXIT,V?LEAVE /?L3
	EQUAL? PRSA,V?WALK-TO,V?BOARD,V?THROUGH \FALSE
?L3:	CALL V-WALK-AROUND >STACK
	RSTACK

	.FUNCT INNER-LAIR-ENTER-F
	FSET? BEAST,MUNGEDBIT \?L1
	RETURN INNER-LAIR
?L1:	PRINTI "The Beast blocks the exit."
	CRLF
	RFALSE

	.FUNCT LAIR-F,RARG
	EQUAL? RARG,M-LOOK \?L1
	PRINTI "This is the lair of the "
	PRINTD BEAST
	PRINTR ". There are exits east and southwest."
?L1:	EQUAL? RARG,M-END \FALSE
	FSET? LAIR,NDESCBIT /FALSE
	SET 'DREAMING,1
	FSET LAIR,NDESCBIT
	FCLEAR SARCASTIC-NAME,INVISIBLE
	FCLEAR BEAST-NAME,INVISIBLE
	CALL QUEUE,I-BEAST,2 >STACK
	PUT STACK,0,1
	CRLF
	PRINTI "The Beast whips its evil-smelling tail away from your nose and bellows a brain-shattering roar. By suddenly popping out of nowhere you have disturbed its train of thought. However, "
	FSET? LAIR,REVISITBIT \?L8
	PRINTI "the Beast is beginning to get used to this sort of thing, shrugs it off, and sinks ten or so of"
	PRINT CLAWS
	CALL PRINT-ID,STR?204
	CALL JIGS-UP,STR?205
	RTRUE
?L8:	PRINTI "since its train of thought was the usual one, and in fact the only one it knows, which goes like this ""hungry ... hungry ... hungry ... hungry ... bad-tempered ... hungry ..."", it soon starts to chug along again."
	CRLF
	CRLF
	PRINT BEAST-DESC
	PRINTR " It advances on you, and roars out a demand that you say your name."

	.FUNCT OUTER-LAIR-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "This is a large walled courtyard. Strewn about are a profusion of gnawed bones bleaching in the sun. In case the significance of these fails to strike you, there is also a "
	PRINTD MEMORIAL
	PRINTI " in the middle of the courtyard, on which the Beast has roughly carved the names of all its victims."
	IN? STONE,HERE \?L5
	CRLF
	PRINTI "Some "
	PRINTD STONE
	PRINTI "s lie near the exit to the west."
?L5:	CRLF
	RTRUE

	.FUNCT MEMORIAL-F
	EQUAL? PRSA,V?CARVE \?L1
	EQUAL? MEMORIAL,PRSI \?L1
	FSET? BEAST,MUNGEDBIT \?L3
	CALL V-DIG >STACK
	RSTACK
?L3:	EQUAL? PRSO,NAME \?L5
	PRINTI "Whose name? The "
	PRINTD BEAST-NAME
	PRINTR "? Your aunt's name? One of the Infinite Unknowable names of Buddha? How about the name of Fred who runs (or rather ran) your local chip shop? At least that's a short name -- you might have time to write it before the Beast eats you."
?L5:	EQUAL? PRSO,SARCASTIC-NAME \?L8
	PRINTR "Concentrate. Learn to distinguish between genuinely helpful suggestions and mere sarcasm."
?L8:	FSET? TOWEL,WORNBIT /?L11
	CALL QUEUE,I-BEAST,2 >STACK
	PUT STACK,0,1
	PRINTI "Before you even chip the first letter, the Beast sees you and hurls you spinning away with a bellow of rage."
	PRINT GETTING-CLOSE
	CRLF
	RTRUE
?L11:	ZERO? BEARINGS-LOST /?L14
	PRINTR "You cannot see and have lost your bearings. You stumble hopelessly and begin to arouse the Beast's suspicions. It's stupid but not THAT stupid."
?L14:	EQUAL? PRSO,ME,ARTHUR,YOUR-NAME \?L17
	FSET? BEAST,MUNGEDBIT \?L18
	PRINTR "You already did that!"
?L18:	PRINTI "You chip away with the stone. It's not your best writing, what with your mounting sense of panic and a towel wrapped around your head. However, it suffices..."
	CRLF
	CRLF
	PRINT JUST-AS
	ZERO? NAME-TOLD /?L25
	FSET BEAST,MUNGEDBIT
	CALL QUEUE,I-BEAST,9 >STACK
	PUT STACK,0,1
	PRINTR "suddenly sees your name freshly carved on its memorial of remembrance. Mystery solved. It realises it must have already eaten you in a fit of absent-mindedness. (Its mind is very very small and quite frequently absent.) It decides to give up the rest of its afternoon to the twin arts of digestion and contemplation. It settles down for a snooze."
?L25:	PRINTI "sees """
	PRINTD ARTHUR
	PRINTI """ freshly carved on the "
	PRINTD MEMORIAL
	PRINTR ". This doesn't ring any bells with the Beast. It roars with fury, and eyes the thing it can't see because it's got a towel on its head (i.e. you) with deepening suspicion."
?L17:	PRINT JUST-AS
	PRINTI "suddenly sees "
	EQUAL? PRSO,BEAST-NAME,BEAST \?L35
	PRINTI "its own name"
	JUMP ?L39
?L35:	PRINTI """"
	PRINTD PRSO
	PRINTI """"
?L39:	PRINTI " freshly carved on the "
	PRINTD MEMORIAL
	PRINTI ". This disconcerts it, as it has no recollection of eating "
	EQUAL? PRSO,BEAST-NAME,BEAST \?L44
	PRINTI "itself"
	JUMP ?L48
?L44:	PRINTI "anyone by that name"
?L48:	PRINTI "."
	PRINT SLOWLY-DAWNS
	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?READ \?L53
	PRINTI "Gleb Snardfitz, Bibs Trench, Zeke Fitzberry, Elmo Smith, "
	FSET? BEAST,MUNGEDBIT \?L56
	PRINTD ARTHUR
	PRINTI ", "
?L56:	PRINTR "Brian ""Spike"" Berkowitz, Clybert Quackentotter..."
?L53:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "There are countless names carved on the "
	PRINTD MEMORIAL
	PRINTI ":"
	CRLF
	CALL PERFORM,V?READ,MEMORIAL
	RTRUE

	.FUNCT STONE-F
	EQUAL? PRSA,V?TAKE \?L1
	FSET? STONE,TRYTAKEBIT \?L1
	FCLEAR STONE,NDESCBIT
	FCLEAR STONE,TRYTAKEBIT
	RFALSE
?L1:	EQUAL? PRSA,V?DROP \?L3
	EQUAL? HERE,OUTER-LAIR \?L3
	FSET STONE,NDESCBIT
	FSET STONE,TRYTAKEBIT
	RFALSE
?L3:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "It's hard as a rock."

	.FUNCT BEAST-DESCFCN,X
	FSET? BEAST,MUNGEDBIT \?L1
	PRINTR "The Beast is in the corner, sleeping peacefully (Footnote 5)."
?L1:	PRINTI "The "
	PRINTD BEAST
	PRINTR " is here, looking particularly nasty and hungry."

	.FUNCT BEAST-F
	EQUAL? BEAST,WINNER \?L1
	FSET? TOWEL,WORNBIT \?L3
	CALL V-SAY >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?TELL-ABOUT \?L5
	EQUAL? PRSO,ME \?L5
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,BEAST,PRSI
	SET 'WINNER,BEAST
	RTRUE
?L5:	EQUAL? PRSA,V?HELLO \?L6
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,BEAST
	SET 'WINNER,BEAST
	RTRUE
?L6:	EQUAL? PRSA,V?WHAT \?L7
	EQUAL? PRSO,OBJECT-OF-GAME \?L7
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?ASK-ABOUT,BEAST,OBJECT-OF-GAME
	SET 'WINNER,BEAST
	RTRUE
?L7:	ZERO? NAME-TOLD \?L12
	EQUAL? PRSA,V?MY-NAME \?L8
	EQUAL? PRSO,NAME \?L8
	EQUAL? PRSI,ARTHUR \?L9
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?SAY-NAME,YOUR-NAME
	SET 'WINNER,BEAST
	RTRUE
?L9:	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?SAY-NAME,BEAST-NAME
	SET 'WINNER,BEAST
	RTRUE
?L8:	ZERO? NAME-TOLD \?L12
	EQUAL? PRSA,V?I-AM \?L12
	EQUAL? PRSO,ARTHUR \?L13
	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?SAY-NAME,YOUR-NAME
	SET 'WINNER,BEAST
	RTRUE
?L13:	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?SAY-NAME,BEAST-NAME
	SET 'WINNER,BEAST
	RTRUE
?L12:	PRINTI "The Beast just roars at you."
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?ASK-ABOUT,V?HELLO,V?TELL /?L20
	EQUAL? PRSA,V?TELL-ABOUT,V?ASK-FOR \?L19
?L20:	EQUAL? PRSO,BEAST \?L19
	FSET? BEAST,MUNGEDBIT \?L21
	PRINTI "The Beast is sleeping!"
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L21:	FSET? TOWEL,WORNBIT \FALSE
	CALL SAID-WITH-TOWEL
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L19:	EQUAL? PRSA,V?TELL-TIME \?L27
	EQUAL? PRSI,YOUR-NAME \?L27
	CALL PERFORM,V?SAY-NAME,YOUR-NAME
	RTRUE
?L27:	EQUAL? PRSA,V?TELL-NAME \?L28
	EQUAL? PRSO,YOUR-NAME \?L28
	CALL PERFORM,V?SAY-NAME,YOUR-NAME
	RTRUE
?L28:	EQUAL? PRSA,V?GIVE,V?SHOW \?L29
	EQUAL? THING,PRSO \?L29
	CALL QUEUE,I-BEAST,2 >STACK
	PUT STACK,0,1
	PRINTR "The Beast stops in its tracks, deeply impressed, and compliments you on the quality of your aunts, and complains that all its aunts are complete horrors. It then continues its dreadful attack."
?L29:	EQUAL? PRSA,V?THROW \?L32
	EQUAL? PRSI,BEAST \?L32
	CALL IDROP >STACK
	ZERO? STACK \?L32
	MOVE PRSO,HERE
	CALL PERFORM,V?KILL,BEAST
	RTRUE
?L32:	EQUAL? PRSA,V?KILL \?L33
	EQUAL? PRSO,BEAST \?L33
	FSET? BEAST,MUNGEDBIT \?L34
	CALL PERFORM,V?ALARM,BEAST
	RTRUE
?L34:	CALL QUEUE,I-BEAST,2 >STACK
	PUT STACK,0,1
	PRINTI "A footling effort. The shock waves of the Beast's laughter push you back."
	CRLF
	CALL PRINT-ID,STR?206 >STACK
	RSTACK
?L33:	EQUAL? PRSA,V?ALARM \?L39
	FSET? BEAST,MUNGEDBIT \?L39
	PRINTI "The Beast casually brushes you away with one of"
	PRINT CLAWS
	CALL PRINT-ID,STR?207
	CALL JIGS-UP,STR?104
	RTRUE
?L39:	EQUAL? PRSA,V?ASK-ABOUT \?L42
	EQUAL? PRSI,OBJECT-OF-GAME \?L42
	PRINTR """Eat. Carve name on memorial. Sleep. Eat more. Roar a lot. Stuff like that."""
?L42:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINT BEAST-DESC
	CRLF
	RTRUE

	.FUNCT I-BEAST
	CALL QUEUE,I-BEAST,-1 >STACK
	PUT STACK,0,1
	CRLF
	FSET? BEAST,MUNGEDBIT \?L1
	MOVE CHIPPER,PROTAGONIST
	FCLEAR LAIR,NDESCBIT
	FSET LAIR,REVISITBIT
	CALL JIGS-UP,STR?208
	RTRUE
?L1:	FSET? TOWEL,WORNBIT \?L3
	PRINTI "The Beast still thinks it can't see you, but it's so irritated at having an invisible object stumble around its lair that it swipes out angrily with one of"
	PRINT CLAWS
	CALL PRINT-ID,STR?209
	CALL JIGS-UP,STR?210
	RTRUE
?L3:	IN? BEAST,HERE /?L6
	MOVE BEAST,HERE
	MOVE NAME,HERE
	SET 'BEAST-COUNTER,0
	PRINTR "Bellowing with rage, the Beast charges after you."
?L6:	INC 'BEAST-COUNTER
	EQUAL? BEAST-COUNTER,1 \?L10
	PRINTI "With a headsplitting roar, the "
	PRINTD BEAST
	PRINTR " charges towards you."
?L10:	EQUAL? BEAST-COUNTER,2 \?L14
	ZERO? NAME-TOLD \?L14
	PRINTI "The Beast, sharpening"
	PRINT CLAWS
	PRINTR ", demands again that you say your name."
?L14:	GRTR? BEAST-COUNTER,4 \?L17
	CALL PRINT-ID,STR?211
	CALL BEAST-DEATH >STACK
	RSTACK
?L17:	PRINTR "The Beast is nearly upon you."

	.FUNCT BEAST-DEATH
	PRINTI "With a vast savage roar, the Beast tears you limb from limb with"
	PRINT CLAWS
	CALL JIGS-UP,STR?212
	RTRUE

	.FUNCT YOUR-NAME-F
	EQUAL? PRSA,V?WHAT \?L1
	CALL PERFORM,V?WHO,ME
	RTRUE
?L1:	EQUAL? HERE,OUTER-LAIR \?L3
	FSET? BEAST,MUNGEDBIT /FALSE
?L3:	EQUAL? PRSA,V?MOVE,V?RUB,V?EXAMINE \FALSE
	PRINTR "Huh?"

	.FUNCT NUT-COM-INTERFACE-F
	EQUAL? PRSA,V?TAKE \?L3
	FSET? NUT-COM-INTERFACE,TRYTAKEBIT \?L1
	FCLEAR NUT-COM-INTERFACE,TRYTAKEBIT
	FCLEAR NUT-COM-INTERFACE,NDESCBIT
	FSET SKELETON,TOUCHBIT
	ADD SCORE,25 >SCORE
	RFALSE
?L1:	EQUAL? PRSA,V?TAKE \?L3
	CALL RUNNING?,I-TEA >STACK
	ZERO? STACK /?L3
	PRINTI "You get a powerful electric shock."
	CRLF
	CALL PRINT-ID,STR?213 >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "The "
	PRINTD PRSO
	PRINTI " is square, about ten inches on each side."
	CALL FINE-PRODUCT
	CRLF
	RTRUE

	.FUNCT I-CARELESS-WORDS
	CRLF
	SET 'FLEET-PROB,60
	PRINTI "It is of course well known that careless talk costs lives, but the full scale of the problem is not always appreciated. For instance, at the exact moment you said """
	CALL RESTORE-INPUT,FIRST-BUFFER
	PRINTI """ a freak wormhole opened in the fabric of the space-time continuum and carried your words far far back in time across almost infinite reaches of space to a distant galaxy where strange and warlike beings were poised on the brink of frightful interstellar battle.

The two opposing leaders were meeting for the last time. A dreadful silence fell across the conference table as the commander of the Vl'Hurgs, resplendent in his"
	PRINT BATTLE-SHORTS
	PRINTI "gazed levelly at the "
	PRINTD GGUGVUNT
	PRINTI " squatting opposite him"
	PRINT CLOUD-OF-STEAM
	PRINTI "As a million sleek and horribly beweaponed star cruisers poised to unleash electric death at his single word of command, the Vl'Hurg challenged his vile enemy to take back what it had said about his mother.

The creature stirred in its sickly broiling vapour, and at that very moment the words """
	CALL RESTORE-INPUT,FIRST-BUFFER
	PRINTI """ drifted across the conference table. Unfortunately, in the Vl'Hurg tongue this was the most dreadful insult imaginable, and there was nothing for it but to wage terrible war for centuries. Eventually the error was detected, but over two hundred and fifty thousand worlds, their peoples and cultures perished in the holocaust.

You have destroyed most of a small galaxy. Please pick your words with greater care."
	CRLF
	CALL PRINT-ID,STR?214 >STACK
	RSTACK

	.FUNCT MICROSCOPIC-FLEET-F
	EQUAL? PRSA,V?THROUGH \FALSE
	PRINT LOOK-AROUND
	CRLF
	RTRUE

	.FUNCT CANOPY-F
	EQUAL? PRSA,V?LOOK-INSIDE \FALSE
	PRINTI "Through the "
	PRINTD CANOPY
	PRINTI " of the ship you can see a vast "
	PRINTD MICROSCOPIC-FLEET
	PRINTR " flying in formation behind you through the black, glittering emptiness of space. Ahead is a star system towards which you are hurtling at a terrifying speed."

	.FUNCT WAR-CHAMBER-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	FCLEAR CONVERSATION,INVISIBLE
	MOVE THIRD-PLANET,HERE
	SET 'DREAMING,1
	CALL QUEUE,I-DOG,-1 >STACK
	PUT STACK,0,1
	RFALSE
?L1:	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "Spread before you, astonishingly enough, is the "
	PRINTD WAR-CHAMBER
	PRINTI " of a star battle cruiser. "
	CALL PERFORM,V?LOOK-INSIDE,CANOPY
	RTRUE

	.FUNCT VLHURG-DESCFCN,X
	CRLF
	PRINTI "Standing near you are two creatures who are gazing at the star system with terrible hatred in their eyes. One is wearing"
	PRINT BATTLE-SHORTS
	PRINTI "and the other is wreathed"
	PRINT CLOUD-OF-STEAM
	PRINTI "They are engaged in "
	PRINTD CONVERSATION
	PRINTR "."

	.FUNCT VLHURG-F
	EQUAL? PRSA,V?TELL \?L1
	PRINTI "You are clearly the worst diplomat that ever lived, and are about to become the worst one that ever died. That is an even worse insult in the G'Gugvunt tongue than """
	CALL PRINT-ID,STR?215
	CALL RESTORE-INPUT,FIRST-BUFFER
	PRINTI """ is in the Vl'Hurg tongue."
	CRLF
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L7
	PRINTI "The "
	PRINTD VLHURG
	PRINTR " looks typically Vl'Hurgish."
?L7:	EQUAL? PRSA,V?LISTEN \FALSE
	FSET? VLHURG,MUNGEDBIT \?L11
	PRINTR "The creatures are speculating about who you are and what to do with you."
?L11:	FSET VLHURG,MUNGEDBIT
	PRINTI "  ""Hated planet!"" snarls the Vl'Hurg.
  ""Home of he that dared to say '"
	CALL RESTORE-INPUT,FIRST-BUFFER
	PRINTI "'"" rasps the G'Gugvunt.
  ""Detested words! Even now it sticks my soul to hear them uttered,"" barks the Vl'Hurg, ""even though ten thousand years have passed...""
  ""And as many senseless megadeaths! Worlds destroyed! My race and yours laid to waste! All because of he that dared shape the words '"
	CALL RESTORE-INPUT,FIRST-BUFFER
	PRINTI "'.""
  ""Torture to my Vl'Hurgish warrior heart to hear it spoken! Yet, even now, the hot breath of our vengeance blows hard upon this little world...""
  ""Vengeance on him who said '"
	CALL RESTORE-INPUT,FIRST-BUFFER
	PRINTI "'.""
  ""Yes, there's no need to keep repeating it,"" growls the Vl'Hurg.
  ""One happy thought,"" adds the G'Gugvunt. ""After millenia of bloody and perpetual conflict, our races have been brought together by this Quest for the Source of the Offending Remark. Perhaps, after our vengeance has been exacted on him who said '"
	CALL RESTORE-INPUT,FIRST-BUFFER
	PRINTR "'...""
  ""Will you stop saying it?""
  ""...perhaps we will continue to live in peace and harmony and...""
  ""We will talk about that AFTER we ... who's this?""

The two creatures turn and stare at you."

	.FUNCT GGUGVUNT-F
	EQUAL? PRSA,V?TELL \?L1
	CALL PERFORM,V?TELL,VLHURG
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L3
	PRINTI "The "
	PRINTD GGUGVUNT
	PRINTR " is looking typically G'Gugvuntish."
?L3:	EQUAL? PRSA,V?LISTEN \FALSE
	CALL PERFORM,V?LISTEN,VLHURG
	RTRUE

	.FUNCT THIRD-PLANET-F
	ZERO? EARTH-DEMOLISHED \?L1
	EQUAL? PRSO,THIRD-PLANET \?L3
	CALL PERFORM,PRSA,GROUND,PRSI
	RTRUE
?L3:	CALL PERFORM,PRSA,PRSO,GROUND >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?DISEMBARK,V?LEAVE \?L6
	PRINTR "You did!"
?L6:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTI "It is an utterly insignificant little blue-green planet, of the sort where they probably still wear "
	PRINTD DIGITAL-WATCH
	PRINTR "es."

	.FUNCT MAZE-EXIT-F
	RANDOM 100 >STACK
	LESS? 40,STACK /?L1
	PRINTI "An electrical impulse across a synapse gap temporarily blocks your way."
	CRLF
	RFALSE
?L1:	INC 'MAZE-COUNTER
	EQUAL? MAZE-COUNTER,3,17,36 \?L6
	MOVE PARTICLE,HERE
	JUMP ?L8
?L6:	MOVE PARTICLE,LOCAL-GLOBALS
?L8:	CALL V-LOOK
	RFALSE

	.FUNCT PARTICLE-F
	EQUAL? PRSA,V?MOVE,V?TAKE \?L1
	MOVE PARTICLE,LOCAL-GLOBALS
	FSET PARTICLE,MUNGEDBIT
	ADD SCORE,25 >SCORE
	FSET WAR-CHAMBER,REVISITBIT
	PRINTI "As you remove the "
	PRINTD PARTICLE
	CALL PRINT-ID,STR?216
	CALL JIGS-UP,STR?217
	RTRUE
?L1:	EQUAL? PRSA,V?READ,V?EXAMINE \FALSE
	PRINTI "As you look closer you see, inscribed in tiny letters on the "
	PRINTD PARTICLE
	PRINTR ":

  Sense, Common for:
     Dent, Arthur
   (for replacement,
  order part #31-541)"

	.FUNCT APARTMENT-F
	EQUAL? PRSA,V?EXIT,V?LEAVE \?L1
	EQUAL? HERE,LIVING-ROOM \?L3
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK
?L3:	CALL V-WALK-AROUND >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?THROUGH \FALSE
	PRINT LOOK-AROUND
	CRLF
	RTRUE

	.FUNCT PARTY-DESC,ROOM
	PRINTI "You are in a large "
	PRINTD ROOM
	PRINTI ". There is a party going on. Other rooms lie to the "
	RTRUE

	.FUNCT PARTY-EXIT-F
	FSET? APARTMENT-DOOR,OPENBIT \?L1
	PRINTI "What! Leave a fun party like this?"
	CRLF
	SET 'AWAITING-REPLY,3
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	RFALSE
?L1:	PRINTI "The door is closed."
	CRLF
	SET 'P-IT-OBJECT,APARTMENT-DOOR
	RFALSE

	.FUNCT LIVING-ROOM-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	EQUAL? IDENTITY-FLAG,TRILLIAN /?L1
	LOC HANDBAG >STACK
	PUT PARTY-TABLE,0,STACK
	LOC TWEEZERS >STACK
	PUT PARTY-TABLE,1,STACK
	FSET? HANDBAG,OPENBIT \?L3
	PUT PARTY-TABLE,2,1
	JUMP ?L5
?L3:	PUT PARTY-TABLE,2,0
?L5:	SET 'IDENTITY-FLAG,TRILLIAN
	MOVE TRILLIAN,GLOBAL-OBJECTS
	SET 'DREAMING,1
	CALL ROB,PROTAGONIST,MEMORIAL
	CALL ROB,HANDBAG,RAMP
	FCLEAR HANDBAG,OPENBIT
	MOVE HANDBAG,PROTAGONIST
	MOVE TWEEZERS,HANDBAG
	MOVE WINE,PROTAGONIST
	MOVE APPETIZERS,PROTAGONIST
	MOVE ARTHUR,HERE
	MOVE PHIL,HERE
	MOVE CAGE,HERE
	PRINTI "You're at a party being given by a distant and incredibly boring acquaintance. Among the people you've been introduced to are a shy, mousy fellow from the West Country named Arthur, and a flamboyant guy named Phil. You've had too many drinks already, and the room is beginning to buzz..."
	CRLF
	CRLF
	RTRUE
?L1:	EQUAL? RARG,M-END \?L8
	FSET? LIVING-ROOM,REVISITBIT \?L8
	CRLF
	CALL PRINT-ID,STR?218
	CALL JIGS-UP,STR?219
	RTRUE
?L8:	EQUAL? RARG,M-LOOK \FALSE
	CALL PARTY-DESC,LIVING-ROOM
	PRINTI "west and southwest, and the "
	PRINTD APARTMENT
	PRINTR "'s front door is south of here."

	.FUNCT APARTMENT-DOOR-F
	EQUAL? PRSA,V?THROUGH \FALSE
	CALL DO-WALK,P?SOUTH >STACK
	RSTACK

	.FUNCT DINING-ROOM-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	CALL PARTY-DESC,DINING-ROOM
	PRINTR "south and east."

	.FUNCT KITCHEN-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	CALL PARTY-DESC,KITCHEN
	PRINTR "north and northeast."

	.FUNCT WINE-F
	EQUAL? PRSA,V?ENJOY,V?DRINK \?L1
	PRINTR "You take a sip, and the room spins a little faster."
?L1:	EQUAL? PRSA,V?POUR,V?THROW \?L5
	CALL PRINT-ID,STR?220
	CALL SHRIEK >STACK
	RSTACK
?L5:	EQUAL? PRSA,V?DROP \FALSE
	CALL DROP-AT-PARTY >STACK
	RSTACK

	.FUNCT APPETIZERS-F
	EQUAL? PRSA,V?ENJOY,V?EAT \?L1
	PRINTI "You nibble at one of the hors d'oeuvres. It tastes "
	RANDOM 100 >STACK
	LESS? 40,STACK /?L5
	PRINTR "okay."
?L5:	RANDOM 100 >STACK
	LESS? 50,STACK /?L9
	PRINTR "delicious."
?L9:	PRINTR "terrible."
?L1:	EQUAL? PRSA,V?THROW \?L15
	CALL SHRIEK >STACK
	RSTACK
?L15:	EQUAL? PRSA,V?COUNT \?L16
	PRINTR "More than three, which is as high as you can count in your condition."
?L16:	EQUAL? PRSA,V?DROP \FALSE
	CALL DROP-AT-PARTY >STACK
	RSTACK

	.FUNCT DROP-AT-PARTY
	ZERO? ITEM-DROPPED-AT-PARTY \?L1
	SET 'ITEM-DROPPED-AT-PARTY,PRSO
	FSET HOSTESS,NDESCBIT
	CALL QUEUE,I-HOSTESS,3 >STACK
	PUT STACK,0,1
?L1:	MOVE PRSO,HERE
	EQUAL? PRSA,V?DROP \?L4
	PRINTR "Dropped."
?L4:	PRINTR "Thrown."

	.FUNCT SHRIEK
	PRINTI "The hostess lets out a blood-chilling shriek. ""My new carpet!"" "
	EQUAL? PRSA,V?THROW \?L3
	PRINTI "Grabbing a shard from your broken "
	PRINTD PRSO
	PRINTI ", s"
	JUMP ?L7
?L3:	PRINTI "S"
?L7:	CALL JIGS-UP,STR?221
	RTRUE

	.FUNCT HOSTESS-F
	EQUAL? HOSTESS,WINNER \?L1
	EQUAL? PRSA,V?YES \?L3
	EQUAL? AWAITING-REPLY,4 \?L3
	SET 'WINNER,PROTAGONIST
	CALL V-YES
	SET 'WINNER,HOSTESS
	RETURN WINNER
?L3:	EQUAL? PRSA,V?NO \?L5
	EQUAL? AWAITING-REPLY,4 \?L5
	SET 'WINNER,PROTAGONIST
	CALL V-NO
	SET 'WINNER,HOSTESS
	RETURN WINNER
?L5:	SET 'WINNER,PROTAGONIST
	CALL PERFORM,V?HELLO,HOSTESS
	CALL FUCKING-CLEAR >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?TELL-ABOUT,V?ASK-ABOUT,V?HELLO \FALSE
	EQUAL? PRSO,HOSTESS \FALSE
	PRINTI "The hostess is delighted to engage in "
	PRINTD CONVERSATION
	CALL PRINT-ID,STR?222
	CALL JIGS-UP,STR?223
	RTRUE

	.FUNCT I-HOSTESS
	CALL QUEUE,I-HOSTESS,-1 >STACK
	PUT STACK,0,1
	ZERO? ITEM-DROPPED-AT-PARTY \?L1
	FCLEAR HOSTESS,TOUCHBIT
	CALL INT,I-HOSTESS >STACK
	PUT STACK,0,0
	RFALSE
?L1:	MOVE HOSTESS,HERE
	MOVE ITEM-DROPPED-AT-PARTY,HERE
	CRLF
	FSET? HOSTESS,TOUCHBIT \?L4
	SET 'AWAITING-REPLY,4
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTI """Tricia dear,"" says the hostess insistently, ""don't you want your "
	PRINTD ITEM-DROPPED-AT-PARTY
	PRINTR "?"""
?L4:	FSET HOSTESS,TOUCHBIT
	SET 'P-IT-OBJECT,ITEM-DROPPED-AT-PARTY
	FSET ITEM-DROPPED-AT-PARTY,NDESCBIT
	PRINTI "The hostess, whom you've been avoiding all evening, scurries up with your "
	PRINTD ITEM-DROPPED-AT-PARTY
	PRINTR ". ""Oh, hello Tricia, how lovely to see you, I think you dropped this, dear."""

	.FUNCT SPEEDBOAT-F,RARG
	EQUAL? RARG,M-ENTER \?L1
	SET 'DREAMING,1
	SET 'IDENTITY-FLAG,ZAPHOD
	MOVE ZAPHOD,GLOBAL-OBJECTS
	MOVE WRENCH,TOOLBOX
	MOVE MAGNIFYING-GLASS,TOOLBOX
	FCLEAR TOOLBOX,OPENBIT
	CALL ROB,PROTAGONIST,MEMORIAL
	MOVE PROTAGONIST,PILOT-SEAT
	SET 'DESTINATION,CHANNEL
	CALL QUEUE,I-SPEEDBOAT,2 >STACK
	PUT STACK,0,1
	PRINTI "The pain at the back of your eyes is from partying until very late last night, and both your heads are suffering the worst hangover you've ever experienced. You remember formulating a plan to steal "
	PRINTD HEART-OF-GOLD
	PRINTI ", but you can't for the life of you remember any details."
	CRLF
	CRLF
	RTRUE
?L1:	EQUAL? RARG,M-LOOK \FALSE
	ZERO? BOAT-DOCKED /?L6
	PRINTI "The boat is resting atop a plume of water. The dais for the dedication ceremonies for "
	PRINTD HEART-OF-GOLD
	PRINTR " lies immediately north."
?L6:	PRINTI "You are piloting the "
	PRINTD BOAT-OBJECT
	PRINTI ", which features very simple controls, toward the island of France (Footnote 3), where the dedication ceremonies for "
	PRINTD HEART-OF-GOLD
	PRINTI " will occur. You are currently steering the boat toward"
	EQUAL? DESTINATION,CHANNEL \?L13
	PRINTI " a "
	PRINTD CHANNEL
	PRINTI " between "
	PRINTD CLIFF
	PRINTI " and a "
	PRINTD SPIRE
	PRINTR "."
?L13:	CALL ARTICLE,DESTINATION
	PRINTR "."

	.FUNCT I-SPEEDBOAT
	INC 'BOAT-COUNTER
	CALL QUEUE,I-SPEEDBOAT,-1 >STACK
	PUT STACK,0,1
	EQUAL? DESTINATION,CLIFF,SPIRE \?L3
	INC 'CRASH-COUNTER
	EQUAL? CRASH-COUNTER,4 \?L3
	SET 'BOAT-DOCKED,1
	CALL INT,I-SPEEDBOAT >STACK
	PUT STACK,0,0
	CRLF
	PRINTI "Suddenly, the autopilot leaps to life, steering the boat away from the "
	PRINTD DESTINATION
	PRINTI ". The crowd gathered for the dedication oohs and aahs as the boat swerves through the "
	PRINTD CHANNEL
	PRINTI ". As it reaches the base of the "
	PRINTD CLIFF
	PRINTR " a plume of water forms under it, sending it higher and higher. The crowd bursts into applause as the boat reaches the top of the cliff, just south of the ceremonial dais."
?L3:	EQUAL? PRSA,V?POINT,V?STEER /FALSE
	EQUAL? PRSA,V?AGAIN \?L12
	EQUAL? L-PRSA,V?STEER,V?POINT /FALSE
?L12:	CRLF
	LESS? BOAT-COUNTER,7 \?L15
	PRINTI "You continue to steer toward the "
	PRINTD DESTINATION
	PRINTR "."
?L15:	CALL INT,I-SPEEDBOAT >STACK
	PUT STACK,0,0
	PRINTI "You almost make it through the "
	PRINTD CHANNEL
	PRINTI " but the turbulent waters push the boat toward the rocks. The "
	PRINTD AUTOPILOT-BUTTON
	PRINTI " lights up and an "
	PRINT EYE-STALK
	CALL PRINT-ID,STR?224
	CALL JIGS-UP,STR?225
	RTRUE

	.FUNCT BOAT-OBJECT-F
	EQUAL? PRSA,V?STEER \?L1
	EQUAL? PRSO,BOAT-OBJECT \?L1
	ZERO? BOAT-DOCKED /?L3
	PRINTR "You've already reached your destination!"
?L3:	EQUAL? PRSI,DESTINATION \?L7
	PRINTI "You already ARE steering the boat toward the "
	PRINTD DESTINATION
	PRINTR "."
?L7:	EQUAL? PRSI,CHANNEL,SPIRE,CLIFF /?L10
	PRINTI "You can't steer the boat toward"
	CALL ARTICLE,PRSI,1
	PRINTR "!"
?L10:	SET 'DESTINATION,PRSI
	GRTR? BOAT-COUNTER,3 \?L16
	SET 'BOAT-COUNTER,3
?L16:	PRINTI "The boat is now heading straight at the "
	PRINTD DESTINATION
	PRINTR "."
?L1:	EQUAL? PRSA,V?DISEMBARK,V?LEAVE,V?EXIT /?L22
	EQUAL? PRSA,V?THROUGH \FALSE
?L22:	ZERO? BOAT-DOCKED /?L23
	CALL DO-WALK,P?NORTH >STACK
	RSTACK
?L23:	PRINT DONT-MIX
	CRLF
	RTRUE

	.FUNCT WATER-PSEUDO
	EQUAL? PRSA,V?BOARD,V?THROUGH \?L1
	PRINT DONT-MIX
	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?THROW,V?PUT \FALSE
	EQUAL? PRSI,PSEUDO-OBJECT \FALSE
	MOVE PRSO,LOCAL-GLOBALS
	PRINTR "Glub..."

	.FUNCT PILOT-SEAT-F,RARG=0
	EQUAL? RARG,M-BEG \?L1
	EQUAL? PRSA,V?WALK \FALSE
	CALL OUT-OF-FIRST,PILOT-SEAT >STACK
	RSTACK
?L1:	ZERO? RARG \FALSE
	EQUAL? PRSA,V?SEARCH,V?RAISE,V?LOOK-UNDER /?L8
	EQUAL? PRSA,V?TAKE \?L7
?L8:	IN? KEY,LOCAL-GLOBALS \?L7
	MOVE CUSHION-FLUFF,PROTAGONIST
	MOVE KEY,PROTAGONIST
	PRINTR "You discover and pick up a small key and a piece of fluff under the seat cushion."
?L7:	EQUAL? PRSA,V?EXAMINE \?L11
	PRINTR "The chair is very comfortable, with a thick plush cushion."
?L11:	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	EQUAL? PRSO,PILOT-SEAT \FALSE
	CALL TELL-ME-HOW >STACK
	RSTACK

	.FUNCT KEY-F
	EQUAL? PRSA,V?WHERE \FALSE
	EQUAL? HERE,SPEEDBOAT \FALSE
	IN? KEY,LOCAL-GLOBALS \FALSE
	PRINTR "It's probably around the boat somewhere."

	.FUNCT TOOLBOX-F
	EQUAL? PRSA,V?OPEN \?L1
	ZERO? PRSI \?L1
	FSET? TOOLBOX,OPENBIT /?L1
	PRINTR "It's locked."
?L1:	EQUAL? PRSA,V?LOCK \?L5
	FSET? TOOLBOX,OPENBIT \?L6
	CALL PERFORM,V?CLOSE,TOOLBOX
	RTRUE
?L6:	PRINTR "It is."
?L5:	EQUAL? PRSA,V?UNLOCK,V?OPEN \FALSE
	FSET? TOOLBOX,OPENBIT \?L12
	PRINT ALREADY-OPEN
	CRLF
	RTRUE
?L12:	ZERO? PRSI \?L17
	CALL HELD?,KEY >STACK
	ZERO? STACK /?L17
	SET 'PRSI,KEY
	PRINTI "(with the key)"
	CRLF
?L17:	EQUAL? PRSI,KEY \?L22
	FSET TOOLBOX,OPENBIT
	PRINTI "The tool box opens"
	FIRST? TOOLBOX >STACK \?L26
	PRINTI " revealing"
	CALL PRINT-CONTENTS,TOOLBOX
?L26:	PRINTR "."
?L22:	PRINTI "You can't unlock it with"
	ZERO? PRSI /?L36
	CALL ARTICLE,PRSI
	JUMP ?L38
?L36:	PRINTI " "
	PRINTD HANDS
?L38:	PRINTR "!"

	.FUNCT MAGNIFYING-GLASS-F
	EQUAL? PRSA,V?LOOK-INSIDE \FALSE
	PRINTR "You see your environs upside-down and slightly distorted."

	.FUNCT AUTOPILOT-BUTTON-F
	EQUAL? PRSA,V?LAMP-ON,V?PUSH \FALSE
	INC 'AUTOPILOT-COUNTER
	PRINTI "The button glows. An "
	PRINT EYE-STALK
	PRINTI "looks around, and withdraws. The light fades."
	EQUAL? AUTOPILOT-COUNTER,3 \?L5
	PRINTI " (Footnote 13)"
?L5:	CRLF
	RTRUE

	.FUNCT DESTINATION-F
	EQUAL? PRSA,V?WALK-TO \FALSE
	ZERO? BOAT-DOCKED \FALSE
	CALL PERFORM,V?STEER,BOAT-OBJECT,PRSO
	RTRUE

	.FUNCT DAIS-EXIT-F
	IN? GUARDS,HERE /?L1
	SET 'AWAITING-REPLY,5
	CALL QUEUE,I-REPLY,2 >STACK
	PUT STACK,0,1
	PRINTI "Don't you think it would be a bad idea to leave the ceremonies?"
	CRLF
	RFALSE
?L1:	IN? RIFLES,HERE /?L6
	IN? RIFLES,GUARDS \?L5
?L6:	PRINTI "You and "
	PRINTD TRILLIAN
	PRINTI " break for "
	PRINTD HEART-OF-GOLD
	PRINTI ". "
	FSET? BLASTER,TRYTAKEBIT \?L9
	PRINT GUARDS-REALIZE
	PRINTI "They"
	JUMP ?L13
?L9:	PRINTI "The guards"
?L13:	CALL PRINT-ID,STR?226
	CALL GUARD-DEATH
	RFALSE
?L5:	ADD SCORE,25 >SCORE
	FSET SPEEDBOAT,REVISITBIT
	MOVE BLASTER,LOCAL-GLOBALS
	CALL ROB,PROTAGONIST,HATCHWAY
	PRINTI "You and "
	PRINTD TRILLIAN
	PRINTI " enter "
	PRINTD HEART-OF-GOLD
	PRINTI ", that beautiful bauble you've been coveting ever since your decision to run for"
	PRINT PRESIDENT
	CALL JIGS-UP,STR?227
	RFALSE

	.FUNCT DAIS-F,RARG
	EQUAL? RARG,M-END \?L1
	FSET? SPEEDBOAT,REVISITBIT \?L1
	SET 'DREAMING,1
	CALL PRINT-ID,STR?228
	CALL JIGS-UP,STR?229
	RTRUE
?L1:	EQUAL? RARG,M-ENTER \?L3
	FSET? SPEEDBOAT,REVISITBIT /?L3
	PUTP PROTAGONIST,P?ACTION,DAIS-FUNCTION
	PRINTI "As you step out of the boat, the plume of water lowers it away. The crowd, unaware of the autopilot, bursts into a round of admiring applause."
	CRLF
	CRLF
	RTRUE
?L3:	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "This is a platform surrounded by a crowd. "
	IN? BANNER,HERE \?L9
	PRINTI "Several members of the crowd are holding a huge banner. "
?L9:	PRINTI "Just to the east is "
	PRINTD HEART-OF-GOLD
	IN? RIFLES,GUARDS \?L16
	PRINTI ". A semi-circle of guards are aiming "
	PRINTD RIFLES
	PRINTI "s at you and "
	PRINTD TRILLIAN
	JUMP ?L20
?L16:	IN? GUARDS,HERE \?L20
	PRINTI ". Many disarmed guards are nervously eyeing you and "
	PRINTD TRILLIAN
?L20:	IN? BLASTER,TRILLIAN \?L24
	PRINTI ", who is pointing a blaster at your head"
?L24:	PRINTR "."

	.FUNCT DAIS-FUNCTION
	EQUAL? PRSA,V?RESTORE,V?RESTART,V?QUIT /FALSE
	EQUAL? PRSA,V?SAVE,V?VERSION,V?SCORE /FALSE
	EQUAL? PRSA,V?VERBOSE,V?WALK,V?AGAIN /FALSE
	EQUAL? PRSA,V?SCRIPT,V?SUPER-BRIEF,V?BRIEF /FALSE
	EQUAL? PRSA,V?LOOK,V?FOOTNOTE,V?UNSCRIPT /FALSE
	EQUAL? PRSA,V?WHO,V?HELP,V?INVENTORY /FALSE
	EQUAL? PRSA,V?WHY,V?WHERE,V?WHAT /FALSE
	EQUAL? PRSA,V?THROUGH,V?NO,V?YES /FALSE
	EQUAL? PRSO,PSEUDO-OBJECT,BANNER \?L4
	EQUAL? PRSA,V?THROUGH,V?EXAMINE,V?COUNT /FALSE
	EQUAL? PRSA,V?READ /FALSE
?L4:	INC 'DAIS-COUNTER
	PRINT CROWD-CHEERS
	EQUAL? DAIS-COUNTER,4 \?L9
	PUTP PROTAGONIST,P?ACTION,PROTAGONIST-F
	MOVE TRILLIAN,HERE
	MOVE BLASTER,TRILLIAN
	MOVE GUARDS,HERE
	MOVE RIFLES,GUARDS
	CALL QUEUE,I-GUARDS,8 >STACK
	PUT STACK,0,1
	PRINTI " Suddenly, "
	PRINTD TRILLIAN
	PRINTI " leaps out of the crowd, grabs you by the necks, and points a blaster at your left head. Guards rush up, "
	PRINTD RIFLES
	PRINTI "s poised to shoot. ""Stay back!"" shouts "
	PRINTD TRILLIAN
	PRINTI ". ""One more step and the"
	PRINT PRESIDENT
	PRINTI " is fried meat!"" The guards seem unsure, and look at you for instructions."
?L9:	CALL FUCKING-CLEAR
	CRLF
	RTRUE

	.FUNCT CROWD-PSEUDO
	EQUAL? PRSA,V?EXAMINE,V?COUNT \?L1
	PRINTR "It's big."
?L1:	EQUAL? PRSA,V?SHOOT \?L5
	CALL PRINT-ID,STR?230
	CALL BLASTER-HOLD >STACK
	ZERO? STACK \TRUE
	PRINTR "You may be a scoundrel, but you're not a mass murderer."
?L5:	EQUAL? PRSA,V?THROUGH \?L11
	PRINTR "You'd be crushed by the enthusiasm of your admirers."
?L11:	EQUAL? PRSA,V?WAVE-AT,V?TELL \FALSE
	PRINT CROWD-CHEERS
	CRLF
	CALL FUCKING-CLEAR
	RTRUE

	.FUNCT PLATFORM-F
	EQUAL? HERE,SPEEDBOAT \?L1
	ZERO? BOAT-DOCKED \?L1
	CALL CANT-SEE,PLATFORM >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?WALK-TO,V?THROUGH \?L3
	EQUAL? HERE,DAIS \?L4
	PRINT LOOK-AROUND
	CRLF
	RTRUE
?L4:	CALL DO-WALK,P?NORTH >STACK
	RSTACK
?L3:	EQUAL? PRSA,V?DISEMBARK,V?LEAVE \FALSE
	EQUAL? HERE,DAIS \?L10
	CALL DO-WALK,P?EAST >STACK
	RSTACK
?L10:	PRINT LOOK-AROUND
	CRLF
	RTRUE

	.FUNCT BLASTER-F
	EQUAL? PRSA,V?TAKE \?L1
	FSET? BLASTER,TRYTAKEBIT \?L1
	PRINT GUARDS-REALIZE
	PRINTI "They"
	IN? RIFLES,GUARDS \?L5
	CALL PRINT-ID,STR?231
	CALL GUARD-DEATH >STACK
	RSTACK
?L5:	FCLEAR BLASTER,TRYTAKEBIT
	FCLEAR BLASTER,NDESCBIT
	MOVE BLASTER,PROTAGONIST
	CALL QUEUE,I-GUARDS,5 >STACK
	PUT STACK,0,1
	PRINTR " are disarmed, though, and unable to do anything as you take the blaster."
?L1:	EQUAL? PRSA,V?SHOOT \FALSE
	EQUAL? PRSI,BLASTER \FALSE
	EQUAL? PRSO,BLASTER \?L11
	CALL V-COUNT >STACK
	RSTACK
?L11:	EQUAL? PRSO,GROUND \?L13
	CALL V-DIG >STACK
	RSTACK
?L13:	FSET? PRSO,TAKEBIT /?L15
	EQUAL? PRSO,BANNER \?L14
?L15:	MOVE PRSO,LOCAL-GLOBALS
	PRINTI "With a cloud of sparks"
	EQUAL? PRSO,RIFLES \?L18
	PRINTI " the pile of "
	PRINTD RIFLES
	PRINTI "s"
	JUMP ?L22
?L18:	CALL ARTICLE,PRSO,1
?L22:	PRINTI " disintegrates. "
	PRINT CROWD-CHEERS
	CRLF
	CALL PRINT-ID,STR?232 >STACK
	RSTACK
?L14:	EQUAL? PRSO,HEART-OF-GOLD \FALSE
	PRINTI "You're too far."
	CRLF
	CALL PRINT-ID,STR?233 >STACK
	RSTACK

	.FUNCT BLASTER-HOLD
	CALL HELD?,BLASTER >STACK
	ZERO? STACK \FALSE
	PRINT NOT-HOLDING
	PRINTI " the "
	PRINTD BLASTER
	PRINTR "."

	.FUNCT RIFLES-F
	EQUAL? PRSA,V?SHOOT \?L1
	CALL BLASTER-HOLD >STACK
	ZERO? STACK \TRUE
	IN? RIFLES,GUARDS \?L6
	CALL PERFORM,V?SHOOT,GUARDS
	RTRUE
?L6:	MOVE RIFLES,LOCAL-GLOBALS
	PRINTI "The rifles explode in a flashy display of sparks and shrapnel. "
	PRINT CROWD-CHEERS
	PRINTR " The guards begin to look a bit concerned."
?L1:	EQUAL? PRSA,V?TAKE \FALSE
	FSET? RIFLES,TRYTAKEBIT \FALSE
	PRINT GUARDS-REALIZE
	PRINTI "As you begin taking the rifles, so do several of the guards. They may be dim, but they know what to do with a "
	PRINTD RIFLES
	CALL PRINT-ID,STR?234
	CALL JIGS-UP,STR?104
	RTRUE

	.FUNCT GUARD-DEATH
	CALL VISIBLE?,RIFLES >STACK
	ZERO? STACK \?L1
	PRINTI " grab the blaster and"
	JUMP ?L5
?L1:	IN? RIFLES,GUARDS /?L5
	PRINTI " pick up their rifles and"
?L5:	CALL JIGS-UP,STR?235 >STACK
	RSTACK

	.FUNCT INSIDE-WHALE-F,RARG
	EQUAL? RARG,M-ENTER \FALSE
	CALL QUEUE,I-WHALE,11 >STACK
	PUT STACK,0,1
	SET 'DREAMING,1
	RFALSE

	.FUNCT I-WHALE
	EQUAL? HERE,INSIDE-WHALE \FALSE
	CRLF
	CALL PRINT-ID,STR?236
	CALL JIGS-UP,STR?237
	RTRUE

	.FUNCT WHALE-OBJECT-F
	EQUAL? PRSA,V?DISEMBARK,V?LEAVE,V?EXIT \FALSE
	CALL V-WALK-AROUND >STACK
	RSTACK

	.INSERT "annotated_games/hitchhiker/hitchhiker_str"
	.END
