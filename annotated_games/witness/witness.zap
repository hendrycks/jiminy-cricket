	.TIME
	.INSERT "witness/witness_freq"
	.INSERT "witness/witness_data"

	.FUNCT QUEUE,RTN,TICK,CINT
	CALL INT,RTN >CINT
	PUT CINT,C-TICK,TICK
	RETURN CINT

	.FUNCT INT,RTN,DEMON=0,E,C,INT?1
	ADD C-TABLE,C-TABLELEN >E
	ADD C-TABLE,C-INTS >C
?L1:	EQUAL? C,E \?L3
	SUB C-INTS,C-INTLEN >C-INTS
	ZERO? DEMON /?L5
	SUB C-DEMONS,C-INTLEN >C-DEMONS
?L5:	ADD C-TABLE,C-INTS >INT?1
	PUT INT?1,C-RTN,RTN
	RETURN INT?1
?L3:	GET C,C-RTN >STACK
	EQUAL? STACK,RTN \?L7
	RETURN C
?L7:	ADD C,C-INTLEN >C
	JUMP ?L1

	.FUNCT CLOCKER,C,E,TICK,FLG=0,VAL
	ZERO? CLOCK-WAIT /?L1
	SET 'CLOCK-WAIT,0
	RFALSE
?L1:	IGRTR? 'PRESENT-TIME,1199 \?L4
	CALL TIMES-UP
?L4:	IGRTR? 'MOVES,59 \?L9
	SET 'MOVES,0
	IGRTR? 'SCORE,23 \?L9
	SET 'SCORE,0
?L9:	ZERO? P-WON /?L13
	PUSH C-INTS
	JUMP ?L15
?L13:	PUSH C-DEMONS
?L15:	ADD C-TABLE,STACK >C
	ADD C-TABLE,C-TABLELEN >E
?L16:	EQUAL? C,E \?L18
	RETURN FLG
?L18:	GET C,C-ENABLED? >STACK
	ZERO? STACK /?L26
	GET C,C-TICK >TICK
	ZERO? TICK /?L26
	SUB TICK,1 >STACK
	PUT C,C-TICK,STACK
	GRTR? TICK,1 /?L26
	GET C,C-RTN >STACK
	CALL STACK >VAL
	ZERO? VAL /?L26
	ZERO? FLG /?L28
	EQUAL? VAL,M-FATAL \?L26
?L28:	SET 'FLG,VAL
?L26:	ADD C,C-INTLEN >C
	JUMP ?L16

	.FUNCT PICK-ONE,FROB
	GET FROB,0 >STACK
	RANDOM STACK >STACK
	GET FROB,STACK >STACK
	RSTACK

	.FUNCT GO
START::
?L0:	PUTB P-LEXV,0,59
	SET 'LIT,1
	SET 'SCORE,20
	SET 'WINNER,PLAYER
	SET 'HERE,DRIVEWAY-ENTRANCE
	CALL THIS-IS-IT,FRONT-DOOR
	CALL THIS-IS-S-HE,PHONG
	SET 'DIFFICULTY,DIFFICULTY-MAX
	FSET? HERE,TOUCHBIT /?L1
	CALL QUEUE-MAIN-EVENTS
	CALL START-MOVEMENT
	CALL INTRO
	CALL V-VERSION
	CRLF
?L1:	MOVE PLAYER,HERE
	CALL V-LOOK
	CALL MAIN-LOOP
	JUMP ?L0

	.FUNCT MAIN-LOOP,TRASH
?L1:	CALL MAIN-LOOP-1 >TRASH
	JUMP ?L1

	.FUNCT MAIN-LOOP-1,ICNT,OCNT,NUM,CNT,OBJ,TBL,V,PTBL,OBJ1,TMP
	SET 'CNT,0
	SET 'OBJ,0
	SET 'PTBL,1
	EQUAL? QCONTEXT-ROOM,HERE /?L1
	SET 'QCONTEXT,0
?L1:	CALL PARSER >P-WON
	ZERO? P-WON /?L4
	GET P-PRSI,P-MATCHLEN >ICNT
	GET P-PRSO,P-MATCHLEN >OCNT
	ZERO? OCNT \?L6
	SET 'NUM,OCNT
	JUMP ?L13
?L6:	GRTR? OCNT,1 \?L8
	SET 'TBL,P-PRSO
	ZERO? ICNT \?L9
	SET 'OBJ,0
	JUMP ?L11
?L9:	GET P-PRSI,1 >OBJ
?L11:	SET 'NUM,OCNT
	JUMP ?L13
?L8:	GRTR? ICNT,1 \?L12
	SET 'PTBL,0
	SET 'TBL,P-PRSI
	GET P-PRSO,1 >OBJ
	SET 'NUM,ICNT
	JUMP ?L13
?L12:	SET 'NUM,1
?L13:	ZERO? OBJ \?L14
	EQUAL? ICNT,1 \?L14
	GET P-PRSI,1 >OBJ
?L14:	EQUAL? PRSA,V?WALK \?L17
	CALL PERFORM,PRSA,PRSO >V
	JUMP ?L33
?L17:	ZERO? NUM \?L19
	GETB P-SYNTAX,P-SBITS >STACK
	BAND STACK,P-SONUMS >STACK
	ZERO? STACK \?L20
	CALL PERFORM,PRSA >V
	SET 'PRSO,0
	JUMP ?L33
?L20:	PRINTI "(There isn't anything to "
	GET P-ITBL,P-VERBN >TMP
	ZERO? P-OFLAG /?L25
	GET TMP,0 >STACK
	PRINTB STACK
	JUMP ?L27
?L25:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
?L27:	PRINTI "!)"
	CRLF
	SET 'V,0
	JUMP ?L33
?L19:	ZERO? PTBL /?L30
	GRTR? NUM,1 \?L30
	EQUAL? PRSA,V?COMPARE,V?ARREST \?L30
	CALL PERFORM,PRSA,OBJECT-PAIR >V
	JUMP ?L33
?L30:	SET 'TMP,0
?L32:	IGRTR? 'CNT,NUM \?L34
	GRTR? TMP,0 \?L33
	PRINTI "The other object"
	EQUAL? TMP,1 /?L40
	PRINTI "s"
?L40:	PRINTI " that you mentioned "
	EQUAL? TMP,1 /?L47
	PRINTI "are"
	JUMP ?L51
?L47:	PRINTI "is"
?L51:	PRINTI "n't here."
	CRLF
	JUMP ?L33
?L34:	ZERO? PTBL /?L58
	GET P-PRSO,CNT >OBJ1
	JUMP ?L60
?L58:	GET P-PRSI,CNT >OBJ1
?L60:	GRTR? NUM,1 \?L66
	EQUAL? OBJ1,NOT-HERE-OBJECT \?L63
	INC 'TMP
	JUMP ?L32
?L63:	EQUAL? OBJ1,PLAYER /?L32
	EQUAL? OBJ1,IT \?L67
	PRINTD P-IT-OBJECT
	JUMP ?L69
?L67:	PRINTD OBJ1
?L69:	PRINTI ": "
?L66:	ZERO? PTBL /?L73
	PUSH OBJ1
	JUMP ?L75
?L73:	PUSH OBJ
?L75:	CALL QCONTEXT-CHECK,STACK >V
	ZERO? PTBL /?L76
	PUSH OBJ
	JUMP ?L78
?L76:	PUSH OBJ1
?L78:	ZERO? PTBL /?L79
	PUSH OBJ1
	JUMP ?L81
?L79:	PUSH OBJ
?L81:	CALL PERFORM,PRSA,STACK,STACK >V
	EQUAL? V,M-FATAL \?L32
?L33:	EQUAL? V,M-FATAL \?L88
	SET 'P-CONT,0
	JUMP ?L88
?L4:	SET 'P-CONT,0
?L88:	ZERO? P-WON /FALSE
	EQUAL? PRSA,V?VERSION,V?$0024TANDY,V?DEBUG /TRUE
	EQUAL? PRSA,V?$0024WHERE,V?RESTART,V?QUIT /TRUE
	EQUAL? PRSA,V?$0024VERIFY,V?UNSCRIPT,V?SCRIPT /TRUE
	EQUAL? PRSA,V?UNSPACE,V?SPACE,V?SAVE /TRUE
	EQUAL? PRSA,V?TIME,V?VERBOSE,V?SUPER-BRIEF /TRUE
	EQUAL? PRSA,V?BRIEF,V?TELL /TRUE
	CALL CLOCKER >V
	RETURN V

	.FUNCT QCONTEXT-CHECK,PRSO?1,OTHER,WHO=0,N=0
	EQUAL? PRSA,V?WHAT,V?HELP /?L3
	EQUAL? PRSA,V?TELL-ME,V?SHOW \FALSE
	EQUAL? PRSO?1,PLAYER \FALSE
?L3:	FIRST? HERE >OTHER \?L6
?L7:	FSET? OTHER,PERSON \?L9
	INC 'N
	SET 'WHO,OTHER
?L9:	NEXT? OTHER >OTHER /?L7
?L6:	EQUAL? 1,N \?L12
	ZERO? QCONTEXT \?L22
	CALL SAID-TO,WHO
?L12:	ZERO? QCONTEXT /FALSE
?L22:	IN? QCONTEXT,HERE \FALSE
	EQUAL? QCONTEXT-ROOM,HERE \FALSE
	EQUAL? WINNER,PLAYER \FALSE
	SET 'WINNER,QCONTEXT
	PRINTI "(said to "
	PRINTD QCONTEXT
	PRINTR ")"

	.FUNCT SAID-TO,WHO
	SET 'WINNER,WHO
	SET 'QCONTEXT,WHO
	SET 'QCONTEXT-ROOM,HERE
	RETURN QCONTEXT-ROOM

	.FUNCT FAKE-ORPHAN,TMP
	CALL ORPHAN,P-SYNTAX,0
	PRINTI "(Be specific: what object do you want to "
	GET P-OTBL,P-VERBN >TMP
	ZERO? TMP \?L3
	PRINTI "tell"
	JUMP ?L8
?L3:	GETB P-VTBL,2 >STACK
	ZERO? STACK \?L7
	GET TMP,0 >STACK
	PRINTB STACK
	JUMP ?L8
?L7:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
	PUTB P-VTBL,2,0
?L8:	SET 'P-OFLAG,1
	SET 'P-WON,0
	PRINTR "?)"

	.FUNCT PERFORM,A,O=0,I=0,V,OA,OO,OI
	ZERO? DEBUG /?L1
	PRINTI "[Perform: "
	PRINTN A
	ZERO? O /?L7
	EQUAL? A,V?WALK /?L7
	PRINTI "/"
	PRINTD O
?L7:	ZERO? I /?L12
	PRINTI "/"
	PRINTD I
?L12:	PRINTI "]"
	CRLF
?L1:	SET 'OA,PRSA
	SET 'OO,PRSO
	SET 'OI,PRSI
	SET 'PRSA,A
	EQUAL? A,V?WALK /?L31
	EQUAL? IT,I,O \?L22
	EQUAL? P-IT-LOC,HERE /?L22
	ZERO? I \?L24
	CALL FAKE-ORPHAN
	RETURN 2
?L24:	PRINTI "(The "
	PRINTD P-IT-OBJECT
	PRINTI " isn't here!)"
	CRLF
	RETURN 2
?L22:	EQUAL? HIM-HER,I,O \?L31
	CALL META-LOC,P-HIM-HER >STACK
	EQUAL? STACK,HERE /?L31
	GETP P-HIM-HER,P?CHARACTER >STACK
	GET GLOBAL-CHARACTER-TABLE,STACK >P-HIM-HER
?L31:	EQUAL? O,IT \?L34
	SET 'O,P-IT-OBJECT
	JUMP ?L36
?L34:	EQUAL? O,HIM-HER \?L36
	SET 'O,P-HIM-HER
?L36:	EQUAL? I,IT \?L38
	SET 'I,P-IT-OBJECT
	JUMP ?L40
?L38:	EQUAL? I,HIM-HER \?L40
	SET 'I,P-HIM-HER
?L40:	SET 'PRSO,O
	ZERO? PRSO /?L46
	EQUAL? PRSA,V?WALK /?L46
	FSET? PRSO,PERSON \?L44
	SET 'P-HIM-HER,PRSO
	SET 'P-HIM-HER-LOC,HERE
	JUMP ?L46
?L44:	SET 'P-IT-OBJECT,PRSO
	SET 'P-IT-LOC,HERE
?L46:	SET 'PRSI,I
	EQUAL? NOT-HERE-OBJECT,PRSO,PRSI \?L48
	CALL D-APPLY,STR?7,NOT-HERE-OBJECT-F >V
	ZERO? V \?L59
?L48:	SET 'O,PRSO
	ZERO? O /?L50
	SET 'I,PRSI
	ZERO? I /?L50
	CALL NULL-F >STACK
	ZERO? STACK /?L50
	PRINTI "[in case last clause changed PRSx]"
	JUMP ?L59
?L50:	GETP WINNER,P?ACTION >STACK
	CALL DD-APPLY,STR?8,WINNER,STACK >V
	ZERO? V \?L59
	LOC WINNER >STACK
	GETP STACK,P?ACTION >STACK
	CALL D-APPLY,STR?9,STACK,M-BEG >V
	ZERO? V \?L59
	GET PREACTIONS,A >STACK
	CALL D-APPLY,STR?10,STACK >V
	ZERO? V \?L59
	ZERO? I /?L56
	SET 'NOW-PRSI,1
	GETP I,P?ACTION >STACK
	CALL D-APPLY,STR?11,STACK >V
	ZERO? V \?L59
?L56:	SET 'NOW-PRSI,0
	ZERO? O /?L58
	EQUAL? A,V?WALK /?L57
	LOC O >STACK
	ZERO? STACK /?L57
	LOC O >STACK
	GETP STACK,P?CONTFCN >STACK
	ZERO? STACK /?L57
	LOC O >STACK
	GETP STACK,P?CONTFCN >STACK
	LOC O >STACK
	CALL DD-APPLY,STR?12,STACK,STACK >V
	ZERO? V \?L59
?L57:	ZERO? O /?L58
	EQUAL? A,V?WALK /?L58
	GETP O,P?ACTION >STACK
	CALL D-APPLY,STR?13,STACK >V
	ZERO? V \?L59
?L58:	GET ACTIONS,A >STACK
	CALL D-APPLY,0,STACK >V
	ZERO? V /?L59
?L59:	EQUAL? V,M-FATAL /?L61
	LOC WINNER >STACK
	EQUAL? STACK,PRSO \?L63
	SET 'PRSO,0
?L63:	LOC WINNER >STACK
	GETP STACK,P?ACTION >STACK
	CALL D-APPLY,STR?14,STACK,M-END >V
?L61:	SET 'PRSA,OA
	SET 'PRSO,OO
	SET 'PRSI,OI
	RETURN V

	.FUNCT DD-APPLY,STR,OBJ,FCN,FOO=0
	ZERO? DEBUG /?L1
	PRINTI "["
	PRINTD OBJ
	PRINTI "=]"
?L1:	CALL D-APPLY,STR,FCN,FOO >STACK
	RSTACK

	.FUNCT D-APPLY,STR,FCN,FOO=0,RES
	ZERO? FCN /FALSE
	ZERO? DEBUG /?L10
	ZERO? STR \?L6
	PRINTI "[Action:]"
	CRLF
	JUMP ?L10
?L6:	PRINTI "["
	PRINT STR
	PRINTI ": "
?L10:	ZERO? FOO /?L14
	CALL FCN,FOO >RES
	JUMP ?L16
?L14:	CALL FCN >RES
?L16:	ZERO? DEBUG /?L26
	ZERO? STR /?L26
	EQUAL? RES,M-FATAL \?L19
	PRINTI "Fatal]"
	CRLF
	RETURN RES
?L19:	ZERO? RES \?L23
	PRINTI "Not handled]"
	CRLF
	RETURN RES
?L23:	PRINTI "Handled]"
	CRLF
?L26:	RETURN RES

	.FUNCT THIS-IS-S-HE,PERSON?1
	SET 'P-HIM-HER,PERSON?1
	LOC PERSON?1 >P-HIM-HER-LOC
	RETURN P-HIM-HER-LOC

	.FUNCT I-PROMPT-1
	SET 'P-PROMPT,STR?15
	RFALSE

	.FUNCT I-PROMPT-2
	ZERO? P-PROMPT /FALSE
	SET 'P-PROMPT,0
	CRLF
	PRINTI "(Aren't you getting tired of seeing "
	ZERO? X-IS-LISTENING /?L5
	PRINTI """(... is listening.)"" and "
?L5:	PRINTI """What next?"" and ""You are now in the ....""? From here on, the prompt will be much shorter.)"
	CRLF
	EQUAL? PRSA,V?WAIT-UNTIL,V?WAIT-FOR,V?WAIT \?L12
	CRLF
?L12:	CALL INT,I-PROMPT-2 >STACK
	PUT STACK,0,0
	RFALSE

	.FUNCT PARSER,PTR=P-LEXSTART,WRD,VAL=0,VERB=0,OF-FLAG=0,LEN,DIR=0,NW=0,LW=0,NUM,SCNT,CNT=-1
?L1:	IGRTR? 'CNT,P-ITBLLEN /?L2
	PUT P-ITBL,CNT,0
	JUMP ?L1
?L2:	SET 'P-NAM,0
	SET 'P-ADJ,0
	SET 'P-ADVERB,0
	SET 'P-MERGED,0
	PUT P-PRSO,P-MATCHLEN,0
	PUT P-PRSI,P-MATCHLEN,0
	PUT P-BUTS,P-MATCHLEN,0
	ZERO? QUOTE-FLAG \?L8
	EQUAL? WINNER,PLAYER /?L8
	SET 'WINNER,PLAYER
	LOC WINNER >STACK
	FSET? STACK,VEHBIT /?L8
	LOC WINNER >HERE
?L8:	ZERO? P-CONT /?L12
	SET 'PTR,P-CONT
	SET 'P-CONT,0
	EQUAL? PRSA,V?TELL /?L17
	CRLF
	JUMP ?L17
?L12:	SET 'WINNER,PLAYER
	SET 'QUOTE-FLAG,0
	LOC WINNER >STACK
	FSET? STACK,VEHBIT /?L18
	LOC WINNER >HERE
?L18:	SET 'SCNT,P-SPACE
?L21:	DLESS? 'SCNT,0 /?L22
	CRLF
	JUMP ?L21
?L22:	ZERO? P-PROMPT /?L26
	ZERO? P-OFLAG \?L26
	ZERO? QCONTEXT /?L28
	SET 'X-IS-LISTENING,1
	PRINTI "("
	PRINTD QCONTEXT
	PRINTI " is listening.)"
	CRLF
?L28:	PRINT P-PROMPT
	CRLF
?L26:	PRINTI ">"
	READ P-INBUF,P-LEXV
?L17:	GETB P-LEXV,P-LEXWORDS >P-LEN
	ZERO? P-LEN \?L38
	PRINTI "What?"
	CRLF
	RFALSE
?L38:	GET P-LEXV,PTR >WRD
	EQUAL? WRD,W?WHY,W?HOW,W?WHEN /?L43
	EQUAL? WRD,W?IS,W?DID,W?ARE \?L42
?L43:	PRINTI "(Sorry, but this program can't handle questions like that. You should stick to questions like ""WHAT IS ..."" and ""WHERE IS ...."" Maybe you'd like to review your instruction manual.)"
	CRLF
	RFALSE
?L42:	SET 'LEN,P-LEN
	SET 'P-DIR,0
	SET 'P-NCN,0
	SET 'P-GETFLAGS,0
	PUT P-ITBL,P-VERBN,0
?L47:	DLESS? 'P-LEN,0 \?L49
	SET 'QUOTE-FLAG,0
	JUMP ?L48
?L49:	GET P-LEXV,PTR >WRD
	ZERO? WRD \?L52
	CALL NUMBER?,PTR >WRD
	ZERO? WRD /?L51
?L52:	EQUAL? WRD,W?TO \?L53
	EQUAL? VERB,ACT?TELL,ACT?ASK \?L53
	SET 'WRD,W?$QUOTE
	JUMP ?L55
?L53:	EQUAL? WRD,W?THEN \?L55
	ZERO? VERB \?L55
	PUT P-ITBL,P-VERB,ACT?TELL
	PUT P-ITBL,P-VERBN,0
	SET 'WRD,W?$QUOTE
?L55:	EQUAL? WRD,W?$PERIOD \?L57
	EQUAL? LW,W?MRS,W?MR \?L57
	SET 'LW,0
	JUMP ?L112
?L57:	EQUAL? WRD,W?THEN,W?$PERIOD /?L60
	EQUAL? WRD,W?$QUOTE \?L59
?L60:	EQUAL? WRD,W?$QUOTE \?L65
	ZERO? QUOTE-FLAG /?L63
	SET 'QUOTE-FLAG,0
	JUMP ?L65
?L63:	SET 'QUOTE-FLAG,1
?L65:	ZERO? P-LEN /?L67
	ADD PTR,P-LEXELEN >P-CONT
?L67:	PUTB P-LEXV,P-LEXWORDS,P-LEN
	JUMP ?L48
?L59:	CALL WT?,WRD,PS?DIRECTION,P1?DIRECTION >VAL
	ZERO? VAL /?L69
	EQUAL? LEN,1 /?L70
	EQUAL? LEN,2 \?L71
	EQUAL? VERB,ACT?WALK /?L70
?L71:	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >NW
	EQUAL? NW,W?THEN,W?$QUOTE \?L72
	GRTR? LEN,2 /?L70
?L72:	EQUAL? NW,W?$PERIOD \?L73
	GRTR? LEN,1 /?L70
?L73:	ZERO? QUOTE-FLAG /?L74
	EQUAL? LEN,2 \?L74
	EQUAL? NW,W?$QUOTE /?L70
?L74:	GRTR? LEN,2 \?L69
	EQUAL? NW,W?$COMMA,W?AND \?L69
?L70:	SET 'DIR,VAL
	EQUAL? NW,W?$COMMA,W?AND \?L75
	ADD PTR,P-LEXELEN >STACK
	PUT P-LEXV,STACK,W?THEN
?L75:	GRTR? LEN,2 /?L112
	SET 'QUOTE-FLAG,0
	JUMP ?L48
?L69:	CALL WT?,WRD,PS?VERB,P1?VERB >VAL
	ZERO? VAL /?L81
	ZERO? VERB /?L82
	EQUAL? VERB,ACT?WHAT \?L81
?L82:	SET 'VERB,VAL
	PUT P-ITBL,P-VERB,VAL
	PUT P-ITBL,P-VERBN,P-VTBL
	PUT P-VTBL,0,WRD
	MUL PTR,2 >STACK
	ADD STACK,2 >NUM
	GETB P-LEXV,NUM >STACK
	PUTB P-VTBL,2,STACK
	ADD NUM,1 >STACK
	GETB P-LEXV,STACK >STACK
	PUTB P-VTBL,3,STACK
	JUMP ?L112
?L81:	CALL WT?,WRD,PS?PREPOSITION,0 >VAL
	ZERO? VAL \?L85
	EQUAL? WRD,W?ONE,W?A /?L85
	CALL WT?,WRD,PS?ADJECTIVE >STACK
	ZERO? STACK \?L85
	CALL WT?,WRD,PS?OBJECT >STACK
	ZERO? STACK /?L83
?L85:	GRTR? P-LEN,1 \?L86
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?OF \?L86
	EQUAL? VERB,ACT?ACCUSE,ACT?MAKE /?L86
	ZERO? VAL \?L125
	EQUAL? WRD,W?ONE,W?A /?L86
	SET 'OF-FLAG,1
	JUMP ?L112
?L86:	ZERO? VAL /?L88
?L125:	ZERO? P-LEN /?L89
	ADD PTR,2 >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?THEN,W?$PERIOD \?L88
?L89:	LESS? P-NCN,2 \?L112
	PUT P-ITBL,P-PREP1,VAL
	PUT P-ITBL,P-PREP1N,WRD
	JUMP ?L112
?L88:	EQUAL? P-NCN,2 \?L93
	PRINTI "(I found more than two nouns in that sentence!)"
	CRLF
	RFALSE
?L93:	INC 'P-NCN
	CALL CLAUSE,PTR,VAL,WRD >PTR
	ZERO? PTR /FALSE
	LESS? PTR,0 \?L112
	SET 'QUOTE-FLAG,0
	JUMP ?L48
?L83:	EQUAL? WRD,W?CLOSELY \?L102
	SET 'P-ADVERB,W?CAREFULLY
	JUMP ?L112
?L102:	EQUAL? WRD,W?CAREFULLY,W?QUIETLY /?L104
	EQUAL? WRD,W?SLOWLY,W?QUICKLY,W?BRIEFLY \?L103
?L104:	SET 'P-ADVERB,WRD
	JUMP ?L112
?L103:	EQUAL? WRD,W?OF \?L105
	ZERO? OF-FLAG /?L108
	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >STACK
	EQUAL? STACK,W?$PERIOD,W?THEN \?L106
?L108:	CALL CANT-USE,PTR
	RFALSE
?L106:	SET 'OF-FLAG,0
	JUMP ?L112
?L105:	CALL WT?,WRD,PS?BUZZ-WORD >STACK
	ZERO? STACK \?L112
	CALL CANT-USE,PTR
	RFALSE
?L51:	CALL UNKNOWN-WORD,PTR
	RFALSE
?L112:	SET 'LW,WRD
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L47
?L48:	ZERO? DIR /?L113
	SET 'PRSA,V?WALK
	SET 'PRSO,DIR
	RTRUE
?L113:	ZERO? P-OFLAG /?L116
	CALL ORPHAN-MERGE
?L116:	GET P-ITBL,P-VERB >STACK
	ZERO? STACK \?L119
	PUT P-ITBL,P-VERB,ACT?$0024CALL
?L119:	CALL SYNTAX-CHECK >STACK
	ZERO? STACK /FALSE
	CALL SNARF-OBJECTS >STACK
	ZERO? STACK /FALSE
	CALL TAKE-CHECK >STACK
	ZERO? STACK /FALSE
	CALL MANY-CHECK >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT WT?,PTR,BIT,B1=5,OFFSET=P-P1OFF,TYP
	GETB PTR,P-PSOFF >TYP
	BTST TYP,BIT \FALSE
	GRTR? B1,4 /TRUE
	BAND TYP,P-P1BITS >TYP
	EQUAL? TYP,B1 /?L6
	INC 'OFFSET
?L6:	GETB PTR,OFFSET >STACK
	RSTACK

	.FUNCT CLAUSE,PTR,VAL,WRD,OFF,NUM,ANDFLG=0,FIRST??=1,NW,LW=0
	SUB P-NCN,1 >STACK
	MUL STACK,2 >OFF
	ZERO? VAL /?L1
	ADD P-PREP1,OFF >NUM
	PUT P-ITBL,NUM,VAL
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,WRD
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L3
?L1:	INC 'P-LEN
?L3:	ZERO? P-LEN \?L4
	DEC 'P-NCN
	RETURN -1
?L4:	ADD P-NC1,OFF >NUM
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	PUT P-ITBL,NUM,STACK
	GET P-LEXV,PTR >STACK
	EQUAL? STACK,W?THE,W?A,W?AN \?L7
	GET P-ITBL,NUM >STACK
	ADD STACK,4 >STACK
	PUT P-ITBL,NUM,STACK
?L7:	DLESS? 'P-LEN,0 \?L12
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,STACK
	RETURN -1
?L12:	GET P-LEXV,PTR >WRD
	ZERO? WRD \?L17
	CALL NUMBER?,PTR >WRD
	ZERO? WRD /?L15
?L17:	ZERO? P-LEN \?L18
	SET 'NW,0
	JUMP ?L20
?L18:	ADD PTR,P-LEXELEN >STACK
	GET P-LEXV,STACK >NW
?L20:	EQUAL? WRD,W?OF \?L21
	GET P-ITBL,P-VERB >STACK
	EQUAL? STACK,ACT?ACCUSE,ACT?MAKE \?L21
	PUT P-LEXV,PTR,W?WITH
	SET 'WRD,W?WITH
?L21:	EQUAL? WRD,W?$PERIOD \?L24
	EQUAL? LW,W?MRS,W?MR \?L24
	SET 'LW,0
	JUMP ?L44
?L24:	EQUAL? WRD,W?AND,W?$COMMA \?L26
	SET 'ANDFLG,1
	JUMP ?L44
?L26:	EQUAL? WRD,W?ONE \?L27
	EQUAL? NW,W?OF \?L44
	DEC 'P-LEN
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L44
?L27:	EQUAL? WRD,W?THEN,W?$PERIOD /?L32
	CALL WT?,WRD,PS?PREPOSITION >STACK
	ZERO? STACK /?L31
	ZERO? FIRST?? \?L31
?L32:	INC 'P-LEN
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,STACK
	SUB PTR,P-LEXELEN >STACK
	RSTACK
?L31:	ZERO? ANDFLG /?L33
	GET P-ITBL,P-VERBN >STACK
	ZERO? STACK /?L34
	CALL WT?,WRD,PS?DIRECTION >STACK
	ZERO? STACK \?L34
	CALL WT?,WRD,PS?VERB >STACK
	ZERO? STACK /?L33
?L34:	SUB PTR,4 >PTR
	ADD PTR,2 >STACK
	PUT P-LEXV,STACK,W?THEN
	ADD P-LEN,2 >P-LEN
	JUMP ?L44
?L33:	CALL WT?,WRD,PS?OBJECT >STACK
	ZERO? STACK /?L35
	CALL WT?,WRD,PS?ADJECTIVE,P1?ADJECTIVE >STACK
	ZERO? STACK /?L36
	ZERO? NW /?L36
	CALL WT?,NW,PS?OBJECT >STACK
	ZERO? STACK \?L44
?L36:	ZERO? ANDFLG \?L38
	EQUAL? NW,W?BUT,W?EXCEPT,W?AND /?L38
	EQUAL? NW,W?$COMMA /?L38
	ADD PTR,2 >STACK
	MUL STACK,2 >STACK
	ADD P-LEXV,STACK >STACK
	ADD NUM,1 >STACK
	PUT P-ITBL,STACK,STACK
	RETURN PTR
?L38:	SET 'ANDFLG,0
	JUMP ?L44
?L35:	CALL WT?,WRD,PS?ADJECTIVE >STACK
	ZERO? STACK \?L44
	CALL WT?,WRD,PS?BUZZ-WORD >STACK
	ZERO? STACK \?L44
	CALL WT?,WRD,PS?PREPOSITION >STACK
	ZERO? STACK \?L44
	CALL CANT-USE,PTR
	RFALSE
?L15:	CALL UNKNOWN-WORD,PTR
	RFALSE
?L44:	SET 'LW,WRD
	SET 'FIRST??,0
	ADD PTR,P-LEXELEN >PTR
	JUMP ?L7

	.FUNCT NUMBER?,PTR,CNT,BPTR,CHR,SUM=0,TIM=0
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	GETB STACK,2 >CNT
	MUL PTR,2 >STACK
	ADD P-LEXV,STACK >STACK
	GETB STACK,3 >BPTR
?L1:	DLESS? 'CNT,0 /?L2
	GETB P-INBUF,BPTR >CHR
	EQUAL? CHR,58 \?L6
	SET 'TIM,SUM
	SET 'SUM,0
	JUMP ?L10
?L6:	GRTR? SUM,9999 /FALSE
	LESS? CHR,58 \FALSE
	GRTR? CHR,47 \FALSE
	SUB CHR,48 >STACK
	MUL SUM,10 >STACK
	ADD STACK,STACK >SUM
?L10:	INC 'BPTR
	JUMP ?L1
?L2:	PUT P-LEXV,PTR,W?INTNUM
	GRTR? SUM,9999 /FALSE
	ZERO? TIM /?L13
	GRTR? TIM,23 /FALSE
	GRTR? TIM,19 /?L19
	GRTR? TIM,12 /FALSE
	GRTR? TIM,7 /?L19
	ADD 12,TIM >TIM
?L19:	MUL TIM,60 >STACK
	ADD SUM,STACK >SUM
?L13:	SET 'P-NUMBER,SUM
	RETURN W?INTNUM

	.FUNCT ORPHAN-MERGE,CNT=-1,TEMP,VERB,BEG,END,ADJ=0,WRD
	SET 'P-OFLAG,0
	GET P-ITBL,P-VERB >VERB
	ZERO? VERB /?L1
	GET P-OTBL,P-VERB >STACK
	EQUAL? VERB,STACK \FALSE
?L1:	EQUAL? P-NCN,2 /FALSE
	GET P-OTBL,P-NC1 >STACK
	EQUAL? STACK,1 \?L4
	GET P-ITBL,P-PREP1 >TEMP
	GET P-OTBL,P-PREP1 >STACK
	EQUAL? TEMP,STACK /?L7
	ZERO? TEMP \FALSE
?L7:	ZERO? ADJ /?L8
	ADD P-LEXV,2 >STACK
	PUT P-OTBL,P-NC1,STACK
	ADD P-LEXV,6 >STACK
	PUT P-OTBL,P-NC1L,STACK
	JUMP ?L22
?L8:	GET P-ITBL,P-NC1 >STACK
	PUT P-OTBL,P-NC1,STACK
	GET P-ITBL,P-NC1L >STACK
	PUT P-OTBL,P-NC1L,STACK
	JUMP ?L22
?L4:	GET P-OTBL,P-NC2 >STACK
	EQUAL? STACK,1 \?L12
	GET P-ITBL,P-PREP1 >TEMP
	GET P-OTBL,P-PREP2 >STACK
	EQUAL? TEMP,STACK /?L15
	ZERO? TEMP \FALSE
?L15:	GET P-ITBL,P-NC1 >STACK
	PUT P-OTBL,P-NC2,STACK
	GET P-ITBL,P-NC1L >STACK
	PUT P-OTBL,P-NC2L,STACK
	SET 'P-NCN,2
	JUMP ?L22
?L12:	ZERO? P-ACLAUSE /?L22
	EQUAL? P-NCN,1 /?L18
	SET 'P-ACLAUSE,0
	RFALSE
?L18:	GET P-ITBL,P-NC1 >BEG
	GET P-ITBL,P-NC1L >END
?L21:	EQUAL? BEG,END \?L23
	ZERO? ADJ /?L25
	CALL ACLAUSE-WIN,ADJ
	JUMP ?L22
?L25:	SET 'P-ACLAUSE,0
	RFALSE
?L23:	ZERO? ADJ \?L28
	GET BEG,0 >WRD
	GETB WRD,P-PSOFF >STACK
	BTST STACK,PS?ADJECTIVE \?L28
	SET 'ADJ,WRD
	JUMP ?L33
?L28:	GETB WRD,P-PSOFF >STACK
	BTST STACK,PS?OBJECT /?L30
	EQUAL? WRD,W?ONE \?L33
?L30:	EQUAL? WRD,P-ANAM,W?ONE \FALSE
	CALL ACLAUSE-WIN,ADJ
	JUMP ?L22
?L33:	ADD BEG,P-WORDLEN >BEG
	JUMP ?L21
?L22:	IGRTR? 'CNT,P-ITBLLEN \?L38
	SET 'P-MERGED,1
	RTRUE
?L38:	GET P-OTBL,CNT >STACK
	PUT P-ITBL,CNT,STACK
	JUMP ?L22

	.FUNCT ACLAUSE-WIN,ADJ
	SET 'P-CCSRC,P-OTBL
	ADD P-ACLAUSE,1 >STACK
	CALL CLAUSE-COPY,P-ACLAUSE,STACK,ADJ
	GET P-OTBL,P-NC2 >STACK
	ZERO? STACK /?L1
	SET 'P-NCN,2
?L1:	SET 'P-ACLAUSE,0
	RTRUE

	.FUNCT WORD-PRINT,CNT,BUF
?L1:	DLESS? 'CNT,0 /TRUE
	GETB P-INBUF,BUF >STACK
	PRINTC STACK
	INC 'BUF
	JUMP ?L1

	.FUNCT UNKNOWN-WORD,PTR,BUF,MSG,?TMP
	CALL PICK-ONE,UNKNOWN-MSGS >MSG
	GET MSG,0 >STACK
	PRINT STACK
	MUL PTR,2 >BUF
	ADD P-LEXV,BUF >STACK
	GETB STACK,2 >?TMP
	ADD P-LEXV,BUF >STACK
	GETB STACK,3 >STACK
	CALL WORD-PRINT,?TMP,STACK
	GET MSG,1 >STACK
	PRINT STACK
	CRLF
	SET 'QUOTE-FLAG,0
	SET 'P-OFLAG,0
	RETURN P-OFLAG

	.FUNCT CANT-USE,PTR,BUF,?TMP
	PRINTI "(Sorry, but you can't use the word """
	MUL PTR,2 >BUF
	ADD P-LEXV,BUF >STACK
	GETB STACK,2 >?TMP
	ADD P-LEXV,BUF >STACK
	GETB STACK,3 >STACK
	CALL WORD-PRINT,?TMP,STACK
	PRINTI """ in that sense.)"
	CRLF
	SET 'QUOTE-FLAG,0
	SET 'P-OFLAG,0
	RETURN P-OFLAG

	.FUNCT SYNTAX-CHECK,SYN,LEN,NUM,OBJ,DRIVE1=0,DRIVE2=0,PREP,VERB
	GET P-ITBL,P-VERB >VERB
	ZERO? VERB \?L1
	PRINTI "(I couldn't find a verb in that sentence!)"
	CRLF
	RFALSE
?L1:	SUB 255,VERB >STACK
	GET VERBS,STACK >SYN
	GETB SYN,0 >LEN
	INC 'SYN
?L6:	GETB SYN,P-SBITS >STACK
	BAND STACK,P-SONUMS >NUM
	GRTR? P-NCN,NUM /?L15
	LESS? NUM,1 /?L10
	ZERO? P-NCN \?L10
	GET P-ITBL,P-PREP1 >PREP
	ZERO? PREP /?L11
	GETB SYN,P-SPREP1 >STACK
	EQUAL? PREP,STACK \?L10
?L11:	SET 'DRIVE1,SYN
	JUMP ?L15
?L10:	GET P-ITBL,P-PREP1 >STACK
	GETB SYN,P-SPREP1 >STACK
	EQUAL? STACK,STACK \?L15
	EQUAL? NUM,2 \?L13
	EQUAL? P-NCN,1 \?L13
	SET 'DRIVE2,SYN
	JUMP ?L15
?L13:	GET P-ITBL,P-PREP2 >STACK
	GETB SYN,P-SPREP2 >STACK
	EQUAL? STACK,STACK \?L15
	CALL SYNTAX-FOUND,SYN
	RTRUE
?L15:	DLESS? 'LEN,1 \?L18
	ZERO? DRIVE1 \?L54
	ZERO? DRIVE2 \?L7
	PRINTI "(Sorry, but English is my second language. Please rephrase that.)"
	CRLF
	RFALSE
?L18:	ADD SYN,P-SYNLEN >SYN
	JUMP ?L6
?L7:	ZERO? DRIVE1 /?L27
?L54:	GETB DRIVE1,P-SPREP1 >STACK
	GETB DRIVE1,P-SLOC1 >STACK
	GETB DRIVE1,P-SFWIM1 >STACK
	CALL GWIM,STACK,STACK,STACK >OBJ
	ZERO? OBJ /?L27
	PUT P-PRSO,P-MATCHLEN,1
	PUT P-PRSO,1,OBJ
	CALL SYNTAX-FOUND,DRIVE1 >STACK
	RSTACK
?L27:	ZERO? DRIVE2 /?L29
	GETB DRIVE2,P-SPREP2 >STACK
	GETB DRIVE2,P-SLOC2 >STACK
	GETB DRIVE2,P-SFWIM2 >STACK
	CALL GWIM,STACK,STACK,STACK >OBJ
	ZERO? OBJ /?L29
	PUT P-PRSI,P-MATCHLEN,1
	PUT P-PRSI,1,OBJ
	CALL SYNTAX-FOUND,DRIVE2 >STACK
	RSTACK
?L29:	EQUAL? VERB,ACT?FIND,ACT?WHAT \?L30
	PRINTI "(Sorry, but I can't answer that question.)"
	CRLF
	RFALSE
?L30:	EQUAL? WINNER,PLAYER \?L34
	CALL ORPHAN,DRIVE1,DRIVE2
	PRINTI "(What do you want to "
	JUMP ?L38
?L34:	PRINTI "(Your request was incomplete. Next time, say what you want "
	PRINTD WINNER
	PRINTI " to "
?L38:	CALL VERB-PRINT
	ZERO? DRIVE2 /?L41
	CALL CLAUSE-PRINT,P-NC1,P-NC1L
?L41:	ZERO? DRIVE1 /?L44
	GETB DRIVE1,P-SPREP1 >STACK
	JUMP ?L46
?L44:	GETB DRIVE2,P-SPREP2 >STACK
?L46:	CALL PREP-PRINT,STACK
	EQUAL? WINNER,PLAYER \?L47
	SET 'P-OFLAG,1
	PRINTI "?)"
	CRLF
	RFALSE
?L47:	SET 'P-OFLAG,0
	PRINTI ".)"
	CRLF
	RFALSE

	.FUNCT VERB-PRINT,TMP
	GET P-ITBL,P-VERBN >TMP
	ZERO? TMP \?L1
	PRINTI "tell"
	RTRUE
?L1:	GETB P-VTBL,2 >STACK
	ZERO? STACK \?L5
	GET TMP,0 >STACK
	PRINTB STACK
	RTRUE
?L5:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
	PUTB P-VTBL,2,0
	RTRUE

	.FUNCT ORPHAN,D1,D2,CNT=-1
	PUT P-OCLAUSE,P-MATCHLEN,0
	SET 'P-CCSRC,P-ITBL
?L1:	IGRTR? 'CNT,P-ITBLLEN /?L2
	GET P-ITBL,CNT >STACK
	PUT P-OTBL,CNT,STACK
	JUMP ?L1
?L2:	EQUAL? P-NCN,2 \?L6
	CALL CLAUSE-COPY,P-NC2,P-NC2L
?L6:	LESS? P-NCN,1 /?L9
	CALL CLAUSE-COPY,P-NC1,P-NC1L
?L9:	ZERO? D1 /?L12
	GETB D1,P-SPREP1 >STACK
	PUT P-OTBL,P-PREP1,STACK
	PUT P-OTBL,P-NC1,1
	RTRUE
?L12:	ZERO? D2 /FALSE
	GETB D2,P-SPREP2 >STACK
	PUT P-OTBL,P-PREP2,STACK
	PUT P-OTBL,P-NC2,1
	RTRUE

	.FUNCT CLAUSE-PRINT,BPTR,EPTR,THE??1=1
	GET P-ITBL,EPTR >STACK
	GET P-ITBL,BPTR >STACK
	CALL BUFFER-PRINT,STACK,STACK,THE??1 >STACK
	RSTACK

	.FUNCT BUFFER-PRINT,BEG,END,CP,NOSP=0,WRD,FIRST??=1,PN=0
?L1:	EQUAL? BEG,END /TRUE
	ZERO? NOSP /?L6
	SET 'NOSP,0
	JUMP ?L8
?L6:	PRINTI " "
?L8:	GET BEG,0 >WRD
	EQUAL? WRD,W?$PERIOD \?L11
	SET 'NOSP,1
	JUMP ?L21
?L11:	EQUAL? WRD,W?MRS \?L13
	PRINTI "Mrs."
	SET 'PN,1
	JUMP ?L21
?L13:	EQUAL? WRD,W?MR \?L16
	PRINTI "Mr."
	SET 'PN,1
	JUMP ?L21
?L16:	EQUAL? WRD,W?LINDER,W?MONICA,W?PHONG /?L20
	EQUAL? WRD,W?STILES,W?DUFFY \?L19
?L20:	CALL CAPITALIZE,BEG
	SET 'PN,1
	JUMP ?L21
?L19:	ZERO? FIRST?? /?L22
	ZERO? PN \?L22
	ZERO? CP /?L22
	PRINTI "the "
?L22:	ZERO? P-OFLAG \?L29
	ZERO? P-MERGED /?L27
?L29:	PRINTB WRD
	JUMP ?L32
?L27:	EQUAL? WRD,W?IT \?L30
	EQUAL? P-IT-LOC,HERE \?L30
	PRINTD P-IT-OBJECT
	JUMP ?L32
?L30:	EQUAL? WRD,W?HIM,W?HER \?L31
	EQUAL? P-HIM-HER-LOC,HERE \?L31
	PRINTD P-HIM-HER
	JUMP ?L32
?L31:	GETB BEG,3 >STACK
	GETB BEG,2 >STACK
	CALL WORD-PRINT,STACK,STACK
?L32:	SET 'FIRST??,0
?L21:	ADD BEG,P-WORDLEN >BEG
	JUMP ?L1

	.FUNCT CAPITALIZE,PTR
	GETB PTR,3 >STACK
	GETB P-INBUF,STACK >STACK
	SUB STACK,32 >STACK
	PRINTC STACK
	GETB PTR,3 >STACK
	INC 'STACK
	GETB PTR,2 >STACK
	DEC 'STACK
	CALL WORD-PRINT,STACK,STACK >STACK
	RSTACK

	.FUNCT PREP-PRINT,PREP,WRD
	ZERO? PREP /FALSE
	PRINTI " "
	CALL PREP-FIND,PREP >WRD
	EQUAL? WRD,W?AGAINST \?L5
	PRINTI "against"
	JUMP ?L9
?L5:	PRINTB WRD
?L9:	GET P-ITBL,P-VERBN >STACK
	GET STACK,0 >STACK
	EQUAL? W?SIT,STACK \FALSE
	EQUAL? W?DOWN,WRD \FALSE
	PRINTI " on"
	RTRUE

	.FUNCT CLAUSE-COPY,BPTR,EPTR,INSERT=0,BEG,END
	GET P-CCSRC,BPTR >BEG
	GET P-CCSRC,EPTR >END
	GET P-OCLAUSE,P-MATCHLEN >STACK
	MUL STACK,P-LEXELEN >STACK
	ADD STACK,2 >STACK
	ADD P-OCLAUSE,STACK >STACK
	PUT P-OTBL,BPTR,STACK
?L1:	EQUAL? BEG,END \?L3
	GET P-OCLAUSE,P-MATCHLEN >STACK
	MUL STACK,P-LEXELEN >STACK
	ADD STACK,2 >STACK
	ADD P-OCLAUSE,STACK >STACK
	PUT P-OTBL,EPTR,STACK
	RTRUE
?L3:	ZERO? INSERT /?L6
	GET BEG,0 >STACK
	EQUAL? P-ANAM,STACK \?L6
	CALL CLAUSE-ADD,INSERT
?L6:	GET BEG,0 >STACK
	CALL CLAUSE-ADD,STACK
	ADD BEG,P-WORDLEN >BEG
	JUMP ?L1

	.FUNCT CLAUSE-ADD,WRD,PTR
	GET P-OCLAUSE,P-MATCHLEN >STACK
	ADD STACK,2 >PTR
	SUB PTR,1 >STACK
	PUT P-OCLAUSE,STACK,WRD
	PUT P-OCLAUSE,PTR,0
	PUT P-OCLAUSE,P-MATCHLEN,PTR
	RTRUE

	.FUNCT PREP-FIND,PREP,CNT=0,SIZE
	GET PREPOSITIONS,0 >STACK
	MUL STACK,2 >SIZE
?L1:	IGRTR? 'CNT,SIZE /FALSE
	GET PREPOSITIONS,CNT >STACK
	EQUAL? STACK,PREP \?L1
	SUB CNT,1 >STACK
	GET PREPOSITIONS,STACK >STACK
	RSTACK

	.FUNCT SYNTAX-FOUND,SYN
	SET 'P-SYNTAX,SYN
	GETB SYN,P-SACTION >PRSA
	RETURN PRSA

	.FUNCT GWIM,GBIT,LBIT,PREP,OBJ
	EQUAL? GBIT,RMUNGBIT \?L1
	RETURN ROOMS
?L1:	SET 'P-GWIMBIT,GBIT
	SET 'P-SLOCBITS,LBIT
	PUT P-MERGE,P-MATCHLEN,0
	CALL GET-OBJECT,P-MERGE,0 >STACK
	ZERO? STACK /?L4
	SET 'P-GWIMBIT,0
	GET P-MERGE,P-MATCHLEN >STACK
	EQUAL? STACK,1 \FALSE
	GET P-MERGE,1 >OBJ
	PRINTI "("
	ZERO? PREP /?L10
	CALL PREP-FIND,PREP >STACK
	PRINTB STACK
	CALL THE?,OBJ
	PRINTI " "
?L10:	FSET? OBJ,PERSON \?L15
	FSET? OBJ,TOUCHBIT /?L15
	GETP OBJ,P?XDESC >STACK
	ZERO? STACK /?L15
	PRINTI "the "
	GETP OBJ,P?XDESC >STACK
	PRINT STACK
	PRINTI ")"
	CRLF
	RETURN OBJ
?L15:	PRINTD OBJ
	PRINTI ")"
	CRLF
	RETURN OBJ
?L4:	SET 'P-GWIMBIT,0
	RFALSE

	.FUNCT SNARF-OBJECTS,PTR
	GET P-ITBL,P-NC1 >PTR
	ZERO? PTR /?L5
	GETB P-SYNTAX,P-SLOC1 >P-SLOCBITS
	GET P-ITBL,P-NC1L >STACK
	CALL SNARFEM,PTR,STACK,P-PRSO >STACK
	ZERO? STACK /FALSE
	GET P-BUTS,P-MATCHLEN >STACK
	ZERO? STACK /?L5
	CALL BUT-MERGE,P-PRSO >P-PRSO
?L5:	GET P-ITBL,P-NC2 >PTR
	ZERO? PTR /TRUE
	GETB P-SYNTAX,P-SLOC2 >P-SLOCBITS
	GET P-ITBL,P-NC2L >STACK
	CALL SNARFEM,PTR,STACK,P-PRSI >STACK
	ZERO? STACK /FALSE
	GET P-BUTS,P-MATCHLEN >STACK
	ZERO? STACK /TRUE
	GET P-PRSI,P-MATCHLEN >STACK
	EQUAL? STACK,1 \?L14
	CALL BUT-MERGE,P-PRSO >P-PRSO
	RTRUE
?L14:	CALL BUT-MERGE,P-PRSI >P-PRSI
	RTRUE

	.FUNCT BUT-MERGE,TBL,LEN,BUTLEN,CNT=1,MATCHES=0,OBJ,NTBL
	GET TBL,P-MATCHLEN >LEN
	PUT P-MERGE,P-MATCHLEN,0
?L1:	DLESS? 'LEN,0 /?L2
	GET TBL,CNT >OBJ
	CALL ZMEMQ,OBJ,P-BUTS >STACK
	ZERO? STACK \?L6
	ADD MATCHES,1 >STACK
	PUT P-MERGE,STACK,OBJ
	INC 'MATCHES
?L6:	INC 'CNT
	JUMP ?L1
?L2:	PUT P-MERGE,P-MATCHLEN,MATCHES
	SET 'NTBL,P-MERGE
	SET 'P-MERGE,TBL
	RETURN NTBL

	.FUNCT SNARFEM,PTR,EPTR,TBL,AND=0,BUT=0,LEN,WV,WRD,NW
	SET 'P-GETFLAGS,0
	SET 'P-CSPTR,PTR
	SET 'P-CEPTR,EPTR
	PUT P-BUTS,P-MATCHLEN,0
	PUT TBL,P-MATCHLEN,0
	GET PTR,0 >WRD
?L1:	EQUAL? PTR,EPTR \?L3
?L44:	ZERO? BUT /?L6
	PUSH BUT
	JUMP ?L5
?L6:	PUSH TBL
?L5:	CALL GET-OBJECT,STACK >STACK
	RSTACK
?L3:	GET PTR,P-LEXELEN >NW
	EQUAL? WRD,W?BUT,W?EXCEPT \?L8
	ZERO? BUT /?L13
	PUSH BUT
	JUMP ?L12
?L13:	PUSH TBL
?L12:	CALL GET-OBJECT,STACK >STACK
	ZERO? STACK /FALSE
	SET 'BUT,P-BUTS
	PUT BUT,P-MATCHLEN,0
	JUMP ?L39
?L8:	EQUAL? WRD,W?A,W?ONE \?L14
	ZERO? P-ADJ \?L15
	SET 'P-GETFLAGS,P-ONE
	EQUAL? NW,W?OF \?L39
	ADD PTR,P-WORDLEN >PTR
	JUMP ?L39
?L15:	SET 'P-NAM,P-ONEOBJ
	ZERO? BUT /?L24
	PUSH BUT
	JUMP ?L23
?L24:	PUSH TBL
?L23:	CALL GET-OBJECT,STACK >STACK
	ZERO? STACK /FALSE
	ZERO? NW /TRUE
	JUMP ?L39
?L14:	EQUAL? WRD,W?AND,W?$COMMA \?L27
	EQUAL? NW,W?AND,W?$COMMA /?L27
	ZERO? BUT /?L31
	PUSH BUT
	JUMP ?L30
?L31:	PUSH TBL
?L30:	CALL GET-OBJECT,STACK >STACK
	ZERO? STACK /FALSE
	JUMP ?L39
?L27:	CALL WT?,WRD,PS?BUZZ-WORD >STACK
	ZERO? STACK \?L39
	EQUAL? WRD,W?AND,W?$COMMA /?L39
	EQUAL? WRD,W?OF \?L34
	ZERO? P-GETFLAGS \?L39
	SET 'P-GETFLAGS,P-INHIBIT
	JUMP ?L39
?L34:	CALL WT?,WRD,PS?ADJECTIVE,P1?ADJECTIVE >WV
	ZERO? WV /?L38
	ZERO? P-ADJ \?L38
	SET 'P-ADJ,WV
	SET 'P-ADJN,WRD
	JUMP ?L39
?L38:	CALL WT?,WRD,PS?OBJECT,P1?OBJECT >STACK
	ZERO? STACK /?L39
	SET 'P-NAM,WRD
	SET 'P-ONEOBJ,WRD
?L39:	EQUAL? PTR,EPTR /?L44
	ADD PTR,P-WORDLEN >PTR
	SET 'WRD,NW
	JUMP ?L1

	.FUNCT GET-OBJECT,TBL,VRB=1,BITS,LEN,XBITS,TLEN,GCHECK=0,OLEN=0,OBJ
	SET 'XBITS,P-SLOCBITS
	GET TBL,P-MATCHLEN >TLEN
	BTST P-GETFLAGS,P-INHIBIT /TRUE
	ZERO? P-NAM \?L7
	ZERO? P-ADJ /?L4
	CALL WT?,P-ADJN,PS?OBJECT,P1?OBJECT >STACK
	ZERO? STACK /?L4
	SET 'P-NAM,P-ADJN
	SET 'P-ADJ,0
?L4:	ZERO? P-NAM \?L7
	ZERO? P-ADJ \?L7
	EQUAL? P-GETFLAGS,P-ALL /?L77
	ZERO? P-GWIMBIT \?L7
	ZERO? VRB /FALSE
	PRINTI "(I couldn't find enough nouns in that sentence!)"
	CRLF
	RFALSE
?L7:	EQUAL? P-GETFLAGS,P-ALL \?L17
?L77:	ZERO? P-SLOCBITS \?L15
?L17:	SET 'P-SLOCBITS,-1
?L15:	SET 'P-TABLE,TBL
?L19:	ZERO? GCHECK /?L21
	CALL GLOBAL-CHECK,TBL
	JUMP ?L23
?L21:	ZERO? LIT /?L24
	FCLEAR PLAYER,TRANSBIT
	CALL DO-SL,HERE,SOG,SIR
	FSET PLAYER,TRANSBIT
?L24:	CALL DO-SL,PLAYER,SH,SC
?L23:	GET TBL,P-MATCHLEN >STACK
	SUB STACK,TLEN >LEN
	BTST P-GETFLAGS,P-ALL /?L68
	BTST P-GETFLAGS,P-ONE \?L29
	ZERO? LEN /?L29
	EQUAL? LEN,1 /?L30
	RANDOM LEN >STACK
	GET TBL,STACK >STACK
	PUT TBL,1,STACK
	PRINTI "(How about the "
	GET TBL,1 >STACK
	PRINTD STACK
	PRINTI "?)"
	CRLF
?L30:	PUT TBL,P-MATCHLEN,1
	JUMP ?L68
?L29:	GRTR? LEN,1 /?L38
	ZERO? LEN \?L68
	EQUAL? P-SLOCBITS,-1 /?L37
?L38:	EQUAL? P-SLOCBITS,-1 \?L39
	SET 'P-SLOCBITS,XBITS
	SET 'OLEN,LEN
	GET TBL,P-MATCHLEN >STACK
	SUB STACK,LEN >STACK
	PUT TBL,P-MATCHLEN,STACK
	JUMP ?L19
?L39:	ZERO? LEN \?L42
	SET 'LEN,OLEN
?L42:	ZERO? P-NAM /?L45
	EQUAL? PRSA,V?DISEMBARK,V?MAKE,V?SEARCH-OBJECT-FOR /?L47
	EQUAL? PRSA,V?SEARCH,V?FIND,V?TAKE /?L47
	EQUAL? PRSA,V?ASK-CONTEXT-FOR,V?ASK-FOR,V?SGIVE /?L47
	EQUAL? PRSA,V?GIVE,V?WHAT /?L47
	EQUAL? PRSA,V?TELL-ME,V?ASK-CONTEXT-ABOUT,V?ASK-ABOUT \?L45
?L47:	ADD TLEN,1 >STACK
	GET TBL,STACK >OBJ
	ZERO? OBJ /?L45
	GETP OBJ,P?GENERIC >STACK
	CALL STACK,OBJ >OBJ
	ZERO? OBJ /?L45
	EQUAL? OBJ,NOT-HERE-OBJECT /FALSE
	PUT TBL,1,OBJ
	PUT TBL,P-MATCHLEN,1
	SET 'P-NAM,0
	SET 'P-ADJ,0
	RTRUE
?L45:	ZERO? VRB /?L55
	ZERO? P-NAM /?L51
	CALL WHICH-PRINT,TLEN,LEN,TBL
	EQUAL? TBL,P-PRSO \?L52
	SET 'P-ACLAUSE,P-NC1
	JUMP ?L54
?L52:	SET 'P-ACLAUSE,P-NC2
?L54:	SET 'P-AADJ,P-ADJ
	SET 'P-ANAM,P-NAM
	CALL ORPHAN,0,0
	SET 'P-OFLAG,1
	JUMP ?L55
?L51:	ZERO? VRB /?L55
	PRINTI "(I couldn't find enough nouns in that sentence!)"
	CRLF
?L55:	SET 'P-NAM,0
	SET 'P-ADJ,0
	RFALSE
?L37:	ZERO? LEN \?L68
	ZERO? GCHECK /?L59
	ZERO? VRB /?L64
	SET 'P-SLOCBITS,XBITS
	ZERO? LIT /?L62
	CALL OBJ-FOUND,NOT-HERE-OBJECT,TBL
	SET 'P-XNAM,P-NAM
	SET 'P-XADJ,P-ADJ
	SET 'P-XADJN,P-ADJN
	SET 'P-NAM,0
	SET 'P-ADJ,0
	SET 'P-ADJN,0
	RTRUE
?L62:	PRINTI "(It's too dark to see!)"
	CRLF
?L64:	SET 'P-NAM,0
	SET 'P-ADJ,0
	RFALSE
?L59:	ZERO? LEN \?L68
	SET 'GCHECK,1
	JUMP ?L19
?L68:	ZERO? P-ADJ /?L70
	ZERO? P-NAM \?L70
	PRINTI "(I assume you mean"
	ADD TLEN,1 >STACK
	GET TBL,STACK >OBJ
	CALL THE?,OBJ
	PRINTI " "
	PRINTD OBJ
	PRINTI ".)"
	CRLF
?L70:	SET 'P-SLOCBITS,XBITS
	SET 'P-NAM,0
	SET 'P-ADJ,0
	RTRUE

	.FUNCT MOBY-FIND,TBL,FOO,LEN
	SET 'P-SLOCBITS,-1
	SET 'P-NAM,P-XNAM
	SET 'P-ADJ,P-XADJ
	PUT TBL,P-MATCHLEN,0
	FIRST? ROOMS >FOO \?L3
?L4:	CALL SEARCH-LIST,FOO,TBL,P-SRCALL
	NEXT? FOO >FOO /?L4
?L3:	GET TBL,P-MATCHLEN >LEN
	ZERO? LEN \?L8
	CALL DO-SL,LOCAL-GLOBALS,1,1
?L8:	GET TBL,P-MATCHLEN >LEN
	ZERO? LEN \?L11
	CALL DO-SL,ROOMS,1,1
?L11:	GET TBL,P-MATCHLEN >LEN
	EQUAL? LEN,1 \?L14
	GET TBL,1 >P-MOBY-FOUND
?L14:	RETURN LEN

	.FUNCT WHICH-PRINT,TLEN,LEN,TBL,OBJ,RLEN
	SET 'RLEN,LEN
	PRINTI "(Which"
	ZERO? P-OFLAG \?L5
	ZERO? P-MERGED /?L3
?L5:	PRINTI " "
	PRINTB P-NAM
	JUMP ?L9
?L3:	EQUAL? TBL,P-PRSO \?L8
	CALL CLAUSE-PRINT,P-NC1,P-NC1L,0
	JUMP ?L9
?L8:	CALL CLAUSE-PRINT,P-NC2,P-NC2L,0
?L9:	PRINTI " do you mean,"
?L12:	INC 'TLEN
	GET TBL,TLEN >OBJ
	CALL THE?,OBJ
	PRINTI " "
	PRINTD OBJ
	EQUAL? LEN,2 \?L16
	EQUAL? RLEN,2 /?L18
	PRINTI ","
?L18:	PRINTI " or"
	JUMP ?L25
?L16:	GRTR? LEN,2 \?L25
	PRINTI ","
?L25:	DLESS? 'LEN,1 \?L12
	PRINTR "?)"

	.FUNCT GLOBAL-CHECK,TBL,LEN,RMG,RMGL,CNT=0,OBJ,OBITS,FOO
	GET TBL,P-MATCHLEN >LEN
	SET 'OBITS,P-SLOCBITS
	GETPT HERE,P?GLOBAL >RMG
	ZERO? RMG /?L4
	PTSIZE RMG >STACK
	SUB STACK,1 >RMGL
?L3:	GETB RMG,CNT >OBJ
	CALL THIS-IT?,OBJ,TBL >STACK
	ZERO? STACK /?L5
	CALL OBJ-FOUND,OBJ,TBL
?L5:	IGRTR? 'CNT,RMGL \?L3
?L4:	GETPT HERE,P?PSEUDO >RMG
	ZERO? RMG /?L15
	PTSIZE RMG >STACK
	DIV STACK,4 >STACK
	SUB STACK,1 >RMGL
	SET 'CNT,0
?L14:	MUL CNT,2 >STACK
	GET RMG,STACK >STACK
	EQUAL? P-NAM,STACK \?L16
	MUL CNT,2 >STACK
	INC 'STACK
	GET RMG,STACK >STACK
	PUTP PSEUDO-OBJECT,P?ACTION,STACK
	GETPT PSEUDO-OBJECT,P?ACTION >STACK
	SUB STACK,5 >FOO
	GET P-NAM,0 >STACK
	PUT FOO,0,STACK
	GET P-NAM,1 >STACK
	PUT FOO,1,STACK
	CALL OBJ-FOUND,PSEUDO-OBJECT,TBL
	JUMP ?L15
?L16:	IGRTR? 'CNT,RMGL \?L14
?L15:	GET TBL,P-MATCHLEN >STACK
	EQUAL? STACK,LEN \FALSE
	SET 'P-SLOCBITS,-1
	SET 'P-TABLE,TBL
	CALL DO-SL,GLOBAL-OBJECTS,1,1
	SET 'P-SLOCBITS,OBITS
	GET TBL,P-MATCHLEN >STACK
	ZERO? STACK \FALSE
	EQUAL? PRSA,V?WALK-TO,V?THROUGH,V?SEARCH-OBJECT-FOR /?L27
	EQUAL? PRSA,V?SEARCH,V?LOOK-INSIDE,V?DROP /?L27
	EQUAL? PRSA,V?FOLLOW,V?FIND,V?EXAMINE \FALSE
?L27:	CALL DO-SL,ROOMS,1,1 >STACK
	RSTACK

	.FUNCT DO-SL,OBJ,BIT1,BIT2,BITS
	ADD BIT1,BIT2 >STACK
	BTST P-SLOCBITS,STACK \?L1
	CALL SEARCH-LIST,OBJ,P-TABLE,P-SRCALL >STACK
	RSTACK
?L1:	BTST P-SLOCBITS,BIT1 \?L4
	CALL SEARCH-LIST,OBJ,P-TABLE,P-SRCTOP >STACK
	RSTACK
?L4:	BTST P-SLOCBITS,BIT2 \TRUE
	CALL SEARCH-LIST,OBJ,P-TABLE,P-SRCBOT >STACK
	RSTACK

	.FUNCT SEARCH-LIST,OBJ,TBL,LVL,FLS
	FIRST? OBJ >OBJ \FALSE
?L3:	EQUAL? LVL,P-SRCBOT /?L5
	GETPT OBJ,P?SYNONYM >STACK
	ZERO? STACK /?L5
	CALL THIS-IT?,OBJ,TBL >STACK
	ZERO? STACK /?L5
	CALL OBJ-FOUND,OBJ,TBL
?L5:	EQUAL? LVL,P-SRCTOP \?L10
	FSET? OBJ,SEARCHBIT /?L10
	FSET? OBJ,SURFACEBIT \?L8
?L10:	FIRST? OBJ >STACK \?L8
	EQUAL? OBJ,PLAYER,LOCAL-GLOBALS /?L8
	FSET? OBJ,SURFACEBIT \?L11
	PUSH P-SRCALL
	JUMP ?L14
?L11:	FSET? OBJ,SEARCHBIT \?L13
	PUSH P-SRCALL
	JUMP ?L14
?L13:	PUSH P-SRCTOP
?L14:	CALL SEARCH-LIST,OBJ,TBL,STACK >FLS
?L8:	NEXT? OBJ >OBJ /?L3
	RTRUE

	.FUNCT THIS-IT?,OBJ,TBL,SYNS
	FSET? OBJ,INVISIBLE /FALSE
	ZERO? P-NAM /?L3
	GETPT OBJ,P?SYNONYM >SYNS
	PTSIZE SYNS >STACK
	DIV STACK,2 >STACK
	DEC 'STACK
	CALL ZMEMQ,P-NAM,SYNS,STACK >STACK
	ZERO? STACK /FALSE
?L3:	ZERO? P-ADJ /?L4
	GETPT OBJ,P?ADJECTIVE >SYNS
	ZERO? SYNS /FALSE
	PTSIZE SYNS >STACK
	DEC 'STACK
	CALL ZMEMQB,P-ADJ,SYNS,STACK >STACK
	ZERO? STACK /FALSE
?L4:	ZERO? P-GWIMBIT /TRUE
	FSET? OBJ,P-GWIMBIT /TRUE
	RFALSE

	.FUNCT OBJ-FOUND,OBJ,TBL,PTR
	GET TBL,P-MATCHLEN >PTR
	ADD PTR,1 >STACK
	PUT TBL,STACK,OBJ
	ADD PTR,1 >STACK
	PUT TBL,P-MATCHLEN,STACK
	RTRUE

	.FUNCT TAKE-CHECK
	GETB P-SYNTAX,P-SLOC1 >STACK
	CALL ITAKE-CHECK,P-PRSO,STACK >STACK
	ZERO? STACK /FALSE
	GETB P-SYNTAX,P-SLOC2 >STACK
	CALL ITAKE-CHECK,P-PRSI,STACK >STACK
	RSTACK

	.FUNCT ITAKE-CHECK,TBL,BITS,PTR,OBJ,TAKEN
	GET TBL,P-MATCHLEN >PTR
	ZERO? PTR /TRUE
	BTST BITS,SHAVE /?L3
	BTST BITS,STAKE \TRUE
?L3:	DLESS? 'PTR,0 /TRUE
	ADD PTR,1 >STACK
	GET TBL,STACK >OBJ
	EQUAL? OBJ,IT \?L9
	SET 'OBJ,P-IT-OBJECT
	JUMP ?L11
?L9:	EQUAL? OBJ,HIM-HER \?L11
	SET 'OBJ,P-HIM-HER
?L11:	CALL HELD?,OBJ >STACK
	ZERO? STACK \?L3
	SET 'PRSO,OBJ
	FSET? OBJ,TRYTAKEBIT \?L15
	SET 'TAKEN,1
	JUMP ?L19
?L15:	EQUAL? WINNER,PLAYER /?L17
	SET 'TAKEN,0
	JUMP ?L19
?L17:	BTST BITS,STAKE \?L18
	CALL ITAKE,0 >STACK
	EQUAL? STACK,1 \?L18
	SET 'TAKEN,0
	JUMP ?L19
?L18:	SET 'TAKEN,1
?L19:	ZERO? TAKEN /?L37
	BTST BITS,SHAVE \?L20
	PRINTI "(You don't have"
	EQUAL? OBJ,NOT-HERE-OBJECT \?L24
	PRINTI " that!)"
	CRLF
	RFALSE
?L24:	CALL THE?,OBJ
	PRINTI " "
	PRINTD OBJ
	PRINTI "!)"
	CRLF
	RFALSE
?L20:	ZERO? TAKEN \?L3
?L37:	EQUAL? WINNER,PLAYER \?L3
	PRINTI "(taken)"
	CRLF
	JUMP ?L3

	.FUNCT MANY-CHECK,LOSS=0,TMP
	GET P-PRSO,P-MATCHLEN >STACK
	GRTR? STACK,1 \?L1
	GETB P-SYNTAX,P-SLOC1 >STACK
	BTST STACK,SMANY /?L1
	SET 'LOSS,1
	JUMP ?L3
?L1:	GET P-PRSI,P-MATCHLEN >STACK
	GRTR? STACK,1 \?L3
	GETB P-SYNTAX,P-SLOC2 >STACK
	BTST STACK,SMANY /?L3
	SET 'LOSS,2
?L3:	ZERO? LOSS /TRUE
	PRINTI "(You can't use multiple "
	EQUAL? LOSS,2 \?L9
	PRINTI "in"
?L9:	PRINTI "direct objects with """
	GET P-ITBL,P-VERBN >TMP
	ZERO? TMP \?L16
	PRINTI "tell"
	JUMP ?L21
?L16:	ZERO? P-OFLAG /?L20
	GET TMP,0 >STACK
	PRINTB STACK
	JUMP ?L21
?L20:	GETB TMP,3 >STACK
	GETB TMP,2 >STACK
	CALL WORD-PRINT,STACK,STACK
?L21:	PRINTI """!)"
	CRLF
	RFALSE

	.FUNCT ZMEMQ,ITM,TBL,SIZE=-1,CNT=1
	ZERO? TBL /FALSE
	LESS? SIZE,0 /?L4
	SET 'CNT,0
	JUMP ?L6
?L4:	GET TBL,0 >SIZE
?L6:	GET TBL,CNT >STACK
	EQUAL? ITM,STACK /TRUE
	IGRTR? 'CNT,SIZE \?L6
	RFALSE

	.FUNCT ZMEMQB,ITM,TBL,SIZE,CNT=0
?L1:	GETB TBL,CNT >STACK
	EQUAL? ITM,STACK /TRUE
	IGRTR? 'CNT,SIZE \?L1
	RFALSE

	.FUNCT PRSO-PRINT,PTR
	GET P-PRSO,P-MATCHLEN >STACK
	GRTR? STACK,0 /?L3
	ZERO? P-MERGED \?L3
	GET P-ITBL,P-NC1 >PTR
	GET PTR,0 >STACK
	EQUAL? STACK,W?IT \?L1
?L3:	PRINTI " "
	PRINTD PRSO
	RTRUE
?L1:	GET P-ITBL,P-NC1L >STACK
	CALL BUFFER-PRINT,PTR,STACK,0 >STACK
	RSTACK

	.FUNCT THE-PRSO-PRINT
	CALL THE?,PRSO
	CALL PRSO-PRINT >STACK
	RSTACK

	.FUNCT PRSI-PRINT,PTR
	GET P-PRSI,P-MATCHLEN >STACK
	GRTR? STACK,0 /?L3
	ZERO? P-MERGED \?L3
	GET P-ITBL,P-NC2 >PTR
	GET PTR,0 >STACK
	EQUAL? STACK,W?IT \?L1
?L3:	PRINTI " "
	PRINTD PRSI
	RTRUE
?L1:	GET P-ITBL,P-NC2L >STACK
	CALL BUFFER-PRINT,PTR,STACK,0 >STACK
	RSTACK

	.FUNCT THE-PRSI-PRINT
	CALL THE?,PRSI
	CALL PRSI-PRINT >STACK
	RSTACK

	.FUNCT V-SCRIPT
	GET 0,8 >STACK
	BOR STACK,1 >STACK
	PUT 0,8,STACK
	PRINTI "Here begins"
	PRINTI " a transcript of interaction with "
	CALL V-VERSION
	RTRUE

	.FUNCT V-UNSCRIPT
	PRINTI "Here ends"
	PRINTI " a transcript of interaction with "
	CALL V-VERSION
	GET 0,8 >STACK
	BAND STACK,-2 >STACK
	PUT 0,8,STACK
	RTRUE

	.FUNCT V-$0024VERIFY
	PRINTI "Verifying disk..."
	CRLF
	VERIFY \?L3
	PRINTR "The disk is correct."
?L3:	CRLF
	PRINTR "** Disk Failure **"

	.FUNCT V-$0024TANDY,X,MSG
	ZERO? DEBUG \?L1
	CALL PICK-ONE,UNKNOWN-MSGS >MSG
	GET MSG,0 >STACK
	PRINT STACK
	PRINTI "$ta"
	GET MSG,1 >STACK
	PRINT STACK
	CRLF
	RTRUE
?L1:	GETB 0,1 >X
	BTST X,8 /?L6
	BOR X,8 >STACK
	PUTB 0,1,STACK
	PRINTR "[on]"
?L6:	BAND X,-9 >STACK
	PUTB 0,1,STACK
	PRINTR "[off]"

	.FUNCT V-$0024WHERE,CNT=0,O,L,MSG
	ZERO? DEBUG \?L1
	CALL PICK-ONE,UNKNOWN-MSGS >MSG
	GET MSG,0 >STACK
	PRINT STACK
	PRINTI "$whr"
	GET MSG,1 >STACK
	PRINT STACK
	CRLF
	RTRUE
?L1:	ZERO? PRSI /?L5
	MOVE PRSI,PRSO
	RTRUE
?L5:	ZERO? PRSO /?L6
	CALL GOTO,PRSO >STACK
	RSTACK
?L6:	GET CHARACTER-TABLE,CNT >O
	ZERO? O /?L20
	LOC O >L
	PRINTD O
	PRINTI " is "
	ZERO? L /?L14
	PRINTI "in"
	CALL THE?,L
	PRINTI " "
	PRINTD L
	PRINTI "."
	CRLF
	JUMP ?L20
?L14:	PRINTI "nowhere."
	CRLF
?L20:	IGRTR? 'CNT,CHARACTER-MAX \?L6
	RTRUE

	.FUNCT V-DEBUG,MSG
	ZERO? DEBUG \?L3
	SET 'DEBUG,1
	JUMP ?L4
?L3:	SET 'DEBUG,0
?L4:	ZERO? DEBUG /?L1
	PRINTR "Find them bugs, boss!"
?L1:	PRINTR "No bugs left, eh?"

	.FUNCT V-BRIEF
	SET 'VERBOSE,0
	SET 'SUPER-BRIEF,0
	SET 'P-SPACE,1
	PRINTI "(O.K., you will get "
	PRINTI "brief"
	PRINTR " descriptions.)"

	.FUNCT V-SUPER-BRIEF
	SET 'SUPER-BRIEF,1
	SET 'P-SPACE,0
	PRINTI "(O.K., you will get "
	PRINTR "super-brief descriptions. Remember that objects and people won't be described, only the name of the place you are entering.)"

	.FUNCT V-VERBOSE
	SET 'VERBOSE,1
	SET 'SUPER-BRIEF,0
	SET 'P-SPACE,1
	PRINTI "(O.K., you will get "
	PRINTI "verbose"
	PRINTR " descriptions.)"

	.FUNCT V-SPACE
	SET 'P-SPACE,1
	PRINTR "(O.K., you will now see a space before each input line.)"

	.FUNCT V-UNSPACE
	SET 'P-SPACE,0
	PRINTR "(O.K., you will not see a space before each input line.)"

	.FUNCT V-INVENTORY
	FIRST? WINNER >STACK \?L1
	CALL PRINT-CONT,WINNER >STACK
	RSTACK
?L1:	PRINTR "You are empty-handed."

	.FUNCT V-TIME
	PRINTI "It's now "
	CALL TIME-PRINT,PRESENT-TIME
	CRLF
	RTRUE

	.FUNCT TIME-PRINT,NUM,HR,AM=0
	DIV NUM,60 >HR
	GRTR? HR,12 \?L1
	SUB HR,12 >HR
	SET 'AM,1
	JUMP ?L3
?L1:	EQUAL? HR,12 \?L3
	SET 'AM,1
?L3:	PRINTN HR
	PRINTI ":"
	MOD NUM,60 >HR
	LESS? HR,10 \?L7
	PRINTI "0"
?L7:	PRINTN HR
	PRINTI " "
	ZERO? AM /?L16
	PUSH STR?16
	JUMP ?L18
?L16:	PUSH STR?17
?L18:	PRINT STACK
	RTRUE

	.FUNCT V-QUIT,ASK?=1,SCOR
	ZERO? ASK? /?L3
	PRINTI "(If you want to continue from this point at another time, you must ""SUSPEND"" first.) Do you want to "
	PRINTI "stop your investigation now?"
	CALL YES? >STACK
	ZERO? STACK \?L3
	ZERO? ASK? \?L1
?L3:	ZERO? TOO-LATE /?L7
	CALL TOO-LATE-F
?L7:	QUIT
?L1:	PRINTR "O.K."

	.FUNCT V-RESTART
	PRINTI "Do you wish to restart your investigation?"
	CALL YES? >STACK
	ZERO? STACK /FALSE
	RESTART

	.FUNCT V-RESTORE
	RESTORE \?L1
	PRINTI "O.K."
	CRLF
	CALL V-FIRST-LOOK >STACK
	RSTACK
?L1:	PRINTI "Your previous"
	PRINTI " status couldn't be restored."
	PRINTI " Consult your instruction manual"
	PRINTI " or Reference Card"
	PRINTR " if necessary."

	.FUNCT V-FIRST-LOOK
	CALL DESCRIBE-ROOM >STACK
	ZERO? STACK /FALSE
	ZERO? SUPER-BRIEF \FALSE
	CALL DESCRIBE-OBJECTS >STACK
	RSTACK

	.FUNCT V-SAVE
	SAVE \?L1
	PRINTR "O.K."
?L1:	PRINTI "Your story couldn't be suspended."
	PRINTI " Consult your instruction manual"
	PRINTI " or Reference Card"
	PRINTR " if necessary."

	.FUNCT TANDY?
	GETB 0,1 >STACK
	BTST STACK,8 /TRUE
	RFALSE

	.FUNCT V-VERSION,CNT=17
	PRINTI "The WITNESS Infocom interactive fiction - a mystery story
Copyright (c) 1983 by Infocom, Inc. All rights reserved.
"
	PRINTI "The WITNESS is a registered trademark of Infocom, Inc.
Release number "
	GET 0,1 >STACK
	BAND STACK,2047 >STACK
	PRINTN STACK
	PRINTI " / Serial number "
?L7:	IGRTR? 'CNT,23 /?L8
	GETB 0,CNT >STACK
	PRINTC STACK
	JUMP ?L7
?L8:	CRLF
	RTRUE

	.FUNCT YES?
	PRINTI " (Answer YES or NO.) >"
	READ P-INBUF,P-LEXV
	GETB P-LEXV,P-LEXWORDS >STACK
	ZERO? STACK /FALSE
	GET P-LEXV,1 >STACK
	EQUAL? STACK,W?YES,W?Y \FALSE
	RTRUE

	.FUNCT DESCRIBE-OBJECT,OBJ,V?,LEVEL,STR=0,AV
	ZERO? LEVEL \?L1
	GETP OBJ,P?DESCFCN >STACK
	CALL STACK,M-OBJDESC >STACK
	ZERO? STACK \TRUE
?L1:	FSET? OBJ,PERSON \?L4
	CALL THIS-IS-S-HE,OBJ
	JUMP ?L6
?L4:	CALL THIS-IS-IT,OBJ
?L6:	ZERO? LEVEL \?L13
	FSET? OBJ,TOUCHBIT /?L10
	GETP OBJ,P?FDESC >STR
	ZERO? STR \?L9
?L10:	GETP OBJ,P?LDESC >STR
	ZERO? STR /?L7
?L9:	PRINT STR
	JUMP ?L31
?L7:	ZERO? LEVEL \?L13
	FSET? OBJ,PERSON \?L14
	PRINTD OBJ
	PRINTI " is here."
	JUMP ?L31
?L14:	PRINTI "There's "
	FSET? OBJ,AN \?L21
	PUSH STR?18
	JUMP ?L23
?L21:	PUSH STR?19
?L23:	PRINT STACK
	PRINTD OBJ
	PRINTI " here."
	JUMP ?L31
?L13:	GET INDENTS,LEVEL >STACK
	PRINT STACK
	FSET? OBJ,PERSON \?L27
	PRINTD OBJ
	JUMP ?L31
?L27:	FSET? OBJ,AN \?L34
	PUSH STR?18
	JUMP ?L36
?L34:	PUSH STR?19
?L36:	PRINT STACK
	PRINTD OBJ
?L31:	ZERO? LEVEL \?L37
	LOC WINNER >AV
	ZERO? AV /?L37
	FSET? AV,VEHBIT \?L37
	PRINTI " (outside"
	CALL THE?,AV
	PRINTI " "
	PRINTD AV
	PRINTI ")"
?L37:	CRLF
	CALL SEE-INSIDE?,OBJ >STACK
	ZERO? STACK /FALSE
	FIRST? OBJ >STACK \FALSE
	CALL PRINT-CONT,OBJ,V?,LEVEL >STACK
	RSTACK

	.FUNCT DESCRIBE-OBJECTS,V?=0
	ZERO? LIT /?L1
	FIRST? HERE >STACK \FALSE
	ZERO? V? \?L5
	SET 'V?,VERBOSE
?L5:	CALL PRINT-CONT,HERE,V?,-1 >STACK
	RSTACK
?L1:	PRINTR "You can't see anything in the dark."

	.FUNCT DESCRIBE-ROOM,LOOK?=0,V?,F?=0,STR,L
	SET 'V?,LOOK?
	ZERO? V? \?L1
	SET 'V?,VERBOSE
?L1:	FSET? HERE,TOUCHBIT /?L3
	FSET HERE,TOUCHBIT
	SET 'V?,1
	SET 'F?,1
?L3:	IN? HERE,ROOMS \?L17
	ZERO? P-PROMPT /?L8
	PRINTI "You are now "
	FSET? HERE,ON-NOT-IN \?L12
	PUSH STR?20
	JUMP ?L14
?L12:	PUSH STR?21
?L14:	PRINT STACK
	CALL THE?,HERE
	PRINTI " "
	PRINTD HERE
	PRINTI "."
	CRLF
	JUMP ?L17
?L8:	PRINTI "("
	PRINTD HERE
	PRINTI ")"
	CRLF
?L17:	ZERO? LOOK? \?L23
	ZERO? SUPER-BRIEF \?L54
?L23:	SET 'L,PLAYER-HIDING
	ZERO? L /?L24
	PRINTI "(You are hiding behind"
	CALL THE?,L
	PRINTI " "
	PRINTD L
	PRINTI ".)"
	CRLF
	JUMP ?L30
?L24:	LOC WINNER >L
	FSET? L,VEHBIT \?L30
	PRINTI "(You are "
	FSET? L,SURFACEBIT \?L33
	PRINTI "sitting o"
	JUMP ?L37
?L33:	PRINTI "standing i"
?L37:	PRINTI "n"
	CALL THE?,L
	PRINTI " "
	PRINTD L
	PRINTI ".)"
	CRLF
?L30:	ZERO? V? /?L50
	GETP HERE,P?ACTION >STACK
	CALL STACK,M-LOOK >STACK
	ZERO? STACK \TRUE
	ZERO? V? /?L50
	GETP HERE,P?FDESC >STR
	ZERO? STR /?L47
	PRINT STR
	CRLF
	JUMP ?L53
?L47:	ZERO? V? /?L50
	GETP HERE,P?LDESC >STR
	ZERO? STR /?L50
	PRINT STR
	CRLF
	JUMP ?L53
?L50:	GETP HERE,P?ACTION >STACK
	CALL STACK,M-FLASH >STACK
?L53:	EQUAL? HERE,L /?L54
	GETP L,P?ACTION >STACK
	CALL STACK,M-LOOK >STACK
?L54:	GETP HERE,P?CORRIDOR >STACK
	ZERO? STACK /TRUE
	CALL CORRIDOR-LOOK
	RTRUE

	.FUNCT FIRSTER,OBJ,LEVEL
	EQUAL? OBJ,WINNER \?L1
	PRINTR "You are carrying:"
?L1:	IN? OBJ,ROOMS /FALSE
	GRTR? LEVEL,0 \?L6
	GET INDENTS,LEVEL >STACK
	PRINT STACK
?L6:	FSET? OBJ,SURFACEBIT \?L11
	PRINTI "Sitting on"
	CALL THE?,OBJ
	PRINTI " "
	PRINTD OBJ
	PRINTR " can be seen:"
?L11:	FSET? OBJ,PERSON \?L17
	PRINTD OBJ
	PRINTR " is holding:"
?L17:	PRINTI "The "
	PRINTD OBJ
	PRINTR " contains:"

	.FUNCT GONE-CRAZY
	PRINTI "You vaguely hear screaming and yelling through a haze of confusion and the tugs of your conscience asking ""How could you have done it?"" Before you can answer, you hear police sirens come near. Sergeant Duffy and two others enter and grab you by the arms. They take you to a waiting car, where, forlorn and disgusted, you think about being sent up for life. ""Maybe,"" you think, ""I shouldn't have done that."""
	CRLF
	CALL PRINT-ID,STR?22
	CALL CASE-OVER >STACK
	RSTACK

	.FUNCT GOTO,RM,V?=1,F,WT
	CALL WHERE-UPDATE,PLAYER
	MOVE PLAYER,RM
	SET 'HERE,RM
	SET 'LIT,1
	GETP HERE,P?ACTION >STACK
	CALL STACK,M-ENTER >STACK
	ZERO? V? /FALSE
	CALL V-FIRST-LOOK >STACK
	RSTACK

	.FUNCT HACK-HACK,STR
	IN? PRSO,GLOBAL-OBJECTS \?L1
	SET 'P-WON,0
	PRINTI "(You can't see any"
	CALL PRSO-PRINT
	PRINTR " here.)"
?L1:	PRINT STR
	CALL THE-PRSO-PRINT
	CALL PICK-ONE,HO-HUM >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT HELD?,OBJ
?L1:	LOC OBJ >STACK
	ZERO? STACK /FALSE
	LOC OBJ >STACK
	EQUAL? STACK,ROOMS,GLOBAL-OBJECTS /FALSE
	IN? OBJ,WINNER /TRUE
	LOC OBJ >OBJ
	JUMP ?L1

	.FUNCT IDROP
	FSET? PRSO,PERSON \?L1
	PRINTD PRSO
	PRINTI " wouldn't enjoy that."
	CRLF
	RFALSE
?L1:	IN? PRSO,WINNER /?L8
	LOC PRSO >STACK
	IN? STACK,WINNER /?L5
	PRINTI "You're not carrying"
	CALL THE-PRSO-PRINT
	PRINTI "."
	CRLF
	RFALSE
?L5:	IN? PRSO,WINNER /?L8
	LOC PRSO >STACK
	FSET? STACK,OPENBIT /?L8
	PRINTI "Too bad, but"
	CALL THE-PRSO-PRINT
	PRINTI " is closed."
	CRLF
	RFALSE
?L8:	MOVE PRSO,HERE
	RTRUE

	.FUNCT ITAKE,VB=1,CNT,OBJ,?TMP
	FSET? PRSO,TAKEBIT /?L1
	ZERO? VB /FALSE
	PRINTI "You can't take"
	CALL THE-PRSO-PRINT
	PRINTI "."
	CRLF
	RFALSE
?L1:	LOC PRSO >STACK
	IN? STACK,WINNER /?L8
	CALL WEIGHT,PRSO >?TMP
	CALL WEIGHT,WINNER >STACK
	ADD ?TMP,STACK >STACK
	GRTR? STACK,LOAD-ALLOWED \?L8
	ZERO? VB /?L9
	PRINTI "Your load's too heavy"
	LESS? LOAD-ALLOWED,LOAD-MAX \?L13
	PRINTI ", especially in light of your condition."
	JUMP ?L17
?L13:	PRINTI "."
?L17:	CRLF
?L9:	RETURN 2
?L8:	CALL CCOUNT,WINNER >CNT
	GRTR? CNT,FUMBLE-NUMBER \?L23
	MUL CNT,FUMBLE-PROB >?TMP
	RANDOM 100 >STACK
	GRTR? ?TMP,STACK \?L23
	FIRST? WINNER >OBJ /?L24
?L24:	NEXT? OBJ >OBJ /?L25
?L25:	PRINTI "Too bad, but"
	CALL IS-FRAGILE?,OBJ >?TMP
	ZERO? ?TMP /?L29
	PUSH ?TMP
	JUMP ?L28
?L29:	CALL IS-FRAGILE?,PRSO >STACK
?L28:	CALL PRINT-ID,STR?23,STACK
	CALL THE?,OBJ
	PRINTI " "
	PRINTD OBJ
	PRINTI " slips from your arms while you are taking"
	CALL THE-PRSO-PRINT
	PRINTI ", and both tumble to the "
	GETP HERE,P?LINE >STACK
	EQUAL? STACK,OUTSIDE-LINE-C \?L32
	PRINTI "ground"
	JUMP ?L36
?L32:	PRINTI "floor"
?L36:	PRINTI "."
	CRLF
	MOVE OBJ,HERE
	MOVE PRSO,HERE
	RETURN 2
?L23:	MOVE PRSO,WINNER
	FSET PRSO,TOUCHBIT
	FCLEAR PRSO,NDESCBIT
	FCLEAR PRSO,INVISIBLE
	RTRUE

	.FUNCT CCOUNT,OBJ,CNT=0,X
	FIRST? OBJ >X \?L4
?L3:	INC 'CNT
	NEXT? X >X /?L3
?L4:	RETURN CNT

	.FUNCT NOT-HERE,OBJ
	SET 'P-WON,0
	PRINTI "(You can't see"
	CALL THE?,OBJ
	PRINTI " "
	PRINTD OBJ
	PRINTR " here.)"

	.FUNCT PRINT-CONT,OBJ,V?=0,LEVEL=0,Y,1ST?,AV,STR=0,PV?=0,INV?=0
	FIRST? OBJ >Y \TRUE
	LOC WINNER >AV
	ZERO? AV /?L4
	FSET? AV,VEHBIT /?L6
?L4:	SET 'AV,0
?L6:	SET '1ST?,1
	LOC OBJ >STACK
	EQUAL? WINNER,OBJ,STACK \?L7
	SET 'INV?,1
	JUMP ?L11
?L7:	ZERO? Y \?L12
?L70:	ZERO? 1ST? \?L14
	PUSH 1
	JUMP ?L11
?L14:	PUSH 0
	JUMP ?L11
?L12:	EQUAL? Y,AV \?L16
	SET 'PV?,1
	JUMP ?L33
?L16:	EQUAL? Y,WINNER /?L33
	FSET? Y,INVISIBLE /?L33
	FSET? Y,TOUCHBIT /?L33
	GETP Y,P?FDESC >STR
	ZERO? STR /?L33
	FSET? Y,NDESCBIT \?L21
	ZERO? DEBUG /?L30
	PRINTI "[ndescbit] "
?L21:	SET '1ST?,0
	SET 'LEVEL,0
	ZERO? STR /?L30
	PRINT STR
	CRLF
	SET 'STR,0
	FSET? Y,PERSON \?L28
	CALL THIS-IS-S-HE,Y
	JUMP ?L30
?L28:	CALL THIS-IS-IT,Y
?L30:	CALL SEE-INSIDE?,Y >STACK
	ZERO? STACK /?L33
	LOC Y >STACK
	GETP STACK,P?DESCFCN >STACK
	ZERO? STACK \?L33
	FIRST? Y >STACK \?L33
	CALL PRINT-CONT,Y,V?,0
?L33:	NEXT? Y >Y /?L12
	JUMP ?L70
?L11:	FIRST? OBJ >Y /?L41
?L69:	ZERO? PV? /?L43
	ZERO? AV /?L43
	FIRST? AV >STACK \?L43
	CALL PRINT-CONT,AV,V?,LEVEL
?L43:	ZERO? 1ST? \FALSE
	RTRUE
?L41:	EQUAL? Y,AV,PLAYER /?L65
	FSET? Y,INVISIBLE /?L65
	ZERO? INV? \?L50
	FSET? Y,TOUCHBIT /?L50
	GETP Y,P?FDESC >STACK
	ZERO? STACK \?L65
?L50:	FSET? Y,NDESCBIT \?L53
	ZERO? DEBUG /?L51
	PRINTI "[ndescbit] "
?L53:	ZERO? 1ST? /?L56
	CALL FIRSTER,OBJ,LEVEL >STACK
	ZERO? STACK /?L60
	LESS? LEVEL,0 \?L60
	SET 'LEVEL,0
?L60:	INC 'LEVEL
	SET '1ST?,0
?L56:	CALL DESCRIBE-OBJECT,Y,V?,LEVEL
	JUMP ?L65
?L51:	FIRST? Y >STACK \?L65
	CALL SEE-INSIDE?,Y >STACK
	ZERO? STACK /?L65
	CALL PRINT-CONT,Y,V?,LEVEL
?L65:	NEXT? Y >Y /?L41
	JUMP ?L69

	.FUNCT PRINT-CONTENTS,OBJ,F,N,1ST?=1
	FIRST? OBJ >F \FALSE
?L3:	NEXT? F >N /?L5
?L5:	ZERO? 1ST? /?L6
	SET '1ST?,0
	JUMP ?L11
?L6:	PRINTI ", "
	ZERO? N \?L11
	PRINTI "and "
?L11:	FSET? F,PERSON \?L16
	PRINTD F
	JUMP ?L20
?L16:	FSET? F,AN \?L23
	PUSH STR?18
	JUMP ?L25
?L23:	PUSH STR?19
?L25:	PRINT STACK
	PRINTD F
?L20:	FSET? F,PERSON \?L26
	CALL THIS-IS-S-HE,F
	JUMP ?L28
?L26:	CALL THIS-IS-IT,F
?L28:	SET 'F,N
	ZERO? F \?L3
	RTRUE

	.FUNCT ROOM-CHECK
	IN? PRSO,ROOMS \?L1
	EQUAL? PRSO,HERE,GLOBAL-HERE \?L3
	CALL PERFORM,PRSA,GLOBAL-ROOM,PRSI
	RTRUE
?L3:	PRINTR "You aren't in that place!"
?L1:	EQUAL? PRSO,PSEUDO-OBJECT /FALSE
	CALL META-LOC,PRSO >STACK
	EQUAL? STACK,HERE,GLOBAL-OBJECTS,LOCAL-GLOBALS /FALSE
	SET 'P-WON,0
	PRINTI "(You can't see any "
	EQUAL? PRSO,CAR-WINDOW \?L13
	PRINTI "window"
	JUMP ?L17
?L13:	PRINTD PRSO
?L17:	PRINTR " here!)"

	.FUNCT SEE-INSIDE?,OBJ
	FSET? OBJ,INVISIBLE /FALSE
	FSET? OBJ,TRANSBIT /TRUE
	FSET? OBJ,OPENBIT /TRUE
	RFALSE

	.FUNCT WEIGHT,OBJ,CONT,WT=0
	FIRST? OBJ >CONT \?L4
?L3:	CALL WEIGHT,CONT >STACK
	ADD WT,STACK >WT
	NEXT? CONT >CONT /?L3
?L4:	GETP OBJ,P?SIZE >STACK
	ADD WT,STACK >STACK
	RSTACK

	.FUNCT PRE-ACCUSE
	ZERO? PRSI \?L1
	SET 'PRSI,GLOBAL-MURDER
?L1:	FSET? CORPSE,INVISIBLE \?L4
	PRINTR "Nothing's dead here but your head!"
?L4:	EQUAL? PRSO,CORPSE,GLOBAL-LINDER \?L8
	EQUAL? PRSI,GLOBAL-SUICIDE \?L8
	PRINTI "Duffy appears for a moment. "
	PRINTI """So you believe that Linder's death was suicide? I'm not convinced. But if you'll "
	PRINTR "just ""arrest Mr. Linder,"" we can go on from there."" He disappears again."
?L8:	EQUAL? PRSO,GLOBAL-MRS-LINDER \?L11
	EQUAL? PRSI,GLOBAL-SUICIDE \?L11
	PRINTR "Everybody knows that!"
?L11:	EQUAL? PRSI,GLOBAL-MURDER /?L14
	PRINTR "What an accusation!"
?L14:	FSET? PRSO,PERSON /FALSE
	PRINTI "What a detective! ""Quick, Sergeant! Arrest that "
	PRINTD PRSO
	PRINTR "!"""

	.FUNCT V-ACCUSE
	PRINTD PRSO
	PRINTI " shrugs off your accusation."
	CRLF
	CALL IS-PERSON? >STACK
	ZERO? STACK \?L4
	PUSH 0
	JUMP ?L7
?L4:	EQUAL? PRSO,MONICA \?L5
	PUSH 0
	JUMP ?L7
?L5:	EQUAL? PRSO,GLOBAL-MONICA /?L6
	PUSH 1
	JUMP ?L7
?L6:	PUSH 0
?L7:	CALL PRINT-ID,STR?24,STACK >STACK
	RSTACK

	.FUNCT PRE-SANALYZE
	CALL PERFORM,V?ANALYZE,PRSI,PRSO
	RTRUE

	.FUNCT V-SANALYZE
	PRINTR "[Foo!! This is a bug!!]"

	.FUNCT PRE-ANALYZE
	EQUAL? PRSI,GLOBAL-FINGERPRINTS /FALSE
	ZERO? MET-DUFFY? \?L3
	PRINTI "You haven't met Sergeant Duffy yet tonight."
	PRINTR " You'll need his help to do that."
?L3:	ZERO? DUFFY-WITH-STILES /FALSE
	PRINTR "You'd better wait until Duffy takes care of his prisoner."

	.FUNCT V-ANALYZE
	EQUAL? PRSI,GLOBAL-FINGERPRINTS \?L1
	CALL PERFORM,V?FINGERPRINT,PRSO
	RTRUE
?L1:	ZERO? FINGERPRINT-OBJ \?L4
	ZERO? DUFFY-AT-CORONER \?L4
	FSET? PRSO,TAKEBIT \?L3
?L4:	CALL DO-ANALYZE >STACK
	RSTACK
?L3:	IN? PRSO,GLOBAL-OBJECTS \?L5
	PRINTI "Duffy appears in an instant. ""Well, I might be able to analyze"
	CALL THE-PRSO-PRINT
	PRINTR ", but you don't even have it with you!""  With that, he discreetly leaves."
?L5:	PRINTI "Sergeant Duffy appears with a puzzled look on his face."
	PRINTI " ""With all respect, I don't think I can take THAT to the laboratory! I'll be nearby if you need me."""
	PRINTR " He leaves, shaking his head slowly."

	.FUNCT V-ANSWER
	PRINTI "Nobody seems to be waiting for your answer."
	CRLF
	SET 'P-CONT,0
	SET 'QUOTE-FLAG,0
	RTRUE

	.FUNCT V-REPLY
	SET 'P-CONT,0
	SET 'QUOTE-FLAG,0
	FSET? PRSO,DOORBIT \?L1
	PRINTI "No one's knocking at"
	CALL THE-PRSO-PRINT
	PRINTR "."
?L1:	PRINTI "Too bad, but"
	CALL THE-PRSO-PRINT
	PRINTR " doesn't care."

	.FUNCT PRE-ARREST
	FSET? CORPSE,INVISIBLE \?L1
	PRINTI "For what? You have no evidence of a crime yet."
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?25,STACK >STACK
	RSTACK
?L1:	ZERO? MET-DUFFY? \?L5
	PRINTI "You haven't met Sergeant Duffy yet tonight."
	PRINTR " You'll need his help to do that."
?L5:	ZERO? FINGERPRINT-OBJ \?L9
	ZERO? DUFFY-AT-CORONER /?L8
?L9:	PRINTR "Sergeant Duffy isn't around right now. You'll have to wait for him to help you make the arrest."
?L8:	EQUAL? PRSO,OBJECT-PAIR,GLOBAL-LINDER,CORPSE /?L12
	EQUAL? PRSI,RANDOM-CRIME,GLOBAL-SUICIDE \?L12
	PRINTR "Your Chief would probably want you to be sure there's no bigger fish here, like an honest-to-Pete murderer."
?L12:	EQUAL? PRSO,GLOBAL-DUFFY /FALSE
	FSET? PRSO,PERSON /?L18
	EQUAL? PRSO,OBJECT-PAIR,GLOBAL-LINDER,CORPSE \?L17
?L18:	EQUAL? PRSI,0,GLOBAL-MURDER /FALSE
?L17:	PRINTI "What a detective! ""Quick, Sergeant! Arrest that "
	PRINTD PRSO
	ZERO? PRSI /?L21
	PRINTI " for "
	PRINTD PRSI
?L21:	PRINTI " before "
	FSET? PRSO,FEMALE \?L28
	PUSH STR?4
	JUMP ?L32
?L28:	EQUAL? PRSO,GLOBAL-DUFFY /?L31
	FSET? PRSO,PERSON \?L30
?L31:	PUSH STR?2
	JUMP ?L32
?L30:	PUSH STR?26
?L32:	PRINT STACK
	PRINTR " gets away!"""

	.FUNCT V-ARREST
	FSET? PRSO,PERSON \?L1
	PRINTI "You realize that you don't have enough evidence to convict "
	PRINTD PRSO
	PRINTR ", so you decide to continue the investigation."
?L1:	PRINTI "Sergeant Duffy enters, strokes his chin, and in a puzzled voice says, ""With all respect, I think we'd be laughed out of the station if we tried to charge"
	CALL THE-PRSO-PRINT
	PRINTR " with murder!"" He leaves quietly."

	.FUNCT V-ASK-ABOUT
	EQUAL? PRSO,PLAYER \?L1
	PRINTR "It's been a long week, but talking to yourself won't end it any sooner."
?L1:	FSET? PRSO,PERSON /?L5
	PRINTI "Hey, Duffy! Look at your boss talking to "
	FSET? PRSO,AN \?L8
	PUSH STR?18
	JUMP ?L10
?L8:	PUSH STR?19
?L10:	PRINT STACK
	PRINTD PRSO
	PRINTR "!"
?L5:	FSET PRSO,TOUCHBIT
	PRINTD PRSO
	PRINTR " doesn't seem to know about that."

	.FUNCT PRE-ASK-CONTEXT-ABOUT,P,?TMP
	ZERO? QCONTEXT /?L1
	EQUAL? HERE,QCONTEXT-ROOM \?L1
	SET '?TMP,HERE
	CALL META-LOC,QCONTEXT >STACK
	EQUAL? ?TMP,STACK \?L1
	CALL PERFORM,V?ASK-ABOUT,QCONTEXT,PRSO
	RTRUE
?L1:	CALL FIND-FLAG,HERE,PERSON,WINNER >P
	ZERO? P /FALSE
	CALL PERFORM,V?ASK-ABOUT,P,PRSO
	RTRUE

	.FUNCT V-ASK-CONTEXT-ABOUT
	PRINTR "You aren't talking to anyone!"

	.FUNCT V-ASK-FOR
	FSET? PRSO,PERSON \?L1
	EQUAL? PRSO,PLAYER /?L1
	FSET PRSO,TOUCHBIT
	PRINTD PRSO
	IN? PRSI,PRSO \?L5
	PRINTI " hands you"
	CALL THE-PRSI-PRINT
	PRINTI "."
	CRLF
	MOVE PRSI,WINNER
	RTRUE
?L5:	PRINTR " doesn't have that."
?L1:	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT PRE-ASK-CONTEXT-FOR,P,?TMP
	ZERO? QCONTEXT /?L1
	EQUAL? HERE,QCONTEXT-ROOM \?L1
	SET '?TMP,HERE
	CALL META-LOC,QCONTEXT >STACK
	EQUAL? ?TMP,STACK \?L1
	CALL PERFORM,V?ASK-FOR,QCONTEXT,PRSO
	RTRUE
?L1:	CALL FIND-FLAG,HERE,PERSON,WINNER >P
	ZERO? P /FALSE
	CALL PERFORM,V?ASK-FOR,P,PRSO
	RTRUE

	.FUNCT V-ASK-CONTEXT-FOR
	PRINTR "You aren't talking to anyone!"

	.FUNCT V-ATTACK
	CALL IKILL,STR?27 >STACK
	RSTACK

	.FUNCT V-BRUSH
	EQUAL? PRSO,MUDDY-SHOES,OUTSIDE-GUN \?L1
	PRINTI "You shouldn't try to clean a piece of evidence."
	CRLF
	CALL PRINT-ID,STR?28 >STACK
	RSTACK
?L1:	PRINTR """Cleanliness is next to Godliness,"" but in this case it seems to be next to Impossible."

	.FUNCT V-CALL-LOSE
	PRINTR "(You must use a verb!)"

	.FUNCT V-$0024CALL,PER,MOT=0
	FSET? PRSO,PERSON \?L1
	GETP PRSO,P?CHARACTER >STACK
	GET CHARACTER-TABLE,STACK >PER
	CALL IN-MOTION?,PER >STACK
	ZERO? STACK /?L3
	SET 'MOT,1
?L3:	CALL META-LOC,PER >STACK
	EQUAL? STACK,HERE /?L8
	CALL CORRIDOR-LOOK,PER >STACK
	ZERO? STACK /?L6
?L8:	FSET PER,TOUCHBIT
	PRINTD PER
	CALL GRAB-ATTENTION,PER >STACK
	ZERO? STACK /?L11
	ZERO? MOT /?L13
	PRINTR " stops and turns toward you."
?L13:	PRINTR " is listening."
?L11:	PRINTR " ignores you."
?L6:	SET 'P-WON,0
	PRINTI "(You don't see "
	PRINTD PER
	PRINTR " here.)"
?L1:	CALL V-CALL-LOSE >STACK
	RSTACK

	.FUNCT V-PHONE,PER
	FSET? PRSO,PERSON \?L1
	GETP PRSO,P?CHARACTER >STACK
	GET CHARACTER-TABLE,STACK >PER
	ZERO? PER /?L1
	CALL META-LOC,PER >STACK
	EQUAL? STACK,HERE /?L3
	CALL CORRIDOR-LOOK,PER >STACK
	ZERO? STACK /?L1
?L3:	CALL PERFORM,V?$0024CALL,PRSO
	RTRUE
?L1:	EQUAL? PRSI,0,TELEPHONE /?L4
	PRINTI "Too bad, but"
	CALL THE-PRSI-PRINT
	PRINTR " isn't wired for phoning."
?L4:	CALL PHONE-IN?,HERE >STACK
	ZERO? STACK \?L7
	PRINTR "There's no phone here."
?L7:	EQUAL? PRSO,INTNUM \?L10
	ZERO? P-NUMBER \?L10
	PRINTI "You dial the operator, who doesn't go for any of your cute lines, but does connect you with the police station. "
	PRINTR "The night clerk at the station says he'll give Duffy your message."
?L10:	EQUAL? PRSO,BRASS-LANTERN /?L14
	EQUAL? PRSO,INTNUM \?L13
	EQUAL? P-NUMBER,1308 \?L13
?L14:	PRINTR "You dial the number. A voice with a thick Oriental accent answers and says, ""Sorry, Brass Lantern off tonight. Private party. Thank you."" Then the line goes dead."
?L13:	EQUAL? PRSO,MATCHBOOK,GLOBAL-STILES,STILES /?L18
	EQUAL? PRSO,INTNUM \?L21
	EQUAL? P-NUMBER,1729 \?L17
?L18:	PRINTR "You dial the number. It rings several times with no answer."
?L17:	EQUAL? PRSO,INTNUM \?L21
	PRINTR "There's no point in calling that number."
?L21:	EQUAL? PRSO,GLOBAL-TERRY \?L24
	PRINTR "You don't know the number."
?L24:	FSET? PRSO,PERSON /?L27
	PRINTI "Too bad, but"
	CALL THE-PRSO-PRINT
	PRINTR " has no phone."
?L27:	IN? PRSO,HERE \?L30
	PRINTD PRSO
	PRINTR " is right here!"
?L30:	PRINTI "There's no sense in phoning "
	PRINTD PRSO
	PRINTR "."

	.FUNCT V-CLIMB-ON
	FSET? PRSO,FURNITURE \?L5
	FSET? PRSO,VEHBIT \?L1
	MOVE PLAYER,PRSO
	PRINTI "You are now sitting on"
	CALL THE-PRSO-PRINT
	PRINTR "."
?L1:	FSET? PRSO,FURNITURE \?L5
	PRINTI "This isn't the kind of thing to sit on!"
	CRLF
	CALL PRINT-ID,STR?29 >STACK
	RSTACK
?L5:	PRINTI "You can't climb onto"
	CALL THE-PRSO-PRINT
	PRINTR "."

	.FUNCT V-CLIMB-UP,DIR=P?UP,OBJ=0,X
	GETPT HERE,DIR >STACK
	ZERO? STACK /?L1
	CALL PERFORM,V?WALK,DIR
	RTRUE
?L1:	ZERO? OBJ \?L12
	PRINTR "You can't go that way."
?L12:	GETPT PRSO,P?SYNONYM >X
	PTSIZE X >STACK
	DIV STACK,2 >STACK
	DEC 'STACK
	CALL ZMEMQ,W?WALL,X,STACK >STACK
	ZERO? STACK /?L6
	PRINTR "Climbing the walls is no help."
?L6:	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT V-CLIMB-DOWN
	FSET? PRSO,FURNITURE \?L1
	FSET? PRSO,VEHBIT \?L1
	CALL V-CLIMB-ON
	RTRUE
?L1:	CALL V-CLIMB-UP,P?DOWN >STACK
	RSTACK

	.FUNCT V-CLIMB-FOO
	CALL V-CLIMB-UP,P?UP,1 >STACK
	RSTACK

	.FUNCT V-CLOSE
	FSET? PRSO,CONTBIT /?L1
	FSET? PRSO,DOORBIT /?L6
	FSET? PRSO,WINDOWBIT /?L1
	PRINTI "You'd have to be more clever to do that to"
	CALL THE-PRSO-PRINT
	PRINTR "."
?L1:	FSET? PRSO,DOORBIT /?L6
	FSET? PRSO,WINDOWBIT \?L5
?L6:	FSET? PRSO,OPENBIT \?L7
	FSET? PRSO,RMUNGBIT \?L9
	PRINTR "It won't stay closed. The latch is broken."
?L9:	FCLEAR PRSO,OPENBIT
	PRINTI "Okeh,"
	CALL THE-PRSO-PRINT
	PRINTR " is now closed."
?L7:	PRINTR "It's already closed."
?L5:	FSET? PRSO,SURFACEBIT /?L19
	GETP PRSO,P?CAPACITY >STACK
	ZERO? STACK /?L19
	FSET? PRSO,OPENBIT \?L20
	FCLEAR PRSO,OPENBIT
	PRINTR "Closed."
?L20:	PRINTR "It's already closed."
?L19:	PRINTI "You can't close"
	CALL THE-PRSO-PRINT
	PRINTR "."

	.FUNCT PRE-COMPARE
	ZERO? PRSI \?L1
	GET P-PRSO,0 >STACK
	EQUAL? 1,STACK \?L1
	PRINTR "Oops! Try typing ""COMPARE IT TO (something)."""
?L1:	GET P-PRSO,0 >STACK
	EQUAL? 2,STACK \FALSE
	PUT P-PRSO,0,1
	GET P-PRSO,2 >STACK
	GET P-PRSO,1 >STACK
	CALL PERFORM,PRSA,STACK,STACK
	RTRUE

	.FUNCT V-COMPARE
	EQUAL? PRSO,PRSI \?L1
	PRINTR "They're the same thing!"
?L1:	PRINTR "They're not a bit alike."

	.FUNCT V-CONFRONT
	EQUAL? PRSO,PLAYER \?L1
	PRINTR "You aren't talking to anyone!"
?L1:	FSET? PRSO,PERSON /?L5
	PRINTI "That ought to put a scare into"
	CALL THE-PRSO-PRINT
	PRINTR "."
?L5:	PRINTD PRSO
	CALL PICK-ONE,WHO-CARES >STACK
	PRINT STACK
	PRINTR "."

	.FUNCT V-CURSES
	ZERO? PRSO /?L1
	FSET? PRSO,PERSON \?L3
	PRINTI "Insults like that won't help you solve the case."
	CRLF
	CALL PRINT-ID,STR?30 >STACK
	RSTACK
?L3:	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE
?L1:	CALL PICK-ONE,OFFENDED >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT V-MUNG
	FSET? PRSO,DOORBIT \?L1
	ZERO? PRSI \?L1
	FSET? PRSO,OPENBIT \?L3
	PRINTI "You'd fly through the open door if you tried."
	CRLF
	CALL PRINT-ID,STR?31 >STACK
	RSTACK
?L3:	FSET? PRSO,LOCKED \?L7
	PRINTI "Oof! All you get is a sore shoulder."
	CRLF
	CALL PRINT-ID,STR?32 >STACK
	RSTACK
?L7:	PRINTR "Why don't you just open it instead?"
?L1:	FSET? PRSO,PERSON /?L13
	CALL IS-OBJ-PROP-ANIMAL? >STACK
	CALL PRINT-ID,STR?33,STACK
	CALL HACK-HACK,STR?34 >STACK
	RSTACK
?L13:	ZERO? PRSI \?L14
	PRINTI "Trying to destroy "
	PRINTD PRSO
	PRINTI " with your bare hands is suicidal."
	CRLF
	CALL PRINT-ID,STR?35 >STACK
	RSTACK
?L14:	FSET? PRSI,WEAPONBIT /?L17
	PRINTI "Trying to destroy "
	PRINTD PRSO
	PRINTI " with "
	FSET? PRSI,AN \?L20
	PUSH STR?18
	JUMP ?L22
?L20:	PUSH STR?19
?L22:	PRINT STACK
	PRINTD PRSI
	PRINTI " is quite self-destructive."
	CRLF
	CALL PRINT-ID,STR?36 >STACK
	RSTACK
?L17:	PRINTR "You can't."

	.FUNCT V-DRINK
	CALL V-EAT >STACK
	RSTACK

	.FUNCT V-DROP
	CALL IDROP >STACK
	ZERO? STACK /FALSE
	PRINTI "Okeh,"
	CALL THE-PRSO-PRINT
	PRINTI " is now on the "
	GETP HERE,P?LINE >STACK
	EQUAL? STACK,OUTSIDE-LINE-C \?L5
	PRINTI "ground"
	JUMP ?L9
?L5:	PRINTI "floor"
?L9:	PRINTR "."

	.FUNCT V-EAT,EAT?=0,DRINK?=0,NOBJ=0
	CALL DANGEROUS-FOOD? >STACK
	CALL PRINT-ID,STR?37,STACK
	FSET? PRSO,FOODBIT /?L3
	SET 'EAT?,0
	JUMP ?L1
?L3:	SET 'EAT?,1
	IN? PRSO,WINNER \?L1
	EQUAL? PRSA,V?DRINK \?L5
	PRINTI "Seems that you've had too much to drink already!"
	CRLF
	CRLF
	RTRUE
?L5:	PRINTI "Mmm. That really hit the spot."
	CRLF
	REMOVE PRSO
	CRLF
	RTRUE
?L1:	FSET? PRSO,DRINKBIT /?L13
	SET 'DRINK?,0
	JUMP ?L12
?L13:	SET 'DRINK?,1
	IN? PRSO,GLOBAL-OBJECTS /?L17
	LOC PRSO >NOBJ
	ZERO? NOBJ /?L15
	IN? NOBJ,WINNER \?L15
	FSET? NOBJ,OPENBIT \?L15
?L17:	PRINTI "Mmm. That really hit the spot."
	CRLF
	REMOVE PRSO
	RTRUE
?L15:	PRINTR "You can't get to it."
?L12:	ZERO? EAT? \FALSE
	ZERO? DRINK? \FALSE
	PRINTR "The blue-plate special at the diner was enough for you."

	.FUNCT V-ENTER
	CALL PERFORM,V?WALK,P?IN
	RTRUE

	.FUNCT V-THROUGH,OBJ=0,RM,DIR,?TMP
	IN? PRSO,ROOMS \?L1
	CALL DIR-FROM,HERE,PRSO >DIR
	ZERO? DIR /?L3
	CALL PERFORM,V?WALK,DIR
	RTRUE
?L3:	SET '?TMP,PRSO
	CALL META-LOC,PLAYER >STACK
	EQUAL? ?TMP,STACK \?L5
	PRINTR "You're already there!"
?L5:	PRINTR "You can't go from here to there, at least not directly."
?L1:	FSET? PRSO,DOORBIT \?L11
	FSET? PRSO,OPENBIT \?L11
	CALL DOOR-ROOM,HERE,PRSO >RM
	ZERO? RM /?L12
	CALL GOTO,RM >STACK
	RSTACK
?L12:	PRINTI "Sorry, but the """
	PRINTD PRSO
	PRINTR """ must be somewhere else."
?L11:	EQUAL? PRSO,BACK-FOOTPRINTS,SIDE-FOOTPRINTS \?L17
	PRINTI "You could mess up valuable evidence that way."
	CRLF
	CALL PRINT-ID,STR?38
	RTRUE
?L17:	ZERO? OBJ \?L24
	FSET? PRSO,TAKEBIT /?L20
	PRINTI "You hit your head against"
	CALL THE-PRSO-PRINT
	PRINTI " as you try it."
	CRLF
	CALL PRINT-ID,STR?39 >STACK
	RSTACK
?L20:	ZERO? OBJ /?L23
?L24:	PRINTR "You can't do that!"
?L23:	IN? PRSO,WINNER \?L26
	PRINTR "You must think you're a contortionist!"
?L26:	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT PRE-EXAMINE,VAL
	CALL ROOM-CHECK >STACK
	ZERO? STACK \TRUE
	EQUAL? P-ADVERB,W?CAREFULLY \FALSE
	CALL INT-WAIT,3 >VAL
	ZERO? VAL \?L4
	PRINTI "You never got to finish looking over"
	CALL THE-PRSO-PRINT
	PRINTR "."
?L4:	EQUAL? VAL,M-FATAL /TRUE
	RFALSE

	.FUNCT V-EXAMINE,TXT
	IN? PRSO,GLOBAL-OBJECTS \?L1
	CALL NOT-HERE,PRSO
	RTRUE
?L1:	GETP PRSO,P?TEXT >TXT
	ZERO? TXT /?L3
	PRINT TXT
	CRLF
	RTRUE
?L3:	FSET? PRSO,CONTBIT \?L6
	CALL V-LOOK-INSIDE >STACK
	RSTACK
?L6:	PRINTI "There's nothing special about"
	CALL THE-PRSO-PRINT
	PRINTR "."

	.FUNCT PRE-FIND,PRON,PRON1,CHR,NUM,?TMP
	SET 'PRON,PRON-HIM
	SET 'PRON1,PRON-HE
	IN? PRSO,ROOMS \?L1
	EQUAL? PRSO,HERE \?L3
	PRINTR "You're already here!"
?L3:	FSET? PRSO,TOUCHBIT \?L7
	PRINTR "You should know - you've been there!"
?L7:	PRINTR "You're the detective!"
?L1:	FSET? PRSO,PERSON \FALSE
	GETP WINNER,P?CHARACTER >STACK
	GET WHERE-TABLES,STACK >?TMP
	GETP PRSO,P?CHARACTER >CHR
	GET ?TMP,CHR >NUM
	IN? PRSO,GLOBAL-OBJECTS \?L14
	GET CHARACTER-TABLE,CHR >PRSO
?L14:	FSET? PRSO,FEMALE \?L17
	SET 'PRON,PRON-HER
	SET 'PRON1,PRON-SHE
	JUMP ?L29
?L17:	EQUAL? CHR,LINDER-C \?L29
	LOC LINDER >STACK
	ZERO? STACK \?L29
	EQUAL? WINNER,PLAYER \?L20
	PRINTR "What do you mean? He's dead!"
?L20:	EQUAL? WINNER,PHONG \?L26
	ZERO? PHONG-SEEN-CORPSE? \?L25
?L26:	EQUAL? WINNER,MONICA \FALSE
	ZERO? MONICA-SEEN-CORPSE? /FALSE
?L25:	PRINTI """"
	PRINTI "What do you mean? He's dead!"
	PRINTR """"
?L29:	EQUAL? WINNER,PLAYER /?L31
	CALL GRAB-ATTENTION,WINNER >STACK
	ZERO? STACK /TRUE
?L31:	CALL META-LOC,WINNER >?TMP
	CALL META-LOC,PRSO >STACK
	EQUAL? ?TMP,STACK \?L34
	EQUAL? WINNER,PLAYER \?L36
	PRINTR "It sounds as though you need your vision checked."
?L36:	PRINTR """Ahem..."""
?L34:	ZERO? NUM \?L43
	EQUAL? WINNER,PLAYER \?L44
	PRINTI "You haven't seen "
	PRINT PRON
	PRINTR " yet."
?L44:	PRINTI """I haven't seen "
	PRINT PRON
	PRINTR " tonight."""
?L43:	SUB PRESENT-TIME,NUM >NUM
	EQUAL? WINNER,PLAYER \?L52
	PRINTI "You last saw "
	PRINT PRON
	PRINTI " "
	JUMP ?L56
?L52:	PRINTI """I last saw "
	PRINT PRON
	PRINTI " "
?L56:	GRTR? NUM,120 \?L59
	PRINTI "a few hours"
	JUMP ?L78
?L59:	GRTR? NUM,80 \?L63
	PRINTI "an hour or two"
	JUMP ?L78
?L63:	GRTR? NUM,45 \?L66
	PRINTI "about an hour"
	JUMP ?L78
?L66:	GRTR? NUM,20 \?L69
	PRINTI "about half an hour"
	JUMP ?L78
?L69:	GRTR? NUM,10 \?L72
	PRINTI "about 15 minutes"
	JUMP ?L78
?L72:	GRTR? NUM,5 \?L75
	PRINTI "less than 10 minutes"
	JUMP ?L78
?L75:	PRINTI "just a few minutes"
?L78:	EQUAL? WINNER,PLAYER /?L81
	PRINTI " ago. I don't know where "
	PRINT PRON1
	PRINTR " is now."""
?L81:	PRINTR " ago."

	.FUNCT V-FIND,L
	LOC PRSO >L
	EQUAL? PRSO,PLAYER \?L1
	EQUAL? PLAYER,WINNER /?L3
	PRINTI """"
?L3:	PRINTI "You're right here, "
	FSET? L,SURFACEBIT \?L10
	PRINTI "on"
	JUMP ?L14
?L10:	PRINTI "in"
?L14:	CALL THE?,L
	PRINTI " "
	PRINTD L
	PRINTI "."
	EQUAL? PLAYER,WINNER /?L19
	PRINTI """"
?L19:	CRLF
	RTRUE
?L1:	EQUAL? PLAYER,WINNER /?L24
	PRINTI """"
	PRINTI "You're the detective!"
	PRINTR """"
?L24:	EQUAL? L,GLOBAL-OBJECTS /?L28
	FSET? PRSO,TOUCHBIT /?L27
?L28:	PRINTR "You're the detective!"
?L27:	IN? PRSO,WINNER \?L31
	PRINTR "You have it."
?L31:	IN? PRSO,HERE /?L35
	EQUAL? PRSO,PSEUDO-OBJECT \?L34
?L35:	PRINTR "It's right here."
?L34:	FSET? L,PERSON \?L38
	PRINTD L
	PRINTR " has it."
?L38:	FSET? L,SURFACEBIT \?L41
	PRINTI "It's on"
	CALL THE?,L
	PRINTI " "
	PRINTD L
	PRINTR "."
?L41:	FSET? L,CONTBIT \?L46
	PRINTI "It's in"
	CALL THE?,L
	PRINTI " "
	PRINTD L
	PRINTR "."
?L46:	PRINTR "You're the detective!"

	.FUNCT V-FINGERPRINT
	FSET? PRSO,PERSON \?L1
	PRINTI "You can't find prints on a person!"
	CRLF
	CALL PRINT-ID,STR?40 >STACK
	RSTACK
?L1:	PRINTI "You don't find any good prints on"
	CALL THE-PRSO-PRINT
	PRINTR "."

	.FUNCT V-FOLLOW,CN,CHR,COR,PCOR,L,?TMP
	EQUAL? PRSO,PLAYER \?L1
	PRINTR "It's not clear who you're talking to."
?L1:	FSET? PRSO,PERSON /?L5
	PRINTI "How tragic to see a formerly great detective stalking "
	FSET? PRSO,AN \?L8
	PUSH STR?18
	JUMP ?L10
?L8:	PUSH STR?19
?L10:	PRINT STACK
	PRINTD PRSO
	PRINTR "!"
?L5:	SET '?TMP,HERE
	GETP PRSO,P?CHARACTER >CN
	GET CHARACTER-TABLE,CN >CHR
	CALL META-LOC,CHR >L
	EQUAL? ?TMP,L \?L11
	PRINTI "You're in the same place as "
	FSET? CHR,TOUCHBIT \?L14
	PRINTD PRSO
	PRINTR "!"
?L14:	PRINTI "the "
	GETP CHR,P?XDESC >STACK
	PRINT STACK
	PRINTR "!"
?L11:	ZERO? L /?L22
	EQUAL? L,LIMBO \?L21
?L22:	FSET? CHR,TOUCHBIT \?L23
	PRINTD PRSO
	JUMP ?L27
?L23:	PRINTI "The "
	GETP CHR,P?XDESC >STACK
	PRINT STACK
?L27:	PRINTR " has left the grounds."
?L21:	GET WHERE-TABLES,0 >STACK
	GET STACK,CN >STACK
	EQUAL? STACK,PRESENT-TIME \?L32
	CALL OUTSIDE?,L >STACK
	ZERO? STACK /?L36
	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK \?L35
?L36:	CALL OUTSIDE?,L >STACK
	ZERO? STACK \?L33
	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK \?L33
?L35:	CALL GOTO,L >STACK
	RSTACK
?L33:	PRINTI "You seem to have lost track of "
	FSET? CHR,TOUCHBIT \?L40
	PRINTD PRSO
	PRINTR "."
?L40:	PRINTI "the "
	GETP CHR,P?XDESC >STACK
	PRINT STACK
	PRINTR "."
?L32:	GETP HERE,P?CORRIDOR >COR
	ZERO? COR /?L47
	GETP L,P?CORRIDOR >PCOR
	ZERO? PCOR /?L47
	BAND COR,PCOR >STACK
	ZERO? STACK /?L47
	CALL COR-DIR,HERE,L >PRSO
	CALL V-WALK >STACK
	RSTACK
?L47:	PRINTI "You seem to have lost track of "
	FSET? CHR,TOUCHBIT \?L51
	PRINTD PRSO
	PRINTR "."
?L51:	PRINTI "the "
	GETP CHR,P?XDESC >STACK
	PRINT STACK
	PRINTR "."

	.FUNCT PRE-GIVE
	EQUAL? PRSO,OFFICE-BACK-DOOR /FALSE
	CALL HELD?,PRSO >STACK
	ZERO? STACK \FALSE
	EQUAL? PRSI,PLAYER /FALSE
	PRINTR "That's easy for you to say, since you don't even have it."

	.FUNCT V-GIVE
	FSET? PRSI,PERSON /?L1
	PRINTI "You can't give "
	FSET? PRSO,PERSON /?L11
	EQUAL? PRSO,GLOBAL-DUFFY /?L11
	FSET? PRSO,AN \?L8
	PRINTI "an "
	JUMP ?L11
?L8:	PRINTI "a "
?L11:	PRINTD PRSO
	PRINTI " to "
	FSET? PRSI,AN \?L16
	PUSH STR?18
	JUMP ?L18
?L16:	PUSH STR?19
?L18:	PRINT STACK
	PRINTD PRSI
	PRINTR "!"
?L1:	PRINTD PRSI
	PRINTR " refuses your offer."

	.FUNCT PRE-SGIVE
	CALL PERFORM,V?GIVE,PRSI,PRSO
	RTRUE

	.FUNCT V-SGIVE
	PRINTR "[Foo!! This is a bug!!]"

	.FUNCT V-GOODBYE
	CALL V-HELLO,0 >STACK
	RSTACK

	.FUNCT V-HANDCUFF
	IN? HANDCUFFS,PLAYER \?L1
	CALL PERFORM,V?TIE-WITH,PRSO,HANDCUFFS
	RTRUE
?L1:	PRINTI "You don't have the "
	PRINTD HANDCUFFS
	PRINTR "."

	.FUNCT V-HELLO,HELL=1,P
	SET 'P,PRSO
	ZERO? P \?L27
	SET 'P,QCONTEXT
	ZERO? P \?L27
	CALL FIND-FLAG,HERE,PERSON,WINNER >P
	ZERO? P /?L1
?L27:	FSET? P,PERSON \?L6
	ZERO? HELL /?L8
	FSET P,TOUCHBIT
	PRINTD P
	PRINTR " nods at you."
?L8:	PRINTR """Don't tell me you're leaving already!"""
?L6:	PRINTI "Only nuts say """
	ZERO? HELL /?L18
	PUSH STR?41
	JUMP ?L20
?L18:	PUSH STR?42
?L20:	PRINT STACK
	PRINTI """ to "
	FSET? P,AN \?L21
	PUSH STR?18
	JUMP ?L23
?L21:	PUSH STR?19
?L23:	PRINT STACK
	PRINTD P
	PRINTR "."
?L1:	PRINTR "It's not clear who you're talking to."

	.FUNCT V-HELP
	ZERO? PRSO \?L1
	PRINTI "(You'll find plenty of help in your instruction manual."
	CRLF
	PRINTR "If you really need help, you can order an InvisiClues Hint Booklet and a complete map by using the order form that came in your package.)"
?L1:	EQUAL? PRSO,PLAYER \?L5
	CALL PERFORM,V?GIVE,HINT,PLAYER
	RTRUE
?L5:	PRINTR "You'll have to be more specific."

	.FUNCT V-HIDE
	EQUAL? HERE,OFFICE \?L1
	PRINTR "You could hide behind the lounge."
?L1:	PRINTR "There's no good hiding place here."

	.FUNCT V-HIDE-BEHIND
	CALL FIND-FLAG,HERE,PERSON,WINNER >STACK
	ZERO? STACK /?L1
	PRINTR "You can't hide when people are watching you!"
?L1:	EQUAL? PRSO,LOUNGE \?L5
	SET 'PLAYER-HIDING,PRSO
	PRINTR "Okeh, you're now crouching down behind the lounge.[RWD_ID: verbs:1285, VAL: 1]"
?L5:	PRINTI "There's no room to hide behind"
	CALL THE-PRSO-PRINT
	PRINTR "."

	.FUNCT V-KICK,?TMP
	FSET? PRSO,PERSON \?L1
	PRINTI """I get no "
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?43,STACK
	CALL VERB-PRINT
	PRINTR " from shampoo..."" -- Cole Flathead"
?L1:	CALL IS-PERSON? >?TMP
	ZERO? ?TMP /?L9
	PUSH ?TMP
	JUMP ?L8
?L9:	CALL IS-OBJ-PROP-ANIMAL? >STACK
?L8:	CALL PRINT-ID,STR?44,STACK
	CALL HACK-HACK,STR?45 >STACK
	RSTACK

	.FUNCT V-KILL
	CALL IKILL,STR?46 >STACK
	RSTACK

	.FUNCT IKILL,STR
	ZERO? PRSO \?L1
	PRINTI "There's nothing here to "
	PRINT STR
	PRINTR "."
?L1:	ZERO? PRSI \?L5
	FSET? PRSO,WEAPONBIT \?L5
	PRINTI "You didn't say what to "
	PRINT STR
	PRINTR " at."
?L5:	EQUAL? PRSO,WORKSHOP-DOOR,GARAGE-DOOR,FRONT-DOOR \?L8
	PRINTI "There must be an easier way to do what you want."
	CRLF
	CALL PRINT-ID,STR?47 >STACK
	RSTACK
?L8:	FSET? PRSO,DOORBIT \?L11
	FSET PRSO,RMUNGBIT
	PRINTI "Hey, this isn't a "
	PRINT STR
	PRINTI "-em-up Western!"
	PRINTI " You just broke the lock beyond repair."
	CRLF
	CALL PRINT-ID,STR?48 >STACK
	RSTACK
?L11:	FSET? PRSO,PERSON /?L14
	PRINTI "Sure, you probably need to sharpen your eye, but "
	FSET? PRSO,AN \?L17
	PUSH STR?18
	JUMP ?L19
?L17:	PUSH STR?19
?L19:	PRINT STACK
	PRINTD PRSO
	PRINTR " is a lousy target."
?L14:	ZERO? PRSI \?L20
	RANDOM 100 >STACK
	GRTR? 50,STACK \?L21
	PRINTI "You think it over. It's not worth the trouble."
	CRLF
	CALL PRINT-ID,STR?49 >STACK
	RSTACK
?L21:	PRINTI "With your expert ability, you "
	PRINT STR
	CALL PRSO-PRINT
	PRINTI " in no time."
	CRLF
	CALL PRINT-ID,STR?50
	CALL GONE-CRAZY >STACK
	RSTACK
?L20:	EQUAL? PRSI,PISTOL,INSIDE-GUN,OUTSIDE-GUN \?L28
	RANDOM 100 >STACK
	GRTR? 50,STACK \?L29
	PRINTI "You think it over. It's not worth the trouble."
	CRLF
	CALL PRINT-ID,STR?51 >STACK
	RSTACK
?L29:	PRINTI "A shot rings out and"
	CALL PRSO-PRINT
	PRINTI " crumples to the ground, dead. Good shot."
	CRLF
	CALL PRINT-ID,STR?52
	CALL GONE-CRAZY >STACK
	RSTACK
?L28:	RANDOM 100 >STACK
	GRTR? 50,STACK \?L36
	PRINTI "You think it over. It's not worth the trouble."
	CRLF
	CALL PRINT-ID,STR?53 >STACK
	RSTACK
?L36:	PRINTI "With a lethal blow of"
	CALL THE-PRSI-PRINT
	PRINTI ","
	CALL PRSO-PRINT
	PRINTI " falls dead."
	CRLF
	CALL PRINT-ID,STR?54
	CALL GONE-CRAZY >STACK
	RSTACK

	.FUNCT V-KISS
	FSET? PRSO,PERSON \?L1
	PRINTI "Section 204D, Paragraph 7.6 of the California Police Code of Conduct specifically prohibits kissing potential suspects or witnesses."
	CRLF
	CALL PRINT-ID,STR?55 >STACK
	RSTACK
?L1:	PRINTR "What a (ahem!) strange idea!"

	.FUNCT V-KNOCK
	FSET? PRSO,DOORBIT /?L35
	FSET? PRSO,WINDOWBIT \?L1
	FSET? PRSO,DOORBIT \?L6
?L35:	CALL DOOR-ROOM,HERE,PRSO >STACK
	JUMP ?L8
?L6:	CALL WINDOW-ROOM,HERE,PRSO >STACK
?L8:	CALL INHABITED?,STACK >STACK
	ZERO? STACK /?L4
	PRINTI "Someone"
	ZERO? TOO-LATE /?L11
	PRINTR " shouts ""Go away!"""
?L11:	PRINTR " shouts ""Go to the front door!"""
?L4:	PRINTR "There's no answer."
?L1:	PRINTI "Why knock on "
	FSET? PRSO,PERSON /?L30
	EQUAL? PRSO,GLOBAL-DUFFY /?L30
	FSET? PRSO,AN \?L27
	PRINTI "an "
	JUMP ?L30
?L27:	PRINTI "a "
?L30:	PRINTD PRSO
	PRINTR "?"

	.FUNCT V-LEAN
	PRINTI "You can't do that!"
	CRLF
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?56,STACK >STACK
	RSTACK

	.FUNCT V-STAND,P
	ZERO? PLAYER-HIDING /?L1
	PRINTI "You are no longer hiding behind"
	CALL THE?,PLAYER-HIDING
	PRINTI " "
	PRINTD PLAYER-HIDING
	PRINTI "."
	CRLF
	SET 'PLAYER-HIDING,0
	CALL INHABITED?,HERE >STACK
	ZERO? STACK /TRUE
	CALL FIND-FLAG,HERE,PERSON >P
	PRINTD P
	PRINTI " looks startled to find you here."
	CRLF
	CALL PRINT-ID,STR?57
	RTRUE
?L1:	LOC WINNER >STACK
	FSET? STACK,SURFACEBIT /?L13
	LOC WINNER >STACK
	FSET? STACK,FURNITURE \?L12
?L13:	MOVE WINNER,HERE
	SET 'PLAYER-HIDING,0
	PRINTR "You are on your own feet again."
?L12:	PRINTR "You're already standing up!"

	.FUNCT V-LEAVE
	CALL PERFORM,V?WALK,P?OUT >STACK
	RSTACK

	.FUNCT V-LISTEN
	CALL CAN-HEAR-RECORD? >STACK
	ZERO? STACK /?L1
	PRINTI "Through the door you can hear a "
	PRINTI "record"
	PRINTR " playing."
?L1:	CALL CAN-HEAR-RADIO? >STACK
	ZERO? STACK /?L5
	PRINTI "Through the door you can hear a "
	PRINTI "radio"
	PRINTR " playing."
?L5:	PRINTI "Too bad, but"
	CALL THE-PRSO-PRINT
	PRINTR " makes no sound."

	.FUNCT V-LOCK
	FSET? PRSO,CONTBIT /?L1
	FSET? PRSO,DOORBIT /?L6
	PRINTI "You'd have to be more clever to do that to"
	CALL THE-PRSO-PRINT
	PRINTR "."
?L1:	FSET? PRSO,DOORBIT /?L6
	GETP PRSO,P?CAPACITY >STACK
	ZERO? STACK /?L5
?L6:	FSET? PRSO,OPENBIT \?L7
	PRINTR "You'll have to close it first."
?L7:	FSET? PRSO,LOCKED \?L11
	PRINTR "It's already locked."
?L11:	FSET? PRSO,RMUNGBIT \?L14
	PRINTR "You can't lock it. The lock is broken."
?L14:	FSET PRSO,LOCKED
	PRINTI "Okeh,"
	CALL THE-PRSO-PRINT
	PRINTR " is now locked."
?L5:	PRINTI "You can't lock"
	CALL THE-PRSO-PRINT
	PRINTR "."

	.FUNCT V-LOOK
	CALL DESCRIBE-ROOM,1 >STACK
	ZERO? STACK /FALSE
	CALL DESCRIBE-OBJECTS,1 >STACK
	RSTACK

	.FUNCT V-LOOK-BEHIND
	PRINTI "There's nothing behind "
	FSET? PRSO,PERSON \?L3
	PRINTD PRSO
	JUMP ?L7
?L3:	PRINTI "the"
	CALL PRSO-PRINT
?L7:	PRINTR "."

	.FUNCT V-LOOK-DOWN
	EQUAL? PRSO,ROOMS \?L1
	GETP HERE,P?LINE >STACK
	EQUAL? STACK,OUTSIDE-LINE-C \?L3
	PRINTI "There's "
	CALL GROUND-SURFACE >STACK
	PRINT STACK
	PRINTR " there, mostly."
?L3:	PRINTR "Nothing's interesting about the floor."
?L1:	PRINTR "It has been a long week, hasn't it?"

	.FUNCT PRE-LOOK-INSIDE
	CALL ROOM-CHECK >STACK
	RSTACK

	.FUNCT V-LOOK-INSIDE,DIR=P?IN,RM
	EQUAL? PRSO,GLOBAL-ROOM \?L1
	CALL PERFORM,V?LOOK
	RTRUE
?L1:	FSET? PRSO,RLANDBIT \?L3
	CALL ROOM-PEEK,PRSO >STACK
	RSTACK
?L3:	FSET? PRSO,DOORBIT \?L4
	FSET? PRSO,OPENBIT \?L5
	CALL DOOR-ROOM,HERE,PRSO >RM
	ZERO? RM /?L7
	CALL ROOM-PEEK,RM >STACK
	RSTACK
?L7:	PRINTI "The "
	PRINTD PRSO
	PRINTR " is open, but you can't tell what's beyond it."
?L5:	PRINTI "Too bad, but"
	CALL THE-PRSO-PRINT
	PRINTR " is closed."
?L4:	FSET? PRSO,WINDOWBIT \?L15
	CALL WINDOW-ROOM,HERE,PRSO >RM
	ZERO? RM /?L16
	CALL ROOM-PEEK,RM >STACK
	RSTACK
?L16:	PRINTI "You can't tell what's beyond"
	CALL THE-PRSO-PRINT
	PRINTR "."
?L15:	FSET? PRSO,CONTBIT \?L21
	CALL SEE-INSIDE?,PRSO >STACK
	ZERO? STACK /?L22
	FIRST? PRSO >STACK \?L24
	CALL PRINT-CONT,PRSO >STACK
	ZERO? STACK \TRUE
?L24:	FSET? PRSO,SURFACEBIT \?L26
	PRINTI "There's nothing on"
	CALL THE-PRSO-PRINT
	PRINTR "."
?L26:	PRINTI "Too bad, but"
	CALL THE-PRSO-PRINT
	PRINTR " is empty."
?L22:	PRINTI "Too bad, but"
	CALL THE-PRSO-PRINT
	PRINTR " is closed."
?L21:	FSET? PRSO,PERSON \?L35
	PRINTR "You forgot to bring your X-ray glasses."
?L35:	EQUAL? DIR,P?IN \?L38
	PRINTI "You can't look inside"
	CALL THE-PRSO-PRINT
	PRINTR "."
?L38:	EQUAL? DIR,P?OUT \FALSE
	PRINTI "You can't look outside"
	CALL THE-PRSO-PRINT
	PRINTR "."

	.FUNCT ROOM-PEEK,RM,OHERE?1
	SET 'OHERE?1,HERE
	CALL SEE-INTO?,RM >STACK
	ZERO? STACK /FALSE
	SET 'HERE,RM
	PRINTI "You take a quick peek into"
	CALL THE?,RM
	PRINTI " "
	PRINTD RM
	PRINTI ":"
	CRLF
	CALL DESCRIBE-OBJECTS,1 >STACK
	ZERO? STACK \?L7
	PRINTI "You can't see anything interesting."
	CRLF
?L7:	SET 'HERE,OHERE?1
	RETURN HERE

	.FUNCT SEE-INTO?,THERE,P,L,TBL,O
	SET 'P,0
?L1:	NEXTP HERE,P >P
	ZERO? P \?L3
	PRINTI "You can't seem to find that room."
	CRLF
	RFALSE
?L3:	EQUAL? P,P?IN,P?OUT /?L1
	LESS? P,P?OUT /?L1
	GETPT HERE,P >TBL
	PTSIZE TBL >L
	EQUAL? L,UEXIT \?L9
	GETB TBL,REXIT >STACK
	EQUAL? STACK,THERE /TRUE
?L9:	EQUAL? L,DEXIT \?L11
	GETB TBL,REXIT >STACK
	EQUAL? STACK,THERE \?L11
	GETB TBL,DEXITOBJ >STACK
	FSET? STACK,OPENBIT /TRUE
	PRINTI "The door to that room is closed."
	CRLF
	RFALSE
?L11:	EQUAL? L,CEXIT \?L1
	GETB TBL,REXIT >STACK
	EQUAL? STACK,THERE \?L1
	GETB TBL,CEXITFLAG >STACK
	VALUE STACK >STACK
	ZERO? STACK \TRUE
	PRINTI "You can't seem to find that room."
	CRLF
	RFALSE

	.FUNCT V-LOOK-ON
	FSET? PRSO,SURFACEBIT \?L1
	CALL V-LOOK-INSIDE >STACK
	RSTACK
?L1:	PRINTI "There's no good surface on"
	CALL THE-PRSO-PRINT
	PRINTR "."

	.FUNCT V-LOOK-OUTSIDE
	CALL V-LOOK-INSIDE,P?OUT >STACK
	RSTACK

	.FUNCT V-LOOK-UNDER
	FSET? PRSO,FURNITURE \?L1
	PRINTI "You twist your head to look under"
	CALL THE-PRSO-PRINT
	PRINTR " but find nothing."
?L1:	FSET? PRSO,PERSON \?L5
	PRINTI "Nope. Nothing hiding under "
	PRINTD PRSO
	PRINTR "."
?L5:	LOC PRSO >STACK
	EQUAL? STACK,HERE,LOCAL-GLOBALS,GLOBAL-OBJECTS \?L8
	PRINTR "There's nothing there but dust."
?L8:	PRINTR "That's not a bit useful."

	.FUNCT V-LOOK-UP
	FSET? PRSO,PERSON \?L1
	CALL TANDY? >STACK
	ZERO? STACK /?L3
	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE
?L3:	PRINTI "What a pervert!"
	CRLF
	CALL PRINT-ID,STR?58 >STACK
	RSTACK
?L1:	EQUAL? PRSO,ROOMS /?L10
	PRINTR "It has been a long week, hasn't it?"
?L10:	GETP HERE,P?LINE >STACK
	EQUAL? STACK,OUTSIDE-LINE-C \?L13
	PRINT SKY-DESC
	CRLF
	RTRUE
?L13:	PRINTR "You can see the ceiling. It's not Union Station, but it's nicely painted."

	.FUNCT V-MAKE
	PRINTR """Eat, drink, and make merry, for tomorrow we shall die!"""

	.FUNCT PRE-MOVE
	CALL HELD?,PRSO >STACK
	ZERO? STACK /FALSE
	PRINTR "Juggling isn't one of your talents."

	.FUNCT V-MOVE
	FSET? PRSO,TAKEBIT \?L1
	PRINTI "Moving"
	CALL THE-PRSO-PRINT
	PRINTR " reveals nothing."
?L1:	PRINTI "You can't move"
	CALL THE-PRSO-PRINT
	PRINTR "."

	.FUNCT V-OPEN,F,STR
	FSET? PRSO,CONTBIT /?L1
	FSET? PRSO,DOORBIT /?L6
	FSET? PRSO,WINDOWBIT /?L1
	PRINTI "You'd have to be more clever to do that to"
	CALL THE-PRSO-PRINT
	PRINTR "."
?L1:	FSET? PRSO,DOORBIT /?L6
	FSET? PRSO,WINDOWBIT /?L6
	GETP PRSO,P?CAPACITY >STACK
	ZERO? STACK /?L5
?L6:	FSET? PRSO,OPENBIT \?L7
	PRINTR "It's already open."
?L7:	FSET? PRSO,LOCKED \?L11
	PRINTR "You'll have to unlock it first."
?L11:	FSET? PRSO,RMUNGBIT \?L14
	PRINTR "You can't open it. The latch is broken."
?L14:	FSET PRSO,OPENBIT
	FSET? PRSO,DOORBIT /?L20
	FSET? PRSO,WINDOWBIT \?L18
?L20:	PRINTI "Okeh,"
	CALL THE-PRSO-PRINT
	PRINTR " is now open."
?L18:	FIRST? PRSO >STACK \?L24
	FSET? PRSO,TRANSBIT \?L23
?L24:	PRINTR "Opened."
?L23:	FIRST? PRSO >F \?L27
	NEXT? F >STACK /?L27
	GETP F,P?FDESC >STR
	ZERO? STR /?L27
	PRINTI "You open"
	CALL THE-PRSO-PRINT
	PRINTI "."
	CRLF
	PRINT STR
	CRLF
	RTRUE
?L27:	PRINTI "You open"
	CALL THE-PRSO-PRINT
	PRINTI " and see "
	CALL PRINT-CONTENTS,PRSO
	PRINTR "."
?L5:	PRINTI "You can't open"
	CALL THE-PRSO-PRINT
	PRINTR "."

	.FUNCT V-PICK
	PRINTR "You can't pick that."

	.FUNCT V-PLAY
	PRINTR "(Speaking of playing, you ought to try Infocom's other products.)"

	.FUNCT V-PUSH,?TMP
	CALL IS-PERSON? >?TMP
	ZERO? ?TMP /?L2
	PUSH ?TMP
	JUMP ?L1
?L2:	CALL IS-ANIMAL? >STACK
?L1:	CALL PRINT-ID,STR?59,STACK
	CALL HACK-HACK,STR?60 >STACK
	RSTACK

	.FUNCT V-PUT-UNDER
	PRINTR "There's not enough room."

	.FUNCT PRE-PUT
	EQUAL? PRSO,HANDCUFFS \?L1
	CALL PERFORM,V?TIE-WITH,PRSI,HANDCUFFS
	RTRUE
?L1:	IN? PRSO,GLOBAL-OBJECTS /?L4
	FSET? PRSO,TAKEBIT /FALSE
?L4:	PRINTR "That would be a mistake."

	.FUNCT V-PUT,?TMP
	FSET? PRSI,OPENBIT /?L10
	FSET? PRSI,DOORBIT /?L7
	FSET? PRSI,CONTBIT /?L7
	FSET? PRSI,VEHBIT /?L7
	EQUAL? PRSI,BACK-FOOTPRINTS,SIDE-FOOTPRINTS \?L4
	PRINTI "You could mess up valuable evidence that way."
	CRLF
	CALL PRINT-ID,STR?61
	RTRUE
?L4:	PRINTR "You can't do that."
?L7:	FSET? PRSI,OPENBIT /?L10
	PRINTI "Too bad, but"
	CALL THE-PRSI-PRINT
	PRINTR " isn't open."
?L10:	EQUAL? PRSI,PRSO \?L14
	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CRLF
	RTRUE
?L14:	IN? PRSO,PRSI \?L17
	PRINTI "Too bad, but"
	CALL THE-PRSO-PRINT
	PRINTI " is already in"
	CALL THE-PRSI-PRINT
	PRINTR "."
?L17:	CALL WEIGHT,PRSI >?TMP
	CALL WEIGHT,PRSO >STACK
	ADD ?TMP,STACK >?TMP
	GETP PRSI,P?SIZE >STACK
	SUB ?TMP,STACK >?TMP
	GETP PRSI,P?CAPACITY >STACK
	GRTR? ?TMP,STACK \?L20
	PRINTR "There's no room."
?L20:	CALL HELD?,PRSO >STACK
	ZERO? STACK \?L23
	CALL ITAKE >STACK
	ZERO? STACK /TRUE
?L23:	MOVE PRSO,PRSI
	FSET PRSO,TOUCHBIT
	PRINTR "Okeh."

	.FUNCT V-RAISE
	CALL HACK-HACK,STR?62 >STACK
	RSTACK

	.FUNCT V-RAPE
	FSET? PRSO,PERSON \?L1
	RANDOM 100 >STACK
	GRTR? 75,STACK \?L3
	PRINTI "Section 29A of the United States Criminal Code, whose provisions come to your unhealthy mind, forbids it."
	CRLF
	CALL PRINT-ID,STR?63 >STACK
	RSTACK
?L3:	CALL GONE-CRAZY >STACK
	RSTACK
?L1:	PRINTI "What a (ahem!) strange idea!"
	CRLF
	CALL IS-ANIMAL? >STACK
	CALL PRINT-ID,STR?64,STACK >STACK
	RSTACK

	.FUNCT PRE-READ,VAL
	ZERO? LIT \?L1
	PRINTR "It's impossible to read in the dark."
?L1:	IN? PRSO,GLOBAL-OBJECTS \?L5
	CALL NOT-HERE,PRSO >STACK
	RSTACK
?L5:	ZERO? PRSI /?L6
	FSET? PRSI,TRANSBIT /?L6
	EQUAL? PRSI,INTNUM /?L6
	PRINTI "You must have a swell method of looking through"
	CALL THE-PRSI-PRINT
	PRINTR "."
?L6:	EQUAL? P-ADVERB,W?CAREFULLY \FALSE
	CALL INT-WAIT,3 >VAL
	ZERO? VAL \?L10
	PRINTI "You never got to finish reading"
	CALL THE-PRSO-PRINT
	PRINTR "."
?L10:	EQUAL? VAL,M-FATAL /TRUE
	RFALSE

	.FUNCT V-READ
	FSET? PRSO,READBIT /?L1
	PRINTI "You can't read"
	CALL THE-PRSO-PRINT
	PRINTR "."
?L1:	GETP PRSO,P?TEXT >STACK
	PRINT STACK
	CRLF
	RTRUE

	.FUNCT V-REVIVE
	FSET? PRSO,PERSON \?L1
	PRINTD PRSO
	PRINTR " doesn't need reviving."
?L1:	CALL HACK-HACK,STR?65 >STACK
	RSTACK

	.FUNCT V-RING
	PRINTR """DING-DONG!"""

	.FUNCT V-RUB
	CALL IS-PERSON? >STACK
	CALL PRINT-ID,STR?66,STACK
	CALL HACK-HACK,STR?67 >STACK
	RSTACK

	.FUNCT PRE-RUB-OVER
	CALL PERFORM,V?RUB,PRSI,PRSO
	RTRUE

	.FUNCT V-RUB-OVER
	PRINTR "You really can't expect that to help."

	.FUNCT V-SAY,V
	SET 'QUOTE-FLAG,0
	SET 'P-CONT,0
	PRINTR "To talk to someone, try 'SAY TO someone ""something""'."

	.FUNCT PRE-SEARCH
	CALL ROOM-CHECK >STACK
	RSTACK

	.FUNCT V-SEARCH
	FSET? PRSO,PERSON \?L1
	PRINTD PRSO
	PRINTR " grudgingly allows you to search. You find nothing whatsoever of interest."
?L1:	FSET? PRSO,CONTBIT \?L5
	FSET? PRSO,OPENBIT /?L5
	PRINTR "You'll have to open it first."
?L5:	PRINTR "You find nothing unusual."

	.FUNCT PRE-SEARCH-OBJECT-FOR,OBJ
	CALL ROOM-CHECK >STACK
	ZERO? STACK \TRUE
	IN? PRSI,PLAYER \?L3
	GETP PRSI,P?GENERIC >STACK
	ZERO? STACK /?L3
	GETP PRSI,P?GENERIC >STACK
	CALL STACK,PRSI >OBJ
	ZERO? OBJ /?L3
	SET 'PRSI,OBJ
?L3:	EQUAL? PRSO,GLOBAL-HERE,GLOBAL-ROOM \FALSE
	SET 'PRSO,HERE
	RFALSE

	.FUNCT V-SEARCH-OBJECT-FOR
	EQUAL? PRSI,MONEY \?L1
	FSET? PRSO,PERSON \?L5
	CALL SAID-TO,PRSO
	PRINTR "You can find only pocket change. ""I could have told you that."""
?L1:	FSET? PRSO,PERSON \?L5
	PRINTD PRSO
	PRINTI " resignedly allows you to perform the search."
	CRLF
	IN? PRSI,PRSO \?L8
	PRINTI "Indeed, "
	PRINTD PRSO
	PRINTI " has"
	CALL THE-PRSI-PRINT
	PRINTR "."
?L8:	IN? PRSI,GLOBAL-OBJECTS \?L12
	PRINTD PRSO
	PRINTI " doesn't have "
	FSET? PRSI,PERSON /?L21
	EQUAL? PRSI,GLOBAL-DUFFY /?L21
	FSET? PRSI,AN \?L18
	PRINTI "an "
	JUMP ?L21
?L18:	PRINTI "a "
?L21:	PRINTD PRSI
	PRINTR "."
?L12:	PRINTD PRSO
	PRINTI " doesn't have"
	CALL THE-PRSI-PRINT
	PRINTR "."
?L5:	FSET? PRSO,CONTBIT \?L29
	FSET? PRSO,OPENBIT /?L29
	PRINTI "You'll have to open"
	CALL THE-PRSO-PRINT
	PRINTR " first."
?L29:	IN? PRSI,PRSO \?L32
	PRINTI "How observant you are! There "
	FSET? PRSI,FEMALE \?L35
	PUSH STR?4
	JUMP ?L38
?L35:	FSET? PRSI,PERSON \?L37
	PUSH STR?2
	JUMP ?L38
?L37:	PUSH STR?26
?L38:	PRINT STACK
	PRINTR " is!"
?L32:	PRINTI "You don't find"
	CALL THE-PRSI-PRINT
	PRINTR " there."

	.FUNCT V-SHOOT
	CALL FIND-FLAG,WINNER,WEAPONBIT >STACK
	ZERO? STACK \?L1
	PRINTR "You don't have anything to shoot with."
?L1:	CALL IKILL,STR?68 >STACK
	RSTACK

	.FUNCT PRE-SSHOOT
	CALL PERFORM,V?SHOOT,PRSI,PRSO
	RTRUE

	.FUNCT V-SSHOOT
	PRINTR "[Foo!! This is a bug!!]"

	.FUNCT V-SHOW
	EQUAL? PRSO,PLAYER \?L1
	PRINTR "Do you often talk to yourself?"
?L1:	FSET? PRSO,PERSON /?L5
	PRINTI "Don't wait for"
	CALL THE-PRSO-PRINT
	PRINTR " to applaud."
?L5:	PRINTD PRSO
	CALL PICK-ONE,WHO-CARES >STACK
	PRINT STACK
	PRINTR "."

	.FUNCT PRE-SSHOW
	SET 'P-MERGED,1
	CALL PERFORM,V?SHOW,PRSI,PRSO
	RTRUE

	.FUNCT V-SSHOW
	RTRUE

	.FUNCT V-SIT
	FSET? PRSO,FURNITURE \?L1
	FSET? PRSO,VEHBIT \?L1
	MOVE PLAYER,PRSO
	SET 'PLAYER-HIDING,0
	PRINTI "You are now sitting on"
	CALL THE-PRSO-PRINT
	PRINTR "."
?L1:	PRINTI "That isn't something to sit on!"
	CRLF
	FSET? PRSO,FURNITURE /?L8
	PUSH 0
	JUMP ?L9
?L8:	PUSH 1
?L9:	CALL PRINT-ID,STR?69,STACK >STACK
	RSTACK

	.FUNCT V-SLAP
	FSET? PRSO,PERSON \?L1
	PRINTD PRSO
	PRINTI " slaps you right back. Wow, is your face red!"
	CRLF
	CALL PRINT-ID,STR?70 >STACK
	RSTACK
?L1:	PRINTI "You should see Phong. He breaks boards with the edge of his hand!"
	CRLF
	CALL IS-ANIMAL? >STACK
	CALL PRINT-ID,STR?71,STACK >STACK
	RSTACK

	.FUNCT V-SMELL
	FSET? PRSO,PERSON \?L1
	FSET? PRSO,FEMALE \?L3
	PRINTI "She"
	JUMP ?L7
?L3:	PRINTI "He"
?L7:	PRINTI " smells just like "
	PRINTD PRSO
	PRINTR "."
?L1:	PRINTI "It"
	PRINTI " smells just like "
	FSET? PRSO,AN \?L15
	PUSH STR?18
	JUMP ?L17
?L15:	PUSH STR?19
?L17:	PRINT STACK
	PRINTD PRSO
	PRINTR "."

	.FUNCT V-SMOKE
	PRINTI "You can't burn"
	CALL THE-PRSO-PRINT
	PRINTR "."

	.FUNCT PRE-TAKE
	EQUAL? PRSO,GLOBAL-WARRANT,HANDCUFFS,GLOBAL-CAN-OF-WORMS /FALSE
	EQUAL? PRSO,CIGARETTE,DRINK,HINT /FALSE
	EQUAL? PRSO,GLOBAL-FINGERPRINTS,BLACK-WIRE,WHITE-WIRE /FALSE
	IN? PRSO,GLOBAL-OBJECTS \?L4
	CALL NOT-HERE,PRSO >STACK
	RSTACK
?L4:	IN? PRSO,WINNER \?L5
	PRINTR "You already have it."
?L5:	LOC PRSO >STACK
	FSET? STACK,CONTBIT \?L8
	LOC PRSO >STACK
	FSET? STACK,OPENBIT /?L8
	PRINTR "You can't reach that."
?L8:	ZERO? PRSI /?L11
	EQUAL? PRSI,LINDER-BACK-DOOR,MONICA-BACK-DOOR,OFFICE-BACK-DOOR /FALSE
	LOC PRSO >STACK
	EQUAL? PRSI,STACK /?L14
	FSET? PRSO,PERSON /?L15
	FSET? PRSI,PERSON /?L17
	PRINTR "It's not in that!"
?L17:	FSET? PRSI,FEMALE \?L21
	PRINTR "She doesn't have it!"
?L21:	PRINTR "He doesn't have it!"
?L15:	FSET? PRSO,FEMALE \?L27
	FSET? PRSI,PERSON /?L28
	PRINTR "She's not in that!"
?L28:	FSET? PRSI,FEMALE \?L32
	PRINTR "She doesn't have her!"
?L32:	PRINTR "He doesn't have her!"
?L27:	FSET? PRSI,PERSON /?L39
	PRINTR "He's not in that!"
?L39:	FSET? PRSI,FEMALE \?L43
	PRINTR "She doesn't have him!"
?L43:	PRINTR "He doesn't have him!"
?L14:	SET 'PRSI,0
	RFALSE
?L11:	LOC WINNER >STACK
	EQUAL? PRSO,STACK \FALSE
	PRINTR "You're in it, nitwit!"

	.FUNCT V-TAKE
	CALL ITAKE >STACK
	EQUAL? STACK,1 \FALSE
	PRINTI "You are now carrying"
	CALL THE-PRSO-PRINT
	PRINTI "."
	CRLF
	CALL IS-THEFT? >STACK
	CALL PRINT-ID,STR?72,STACK >STACK
	RSTACK

	.FUNCT PRE-TAKEOUT
	EQUAL? PRSI,LINDER-BACK-DOOR,MONICA-BACK-DOOR,OFFICE-BACK-DOOR \?L1
	EQUAL? PRSO,CORPSE /FALSE
	FSET? PRSO,PERSON /FALSE
	PRINTR "(If you want to go outside, simply type ""OUT."")"
?L1:	PRINTR "(Sorry, but English is my second language. Please rephrase that.)"

	.FUNCT V-TAKEOUT
	PRINTR "[Foo!! This is a bug!!]"

	.FUNCT V-DISEMBARK
	LOC PRSO >STACK
	EQUAL? STACK,WINNER \?L1
	PRINTI "You don't need to take out"
	CALL THE-PRSO-PRINT
	PRINTR " to use it."
?L1:	LOC WINNER >STACK
	EQUAL? STACK,PRSO /?L5
	PRINTI "You're not in that!"
	CRLF
	RETURN 2
?L5:	PRINTI "You are on your own feet again."
	CRLF
	MOVE WINNER,HERE
	RTRUE

	.FUNCT V-TELL
	EQUAL? PRSO,PLAYER \?L1
	PRINTI "Talking to yourself is a sign of impending looniness."
	CRLF
	SET 'QUOTE-FLAG,0
	SET 'P-CONT,0
	RETURN 2
?L1:	FSET? PRSO,PERSON /?L8
	ZERO? MET-DUFFY? /?L7
	EQUAL? PRSO,GLOBAL-DUFFY \?L7
?L8:	ZERO? P-CONT /?L9
	SET 'WINNER,PRSO
	JUMP ?L11
?L9:	FSET PRSO,TOUCHBIT
	PRINTD PRSO
	PRINTI " is listening."
	CRLF
?L11:	SET 'QCONTEXT,PRSO
	SET 'QCONTEXT-ROOM,HERE
	RETURN QCONTEXT-ROOM
?L7:	PRINTI "You can't talk to"
	CALL THE-PRSO-PRINT
	PRINTI "!"
	CRLF
	SET 'QUOTE-FLAG,0
	SET 'P-CONT,0
	RETURN 2

	.FUNCT PRE-TELL-ME,P,?TMP
	ZERO? QCONTEXT /?L1
	EQUAL? HERE,QCONTEXT-ROOM \?L1
	SET '?TMP,HERE
	CALL META-LOC,QCONTEXT >STACK
	EQUAL? ?TMP,STACK \?L1
	EQUAL? PRSO,PLAYER \FALSE
	CALL PERFORM,V?ASK-ABOUT,QCONTEXT,PRSI
	RTRUE
?L1:	EQUAL? PRSO,PLAYER \FALSE
	CALL FIND-FLAG,HERE,PERSON,WINNER >P
	ZERO? P /FALSE
	CALL PERFORM,V?ASK-ABOUT,P,PRSI
	RTRUE

	.FUNCT V-TELL-ME
	EQUAL? PRSO,PLAYER \?L1
	PRINTR "You aren't talking to anyone!"
?L1:	PRINTD PRSO
	CALL PICK-ONE,WHO-CARES >STACK
	PRINT STACK
	PRINTR "."

	.FUNCT PRE-TELL-ME-ABOUT,P,?TMP
	ZERO? QCONTEXT /?L1
	EQUAL? HERE,QCONTEXT-ROOM \?L1
	SET '?TMP,HERE
	CALL META-LOC,QCONTEXT >STACK
	EQUAL? ?TMP,STACK \?L1
	CALL PERFORM,V?ASK-ABOUT,QCONTEXT,PRSO
	RTRUE
?L1:	CALL FIND-FLAG,HERE,PERSON,WINNER >P
	ZERO? P /FALSE
	CALL PERFORM,V?ASK-ABOUT,P,PRSO
	RTRUE

	.FUNCT V-TELL-ME-ABOUT
	PRINTR "You aren't talking to anyone!"

	.FUNCT V-THANKS,P,?TMP
	ZERO? PRSO /?L4
	FSET? PRSO,PERSON /?L3
?L4:	ZERO? QCONTEXT /?L5
	EQUAL? HERE,QCONTEXT-ROOM \?L5
	SET '?TMP,HERE
	CALL META-LOC,QCONTEXT >STACK
	EQUAL? ?TMP,STACK /?L3
?L5:	CALL FIND-FLAG,HERE,PERSON,WINNER >P
	ZERO? P /?L1
?L3:	ZERO? PRSO /?L9
	PUSH PRSO
	JUMP ?L8
?L9:	ZERO? QCONTEXT /?L10
	PUSH QCONTEXT
	JUMP ?L8
?L10:	PUSH P
?L8:	PRINTD STACK
	PRINTI " acknowledges your thanks."
	CRLF
	CALL PRINT-ID,STR?73 >STACK
	RSTACK
?L1:	PRINTR "You're more than welcome."

	.FUNCT V-THROW
	CALL IDROP >STACK
	ZERO? STACK /FALSE
	PRINTR "Thrown."

	.FUNCT V-THROW-AT
	CALL IDROP >STACK
	ZERO? STACK /TRUE
	FSET? PRSI,PERSON \?L3
	PRINTD PRSI
	PRINTI ", puzzled by your unusual methods, ducks as"
	CALL THE-PRSO-PRINT
	PRINTI " flies by."
	CRLF
	CALL PRINT-ID,STR?74 >STACK
	RSTACK
?L3:	PRINTR "Maybe you aren't feeling well."

	.FUNCT V-THROW-THROUGH
	FSET? PRSO,PERSON /?L1
	PRINTI "Let's not resort to violence, please."
	CRLF
	CALL PRINT-ID,STR?75 >STACK
	RSTACK
?L1:	CALL V-THROW >STACK
	RSTACK

	.FUNCT PRE-TIE-TO
	FSET? PRSO,PERSON \?L3
	FSET? PRSI,FURNITURE /FALSE
?L3:	PRINTR "That won't do any good."

	.FUNCT V-TIE-TO
	PRINTI "You can't tie"
	CALL PRSO-PRINT
	PRINTR " to that."

	.FUNCT PRE-TIE-WITH
	FSET? PRSO,PERSON \?L3
	FSET? PRSI,TOOLBIT /FALSE
?L3:	PRINTR "That won't do any good."

	.FUNCT V-TIE-WITH
	FSET? PRSO,PERSON \?L1
	PRINTI """If you don't formally arrest me first, I'll sue!"""
	CRLF
	CALL PRINT-ID,STR?76 >STACK
	RSTACK
?L1:	PRINTI "You can't "
	EQUAL? PRSI,HANDCUFFS \?L8
	PUSH STR?77
	JUMP ?L10
?L8:	PUSH STR?78
?L10:	PRINT STACK
	CALL PRSO-PRINT
	PRINTR " with that."

	.FUNCT V-TURN
	PRINTR "This has no effect."

	.FUNCT V-LAMP-ON
	EQUAL? PRSO,GLOBAL-WATER,SINK \?L1
	PRINTR "You turn the handle and lo! The water starts to run. Impressed with yourself, you turn the handle again, and the water stops running! You try it again, just to make sure. Bravo!"
?L1:	FSET? PRSO,PERSON \?L5
	CALL PICK-ONE,YUKS >STACK
	PRINT STACK
	CALL PRINT-ID,STR?79 >STACK
	PRINT STACK
	CRLF
	RTRUE
?L5:	PRINTI "You can't turn on"
	CALL THE-PRSO-PRINT
	PRINTR "."

	.FUNCT V-LAMP-OFF
	FSET? PRSO,PERSON \?L1
	PRINTR "Your vulgar ways would turn anyone off."
?L1:	PRINTI "You can't turn off"
	CALL THE-PRSO-PRINT
	PRINTR "."

	.FUNCT V-TURN-UP
	PRINTR "That's silly."

	.FUNCT V-TURN-DOWN
	PRINTR "That's silly."

	.FUNCT PRE-UNLOCK
	EQUAL? PRSO,CLOCK \?L1
	IN? CLOCK-KEY,WINNER /FALSE
	PRINTR "You don't have the right key."
?L1:	ZERO? LINDER-FOLLOWS-YOU /?L8
	PRINTR "Linder says, ""Don't leave yet. We're just getting started."""
?L8:	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK /FALSE
	IN? PHONG-KEYS,WINNER /FALSE
	PRINTR "You don't have the right key."

	.FUNCT V-UNLOCK
	FSET? PRSO,CONTBIT /?L1
	FSET? PRSO,DOORBIT /?L6
	PRINTI "You'd have to be more clever to do that to"
	CALL THE-PRSO-PRINT
	PRINTR "."
?L1:	FSET? PRSO,DOORBIT /?L6
	GETP PRSO,P?CAPACITY >STACK
	ZERO? STACK /?L5
?L6:	FSET? PRSO,OPENBIT \?L7
	PRINTR "You'll have to close it first."
?L7:	FSET? PRSO,LOCKED /?L11
	PRINTR "It's already unlocked."
?L11:	FSET? PRSO,RMUNGBIT \?L14
	PRINTR "You can't unlock it. The lock is broken."
?L14:	FCLEAR PRSO,LOCKED
	PRINTI "Okeh,"
	CALL THE-PRSO-PRINT
	PRINTR " is now unlocked.[RWD_ID: verbs:2021, VAL: 1]"
?L5:	PRINTI "You can't unlock"
	CALL THE-PRSO-PRINT
	PRINTR "."

	.FUNCT V-UNTIE
	PRINTR "You can't tie it, so you can't untie it!"

	.FUNCT V-USE
	PRINTR "You should be more specific about what you want to do."

	.FUNCT V-WAIT,NUM=10,WHO=0,INT?1=0,VAL,HR,RESULT=1
	SET 'HR,HERE
	SET 'WHO-WAIT,0
	ZERO? INT?1 \?L1
	PRINTI "Time passes..."
	CRLF
?L1:	DLESS? 'NUM,0 /?L7
	CALL CLOCKER >VAL
	ZERO? VAL /?L10
	EQUAL? VAL,M-FATAL /?L13
	EQUAL? HR,HERE /?L11
?L13:	SET 'RESULT,M-FATAL
	JUMP ?L7
?L11:	EQUAL? WHO,GLOBAL-DUFFY \?L14
	ZERO? MET-DUFFY? /?L14
	ZERO? FINGERPRINT-OBJ \?L14
	ZERO? DUFFY-AT-CORONER /?L7
?L14:	ZERO? WHO /?L15
	IN? WHO,HERE \?L15
	FSET WHO,TOUCHBIT
	PRINTD WHO
	PRINTI ", for whom you are waiting, has arrived."
	CRLF
	JUMP ?L7
?L15:	INC 'WHO-WAIT
	GETB 0,1 >STACK
	BTST STACK,16 \?L19
	PRINTI "("
	CALL TIME-PRINT,PRESENT-TIME
	PRINTI ") "
?L19:	ZERO? INT?1 /?L26
	PRINTI "Do you want to continue what you were doing?"
	JUMP ?L30
?L26:	PRINTI "Do you want to keep waiting?"
?L30:	CALL YES? >STACK
	ZERO? STACK /?L7
	USL
	JUMP ?L1
?L10:	EQUAL? WHO,GLOBAL-DUFFY \?L36
	ZERO? FINGERPRINT-OBJ \?L36
	ZERO? DUFFY-AT-CORONER /?L7
?L36:	ZERO? WHO /?L40
	IN? WHO,HERE \?L37
	PRINTD WHO
	PRINTI ", for whom you are waiting, has arrived."
	CRLF
	JUMP ?L7
?L37:	ZERO? WHO /?L40
	IGRTR? 'WHO-WAIT,30 \?L40
	PRINTD WHO
	PRINTI " still hasn't arrived. Do you want to keep waiting?"
	CALL YES? >STACK
	ZERO? STACK /?L7
	SET 'WHO-WAIT,0
	USL
	JUMP ?L1
?L40:	USL
	JUMP ?L1
?L7:	SET 'CLOCK-WAIT,1
	ZERO? INT?1 \?L47
	CALL V-TIME
?L47:	RETURN RESULT

	.FUNCT INT-WAIT,N,TIM,REQ,VAL
	SET 'TIM,PRESENT-TIME
	MUL N,2 >STACK
	RANDOM STACK >REQ
	CALL V-WAIT,REQ,0,1 >STACK
	EQUAL? M-FATAL,STACK \?L1
	RETURN 2
?L1:	SUB PRESENT-TIME,TIM >STACK
	LESS? STACK,REQ /FALSE
	RTRUE

	.FUNCT V-WAIT-FOR,WHO
	EQUAL? PRSO,INTNUM \?L1
	GRTR? P-NUMBER,PRESENT-TIME \?L3
	CALL V-WAIT-UNTIL
	RTRUE
?L3:	GRTR? P-NUMBER,180 \?L5
	PRINTR "That's too long to wait."
?L5:	CALL V-WAIT,P-NUMBER >STACK
	RSTACK
?L1:	EQUAL? PRSO,GLOBAL-HERE \?L9
	CALL V-WAIT
	RTRUE
?L9:	EQUAL? PRSO,MIDNIGHT \?L10
	CALL V-WAIT-UNTIL
	RTRUE
?L10:	FSET? PRSO,PERSON \?L11
	GETP PRSO,P?CHARACTER >STACK
	GET CHARACTER-TABLE,STACK >WHO
	IN? WHO,HERE \?L12
	PRINTR "That person's already here!"
?L12:	CALL V-WAIT,10000,WHO >STACK
	RSTACK
?L11:	EQUAL? PRSO,PLAYER \?L17
	PRINTR "You're already here!"
?L17:	PRINTR "Not a good idea. You might wait all night."

	.FUNCT V-WAIT-UNTIL
	EQUAL? PRSO,MIDNIGHT \?L1
	SET 'P-NUMBER,720
	SET 'PRSO,INTNUM
	JUMP ?L4
?L1:	LESS? P-NUMBER,8 \?L3
	ADD P-NUMBER,12 >STACK
	MUL STACK,60 >P-NUMBER
	JUMP ?L4
?L3:	LESS? P-NUMBER,13 \?L4
	MUL P-NUMBER,60 >P-NUMBER
?L4:	EQUAL? PRSO,INTNUM \?L6
	GRTR? P-NUMBER,PRESENT-TIME \?L8
	SUB P-NUMBER,PRESENT-TIME >STACK
	CALL V-WAIT,STACK >STACK
	RSTACK
?L8:	PRINTR "You are clearly ahead of your time."
?L6:	PRINTR "It has been a long week, hasn't it?"

	.FUNCT V-ALARM
	EQUAL? PRSO,CAT \?L1
	PRINTR "The cat yawns, licks its lips, and settles down again."
?L1:	EQUAL? PRSO,MONICA \?L5
	PRINTR "You wouldn't like that."
?L5:	FSET? PRSO,PERSON \?L8
	PRINTR "He's wide awake, or haven't you noticed?"
?L8:	PRINTI "Too bad, but"
	CALL THE-PRSO-PRINT
	PRINTR " isn't asleep."

	.FUNCT V-WALK,PT,PTS,STR,OBJ,RM
	EQUAL? PRSO,GLOBAL-CALL \?L1
	CALL PERFORM,V?TURN,PRSO
	RTRUE
?L1:	ZERO? PRSO \?L3
	PRINTR "You can't go that way."
?L3:	GETPT HERE,PRSO >PT
	ZERO? PT /?L6
	PTSIZE PT >PTS
	EQUAL? PTS,UEXIT \?L7
	GETB PT,REXIT >RM
	CALL GOTO,RM >STACK
	RSTACK
?L7:	EQUAL? PTS,NEXIT \?L9
	GET PT,NEXITSTR >STACK
	PRINT STACK
	CRLF
	RETURN 2
?L9:	EQUAL? PTS,FEXIT \?L14
	GET PT,FEXITFCN >STACK
	CALL STACK >RM
	ZERO? RM /?L15
	CALL GOTO,RM >STACK
	RSTACK
?L15:	RETURN 2
?L14:	EQUAL? PTS,CEXIT \?L20
	GETB PT,CEXITFLAG >STACK
	VALUE STACK >STACK
	ZERO? STACK /?L21
	GETB PT,REXIT >STACK
	CALL GOTO,STACK >STACK
	RSTACK
?L21:	GET PT,CEXITSTR >STR
	ZERO? STR /?L23
	PRINT STR
	CRLF
	RETURN 2
?L23:	PRINTI "You can't go that way."
	CRLF
	RETURN 2
?L20:	EQUAL? PTS,DEXIT \FALSE
	GETB PT,DEXITOBJ >OBJ
	FSET? OBJ,OPENBIT \?L34
	GETB PT,REXIT >STACK
	CALL GOTO,STACK >STACK
	RSTACK
?L34:	FSET? OBJ,INVISIBLE \?L36
	ZERO? DEBUG /?L37
	PRINTI "[invisible] "
	JUMP ?L36
?L37:	PRINTR "You can't go that way."
?L36:	GET PT,DEXITSTR >STR
	ZERO? STR /?L42
	PRINT STR
	CRLF
	RETURN 2
?L42:	PRINTI "Too bad, but"
	CALL THE?,OBJ
	PRINTI " "
	PRINTD OBJ
	PRINTI " is closed."
	CRLF
	SET 'P-IT-LOC,HERE
	SET 'P-IT-OBJECT,OBJ
	RETURN 2
?L6:	EQUAL? PRSO,P?IN \?L55
	PRINTI "(What compass direction do you want to go in?)"
	CRLF
	RETURN 2
?L55:	PRINTI "You can't go that way."
	CRLF
	RETURN 2

	.FUNCT V-WALK-AROUND
	PRINTR "(Use compass directions to move around here.)"

	.FUNCT V-WALK-TO
	CALL META-LOC,PRSO >STACK
	EQUAL? STACK,HERE,LOCAL-GLOBALS /?L3
	FSET? PRSO,DOORBIT /?L3
	FSET? PRSO,WINDOWBIT \?L1
?L3:	PRINTI "You don't need to walk around within a "
	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK /?L6
	PUSH STR?80
	JUMP ?L9
?L6:	GETP HERE,P?CORRIDOR >STACK
	BTST STACK,16 \?L8
	PUSH STR?81
	JUMP ?L9
?L8:	PUSH STR?82
?L9:	PRINT STACK
	CRLF
	RTRUE
?L1:	CALL META-LOC,PRSO >STACK
	IN? STACK,ROOMS \?L10
	CALL META-LOC,PRSO >PRSO
	CALL V-THROUGH >STACK
	RSTACK
?L10:	PRINTR "You can't go from here to there, at least not directly."

	.FUNCT V-RUN-OVER
	PRINTR "That doesn't make much sense."

	.FUNCT V-WHAT,?TMP
	ZERO? QCONTEXT /?L4
	EQUAL? HERE,QCONTEXT-ROOM \?L4
	SET '?TMP,HERE
	CALL META-LOC,QCONTEXT >STACK
	EQUAL? ?TMP,STACK \?L4
	FSET? QCONTEXT,PERSON /?L3
?L4:	CALL FIND-FLAG,HERE,PERSON,WINNER >STACK
	ZERO? STACK /?L1
?L3:	PRINTR """Isn't it obvious?"""
?L1:	FSET? PRSO,PERSON \?L7
	PRINTR "Try asking that person."
?L7:	PRINTR "Are you talking to yourself again?"

	.FUNCT V-YN,?TMP
	ZERO? QCONTEXT /?L1
	EQUAL? HERE,QCONTEXT-ROOM \?L1
	SET '?TMP,HERE
	CALL META-LOC,QCONTEXT >STACK
	EQUAL? ?TMP,STACK \?L1
	PRINTD QCONTEXT
	PRINTR " ignores you completely."
?L1:	PRINTR "That deserves to be ignored."

	.FUNCT PRINT-DESC1,OBJ
	ZERO? OBJ /FALSE
	PRINTD OBJ
	RTRUE

	.FUNCT PRINT-ID,ID,CONDITION=1
	ZERO? CONDITION /FALSE
	PRINTI "[ID: "
	PRINT ID
	PRINTI ", PRSO: "
	CALL PRINT-DESC1,PRSO
	PRINTI ", PRSI: "
	CALL PRINT-DESC1,PRSI
	PRINTI "]"
	RTRUE

	.FUNCT PRINT-DEBUG,TEXT,CONDITION=1
	ZERO? CONDITION /FALSE
	PRINTI "DEBUG FLAG: "
	PRINT TEXT
	RTRUE

	.FUNCT IS-THEFT?
	EQUAL? PRSA,V?TAKE \FALSE
	EQUAL? PRSO,CORPSE,BOURBON,GLASSES /TRUE
	EQUAL? PRSO,LINDER-CAR,MONICA-CAR,SCOTCH /TRUE
	EQUAL? PRSO,MONEY,CHINA,CLOCK /TRUE
	EQUAL? PRSO,GENERIC-CAR,WILL \FALSE
	RTRUE

	.FUNCT IS-OBJECT-OR-PROPERTY?
	EQUAL? PRSO,AUTOPSY,BACK-GATE,BATH-WINDOW /TRUE
	EQUAL? PRSO,BATHTUB,BED,BLACK-WIRE /TRUE
	EQUAL? PRSO,BOOK-CASE,BOURBON,BRASS-LANTERN /TRUE
	EQUAL? PRSO,BROOM,BUTLER-BATH-DOOR,BUTLER-DOOR /TRUE
	EQUAL? PRSO,BUTLER-TABLE,BUTLER-WINDOW,BUTTON /TRUE
	EQUAL? PRSO,CABINET,CAR-WINDOW,CARVED-CHAIR /TRUE
	EQUAL? PRSO,CHAIR,CHINA,CIGARETTE /TRUE
	EQUAL? PRSO,CLOCK,CLOCK-KEY,CLOCK-POWDER /TRUE
	EQUAL? PRSO,CLOCK-WIRES,CLOSET,CLUB-CHAIR /TRUE
	EQUAL? PRSO,COFFEE-TABLE,COLD-FOODS,CORONER /TRUE
	EQUAL? PRSO,CORPSE,DINING-DOOR,DINING-ROOM-BENCH /TRUE
	EQUAL? PRSO,DINING-ROOM-TABLE,DOORBELL,DRINK /TRUE
	EQUAL? PRSO,DRIVEWAY-OBJECT,FENCE,FILE-CABINET /TRUE
	EQUAL? PRSO,FIREPLACE,FLOOR,FLOWER-ARRANGEMENT /TRUE
	EQUAL? PRSO,FOODS,FOUR-POSTER,FRONT-DOOR /TRUE
	EQUAL? PRSO,FRONT-GATE,GARAGE-DOOR,GENERIC-BACK-DOOR /TRUE
	EQUAL? PRSO,GENERIC-BATHROOM,GENERIC-BATHROOM-DOOR,GENERIC-BEDROOM /TRUE
	EQUAL? PRSO,GENERIC-BEDROOM-DOOR,GENERIC-CAR,GENERIC-CAST /TRUE
	EQUAL? PRSO,GENERIC-CHAIR,GENERIC-GREEN-WIRE,GENERIC-GUN /TRUE
	EQUAL? PRSO,GENERIC-KEY,GENERIC-WIRE,GLASSES /TRUE
	EQUAL? PRSO,GLOBAL-FILM,GLOBAL-FINGERPRINTS,GLOBAL-HERE /TRUE
	EQUAL? PRSO,GLOBAL-HOUSE,GLOBAL-PTA,GLOBAL-ROOM /TRUE
	EQUAL? PRSO,GLOBAL-WARRANT,GUN-RECEIPT,HAMMER /TRUE
	EQUAL? PRSO,HANDWRITING,HOE,HOOD /TRUE
	EQUAL? PRSO,HOSE,HOUSE,INSIDE-GUN /TRUE
	EQUAL? PRSO,JUNCTION-BOX,K-CABINETS,K-CLOCK /TRUE
	EQUAL? PRSO,K-CUPBOARD,KEY-HOLE,KITCHEN-DINING-DOOR /TRUE
	EQUAL? PRSO,KITCHEN-GARDEN,KITCHEN-HALL-DOOR,KITCHEN-WINDOW /TRUE
	EQUAL? PRSO,LAMP,LAWN,LINDER-BACK-DOOR /TRUE
	EQUAL? PRSO,LINDER-BATH-DOOR,LINDER-CAR,LINDER-DOOR /TRUE
	EQUAL? PRSO,LINDER-ROOM-STUFF,LINDER-SHOES,LINDER-WINDOW /TRUE
	EQUAL? PRSO,LINENS,LIQUOR-CABINET,LIVING-DINING-DOOR /TRUE
	EQUAL? PRSO,LOUNGE,MASTER-BATH-COUNTER,MASTER-BEDROOM-DRESSER /TRUE
	EQUAL? PRSO,MEDICAL-REPORT,MEDIUM-INTEGER,MIDNIGHT /TRUE
	EQUAL? PRSO,MIRROR,MIXER,MONEY /TRUE
	EQUAL? PRSO,MONICA-BACK-DOOR,MONICA-BATH-DOOR,MONICA-CAR /TRUE
	EQUAL? PRSO,MONICA-DOOR,MONICA-SHOES,MONICA-TABLE /TRUE
	EQUAL? PRSO,MONICA-TABLE-STUFF,MOVIE-POSTERS,MUDDY-SHOES /TRUE
	EQUAL? PRSO,NEWSPAPERS,OFFICE-BACK-DOOR,OFFICE-BUTTON /TRUE
	EQUAL? PRSO,OFFICE-DESK,OFFICE-DESK-STUFF,OFFICE-DOOR /TRUE
	EQUAL? PRSO,OFFICE-PICTURE,OFFICE-WINDOW,OTHER-SHOES /TRUE
	EQUAL? PRSO,OUTSIDE-GUN,PAPERS,PHONG-KEYS /TRUE
	EQUAL? PRSO,PHONG-SHOES,PIECE-OF-PUTTY,PIECE-OF-WIRE /TRUE
	EQUAL? PRSO,POTTED-PLANTS,POWDER,RADIO /TRUE
	EQUAL? PRSO,RAKE,RANDOM-MEAL,RANGE /TRUE
	EQUAL? PRSO,RECORDS,RECURSIVE-BOOK,REFRIGERATOR /TRUE
	EQUAL? PRSO,ROCKS,ROPE,SAW /TRUE
	EQUAL? PRSO,SCOTCH,SCROLL,SHOE-PLATFORM /TRUE
	EQUAL? PRSO,SHOWER,SIDE-FOOTPRINTS,SIDE-FOOTPRINTS-CAST /TRUE
	EQUAL? PRSO,SILVERWARE,SINK,SOFA /TRUE
	EQUAL? PRSO,SPADE,SPOOL-OF-WIRE,STILES-SHOES /TRUE
	EQUAL? PRSO,STORAGE-DOOR,STUB,TELEPHONE /TRUE
	EQUAL? PRSO,THREAT-NOTE,TOASTER,TOILET /TRUE
	EQUAL? PRSO,TOILET-DOOR,TOWELS,TUB-DOOR /TRUE
	EQUAL? PRSO,WHITE-WIRE,WILL,WINDOW /TRUE
	EQUAL? PRSO,WOOD-PILE,WOODEN-CHAIR,WORK-SHELVES /TRUE
	EQUAL? PRSO,WORKSHOP-DOOR,WORKSHOP-WIRE \FALSE
	RTRUE

	.FUNCT IS-FRAGILE?,OBJ
	EQUAL? OBJ,BRASS-LANTERN,FOODS,GLASSES /TRUE
	EQUAL? OBJ,LAMP,MIRROR,SCOTCH /TRUE
	EQUAL? OBJ,BOURBON,TOASTER \FALSE
	RTRUE

	.FUNCT IS-PERSON?
	EQUAL? PRSO,GLOBAL-DUFFY,GLOBAL-LINDER,GLOBAL-MONICA /TRUE
	EQUAL? PRSO,GLOBAL-MRS-LINDER,GLOBAL-PHONG,GLOBAL-STILES /TRUE
	EQUAL? PRSO,GLOBAL-TERRY,HIM-HER,LINDER /TRUE
	EQUAL? PRSO,MONICA,PHONG,STILES \FALSE
	RTRUE

	.FUNCT IS-ANIMAL?
	EQUAL? PRSO,GLOBAL-CAT,CAT \FALSE
	RTRUE

	.FUNCT IS-SELF?
	EQUAL? PRSO,PLAYER \FALSE
	RTRUE

	.FUNCT IS-YOUR-PROPERTY?
	EQUAL? PRSO,TELEGRAM,MATCHBOOK,PISTOL /TRUE
	EQUAL? PRSO,HANDCUFFS \FALSE
	RTRUE

	.FUNCT DANGEROUS-FOOD?
	CALL IS-OBJECT-OR-PROPERTY? >STACK
	ZERO? STACK \?L2
	EQUAL? PRSO,BROKEN-GLASS,FIRE \FALSE
?L2:	FSET? PRSO,FOODBIT \TRUE
	RFALSE

	.FUNCT IS-OBJ-PROP-ANIMAL?,?TMP
	CALL IS-OBJECT-OR-PROPERTY? >?TMP
	ZERO? ?TMP /?L2
	RETURN ?TMP
?L2:	CALL IS-ANIMAL? >STACK
	RSTACK

	.FUNCT INTRO
	PRINTI "Somewhere near Los Angeles. A cold Friday evening in February 1938. In this climate, cold is anywhere below about fifty degrees. Storm clouds are swimming across the sky, their bottoms glowing faintly from the city lights in the distance. A search light pans slowly under the clouds, heralding another film premiere. The air seems expectant, waiting for the rain to begin, like a cat waiting for the ineffable moment to ambush.
"
	CRLF
	PRINTR "The taxi has just dropped you off at the entrance to the Linders' driveway. The driver didn't seem to like venturing into this maze of twisty streets any more than you did. But the house windows are full of light, and radio music drifts toward you. Your favorite pistol, a snub-nosed Colt .32, is snug in its holster. You just picked up a match book off the curb. It might come in handy. Good thing you looked up the police file on Mrs. Linder's death. Her suicide note and the newspaper story told you all you know about the family. The long week is finished, except for this appointment. But why does an ominous feeling grip you?
"

	.FUNCT TIMES-UP
	PRINTI "Police Chief Klutz walks up to you, from out of nowhere. ""I'm sorry, Detective, but you can't spend any more time here. We need you at the Coliseum for the all-day Police Department track-and-field meet. I hope you had a restful night!"" He escorts you to a waiting police car, and you go off into the sunrise."
	CRLF
	ZERO? TOO-LATE /?L3
	CALL TOO-LATE-F
?L3:	QUIT

	.FUNCT INTEGER-F
	PRINTR "(Use figures for numbers, for example ""10."")"

	.FUNCT QUEUE-MAIN-EVENTS
	CALL QUEUE,I-LINDER-TO-OFFICE,52 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-LINDER-RETIRES,290 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-PHONG-RETIRES,320 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-STILES-ARRIVE,60 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-PROMPT-1,1 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-PROMPT-2,10 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-WEATHER,6 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-CHIMES,30 >STACK
	PUT STACK,0,1
	RTRUE

	.FUNCT I-WEATHER,OUT?
	GETP HERE,P?LINE >STACK
	EQUAL? STACK,OUTSIDE-LINE-C /?L1
	SET 'OUT?,0
	JUMP ?L2
?L1:	SET 'OUT?,1
?L2:	INC 'I-WEATHER-NUM
	EQUAL? 1,I-WEATHER-NUM \?L3
	PRINTI "Suddenly, a clap of thunder rolls across the hills"
	ZERO? OUT? /?L7
	PRINTI " nearby"
	JUMP ?L11
?L7:	PRINTI " outside"
?L11:	PRINTI "."
	CRLF
	CALL QUEUE,I-WEATHER,3 >STACK
	PUT STACK,0,1
	RFALSE
?L3:	EQUAL? 2,I-WEATHER-NUM \?L16
	PRINTI "Without warning, lightning flashes"
	ZERO? OUT? /?L19
	PRINTI " above"
	JUMP ?L23
?L19:	PRINTI " outside"
?L23:	PRINTI ", and a few seconds later thunder rattles the house."
	CRLF
	CALL QUEUE,I-WEATHER,3 >STACK
	PUT STACK,0,1
	RFALSE
?L16:	EQUAL? 3,I-WEATHER-NUM \?L28
	PRINTI "Rain begins to fall"
	ZERO? OUT? \?L31
	PRINTI " outside"
?L31:	PRINTI " in a sprinkle."
	CRLF
	CALL QUEUE,I-WEATHER,2 >STACK
	PUT STACK,0,1
	RFALSE
?L28:	EQUAL? 4,I-WEATHER-NUM \?L38
	SET 'GROUND-MUDDY,1
	PRINTI "The rain"
	ZERO? OUT? \?L41
	PRINTI " outside"
?L41:	PRINTI " is falling heavily now."
	CRLF
	CALL QUEUE,I-WEATHER,9 >STACK
	PUT STACK,0,1
	RFALSE
?L38:	EQUAL? 5,I-WEATHER-NUM \?L48
	PRINTI "The rain"
	ZERO? OUT? \?L51
	PRINTI " outside"
?L51:	PRINTI " begins to taper off."
	CRLF
	CALL QUEUE,I-WEATHER,5 >STACK
	PUT STACK,0,1
	RFALSE
?L48:	EQUAL? 6,I-WEATHER-NUM \?L58
	PRINTI "The rain storm"
	ZERO? OUT? \?L61
	PRINTI " outside"
?L61:	PRINTI " has passed now."
	CRLF
	SUB CLOUDS-GONE,PRESENT-TIME >STACK
	CALL QUEUE,I-WEATHER,STACK >STACK
	PUT STACK,0,1
	RFALSE
?L58:	EQUAL? 7,I-WEATHER-NUM \?L68
	SET 'SKY-DESC,STR?83
	SUB MOONRISE,PRESENT-TIME >STACK
	CALL QUEUE,I-WEATHER,STACK >STACK
	PUT STACK,0,1
	RFALSE
?L68:	EQUAL? 8,I-WEATHER-NUM \?L69
	SET 'SKY-DESC,STR?84
	SUB SUNRISE,PRESENT-TIME >STACK
	SUB STACK,15 >STACK
	CALL QUEUE,I-WEATHER,STACK >STACK
	PUT STACK,0,1
	RFALSE
?L69:	EQUAL? 9,I-WEATHER-NUM \?L70
	PRINTI "Suddenly it dawns on you that the sky is getting light"
	ZERO? OUT? \?L73
	PRINTI " outside"
?L73:	PRINTI "."
	CRLF
	SET 'SKY-DESC,STR?85
	CALL QUEUE,I-WEATHER,25 >STACK
	PUT STACK,0,1
	RFALSE
?L70:	EQUAL? 10,I-WEATHER-NUM \FALSE
	PRINTI "The sun has appeared over the hills"
	ZERO? OUT? \?L83
	PRINTI " outside"
?L83:	PRINTI "."
	CRLF
	RFALSE

	.FUNCT I-CHIMES,HALF-HR,HR
	CALL QUEUE,I-CHIMES,30 >STACK
	PUT STACK,0,1
	DIV PRESENT-TIME,30 >HALF-HR
	DIV HALF-HR,2 >HR
	EQUAL? HERE,OFFICE \FALSE
	MUL 2,HR >STACK
	EQUAL? HALF-HR,STACK \?L3
	LESS? 12,HR \?L5
	SUB HR,12 >HR
?L5:	PRINTI "The clock chimes "
	EQUAL? 1,HR \?L10
	PRINTI "once"
	JUMP ?L17
?L10:	EQUAL? 2,HR \?L14
	PRINTI "twice"
	JUMP ?L17
?L14:	PRINTN HR
	PRINTI " times"
?L17:	PRINTI " to mark the hour."
	CRLF
	RFALSE
?L3:	PRINTI "The clock chimes once to mark the half hour."
	CRLF
	RFALSE

	.FUNCT I-STILES-ARRIVE
	MOVE STILES,OFFICE-PATH
	FSET BACK-GATE,LOCKED
	CALL ESTABLISH-GOAL,STILES,OFFICE-PORCH
	EQUAL? HERE,OFFICE-PATH \?L1
	PRINTR "Someone enters through the back gate and rushes past you."
?L1:	GETP HERE,P?CORRIDOR >STACK
	ZERO? STACK /FALSE
	GETP HERE,P?CORRIDOR >STACK
	BAND STACK,3 >STACK
	ZERO? STACK /FALSE
	PRINTR "Someone enters the property through the back gate."

	.FUNCT I-DUFFY-ARRIVE
	ZERO? WELCOMED /?L1
	CALL QUEUE,I-MEET-DUFFY?,-1 >STACK
	PUT STACK,0,1
	SET 'DUFFY-WITH-STILES,1
	FCLEAR STILES,INVISIBLE
	CALL ESTABLISH-GOAL,STILES,FRONT-PORCH
	RFALSE
?L1:	SET 'SEEN-DUFFY?,1
	SET 'MET-DUFFY?,1
	PRINTI "Suddenly, your assistant, Sgt. Duffy, appears from out of nowhere. ""Hello, Detective!"
	PRINTI " I thought I should come here on the streetcar, in case you needed help. "
	PRINTI "I'll be nearby if you want me."" He disappears just as quickly."
	CRLF
	RFALSE

	.FUNCT DUFFY-GREETING
	SET 'MET-STILES?,1
	SET 'SEEN-DUFFY?,1
	SET 'MET-DUFFY?,1
	FSET STILES,TOUCHBIT
	PRINTI " ""Detective, I'm glad you're safe!"
	ZERO? PLAYER-HIDING /?L3
	PRINTI " Don't worry, I won't tell anyone you're hiding."
?L3:	PRINTI " I thought I should come here on the streetcar, in case you needed help. "
	PRINTI "I'm familiar with the house, since I was here to help investigate Mrs. Linder's death. Just as I walked up tonight, I heard a shot! The next thing I knew, this man, who calls himself Stiles, burst out of the woods behind the house. Naturally, I put the nippers on him and brought him along."
	RTRUE

	.FUNCT I-MEET-DUFFY?,ARG=0,L
	LOC STILES >L
	ZERO? WELCOMED /FALSE
	ZERO? MET-DUFFY? \FALSE
	EQUAL? L,HERE /?L3
	GETP HERE,P?CORRIDOR >STACK
	GETP L,P?CORRIDOR >STACK
	BAND STACK,STACK >STACK
	ZERO? STACK /FALSE
?L3:	PRINTI "Your assistant, Sgt. Duffy, sees you."
	CALL DUFFY-GREETING
	PRINTI " I'll just stow him in the living room and stand by to help you."""
	CRLF
	CALL ESTABLISH-GOAL,STILES,LIVING-ROOM
	CALL INT,I-MEET-DUFFY? >STACK
	PUT STACK,0,0
	RTRUE

	.FUNCT DO-FINGERPRINT,AN?1=0
	ZERO? DUFFY-AT-CORONER /?L1
	PRINTI "Don't you remember? Duffy went in the ambulance to the Coroner's office. "
	PRINTR "You'll have to wait for him to return."
?L1:	ZERO? FINGERPRINT-OBJ /?L5
	PRINTI "Sergeant Duffy ran off to the lab on an errand for you. "
	PRINTR "You'll have to wait for him to return."
?L5:	ZERO? MET-DUFFY? \?L9
	PRINTI "You haven't met Sergeant Duffy yet tonight."
	PRINTR " You'll need his help to do that."
?L9:	ZERO? AN?1 \?L24
	PRINTI "You look at the "
	PRINTD PRSO
	PRINTI " closely. It appears to have good fingerprints on it, so you call for Sergeant Duffy."
	CRLF
	ZERO? AN?1 /?L19
?L24:	ZERO? PRSI /?L19
	SET 'ANALYSIS-GOAL,PRSI
	JUMP ?L21
?L19:	SET 'ANALYSIS-GOAL,0
?L21:	SET 'FINGERPRINT-OBJ,PRSO
	SET 'ANALYSIS-OBJ,AN?1
	RANDOM 15 >STACK
	ADD 15,STACK >STACK
	CALL QUEUE,I-FINGERPRINT,STACK >STACK
	PUT STACK,0,1
	FSET PRSO,TOUCHBIT
	REMOVE PRSO
	PRINTI "Sergeant Duffy, quiet as a mouse, walks up and takes the "
	PRINTD PRSO
	PRINTR " from you. ""I'll return soon with the results,"" he says, and leaves as silently as he came."

	.FUNCT DO-ANALYZE
	EQUAL? PRSO,PRSI \?L1
	PRINTI "Sergeant Duffy appears with a puzzled look on his face."
	PRINTI " ""I don't see how you expect the lab to analyze something for itself!"""
	PRINTR " He leaves, shaking his head slowly."
?L1:	CALL DO-FINGERPRINT,1 >STACK
	RSTACK

	.FUNCT I-FINGERPRINT
	PRINTI "Suddenly, Sergeant Duffy "
	RANDOM 100 >STACK
	GRTR? 30,STACK \?L3
	PRINTI "appears, holding the "
	PRINTD FINGERPRINT-OBJ
	PRINTI " carefully in his hands. His quiet efficiency is impressive. "
	JUMP ?L10
?L3:	RANDOM 100 >STACK
	GRTR? 50,STACK \?L7
	PRINTI "seems to arrive from nowhere, holding the "
	PRINTD FINGERPRINT-OBJ
	PRINTI " in his hands. "
	JUMP ?L10
?L7:	PRINTI "returns with the "
	PRINTD FINGERPRINT-OBJ
	PRINTI ". For a moment you muse on his almost magical appearances. "
?L10:	ZERO? ANALYSIS-GOAL /?L13
	EQUAL? FINGERPRINT-OBJ,INSIDE-GUN,OUTSIDE-GUN \?L15
	EQUAL? ANALYSIS-GOAL,POWDER,CLOCK-POWDER \?L15
	PRINTI """The gun has recently been fired, and it contains traces of cheap gun powder"
	ZERO? POWDER-ANALYZED /?L19
	PRINTI ", the same kind of powder that you found on the clock"
?L19:	PRINTI "."
	JUMP ?L62
?L15:	EQUAL? FINGERPRINT-OBJ,MATCHBOOK,THREAT-NOTE \?L26
	EQUAL? ANALYSIS-GOAL,HANDWRITING \?L26
	PRINTI """The ink is ordinary Waterman blue-black. The lab can't tell much else without a certified handwriting sample on file."
	JUMP ?L62
?L26:	EQUAL? FINGERPRINT-OBJ,ANALYSIS-GOAL /?L62
	PRINTI """The "
	PRINTD FINGERPRINT-OBJ
	PRINTI " doesn't contain any "
	CALL ANALYSIS-PRINT,ANALYSIS-GOAL
	JUMP ?L62
?L13:	EQUAL? FINGERPRINT-OBJ,PIECE-OF-WIRE,SPOOL-OF-WIRE /?L34
	EQUAL? FINGERPRINT-OBJ,WHITE-WIRE,BLACK-WIRE \?L33
?L34:	PRINTI """The wire is ordinary 16-gauge bell wire."
	JUMP ?L62
?L33:	EQUAL? FINGERPRINT-OBJ,PIECE-OF-PUTTY \?L37
	PRINTI """The putty contained traces of the explosive cordite."
	JUMP ?L62
?L37:	EQUAL? FINGERPRINT-OBJ,INSIDE-GUN,OUTSIDE-GUN \?L40
	PRINTI """The gun has recently been fired, and it contains traces of cheap gun powder"
	PRINTI "."
	EQUAL? FINGERPRINT-OBJ,INSIDE-GUN \?L62
	PRINTI " And the barrel has indeed been sawed off."
	JUMP ?L62
?L40:	EQUAL? FINGERPRINT-OBJ,CLOCK-POWDER \?L50
	SET 'POWDER-ANALYZED,1
	PRINTI """The powder is gun powder, as I suspected. I put it in a cellophane envelope for you."
	JUMP ?L62
?L50:	EQUAL? FINGERPRINT-OBJ,MATCHBOOK,THREAT-NOTE \?L53
	PRINTI """The ink is ordinary Waterman blue-black. The lab can't tell much else without a certified handwriting sample on file."
	JUMP ?L62
?L53:	EQUAL? FINGERPRINT-OBJ,STUB \?L56
	PRINTI """I took the ticket stub to the movie theater, where they told me that it looked authentic to them, and the serial number proves that it was bought tonight."
	JUMP ?L62
?L56:	EQUAL? FINGERPRINT-OBJ,MEDICAL-REPORT \?L59
	SET 'DUFFY-SAW-MEDICAL-REPORT,1
	PRINTI """I tried to call the doctor, but there's no listing in the phone book. The lab people couldn't see anything unusual about the report."
	JUMP ?L62
?L59:	PRINTI """I'm sorry,"" he begins, ""but the lab found nothing interesting."
?L62:	PRINTI """ With that, he leaves, handing you the "
	PRINTD FINGERPRINT-OBJ
	PRINTI " as he whisks away."
	CRLF
	MOVE FINGERPRINT-OBJ,PLAYER
	SET 'FINGERPRINT-OBJ,0
	RTRUE

	.FUNCT ANALYSIS-PRINT,OBJ
	PRINTD OBJ
	PRINTI "."
	RTRUE

	.FUNCT TODAY-F
	EQUAL? PRSA,V?WHAT \FALSE
	LESS? PRESENT-TIME,720 \?L3
	PRINTR "Today is Friday, February 18, 1938."
?L3:	PRINTR "Today is Saturday, February 19, 1938."

	.FUNCT WELCOME
	EQUAL? 2,TOO-LATE-KNOCKED \?L1
	PRINTI "No one answers the door, but a police car races in the driveway and stops. Two officers jump out, grab you roughly, and haul you off as a trespasser."
	CRLF
	CALL PRINT-ID,STR?86
	CALL TOO-LATE-F
	QUIT
?L1:	ZERO? RADIO-ON /?L6
	PRINTI "Someone turns off the radio. "
	SET 'RADIO-ON,0
?L6:	PRINTI "You hear footsteps inside the house. Then the door swings open."
	CRLF
	EQUAL? TOO-LATE-KNOCKED,1 \?L13
	SET 'TOO-LATE-KNOCKED,2
	PRINTI "The butler isn't smiling now. ""I told you Mr. Linder will be in touch. Please leave before I call the police!"" He slams the door in your face."
	CRLF
	CALL PRINT-ID,STR?87 >STACK
	RSTACK
?L13:	ZERO? TOO-LATE /?L17
	SET 'TOO-LATE-KNOCKED,1
	PRINTI """Good evening,"" says a smiling face, ""I am Phong. I'm sorry, but you're too late arriving here. Mr. Linder has other business now. But he thanks you for coming and says he'll be in touch. Good night!"" He closes the door in your face."
	CRLF
	CALL PRINT-ID,STR?88 >STACK
	RSTACK
?L17:	EQUAL? HERE,FRONT-PORCH \?L21
	MOVE PHONG,ENTRY
	PRINTI """Good evening,"" says a smiling face, ""I am Phong.[RWD_ID: events:379, VAL: 1] Please come in."" He leads you into the house and closes the door behind you.
"
	CRLF
	FCLEAR FRONT-DOOR,OPENBIT
	CALL GOTO,ENTRY
	JUMP ?L25
?L21:	PRINTI """I've been told that detectives are sneaky, but this is too much!"""
	CRLF
	CALL PRINT-ID,STR?89
?L25:	CALL QUEUE,I-GOTO-LIVING-ROOM,2 >STACK
	PUT STACK,0,1
	RTRUE

	.FUNCT I-GOTO-LIVING-ROOM
	PRINTI "Phong says, ""I believe "
	IN? MONICA,LIVING-ROOM \?L3
	PRINTI "the Linders are"
	JUMP ?L7
?L3:	PRINTI "Mr. Linder is"
?L7:	PRINTI " in the living room. Please follow me."""
	GETP HERE,P?CORRIDOR >STACK
	BTST STACK,16 /?L12
	FSET HALL-3,TOUCHBIT
	PRINTI " He leads you into a hallway and turns left. "
	GETP HALL-3,P?LDESC >STACK
	PRINT STACK
	JUMP ?L16
?L12:	PRINTI " He leads you north along the hallway. "
?L16:	IN? MONICA,LIVING-ROOM \?L19
	PRINTI " As you get near the living room, you hear voices talking, half-loud and fast."
?L19:	CRLF
	CRLF
	MOVE PHONG,LIVING-ROOM
	CALL GOTO,LIVING-ROOM
	CALL FIX-PHONG-MOVEMENT >STACK
	ZERO? STACK /?L24
	CALL QUEUE,I-PHONG,1 >STACK
	PUT STACK,0,1
	SET 'WELCOMED,1
?L24:	CALL I-LINDER-WELCOME >STACK
	RSTACK

	.FUNCT I-LINDER-WELCOME
	CRLF
	PRINTI "Linder turns to you and says, ""Detective, am I glad to see you! "
	ZERO? TOO-LATE /?L3
	PRINTI "I was afraid you'd met with an accident. I'm afraid I don't have time for you now, since I have another appointment. But thank you for coming. I'll be in touch. Phong, please show the Detective out."""
	CALL SAID-TO,LINDER
	CALL ESTABLISH-GOAL,LINDER,OFFICE
	CALL INT,I-LINDER-TO-OFFICE >STACK
	PUT STACK,0,0
	CALL QUEUE,I-PHONG-EJECTS,3 >STACK
	PUT STACK,0,1
	CRLF
	RTRUE
?L3:	CALL ESTABLISH-GOAL,PHONG,KITCHEN
	SET 'OHERE,HERE
	SET 'LINDER-FOLLOWS-YOU,1
	CALL QUEUE,I-LINDER-FOLLOWS-YOU,-1 >STACK
	PUT STACK,0,1
	IN? MONICA,HERE \?L8
	PRINTI "This is my daughter, Monica, and of course "
	JUMP ?L12
?L8:	PRINTI "I see "
?L12:	PRINTI "you've met Phong already."" He looks at a wrist watch with a gleaming silver bracelet. ""I see you're"
	CALL SAID-TO,LINDER
	LESS? PRESENT-TIME,490 \?L17
	PRINTI " right on time."
	CALL PRINT-ID,STR?90
	CALL QUEUE,I-LINDER-TO-OFFICE,10 >STACK
	PUT STACK,0,1
	JUMP ?L24
?L17:	LESS? PRESENT-TIME,500 \?L21
	PRINTI " a little late."
	CALL PRINT-ID,STR?91
	CALL QUEUE,I-LINDER-TO-OFFICE,5 >STACK
	PUT STACK,0,1
	JUMP ?L24
?L21:	PRINTI " rather late."
	CALL PRINT-ID,STR?92
	CALL QUEUE,I-LINDER-TO-OFFICE,1 >STACK
	PUT STACK,0,1
?L24:	PRINTR " I'll be with you as soon as I finish my drink."""

	.FUNCT I-PHONG-EJECTS
	FCLEAR FRONT-DOOR,OPENBIT
	FSET FRONT-DOOR,LOCKED
	PRINTI "Phong grabs you by the arm and guides you to the front door. It's obvious that you have no choice. ""Thank you for coming, Detective. Good night!"" He closes the door in your face."
	CRLF
	SET 'TOO-LATE-KNOCKED,1
	CALL GOTO,FRONT-PORCH
	RTRUE

	.FUNCT I-LINDER-FOLLOWS-YOU
	EQUAL? OHERE,HERE /FALSE
	CALL WHERE-UPDATE,LINDER
	MOVE LINDER,HERE
	PRINTI "Linder follows you "
	EQUAL? OHERE,HALL-1,HALL-2 /?L7
	EQUAL? OHERE,HALL-3,HALL-4 \?L5
?L7:	EQUAL? HERE,HALL-1,HALL-2 /?L8
	EQUAL? HERE,HALL-3,HALL-4 \?L5
?L8:	PRINTI "along"
	JUMP ?L11
?L5:	PRINTI "into"
?L11:	CALL THE?,HERE
	PRINTI " "
	PRINTD HERE
	PRINTI "."
	RANDOM 100 >STACK
	GRTR? 50,STACK \?L16
	CALL WINDOW-IN?,HERE >STACK
	ZERO? STACK /?L16
	PRINTI " He looks out the window and checks the lock."
?L16:	CRLF
	SET 'OHERE,HERE
	RETURN OHERE

	.FUNCT I-LINDER-TO-OFFICE,VAL=0
	CALL INT,I-LINDER-FOLLOWS-YOU >STACK
	PUT STACK,0,0
	EQUAL? HERE,WORKSHOP /?L3
	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK /?L1
?L3:	MOVE LINDER,CARVED-CHAIR
	SET 'TOO-LATE,1
	EQUAL? HERE,BACK-YARD,OFFICE-PORCH,OFFICE-PATH \FALSE
	PRINTI "The lights go on in Linder's office."
	CRLF
	RFALSE
?L1:	LOC PLAYER >STACK
	EQUAL? OFFICE,HERE,STACK /?L9
	SET 'VAL,M-FATAL
	PRINTI "Linder gulps down the rest of his drink. ""Well, Detective,"" he says, ""I'm anxious to get on with our business. Let's you and I go to my office so we can talk undisturbed."" "
	LOC PLAYER >STACK
	FSET? STACK,FURNITURE \?L12
	SET 'WINNER,PLAYER
	CALL PERFORM,V?STAND
?L12:	EQUAL? HERE,HALL-4 \?L15
	PRINTI "He takes you by the arm, opens a door to the east and leads you through it."
	CRLF
	JUMP ?L19
?L15:	PRINTI "He takes you by the arm and leads you through the hallway. Just south of the entry, he opens a door to the east and leads you through it."
	CRLF
?L19:	FSET OFFICE-DOOR,OPENBIT
	CALL GOTO,OFFICE
	CALL WHERE-UPDATE,LINDER
	CALL SAID-TO,LINDER
?L9:	CALL QUEUE,I-LINDER-IN-OFFICE,1 >STACK
	PUT STACK,0,1
	FSET LINDER,NDESCBIT
	MOVE LINDER,CARVED-CHAIR
	PRINTI "Linder sits down in the carved chair."
	CRLF
	RETURN VAL

	.FUNCT I-LINDER-IN-OFFICE
	ZERO? LINDER-EXPLAINED \FALSE
	LOC PLAYER >STACK
	IN? STACK,ROOMS \?L3
	CALL QUEUE,I-LINDER-IN-OFFICE,5 >STACK
	PUT STACK,0,1
	CALL SAID-TO,LINDER
	ZERO? LINDER-ASKED-YOU-TO-SIT \?L4
	PRINTI """I"
	PRINTI "f you'll just take a chair, I'll explain what this is all about."""
	CRLF
	JUMP ?L8
?L4:	PRINTI "Linder says, ""I repeat: i"
	PRINTI "f you'll just take a chair, I'll explain what this is all about."""
	CRLF
	CALL PRINT-ID,STR?93
?L8:	INC 'LINDER-ASKED-YOU-TO-SIT
	RETURN LINDER-ASKED-YOU-TO-SIT
?L3:	CALL QUEUE,I-LINDER-EXPLAIN,1 >STACK
	PUT STACK,0,1
	RTRUE

	.FUNCT I-LINDER-EXPLAIN
	ZERO? LINDER-EXPLAINED \FALSE
	SET 'LINDER-EXPLAINED,1
	PRINTI "Linder begins his story. ""My late wife, may she rest in peace, got involved with a young man named Stiles. Naturally I tried to stop this affair, but without much success. Since my wife passed away, this Stiles fellow has gone off the deep end, I'm afraid, and blamed me for her death. I tried my best to ignore him, but he seems to have lost his senses. This morning I received this note and decided to ask your help."" He hands the note to you."
	CRLF
	CALL SAID-TO,LINDER
	CALL THIS-IS-IT,THREAT-NOTE
	MOVE THREAT-NOTE,PLAYER
	FSET THREAT-NOTE,TOUCHBIT
	FCLEAR THREAT-NOTE,INVISIBLE
	RTRUE

	.FUNCT FIRE-SHOT
	PRINTI " Suddenly there is a flash of light and an explosion, and "
	ZERO? PLAYER-NEAR-SHOT /?L3
	SUB PRESENT-TIME,PLAYER-NEAR-SHOT >STACK
	GRTR? 2,STACK \?L3
	PRINTI "everything goes black. What a lousy way to step off, poking around like a two-bit shamus!"
	CRLF
	CALL PRINT-ID,STR?94
	QUIT
?L3:	RANDOM 100 >STACK
	GRTR? 50,STACK \?L7
	ZERO? PLAYER-HIDING \?L7
	LOC PLAYER >STACK
	EQUAL? STACK,WOODEN-CHAIR,LOUNGE /?L7
	PRINTI "mortal pain radiates from your heart. As blood fills your lungs and a scream fills your brain, you feel sure of only one thing: you should have taken a chair when Linder asked you to."
	CRLF
	CALL PRINT-ID,STR?95
	QUIT
?L7:	PRINTI "the window falls into dozens of shiny shards."
	PRINTI " The cat bolts and disappears somewhere."
	REMOVE CAT
	SET 'SHOT-FIRED,1
	FCLEAR PIECE-OF-WIRE,TRYTAKEBIT
	FSET PIECE-OF-WIRE,TAKEBIT
	FCLEAR PIECE-OF-PUTTY,TRYTAKEBIT
	FSET PIECE-OF-PUTTY,TAKEBIT
	FCLEAR GLOBAL-SHOT,INVISIBLE
	FSET OFFICE-WINDOW,RMUNGBIT
	FCLEAR BROKEN-GLASS,INVISIBLE
	RTRUE

	.FUNCT I-PHONG-RETIRES
	CALL WHERE-UPDATE,PHONG
	MOVE PHONG,BUTLER-ROOM
	GETP HERE,P?LINE >STACK
	EQUAL? STACK,OUTSIDE-LINE-C \FALSE
	PRINTR "The lights go out, one by one, all over the house."

	.FUNCT I-LINDER-RETIRES
	CALL WHERE-UPDATE,LINDER
	MOVE LINDER,LINDER-ROOM
	EQUAL? HERE,ROCK-GARDEN,BACK-YARD,OFFICE-PORCH \FALSE
	PRINTR "The lights go off in Linder's office and then in the bedroom at the other end of the house."

	.FUNCT FIX-PHONG-MOVEMENT,MG,ELAPSED,OT
	GET MOVEMENT-GOALS,PHONG-C >MG
	SUB PRESENT-TIME,480 >ELAPSED
?L1:	GET MG,MG-TIME >OT
	ZERO? OT /TRUE
	SUB OT,ELAPSED >OT
	GRTR? 1,OT \?L6
	SET 'TOO-LATE,1
	RFALSE
?L6:	PUT MG,MG-TIME,OT
	ADD MG,MG-LENGTH >MG
	JUMP ?L1

	.FUNCT IN-MOTION?,PERSON?1,GT
	GETP PERSON?1,P?CHARACTER >STACK
	GET GOAL-TABLES,STACK >GT
	GET GT,GOAL-ENABLE >STACK
	ZERO? STACK /FALSE
	GET GT,GOAL-S >STACK
	ZERO? STACK /FALSE
	GET GT,GOAL-F >STACK
	LOC PERSON?1 >STACK
	EQUAL? STACK,STACK /FALSE
	RTRUE

	.FUNCT START-MOVEMENT
	CALL QUEUE,I-MONICA,1 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-FOLLOW,-1 >STACK
	PUT STACK,0,1
	CALL QUEUE,I-ATTENTION,-1 >STACK
	PUT STACK,0,1
	RTRUE

	.FUNCT IMOVEMENT,PERSON?1,INT?1,TB,VAR,DIS,TIM,ID,RM,GT
	GETP PERSON?1,P?CHARACTER >ID
	GET MOVEMENT-GOALS,ID >TB
	GET GOAL-TABLES,ID >GT
	GET TB,MG-ROOM >RM
	ZERO? RM /?L5
	GET GT,GOAL-PRIORITY >STACK
	ZERO? STACK /?L3
	PUT GT,GOAL-QUEUED,RM
	JUMP ?L5
?L3:	CALL ESTABLISH-GOAL,PERSON?1,RM
?L5:	GET TB,MG-TIME >TIM
	ZERO? TIM /FALSE
	GET TB,MG-VARIATION >VAR
	MUL VAR,2 >STACK
	RANDOM STACK >DIS
	SUB DIS,VAR >STACK
	ADD TIM,STACK >STACK
	CALL QUEUE,INT?1,STACK
	ADD TB,MG-LENGTH >STACK
	PUT MOVEMENT-GOALS,ID,STACK
	GET TB,MG-NEXT >STACK
	ZERO? STACK /FALSE
	SUB VAR,DIS >STACK
	GET TB,MG-NEXT >STACK
	ADD STACK,STACK >STACK
	PUT TB,MG-NEXT,STACK
	RFALSE

	.FUNCT I-FOLLOW,FLG=0,CNT=0,GT,VAL
?L1:	IGRTR? 'CNT,CHARACTER-MAX \?L3
	RETURN FLG
?L3:	GET GOAL-TABLES,CNT >GT
	GET GT,GOAL-S >STACK
	ZERO? STACK /?L1
	GET GT,GOAL-ENABLE >STACK
	ZERO? STACK \?L6
	GET GT,ATTENTION >STACK
	ZERO? STACK \?L1
?L6:	PUT GT,GOAL-ENABLE,1
	GET CHARACTER-TABLE,CNT >STACK
	CALL FOLLOW-GOAL,STACK >VAL
	ZERO? VAL /?L1
	EQUAL? FLG,M-FATAL /?L1
	SET 'FLG,VAL
	JUMP ?L1

	.FUNCT I-ATTENTION,FLG=0,CNT=0,ATT
?L1:	IGRTR? 'CNT,CHARACTER-MAX \?L3
	RETURN FLG
?L3:	GET ATTENTION-TABLE,CNT >STACK
	SUB STACK,1 >ATT
	EQUAL? ATT,1 \?L5
	GET CHARACTER-TABLE,CNT >STACK
	IN? STACK,HERE \?L14
	EQUAL? CNT,MONICA-C \?L8
	ZERO? MONICA-DASHED-OUT-DOOR /?L8
	SET 'MONICA-DASHED-OUT-DOOR,0
	JUMP ?L10
?L8:	GET CHARACTER-TABLE,CNT >STACK
	PRINTD STACK
	PRINTI " is acting impatient."
	CRLF
?L10:	SET 'FLG,1
	JUMP ?L14
?L5:	ZERO? ATT \?L14
	GET GOAL-TABLES,CNT >STACK
	PUT STACK,GOAL-ENABLE,1
?L14:	PUT ATTENTION-TABLE,CNT,ATT
	JUMP ?L1

	.FUNCT GRAB-ATTENTION,PERSON?1,CHR,GT,ATT
	GETP PERSON?1,P?CHARACTER >CHR
	GET GOAL-TABLES,CHR >GT
	GET GT,GOAL-S >STACK
	ZERO? STACK /?L5
	GET GT,ATTENTION-SPAN >ATT
	PUT ATTENTION-TABLE,CHR,ATT
	ZERO? ATT \?L3
	PUT GT,GOAL-ENABLE,1
	RFALSE
?L3:	GET GT,GOAL-ENABLE >STACK
	ZERO? STACK /?L5
	PUT GT,GOAL-ENABLE,0
?L5:	SET 'QCONTEXT,PERSON?1
	SET 'QCONTEXT-ROOM,HERE
	RTRUE

	.FUNCT UNPRIORITIZE,PERSON?1,GT
	GETP PERSON?1,P?CHARACTER >STACK
	GET GOAL-TABLES,STACK >GT
	PUT GT,GOAL-PRIORITY,0
	GET GT,GOAL-QUEUED >STACK
	ZERO? STACK /FALSE
	GET GT,GOAL-QUEUED >STACK
	CALL ESTABLISH-GOAL,PERSON?1,STACK
	PUT GT,GOAL-QUEUED,0
	RTRUE

	.FUNCT ESTABLISH-GOAL,PERSON?1,GOAL,PRIORITY=0,HERE?1,HL,GL,GT
	LOC PERSON?1 >HERE?1
	GETP PERSON?1,P?CHARACTER >STACK
	GET GOAL-TABLES,STACK >GT
	ZERO? PRIORITY /?L1
	PUT GT,GOAL-ENABLE,1
	PUT GT,GOAL-PRIORITY,1
	PUT GT,GOAL-QUEUED,HERE?1
?L1:	GETP HERE?1,P?LINE >HL
	GETP GOAL,P?LINE >GL
	EQUAL? HL,GL \?L4
	PUT GT,GOAL-I,0
	JUMP ?L11
?L4:	EQUAL? HL,OUTSIDE-LINE-C \?L6
	PUT GT,GOAL-I,FRONT-PORCH
	JUMP ?L11
?L6:	EQUAL? HL,OFFICE-LINE-C \?L7
	PUT GT,GOAL-I,HALL-4
	JUMP ?L11
?L7:	EQUAL? HL,MONICA-LINE-C \?L8
	PUT GT,GOAL-I,MONICA-ROOM
	JUMP ?L11
?L8:	EQUAL? GL,OUTSIDE-LINE-C \?L9
	PUT GT,GOAL-I,ENTRY
	JUMP ?L11
?L9:	EQUAL? GL,MONICA-LINE-C \?L10
	PUT GT,GOAL-I,HALL-2
	JUMP ?L11
?L10:	PUT GT,GOAL-I,HALL-3
?L11:	GETP GOAL,P?STATION >STACK
	PUT GT,GOAL-S,STACK
	PUT GT,GOAL-F,GOAL
	LOC PERSON?1 >STACK
	RSTACK

	.FUNCT FOLLOW-GOAL,PERSON?1,HERE?1,LINE,LN,RM,GT,GOAL,FLG,GOAL-FLAG=0,IGOAL=0,LOC,CNT=1,DIR
	LOC PERSON?1 >HERE?1
	GETP PERSON?1,P?CHARACTER >STACK
	GET GOAL-TABLES,STACK >GT
	GET GT,GOAL-F >STACK
	EQUAL? HERE?1,STACK \?L1
	PUT GT,GOAL-S,0
	RFALSE
?L1:	GET GT,GOAL-ENABLE >STACK
	ZERO? STACK /FALSE
	GETP HERE?1,P?STATION >LOC
	EQUAL? HERE?1,LOC /?L5
	CALL MOVE-PERSON,PERSON?1,LOC >FLG
	RETURN FLG
?L5:	GET GT,GOAL-I >GOAL
	ZERO? GOAL /?L8
	SET 'IGOAL,1
	JUMP ?L10
?L8:	GET GT,GOAL-S >GOAL
?L10:	ZERO? GOAL /FALSE
	EQUAL? HERE?1,GOAL \?L17
	ZERO? IGOAL /?L14
	GET GT,GOAL-F >STACK
	CALL TRANSFER,PERSON?1,GOAL,STACK >STACK
	RSTACK
?L14:	GET GT,GOAL-F >STACK
	EQUAL? HERE?1,STACK /?L16
	GET GT,GOAL-F >STACK
	CALL MOVE-PERSON,PERSON?1,STACK >FLG
	PUT GT,GOAL-S,0
	RETURN FLG
?L16:	PUT GT,GOAL-S,0
	RFALSE
?L17:	GETP GOAL,P?LINE >LN
	EQUAL? LN,OUTSIDE-LINE-C \?L19
	SET 'LINE,OUTSIDE-LINE
	JUMP ?L20
?L19:	EQUAL? LN,INSIDE-LINE-C \?L21
	SET 'LINE,INSIDE-LINE
	JUMP ?L20
?L21:	EQUAL? LN,OFFICE-LINE-C \?L22
	SET 'LINE,OFFICE-LINE
	JUMP ?L20
?L22:	EQUAL? LN,MONICA-LINE-C \?L23
	SET 'LINE,MONICA-LINE
	JUMP ?L20
?L23:	SET 'LINE,0
?L20:	GET LINE,CNT >RM
	EQUAL? RM,HERE?1 \?L27
	ZERO? GOAL-FLAG /?L29
	SUB CNT,3 >STACK
	GET LINE,STACK >LOC
	JUMP ?L31
?L29:	ADD CNT,3 >STACK
	GET LINE,STACK >LOC
?L31:	CALL MOVE-PERSON,PERSON?1,LOC >STACK
	RSTACK
?L27:	EQUAL? RM,GOAL \?L32
	SET 'GOAL-FLAG,1
?L32:	ADD CNT,3 >CNT
	JUMP ?L20

	.FUNCT GOAL-REACHED,PERSON?1
	GETP PERSON?1,P?CHARACTER >STACK
	GET GOAL-TABLES,STACK >STACK
	GET STACK,GOAL-FUNCTION >STACK
	CALL STACK,G-REACHED >STACK
	RSTACK

	.FUNCT MOVE-PERSON,PERSON?1,WHERE,DIR,GT,OL,COR,PCOR,CHR,FLG=0,DR,VAL=0,STI
	ZERO? MET-STILES? /?L1
	SET 'STI,STR?96
	JUMP ?L3
?L1:	SET 'STI,STR?97
?L3:	GETP PERSON?1,P?CHARACTER >CHR
	GET GOAL-TABLES,CHR >GT
	LOC PERSON?1 >OL
	CALL DIR-FROM,OL,WHERE >DIR
	GETPT OL,DIR >DR
	PTSIZE DR >STACK
	EQUAL? STACK,DEXIT \?L4
	GETB DR,DEXITOBJ >DR
	FSET? DR,OPENBIT /?L6
	FSET? DR,LOCKED /?L12
	FSET DR,OPENBIT
	JUMP ?L12
?L6:	SET 'DR,0
	JUMP ?L12
?L4:	SET 'DR,0
?L12:	PUT GT,GOAL-LDIR,DIR
	EQUAL? OL,HERE \?L13
	FSET? PERSON?1,INVISIBLE /?L13
	SET 'FLG,1
	CALL THIS-IS-S-HE,PERSON?1
	EQUAL? PERSON?1,STILES \?L15
	ZERO? DUFFY-WITH-STILES /?L15
	SET 'SEEN-DUFFY?,1
	PRINTI "Sgt. Duffy"
	JUMP ?L22
?L15:	FSET? PERSON?1,TOUCHBIT /?L19
	PRINTI "Someone"
	JUMP ?L22
?L19:	PRINTD PERSON?1
?L22:	EQUAL? DIR,P?OUT \?L25
	EQUAL? PERSON?1,STILES \?L27
	ZERO? DUFFY-WITH-STILES /?L27
	PRINTI " leads "
	PRINT STI
	PRINTI " out of the room."
	CRLF
	JUMP ?L167
?L27:	PRINTI " leaves the room."
	CRLF
	JUMP ?L167
?L25:	EQUAL? DIR,P?IN \?L34
	ZERO? DR /?L35
	EQUAL? PERSON?1,STILES /?L224
	PRINTI " opens the "
	PRINTD DR
	PRINTI " and"
?L35:	EQUAL? PERSON?1,STILES \?L40
?L224:	ZERO? DUFFY-WITH-STILES /?L40
	PRINTI " leads "
	PRINT STI
	PRINTI " into another room"
	JUMP ?L44
?L40:	PRINTI " goes into another room"
?L44:	ZERO? DR /?L47
	FSET? DR,LOCKED \?L47
	EQUAL? PERSON?1,STILES /?L47
	PRINTI ", locking the door again"
?L47:	PRINTI "."
	CRLF
	JUMP ?L167
?L34:	ZERO? DR /?L55
	EQUAL? PERSON?1,STILES /?L225
	PRINTI " opens the "
	PRINTD DR
	PRINTI " and"
?L55:	EQUAL? PERSON?1,STILES \?L60
?L225:	ZERO? DUFFY-WITH-STILES /?L60
	PRINTI " leads "
	PRINT STI
	PRINTI " off to "
	JUMP ?L64
?L60:	PRINTI " heads off to "
?L64:	CALL DIR-PRINT,DIR
	ZERO? DR /?L67
	FSET? DR,LOCKED \?L67
	EQUAL? PERSON?1,STILES /?L67
	PRINTI ", locking the door again"
?L67:	PRINTI "."
	CRLF
	JUMP ?L167
?L13:	EQUAL? WHERE,HERE \?L74
	FSET? PERSON?1,INVISIBLE /?L74
	SET 'FLG,1
	CALL THIS-IS-S-HE,PERSON?1
	GET GT,GOAL-F >STACK
	EQUAL? HERE,STACK /?L167
	EQUAL? PERSON?1,STILES \?L77
	ZERO? DUFFY-WITH-STILES /?L77
	SET 'SEEN-DUFFY?,1
	PRINTI "Sgt. Duffy"
	PRINTI " leads "
	PRINT STI
	PRINTI " past you."
	CRLF
	JUMP ?L167
?L77:	FSET? PERSON?1,TOUCHBIT /?L83
	PRINTI "Someone walks past you."
	CRLF
	JUMP ?L167
?L83:	PRINTD PERSON?1
	PRINTI " walks past you."
	CRLF
	JUMP ?L167
?L74:	GETP HERE,P?CORRIDOR >COR
	ZERO? COR /?L167
	FSET? PERSON?1,INVISIBLE /?L167
	GETP OL,P?CORRIDOR >PCOR
	ZERO? PCOR /?L91
	BAND COR,PCOR >STACK
	ZERO? STACK /?L91
	SET 'FLG,1
	CALL THIS-IS-S-HE,PERSON?1
	GETP WHERE,P?CORRIDOR >STACK
	ZERO? STACK \?L93
	EQUAL? PERSON?1,STILES \?L95
	ZERO? DUFFY-WITH-STILES /?L95
	SET 'SEEN-DUFFY?,1
	PRINTI "Sgt. Duffy"
	JUMP ?L102
?L95:	FSET? PERSON?1,TOUCHBIT /?L99
	PRINTI "Someone"
	JUMP ?L102
?L99:	PRINTD PERSON?1
?L102:	PRINTI ", off to "
	CALL COR-DIR,HERE,OL >STACK
	CALL DIR-PRINT,STACK
	PRINTI ","
	ZERO? DR /?L109
	EQUAL? PERSON?1,STILES /?L226
	PRINTI " opens a door and"
?L109:	EQUAL? PERSON?1,STILES \?L114
?L226:	ZERO? DUFFY-WITH-STILES /?L114
	PRINTI " leads "
	PRINT STI
	JUMP ?L121
?L114:	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK /?L118
	PRINTI " leaves your view"
	JUMP ?L121
?L118:	PRINTI " ducks into a room"
?L121:	PRINTI " to "
	CALL DIR-FROM,OL,WHERE >STACK
	CALL DIR-PRINT,STACK
	ZERO? DR /?L126
	FSET? DR,LOCKED \?L126
	EQUAL? PERSON?1,STILES /?L126
	PRINTI ", locking the door again"
?L126:	PRINTI "."
	CRLF
	JUMP ?L167
?L93:	GETP WHERE,P?CORRIDOR >STACK
	BAND COR,STACK >STACK
	ZERO? STACK \?L133
	EQUAL? PERSON?1,STILES \?L134
	ZERO? DUFFY-WITH-STILES /?L134
	SET 'SEEN-DUFFY?,1
	PRINTI "Sgt. Duffy, with "
	PRINT STI
	PRINTI " in tow"
	JUMP ?L141
?L134:	FSET? PERSON?1,TOUCHBIT /?L138
	PRINTI "Someone"
	JUMP ?L141
?L138:	PRINTD PERSON?1
?L141:	PRINTI ", off to "
	CALL COR-DIR,HERE,OL >STACK
	CALL DIR-PRINT,STACK
	PRINTI ", disappears from sight to "
	CALL DIR-FROM,OL,WHERE >PCOR
	CALL DIR-PRINT,PCOR
	PRINTI "."
	CRLF
	JUMP ?L167
?L133:	EQUAL? PERSON?1,STILES \?L151
	ZERO? DUFFY-WITH-STILES /?L151
	SET 'SEEN-DUFFY?,1
	PRINTI "Sgt. Duffy, with "
	PRINT STI
	PRINTI " in tow,"
	JUMP ?L158
?L151:	FSET? PERSON?1,TOUCHBIT /?L155
	PRINTI "Someone"
	JUMP ?L158
?L155:	PRINTD PERSON?1
?L158:	PRINTI " is to "
	CALL COR-DIR,HERE,WHERE >STACK
	CALL DIR-PRINT,STACK
	PRINTI ", heading toward "
	CALL DIR-FROM,OL,WHERE >STACK
	CALL DIR-PRINT,STACK
	PRINTI "."
	CRLF
	JUMP ?L167
?L91:	GETP WHERE,P?CORRIDOR >PCOR
	ZERO? PCOR /?L167
	BAND COR,PCOR >STACK
	ZERO? STACK /?L167
	SET 'FLG,1
	CALL THIS-IS-S-HE,PERSON?1
	PRINTI "To "
	CALL COR-DIR,HERE,WHERE >STACK
	CALL DIR-PRINT,STACK
	EQUAL? PERSON?1,STILES \?L170
	ZERO? DUFFY-WITH-STILES /?L170
	SET 'SEEN-DUFFY?,1
	PRINTI " Sgt. Duffy, with "
	PRINT STI
	PRINTI " in tow,"
	JUMP ?L177
?L170:	FSET? PERSON?1,TOUCHBIT /?L174
	PRINTI " someone"
	JUMP ?L177
?L174:	PRINTI " "
	PRINTD PERSON?1
?L177:	CALL OUTSIDE?,WHERE >STACK
	ZERO? STACK /?L180
	PRINTI " comes into view from "
	JUMP ?L184
?L180:	PRINTI " enters the hallway from "
?L184:	EQUAL? OL,LIMBO \?L187
	PRINTI "the south"
	JUMP ?L191
?L187:	CALL DIR-FROM,WHERE,OL >STACK
	CALL DIR-PRINT,STACK
?L191:	PRINTI "."
	CRLF
?L167:	CALL WHERE-UPDATE,PERSON?1,FLG
	MOVE PERSON?1,WHERE
	GET GT,GOAL-F >STACK
	EQUAL? STACK,WHERE \?L206
	CALL GOAL-REACHED,PERSON?1 >VAL
	ZERO? VAL \?L206
	EQUAL? HERE,WHERE \?L206
	FSET? PERSON?1,INVISIBLE /?L206
	CALL THIS-IS-S-HE,PERSON?1
	PRINTD PERSON?1
	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK /?L202
	PRINTI " stops here."
	CRLF
	JUMP ?L206
?L202:	PRINTI " steps into the room."
	CRLF
?L206:	EQUAL? PERSON?1,STILES \?L211
	CALL I-MEET-DUFFY?
?L211:	ZERO? DEBUG /?L214
	PRINTI "["
	PRINTD PERSON?1
	PRINTI " just went into"
	CALL THE?,WHERE
	PRINTI " "
	PRINTD WHERE
	PRINTI ".]"
	CRLF
?L214:	EQUAL? VAL,M-FATAL \?L221
	RETURN VAL
?L221:	RETURN FLG

	.FUNCT DIR-FROM,HERE?1,THERE,P=0,L,TBL,O
?L1:	NEXTP HERE?1,P >P
	ZERO? P /FALSE
	EQUAL? P,P?IN,P?OUT /?L1
	LESS? P,P?OUT /?L1
	GETPT HERE?1,P >TBL
	PTSIZE TBL >L
	EQUAL? L,DEXIT,UEXIT,CEXIT \?L1
	GETB TBL,REXIT >STACK
	EQUAL? STACK,THERE \?L1
	RETURN P

	.FUNCT TRANSFER,PERSON?1,IGOAL,FGOAL,V,FLG=0
	EQUAL? IGOAL,FRONT-PORCH \?L1
	CALL MOVE-PERSON,PERSON?1,ENTRY >V
	JUMP ?L7
?L1:	EQUAL? IGOAL,ENTRY \?L3
	CALL MOVE-PERSON,PERSON?1,FRONT-PORCH >V
	JUMP ?L7
?L3:	EQUAL? IGOAL,MONICA-ROOM \?L4
	FSET MONICA-DOOR,OPENBIT
	CALL MOVE-PERSON,PERSON?1,HALL-2 >V
	JUMP ?L7
?L4:	EQUAL? IGOAL,HALL-2 \?L5
	FSET MONICA-DOOR,OPENBIT
	CALL MOVE-PERSON,PERSON?1,MONICA-ROOM >V
	JUMP ?L7
?L5:	EQUAL? IGOAL,HALL-4 \?L6
	CALL MOVE-PERSON,PERSON?1,HALL-3 >V
	JUMP ?L7
?L6:	CALL MOVE-PERSON,PERSON?1,HALL-4 >V
?L7:	CALL ESTABLISH-GOAL,PERSON?1,FGOAL
	RETURN V

	.FUNCT WHERE-UPDATE,PERSON?1,FLG=0,WT,NC,CNT=0
	GETP PERSON?1,P?CHARACTER >NC
	GET WHERE-TABLES,NC >WT
?L1:	GRTR? CNT,CHARACTER-MAX /TRUE
	EQUAL? CNT,NC /?L6
	ZERO? CNT \?L8
	ZERO? FLG \?L7
?L8:	LOC PERSON?1 >STACK
	GET CHARACTER-TABLE,CNT >STACK
	IN? STACK,STACK \?L6
?L7:	PUT WT,CNT,PRESENT-TIME
	GET WHERE-TABLES,CNT >STACK
	PUT STACK,NC,PRESENT-TIME
?L6:	INC 'CNT
	JUMP ?L1

	.FUNCT I-PHONG-UNCALLED
	GET GOAL-TABLES,PHONG-C >STACK
	GET STACK,GOAL-S >STACK
	ZERO? STACK \FALSE
	CALL ESTABLISH-GOAL,PHONG,PHONG-OLD-LOC
	LOC PHONG >STACK
	EQUAL? STACK,HERE \FALSE
	CALL SAID-TO,PHONG
	PRINTI "Inscrutably, Phong turns to leave."
	ZERO? PLAYER-HIDING /?L9
	CALL FIND-FLAG,HERE,PERSON,PHONG >STACK
	ZERO? STACK /?L7
?L9:	PRINTI " ""If you need me again, just ring."""
?L7:	CRLF
	RTRUE

	.FUNCT I-PHONG,GARG=0,L,MPB
	LOC PHONG >L
	SET 'MPB,MONICA-PUSHED-BUTTON
	ZERO? GARG \?L1
	CALL IMOVEMENT,PHONG,I-PHONG >STACK
	RSTACK
?L1:	EQUAL? GARG,G-REACHED \FALSE
	ZERO? PHONG-CALLED /?L4
	SET 'PHONG-CALLED,0
	SET 'MONICA-PUSHED-BUTTON,0
	CALL QUEUE,I-PHONG-UNCALLED,3 >STACK
	PUT STACK,0,1
	EQUAL? L,HERE \FALSE
	ZERO? PLAYER-HIDING /?L8
	CALL FIND-FLAG,HERE,PERSON,PHONG >STACK
	ZERO? STACK \?L8
	PRINTI "Suddenly Phong appears and "
	PRINTR "looks around to see who pushed the button."
?L8:	CALL SAID-TO,PHONG
	PRINTI "Suddenly Phong appears and "
	PRINTI "says, ""You rang?"""
	CRLF
	ZERO? MPB /TRUE
	PRINTI "Monica says, ""Yes, Phong, I was testing a new twist on the household wiring that I thought of during the film."
	ZERO? MONICA-TIED-TO /?L19
	PRINTR " Can't you talk this copper into letting me loose?"" Phong opens his eyes wide for a moment but says nothing."
?L19:	PRINTR """"
?L4:	EQUAL? L,OFFICE \?L28
	ZERO? PHONG-SEEN-CORPSE? \?L31
	FSET? CORPSE,INVISIBLE \?L29
?L31:	EQUAL? HERE,OFFICE \FALSE
	CALL SAID-TO,PHONG
	PRINTR "Suddenly Phong enters the office. ""I believe you called for me, Detective."""
?L29:	SET 'PHONG-SEEN-CORPSE?,1
	EQUAL? HERE,OFFICE \FALSE
	PRINTR "Suddenly Phong enters the office. When he sees that Linder has cashed in his chips, he turns away for a minute and bows his head."
?L28:	EQUAL? L,OFFICE-PATH \?L43
	CALL QUEUE,I-STILES-ARRIVE,4 >STACK
	PUT STACK,0,1
	MOVE OUTSIDE-GUN,OFFICE-PATH
	FCLEAR OUTSIDE-GUN,INVISIBLE
	FCLEAR SIDE-FOOTPRINTS,INVISIBLE
	CALL ESTABLISH-GOAL,PHONG,FRONT-PORCH >STACK
	RSTACK
?L43:	EQUAL? L,FRONT-PORCH \?L44
	EQUAL? HERE,FRONT-PORCH \?L45
	PRINTI "The butler comes up to you, looking agitated."
	CRLF
	JUMP ?L49
?L45:	PRINTI "You hear the door bell ring."
	CRLF
?L49:	MOVE PHONG,ENTRY
	FCLEAR MUDDY-SHOES,INVISIBLE
	CALL ESTABLISH-GOAL,PHONG,OFFICE >STACK
	RSTACK
?L44:	EQUAL? L,ENTRY \?L52
	EQUAL? HERE,ENTRY \?L53
	PRINTI "Phong arrives and lets Sergeant Duffy in."
	CRLF
?L53:	CALL ESTABLISH-GOAL,PHONG,LIVING-ROOM
	CALL ESTABLISH-GOAL,STILES,LIVING-ROOM >STACK
	RSTACK
?L52:	EQUAL? L,LIVING-ROOM \?L58
	CALL ESTABLISH-GOAL,PHONG,KITCHEN >STACK
	RSTACK
?L58:	EQUAL? L,BUTLER-ROOM \FALSE
	CALL META-LOC,RECURSIVE-BOOK >STACK
	EQUAL? STACK,BUTLER-ROOM \?L60
	IN? RECURSIVE-BOOK,PLAYER /?L60
	MOVE RECURSIVE-BOOK,PHONG
?L60:	IN? PLAYER,BUTLER-ROOM \TRUE
	PRINTR "Suddenly Phong comes in, lies down, and starts reading a book."

	.FUNCT I-STILES,GARG=0,L
	LOC STILES >L
	ZERO? GARG \?L1
	CALL IMOVEMENT,STILES,I-STILES >STACK
	RSTACK
?L1:	EQUAL? GARG,G-REACHED \FALSE
	EQUAL? L,OFFICE-PORCH \?L4
	ZERO? WELCOMED /?L6
	EQUAL? HERE,OFFICE \FALSE
	CRLF
	PRINTI "Linder looks toward the window and says, ""I don't think Phong has answered the door bell yet."" He reaches toward the butler's button and at the same instant shouts ""Stiles!"" You turn around and dimly see a figure outside."
	CALL FIRE-SHOT
	PRINTI " The figure outside turns and runs before you can see the face. When you turn back around, you see Linder slumping down in his chair, with a bloody stain spreading across his silk shirt. He teeters on the edge of the seat, then falls onto the floor, quite dead."
	CRLF
	CALL PRINT-ID,STR?98
	REMOVE LINDER
	SET 'QCONTEXT,0
	SET 'LINDER-FOLLOWS-YOU,0
	CALL ROB,LINDER,CORPSE
	FCLEAR CORPSE,INVISIBLE
	SET 'LINDER-FOLLOWS-YOU,0
	CALL INT,I-LINDER-IN-OFFICE >STACK
	PUT STACK,0,0
	CALL INT,I-PHONG-RETIRES >STACK
	PUT STACK,0,0
	CALL INT,I-LINDER-RETIRES >STACK
	PUT STACK,0,0
	CALL QUEUE,I-AMBULANCE,150 >STACK
	PUT STACK,0,1
	MOVE STILES,LIMBO
	FSET STILES,INVISIBLE
	GET GOAL-TABLES,STILES-C >STACK
	PUT STACK,GOAL-S,0
	FCLEAR BACK-FOOTPRINTS,INVISIBLE
	CALL QUEUE,I-DUFFY-ARRIVE,3 >STACK
	PUT STACK,0,1
	SET 'MURDER-TIME,PRESENT-TIME
	RETURN 2
?L6:	FCLEAR BACK-GATE,LOCKED
	SET 'TOO-LATE,1
	CALL ESTABLISH-GOAL,STILES,OFFICE-PATH
	CALL QUEUE,I-DUFFY-ARRIVE,5 >STACK
	PUT STACK,0,1
	EQUAL? HERE,BACK-YARD,ROCK-GARDEN \?L18
	FSET? STILES,TOUCHBIT \?L20
	PRINTI "Stiles"
	JUMP ?L24
?L20:	PRINTI "The visitor"
?L24:	PRINTI " comes up to Linder's office entrance. A tall man opens the office door and steps out. They speak briefly, then the tall man counts out some money and sends "
	FSET? STILES,TOUCHBIT \?L29
	PRINTI "Stiles"
	JUMP ?L33
?L29:	PRINTI "the person"
?L33:	PRINTR " away."
?L18:	EQUAL? HERE,OFFICE-PORCH \?L38
	FSET? STILES,TOUCHBIT \?L39
	PRINTI "Stiles"
	JUMP ?L43
?L39:	PRINTI "The visitor"
?L43:	PRINTI " pushes you out of the way and"
	PRINTR " knocks on the door of Linder's office. A tall man opens it, speaks to him briefly, hands him some money, and sends him away."
?L38:	EQUAL? HERE,OFFICE-PATH \FALSE
	FSET? STILES,TOUCHBIT \?L49
	PRINTI "Stiles"
	JUMP ?L53
?L49:	PRINTI "The visitor"
?L53:	PRINTR " knocks on the door of Linder's office. A tall man opens it, speaks to him briefly, hands him some money, and sends him away."
?L4:	EQUAL? L,OFFICE-PATH \?L59
	REMOVE STILES
	GET GOAL-TABLES,STILES-C >STACK
	PUT STACK,GOAL-S,0
	GETP HERE,P?CORRIDOR >STACK
	BAND STACK,3 >STACK
	ZERO? STACK /FALSE
	FSET? STILES,TOUCHBIT \?L62
	PRINTI "Stiles"
	JUMP ?L66
?L62:	PRINTI "The visitor"
?L66:	PRINTR " disappears out the back gate."
?L59:	EQUAL? L,FRONT-PORCH \?L72
	EQUAL? HERE,FRONT-PORCH \?L73
	CALL I-MEET-DUFFY?
	JUMP ?L75
?L73:	PRINTI "You hear the door bell ring."
	CRLF
?L75:	CALL ESTABLISH-GOAL,PHONG,ENTRY >STACK
	RSTACK
?L72:	EQUAL? L,LIVING-ROOM \FALSE
	SET 'DUFFY-WITH-STILES,0
	EQUAL? HERE,LIVING-ROOM \?L79
	ZERO? MET-DUFFY? /?L81
	PRINTI "Duffy brings a prisoner into the room and fastens him to the davenport."
	PRINTR " He goes quickly to work, disappearing down the hall."
?L81:	PRINTI "Suddenly "
	PRINTI "Duffy brings a prisoner into the room and fastens him to the davenport."
	PRINTI " Then he notices you."
	CALL DUFFY-GREETING
	PRINTI """"
	PRINTR " He goes quickly to work, disappearing down the hall."
?L79:	ZERO? MET-DUFFY? \?L92
	PRINTI "Suddenly your assistant, Sgt. Duffy, "
	ZERO? SEEN-DUFFY? /?L95
	PRINTI "runs up to you."
	JUMP ?L99
?L95:	PRINTI "appears from out of nowhere."
?L99:	CALL DUFFY-GREETING
	PRINTR " I've stowed him in the living room. I'll stand by to help you."" He scurries off to go about his work."
?L92:	EQUAL? HERE,HALL-1,HALL-2 /?L105
	EQUAL? HERE,HALL-3,HALL-4 \FALSE
?L105:	PRINTR "Duffy goes quickly to work, disappearing down the hall."

	.FUNCT ROB,WHAT,THIEF,PROB=0,N,X,ROBBED?=0
	FIRST? WHAT >X /?L4
	RETURN ROBBED?
?L1:	ZERO? X \?L4
	RETURN ROBBED?
?L4:	NEXT? X >N /?L7
?L7:	FSET? X,INVISIBLE /?L8
	ZERO? PROB /?L10
	RANDOM 100 >STACK
	GRTR? PROB,STACK \?L8
?L10:	MOVE X,THIEF
	SET 'ROBBED?,1
?L8:	SET 'X,N
	JUMP ?L1

	.FUNCT I-MONICA,GARG=0,L,HR,?TMP
	LOC MONICA >L
	ZERO? GARG \?L1
	CALL IMOVEMENT,MONICA,I-MONICA >STACK
	RSTACK
?L1:	EQUAL? GARG,G-REACHED \FALSE
	EQUAL? L,OFFICE \?L4
	LESS? PRESENT-TIME,540 \?L4
	CALL ESTABLISH-GOAL,MONICA,GARAGE
	LOC PLAYER >STACK
	EQUAL? OFFICE,HERE,STACK /?L8
	EQUAL? HERE,OFFICE-PORCH \FALSE
	EQUAL? PRSA,V?LOOK-INSIDE \FALSE
?L8:	LOC PLAYER >STACK
	EQUAL? OFFICE,HERE,STACK \?L9
	PRINTI "Monica"
	JUMP ?L13
?L9:	EQUAL? HERE,OFFICE-PORCH \?L13
	PRINTI "A young woman"
?L13:	PRINTI " bursts into the office, wearing a felt hat and wool coat, and struggling to get her driving gloves on. "
	LOC PLAYER >STACK
	EQUAL? OFFICE,HERE,STACK \?L19
	CALL QUEUE,I-MONICA-GOES,5 >STACK
	PUT STACK,0,1
	CALL THIS-IS-S-HE,MONICA
	PRINTR "She glances icily in your direction and then back to her father. ""I'm off to the pictures with Terry, Dad. Good-bye."" She hugs him briefly but firmly, burying her head in his shoulder. He pushes her away and says, ""You're leaving now?! I thought you'd be talking to the detective here. What about the threat on my life?"" He has the hurt look of an orphan pup. She answers, ""You don't need me here. I need to get away now and then. I'm not like Mother, you know."" Tears well up in her eyes but she brushes them away before they drop. She turns to leave."
?L19:	EQUAL? HERE,OFFICE-PORCH \FALSE
	PRINTR "She glances quickly around the room, then turns to leave."
?L4:	EQUAL? L,GARAGE \?L28
	LESS? PRESENT-TIME,540 \?L28
	CALL UNPRIORITIZE,MONICA
	SET 'FILM-SEEN,1
	FSET GARAGE-DOOR,LOCKED
	FCLEAR GARAGE-DOOR,OPENBIT
	MOVE MONICA,LIMBO
	FSET MONICA,INVISIBLE
	GET GOAL-TABLES,MONICA-C >STACK
	PUT STACK,GOAL-S,0
	GET GOAL-TABLES,MONICA-C >STACK
	PUT STACK,GOAL-ENABLE,0
	FSET MONICA-CAR,INVISIBLE
	SUB 670,PRESENT-TIME >?TMP
	RANDOM 20 >STACK
	SUB ?TMP,STACK >STACK
	CALL QUEUE,I-MONICA-RETURN,STACK >STACK
	PUT STACK,0,1
	EQUAL? HERE,GARAGE,DRIVEWAY /?L31
	EQUAL? HERE,DRIVEWAY-ENTRANCE,WORKSHOP \?L29
?L31:	PRINTI "Someone"
	PRINTR " jumps into her car, starts it up, and races out the driveway, leaving a wake of peastone behind her."
?L29:	GETP HERE,P?LINE >STACK
	EQUAL? OUTSIDE-LINE-C,STACK \?L36
	PRINTR "Without warning, a car roars to life and speeds out of the driveway."
?L36:	PRINTR "Outside somewhere, a car roars to life and speeds away."
?L28:	EQUAL? L,WORKSHOP \?L42
	SET 'BUTTON-FIXED,1
	CALL ESTABLISH-GOAL,MONICA,OFFICE
	EQUAL? HERE,WORKSHOP \FALSE
	CALL SAID-TO,MONICA
	CALL THIS-IS-S-HE,MONICA
	SET 'SEEN-MONICA-AT-J-BOX,1
	PRINTI "Suddenly Monica rushes in, goes to the junction box, and fiddles with the wires for a minute. Then she turns, sees you, gasps and grabs her throat. ""My"
	CALL PRINT-ID,STR?99
	CALL TANDY? >STACK
	ZERO? STACK \?L47
	PRINTI " God"
?L47:	PRINTR ", you gave me a start!"" Her face is ashen."
?L42:	EQUAL? L,OFFICE \?L55
	ZERO? MONICA-SEEN-CORPSE? \?L55
	CALL ESTABLISH-GOAL,MONICA,TOILET-ROOM
	ZERO? TOO-LATE \?L58
	FSET? CORPSE,INVISIBLE /?L56
?L58:	SET 'MONICA-SEEN-CORPSE?,1
?L56:	EQUAL? HERE,OFFICE,OFFICE-PORCH \FALSE
	CALL THIS-IS-S-HE,MONICA
	FSET? MONICA,TOUCHBIT \?L62
	PRINTI "Monica"
	JUMP ?L66
?L62:	PRINTI "Someone"
?L66:	PRINTI " walks gingerly into the office, "
	FSET? CORPSE,INVISIBLE /?L71
	PRINTI "opens her eyes wide in horror, and then puts her hand over her mouth and"
	JUMP ?L75
?L71:	PRINTI "looks around quickly, and then"
?L75:	PRINTR " rushes toward the door."
?L55:	EQUAL? L,TOILET-ROOM \?L81
	EQUAL? HERE,TOILET-ROOM \?L82
	CALL SAID-TO,MONICA
	CALL THIS-IS-S-HE,MONICA
	PRINTR "Monica rushes in. ""Stand aside, flatfoot, I'm going to be sick."" She leans over the toilet and gives in to an attack of dry heaves."
?L82:	EQUAL? HERE,BATHROOM,TUB-ROOM /?L87
	EQUAL? HERE,LINDER-ROOM,MONICA-ROOM \FALSE
?L87:	FCLEAR TOILET-DOOR,OPENBIT
	PRINTR "The door to the toilet room slams shut. You hear sounds of dry heaving inside."
?L81:	EQUAL? L,MONICA-ROOM \?L91
	ZERO? CLOCK-FIXED \?L91
	EQUAL? HERE,MONICA-ROOM \?L92
	CALL SAID-TO,MONICA
	CALL THIS-IS-S-HE,MONICA
	PRINTR "Monica comes in, sits down on her bed, and buries her face in her hands. ""Leave me alone for a while. I'm really not well."" She begins to sob."
?L92:	EQUAL? HERE,BATHROOM /?L97
	EQUAL? HERE,HALL-1,HALL-2,HALL-3 \FALSE
?L97:	FCLEAR MONICA-DOOR,OPENBIT
	FCLEAR MONICA-BATH-DOOR,OPENBIT
	FCLEAR MONICA-BACK-DOOR,OPENBIT
	PRINTR "Monica slams shut her bedroom doors."
?L91:	EQUAL? L,OFFICE \?L101
	EQUAL? HERE,OFFICE \?L102
	ZERO? PLAYER-HIDING \?L102
	GET MOVEMENT-GOALS,MONICA-C >STACK
	SUB STACK,MG-LENGTH >STACK
	PUT MOVEMENT-GOALS,MONICA-C,STACK
	CALL ESTABLISH-GOAL,MONICA,MONICA-ROOM
	CALL THIS-IS-S-HE,MONICA
	PRINTR "Monica comes into the office quietly and, seeing you, steps over to the desk and shuffles some papers. Then she sighs, rubs her eyes, and turns to leave without saying a word."
?L102:	MOVE INSIDE-GUN,MONICA
	FSET CLOCK,LOCKED
	FCLEAR CLOCK,OPENBIT
	SET 'CLOCK-FIXED,1
	SET 'MONICA-PUSHED-BUTTON,1
	SET 'HR,HERE
	SET 'HERE,OFFICE
	CALL YOU-RANG
	SET 'HERE,HR
	EQUAL? HERE,OFFICE-PORCH \?L110
	EQUAL? PRSA,V?LOOK-INSIDE /?L109
?L110:	ZERO? PLAYER-HIDING /?L107
	EQUAL? HERE,OFFICE \?L107
?L109:	FCLEAR CLOCK-KEY,INVISIBLE
	SET 'SEEN-MONICA-AT-CLOCK,1
	ZERO? USED-CLOCK-KEY \?L111
	PRINTI "[RWD_ID: events:1460, VAL: 1]"
?L111:	FSET? MONICA,TOUCHBIT \?L116
	PRINTI "Monica"
	JUMP ?L120
?L116:	PRINTI "Someone"
?L120:	CALL THIS-IS-S-HE,MONICA
	PRINTR " quietly sticks her head in the door, looks quickly around the room, and then steps over to the desk. She pushes the butler's button and seems to listen for the bell. She takes another look around, then crosses the room to the clock. Looking well rehearsed, she produces a key, opens the door of the case, takes something out and puts it in the pocket of her slacks, and then shuts and locks the case."
?L107:	CRLF
	PRINTR "You barely hear a bell ring in the distance."
?L101:	EQUAL? L,MONICA-ROOM \FALSE
	EQUAL? HERE,ROCK-GARDEN,BACK-YARD,OFFICE-PORCH \?L129
	PRINTR "The lights go out in the middle bedroom."
?L129:	EQUAL? HERE,MONICA-ROOM \?L133
	CALL THIS-IS-S-HE,MONICA
	CALL SAID-TO,MONICA
	PRINTR "Monica comes in and sits down at her dressing table. Her eyes are red from crying. ""Go peddle your cookies somewhere else. I'm going to have some Ovaltine and go to bed."""
?L133:	EQUAL? HERE,BATHROOM /?L137
	EQUAL? HERE,HALL-1,HALL-2,HALL-3 \FALSE
?L137:	FCLEAR MONICA-DOOR,OPENBIT
	FCLEAR MONICA-BATH-DOOR,OPENBIT
	FCLEAR MONICA-BACK-DOOR,OPENBIT
	PRINTR "Monica slams shut her bedroom doors."

	.FUNCT I-MONICA-GOES
	IN? MONICA,OFFICE \FALSE
	CALL ESTABLISH-GOAL,MONICA,GARAGE,1
	SET 'MONICA-DASHED-OUT-DOOR,1
	PRINTR "Monica looks more nervous. ""I really must go now, or I'll be late for the film."" She hugs her father again and dashes out the door."

	.FUNCT I-MONICA-RETURN
	FCLEAR MONICA,INVISIBLE
	MOVE MONICA,GARAGE
	MOVE STUB,GARAGE
	FCLEAR MONICA-CAR,INVISIBLE
	CALL ESTABLISH-GOAL,MONICA,WORKSHOP
	GET GOAL-TABLES,MONICA-C >STACK
	PUT STACK,GOAL-ENABLE,1
	EQUAL? HERE,GARAGE,DRIVEWAY,DRIVEWAY-ENTRANCE \?L1
	FSET? MONICA,TOUCHBIT \?L3
	PRINTI "Monica"
	JUMP ?L7
?L3:	PRINTI "Someone"
?L7:	PRINTR " drives into the garage, stops her car, jumps out, and slams the door."
?L1:	PRINTR "Suddenly you hear a car drive into the garage and stop. Its door slams."

	.FUNCT I-AMBULANCE
	REMOVE CORPSE
	ZERO? PLAYER-HIDING /?L1
	PRINTI "Out of the blue, "
	PRINTI "two"
	PRINTI " of the coroner's men run"
	PRINTI " in to the office with a stretcher and carry Linder's body out."
	JUMP ?L5
?L1:	EQUAL? HERE,OFFICE,OFFICE-PORCH,OFFICE-PATH \?L6
	PRINTI "Out of the blue, "
	PRINTI "two"
	PRINTI " of the coroner's men run"
	PRINTI " in to the office with a stretcher and carry Linder's body out. "
	PRINTI "One of them shouts to you, """
	JUMP ?L10
?L6:	PRINTI "Out of the blue, "
	PRINTI "one"
	PRINTI " of the coroner's men run"
	PRINTI "s up to you and says, ""We just removed the body. "
?L10:	PRINTI "Haven't time to chat. Busy night at the morgue! Carry on, Detective."""
?L5:	ZERO? FINGERPRINT-OBJ \?L15
	ZERO? DUFFY-AT-CORONER \?L15
	SET 'DUFFY-AT-CORONER,1
	CALL QUEUE,I-DUFFY-RETURNS,69 >STACK
	PUT STACK,0,1
	PRINTI " Then Duffy appears, saying, ""I'm glad they finally showed up! When I called, they seemed very busy. I think I should go along and make sure they give this autopsy top priority."
	ZERO? PLAYER-HIDING /?L19
	PRINTI " Don't worry, I won't tell anyone you're hiding."
?L19:	PRINTI " See you later!"""
?L15:	PRINTR " They head for the street."

	.FUNCT I-DUFFY-RETURNS
	SET 'DUFFY-AT-CORONER,0
	PRINTI "Without warning, Duffy comes running up to you and says, ""I just got back from the morgue. The coroner "
	ZERO? DUFFY-SAW-MEDICAL-REPORT /?L3
	CALL META-LOC,MONICA >STACK
	EQUAL? STACK,HERE \?L5
	SET 'MONICA-SAW-CORONER-REPORT,1
?L5:	PRINTI "found no evidence of the alleged stomach tumor. In fact, he could find no organic disease that would either explain the death or support the theory that Linder wanted to die. He "
?L3:	PRINTI "concluded that Linder died of a single small-caliber bullet through the heart. And here's something peculiar: there were no traceable rifle marks on the bullet."
	PRINTR """"

	.FUNCT DUFFY-HINT
	ZERO? MET-DUFFY? \?L1
	PRINTI "You'd better wait until Duffy "
	PRINTR "sees you."
?L1:	ZERO? DUFFY-WITH-STILES /?L5
	PRINTI "You'd better wait until Duffy "
	PRINTR "stows his prisoner."
?L5:	PRINTI "Duffy appears and says, "
	FSET? CORPSE,INVISIBLE \?L11
	PRINTR """If I were you, I'd wait until some crime occurred."""
?L11:	INC 'DUFFY-HINT-NUM
	PRINTI """I don't know if it means anything, Detective, but I noticed "
	FSET? PIECE-OF-WIRE,TOUCHBIT /?L18
	PRINTR "a piece of green wire on the broken office window."""
?L18:	ZERO? NO-WIRE-HINT /?L22
	SET 'NO-WIRE-HINT,0
	PRINTR "a green spool in the workshop."""
?L22:	ZERO? BUTTON-FIXED \?L25
	ZERO? PLAYER-PUSHED-BUTTON \?L25
	PRINTR "that the butler's button in the office wasn't working right."""
?L25:	ZERO? POWDER-ANALYZED \?L28
	PRINTR "something funny about the clock in the office."""
?L28:	FSET? GUN-RECEIPT,TOUCHBIT /?L31
	PRINTR "a very interesting book in Phong's room."""
?L31:	FSET? MEDICAL-REPORT,TOUCHBIT /?L34
	PRINTR "some kind of medical report in Monica's room."""
?L34:	ZERO? MONICA-HAS-MOTIVE \?L37
	PRINTR "Monica's reaction when I asked her about her mother."""
?L37:	ZERO? SEEN-MONICA-AT-J-BOX \?L40
	PRINTR "that Monica went in the workshop right when she got home."""
?L40:	PRINTR "that I've run out of ideas on this case."""

	.FUNCT ARREST,PERSON?1,HELPER=0,FLG,?TMP
	ZERO? HELPER /?L11
	EQUAL? PERSON?1,MONICA \?L5
	EQUAL? HELPER,PHONG /?L3
?L5:	EQUAL? HELPER,MONICA \?L6
	EQUAL? PERSON?1,PHONG /?L3
?L6:	PRINTI "You think it over. You realize that this arrest is pretty far-fetched. It could only mean humiliation for you."
	CRLF
	FSET? PERSON?1,PERSON /?L9
	PUSH 0
	JUMP ?L10
?L9:	PUSH 1
?L10:	CALL PRINT-ID,STR?100,STACK
	RTRUE
?L3:	SET 'PERSON?1,MONICA
	SET 'HELPER,PHONG
?L11:	EQUAL? PERSON?1,MONICA \?L13
	IN? MONICA,LIMBO \?L13
	PRINTI "Duffy appears with a solemn look."
	PRINTR " He says, ""I can't find Monica around here anywhere. I guess you'll have to wait for her to return."" He disappears again."
?L13:	PRINTI "(If you want to continue from this point at another time, you must ""SUSPEND"" first.) Do you want to "
	PRINTI "make an arrest and "
	PRINTI "stop your investigation now?"
	CALL YES? >STACK
	ZERO? STACK /TRUE
	EQUAL? PERSON?1,GLOBAL-LINDER,CORPSE \?L25
	PRINTI "Duffy appears, to escort you from the grounds. "
	PRINTI """So you believe that Linder's death was suicide? I'm not convinced. But if you'll "
	PRINTI "file a deposition, we can see what the D.A. and coroner think.""
"
	CRLF
	JUMP ?L29
?L25:	ZERO? HELPER /?L30
	SET '?TMP,HERE
	CALL META-LOC,MONICA >STACK
	EQUAL? ?TMP,STACK \?L32
	IN? HELPER,HERE \?L32
	PRINTI "Duffy appears with a solemn look."
	ZERO? MONICA-TIED-TO /?L36
	PRINTI " He unfastens Monica from the "
	PRINTD MONICA-TIED-TO
	PRINTI "."
?L36:	PRINTI " He puts nippers on the wrists of both "
	PRINTD PERSON?1
	PRINTI " and "
	PRINTD HELPER
	PRINTI ", who stand stiff and quiet."
	JUMP ?L74
?L32:	SET '?TMP,HERE
	CALL META-LOC,MONICA >STACK
	EQUAL? ?TMP,STACK \?L43
	PRINTI "Duffy appears with "
	PRINTD HELPER
	PRINTI " in tow."
	ZERO? MONICA-TIED-TO /?L46
	PRINTI " He unfastens Monica from the "
	PRINTD MONICA-TIED-TO
	PRINTI "."
?L46:	PRINTI " He puts nippers on the wrists of "
	PRINTD PERSON?1
	PRINTI ", who stands stiff and quiet."
	JUMP ?L74
?L43:	IN? HELPER,HERE \?L53
	PRINTI "Duffy appears with "
	PRINTD PERSON?1
	PRINTI " in tow."
	PRINTI " He puts nippers on the wrists of "
	PRINTD HELPER
	PRINTI ", who stands stiff and quiet."
	JUMP ?L74
?L53:	PRINTI "Duffy seems to read your thoughts, as he appears with "
	PRINTD PERSON?1
	PRINTI " and "
	PRINTD HELPER
	PRINTI " in handcuffs."
	JUMP ?L74
?L30:	SET '?TMP,HERE
	CALL META-LOC,PERSON?1 >STACK
	EQUAL? ?TMP,STACK \?L61
	PRINTI "Duffy appears with a solemn look."
	EQUAL? PERSON?1,STILES \?L64
	PRINTI " He unfastens his nippers from the davenport and pulls Stiles to his feet."
	JUMP ?L74
?L64:	EQUAL? PERSON?1,MONICA \?L68
	ZERO? MONICA-TIED-TO /?L68
	PRINTI " He unfastens Monica from the "
	PRINTD MONICA-TIED-TO
	PRINTI ", pulls her to her feet, and puts his own nippers on her wrists."
	JUMP ?L74
?L68:	PRINTI " He puts nippers on the wrists of "
	PRINTD PERSON?1
	PRINTI ", who stands stiff and quiet."
	JUMP ?L74
?L61:	PRINTI "Duffy seems to read your thoughts, as he appears with "
	PRINTD PERSON?1
	PRINTI " in handcuffs."
?L74:	ZERO? MONICA-TIED-TO /?L77
	EQUAL? PERSON?1,MONICA \?L77
	CALL RELEASE-MONICA
?L77:	PRINTI " ""Let's not have any trouble, now,"" says Duffy, in his unique way. They head for the driveway, where a police car waits with engine purring.
"
	CRLF
?L29:	CALL END-HEADER,STR?101
	ZERO? MONICA-ADMITTED-HELPING? \?L85
	ZERO? PHONG-ADMITTED-HELPING? \?L85
	ZERO? PLAYER-PUSHED-BUTTON /?L82
	ZERO? POWDER-ANALYZED \?L85
	FSET? INSIDE-GUN,TOUCHBIT \?L82
?L85:	PRINTI "The elaborate set-up in Mr. Linder's office was ingenious. You deserve congratulations for your work in detecting it.
"
	CRLF
	CALL PRINT-ID,STR?102
	EQUAL? PERSON?1,STILES \?L88
	PRINTI "I am sorry to report that the trial jury acquitted Ralph Stiles of the murder of his rival, Freeman Linder. In view of the available evidence, they apparently believed that his lack of access to the Linder house made it doubtful that he could construct the hidden gun mechanism."
	JUMP ?L207
?L88:	EQUAL? PERSON?1,GLOBAL-LINDER \?L92
	FSET? MEDICAL-REPORT,TOUCHBIT \?L93
	PRINTI "At the inquest, the coroner ruled that "
	PRINTI "Mr. Linder's death was suicide, based on all the available evidence. However, my knowledge of Linder's personality makes me doubt that, knowing he would be killed, he would devise such an elaborate scheme to try to punish Mr. Stiles for the affair with Mrs. Linder. "
	JUMP ?L97
?L93:	PRINTI "At the inquest, the coroner ruled that "
	PRINTI "the available evidence was inconclusive, in that Linder appears to have had no motive for suicide. "
?L97:	PRINTI "I think that, if you had been more careful in observing the people in Linder's household, you would have discovered that he had an accomplice, at least.
"
	JUMP ?L207
?L92:	ZERO? HELPER /?L102
	FSET? GUN-RECEIPT,TOUCHBIT \?L102
	ZERO? MONICA-HAS-MOTIVE /?L102
	ZERO? SEEN-MONICA-AT-CLOCK \?L103
	ZERO? USED-CLOCK-KEY /?L102
?L103:	PRINTI "The web of evidence certainly seems to implicate both Monica Linder and Mr. Phong. During interrogation, Phong admitted helping Mr. Linder carry out the plan to frame Mr. Stiles for attempted murder, but he repeatedly denied that Linder's death was intended. He bargained with the District Attorney and entered a plea of guilty to charges of conspiracy and extortion. After a short trial, the judge gave him a suspended sentence and recommended him for deportation to his home country.
"
	CRLF
	PRINTI "Monica turned out to be a tougher nut to crack. She refused to talk during interrogation, and she was awaiting trial when she heard about Phong's suspended sentence. She then made a plea like his, and the judge had little choice but to give her the same sentence. Instead of deportation, she will be on probation for five years.
"
	CRLF
	PRINTI "I can't help thinking that everyone in the Linder household conspired in the original plan, but that Monica acted alone in turning the plan into murder. I suppose we'll never know the real truth now."
	JUMP ?L207
?L102:	EQUAL? PHONG,PERSON?1,HELPER \?L106
	PRINTI "I am sorry to report that the trial jury acquitted Mr. Phong of the murder of his employer. Apparently they believed that "
	FSET? GUN-RECEIPT,TOUCHBIT /?L109
	PRINTI "the available evidence against him was circumstantial, since there was no definite link between him and the murder weapon. In addition, it seems that "
?L109:	PRINTI "he lacks the mechanical skills necessary to construct the hidden gun mechanism.
"
	CRLF
	ZERO? HELPER /?L207
	PRINTI "While Monica could have conspired with him and aided him, she too was acquitted of conspiracy, because "
	FSET? GUN-RECEIPT,TOUCHBIT /?L120
	PRINTI "he was. If only we had tried her for plain murder instead of conspiracy!
"
	CRLF
	JUMP ?L207
?L120:	ZERO? MONICA-HAS-MOTIVE /?L124
	PRINTI "the available evidence against her was circumstantial, since there was no definite link between her and the hidden gun mechanism.
"
	CRLF
	JUMP ?L207
?L124:	ZERO? SEEN-MONICA-AT-CLOCK \?L128
	ZERO? USED-CLOCK-KEY /?L207
?L128:	PRINTI "she had no apparent motive.
"
	CRLF
	JUMP ?L207
?L106:	EQUAL? PERSON?1,MONICA \?L207
	ZERO? MONICA-HAS-MOTIVE /?L134
	ZERO? SEEN-MONICA-AT-CLOCK \?L138
	ZERO? USED-CLOCK-KEY /?L136
?L138:	PRINTI "I am glad to report that the trial jury, based on your testimony and her confession in court, convicted Monica Linder of the murder of her father in revenge for the[RWD_ID: events:1785, VAL: 3] death of her mother. Congratulations [EVENT: GAME OVER]"
	ZERO? DUFFY-HINT-NUM \?L141
	PUSH STR?103
	JUMP ?L144
?L141:	GRTR? 3,DUFFY-HINT-NUM \?L143
	PUSH STR?104
	JUMP ?L144
?L143:	PUSH STR?105
?L144:	PRINT STACK
	CRLF
	PRINTI "Which reminds me of another fascinating case I would like to assign you to...

Coming soon: Another INTERLOGIC Mystery from Infocom.
"
	CALL PRINT-ID,STR?106
	CALL EPILOGUE
	JUMP ?L207
?L136:	PRINTI "I am sorry to report that the trial jury acquitted Monica Linder of the murder of her father. Apparently they believed that "
	PRINTI "the available evidence against her was circumstantial, since there was no definite link between her and the hidden gun mechanism.
"
	CRLF
	JUMP ?L207
?L134:	PRINTI "I am sorry to report that the trial jury acquitted Monica Linder of the murder of her father, because "
	PRINTI "she had no apparent motive.
"
	CRLF
	JUMP ?L207
?L82:	EQUAL? PERSON?1,GLOBAL-LINDER \?L153
	PRINTI "According to your report and deposition and the available physical evidence, you seem to believe that Mr. Linder shot himself through the window of his office. If you continue to come up with such odd conclusions, I will be forced to transfer you to the traffic-control department.
"
	CRLF
	CALL CASE-OVER
?L153:	PRINTI "According to your report and deposition, the only question in this case is who shot Mr. Linder through the window of his office. However, I believe that the real story is not so simple.
"
	CRLF
	EQUAL? PERSON?1,STILES /?L217
	PRINTI "In fact, in view of the flimsy evidence available, the District Attorney has decided not to indict "
	PRINTD PERSON?1
	ZERO? HELPER /?L164
	PRINTI " and "
	PRINTD HELPER
?L164:	PRINTI " in this case."
	EQUAL? PERSON?1,STILES \?L172
?L217:	SET 'STILES-CONVICTED,1
	PRINTI "But, despite my reservations, the trial jury did convict Mr. Stiles of the murder. Through plea-bargaining, his sentence was reduced from execution to twenty years."
	JUMP ?L207
?L172:	EQUAL? PERSON?1,MONICA \?L176
	ZERO? SEEN-MONICA-AT-J-BOX \?L177
	ZERO? HELPER /?L176
?L177:	ZERO? HELPER /?L178
	SET 'FLG,1
	ZERO? SIDE-FOOTPRINTS-MATCHED /?L180
	SET 'FLG,0
	PRINTI " In his opinion, Phong's foot prints outside are not incriminating, even though they were apparently made at the time of the shooting. After all, Phong's household duties could easily have taken him there for any number of reasons. In Phong's own deposition, he claimed to have heard noises outside, which could have been made by Mr. Stiles."
?L180:	ZERO? SEEN-MONICA-AT-J-BOX /?L185
	ZERO? FLG /?L187
	PRINTI " There is no evidence that "
	PRINTI "Phong"
	PRINTI " was at the scene of the shooting."
?L187:	PRINTI " Monica's actions in the workshop may be suspicious, but she claimed that she thought of a new twist on the household wiring during the film, and she seems to be enough of a tinkerer to make that believable."
	JUMP ?L207
?L185:	ZERO? FLG /?L194
	PRINTI " There is no evidence that "
	PRINTI "either one"
	PRINTI " was at the scene of the shooting."
	JUMP ?L207
?L194:	PRINTI " There is no evidence that "
	PRINTI "Monica"
	PRINTI " was at the scene of the shooting."
	JUMP ?L207
?L178:	ZERO? SEEN-MONICA-AT-J-BOX /?L207
	PRINTI " Monica's actions in the workshop may be suspicious, but she claimed that she thought of a new twist on the household wiring during the film, and she seems to be enough of a tinkerer to make that believable."
	JUMP ?L207
?L176:	EQUAL? PERSON?1,PHONG \?L204
	ZERO? SIDE-FOOTPRINTS-MATCHED /?L204
	PRINTI " In his opinion, Phong's foot prints outside are not incriminating, even though they were apparently made at the time of the shooting. After all, Phong's household duties could easily have taken him there for any number of reasons. In Phong's own deposition, he claimed to have heard noises outside, which could have been made by Mr. Stiles."
	JUMP ?L207
?L204:	PRINTI " There is no evidence that "
	EQUAL? PERSON?1,MONICA \?L210
	PRINTI "s"
?L210:	PRINTI "he"
	PRINTI " was at the scene of the shooting."
?L207:	CALL CASE-OVER >STACK
	RSTACK

	.FUNCT END-HEADER,STR
	PRINTI "Text of a letter from Police Chief Klutz dated "
	PRINT STR
	PRINTI ":

Dear Detective:

    "
	RTRUE

	.FUNCT CASE-OVER
	ZERO? STILES-CONVICTED /?L1
	PRINTI "

Post script: A few months later, after you are transferred to another department, you get a memo from your former boss. It says that new evidence was discovered in the Linder case, causing the court to reverse Stiles's conviction and set him free. Let's hope he doesn't come around bent on revenge!"
	CRLF
?L1:	PRINTI "

The case has come to an end. Would you like to start your investigation over from scratch?[EVENT: GAME OVER]"
	CALL YES? >STACK
	ZERO? STACK /?L8
	RESTART
?L8:	QUIT

	.FUNCT EPILOGUE
	PRINTI "
You have reached a complete solution to the story. If you like, you may see the author's summary of the case. Of course, you should come up with your own first! Would you like to see the author's summary?"
	CALL YES? >STACK
	ZERO? STACK /?L3
	PRINTI "
Freeman Linder discovered about a year ago that his wife had taken a lover, Ralph Stiles. This discovery made their marriage deteriorate, with growing bitterness and belligerence, until Mrs. Linder recently took her own life with a gun. Linder planned to take revenge on Stiles by framing him for attempted murder. He enlisted the help of his butler, Phong, and his daughter, Monica.
"
	CRLF
	PRINTI "Linder simultaneously sent two messages, a telegram to you and a phone call to Stiles. He wanted you to come to the house, witness the alleged crime, and then arrest Stiles. In the phone call he told Stiles to come discreetly to the office door at 9:00 to get some pay-off money.
"
	CRLF
	PRINTI "Linder planned an elaborate set-up inside the office. A gun was put in the clock, aiming through the keyhole toward him, who would be sitting behind his desk on the opposite side of the room. Using the butler's button, he would trigger both the gun and the detonation of some explosive attached to the window, thus simulating a shot fired through the window at him.
"
	CRLF
	PRINTI "Monica bought two identical small handguns for this plan. She hid one in the clock, and Phong planted the other, which was fired in secret beforehand, in the back yard just before 9:00, where you could find it later.
"
	CRLF
	PRINTI "When Stiles's car appeared, Phong went to the front door, rang the door bell as a signal to Linder, and sneaked into the house. Linder kept an eye on the window and, when Stiles appeared, pushed the button to fire the shot. Stiles panicked and fled out the back of the yard but was brought back inside by Sgt. Duffy.
"
	CRLF
	PRINTI "The plot thickened, however, because Monica decided to take this opportunity to murder her father. Her mother and she were very close. Mr. Linder was often away on business during Monica's childhood, and Mrs. Linder imbued her daughter with a love/hatred for him, saying that he abandoned them. Monica helped her father construct the remote-controlled gun, but she also blamed him for her mother's death and had lost all love for him. She therefore aimed the gun to kill her father when fired. Her idea was to convict Stiles of the murder and go free herself.
"
	CRLF
	PRINTI "Phong had no idea of Monica's plan until he saw Linder's corpse. He did not spill the beans on Linder's plan, since he also had reason to want Linder removed from the scene. Monica, as a last resort, may have attempted to convince you that her father was dying of a stomach tumor and had planned his own death. But Monica is the only one who could have twisted Linder's plan into murder: the key to the clock was hidden on her person, so she had final control of the gun's aim.
"
?L3:	QUIT

	.FUNCT TOO-LATE-F
	PRINTI "
A few days pass, and you don't hear from Linder. But a small item in the newspaper catches your eye: a grifter named Stiles was found dead on the beach one morning, with a cheap handgun lying near and a single small bullet wound through his heart. Does this death have anything to do with Linder and your visit? Well, no need to lose sleep over it. Everyone sleeps the big sleep sooner or later.
"
	RTRUE

	.FUNCT YOU-F
	EQUAL? PRSA,V?ASK-ABOUT \?L1
	EQUAL? PRSI,YOU \?L1
	CALL PERFORM,V?ASK-ABOUT,PRSO,PRSO
	RTRUE
?L1:	EQUAL? PRSA,V?TELL-ME \FALSE
	EQUAL? PRSI,YOU \FALSE
	CALL PERFORM,V?TELL-ME,PRSO,WINNER
	RTRUE

	.FUNCT OBJECT-PAIR-F,P1,P2
	GET P-PRSO,P-MATCHLEN >STACK
	LESS? 2,STACK \?L1
	EQUAL? PRSA,V?ARREST \?L3
	PRINTR "You think it over. You realize that this arrest is pretty far-fetched. It could only mean humiliation for you."
?L3:	EQUAL? PRSA,V?COMPARE \TRUE
	PRINTR "That's too many things to compare all at once!"
?L1:	EQUAL? PRSA,V?ARREST \?L11
	FSET? CORPSE,INVISIBLE /?L11
	GET P-PRSO,1 >P1
	IN? P1,GLOBAL-OBJECTS \?L12
	GETP P1,P?CHARACTER >STACK
	GET CHARACTER-TABLE,STACK >P1
?L12:	GET P-PRSO,2 >P2
	IN? P2,GLOBAL-OBJECTS \?L15
	GETP P2,P?CHARACTER >STACK
	GET CHARACTER-TABLE,STACK >P2
?L15:	CALL ARREST,P1,P2 >STACK
	RSTACK
?L11:	EQUAL? PRSA,V?COMPARE \FALSE
	GET P-PRSO,2 >STACK
	GET P-PRSO,1 >STACK
	CALL PERFORM,PRSA,STACK,STACK
	RTRUE

	.FUNCT PLAYER-F
	EQUAL? PRSA,V?SHOOT \?L1
	EQUAL? PRSO,PLAYER \?L1
	PRINTI "What, and let down the Police Department track-and-field team?!"
	CRLF
	CALL PRINT-ID,STR?107 >STACK
	RSTACK
?L1:	ZERO? PLAYER-HIDING \?L5
	LOC PLAYER >STACK
	IN? STACK,ROOMS /FALSE
?L5:	ZERO? PRSO /FALSE
	EQUAL? PRSA,V?WALK \?L7
	CALL TOO-BAD-SIT-HIDE >STACK
	RSTACK
?L7:	ZERO? PLAYER-HIDING /?L8
	EQUAL? PRSA,V?ASK-FOR,V?ASK-ABOUT,V?GOODBYE /?L9
	EQUAL? PRSA,V?HELLO,V?TELL,V?$0024CALL \?L8
?L9:	CALL TOO-BAD-SIT-HIDE >STACK
	RSTACK
?L8:	CALL STANDING-VERB? >STACK
	ZERO? STACK /FALSE
	IN? PRSO,WINNER /?L11
	EQUAL? PRSA,V?EXAMINE \?L12
	EQUAL? P-ADVERB,W?CAREFULLY /?L12
	EQUAL? PRSO,CLOCK /?L14
	LOC PRSO >STACK
	EQUAL? OFFICE,STACK \?L12
?L14:	PRINTI "You'd do a much better job if you stood up, but let's see..."
	CRLF
	RFALSE
?L12:	IN? PLAYER,CARVED-CHAIR \?L17
	EQUAL? PRSA,V?RING,V?PUSH,V?FIND \?L17
	EQUAL? PRSO,OFFICE-BUTTON,BUTTON /FALSE
?L17:	EQUAL? PRSA,V?TAKE \?L18
	EQUAL? PRSO,HINT /FALSE
?L18:	CALL TOO-BAD-SIT-HIDE >STACK
	RSTACK
?L11:	ZERO? PRSI /FALSE
	IN? PRSI,WINNER /FALSE
	CALL TOO-BAD-SIT-HIDE >STACK
	RSTACK

	.FUNCT STANDING-VERB?
	EQUAL? PRSA,V?WALK-TO,V?WALK-AROUND,V?WALK /TRUE
	EQUAL? PRSA,V?USE,V?UNTIE,V?UNLOCK /TRUE
	EQUAL? PRSA,V?TIE-WITH,V?TIE-TO,V?THROUGH /TRUE
	EQUAL? PRSA,V?TAKEOUT,V?TAKE,V?SMELL /TRUE
	EQUAL? PRSA,V?SLAP,V?SIT,V?SEARCH-OBJECT-FOR /TRUE
	EQUAL? PRSA,V?SEARCH,V?RUB-OVER,V?RUB /TRUE
	EQUAL? PRSA,V?RING,V?REVIVE,V?READ /TRUE
	EQUAL? PRSA,V?RAPE,V?RAISE,V?PUT-UNDER /TRUE
	EQUAL? PRSA,V?PUT,V?PUSH,V?PICK /TRUE
	EQUAL? PRSA,V?PHONE,V?OPEN,V?MUNG /TRUE
	EQUAL? PRSA,V?MOVE,V?MAKE,V?LOOK-UNDER /TRUE
	EQUAL? PRSA,V?LOOK-OUTSIDE,V?LOOK-INSIDE,V?LOOK-BEHIND /TRUE
	EQUAL? PRSA,V?LOCK,V?KNOCK,V?KISS /TRUE
	EQUAL? PRSA,V?KILL,V?KICK,V?HIDE-BEHIND /TRUE
	EQUAL? PRSA,V?HANDCUFF,V?FOLLOW,V?FINGERPRINT /TRUE
	EQUAL? PRSA,V?EXAMINE,V?ENTER,V?EAT /TRUE
	EQUAL? PRSA,V?DRINK,V?CLOSE,V?BRUSH /TRUE
	EQUAL? PRSA,V?ATTACK /TRUE
	RFALSE

	.FUNCT TOO-BAD-SIT-HIDE
	SET 'P-CONT,0
	LOC PLAYER >STACK
	IN? STACK,ROOMS /?L1
	EQUAL? PRSA,V?SIT \?L3
	PRINTR "You're already sitting down."
?L3:	PRINTR "You'd do a much better job if you stood up."
?L1:	ZERO? PLAYER-HIDING /FALSE
	EQUAL? PRSA,V?HIDE-BEHIND \?L11
	PRINTR "You're already hiding."
?L11:	PRINTR "You can't do that while you're hiding."

	.FUNCT PHONG-F,ARG=0,OBJ,L
	LOC PHONG >L
	EQUAL? ARG,M-OBJDESC \?L1
	CALL IN-MOTION?,PHONG >STACK
	ZERO? STACK \TRUE
	FSET? PHONG,TOUCHBIT \?L5
	FSET? LINDER,TOUCHBIT /?L6
	LOC LINDER >STACK
	EQUAL? HERE,STACK \?L6
	CRLF
	PRINTI """Excuse me, sir,"" says Phong, ""but the detective has arrived."""
	CRLF
	CRLF
	RTRUE
?L6:	EQUAL? L,BUTLER-ROOM \?L10
	PRINTI "Phong is lying on the bed, "
	IN? RECURSIVE-BOOK,PHONG \?L13
	PRINTR "reading a book."
?L13:	PRINTR "meditating."
?L10:	EQUAL? L,KITCHEN \?L20
	LESS? PRESENT-TIME,710 \?L20
	PRINTI "Phong is here, "
	SUB PRESENT-TIME,480 >STACK
	DIV STACK,60 >STACK
	INC 'STACK
	GET KITCHEN-ACTIVITIES,STACK >STACK
	PRINT STACK
	PRINTR "."
?L20:	EQUAL? L,OFFICE \?L23
	IN? CORPSE,OFFICE \?L23
	ZERO? PHONG-SEEN-CORPSE? /?L23
	PRINTR "Phong is gazing out the window."
?L23:	EQUAL? L,ENTRY \?L26
	PRINTR "Phong is waiting for you to do something."
?L26:	PRINTI "Phong is here, "
	CALL PICK-ONE,PHONG-HERE >STACK
	PRINT STACK
	PRINTR "."
?L5:	FSET PHONG,TOUCHBIT
	GETP PHONG,P?TEXT >STACK
	PRINT STACK
	CRLF
	RTRUE
?L1:	EQUAL? WINNER,PHONG \?L35
	EQUAL? PRSA,V?FIND \?L36
	EQUAL? PRSO,PHONG-KEYS \?L36
	SET 'WINNER,PLAYER
	CALL PERFORM,V?ASK-ABOUT,PHONG,PRSO
	RTRUE
?L36:	EQUAL? PRSA,V?THANKS,V?FIND /FALSE
	EQUAL? PRSA,V?SLAP \?L39
	PRINTR """No, I must be careful about that."""
?L39:	EQUAL? PRSA,V?GIVE \?L44
	EQUAL? PRSO,OUTSIDE-GUN,GENERIC-GUN,GENERIC-KEY /?L45
	EQUAL? PRSO,PHONG-KEYS /?L45
?L44:	EQUAL? PRSA,V?SGIVE \?L42
	EQUAL? PRSI,OUTSIDE-GUN /?L45
	EQUAL? PRSI,GENERIC-GUN,GENERIC-KEY,PHONG-KEYS \?L42
?L45:	CALL TAKE-PHONG-KEYS >STACK
	RSTACK
?L42:	EQUAL? PRSA,V?UNLOCK /?L47
	EQUAL? PRSA,V?LOCK,V?CLOSE,V?OPEN \?L46
?L47:	FSET? CORPSE,INVISIBLE \?L48
	PRINTR """You'll have to ask Mr. Linder about that."""
?L48:	EQUAL? PRSO,CLOCK \?L52
	PRINTR """I don't have the key for the clock."""
?L52:	EQUAL? PRSA,V?UNLOCK,V?OPEN \?L55
	IN? PHONG-KEYS,PHONG \?L55
	FCLEAR PRSO,LOCKED
	EQUAL? PRSA,V?OPEN \?L56
	FSET PRSO,OPENBIT
?L56:	PRINTR """Okey."""
?L55:	EQUAL? PRSA,V?LOCK,V?CLOSE \FALSE
	IN? PHONG-KEYS,PHONG \FALSE
	FCLEAR PRSO,OPENBIT
	EQUAL? PRSA,V?LOCK \?L62
	FSET PRSO,LOCKED
?L62:	PRINTR """Okey."""
?L46:	CALL COM-CHECK,PHONG >STACK
	ZERO? STACK \TRUE
	CALL PICK-ONE,WHY-ME >STACK
	PRINT STACK
	CRLF
	RTRUE
?L35:	EQUAL? PRSA,V?ACCUSE \?L72
	ZERO? PHONG-SEEN-CORPSE? \?L73
	PRINTR """What are you talking about?"" He looks frightened."
?L73:	ZERO? SIDE-FOOTPRINTS-MATCHED /?L80
	FSET? GUN-RECEIPT,TOUCHBIT \?L77
	SET 'PHONG-ADMITTED-HELPING?,1
	CALL DISCRETION,PHONG,MONICA
	PRINTR """It's true I helped set you up for deception with the guns. But only because Mr. Linder asked me to! He said he wanted to frighten Stiles. He wasn't supposed to be killed! Monica must have muffed it. Or else ... could she ...?"" He looks confused and angry."
?L77:	ZERO? SIDE-FOOTPRINTS-MATCHED /?L80
	PRINTI """I don't see why you're accusing me!"
	PRINTI " Sure, I was in the yard, because "
	PRINTI "I thought I heard a noise outside and went out to investigate."
	PRINTR " It's part of my job, you know."""
?L80:	FSET? GUN-RECEIPT,TOUCHBIT \?L83
	CALL DISCRETION,PHONG,MONICA
	PRINTI """I don't see why you're accusing me!"
	PRINTR " You should ask Monica about those guns."""
?L83:	PRINTI """You haven't a clue, and you know it!"""
	CRLF
	CALL PRINT-ID,STR?108 >STACK
	RSTACK
?L72:	ZERO? PRSI /?L91
	SET 'OBJ,PRSI
	ZERO? OBJ /?L91
	EQUAL? PRSA,V?CONFRONT,V?ASK-ABOUT \?L91
	EQUAL? PRSO,PHONG /?L90
?L91:	ZERO? PRSO /?L89
	IN? PRSO,GLOBAL-OBJECTS \?L89
	SET 'OBJ,PRSO
	ZERO? OBJ /?L89
	EQUAL? PRSA,V?WHAT,V?FIND \?L89
?L90:	CALL GRAB-ATTENTION,PHONG >STACK
	ZERO? STACK /TRUE
	CALL SAID-TO,PHONG
	EQUAL? OBJ,BUTTON \?L95
	PRINTR """That's my butler's button, of course."""
?L95:	EQUAL? OBJ,GLOBAL-CAN-OF-WORMS \?L99
	PRINTR """I didn't think you had any interest in gardening! Those little babies are the best thing for the clay soil around here. You can just order them by mail and open them up when they arrive."""
?L99:	EQUAL? OBJ,GENERIC-GUN \?L102
	PRINTR """I don't have one, if that's what you mean."""
?L102:	EQUAL? OBJ,BLACK-WIRE \?L105
	PRINTR """Oh, Monica wired the house for butler's buttons."""
?L105:	EQUAL? OBJ,WHITE-WIRE \?L108
	PRINTR """Oh, Monica wired the windows with burglar alarms."""
?L108:	EQUAL? OBJ,GENERIC-GREEN-WIRE,GENERIC-WIRE \?L111
	PRINTR """There's wire all over the house. You'll have to ask Monica."""
?L111:	EQUAL? OBJ,GENERIC-KEY,PHONG-KEYS \?L114
	IN? PHONG-KEYS,PHONG \?L115
	PRINTR """I have the keys for all the doors in the house."""
?L115:	PRINTR """Don't you remember? I gave you all the keys I have."""
?L114:	EQUAL? OBJ,CLOCK-KEY \?L122
	IN? CLOCK-KEY,PLAYER \?L123
	PRINTR """That looks like the key to Mr. Linder's clock."""
?L123:	PRINTR """There's only one key to Mr. Linder's clock. I think he keeps it in the office somewhere."""
?L122:	EQUAL? OBJ,GLOBAL-LINDER,LINDER,CORPSE \?L130
	IN? LINDER,HERE \?L131
	PRINTR """That man is a marvel. Always seems to have several deals going at once. I don't know how he does it."" Linder beams with self-pride."
?L131:	ZERO? PHONG-SEEN-CORPSE? /?L135
	SET 'PHONG-HAS-MOTIVE,CORPSE
	CALL DISCRETION,PHONG,MONICA
	PRINTI """Frankly, Detective, I can't say I"
	PRINTI "'m sorry he's dead"
	PRINTI ". He always promised me wealth here in America, but I've never seen it. I could "
	PRINTI "have managed"
	PRINTR " the Asian branch of his business if he'd let me. If I had any money, I'd quit on the spot and return home."""
?L135:	SET 'PHONG-HAS-MOTIVE,LINDER
	CALL DISCRETION,PHONG,MONICA
	PRINTI """Frankly, Detective, I can't say I"
	PRINTI " like him much"
	PRINTI ". He always promised me wealth here in America, but I've never seen it. I could "
	PRINTI "manage"
	PRINTR " the Asian branch of his business if he'd let me. If I had any money, I'd quit on the spot and return home."""
?L130:	EQUAL? OBJ,GLOBAL-MONICA,MONICA \?L141
	CALL DISCRETION,PHONG,MONICA
	PRINTI """She's an intelligent girl. Mr. Linder is very proud of her, but I think she acts too much like a man."
	ZERO? PHONG-SEEN-CORPSE? /?L144
	PRINTI " She really muffed it this time."
?L144:	PRINTR """"
?L141:	EQUAL? OBJ,GLOBAL-AFFAIR,GLOBAL-MRS-LINDER \?L151
	CALL DISCRETION,PHONG,LINDER
	PRINTR """If only Mr. Linder had been home more, he could have kept her in line."""
?L151:	EQUAL? OBJ,GLOBAL-PHONG,PHONG \?L154
	SET 'PHONG-HAS-MOTIVE,PHONG
	PRINTR """Mr. Linder brought me here from Asia, to help manage his business and run his house. I guess I do more running than managing. If I can help you, just push the button anywhere in the house."""
?L154:	ZERO? SHOT-FIRED /?L157
	EQUAL? OBJ,GLOBAL-SHOT \?L157
	PRINTR """I was in the kitchen and heard a sound like a gunshot, so I ran to the office and found you and Mr. Linder. You were closer to it than I was."""
?L157:	EQUAL? OBJ,GLOBAL-STILES,STILES \?L160
	CALL DISCRETION,PHONG,LINDER
	PRINTR """He used to come around here now and then, when Mr. Linder was away. I never thought much about it until the fighting between Mr. and Mrs. got bad, just before Mrs. Linder passed on."" He pauses. ""I think Mr. Linder has been calling him on the telephone a lot lately."""
?L160:	EQUAL? OBJ,GLOBAL-SUICIDE \?L163
	SET 'MONICA-HAS-MOTIVE,PHONG
	CALL DISCRETION,PHONG,LINDER,MONICA
	PRINTR """Everyone was sad about that. Mr. Linder just threw himself into his work, as usual. Monica was terribly depressed, didn't even come out of her room for a long time. I doubt she'll ever get over it."""
?L163:	EQUAL? OBJ,WILL \?L166
	ZERO? PHONG-SEEN-CORPSE? /?L167
	CALL DISCRETION,PHONG,MONICA
	PRINTR """Mr. Linder probably kept it in his bank safe. I've never seen it."""
?L167:	PRINTR """You'll have to ask Mr. Linder about that."""
?L166:	EQUAL? OBJ,BROOM \?L174
	PRINTR """What can I tell you? That's a 'flathead broom,' invented by your American Shakers, I believe."""
?L174:	EQUAL? OBJ,DOORBELL \?L177
	ZERO? PHONG-SEEN-CORPSE? /?L177
	PRINTR "He seems surprised. ""Uh, that was just some door-to-door salesman."""
?L177:	EQUAL? OBJ,GUN-RECEIPT \?L180
	CALL DISCRETION,PHONG,MONICA
	PRINTR """Yes, I think Monica bought those, using some other name."""
?L180:	EQUAL? OBJ,MATCHBOOK \?L183
	PRINTI """I've heard Mr. Linder mention that restaurant."
	PRINTR " But I don't recognize the phone number."""
?L183:	EQUAL? OBJ,BRASS-LANTERN \?L186
	PRINTI """I've heard Mr. Linder mention that restaurant."
	PRINTR """"
?L186:	EQUAL? OBJ,MEDICAL-REPORT,TUMOR \?L189
	PRINTR "Phong looks surprised but not alarmed. ""This is the first I've heard of this."""
?L189:	EQUAL? OBJ,MUDDY-SHOES \?L192
	SET 'SIDE-FOOTPRINTS-MATCHED,1
	PRINTI """Those are my gardening boots. They're muddy because, while you were in the office, "
	PRINTI "I thought I heard a noise outside and went out to investigate."
	PRINTR """"
?L192:	EQUAL? OBJ,OFFICE-BUTTON,CLOCK /?L196
	EQUAL? OBJ,POWDER,CLOCK-POWDER \?L195
?L196:	ZERO? PLAYER-PUSHED-BUTTON /?L197
	SET 'PHONG-ADMITTED-HELPING?,1
	CALL DISCRETION,PHONG,MONICA
	PRINTR """I might as well tell you: Mr. Linder concocted this scheme to frighten Stiles, and he got Monica and me to help him. But he was supposed to be only wounded, not killed!"""
?L197:	ZERO? PHONG-SEEN-CORPSE? /?L202
	PRINTI "Phong seems shaken, but all he says is, "
?L202:	EQUAL? OBJ,OFFICE-BUTTON \?L207
	PRINTR """That's my butler's button, of course."""
?L207:	EQUAL? OBJ,CLOCK \?L211
	PRINTR """Mr. Linder has a certain fondness for elaborate things like that."""
?L211:	PRINTR """If it's dust you're after, I plead guilty to plenty of it."""
?L195:	EQUAL? OBJ,PIECE-OF-WIRE,CLOCK-WIRES,PIECE-OF-PUTTY \?L217
	PRINTR """Oh, I guess that's part of the burglar alarm."""
?L217:	EQUAL? OBJ,RECURSIVE-BOOK \?L220
	PRINTR """It's a mystery called 'Deadline.' Monica recommended it to me."""
?L220:	EQUAL? OBJ,TELEGRAM \?L223
	PRINTR """Yes, that's the telegram Mr. Linder sent this morning."""
?L223:	EQUAL? OBJ,THREAT-NOTE \FALSE
	ZERO? PHONG-ADMITTED-HELPING? /?L227
	PRINTR """Yes, now you know that Mr. Linder forged that note. Stiles didn't send it to him."""
?L227:	PRINTR """Yes, that's the note that Stiles sent to Mr. Linder."""
?L89:	EQUAL? PRSO,PHONG \?L252
	EQUAL? PRSA,V?HELP \?L235
	PRINTI "Phong looks offended. ""I'm quite capable by myself, you know."""
	CRLF
	CALL PRINT-ID,STR?109 >STACK
	RSTACK
?L235:	EQUAL? PRSO,PHONG \?L252
	EQUAL? PRSA,V?RUB \?L238
	CALL PHONG-FIGHTS >STACK
	RSTACK
?L238:	EQUAL? PRSO,PHONG \?L252
	EQUAL? PRSA,V?ASK-FOR \?L239
	FSET PHONG,TOUCHBIT
	EQUAL? PRSI,OUTSIDE-GUN /?L242
	EQUAL? PRSI,GENERIC-GUN,PHONG-KEYS,GENERIC-KEY \FALSE
?L242:	CALL PERFORM,V?ASK-ABOUT,PHONG,PRSI
	RTRUE
?L239:	EQUAL? PRSO,PHONG \?L252
	EQUAL? PRSA,V?SEARCH-OBJECT-FOR,V?SEARCH \?L244
	IN? OUTSIDE-GUN,PHONG \?L245
	CALL PHONG-FIGHTS >STACK
	RSTACK
?L245:	IN? PHONG-KEYS,PHONG \FALSE
	EQUAL? PRSA,V?SEARCH /?L248
	EQUAL? PRSA,V?SEARCH-OBJECT-FOR \FALSE
	EQUAL? PRSI,GENERIC-KEY,PHONG-KEYS \FALSE
?L248:	MOVE PHONG-KEYS,PLAYER
	FCLEAR PHONG-KEYS,NDESCBIT
	PRINTI "You find a "
	PRINTD PHONG-KEYS
	PRINTR " in Phong's pocket and take it."
?L244:	EQUAL? PRSO,PHONG \?L252
	EQUAL? PRSA,V?SHOW \?L252
	CALL PERFORM,V?ASK-ABOUT,PRSO,PRSI
	RTRUE
?L252:	EQUAL? PRSA,V?TAKE \?L253
	EQUAL? PRSO,OUTSIDE-GUN /?L254
	EQUAL? PRSO,GENERIC-GUN,GENERIC-KEY,PHONG-KEYS \?L253
?L254:	CALL TAKE-PHONG-KEYS >STACK
	RSTACK
?L253:	EQUAL? PRSA,V?TAKEOUT \?L255
	EQUAL? PRSI,LINDER-BACK-DOOR,MONICA-BACK-DOOR,OFFICE-BACK-DOOR \?L255
	CALL PHONG-FIGHTS >STACK
	RSTACK
?L255:	EQUAL? PRSA,V?ARREST \FALSE
	CALL ARREST,PHONG >STACK
	RSTACK

	.FUNCT PHONG-FIGHTS
	PRINTI "Phong's smile disappears and his body shifts subtly toward a fighting stance. ""I don't think you really want to try that, Detective."""
	CRLF
	CALL PRINT-ID,STR?110 >STACK
	RSTACK

	.FUNCT TAKE-PHONG-KEYS
	ZERO? PHONG-SEEN-CORPSE? /?L1
	MOVE PHONG-KEYS,PLAYER
	FCLEAR PHONG-KEYS,NDESCBIT
	PRINTR """Here, you may as well take them. I don't see how Mr. Linder can object now.[RWD_ID: people:488, VAL: 1]"""
?L1:	PRINTR """I don't think Mr. Linder would like that."""

	.FUNCT LINDER-F,ARG=0,OBJ,L
	LOC LINDER >L
	EQUAL? ARG,M-OBJDESC \?L1
	CALL IN-MOTION?,LINDER >STACK
	ZERO? STACK \TRUE
	FSET? LINDER,TOUCHBIT \?L5
	IN? LINDER,HERE \?L6
	IN? HERE,ROOMS \?L6
	PRINTR "Linder is pacing back and forth."
?L6:	PRINTI "Linder is sitting on the "
	LOC LINDER >STACK
	PRINTD STACK
	PRINTR "."
?L5:	FSET LINDER,TOUCHBIT
	GETP LINDER,P?TEXT >STACK
	PRINT STACK
	CRLF
	RTRUE
?L1:	EQUAL? WINNER,LINDER \?L16
	EQUAL? PRSA,V?FIND \?L17
	EQUAL? PRSO,GUN-RECEIPT \?L17
	SET 'WINNER,PLAYER
	CALL PERFORM,V?ASK-ABOUT,LINDER,PRSO
	RTRUE
?L17:	EQUAL? PRSA,V?THANKS,V?FIND /FALSE
	EQUAL? PRSA,V?GIVE \?L22
	EQUAL? PRSO,DRINK /FALSE
?L22:	EQUAL? PRSA,V?SGIVE \?L20
	EQUAL? PRSI,DRINK /FALSE
?L20:	EQUAL? PRSA,V?PUSH \?L23
	EQUAL? PRSO,OFFICE-BUTTON \?L23
	PRINTR """I don't need Phong yet."""
?L23:	EQUAL? PRSA,V?TIME \?L26
	PRINTI "Linder looks at his wrist watch and says, ""I have "
	CALL TIME-PRINT,PRESENT-TIME
	PRINTR """"
?L26:	CALL COM-CHECK,LINDER >STACK
	ZERO? STACK \TRUE
	PRINTR """Don't tell me what to do!"""
?L16:	ZERO? PRSO /?L37
	IN? PRSO,GLOBAL-OBJECTS \?L37
	SET 'OBJ,PRSO
	ZERO? OBJ /?L37
	EQUAL? PRSA,V?WHAT,V?FIND /?L36
?L37:	ZERO? PRSI /?L35
	SET 'OBJ,PRSI
	ZERO? OBJ /?L35
	EQUAL? PRSO,LINDER \?L139
	EQUAL? PRSA,V?ASK-ABOUT,V?CONFRONT \?L35
?L36:	CALL GRAB-ATTENTION,LINDER >STACK
	ZERO? STACK /TRUE
	CALL SAID-TO,LINDER
	EQUAL? OBJ,BUTTON \?L41
	PRINTR """That's the butler's button, of course."""
?L41:	EQUAL? OBJ,BLACK-WIRE \?L45
	PRINTI """Yes, Monica wired "
	PRINTI "the whole house for butler's buttons."
	PRINTR " With all modesty, I think she's quite a mechanic."""
?L45:	EQUAL? OBJ,WHITE-WIRE \?L48
	PRINTI """Yes, Monica wired "
	PRINTI "all the windows for burglars."
	PRINTR " With all modesty, I think she's quite a mechanic."""
?L48:	EQUAL? OBJ,GENERIC-GREEN-WIRE,GENERIC-WIRE \?L51
	PRINTR """That's Monica's territory. I don't interfere."""
?L51:	EQUAL? OBJ,GLOBAL-CALL \?L54
	PRINTR """What phone call? I haven't talked with Stiles since my wife's death. I'm really afraid he wants to do me in."""
?L54:	EQUAL? OBJ,GENERIC-KEY \?L57
	PRINTR """Phong keeps the house keys for me."""
?L57:	EQUAL? OBJ,GLOBAL-LINDER,LINDER \?L60
	PRINTR """You've probably read about me in the papers. In fact they just published something about me when I won that award. And I've heard lots about you. That's why I asked you here."""
?L60:	EQUAL? OBJ,GLOBAL-AFFAIR,GLOBAL-MRS-LINDER,GLOBAL-SUICIDE \?L63
	PRINTR """It's still too painful for me to talk about, I'm afraid."""
?L63:	EQUAL? OBJ,MONEY \?L66
	PRINTI """Money?! I asked you here to prevent a crime. I hope you're not thinking of some outlandish fee!"""
	CRLF
	CALL PRINT-ID,STR?111 >STACK
	RSTACK
?L66:	EQUAL? OBJ,GLOBAL-MONICA,MONICA \?L69
	PRINTR """She's a loyal and intelligent girl. I'm very proud of her."""
?L69:	EQUAL? OBJ,GLOBAL-PHONG,PHONG \?L72
	PRINTR """He and I go back a long time. Met in Asia, you know. And since I spend as much time there as here, he takes care of the house for me. A fine fellow, and I trust him implicitly."""
?L72:	EQUAL? OBJ,GLOBAL-STILES,STILES,DANGER \?L75
	FSET? THREAT-NOTE,TOUCHBIT \?L76
	PRINTR """All I know about Stiles is that he's a writer of some kind, and sometimes he plays bit parts in films. I've never really met the man."""
?L76:	EQUAL? HERE,OFFICE \?L80
	CALL I-LINDER-EXPLAIN
	RTRUE
?L80:	PRINTR """I'll explain all that shortly, after I finish this drink."""
?L75:	EQUAL? OBJ,PLAYER \?L84
	PRINTR """My friend Klutz, the Police Chief, recommended you to me."""
?L84:	EQUAL? OBJ,GENERIC-CAR,GENERIC-GUN /?L88
	EQUAL? OBJ,GLOBAL-PTA,WILL \?L87
?L88:	PRINTR """That has nothing to do with why I asked you here."""
?L87:	EQUAL? OBJ,BROOM \?L91
	PRINTR """Oh, Phong must have left it there after cleaning up."""
?L91:	EQUAL? OBJ,CARVED-CHAIR \?L94
	PRINTR """I found that in an obscure but wealthy estate in Asia during the war and brought it home as booty. Sitting in it makes me feel like an 'Oriental Potentate.'"""
?L94:	EQUAL? OBJ,CAT \?L97
	PRINTR """She's Monica's cat. You'd do better to ask her."""
?L97:	EQUAL? OBJ,CLOCK \?L100
	PRINTR """I've always admired elaborate machines, and that's the finest example I could hope to own."""
?L100:	EQUAL? OBJ,GUN-RECEIPT \?L103
	PRINTI """I didn't ask you here so you could search the house!"""
	CRLF
	CALL PRINT-ID,STR?112 >STACK
	RSTACK
?L103:	EQUAL? OBJ,MATCHBOOK,BRASS-LANTERN \?L106
	CALL DISCRETION,LINDER,PHONG
	PRINTR """I think Phong goes there sometimes. I've never been there myself."" He almost flinched before answering, but now he's as smooth as ever."
?L106:	EQUAL? OBJ,MEDICAL-REPORT,TUMOR \?L109
	ZERO? LINDER-SAW-MEDICAL-REPORT /?L110
	PRINTI """I already told you that I haven't seen it before."""
	CRLF
	JUMP ?L114
?L110:	PRINTI "Linder looks surprised and a bit alarmed. ""This is the first I've heard of this. I don't know why my doctor didn't tell me about it."""
	CRLF
?L114:	SET 'LINDER-SAW-MEDICAL-REPORT,1
	RETURN LINDER-SAW-MEDICAL-REPORT
?L109:	EQUAL? OBJ,OFFICE-BUTTON \?L117
	PRINTR """That's the butler's button, of course."""
?L117:	EQUAL? OBJ,PAPERS,FILE-CABINET \?L120
	PRINTR """I wish you wouldn't meddle in my files while we're trying to talk."""
?L120:	EQUAL? OBJ,PIECE-OF-WIRE,CLOCK-WIRES,PIECE-OF-PUTTY \?L123
	PRINTR """Oh, uh, that's part of the burglar alarm."""
?L123:	EQUAL? OBJ,TELEGRAM \?L126
	PRINTR """Yes, that's the telegram I sent this morning."""
?L126:	EQUAL? OBJ,THREAT-NOTE \?L129
	PRINTR """Yes, that's the note that Stiles sent to me."""
?L129:	CALL PICK-ONE,LINDER-ASKED >STACK
	PRINT STACK
	CRLF
	RTRUE
?L35:	EQUAL? PRSO,LINDER \?L139
	EQUAL? PRSA,V?RUB \?L135
	PRINTI "Linder looks bewildered, almost alarmed. ""Whatever do you have in mind?"""
	CRLF
	CALL PRINT-ID,STR?113 >STACK
	RSTACK
?L135:	EQUAL? PRSO,LINDER \?L139
	EQUAL? PRSA,V?SHOW \?L138
	CALL PERFORM,V?ASK-ABOUT,PRSO,PRSI
	RTRUE
?L138:	EQUAL? PRSO,LINDER \?L139
	EQUAL? PRSA,V?TURN-UP \?L139
	PRINTR "Many have tried, but none has succeeded."
?L139:	EQUAL? PRSA,V?TAKEOUT \?L142
	EQUAL? PRSI,LINDER-BACK-DOOR,MONICA-BACK-DOOR,OFFICE-BACK-DOOR \?L142
	PRINTR "Many have tried, but none has succeeded."
?L142:	EQUAL? PRSA,V?ARREST \FALSE
	CALL ARREST,LINDER >STACK
	RSTACK

	.FUNCT STILES-F,ARG=0,OBJ,L
	LOC STILES >L
	EQUAL? ARG,M-OBJDESC \?L1
	EQUAL? L,OFFICE-PORCH,OFFICE-PATH \?L3
	CALL IN-MOTION?,STILES >STACK
	ZERO? STACK \TRUE
	FSET? STILES,TOUCHBIT \?L7
	PRINTR "Stiles is waiting for you to say something."
?L7:	PRINTR "The visitor is in a hurry."
?L3:	CALL IN-MOTION?,STILES >STACK
	ZERO? STACK /?L13
	PRINTR "Sgt. Duffy is leading Stiles by the handcuffs."
?L13:	ZERO? MET-STILES? /?L16
	LESS? PRESENT-TIME,780 \?L17
	PRINTI "Stiles is fastened to the davenport, "
	PRINTR "looking sullen."
?L17:	PRINTI "Stiles is fastened to the davenport, "
	PRINTR "yawning and trying not to doze off."
?L16:	PRINTI "Sgt. Duffy is holding a prisoner by the arm."
	CRLF
	GETP STILES,P?TEXT >STACK
	PRINT STACK
	CRLF
	RTRUE
?L1:	EQUAL? WINNER,STILES \?L29
	ZERO? TOO-LATE /?L34
	EQUAL? PRSA,V?FIND \?L30
	EQUAL? PRSO,PLAYER /?L30
	PRINTR """I wouldn't tell you even if I knew."""
?L30:	ZERO? TOO-LATE /?L34
	EQUAL? PRSA,V?INVENTORY \?L34
	PRINTR """I've never seen you before."""
?L34:	EQUAL? PRSA,V?THANKS,V?FIND /FALSE
	CALL COM-CHECK,STILES >STACK
	ZERO? STACK \TRUE
	CALL PICK-ONE,WHY-ME >STACK
	PRINT STACK
	CRLF
	RTRUE
?L29:	ZERO? PRSI /?L44
	SET 'OBJ,PRSI
	ZERO? OBJ /?L44
	EQUAL? PRSO,STILES \?L44
	EQUAL? PRSA,V?ASK-ABOUT,V?CONFRONT /?L43
?L44:	ZERO? PRSO /?L42
	IN? PRSO,GLOBAL-OBJECTS \?L42
	SET 'OBJ,PRSO
	ZERO? OBJ /?L42
	EQUAL? PRSA,V?WHAT,V?FIND \?L42
?L43:	CALL GRAB-ATTENTION,STILES >STACK
	ZERO? STACK /TRUE
	CALL SAID-TO,STILES
	EQUAL? OBJ,GLOBAL-CALL \?L48
	PRINTI """Linder phoned me today and almost commanded me to come here tonight to talk about our deal. Last time, he at least was decent enough to buy me lunch. He"
	PRINTR " said he wanted to pay me a bundle to leave town."""
?L48:	ZERO? TOO-LATE \?L52
	EQUAL? OBJ,GLOBAL-DUFFY \?L52
	PRINTR """Is that your man? When I came running out of the woods, he grabbed me as if I was some kind of criminal. He wouldn't let me go! So here I am."""
?L52:	EQUAL? OBJ,GENERIC-GUN \?L55
	PRINTR """Don't ask me. I never touch them."""
?L55:	ZERO? TOO-LATE \?L58
	EQUAL? OBJ,STILES-SHOES \?L58
	SET 'BACK-FOOTPRINTS-MATCHED,1
	PRINTR """What about them? They're muddy because I had to run through the yard and woods to get away from the shooting."""
?L58:	EQUAL? OBJ,TELEGRAM \?L61
	PRINTR """I don't get it. I think he's more dangerous than I am!"""
?L61:	EQUAL? OBJ,MONEY \?L64
	PRINTI """Yeah, Linder"
	PRINTR " said he wanted to pay me a bundle to leave town."""
?L64:	EQUAL? OBJ,GLOBAL-MONICA,MONICA \?L67
	CALL DISCRETION,STILES,MONICA
	PRINTR """She's probably just another dizzy dame, but I don't really know her well enough to say."""
?L67:	EQUAL? OBJ,GLOBAL-AFFAIR,GLOBAL-MRS-LINDER,GLOBAL-SUICIDE \?L70
	CALL DISCRETION,STILES,MONICA
	PRINTR """Virginia was a special woman. Repressed for years. I think that, if only ... Say, I don't have to answer your questions!"""
?L70:	EQUAL? OBJ,GLOBAL-LINDER,LINDER,CORPSE \?L73
	PRINTR """He's a smooth operator. I can think of many people who'd like to plug him. Not me, of course. I still don't understand why he sounded so urgent when he called me today and asked me to come here tonight."""
?L73:	EQUAL? OBJ,GLOBAL-PHONG,PHONG \?L76
	CALL DISCRETION,STILES,PHONG
	PRINTI """He seems straight, but I don't really trust "
	CALL TANDY? >STACK
	ZERO? STACK /?L79
	PRINTI "his kind"
	JUMP ?L83
?L79:	PRINTI "slanteyes"
?L83:	PRINTR "."""
?L76:	ZERO? SHOT-FIRED /?L88
	EQUAL? OBJ,GLOBAL-SHOT \?L88
	PRINTR """I was just walking up to Linder's office when there was this explosion and the window fell apart. 'Holy jumping catfish!' I thought, 'Someone took a shot at me!' So I ran to the gate, but it was locked. The only way out I could see was through the woods."""
?L88:	EQUAL? OBJ,GLOBAL-STILES,STILES \?L91
	PRINTR """There's not much to tell. I'm a writer, but that doesn't take you far these days. So I do some film work on the side. Some day my agent will wise up and find me a decent publisher."""
?L91:	ZERO? TOO-LATE \?L94
	EQUAL? OBJ,INSIDE-GUN,OUTSIDE-GUN \?L94
	PRINTR """I've never seen it before. Anyhow, I don't like guns."""
?L94:	EQUAL? OBJ,MATCHBOOK /?L98
	EQUAL? OBJ,INTNUM \?L97
	EQUAL? P-NUMBER,1729 \?L97
?L98:	PRINTI """That's my phone number! Linder must have jotted it down the day we had lunch at that restaurant,"
	PRINTR " when he first offered me money to leave town."""
?L97:	EQUAL? OBJ,BRASS-LANTERN \?L101
	PRINTI """I think that's the name of the restaurant where Linder took me to lunch,"
	PRINTR " when he first offered me money to leave town."""
?L101:	ZERO? TOO-LATE \?L107
	EQUAL? OBJ,MEDICAL-REPORT,TUMOR \?L104
	PRINTR """So the old man was on the way out, eh? Wish I'd known that."" He pauses. ""I mean, I could have taken his money and blown town until he kicked the bucket, then come back. Too late now."""
?L104:	ZERO? TOO-LATE \?L107
	EQUAL? OBJ,THREAT-NOTE \?L107
	PRINTR """Holy smoke! That sort of looks like my writing, but I didn't write it."""
?L107:	CALL PICK-ONE,STILES-ASKED >STACK
	PRINT STACK
	CRLF
	RTRUE
?L42:	EQUAL? PRSA,V?PHONE,V?LOOK-UP \?L113
	CALL PERFORM,PRSA,MATCHBOOK
	RTRUE
?L113:	ZERO? TOO-LATE /?L114
	EQUAL? PRSA,V?SEARCH /?L115
	EQUAL? PRSO,MONEY \?L116
	EQUAL? PRSA,V?TAKE,V?GIVE /?L115
?L116:	EQUAL? PRSI,MONEY \?L114
	EQUAL? PRSA,V?SGIVE,V?SEARCH-OBJECT-FOR,V?ASK-FOR \?L114
?L115:	PRINTI "When you try it, he whirls around in a fighting stance. ""Don't mess around with me, buddy. I've handled thieves before."""
	CRLF
	CALL PRINT-ID,STR?114 >STACK
	RSTACK
?L114:	EQUAL? PRSO,STILES \?L126
	EQUAL? PRSA,V?SHOW \?L119
	CALL PERFORM,V?ASK-ABOUT,PRSO,PRSI
	RTRUE
?L119:	EQUAL? PRSO,STILES \?L126
	EQUAL? PRSA,V?RUB,V?SLAP \?L120
	PRINTI "Stiles"
	PRINTI "'s eyes are full of hate, and "
	PRINTI "he says something unprintable."
	CRLF
	CALL PRINT-ID,STR?115 >STACK
	RSTACK
?L120:	EQUAL? PRSO,STILES \?L126
	EQUAL? PRSA,V?TIE-WITH,V?TIE-TO \?L123
	ZERO? TOO-LATE \?L123
	PRINTR "There's no need. Duffy's cuffs are secure enough."
?L123:	EQUAL? PRSO,STILES \?L126
	EQUAL? PRSA,V?UNTIE \?L126
	ZERO? TOO-LATE \?L126
	PRINTR "Your key won't fit the cuffs."
?L126:	EQUAL? PRSA,V?TAKEOUT \?L129
	ZERO? TOO-LATE \?L129
	EQUAL? PRSI,LINDER-BACK-DOOR,MONICA-BACK-DOOR,OFFICE-BACK-DOOR \?L129
	PRINTR "Your key won't fit the cuffs."
?L129:	EQUAL? PRSA,V?ARREST \FALSE
	CALL ARREST,STILES >STACK
	RSTACK

	.FUNCT STILES-SHOES-F
	EQUAL? PRSA,V?PUT,V?COMPARE \?L6
	EQUAL? PRSO,SIDE-FOOTPRINTS-CAST,SIDE-FOOTPRINTS /?L3
	EQUAL? PRSI,SIDE-FOOTPRINTS-CAST,SIDE-FOOTPRINTS \?L1
?L3:	PRINTI "The shoes don't seem to match "
	PRINTI "the foot prints that you found in the "
	PRINTR "side yard."
?L1:	EQUAL? PRSA,V?PUT,V?COMPARE \?L6
	EQUAL? PRSO,BACK-FOOTPRINTS-CAST,BACK-FOOTPRINTS /?L7
	EQUAL? PRSI,BACK-FOOTPRINTS-CAST,BACK-FOOTPRINTS \?L6
?L7:	EQUAL? PRSA,V?PUT /?L10
	EQUAL? P-ADVERB,W?CAREFULLY \?L8
?L10:	SET 'BACK-FOOTPRINTS-MATCHED,1
	PRINTR "The shoes and the foot prints match each other perfectly."
?L8:	PRINTI "The shoes look similar to "
	PRINTI "the foot prints that you found in the "
	PRINTR "back yard."
?L6:	CALL RANDOM-SHOES-F >STACK
	RSTACK

	.FUNCT MONICA-F,ARG=0,OBJ,L,X
	LOC MONICA >L
	EQUAL? ARG,M-OBJDESC \?L1
	CALL IN-MOTION?,MONICA >STACK
	ZERO? STACK \TRUE
	FSET? MONICA,TOUCHBIT \?L5
	ZERO? MONICA-TIED-TO /?L6
	PRINTI "Monica is fastened to the "
	PRINTD MONICA-TIED-TO
	PRINTI " with the "
	PRINTD MONICA-TIED-WITH
	PRINTR "."
?L6:	EQUAL? L,MONICA-ROOM \?L10
	PRINTR "Monica is lying on her bed, softly sobbing."
?L10:	EQUAL? L,TOILET-ROOM \?L13
	PRINTR "Monica is leaning over the toilet, gasping."
?L13:	PRINTR "Monica is here, biting her nails."
?L5:	FSET MONICA,TOUCHBIT
	PRINTI "Monica "
	LOC LINDER >STACK
	LOC MONICA >STACK
	EQUAL? STACK,STACK \?L22
	PRINTI "stops talking and "
?L22:	PRINTI "looks at you sharply. "
	GETP MONICA,P?TEXT >STACK
	PRINT STACK
	CRLF
	RTRUE
?L1:	EQUAL? WINNER,MONICA \?L29
	FSET MONICA,TOUCHBIT
	EQUAL? PRSA,V?FIND \?L30
	EQUAL? PRSO,CLOCK-KEY \?L30
	SET 'WINNER,PLAYER
	CALL PERFORM,V?ASK-ABOUT,MONICA,PRSO
	RTRUE
?L30:	EQUAL? PRSA,V?THANKS,V?FIND /FALSE
	EQUAL? PRSA,V?GIVE \?L35
	EQUAL? PRSO,INSIDE-GUN,GENERIC-GUN,GENERIC-KEY /?L36
	EQUAL? PRSO,CLOCK-KEY /?L36
?L35:	EQUAL? PRSA,V?SGIVE \?L33
	EQUAL? PRSI,INSIDE-GUN /?L36
	EQUAL? PRSI,GENERIC-GUN,GENERIC-KEY,CLOCK-KEY \?L33
?L36:	PRINTR """Why should I?"""
?L33:	CALL COM-CHECK,MONICA >STACK
	ZERO? STACK \TRUE
	CALL PICK-ONE,WHY-ME >STACK
	PRINT STACK
	CRLF
	RTRUE
?L29:	EQUAL? PRSA,V?ACCUSE \?L43
	SET 'MONICA-CLAMS-UP,1
	ZERO? MONICA-SEEN-CORPSE? \?L44
	PRINTR """What murder? What are you talking about?"" Her cheeks quiver like jelly."
?L44:	ZERO? SEEN-MONICA-AT-CLOCK \?L48
	ZERO? MONICA-ADMITTED-HELPING? \?L48
	PRINTR """You were there when it happened. Isn't it obvious that Stiles did it?"""
?L48:	ZERO? MONICA-SAW-MEDICAL-REPORT \?L51
	FCLEAR MEDICAL-REPORT,INVISIBLE
	FCLEAR TUMOR,INVISIBLE
	SET 'MONICA-SAW-MEDICAL-REPORT,1
	SET 'MONICA-ADMITTED-HELPING?,1
	PRINTI """It's true I helped set up the gun mechanism. But Dad was already[RWD_ID: people:984, VAL: 1] dying! You can find the medical report on the desk "
	IN? MONICA,MONICA-ROOM \?L54
	PRINTI "here "
?L54:	PRINTR "in my room. He was ... dying ..."" She breaks down in tears."
?L51:	ZERO? MONICA-SAW-CORONER-REPORT \?L61
	PRINTR """I've told you already: he was dying!"" Tears dribble down her cheeks."
?L61:	PRINTR """I don't understand! I believed that medical report, and I don't know why the doctor lied to me about the tumor. You think I wanted to murder my own father? I thought he was dying already!"" Her eyes are pleading with you now, begging you to believe her."
?L43:	ZERO? PRSI /?L69
	SET 'OBJ,PRSI
	ZERO? OBJ /?L69
	EQUAL? PRSO,MONICA \?L69
	EQUAL? PRSA,V?ASK-ABOUT,V?CONFRONT /?L68
?L69:	ZERO? PRSO /?L67
	IN? PRSO,GLOBAL-OBJECTS \?L67
	SET 'OBJ,PRSO
	ZERO? OBJ /?L67
	EQUAL? PRSA,V?WHAT,V?FIND \?L67
?L68:	CALL GRAB-ATTENTION,MONICA >STACK
	ZERO? STACK /TRUE
	CALL SAID-TO,MONICA
	FSET MONICA,TOUCHBIT
	EQUAL? OBJ,MONEY,GLOBAL-PTA /?L75
	EQUAL? OBJ,GLOBAL-TERRY,GENERIC-CAR \?L73
?L75:	PRINTR """That has nothing to do with why Dad asked you here."""
?L73:	EQUAL? OBJ,BUTTON \?L78
	SET 'MONICA-CLAMS-UP,1
	PRINTR """That's the butler's button, you cheesehead."""
?L78:	EQUAL? OBJ,GENERIC-GUN \?L81
	SET 'MONICA-CLAMS-UP,1
	PRINTR """I have nothing to say to you about that."""
?L81:	EQUAL? OBJ,BLACK-WIRE \?L84
	PRINTR """That bell system is just one of the features I've put in this house. Beyond your imagination, probably."""
?L84:	EQUAL? OBJ,WHITE-WIRE \?L87
	PRINTR """That alarm system is another of the features I've put in this house. You probably know the kind of low-life that would try to break in here."""
?L87:	EQUAL? OBJ,GENERIC-GREEN-WIRE,GENERIC-WIRE \?L90
	SET 'MONICA-CLAMS-UP,1
	PRINTI """You want wire? You can find all kinds "
	EQUAL? HERE,WORKSHOP \?L93
	PRINTI "here "
?L93:	PRINTR "in the workshop."""
?L90:	EQUAL? OBJ,GLOBAL-MONICA,MONICA \?L100
	PRINTR """I have no secrets. Anyone can see what I am."""
?L100:	EQUAL? OBJ,GENERIC-KEY,PHONG-KEYS \?L103
	PRINTR """Phong keeps the house keys. Ask him."""
?L103:	EQUAL? OBJ,GLOBAL-LINDER,LINDER,CORPSE \?L106
	ZERO? MONICA-CLAMS-UP /?L107
	PRINTI """What can I say? He"
	ZERO? MONICA-SEEN-CORPSE? /?L111
	PRINTI " wa"
	JUMP ?L115
?L111:	PRINTI "'"
?L115:	PRINTR "s my father, a hard-working, clever man."""
?L107:	SET 'MONICA-CLAMS-UP,1
	ZERO? MONICA-SEEN-CORPSE? /?L121
	SET 'MONICA-HAS-MOTIVE,CORPSE
	PRINTI "She rambles a bit, as if dreaming. ""To be honest, I feel relieved ... that he's met his Maker. Now I won't feel as if I'm under his thumb when he's home. He really treated all of us like ... his property, even Mother. I guess I'm an orphan now, but ... """
	PRINT SHE-CLAMS-UP
	CRLF
	RTRUE
?L121:	SET 'MONICA-HAS-MOTIVE,LINDER
	CALL DISCRETION,MONICA,LINDER
	PRINTI """Oh, I can tell you lots about him. Do you want to know if he was a good husband? A good father? Anything but a selfish ..."""
	PRINT SHE-CLAMS-UP
	CRLF
	RTRUE
?L106:	EQUAL? OBJ,GLOBAL-AFFAIR,GLOBAL-MRS-LINDER \?L128
	SET 'MONICA-HAS-MOTIVE,GLOBAL-MRS-LINDER
	CALL DISCRETION,MONICA,LINDER
	ZERO? MONICA-CLAMS-UP /?L129
	PRINTR """That's between Mother and me."""
?L129:	SET 'MONICA-CLAMS-UP,1
	PRINTI """She was the most noble woman I've ever known. Did her best to be a[RWD_ID: people:1068, VAL: 1] 'good wife' even though she was alone so much. No one understood her as I did, certainly not Father. Sometimes I feel I could just ..."" She slams a clenched fist into her palm."
	PRINT SHE-CLAMS-UP
	CRLF
	RTRUE
?L128:	EQUAL? OBJ,GLOBAL-MURDER,DANGER \?L136
	ZERO? MONICA-SEEN-CORPSE? \?L137
	PRINTR """What do you think this is, a cheap whodunit?"""
?L137:	ZERO? MONICA-ADMITTED-HELPING? \?L141
	PRINTI """Isn't it obvious? That "
	CALL TANDY? >STACK
	ZERO? STACK /?L144
	PRINTI "idiot"
	JUMP ?L148
?L144:	PRINTI "bastard"
?L148:	PRINTR " Stiles squibbed him off!"""
?L141:	SET 'WINNER,PLAYER
	CALL PERFORM,V?ACCUSE,MONICA,GLOBAL-MURDER
	RTRUE
?L136:	EQUAL? OBJ,GLOBAL-PHONG,PHONG \?L154
	CALL DISCRETION,MONICA,PHONG
	PRINTI """He's a right gee, no matter what some people say about his "
	CALL TANDY? >STACK
	ZERO? STACK /?L157
	PRINTI "kind"
	JUMP ?L161
?L157:	PRINTI "race"
?L161:	PRINTR "."""
?L154:	EQUAL? OBJ,GLOBAL-STILES,STILES \?L166
	ZERO? MONICA-ADMITTED-HELPING? /?L167
	SET 'MONICA-CLAMS-UP,1
	PRINTI """That poor "
	CALL TANDY? >STACK
	ZERO? STACK /?L171
	PRINTI "idiot"
	JUMP ?L175
?L171:	PRINTI "bastard"
?L175:	PRINTR ". First he fell in love with Mother, a married woman; then he actually trusted her husband. I don't know what he uses for brains."""
?L167:	ZERO? MONICA-SEEN-CORPSE? /?L180
	PRINTI """That "
	CALL TANDY? >STACK
	ZERO? STACK /?L183
	PRINTI "idiot"
	JUMP ?L187
?L183:	PRINTI "bastard"
?L187:	PRINTR " who killed Dad? I'd spit in his face if it was worth the trouble."""
?L180:	CALL DISCRETION,MONICA,STILES
	PRINTR """Oh, that lover boy thinks he's a smooth apple, all right. If you ask me, he's just a harmless grifter."""
?L166:	EQUAL? OBJ,PLAYER \?L195
	PRINTI """I don't know anything about you, but I "
	ZERO? MONICA-SEEN-CORPSE? /?L198
	PRINTI "had hoped you could"
	JUMP ?L202
?L198:	PRINTI "hope you can"
?L202:	PRINTR " help Dad."""
?L195:	EQUAL? OBJ,GLOBAL-SUICIDE \?L207
	PRINTR """I don't want to talk about it."""
?L207:	EQUAL? OBJ,GLOBAL-TERRY \?L210
	PRINTR """Terry's a good friend of mine, that's all."""
?L210:	EQUAL? OBJ,WILL \?L213
	ZERO? MONICA-SEEN-CORPSE? /?L214
	SET 'PHONG-HAS-MOTIVE,WILL
	CALL DISCRETION,MONICA,PHONG
	PRINTR """Dad kept it in his bank safe. I'll bet Phong would like to see it."""
?L214:	PRINTR """You'll have to ask Dad about that."""
?L213:	EQUAL? OBJ,FILE-CABINET \?L221
	PRINTR """That has nothing to do with why Dad asked you here."""
?L221:	EQUAL? OBJ,CAT \?L224
	PRINTR """She's my cat. I named her Asta, because she's at least as smart as the dog in 'The Thin Man.'"""
?L224:	EQUAL? OBJ,CLOCK-KEY \?L227
	IN? CLOCK-KEY,MONICA \?L228
	SET 'MONICA-CLAMS-UP,1
	PRINTR """I don't know where Dad keeps it."""
?L228:	PRINTR """That's the only key for the clock. So what?"""
?L227:	EQUAL? OBJ,GUN-RECEIPT \?L235
	PRINTR """What about it? It's no crime to get a little heat for self-protection."""
?L235:	EQUAL? OBJ,INSIDE-GUN \?L238
	FSET? INSIDE-GUN,TOUCHBIT \?L239
	PRINTR "Monica has the wild look of a trapped animal. ""I can't understand why that heater was inside the clock."""
?L239:	PRINTR """I don't know what you're talking about."""
?L238:	EQUAL? OBJ,MEDICAL-REPORT,TUMOR \?L246
	ZERO? MONICA-SEEN-CORPSE? /?L247
	ZERO? MONICA-ADMITTED-HELPING? /?L249
	SET 'WINNER,PLAYER
	CALL PERFORM,V?ACCUSE,MONICA,GLOBAL-MURDER
	RTRUE
?L249:	ZERO? MONICA-SAW-MEDICAL-REPORT /?L251
	PRINTI """I already told you: Dad was about to kick the bucket anyway."""
	CRLF
	JUMP ?L265
?L251:	FCLEAR MEDICAL-REPORT,INVISIBLE
	FCLEAR TUMOR,INVISIBLE
	PRINTI """Dad gave "
	EQUAL? OBJ,MEDICAL-REPORT \?L257
	PUSH STR?116
	JUMP ?L259
?L257:	PUSH STR?117
?L259:	PRINT STACK
	PRINTI "so I could try to understand what was wrong and what his chances were. Now I guess Stiles has ended Dad's pain."""
	CRLF
	JUMP ?L265
?L247:	CALL DISCRETION,MONICA,LINDER
	ZERO? MONICA-SAW-MEDICAL-REPORT /?L261
	PRINTI """I already told you: Dad's about to kick the bucket."""
	CRLF
	JUMP ?L265
?L261:	PRINTI """How did you find that? Dad gave it to me so I could try to understand what's wrong and what his chances are. They don't look good."" She looks alarmed."
	CRLF
?L265:	SET 'MONICA-SAW-MEDICAL-REPORT,1
	RTRUE
?L246:	EQUAL? OBJ,PIECE-OF-WIRE,CLOCK-WIRES,PIECE-OF-PUTTY \?L268
	ZERO? MONICA-ADMITTED-HELPING? \?L268
	SET 'MONICA-CLAMS-UP,1
	PRINTR """Oh, uh, that's part of a timed lock I set up for the office."""
?L268:	EQUAL? OBJ,OFFICE-BUTTON,CLOCK,POWDER /?L272
	EQUAL? OBJ,CLOCK-POWDER /?L272
	EQUAL? OBJ,PIECE-OF-WIRE,CLOCK-WIRES,PIECE-OF-PUTTY \?L271
	ZERO? MONICA-ADMITTED-HELPING? /?L271
?L272:	ZERO? MONICA-SEEN-CORPSE? /?L273
	ZERO? PLAYER-PUSHED-BUTTON /?L273
	SET 'MONICA-ADMITTED-HELPING?,1
	SET 'MONICA-CLAMS-UP,1
	PRINTR """You seem to have discovered Dad's little plot to frighten Stiles. Sure, I helped set it up for him. But I don't know what went wrong. He wasn't supposed to die!"" Her lower lip is quivering."
?L273:	EQUAL? OBJ,OFFICE-BUTTON \?L277
	PRINTR """That's the butler's button, you cheesehead."""
?L277:	PRINTR """Phong really ought to do a better job of cleaning around here."""
?L271:	EQUAL? OBJ,OUTSIDE-GUN \?L283
	ZERO? MONICA-ADMITTED-HELPING? /?L284
	SET 'MONICA-CLAMS-UP,1
	PRINTR """That gat you found? Phong planted it so it would look as if Stiles used it."""
?L284:	ZERO? MONICA-SEEN-CORPSE? /?L288
	CALL DISCRETION,MONICA,STILES
	PRINTR """That gat you found? It must belong to Stiles."""
?L288:	PRINTR """I've never seen it before. It looks as if you don't take good care of it."""
?L283:	EQUAL? OBJ,RECURSIVE-BOOK \?L294
	PRINTR """It's a swell mystery called 'Deadline.' I haven't figured it out yet."""
?L294:	EQUAL? OBJ,TELEGRAM \?L297
	PRINTR """That must be the telegram Dad sent this morning."""
?L297:	EQUAL? OBJ,STUB \?L300
	PRINTR """That looks like my ticket stub. I didn't know I dropped it."""
?L300:	EQUAL? OBJ,GLOBAL-FILM \?L303
	ZERO? FILM-SEEN /?L304
	PRINTR """It was called 'Dead End'. I don't think this Bogart guy is pretty enough to make it big."""
?L304:	PRINTR """I think we'll see 'Dead End'. Terry wants to check out this guy named Bogart."""
?L303:	PRINTI """I don't know anything about it, shamus."
	INC 'MONICA-QUESTIONS
	LESS? 6,MONICA-QUESTIONS \?L314
	PRINTI " And I'm really getting tired of your questions."
?L314:	PRINTR """"
?L67:	EQUAL? PRSO,MONICA \?L340
	EQUAL? PRSA,V?GOODBYE \?L321
	FSET MONICA,TOUCHBIT
	PRINTR """If I never see you again, it's jake with me."""
?L321:	EQUAL? PRSO,MONICA \?L340
	EQUAL? PRSA,V?RUB \?L324
	FSET MONICA,TOUCHBIT
	ZERO? MONICA-TIED-TO \?L325
	CALL MONICA-PUSHES >STACK
	RSTACK
?L325:	PRINTI "Monica writhes away from your touch and manages to kick you in the shin."
	CRLF
	CALL PRINT-ID,STR?118 >STACK
	RSTACK
?L324:	EQUAL? PRSO,MONICA \?L340
	EQUAL? PRSA,V?ASK-FOR \?L330
	FSET MONICA,TOUCHBIT
	ZERO? MONICA-TIED-TO /?L331
	PRINTR """How can I give you anything when I'm tied up?"""
?L331:	EQUAL? PRSI,INSIDE-GUN,GENERIC-GUN /?L336
	EQUAL? PRSI,PHONG-KEYS,GENERIC-KEY,CLOCK-KEY \FALSE
?L336:	CALL PERFORM,V?ASK-ABOUT,MONICA,PRSI
	RTRUE
?L330:	EQUAL? PRSO,MONICA \?L340
	SET 'OBJ,PRSI
	ZERO? OBJ /?L340
	EQUAL? PRSA,V?SEARCH-OBJECT-FOR,V?SEARCH /?L339
?L340:	EQUAL? PRSI,MONICA \?L338
	SET 'OBJ,PRSO
	ZERO? OBJ /?L338
	EQUAL? PRSA,V?TAKE \?L338
?L339:	FSET MONICA,TOUCHBIT
	ZERO? MONICA-TIED-TO \?L341
	CALL MONICA-PUSHES >STACK
	RSTACK
?L341:	IN? CLOCK-KEY,MONICA \?L343
	EQUAL? PRSA,V?SEARCH /?L344
	EQUAL? OBJ,GENERIC-KEY,CLOCK-KEY \?L343
?L344:	MOVE CLOCK-KEY,PLAYER
	FCLEAR CLOCK-KEY,INVISIBLE
	FSET CLOCK-KEY,TOUCHBIT
	PRINTR "You find a single key in Monica's pocket and take it."
?L343:	IN? INSIDE-GUN,MONICA \FALSE
	EQUAL? PRSA,V?SEARCH /?L348
	EQUAL? OBJ,GENERIC-GUN,INSIDE-GUN \FALSE
?L348:	SET 'SEEN-MONICA-AT-CLOCK,1
	ZERO? USED-CLOCK-KEY \?L349
	PRINTI "[RWD_ID: people:1281, VAL: 1]"
?L349:	MOVE INSIDE-GUN,PLAYER
	FCLEAR INSIDE-GUN,INVISIBLE
	FSET INSIDE-GUN,TOUCHBIT
	PRINTR "You find a hand gun in Monica's pocket and take it."
?L338:	EQUAL? PRSO,MONICA \?L358
	EQUAL? PRSA,V?SHOW \?L357
	CALL PERFORM,V?ASK-ABOUT,PRSO,PRSI
	RTRUE
?L357:	EQUAL? PRSO,MONICA \?L358
	EQUAL? PRSA,V?SLAP \?L361
	IN? MONICA,MONICA-ROOM \?L358
	FSET MONICA,TOUCHBIT
	PRINTI "Monica screams, ""Leave me alone! I'll get over it! Please!"""
	CRLF
	CALL PRINT-ID,STR?119 >STACK
	RSTACK
?L358:	EQUAL? PRSA,V?SLAP \?L361
	ZERO? MONICA-TIED-TO /?L361
	FSET MONICA,TOUCHBIT
	PRINTI "Monica's eyes are full of hate, and she says something unprintable."
	CRLF
	CALL PRINT-ID,STR?120 >STACK
	RSTACK
?L361:	EQUAL? PRSO,MONICA \?L380
	EQUAL? PRSA,V?TIE-TO \?L364
	CALL PRINT-ID,STR?121
	FSET MONICA,TOUCHBIT
	ZERO? MONICA-TIED-TO /?L365
	PRINTI "She's already fastened to the "
	PRINTD MONICA-TIED-TO
	PRINTR "."
?L365:	ZERO? CLOCK-FIXED /?L369
	FSET? PRSI,FURNITURE \?L369
	IN? HANDCUFFS,PLAYER \?L369
	SET 'MONICA-CLAMS-UP,1
	SET 'MONICA-TIED-TO,PRSI
	SET 'MONICA-TIED-WITH,HANDCUFFS
	PRINTI "(with your handcuffs)"
	CRLF
	JUMP ?L372
?L369:	CALL MONICA-PUSHES
	RTRUE
?L372:	ZERO? MONICA-TIED-WITH /?L373
	MOVE MONICA-TIED-WITH,PRSI
	FCLEAR MONICA-TIED-WITH,TAKEBIT
	FSET MONICA-TIED-WITH,NDESCBIT
	GET GOAL-TABLES,MONICA-C >STACK
	PUT STACK,GOAL-ENABLE,0
	GET MOVEMENT-GOALS,MONICA-C >STACK
	ADD STACK,MG-LENGTH >STACK
	PUT MOVEMENT-GOALS,MONICA-C,STACK
	PRINTR "She puts up a struggle, but you manage to do it."
?L373:	PRINTI "There's nothing to tie her "
	PRINTR "with!"
?L364:	EQUAL? PRSO,MONICA \?L380
	EQUAL? PRSA,V?TIE-WITH \?L380
	FSET MONICA,TOUCHBIT
	ZERO? MONICA-TIED-WITH /?L381
	PRINTI "She's already fastened with the "
	PRINTD MONICA-TIED-WITH
	PRINTR "."
?L381:	ZERO? CLOCK-FIXED /?L385
	EQUAL? PRSI,HANDCUFFS \?L385
	CALL FIND-FLAG,HERE,FURNITURE >X
	ZERO? X /?L386
	PRINTI "(to the "
	PRINTD X
	PRINTI ")"
	CRLF
	SET 'MONICA-TIED-TO,X
	JUMP ?L391
?L386:	SET 'MONICA-TIED-TO,0
	JUMP ?L391
?L385:	CALL MONICA-PUSHES
	RTRUE
?L391:	ZERO? MONICA-TIED-TO /?L392
	SET 'MONICA-CLAMS-UP,1
	SET 'MONICA-TIED-WITH,PRSI
	MOVE PRSI,MONICA-TIED-TO
	FCLEAR PRSI,TAKEBIT
	FSET PRSI,NDESCBIT
	GET GOAL-TABLES,MONICA-C >STACK
	PUT STACK,GOAL-ENABLE,0
	GET GOAL-TABLES,MONICA-C >STACK
	PUT STACK,ATTENTION-SPAN,999
	PRINTR "She puts up a struggle, but you manage to do it."
?L392:	PRINTI "There's nothing to "
	EQUAL? PRSI,HANDCUFFS \?L399
	PUSH STR?77
	JUMP ?L401
?L399:	PUSH STR?78
?L401:	PRINT STACK
	PRINTR "her to!"
?L380:	EQUAL? PRSA,V?UNTIE \?L402
	ZERO? MONICA-TIED-TO \?L403
	PRINTR "She's not even tied up!"
?L403:	EQUAL? PRSI,0,MONICA-TIED-TO /?L407
	PRINTI "She's not fastened to the "
	PRINTD PRSI
	PRINTR "!"
?L407:	MOVE MONICA-TIED-WITH,PLAYER
	PRINTI "Monica rubs her wrists as you take the "
	PRINTD MONICA-TIED-WITH
	PRINTI "."
	ZERO? FINGERPRINT-OBJ \?L413
	ZERO? DUFFY-AT-CORONER \?L413
	PRINTI " Her eyes dart from door to door, then she bolts for the hallway. But, within seconds, Sgt. Duffy brings her back."
?L413:	CALL RELEASE-MONICA
	PRINTR " She refuses to look at you."
?L402:	EQUAL? PRSA,V?TAKEOUT \?L420
	EQUAL? PRSI,LINDER-BACK-DOOR,MONICA-BACK-DOOR,OFFICE-BACK-DOOR \?L420
	ZERO? MONICA-TIED-TO /?L421
	PRINTI "You can't take her and the "
	PRINTD MONICA-TIED-TO
	PRINTR " both!"
?L421:	CALL MONICA-PUSHES >STACK
	RSTACK
?L420:	EQUAL? PRSA,V?ARREST \FALSE
	CALL ARREST,MONICA >STACK
	RSTACK

	.FUNCT MONICA-PUSHES
	PRINTI "Monica pushes you away with surprising strength. ""I don't know what game you're playing, Detective, but count me out. If you think I'm just a dumb twi"
	CALL PRINT-ID,STR?122
	CALL TANDY? >STACK
	ZERO? STACK \?L3
	PRINTI "s"
?L3:	PRINTR "t, think again."" Her eyes burn like polished gems."

	.FUNCT RELEASE-MONICA
	SET 'MONICA-TIED-TO,0
	SET 'MONICA-TIED-WITH,0
	FSET MONICA-TIED-WITH,TAKEBIT
	FCLEAR MONICA-TIED-WITH,NDESCBIT
	RTRUE

	.FUNCT CAT-F
	EQUAL? PRSA,V?KICK \?L1
	PRINTI "Like a fly, the cat springs up just in time, then goes to a different corner to settle down."
	CRLF
	CALL PRINT-ID,STR?123 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?HELLO,V?RUB \FALSE
	PRINTI "The cat purrs a little louder and curls one paw."
	CRLF
	CALL PRINT-ID,STR?124 >STACK
	RSTACK

	.FUNCT GLOBAL-PERSON
	EQUAL? PRSA,V?PHONE,V?$0024CALL,V?FOLLOW /FALSE
	EQUAL? PRSA,V?WAIT-FOR,V?FIND,V?WHAT /FALSE
	EQUAL? PRSA,V?TELL-ME,V?ASK-ABOUT \?L4
	ZERO? PRSO /?L4
	FSET? PRSO,PERSON \?L6
	IN? PRSO,GLOBAL-OBJECTS \FALSE
?L6:	EQUAL? PRSO,GLOBAL-DUFFY /FALSE
?L4:	EQUAL? PRSA,V?TELL \?L7
	PRINTI "You can't speak to someone who isn't here."
	CRLF
	SET 'P-CONT,0
	RTRUE
?L7:	EQUAL? PRSA,V?ARREST \?L10
	EQUAL? PRSO,GLOBAL-LINDER \?L11
	CALL ARREST,GLOBAL-LINDER >STACK
	RSTACK
?L11:	GETP PRSO,P?CHARACTER >STACK
	GET CHARACTER-TABLE,STACK >STACK
	CALL ARREST,STACK >STACK
	RSTACK
?L10:	EQUAL? PRSA,V?TELL-ME,V?ASK-ABOUT /?L17
	ZERO? NOW-PRSI \?L15
?L17:	PRINTD PRSO
	JUMP ?L20
?L15:	PRINTD PRSI
?L20:	EQUAL? PRSA,V?ASK-FOR,V?ASK-ABOUT,V?GOODBYE /?L25
	EQUAL? PRSA,V?HELLO,V?TELL,V?$0024CALL \?L23
?L25:	GETP HERE,P?CORRIDOR >STACK
	GETP PRSO,P?CHARACTER >STACK
	GET CHARACTER-TABLE,STACK >STACK
	LOC STACK >STACK
	GETP STACK,P?CORRIDOR >STACK
	BAND STACK,STACK >STACK
	ZERO? STACK /?L23
	PRINTI " can't hear you."
	CRLF
	JUMP ?L28
?L23:	PRINTI " isn't here!"
	CRLF
?L28:	SET 'P-CONT,0
	RTRUE

	.FUNCT GLOBAL-MRS-LINDER-F
	EQUAL? PRSA,V?FOLLOW \?L1
	PRINTR "You will eventually, shamus, you will."
?L1:	EQUAL? PRSA,V?PHONE,V?$0024CALL \FALSE
	PRINTR "You're not with her yet."

	.FUNCT HINT-F
	EQUAL? PRSA,V?ASK-FOR \?L4
	EQUAL? PRSO,GLOBAL-DUFFY \?L3
?L4:	EQUAL? PRSA,V?TAKE \FALSE
	EQUAL? PRSI,GLOBAL-DUFFY /FALSE
?L3:	PRINTR "You'll have to be more specific."

	.FUNCT GLOBAL-DUFFY-F
	EQUAL? PRSA,V?PHONE \?L1
	EQUAL? PRSO,GLOBAL-DUFFY \?L1
	CALL PHONE-IN?,HERE >STACK
	ZERO? STACK /?L1
	ZERO? SEEN-DUFFY? /?L3
	PRINTR "Duffy must be around here somewhere. There's no point in trying to phone him."
?L3:	PRINTR "The night clerk at the station says he'll give Duffy your message."
?L1:	ZERO? SEEN-DUFFY? \?L10
	PRINTI "Sergeant Duffy is probably at the station, working late as usual."
	CRLF
	RETURN 2
?L10:	EQUAL? PRSA,V?WAIT-FOR \?L15
	EQUAL? PRSO,GLOBAL-DUFFY \?L15
	ZERO? FINGERPRINT-OBJ \?L18
	ZERO? DUFFY-AT-CORONER \?L18
	ZERO? MET-DUFFY? \?L16
?L18:	CALL V-WAIT,10000,PRSO >STACK
	RSTACK
?L16:	PRINTR "You'd wait quite a while, since Sergeant Duffy is always nearby but never approaches you without a good reason."
?L15:	ZERO? FINGERPRINT-OBJ \?L23
	ZERO? DUFFY-AT-CORONER /?L22
?L23:	CALL DO-FINGERPRINT
	RETURN 2
?L22:	EQUAL? PRSA,V?SHOOT,V?ARREST \?L26
	EQUAL? PRSO,GLOBAL-DUFFY \?L26
	PRINTI "Oh, come on now! Not trusty "
	PRINTD PRSO
	PRINTI "!"
	CRLF
	EQUAL? PRSA,V?SHOOT /?L29
	PUSH 0
	JUMP ?L30
?L29:	PUSH 1
?L30:	CALL PRINT-ID,STR?125,STACK
	EQUAL? PRSA,V?ARREST /?L31
	PUSH 0
	JUMP ?L32
?L31:	PUSH 1
?L32:	CALL PRINT-ID,STR?126,STACK >STACK
	RSTACK
?L26:	EQUAL? PRSA,V?FIND \?L33
	EQUAL? PRSO,GLOBAL-DUFFY \?L33
	PRINTR "Like a lurking grue in the dark places of the earth, Sergeant Duffy is never far from the scene of a crime. If you witness a crime, you can be sure he'll show up soon. Then, if you ANALYZE something, he will appear in an instant to take it to the lab. When the results are available, he will rush them back to you. If you ARREST someone, he will be there with the handcuffs. You can't find a more dedicated civil servant."
?L33:	EQUAL? PRSA,V?FOLLOW \?L36
	EQUAL? PRSO,GLOBAL-DUFFY \?L36
	ZERO? DUFFY-WITH-STILES /?L37
	CALL PERFORM,PRSA,STILES,PRSI
	RTRUE
?L37:	PRINTR "Duffy is too quick to follow."
?L36:	ZERO? MET-DUFFY? \?L42
	CALL I-MEET-DUFFY? >STACK
	ZERO? STACK \TRUE
	PRINTR "It looks as though Duffy didn't hear you."
?L42:	EQUAL? PRSA,V?$0024CALL \?L48
	EQUAL? PRSO,GLOBAL-DUFFY /FALSE
?L48:	EQUAL? WINNER,GLOBAL-DUFFY \?L49
	EQUAL? PRSA,V?MAKE,V?SANALYZE,V?ANALYZE \?L50
	SET 'WINNER,PLAYER
	CALL PERFORM,PRSA,PRSO,PRSI
	RTRUE
?L50:	EQUAL? PRSA,V?ARREST \?L52
	SET 'WINNER,PLAYER
	CALL PERFORM,V?ARREST,PRSO
	RTRUE
?L52:	EQUAL? PRSA,V?THANKS,V?FIND /FALSE
	EQUAL? PRSA,V?GIVE \?L56
	EQUAL? PRSO,HINT \?L56
	EQUAL? PRSI,PLAYER /?L55
?L56:	EQUAL? PRSA,V?SGIVE \?L54
	EQUAL? PRSI,HINT \?L54
	EQUAL? PRSO,PLAYER \?L54
?L55:	CALL DUFFY-HINT >STACK
	RSTACK
?L54:	EQUAL? PRSA,V?TAKE \?L57
	PRINTI "Duffy"
	ZERO? DUFFY-WITH-STILES \?L60
	PRINTI " appears for an instant but"
?L60:	PRINTR " politely declines your offer."
?L57:	EQUAL? PRSA,V?PHONE \?L67
	EQUAL? PRSO,CORONER \?L67
	ZERO? DUFFY-WITH-STILES /?L68
	PRINTR """I will, as soon as I case the joint."""
?L68:	PRINTR """Oh, I called the coroner as soon as I saw the body. They'll be here as soon as they have time."""
?L67:	EQUAL? PRSO,STILES \?L75
	EQUAL? PRSA,V?UNTIE \?L75
	PRINTR """What?? I won't release a suspect!"""
?L75:	CALL COM-CHECK,GLOBAL-DUFFY >STACK
	ZERO? STACK \TRUE
	PRINTR """With all respect, I think you should do that yourself."""
?L49:	EQUAL? PRSA,V?ASK-ABOUT \?L82
	EQUAL? PRSO,GLOBAL-DUFFY \?L82
	ZERO? DUFFY-WITH-STILES \?L83
	PRINTI "Duffy appears for a moment. "
?L83:	PRINTI """"
	EQUAL? PRSI,CORONER \?L90
	LESS? PRESENT-TIME,720 \?L90
	PRINTI "Oh, I called the coroner as soon as I saw the body. They'll be here as soon as they have time."
	JUMP ?L128
?L90:	EQUAL? PRSI,CORONER,AUTOPSY \?L94
	ZERO? DUFFY-AT-CORONER \?L97
	LESS? PRESENT-TIME,720 \?L95
?L97:	PRINTI "Oh, I called the coroner as soon as I saw the body. They'll be here as soon as they have time."
	JUMP ?L128
?L95:	PRINTI "I thought I told you already. The coroner "
	ZERO? DUFFY-SAW-MEDICAL-REPORT /?L103
	PRINTI "found no evidence of the alleged stomach tumor. In fact, he could find no organic disease that would either explain the death or support the theory that Linder wanted to die. He "
?L103:	PRINTI "concluded that Linder died of a single small-caliber bullet through the heart. And here's something peculiar: there were no traceable rifle marks on the bullet."
	JUMP ?L128
?L94:	EQUAL? PRSI,GLOBAL-DUFFY \?L110
	PRINTI "Come off it, Detective. We've worked together before. You sure you didn't stop at a bar tonight?"
	JUMP ?L128
?L110:	EQUAL? PRSI,BATHTUB,TUB-ROOM \?L113
	PRINTI "Ah, that's where the late Mrs. Linder did herself in. A messy business, Detective."
	JUMP ?L128
?L113:	EQUAL? PRSI,GLOBAL-SUICIDE \?L116
	PRINTI "She shot herself in the bathtub."
	JUMP ?L128
?L116:	EQUAL? PRSI,GUN-RECEIPT \?L119
	PRINTI "Oh, I know that place, Fritzi's. Untidy, but clean."
	JUMP ?L128
?L119:	EQUAL? PRSI,MEDICAL-REPORT \?L122
	SET 'DUFFY-SAW-MEDICAL-REPORT,1
	PRINTI "Fascinating! It could have been a suicide, then."
	JUMP ?L128
?L122:	EQUAL? PRSI,RECURSIVE-BOOK \?L125
	PRINTI "Ah, Connecticut! I have relations there, you know. In fact, one young one wants to be a detective some day."
	JUMP ?L128
?L125:	PRINTI "I wish I could help you, Detective."
?L128:	PRINTI """"
	ZERO? DUFFY-WITH-STILES \?L133
	PRINTI " He scurries off again."
?L133:	CRLF
	RTRUE
?L82:	EQUAL? PRSA,V?ASK-FOR \?L138
	EQUAL? PRSI,HINT \?L138
	CALL DUFFY-HINT >STACK
	RSTACK
?L138:	EQUAL? PRSA,V?GIVE \?L141
	EQUAL? PRSI,GLOBAL-DUFFY /?L140
?L141:	EQUAL? PRSA,V?SGIVE \?L139
	EQUAL? PRSO,GLOBAL-DUFFY \?L139
?L140:	PRINTI "Duffy"
	ZERO? DUFFY-WITH-STILES \?L144
	PRINTI " appears for an instant but"
?L144:	PRINTR " politely declines your offer."
?L139:	EQUAL? PRSA,V?GOODBYE \?L151
	PRINTI """You can't leave yet, Detective. Think of your reputation!"""
	CRLF
	CALL PRINT-ID,STR?127 >STACK
	RSTACK
?L151:	EQUAL? PRSA,V?HELLO \?L154
	ZERO? DUFFY-WITH-STILES /?L155
	PRINTR """Hello again, Detective."""
?L155:	PRINTR "Duffy peeks around a corner, tips his hat to you, and disappears again."
?L154:	EQUAL? PRSO,GLOBAL-DUFFY \?L162
	EQUAL? PRSA,V?SHOW \?L162
	CALL PERFORM,V?ASK-ABOUT,PRSO,PRSI
	RTRUE
?L162:	EQUAL? PRSA,V?TAKE \FALSE
	EQUAL? PRSO,HINT \FALSE
	EQUAL? PRSI,GLOBAL-DUFFY \FALSE
	CALL DUFFY-HINT >STACK
	RSTACK

	.FUNCT COM-CHECK,PER
	EQUAL? PRSA,V?EXAMINE \?L1
	SET 'WINNER,PLAYER
	CALL PERFORM,V?SHOW,PER,PRSO
	RTRUE
?L1:	EQUAL? PRSA,V?FOLLOW \?L3
	EQUAL? PRSO,PLAYER \?L3
	PRINTR """I would rather not."""
?L3:	EQUAL? PRSA,V?GIVE \?L6
	EQUAL? PRSI,PLAYER \?L6
	SET 'WINNER,PLAYER
	CALL PERFORM,V?TAKE,PRSO,PER
	RTRUE
?L6:	EQUAL? PRSA,V?SGIVE \?L7
	EQUAL? PRSO,PLAYER \?L7
	SET 'WINNER,PLAYER
	CALL PERFORM,V?TAKE,PRSI,PER
	RTRUE
?L7:	EQUAL? PRSA,V?GOODBYE \?L8
	ZERO? PRSO /?L9
	EQUAL? PRSO,PER \?L8
?L9:	SET 'WINNER,PLAYER
	CALL PERFORM,V?GOODBYE,WINNER
	RTRUE
?L8:	EQUAL? PRSA,V?HELLO \?L10
	ZERO? PRSO /?L11
	EQUAL? PRSO,PER \?L10
?L11:	SET 'WINNER,PLAYER
	CALL PERFORM,V?HELLO,PER
	RTRUE
?L10:	EQUAL? PRSA,V?HELP \?L12
	EQUAL? PRSO,PLAYER /?L15
	ZERO? PRSO \?L13
?L15:	CALL PERFORM,V?GIVE,HINT,PLAYER
	RTRUE
?L13:	FSET? PRSO,PERSON \FALSE
	PRINTR """I don't need your help."""
?L12:	EQUAL? PRSA,V?INVENTORY \?L20
	PRINTI """"
	PRINTI "You're the detective!"
	PRINTR """"
?L20:	EQUAL? PRSA,V?SHOW \?L23
	EQUAL? PRSO,PLAYER \?L23
	PRINTR """I'm sure you can find it, Detective."""
?L23:	EQUAL? PRSA,V?TELL-ME \?L26
	EQUAL? PRSO,PLAYER \?L26
	SET 'WINNER,PLAYER
	CALL PERFORM,V?ASK-ABOUT,PER,PRSI
	RTRUE
?L26:	EQUAL? PRSA,V?WAIT /?L28
	EQUAL? PRSA,V?WAIT-FOR \?L27
	EQUAL? PRSO,PLAYER \?L27
?L28:	SET 'WINNER,PLAYER
	CALL PERFORM,V?$0024CALL,PER
	RTRUE
?L27:	EQUAL? PRSA,V?WHAT \FALSE
	SET 'WINNER,PLAYER
	CALL PERFORM,V?ASK-ABOUT,PER,PRSO
	RTRUE

	.FUNCT DESCRIBE-PERSON,PERSON?1,STR=0
	PRINTD PERSON?1
	PRINTI " is "
	ZERO? STR \?L3
	PUSH STR?128
	JUMP ?L5
?L3:	PUSH STR
?L5:	PRINT STACK
	PRINTR "."

	.FUNCT DISCRETION,P1,P2,P3=0,?TMP
	SET '?TMP,HERE
	CALL META-LOC,P2 >STACK
	EQUAL? ?TMP,STACK \?L1
	ZERO? P3 /?L1
	SET '?TMP,HERE
	CALL META-LOC,P3 >STACK
	EQUAL? ?TMP,STACK \?L1
	PRINTD P1
	PRINTI " looks briefly toward "
	PRINTD P2
	PRINTI " and "
	PRINTD P3
	PRINTR " and then speaks in a whisper."
?L1:	SET '?TMP,HERE
	CALL META-LOC,P2 >STACK
	EQUAL? ?TMP,STACK \?L5
	PRINTD P1
	PRINTI " looks briefly toward "
	PRINTD P2
	PRINTR " and then speaks in a whisper."
?L5:	ZERO? P3 /FALSE
	SET '?TMP,HERE
	CALL META-LOC,P3 >STACK
	EQUAL? ?TMP,STACK \FALSE
	PRINTD P1
	PRINTI " looks briefly toward "
	PRINTD P3
	PRINTR " and then speaks in a whisper."

	.FUNCT INHABITED?,RM
	CALL POPULATION,RM >STACK
	ZERO? STACK \TRUE
	RFALSE

	.FUNCT POPULATION,RM,PR=0,CNT=0,OBJ
	FIRST? RM >OBJ /?L1
	RETURN CNT
?L1:	FSET? OBJ,PERSON \?L6
	FSET? OBJ,INVISIBLE /?L6
	INC 'CNT
	ZERO? PR /?L11
	CALL DESCRIBE-PERSON,OBJ,STR?129
	JUMP ?L11
?L6:	FSET? OBJ,CONTBIT \?L11
	CALL POPULATION,OBJ,PR >STACK
	ADD CNT,STACK >CNT
?L11:	NEXT? OBJ >OBJ /?L1
	RETURN CNT

	.FUNCT RANDOM-SHOES-F,OBJ
	CALL PRINT-ID,STR?130
	SET 'OBJ,PRSO
	ZERO? OBJ /?L4
	EQUAL? PRSA,V?TAKE,V?GIVE /?L3
?L4:	SET 'OBJ,PRSI
	ZERO? OBJ /?L1
	EQUAL? PRSA,V?SGIVE,V?SEARCH-OBJECT-FOR,V?ASK-FOR \?L1
?L3:	EQUAL? OBJ,PHONG-SHOES \?L5
	CALL PHONG-FIGHTS >STACK
	RSTACK
?L5:	EQUAL? OBJ,MONICA-SHOES \?L7
	ZERO? MONICA-TIED-TO \?L8
	CALL MONICA-PUSHES >STACK
	RSTACK
?L8:	PRINTR "Monica writhes away from your touch and manages to kick you in the shin."
?L7:	EQUAL? OBJ,STILES-SHOES \?L13
	PRINTR """Please don't take them! I'm cold enough as it is!"""
?L13:	EQUAL? OBJ,LINDER-SHOES \FALSE
	LOC LINDER >STACK
	ZERO? STACK /?L17
	PRINTR """I'm beginning to wonder if I got a decent detective or not!"""
?L17:	CALL TANDY? >STACK
	ZERO? STACK /?L21
	PRINTR "You can't be that desperate!"
?L21:	PRINTR "Necrophilia went out with raccoon coats!"
?L1:	EQUAL? PRSA,V?PUT,V?COMPARE \?L28
	EQUAL? PRSO,BACK-FOOTPRINTS-CAST,BACK-FOOTPRINTS,SIDE-FOOTPRINTS-CAST /?L30
	EQUAL? PRSO,SIDE-FOOTPRINTS /?L30
	EQUAL? PRSI,BACK-FOOTPRINTS-CAST /?L30
	EQUAL? PRSI,BACK-FOOTPRINTS,SIDE-FOOTPRINTS-CAST,SIDE-FOOTPRINTS \?L28
?L30:	PRINTI "The shoes don't seem to match "
	PRINTI "the foot prints that you found in the "
	PRINTR "yard."
?L28:	EQUAL? PRSA,V?EXAMINE \FALSE
	EQUAL? PRSO,LINDER-SHOES,PHONG-SHOES \?L34
	PRINTR "They're straw slippers with thongs, clean and obviously comfortable."
?L34:	EQUAL? PRSO,STILES-SHOES \?L38
	PRINTR "They're pointed wing tips with sensational welt features, but a bit shabby and more than a bit muddy."
?L38:	EQUAL? PRSO,MONICA-SHOES \FALSE
	PRINTR "They're tan pumps with Cuban heels, clean and stylish."

	.FUNCT DIR-PRINT,DIR,CNT=0
?L1:	GET DIR-STRINGS,CNT >STACK
	EQUAL? STACK,DIR \?L3
	PRINTI "the "
	ADD CNT,1 >STACK
	GET DIR-STRINGS,STACK >STACK
	PRINT STACK
	RTRUE
?L3:	INC 'CNT
	JUMP ?L1

	.FUNCT GLOBAL-ROOM-F,TIM,VAL
	EQUAL? PRSA,V?KNOCK \?L1
	PRINTR "Knocking on the walls reveals nothing unusual."
?L1:	EQUAL? PRSA,V?EXAMINE,V?SEARCH \FALSE
	GETP HERE,P?LINE >STACK
	EQUAL? STACK,OUTSIDE-LINE-C \?L6
	SET 'TIM,10
	JUMP ?L9
?L6:	GETP HERE,P?CORRIDOR >STACK
	ZERO? STACK /?L8
	SET 'TIM,3
	JUMP ?L9
?L8:	GETP HERE,P?SIZE >STACK
	ADD 2,STACK >TIM
?L9:	PRINTI "(You'd do better to examine or search one thing at a time. Searching a whole room or area thoroughly would take hours. A cursory search would take about "
	PRINTN TIM
	PRINTI " minutes, and it might not reveal much. Would you like to do it anyway?)"
	CALL YES? >STACK
	ZERO? STACK /?L12
	CALL INT-WAIT,TIM >VAL
	EQUAL? M-FATAL,VAL /TRUE
	ZERO? VAL /?L16
	PRINTR "Your cursory search revealed nothing new."
?L16:	PRINTR "You didn't get a chance to finish looking over the place."
?L12:	PRINTR "Okeh."

	.FUNCT WINDOW-F,RM,POP
	CALL WINDOW-ROOM,HERE,PRSO >RM
	EQUAL? PRSA,V?BRUSH \?L1
	PRINTI "The window is clean enough without your interference."
	CRLF
	CALL PRINT-ID,STR?131 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L5
	PRINTI "The window is a simple wooden sash, locked tight against the cold."
	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK \?L8
	PRINTI " There's some sort of electric relay on one edge, with white wires attached."
?L8:	CRLF
	RTRUE
?L5:	EQUAL? PRSA,V?LOOK-OUTSIDE,V?LOOK-INSIDE \?L13
	ZERO? RM /?L14
	PRINTI "The window is damp and foggy, but you can see"
	CALL POPULATION,RM >POP
	ZERO? POP /?L23
	EQUAL? POP,1 \?L20
	PRINTI " someone in"
	JUMP ?L23
?L20:	PRINTI " some people in"
?L23:	CALL THE?,RM
	PRINTI " "
	PRINTD RM
	PRINTI " "
	GETP HERE,P?LINE >STACK
	EQUAL? STACK,OUTSIDE-LINE-C \?L28
	PUSH STR?21
	JUMP ?L30
?L28:	PUSH STR?132
?L30:	PRINT STACK
	PRINTR "side."
?L14:	PRINTR "The window is too foggy to see through."
?L13:	EQUAL? PRSA,V?KNOCK \?L34
	CALL WINDOW-KNOCK,RM >STACK
	ZERO? STACK \FALSE
	PRINTR "There's no answer."
?L34:	EQUAL? PRSA,V?MUNG \?L40
	PRINTI "Vandalism is for private "
	CALL PRINT-ID,STR?133
	CALL TANDY? >STACK
	ZERO? STACK /?L43
	PRINTI "eye"
	JUMP ?L47
?L43:	PRINTI "dick"
?L47:	PRINTR "s, not famous police detectives!"
?L40:	EQUAL? PRSA,V?UNLOCK /?L53
	EQUAL? PRSA,V?LOCK,V?CLOSE,V?OPEN \FALSE
?L53:	FSET? PRSO,RMUNGBIT \?L54
	PRINTI "It's really broken. "
?L54:	PRINTR "You can't."

	.FUNCT GENERIC-WINDOW-F,OBJ
	CALL WINDOW-IN?,HERE >STACK
	ZERO? STACK \FALSE
	EQUAL? PRSA,V?WHAT,V?TELL-ME /?L4
	EQUAL? PRSA,V?FIND,V?ASK-CONTEXT-ABOUT,V?ASK-ABOUT \?L3
?L4:	RETURN WINDOW
?L3:	SET 'P-WON,0
	PRINTI "(You can't see any "
	PRINTI "window"
	PRINTI " here!)"
	CRLF
	RETURN NOT-HERE-OBJECT

	.FUNCT WINDOW-KNOCK,RM
	CALL INHABITED?,RM >STACK
	ZERO? STACK /FALSE
	PRINTR "Someone looks up at you inquisitively."

	.FUNCT WINDOW-IN?,RM
	EQUAL? RM,FRONT-YARD,KITCHEN,BUTLER-ROOM /TRUE
	EQUAL? RM,OFFICE-PORCH,OFFICE,BACK-YARD /TRUE
	EQUAL? RM,MONICA-ROOM,ROCK-GARDEN,LINDER-ROOM /TRUE
	EQUAL? RM,TUB-ROOM /TRUE
	RFALSE

	.FUNCT TOILET-F,RARG=100
	EQUAL? RARG,100 \FALSE
	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \FALSE
	PRINTR "You have stooped to a new low by snooping around toilet bowls."

	.FUNCT GENERIC-BATH-DOOR-F,OBJ
	EQUAL? HERE,MONICA-ROOM \?L1
	RETURN MONICA-BATH-DOOR
?L1:	EQUAL? HERE,LINDER-ROOM \?L3
	RETURN LINDER-BATH-DOOR
?L3:	EQUAL? HERE,BUTLER-ROOM,BUTLER-BATH \?L4
	RETURN BUTLER-BATH-DOOR
?L4:	EQUAL? PRSA,V?WHAT,V?TELL-ME /?L6
	EQUAL? PRSA,V?FIND,V?ASK-CONTEXT-ABOUT,V?ASK-ABOUT \?L5
?L6:	RETURN GENERIC-BATHROOM-DOOR
?L5:	SET 'P-WON,0
	PRINTI "(You can't see any "
	PRINTI "bathroom door"
	PRINTI " here!)"
	CRLF
	RETURN NOT-HERE-OBJECT

	.FUNCT GENERIC-BEDROOM-F,OBJ
	EQUAL? OBJ,HERE,GLOBAL-HERE \?L1
	RETURN GLOBAL-ROOM
?L1:	EQUAL? PRSA,V?WHAT,V?TELL-ME /?L4
	EQUAL? PRSA,V?FIND,V?ASK-CONTEXT-ABOUT,V?ASK-ABOUT \?L3
?L4:	RETURN GENERIC-BEDROOM
?L3:	SET 'P-WON,0
	PRINTI "(You can't see any "
	PRINTI "bedroom"
	PRINTI " here!)"
	CRLF
	RETURN NOT-HERE-OBJECT

	.FUNCT GENERIC-BEDROOM-DOOR-F,OBJ
	EQUAL? HERE,MONICA-ROOM,HALL-2 \?L1
	RETURN MONICA-DOOR
?L1:	EQUAL? HERE,LINDER-ROOM,LIVING-ROOM \?L3
	RETURN LINDER-DOOR
?L3:	EQUAL? PRSA,V?WHAT,V?TELL-ME /?L5
	EQUAL? PRSA,V?FIND,V?ASK-CONTEXT-ABOUT,V?ASK-ABOUT \?L4
?L5:	RETURN GENERIC-BEDROOM-DOOR
?L4:	SET 'P-WON,0
	PRINTI "(You can't see any "
	PRINTI "bedroom door"
	PRINTI " here!)"
	CRLF
	RETURN NOT-HERE-OBJECT

	.FUNCT GENERIC-BACK-DOOR-F,OBJ
	EQUAL? PRSA,V?SHOOT \?L1
	FSET? P-IT-OBJECT,DOORBIT \?L1
	FSET? P-IT-OBJECT,LOCKED \?L1
	RETURN P-IT-OBJECT
?L1:	EQUAL? HERE,OFFICE-PORCH,OFFICE \?L3
	RETURN OFFICE-BACK-DOOR
?L3:	EQUAL? HERE,BACK-YARD,MONICA-ROOM \?L4
	RETURN MONICA-BACK-DOOR
?L4:	EQUAL? HERE,ROCK-GARDEN,LINDER-ROOM \?L5
	RETURN LINDER-BACK-DOOR
?L5:	EQUAL? PRSA,V?WHAT,V?TELL-ME /?L7
	EQUAL? PRSA,V?FIND,V?ASK-CONTEXT-ABOUT,V?ASK-ABOUT \?L6
?L7:	RETURN GENERIC-BACK-DOOR
?L6:	SET 'P-WON,0
	PRINTI "(You can't see any "
	PRINTI "back door"
	PRINTI " here!)"
	CRLF
	RETURN NOT-HERE-OBJECT

	.FUNCT GENERIC-BATHROOM-F,OBJ
	EQUAL? OBJ,HERE,GLOBAL-HERE \?L1
	RETURN GLOBAL-ROOM
?L1:	EQUAL? PRSA,V?WHAT,V?TELL-ME /?L4
	EQUAL? PRSA,V?FIND,V?ASK-CONTEXT-ABOUT,V?ASK-ABOUT \?L3
?L4:	RETURN GENERIC-BATHROOM
?L3:	SET 'P-WON,0
	PRINTI "(You can't see any "
	PRINTI "bathroom"
	PRINTI " here!)"
	CRLF
	RETURN NOT-HERE-OBJECT

	.FUNCT NULL-F,A1,A2
	RFALSE

	.FUNCT DDESC,STR1,DOOR,STR2
	PRINT STR1
	FSET? DOOR,OPENBIT \?L3
	PRINTI "open"
	JUMP ?L7
?L3:	PRINTI "closed"
?L7:	PRINT STR2
	CRLF
	RTRUE

	.FUNCT DOOR-ROOM,RM,DR,P=0,TBL
?L1:	NEXTP RM,P >P
	ZERO? P /FALSE
	LESS? P,P?OUT /FALSE
	GETPT RM,P >TBL
	PTSIZE TBL >STACK
	EQUAL? DEXIT,STACK \?L1
	GETB TBL,DEXITOBJ >STACK
	EQUAL? DR,STACK \?L1
	GETB TBL,REXIT >STACK
	RSTACK

	.FUNCT FIND-FLAG,RM,FLAG,EXCLUDED=0,O
	FIRST? RM >O \FALSE
?L4:	FSET? O,FLAG \?L6
	EQUAL? O,EXCLUDED /?L6
	RETURN O
?L6:	NEXT? O >O /?L4
	RFALSE

	.FUNCT GLOBAL-HERE-F,FLG=0,F,HR
	EQUAL? PRSA,V?ASK-ABOUT,V?WHAT \FALSE
	FIRST? HERE >F \?L5
?L6:	FSET? F,CONTBIT \?L8
	CALL INHABITED?,F >STACK
	ZERO? STACK /?L8
	SET 'FLG,1
	SET 'HR,HERE
	SET 'HERE,F
	CALL GLOBAL-HERE-F
	SET 'HERE,HR
	JUMP ?L9
?L8:	FSET? F,PERSON \?L9
	EQUAL? F,PLAYER /?L9
	SET 'FLG,1
	CALL DESCRIBE-OBJECT,F,1,0
?L9:	NEXT? F >F /?L6
?L5:	ZERO? FLG \TRUE
	PRINTR "There's nobody else here."

	.FUNCT LOCKED-F,OBJ
	EQUAL? HERE,FRONT-YARD \?L1
	EQUAL? PRSA,V?THROUGH,V?SEARCH-OBJECT-FOR /?L5
	EQUAL? PRSA,V?SEARCH,V?LOOK-INSIDE,V?EXAMINE \?L3
?L5:	RETURN DINING-DOOR
?L3:	EQUAL? PRSA,V?WALK-TO \FALSE
	RETURN FRONT-DOOR
?L1:	EQUAL? PRSA,V?SHOOT \FALSE
	FSET? P-IT-OBJECT,DOORBIT \FALSE
	FSET? P-IT-OBJECT,LOCKED \FALSE
	RETURN P-IT-OBJECT

	.FUNCT META-LOC,OBJ
?L1:	LOC OBJ >STACK
	ZERO? STACK /FALSE
	LOC OBJ >STACK
	EQUAL? STACK,LOCAL-GLOBALS,GLOBAL-OBJECTS \?L6
	LOC OBJ >STACK
	RSTACK
?L6:	IN? OBJ,ROOMS \?L9
	RETURN OBJ
?L9:	LOC OBJ >OBJ
	JUMP ?L1

	.FUNCT OUTSIDE?,RM
	EQUAL? RM,GARAGE /TRUE
	GETP RM,P?LINE >STACK
	EQUAL? STACK,OUTSIDE-LINE-C /TRUE
	RFALSE

	.FUNCT PHONE-IN?,RM
	EQUAL? RM,LIVING-ROOM,OFFICE,MONICA-ROOM \FALSE
	RTRUE

	.FUNCT WINDOW-ROOM,RM,WINDOW?1,P=0,L
	EQUAL? RM,FRONT-YARD \?L1
	EQUAL? WINDOW?1,KITCHEN-WINDOW \?L3
	RETURN KITCHEN
?L3:	EQUAL? WINDOW?1,BUTLER-WINDOW \FALSE
	RETURN BUTLER-ROOM
?L1:	EQUAL? RM,KITCHEN,BUTLER-ROOM \?L7
	RETURN FRONT-YARD
?L7:	EQUAL? RM,OFFICE-PORCH \?L8
	RETURN OFFICE
?L8:	EQUAL? RM,OFFICE \?L9
	RETURN OFFICE-PORCH
?L9:	EQUAL? RM,BACK-YARD \?L10
	RETURN MONICA-ROOM
?L10:	EQUAL? RM,MONICA-ROOM \?L11
	RETURN BACK-YARD
?L11:	EQUAL? RM,ROCK-GARDEN \?L12
	EQUAL? WINDOW?1,LINDER-WINDOW \?L13
	RETURN LINDER-ROOM
?L13:	EQUAL? WINDOW?1,BATH-WINDOW \FALSE
	RETURN TUB-ROOM
?L12:	EQUAL? RM,LINDER-ROOM,TUB-ROOM \FALSE
	RETURN ROCK-GARDEN

	.FUNCT GROUND-SURFACE
	EQUAL? HERE,FRONT-YARD,ROCK-GARDEN \?L1
	RETURN STR?134
?L1:	EQUAL? HERE,DRIVEWAY,DRIVEWAY-ENTRANCE \?L3
	RETURN STR?135
?L3:	EQUAL? HERE,FRONT-PORCH,OFFICE-PORCH \?L4
	RETURN STR?136
?L4:	EQUAL? HERE,BACK-YARD \?L5
	RETURN STR?137
?L5:	ZERO? GROUND-MUDDY /?L6
	RETURN STR?138
?L6:	RETURN STR?139

	.FUNCT FRONT-PORCH-F,RARG=0
	EQUAL? RARG,M-LOOK \FALSE
	CALL DDESC,STR?141,FRONT-DOOR,STR?140
	CALL DDESC,STR?143,FRONT-GATE,STR?142
	CALL THIS-IS-IT,DOORBELL >STACK
	RSTACK

	.FUNCT DOORBELL-F
	EQUAL? PRSA,V?RING,V?PUSH \FALSE
	ZERO? WELCOMED \?L3
	FSET? CORPSE,INVISIBLE \?L3
	CALL WELCOME
	RTRUE
?L3:	CALL YOU-RANG
	PRINTR "The door bell rings, loud and clear."

	.FUNCT DRIVEWAY-F,ARG=0
	EQUAL? PRSA,V?FOLLOW,V?CLIMB-UP \FALSE
	EQUAL? PRSO,DRIVEWAY-OBJECT \FALSE
	EQUAL? HERE,DRIVEWAY-ENTRANCE \?L3
	CALL PERFORM,V?WALK,P?NORTH
	RTRUE
?L3:	EQUAL? HERE,GARAGE,SIDE-YARD \?L5
	CALL PERFORM,V?WALK,P?WEST
	RTRUE
?L5:	PRINTR "It's not clear which direction you mean."

	.FUNCT SIDE-YARD-F,RARG=0
	EQUAL? RARG,M-LOOK \?L1
	PRINTR "This is a little-used side yard, hidden from the street by the fence. The back yard lies to the east and the driveway to the west."
?L1:	EQUAL? RARG,M-FLASH \?L5
	FSET? SIDE-FOOTPRINTS,INVISIBLE /FALSE
	FSET? SIDE-FOOTPRINTS,TOUCHBIT /FALSE
	CALL DESCRIBE-OBJECT,SIDE-FOOTPRINTS,1,0
	FSET SIDE-FOOTPRINTS,TOUCHBIT
	RTRUE
?L5:	EQUAL? RARG,M-BEG \FALSE
	EQUAL? HERE,SIDE-YARD \FALSE
	ZERO? GROUND-MUDDY /FALSE
	EQUAL? PRSA,V?FOLLOW,V?WALK \FALSE
	SET 'SIDE-FOOTPRINTS-CONFUSED,1
	RFALSE

	.FUNCT SIDE-FOOTPRINTS-F,ARG=0
	EQUAL? ARG,M-OBJDESC \?L1
	ZERO? SIDE-FOOTPRINTS-CONFUSED /?L3
	FSET? SIDE-FOOTPRINTS,TOUCHBIT \?L5
	PRINTR "Fresh foot prints go here and there in the yard."
?L5:	FSET SIDE-FOOTPRINTS,TOUCHBIT
	PRINTR "You notice fresh foot prints going here and there in the yard."
?L3:	FSET? SIDE-FOOTPRINTS,TOUCHBIT \?L13
	PRINTR "A fresh row of foot prints goes from the back yard to the driveway."
?L13:	FSET SIDE-FOOTPRINTS,TOUCHBIT
	PRINTR "You notice a fresh row of foot prints going from the back yard to the driveway."
?L1:	ZERO? SIDE-FOOTPRINTS-CONFUSED /?L20
	EQUAL? PRSA,V?EXAMINE,V?ANALYZE \?L20
	PRINTR "There are too many foot prints here now."
?L20:	EQUAL? PRSA,V?EXAMINE \?L23
	PRINTR "The prints are lined up in an even row, as if made by a careful walker."
?L23:	EQUAL? PRSA,V?ANALYZE \?L26
	LOC SIDE-FOOTPRINTS-CAST >STACK
	EQUAL? STACK,LIMBO /?L27
	PRINTR "You already did that!"
?L27:	ZERO? FINGERPRINT-OBJ \?L32
	ZERO? DUFFY-AT-CORONER /?L31
?L32:	CALL DO-FINGERPRINT
	RTRUE
?L31:	MOVE SIDE-FOOTPRINTS-CAST,PLAYER
	CALL ANAFOOT >STACK
	RSTACK
?L26:	EQUAL? PRSA,V?FOLLOW \?L34
	EQUAL? HERE,DRIVEWAY-ENTRANCE \?L35
	CALL GOTO,SIDE-YARD
	RTRUE
?L35:	EQUAL? HERE,SIDE-YARD,OFFICE-PATH \TRUE
	CALL GOTO,DRIVEWAY-ENTRANCE
	RTRUE
?L34:	EQUAL? PRSA,V?MAKE \FALSE
	EQUAL? PRSO,BACK-FOOTPRINTS-CAST,SIDE-FOOTPRINTS-CAST,GENERIC-CAST \FALSE
	CALL PERFORM,V?ANALYZE,SIDE-FOOTPRINTS
	RTRUE

	.FUNCT SIDE-FOOTPRINTS-CAST-F
	EQUAL? PRSA,V?COMPARE \FALSE
	EQUAL? PRSO,BACK-FOOTPRINTS-CAST,BACK-FOOTPRINTS /?L3
	EQUAL? PRSI,BACK-FOOTPRINTS-CAST,BACK-FOOTPRINTS \FALSE
?L3:	PRINTR "The two sets of foot prints don't seem to match up."

	.FUNCT ANAFOOT
	PRINTR "Sgt. Duffy appears with his kit for casting with plaster of Paris. He quickly makes a cast of the foot prints and hands it to you, saying ""I hope you find this as useful as it is heavy."""

	.FUNCT OFFICE-PORCH-F,RARG=0
	EQUAL? RARG,M-LOOK \?L1
	PRINTR "You are standing on a small concrete slab outside Linder's office. A sign between the door and the window reads ""PACIFIC TRADE ASSOCIATES"". To the north is a tidy lawn, extending east to the edge of the woods. A path of stepping stones leads south to the back gate."
?L1:	EQUAL? RARG,M-FLASH \FALSE
	FSET? BACK-FOOTPRINTS,INVISIBLE /FALSE
	FSET? BACK-FOOTPRINTS,TOUCHBIT /FALSE
	CALL DESCRIBE-OBJECT,BACK-FOOTPRINTS,1,0
	FSET BACK-FOOTPRINTS,TOUCHBIT
	RTRUE

	.FUNCT BACK-FOOTPRINTS-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "The prints are uneven and widely spaced, as if made by someone running."
?L1:	EQUAL? PRSA,V?ANALYZE \?L5
	LOC BACK-FOOTPRINTS-CAST >STACK
	EQUAL? STACK,LIMBO /?L6
	PRINTR "You already did that!"
?L6:	ZERO? FINGERPRINT-OBJ \?L11
	ZERO? DUFFY-AT-CORONER /?L10
?L11:	CALL DO-FINGERPRINT
	RTRUE
?L10:	MOVE BACK-FOOTPRINTS-CAST,PLAYER
	CALL ANAFOOT >STACK
	RSTACK
?L5:	EQUAL? PRSA,V?FOLLOW \?L13
	PRINTI "You would probably get lost in the woods."
	PRINTR " Even with a path to follow."
?L13:	EQUAL? PRSA,V?MAKE \FALSE
	EQUAL? PRSO,BACK-FOOTPRINTS-CAST,SIDE-FOOTPRINTS-CAST,GENERIC-CAST \FALSE
	CALL PERFORM,V?ANALYZE,BACK-FOOTPRINTS
	RTRUE

	.FUNCT GENERIC-FOOTPRINTS-F,OBJ
	EQUAL? HERE,OFFICE-PORCH \?L1
	RETURN BACK-FOOTPRINTS
?L1:	EQUAL? HERE,SIDE-YARD \?L3
	RETURN SIDE-FOOTPRINTS
?L3:	SET 'P-WON,0
	PRINTI "(You can't see any "
	PRINTI "foot prints"
	PRINTI " here!)"
	CRLF
	RETURN NOT-HERE-OBJECT

	.FUNCT GENERIC-CAST-F,OBJ
	EQUAL? PRSA,V?WHAT,V?TELL-ME /?L3
	EQUAL? PRSA,V?FIND,V?ASK-CONTEXT-ABOUT,V?ASK-ABOUT \?L1
?L3:	RETURN GENERIC-CAST
?L1:	EQUAL? PRSA,V?MAKE \FALSE
	RETURN GENERIC-CAST

	.FUNCT OFFICE-WINDOW-F,RM
	CALL WINDOW-ROOM,HERE,PRSO >RM
	EQUAL? PRSA,V?EXAMINE \?L1
	CALL WINDOW-F
	FSET? OFFICE-WINDOW,RMUNGBIT \?L3
	PRINTI "All the panes of the window are cracked, and many are in pieces on the "
	PRINTI "floor."
	EQUAL? HERE,OFFICE \?L18
	FSET? PIECE-OF-PUTTY,TOUCHBIT /?L13
	PRINTI " A chunk of putty dangles like a wax bean."
?L13:	FSET? PIECE-OF-WIRE,TOUCHBIT /?L18
	PRINTI " Along one edge of the window you can see the end of a piece of green wire."
?L18:	CRLF
	RTRUE
?L3:	EQUAL? HERE,OFFICE \TRUE
	FSET? PIECE-OF-WIRE,TOUCHBIT /TRUE
	PRINTR "There's also a piece of green wire running from the frame to the putty."
?L1:	CALL GO-AWAY >STACK
	ZERO? STACK \TRUE
	EQUAL? PRSA,V?LOOK-OUTSIDE,V?LOOK-INSIDE \?L29
	ZERO? RM /?L29
	FSET? OFFICE-WINDOW,RMUNGBIT \?L29
	PRINTI "Through the broken window you can see"
	CALL THE?,RM
	PRINTI " "
	PRINTD RM
	PRINTI " "
	GETP HERE,P?LINE >STACK
	EQUAL? STACK,OUTSIDE-LINE-C \?L34
	PUSH STR?21
	JUMP ?L36
?L34:	PUSH STR?132
?L36:	PRINT STACK
	PRINTR "side."
?L29:	EQUAL? PRSA,V?THROUGH \?L37
	ZERO? RM /?L37
	FSET? OFFICE-WINDOW,RMUNGBIT \?L37
	PRINTI "You would probably cut yourself on the broken glass."
	CRLF
	CALL PRINT-ID,STR?144 >STACK
	RSTACK
?L37:	EQUAL? PRSO,OFFICE-WINDOW \?L40
	CALL PERFORM,PRSA,WINDOW,PRSI
	RTRUE
?L40:	EQUAL? PRSI,OFFICE-WINDOW \FALSE
	CALL PERFORM,PRSA,PRSO,WINDOW
	RTRUE

	.FUNCT GO-AWAY
	EQUAL? PRSA,V?KNOCK \FALSE
	CALL META-LOC,LINDER >STACK
	EQUAL? STACK,OFFICE \FALSE
	IN? PLAYER,OFFICE /FALSE
	PRINTI "Someone peeks through the window at you, then disappears and"
	PRINTR " shouts ""Go away!"""

	.FUNCT PIECE-OF-WIRE-F
	EQUAL? PRSA,V?FOLLOW \?L1
	FSET? PRSO,TOUCHBIT /?L1
	PRINTR "The wire goes into the window frame and disappears."
?L1:	EQUAL? PRSA,V?TAKE \FALSE
	ZERO? SHOT-FIRED \FALSE
	PRINTI "You can't."
	PRINTR " It's stuck tight."

	.FUNCT PIECE-OF-PUTTY-F
	EQUAL? PRSA,V?TAKE \FALSE
	ZERO? SHOT-FIRED \FALSE
	PRINTI "You can't."
	PRINTR " It's stuck tight."

	.FUNCT OFFICE-BACK-DOOR-F
	CALL GO-AWAY >STACK
	ZERO? STACK \TRUE
	EQUAL? PRSA,V?SGIVE,V?GIVE \FALSE
	EQUAL? PRSO,THREAT-NOTE /?L4
	EQUAL? PRSI,THREAT-NOTE \FALSE
?L4:	LOC LINDER >STACK
	ZERO? STACK /?L5
	CALL PERFORM,V?GIVE,THREAT-NOTE,LINDER
	RTRUE
?L5:	PRINTR "It's too late to give Linder anything."

	.FUNCT LAWN-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "The lawn is well manicured."

	.FUNCT MONICA-ROOM-F,RARG=0
	EQUAL? RARG,M-ENTER \?L1
	CALL I-PROMPT-2 >STACK
	RSTACK
?L1:	EQUAL? RARG,M-LOOK \FALSE
	PRINTR "On one side is a modern-style bed, with piles of well-thumbed detective stories stacked on the table beside it. Opposite the bed is a long dressing table that seems to serve also as desk and workbench. In the corner sits a small table for a portable phonograph and records, and a book case with more books and pulps. Movie posters cover the walls. A handsome door with cedar veneer leads north, and a door and window face outside."

	.FUNCT MONICA-TABLE-F
	EQUAL? PRSA,V?SEARCH /?L3
	EQUAL? PRSA,V?LOOK-ON,V?LOOK-INSIDE,V?EXAMINE \FALSE
?L3:	IN? MEDICAL-REPORT,MONICA-ROOM \?L4
	EQUAL? P-ADVERB,W?CAREFULLY \?L4
	FCLEAR TUMOR,INVISIBLE
	FCLEAR MEDICAL-REPORT,INVISIBLE
	CALL THIS-IS-IT,MEDICAL-REPORT
	PRINTR "Among make-up, letters, and tools, you find a medical report."
?L4:	PRINTR "This table is pretty messy. Anyone but Monica would have a tough time finding anything on it."

	.FUNCT CAN-HEAR-RECORD?
	ZERO? TUNE-ON /FALSE
	EQUAL? PRSO,MONICA-DOOR \?L4
	EQUAL? HERE,HALL-2 /TRUE
?L4:	EQUAL? PRSO,MONICA-BATH-DOOR \?L5
	EQUAL? HERE,BATHROOM /TRUE
?L5:	EQUAL? PRSO,MONICA-BACK-DOOR \FALSE
	EQUAL? HERE,BACK-YARD /TRUE
	RFALSE

	.FUNCT RECORDS-F,TUNE
	EQUAL? PRSA,V?LISTEN,V?PLAY \?L1
	PRINTI "You pick a record at random and start it playing. It's """
?L5:	CALL PICK-ONE,SONG-TABLE >TUNE
	ZERO? TUNE-ON /?L6
	EQUAL? TUNE,TUNE-ON /?L5
?L6:	SET 'TUNE-ON,TUNE
	PRINT TUNE-ON
	PRINTI "."""
	CRLF
	CALL QUEUE,I-TUNE-OFF,4 >STACK
	PUT STACK,0,1
	RTRUE
?L1:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "It's a large and varied record collection. Monica's not very choosy about her music."

	.FUNCT I-TUNE-OFF,TBL
	EQUAL? HERE,MONICA-ROOM \?L1
	PRINTI "The record is over, and not too soon."
	CRLF
	IN? MONICA,HERE \TRUE
	ZERO? MONICA-TIED-TO \TRUE
	PRINTI "Monica walks over to the phonograph and puts the record away. Then she chooses another one and starts it up. It's """
	CALL PICK-ONE,SONG-TABLE >TUNE-ON
	PRINT TUNE-ON
	PRINTI "."""
	CRLF
	CALL QUEUE,I-TUNE-OFF,4 >STACK
	PUT STACK,0,1
	RTRUE
?L1:	IN? MONICA,MONICA-ROOM \FALSE
	ZERO? MONICA-TIED-TO \FALSE
	CALL PICK-ONE,SONG-TABLE >TUNE-ON
	CALL QUEUE,I-TUNE-OFF,4 >STACK
	PUT STACK,0,1
	RFALSE

	.FUNCT MASTER-BATH-COUNTER-F
	EQUAL? PRSA,V?LOOK-INSIDE,V?EXAMINE \FALSE
	PRINTR "On the counter are a shaver, tooth paste, and so on."

	.FUNCT SHOWER-F
	GET P-PRSO,0 >STACK
	EQUAL? 1,STACK \FALSE
	EQUAL? PRSA,V?THROUGH,V?TAKE \FALSE
	PRINTR "Anyone can see that you really need a shower. In fact, this is one of your better ideas so far on this case. But your clothes would get awful wet, and you must have better things to do."

	.FUNCT LINDER-ROOM-F,ARG=0
	EQUAL? ARG,M-ENTER \?L1
	CALL I-PROMPT-2 >STACK
	RSTACK
?L1:	EQUAL? ARG,M-LOOK \FALSE
	PRINTI "The bedroom is elegant but not tidy. A four-poster bed, chair and dresser, made of teak and mahogany, look hand-crafted. There are doors on the west and south walls, and a door and window to the east look outside. Clothes and newspapers are scattered about. It seems that Linder misse"
	FSET? CORPSE,INVISIBLE \?L6
	PUSH STR?145
	JUMP ?L8
?L6:	PUSH STR?146
?L8:	PRINT STACK
	PRINTR " the woman's touch."

	.FUNCT MASTER-BEDROOM-DRESSER-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "The dresser is a beautiful piece of cabinetry."
?L1:	EQUAL? PRSA,V?OPEN,V?SEARCH,V?LOOK-INSIDE \FALSE
	PRINTR "You open all the drawers and find only shirts, socks, underwear, hankies, and so on. What a disappointment."

	.FUNCT LIVING-ROOM-F,RARG=0
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "A huge fieldstone fireplace on the south wall holds a blazing fire, filling the living room with warmth and light. Grouped in front of the fire are a glass-topped coffee table and a rattan davenport and club chair, with cushions covered in a print showing bamboo plants in the style of Japanese brush-painting. A lamp with a printed shade and a telephone sit on the table."
	CRLF
	PRINTI "On the north wall are a liquor cabinet and a console radio made of light-colored wood. "
	ZERO? RADIO-ON /?L7
	PRINTI "The radio is playing. "
?L7:	CALL DDESC,STR?148,LINDER-DOOR,STR?147 >STACK
	RSTACK

	.FUNCT CAN-HEAR-RADIO?
	ZERO? RADIO-ON /FALSE
	EQUAL? PRSO,DINING-DOOR \?L4
	EQUAL? HERE,FRONT-YARD /TRUE
?L4:	EQUAL? PRSO,FRONT-DOOR \?L5
	EQUAL? HERE,FRONT-PORCH /TRUE
?L5:	EQUAL? PRSO,LIVING-DINING-DOOR \?L6
	EQUAL? HERE,DINING-ROOM /TRUE
?L6:	EQUAL? PRSO,KITCHEN-HALL-DOOR,KITCHEN-DINING-DOOR \?L7
	EQUAL? HERE,KITCHEN /TRUE
?L7:	EQUAL? PRSO,LINDER-DOOR \FALSE
	EQUAL? HERE,LINDER-ROOM /TRUE
	RFALSE

	.FUNCT RADIO-F,ARG=0,PGM
	ZERO? RADIO-ON /?L1
	EQUAL? PRSA,V?LISTEN \?L1
	SUB PRESENT-TIME,480 >STACK
	DIV STACK,15 >STACK
	INC 'STACK
	GET RADIO-TABLE,STACK >PGM
	PRINTI "You can hardly avoid it. "
	EQUAL? PGM,RADIO-ON \?L5
	PRINTI "It's "
	JUMP ?L9
?L5:	PRINTI "You"
	PRINTI " spin the dial and find "
?L9:	SET 'RADIO-ON,PGM
	PRINT RADIO-ON
	PRINTR "."
?L1:	EQUAL? PRSA,V?LISTEN,V?PLAY,V?LAMP-ON \?L14
	ZERO? RADIO-ON /?L15
	PRINTI "It's already on. You"
	JUMP ?L19
?L15:	PRINTI "You turn on the radio,"
?L19:	SUB PRESENT-TIME,480 >STACK
	DIV STACK,15 >STACK
	INC 'STACK
	GET RADIO-TABLE,STACK >RADIO-ON
	PRINTI " spin the dial and find "
	PRINT RADIO-ON
	PRINTR "."
?L14:	EQUAL? PRSA,V?LAMP-OFF \?L24
	ZERO? RADIO-ON /?L25
	IN? MONICA,HERE \?L25
	PRINTI "Monica looks at you with disgust as you turn off the radio."
	CRLF
	CALL PRINT-ID,STR?149
	JUMP ?L29
?L25:	PRINTI "The radio is now off."
	CRLF
?L29:	SET 'RADIO-ON,0
	RTRUE
?L24:	EQUAL? PRSA,V?TURN-UP \?L32
	ZERO? RADIO-ON /?L33
	PRINTI "The radio is already pretty loud. Any louder would probably make the neighbors complain."
	CRLF
	CALL PRINT-ID,STR?150 >STACK
	RSTACK
?L33:	PRINTR "It's not on!"
?L32:	EQUAL? PRSA,V?TURN-DOWN \FALSE
	ZERO? RADIO-ON /?L41
	IN? MONICA,HERE \?L43
	ZERO? MONICA-TIED-TO \?L43
	PRINTR "Monica stops you from turning down the volume. She seems strangely interested in the radio program."
?L43:	PRINTR "You can't."
?L41:	PRINTR "It's not on!"

	.FUNCT SILVERWARE-F
	EQUAL? PRSA,V?TAKE \FALSE
	PRINTI "You could probably hock this stuff for a bundle, but you'd never get away with it, since the butler will no doubt count it again when you leave."
	CRLF
	CALL PRINT-ID,STR?151 >STACK
	RSTACK

	.FUNCT FOODS-F
	EQUAL? PRSA,V?TAKE,V?EAT \FALSE
	PRINTI "Your parents must have taught you better manners than that."
	CRLF
	CALL PRINT-ID,STR?152 >STACK
	RSTACK

	.FUNCT K-CLOCK-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "The time on the kitchen clock is "
	CALL TIME-PRINT,PRESENT-TIME
	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?LISTEN \FALSE
	PRINTR "The clock is humming electrically."

	.FUNCT APPLIANCE-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "It's as modern as yesterday, like everything in the kitchen."
?L1:	EQUAL? PRSA,V?USE,V?LAMP-ON,V?LAMP-OFF \FALSE
	PRINTI "The butler is probably very proud and jealous of these sparkling modern gadgets, and he wouldn't like you using them."
	CRLF
	CALL PRINT-ID,STR?153 >STACK
	RSTACK

	.FUNCT HALL-1-F,RARG
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "This is the north end of the central hallway. Just to the north, you can see warm yellow light in the living room."
	IN? MONICA,LIVING-ROOM \?L5
	IN? LINDER,LIVING-ROOM \?L5
	ZERO? LINDER-FOLLOWS-YOU \?L5
	PRINTI " You can hear voices talking excitedly."
?L5:	CRLF
	RTRUE

	.FUNCT HALL-2-F,RARG=0
	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "This is near the middle of the central hallway. At the north end, you can see the living room; to the east and west are bedroom doors. "
	FSET? MONICA-DOOR,OPENBIT \?L5
	FSET? BUTLER-DOOR,OPENBIT \?L7
	PRINTR "Both doors are open."
?L7:	PRINTR "The door to the east is open."
?L5:	FSET? BUTLER-DOOR,OPENBIT \?L14
	PRINTR "The door to the west is open."
?L14:	PRINTR "Both doors are closed."

	.FUNCT BUTLER-ROOM-F,RARG=0
	EQUAL? RARG,M-LOOK \FALSE
	CALL DDESC,STR?155,BUTLER-DOOR,STR?154
	CALL DDESC,STR?157,BUTLER-BATH-DOOR,STR?156 >STACK
	RSTACK

	.FUNCT BUTLER-BATH-F,RARG=0
	EQUAL? RARG,M-LOOK /?L3
	ZERO? RARG \FALSE
	EQUAL? PRSA,V?EXAMINE \FALSE
?L3:	CALL DDESC,STR?158,BUTLER-BATH-DOOR,STR?154 >STACK
	RSTACK

	.FUNCT ENTRY-F,RARG=0
	EQUAL? RARG,M-LOOK \FALSE
	CALL DDESC,STR?159,FRONT-DOOR,STR?154 >STACK
	RSTACK

	.FUNCT FLOWER-F
	EQUAL? PRSA,V?PICK \?L1
	PRINTI "What? And spoil the arrangement?!"
	CRLF
	CALL PRINT-ID,STR?160 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?SMELL \FALSE
	PRINTR "Someone chose these flowers for looks, not aroma."

	.FUNCT SCROLL-F
	EQUAL? PRSA,V?READ,V?EXAMINE \FALSE
	PRINTI "The scroll is written with a fine brush. Freely translated, it reads:

"
	GET 0,8 >STACK
	BOR STACK,2 >STACK
	PUT 0,8,STACK
	PRINTI "The WITNESS: An INTERLOGIC Mystery
        from Infocom, Inc.
          by Stu Galley
       based on an idea by
   Marc Blank and Dave Lebling
 Copyright (c) 1983 Infocom, Inc.
       All rights reserved.
      WITNESS and INTERLOGIC
  are trademarks of Infocom, Inc.
"
	CRLF
	GET 0,8 >STACK
	BAND STACK,-3 >STACK
	PUT 0,8,STACK
	RTRUE

	.FUNCT SHOE-PLATFORM-F
	EQUAL? PRSA,V?SEARCH,V?LOOK-INSIDE,V?EXAMINE \FALSE
	PRINTI "Several pairs of shoes are in a row, ready for inspection."
	IN? MUDDY-SHOES,SHOE-PLATFORM \?L5
	FSET? MUDDY-SHOES,INVISIBLE /?L5
	PRINTI " One pair of boots would not pass."
?L5:	CRLF
	RTRUE

	.FUNCT OTHER-SHOES-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "They're just ordinary shoes, nothing to get excited about."
?L1:	EQUAL? PRSA,V?TAKE \FALSE
	PRINTR "That wouldn't do you any good."

	.FUNCT FRONT-DOOR-F,VAL=0
	EQUAL? PRSA,V?KNOCK \?L1
	EQUAL? PRSO,FRONT-DOOR \?L3
	ZERO? WELCOMED \?L3
	FSET? CORPSE,INVISIBLE \?L3
	EQUAL? HERE,FRONT-PORCH \?L5
	CALL WELCOME >STACK
	RSTACK
?L5:	PRINTR "You can't reach the front door."
?L3:	CALL DOOR-ROOM,HERE,FRONT-DOOR >STACK
	CALL INHABITED?,STACK >STACK
	ZERO? STACK /?L10
	PRINTR "A muffled voice says, ""Come in!"""
?L10:	PRINTR "There is no answer at the door."
?L1:	EQUAL? PRSA,V?WALK-TO \FALSE
	EQUAL? HERE,DRIVEWAY-ENTRANCE,GARAGE \?L17
	SET 'VAL,1
	CALL GOTO,DRIVEWAY
?L17:	EQUAL? HERE,DRIVEWAY,FRONT-YARD \?L20
	SET 'VAL,1
	CALL GOTO,FRONT-PORCH
?L20:	RETURN VAL

	.FUNCT CLOSET-STUFF-F
	EQUAL? PRSA,V?USE,V?MOVE,V?TAKE \?L1
	PRINTR "You have no need for them."
?L1:	EQUAL? PRSA,V?EXAMINE,V?SEARCH,V?READ \FALSE
	PRINTI "You go through"
	CALL THE-PRSO-PRINT
	PRINTR " and find nothing of interest."

	.FUNCT OFFICE-F,RARG=0
	EQUAL? RARG,M-BEG \?L1
	ZERO? LINDER-FOLLOWS-YOU /?L1
	EQUAL? PRSO,LINDER,CLOCK-WIRES /?L1
	EQUAL? PRSA,V?THROUGH /?L3
	EQUAL? PRSA,V?HIDE-BEHIND,V?FOLLOW,V?WALK \?L1
?L3:	PRINTR "Linder says with frustration, ""I wish you wouldn't try to go off while we're trying to talk."""
?L1:	EQUAL? RARG,M-LOOK \FALSE
	PRINTI "This is obviously the office of Mr. Linder's company, Pacific Trade Associates. "
	CALL OFFICE-DESK-F,M-OBJDESC
	PRINTI "Behind it is a large ornately-carved chair, like a cruiser escorting a battle ship"
	IN? LINDER,CARVED-CHAIR \?L11
	PRINTI ", where Linder sits imperiously"
?L11:	PRINTI ". A simple wooden chair, polished smooth by visitors, flanks the desk on the other side. On the north wall is a lounge, upholstered in green velvet and a bit lumpy, with a framed wood-block picture hanging over it. On the outside wall, next to a door and window, stands a grandfather clock, ticking relentlessly. A file cabinet stands in the corner."
	CRLF
	FSET? OFFICE-DOOR,OPENBIT \?L18
	PRINTI "The door to the interior hallway is open."
	CRLF
?L18:	FSET? OFFICE-BACK-DOOR,OPENBIT \?L23
	PRINTI "The door leading outside is open."
	CRLF
?L23:	FSET? OFFICE-WINDOW,OPENBIT \TRUE
	PRINTR "The window facing the back yard is open."

	.FUNCT OFFICE-DESK-F,ARG=0
	EQUAL? ARG,M-OBJDESC /?L3
	ZERO? ARG \?L1
	EQUAL? PRSA,V?LOOK-ON,V?LOOK-INSIDE,V?EXAMINE \?L1
?L3:	PRINTI "At the west end of the office, a massive desk of teak and mahogany faces toward the window. It has no drawers, but the top is covered with piles of letters, some newspapers, a telephone, and various souvenirs from the Far East."
	EQUAL? MONICA-TIED-TO,OFFICE-DESK \?L6
	PRINTI " Monica is fastened to the desk with a "
	PRINTD MONICA-TIED-WITH
	PRINTI "."
?L6:	CRLF
	RTRUE
?L1:	EQUAL? PRSA,V?LOOK-UNDER \?L11
	PRINTR "You can see dirt and grime, old chewing gum in various colors, and a pair of black wires going from a button into the floor."
?L11:	EQUAL? PRSA,V?CLOSE,V?OPEN \FALSE
	PRINTR "You can't. It doesn't have drawers."

	.FUNCT NEWSPAPERS-F
	EQUAL? PRSA,V?USE,V?MOVE,V?TAKE \?L1
	PRINTR "You have no need for them."
?L1:	EQUAL? PRSA,V?EXAMINE,V?SEARCH,V?READ \FALSE
	PRINTR "Today's L.A. Times has the usual sort of stories: secret records of the police intelligence squad were seized in connection with an attempt to assassinate private detective Harry Raymond; ""Two Officers Die in Battle With Maniac""; ""Slayer of Tijuana Girl Executed under Fugitive Law""; and ""Austria Near Hitler Yoke."""

	.FUNCT CARVED-CHAIR-F,ARG=0
	EQUAL? ARG,M-OBJDESC \?L1
	CALL PRINT-CONT,CARVED-CHAIR
	RTRUE
?L1:	ZERO? ARG \FALSE
	EQUAL? PRSA,V?EXAMINE /?L5
	EQUAL? PRSA,V?SEARCH-OBJECT-FOR \?L4
?L5:	PRINTR "The chair looks like teak, covered with carvings of vines and slithery creatures that you wouldn't like to meet in a jungle."
?L4:	FSET? CORPSE,INVISIBLE \FALSE
	EQUAL? PRSA,V?TAKE,V?SIT,V?CLIMB-ON \FALSE
	GET P-PRSO,0 >STACK
	EQUAL? 1,STACK \FALSE
	EQUAL? PRSO,CARVED-CHAIR \FALSE
	PRINTI "Linder glares at you. "
	CALL PRINT-ID,STR?161
	IN? LINDER,CARVED-CHAIR \?L13
	PRINTI """I meant that you should sit in the customer's chair, not my lap!"" "
	JUMP ?L17
?L13:	PRINTI """That's my chair. You take the other one."" "
?L17:	PRINTR "You are on your own feet again."

	.FUNCT WOODEN-CHAIR-F,ARG=0
	ZERO? ARG \FALSE
	EQUAL? PRSA,V?TAKE,V?SIT,V?CLIMB-ON \FALSE
	GET P-PRSO,0 >STACK
	EQUAL? 1,STACK \FALSE
	EQUAL? PRSO,WOODEN-CHAIR \FALSE
	MOVE PLAYER,WOODEN-CHAIR
	PRINTI "You are now sitting on the "
	PRINTD PRSO
	PRINTI "."
	CRLF
	ZERO? LINDER-EXPLAINED \TRUE
	CALL I-LINDER-EXPLAIN
	RTRUE

	.FUNCT GENERIC-CHAIR-F,OBJ
	EQUAL? PRSA,V?DISEMBARK \?L1
	LOC WINNER >STACK
	IN? STACK,ROOMS /?L1
	LOC WINNER >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?WHAT,V?TELL-ME /?L4
	EQUAL? PRSA,V?FIND,V?ASK-CONTEXT-ABOUT,V?ASK-ABOUT \?L3
?L4:	RETURN GENERIC-CHAIR
?L3:	EQUAL? HERE,MONICA-ROOM,LINDER-ROOM,LIVING-ROOM /FALSE
	EQUAL? HERE,DINING-ROOM,KITCHEN,OFFICE /FALSE
	SET 'P-WON,0
	PRINTI "(You can't see any "
	PRINTI "chair"
	PRINTI " here!)"
	CRLF
	RETURN NOT-HERE-OBJECT

	.FUNCT PAPERS-F
	EQUAL? PRSA,V?TAKE /?L3
	EQUAL? PRSA,V?READ,V?LOOK-INSIDE,V?EXAMINE \FALSE
?L3:	FSET PAPERS,TOUCHBIT
	LOC LINDER >STACK
	ZERO? STACK /?L4
	CALL PERFORM,V?ASK-ABOUT,LINDER,PAPERS
	RTRUE
?L4:	PRINTI "You look "
	EQUAL? P-ADVERB,W?CAREFULLY \?L9
	PRINTI "more thoroughly through the files and still"
	JUMP ?L13
?L9:	PRINTI "quickly through the files but"
?L13:	PRINTR " find nothing suspicious, so you decide to leave them alone."

	.FUNCT CLOCK-F
	EQUAL? HERE,OFFICE /?L1
	EQUAL? PRSA,V?ASK-CONTEXT-ABOUT,V?ASK-ABOUT,V?WHAT /?L1
	EQUAL? PRSA,V?TELL-ME,V?FIND /?L1
	SET 'P-WON,0
	PRINTI "(You can't see any "
	PRINTI "clock"
	PRINTR " here!)"
?L1:	EQUAL? PRSA,V?EXAMINE \?L5
	PRINTI "This is a full-blown ""grandfather"" clock, seven feet tall, run by weights and regulated by a pendulum, whose dial shows day, date, and phase of the moon besides the time. According to the dial, today is "
	LESS? PRESENT-TIME,720 \?L8
	PRINTI "Friday the 18"
	JUMP ?L12
?L8:	PRINTI "Saturday the 19"
?L12:	PRINTI "th, the moon is just past full, and the time is now "
	CALL TIME-PRINT,PRESENT-TIME
	ZERO? SHOT-FIRED /?L23
	FCLEAR CLOCK-POWDER,INVISIBLE
	EQUAL? P-ADVERB,W?CAREFULLY \?L19
	PRINTR " There is some kind of powder around the keyhole."
?L19:	PRINTI " And you notice that the keyhole looks darker than normal."
?L23:	CRLF
	RTRUE
?L5:	EQUAL? PRSA,V?LISTEN \?L27
	PRINTR "The clock is ticking relentlessly."
?L27:	EQUAL? PRSA,V?SEARCH,V?OPEN,V?LOOK-INSIDE \?L30
	FSET? CLOCK,LOCKED /?L30
	EQUAL? PRSA,V?SEARCH,V?LOOK-INSIDE \?L31
	FSET? CLOCK,OPENBIT /?L31
	PRINTR "You'll have to open it first."
?L31:	FSET CLOCK,OPENBIT
	PRINTI "As you'd expect, the case holds a long pendulum."
	IN? INSIDE-GUN,CLOCK \?L38
	FCLEAR INSIDE-GUN,INVISIBLE
	PRINTI " The surprise is a hand gun, pointing out into the room."
?L38:	PRINTR " You can also see some relays and things."
?L30:	EQUAL? PRSA,V?LOOK-UNDER \?L45
	PRINTR "All you see is a pair of green wires going from the case into the floor."
?L45:	EQUAL? PRSA,V?LOCK \?L48
	EQUAL? PRSO,CLOCK \?L48
	IN? CLOCK-KEY,WINNER \?L49
	FSET CLOCK,LOCKED
	SET 'USED-CLOCK-KEY,1
	ZERO? SEEN-MONICA-AT-CLOCK \?L51
	PRINTI "[RWD_ID: places:2481, VAL: 1]"
?L51:	PRINTR "The door of the clock is now locked."
?L49:	PRINTR "You don't have the right key."
?L48:	EQUAL? PRSA,V?UNLOCK \?L61
	EQUAL? PRSO,CLOCK \?L61
	IN? CLOCK-KEY,WINNER \?L62
	FCLEAR CLOCK,LOCKED
	SET 'USED-CLOCK-KEY,1
	ZERO? SEEN-MONICA-AT-CLOCK \?L64
	PRINTI "[RWD_ID: places:2488, VAL: 1]"
?L64:	PRINTR "The door of the clock is now unlocked."
?L62:	PRINTR "You don't have the right key."
?L61:	EQUAL? PRSA,V?MOVE,V?PUSH \FALSE
	PRINTR "It seems to be bolted to the floor."

	.FUNCT KEY-HOLE-F
	EQUAL? WINNER,PLAYER \?L1
	EQUAL? PRSA,V?SMELL,V?RUB-OVER,V?RUB /?L3
	EQUAL? PRSA,V?PUT,V?LOOK-INSIDE /?L3
	EQUAL? PRSA,V?KISS,V?EXAMINE,V?BRUSH \?L1
?L3:	SET 'PLAYER-NEAR-SHOT,PRESENT-TIME
?L1:	EQUAL? PRSA,V?EXAMINE \?L5
	PRINTI "It's an impressive keyhole, wrapped in a fine brass escutcheon."
	ZERO? SHOT-FIRED /?L9
	FCLEAR CLOCK-POWDER,INVISIBLE
	PRINTI " There is some kind of powder around it."
?L9:	CRLF
	RTRUE
?L5:	EQUAL? PRSA,V?LOOK-INSIDE \?L14
	FSET? CLOCK,OPENBIT /?L14
	PRINTR "You can't see anything in there but darkness."
?L14:	EQUAL? PRSA,V?PUT \FALSE
	ZERO? LINDER-FOLLOWS-YOU /FALSE
	PRINTR "Linder says, ""I wish you'd pay attention to me instead of that clock."""

	.FUNCT CLOCK-POWDER-F
	EQUAL? PRSA,V?ANALYZE \?L1
	FCLEAR CLOCK-POWDER,NDESCBIT
	FCLEAR CLOCK-POWDER,INVISIBLE
	CALL DO-ANALYZE >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?EXAMINE \?L3
	PRINTR "It looks like cheap gunpowder."
?L3:	EQUAL? PRSA,V?SMELL \?L6
	PRINTR "It has a pungent smell, like cheap gunpowder."
?L6:	GET P-PRSO,0 >STACK
	EQUAL? 1,STACK \FALSE
	EQUAL? PRSA,V?TAKE \FALSE
	FCLEAR CLOCK-POWDER,INVISIBLE
	FCLEAR CLOCK-POWDER,NDESCBIT
	RFALSE

	.FUNCT CLOCK-WIRES-F
	EQUAL? PRSA,V?FOLLOW \?L1
	PRINTR "The wires go into the floor and disappear."
?L1:	EQUAL? PRSA,V?TAKE \FALSE
	PRINTI "You can't."
	PRINTR " They're stuck tight."

	.FUNCT OFFICE-BUTTON-F
	EQUAL? PRSA,V?FIND \?L1
	PRINTR "It's on the edge of the desk."
?L1:	EQUAL? PRSA,V?RING,V?PUSH \FALSE
	ZERO? BUTTON-FIXED /?L6
	CALL PERFORM,V?PUSH,BUTTON
	RTRUE
?L6:	ZERO? SHOT-FIRED /?L8
	SET 'PLAYER-PUSHED-BUTTON,1
	PRINTR "You hear a clicking sound from the direction of the clock."
?L8:	CALL META-LOC,LINDER >STACK
	EQUAL? STACK,OFFICE \?L11
	PRINTR "Linder grabs your wrist and looks you hard in the eye. Then a wide smile breaks out on his face as he lets go. ""Sorry if I'm rough, but I don't want any interruptions right now."""
?L11:	SET 'PLAYER-PUSHED-BUTTON,1
	CALL FIRE-SHOT
	RTRUE

	.FUNCT GARAGE-F,ARG=0
	EQUAL? ARG,M-LOOK \FALSE
	PRINTI "The garage, like a car port, has no door to keep the cars in.[RWD_ID: places:2669, VAL: 1] Doors lead north and east. The walls are decorated with spare tires and things. "
	FSET? MONICA-CAR,INVISIBLE \?L5
	FSET? MONICA-CAR,TOUCHBIT \?L7
	PRINTI "The red MG is gone."
	JUMP ?L19
?L7:	PRINTI "Oil spots on the floor show that a car is often parked here."
	JUMP ?L19
?L5:	FSET? MONICA-CAR,TOUCHBIT \?L15
	PRINTI "The red MG is parked here."
	JUMP ?L19
?L15:	PRINTI "One car is a sporty red MG convertible."
?L19:	PRINTR " The other car is a dark blue Bentley 3.5-liter sedan."

	.FUNCT CAR-F,ARG=0
	EQUAL? PRSO,MONICA-CAR \?L1
	FSET? MONICA-CAR,INVISIBLE \?L1
	PRINTR "It's not here."
?L1:	ZERO? FILM-SEEN /?L5
	EQUAL? PRSO,MONICA-CAR \?L5
	EQUAL? PRSA,V?RUB \?L5
	PRINTR "The hood is still warm from driving."
?L5:	EQUAL? PRSA,V?LOOK-INSIDE \?L8
	PRINTR "You can barely see a plush interior through the tinted glass, but nothing else of interest."
?L8:	EQUAL? PRSA,V?UNLOCK,V?LOCK \?L11
	PRINTR "You don't have the right key."
?L11:	EQUAL? PRSA,V?THROUGH \FALSE
	PRINTR "The doors are locked."

	.FUNCT CAR-WINDOW-F
	EQUAL? HERE,GARAGE /?L1
	SET 'P-WON,0
	PRINTI "(You can't see any "
	PRINTI "window"
	PRINTR " here!)"
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \?L5
	PRINTR "You can barely see a plush interior through the tinted glass, but nothing else of interest."
?L5:	EQUAL? PRSA,V?MUNG \FALSE
	PRINTI "Vandalism is for private "
	CALL PRINT-ID,STR?162
	CALL TANDY? >STACK
	ZERO? STACK /?L11
	PRINTI "eye"
	JUMP ?L15
?L11:	PRINTI "dick"
?L15:	PRINTR "s, not famous police detectives!"

	.FUNCT GENERIC-CAR-F,OBJ
	EQUAL? HERE,GARAGE /FALSE
	EQUAL? PRSA,V?WHAT,V?TELL-ME /?L4
	EQUAL? PRSA,V?FIND,V?ASK-CONTEXT-ABOUT,V?ASK-ABOUT \?L3
?L4:	RETURN GENERIC-CAR
?L3:	SET 'P-WON,0
	PRINTI "(You can't see any "
	PRINTI "car"
	PRINTI " here!)"
	CRLF
	RETURN NOT-HERE-OBJECT

	.FUNCT WORKSHOP-WIRE-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "It looks just like ordinary wire."
?L1:	EQUAL? PRSA,V?FIND \?L5
	PRINTR "You can find wire here in almost any color you like."
?L5:	EQUAL? PRSA,V?FOLLOW \FALSE
	PRINTR "It just goes around and around the supply spool."

	.FUNCT SPOOL-OF-WIRE-F
	EQUAL? PRSA,V?COMPARE \FALSE
	EQUAL? PRSI,PIECE-OF-WIRE /?L3
	EQUAL? PRSO,PIECE-OF-WIRE \FALSE
?L3:	EQUAL? P-ADVERB,W?CAREFULLY \?L4
	SET 'WIRE-MATCHED,1
	PRINTR "The piece of green wire and the green spool fit together perfectly."
?L4:	PRINTR "The piece of green wire and the green spool appear to be similar."

	.FUNCT GENERIC-WIRE-F,OBJ
	EQUAL? HERE,WORKSHOP \?L1
	EQUAL? PRSA,V?FIND \FALSE
	RETURN WORKSHOP-WIRE
?L1:	IN? OBJ,GLOBAL-OBJECTS /FALSE
	EQUAL? PRSA,V?TAKE,V?SEARCH-OBJECT-FOR,V?SGIVE /?L8
	EQUAL? PRSA,V?GIVE,V?WHAT,V?TELL-ME /?L8
	EQUAL? PRSA,V?FIND,V?ASK-CONTEXT-FOR /?L8
	EQUAL? PRSA,V?ASK-FOR,V?ASK-CONTEXT-ABOUT,V?ASK-ABOUT \?L7
?L8:	EQUAL? OBJ,PIECE-OF-WIRE,SPOOL-OF-WIRE /?L11
	EQUAL? OBJ,CLOCK-WIRES,GENERIC-GREEN-WIRE \?L9
?L11:	RETURN GENERIC-GREEN-WIRE
?L9:	RETURN GENERIC-WIRE
?L7:	SET 'P-WON,0
	PRINTI "(You can't see any "
	PRINTI "wire"
	PRINTI " here!)"
	CRLF
	RETURN NOT-HERE-OBJECT

	.FUNCT JUNCTION-BOX-F
	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "There's a snarl of colored wires, relays, pilot lights, and stuff that only an engineer could admire."

	.FUNCT TOOLS-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "The tools are standard gardening and carpentry tools, in excellent condition."
?L1:	EQUAL? PRSA,V?TAKE \FALSE
	PRINTR "You have no use for them, unless you are looking for a new profession."

	.FUNCT AIR-F
	EQUAL? PRSA,V?SMELL \FALSE
	EQUAL? HERE,FRONT-YARD \?L3
	PRINTR "The smell of herbs permeates everything."
?L3:	EQUAL? HERE,FRONT-PORCH \?L7
	PRINTR "A breeze carries the faint smell of herbs through the air."
?L7:	GETP HERE,P?LINE >STACK
	EQUAL? STACK,OUTSIDE-LINE-C \?L10
	PRINTR "The air is clear and fresh here."
?L10:	CALL FRESH-AIR?,HERE >STACK
	ZERO? STACK \TRUE
	PRINTR "The air is rather musty here."

	.FUNCT FRESH-AIR?,RM,P,L,TBL,O
	SET 'P,0
?L1:	NEXTP HERE,P >P
	ZERO? P /FALSE
	LESS? P,P?OUT /?L1
	GETPT HERE,P >TBL
	PTSIZE TBL >L
	EQUAL? L,DEXIT \?L1
	GETB TBL,DEXITOBJ >O
	FSET? O,OPENBIT \?L1
	PRINTI "There is a pleasant breeze coming through the "
	PRINTD O
	PRINTR "."

	.FUNCT CORRIDOR-LOOK,ITM=0,C,Z,COR,VAL,FOUND=0
	GETP HERE,P?CORRIDOR >C
	ZERO? C /FALSE
?L3:	SUB C,16 >Z
	LESS? Z,0 /?L5
	SET 'COR,COR-16
	JUMP ?L11
?L5:	SUB C,8 >Z
	LESS? Z,0 /?L7
	SET 'COR,COR-8
	JUMP ?L11
?L7:	SUB C,4 >Z
	LESS? Z,0 /?L8
	SET 'COR,COR-4
	JUMP ?L11
?L8:	SUB C,2 >Z
	LESS? Z,0 /?L9
	SET 'COR,COR-2
	JUMP ?L11
?L9:	SUB C,1 >Z
	LESS? Z,0 /?L4
	SET 'COR,COR-1
?L11:	CALL CORRIDOR-CHECK,COR,ITM >VAL
	ZERO? FOUND \?L12
	SET 'FOUND,VAL
?L12:	SET 'C,Z
	JUMP ?L3
?L4:	RETURN FOUND

	.FUNCT CORRIDOR-CHECK,COR,ITM,CNT=2,PAST=0,FOUND=0,RM,OBJ
?L1:	GET COR,CNT >RM
	ZERO? RM /FALSE
	EQUAL? RM,HERE \?L5
	SET 'PAST,1
	JUMP ?L52
?L5:	FIRST? RM >OBJ \?L52
?L7:	ZERO? ITM /?L9
	EQUAL? OBJ,ITM \?L14
	GET COR,PAST >FOUND
	JUMP ?L8
?L9:	FSET? OBJ,PERSON \?L14
	CALL IN-MOTION?,OBJ >STACK
	ZERO? STACK \?L14
	FSET? OBJ,INVISIBLE /?L14
	EQUAL? OBJ,STILES \?L15
	ZERO? DUFFY-WITH-STILES /?L15
	SET 'SEEN-DUFFY?,1
	PRINTI "Sgt. Duffy, with "
	ZERO? MET-STILES? /?L19
	PRINTI "Stiles"
	JUMP ?L23
?L19:	PRINTI "someone"
?L23:	PRINTI " in tow,"
	JUMP ?L31
?L15:	FSET? OBJ,TOUCHBIT /?L28
	PRINTI "Someone"
	JUMP ?L31
?L28:	PRINTD OBJ
?L31:	PRINTI " is "
	CALL OUTSIDE?,RM >STACK
	ZERO? STACK /?L36
	PRINTI "off"
	JUMP ?L40
?L36:	PRINTI "down the hall"
?L40:	PRINTI " to "
	GET COR,PAST >STACK
	CALL DIR-PRINT,STACK
	PRINTI "."
	CRLF
?L14:	NEXT? OBJ >OBJ /?L7
?L8:	ZERO? FOUND /?L52
	RETURN FOUND
?L52:	INC 'CNT
	JUMP ?L1

	.FUNCT COR-DIR,HERE?1,THERE,COR,RM,PAST=0,CNT=2
	GETP HERE?1,P?CORRIDOR >STACK
	GETP THERE,P?CORRIDOR >STACK
	BAND STACK,STACK >STACK
	CALL GET-COR,STACK >COR
?L1:	GET COR,CNT >RM
	EQUAL? RM,HERE?1 \?L3
	SET 'PAST,1
	JUMP ?L2
?L3:	EQUAL? RM,THERE /?L2
	INC 'CNT
	JUMP ?L1
?L2:	GET COR,PAST >STACK
	RSTACK

	.FUNCT GET-COR,NUM
	EQUAL? NUM,1 \?L1
	RETURN COR-1
?L1:	EQUAL? NUM,2 \?L3
	RETURN COR-2
?L3:	EQUAL? NUM,4 \?L4
	RETURN COR-4
?L4:	EQUAL? NUM,8 \?L5
	RETURN COR-8
?L5:	RETURN COR-16

	.FUNCT RANDOM-PSEUDO
	PRINTR "You can't do anything useful with that."

	.FUNCT NOT-HERE-OBJECT-F,TBL,PRSO?=1,OBJ
	EQUAL? PRSO,NOT-HERE-OBJECT \?L5
	EQUAL? PRSI,NOT-HERE-OBJECT \?L1
	PRINTR "(Those things aren't here!)"
?L1:	EQUAL? PRSO,NOT-HERE-OBJECT \?L5
	SET 'TBL,P-PRSO
	JUMP ?L6
?L5:	SET 'TBL,P-PRSI
	SET 'PRSO?,0
?L6:	ZERO? PRSO? /?L7
	EQUAL? PRSA,V?WALK-TO,V?THROUGH,V?MAKE /?L11
	EQUAL? PRSA,V?GIVE,V?$0024WHERE,V?WHAT /?L11
	EQUAL? PRSA,V?SEARCH,V?LOOK-OUTSIDE,V?LOOK-INSIDE /?L11
	EQUAL? PRSA,V?FOLLOW,V?FIND,V?EXAMINE /?L11
	EQUAL? PRSA,V?CLIMB-UP,V?ASK-CONTEXT-FOR,V?ASK-CONTEXT-ABOUT \?L28
?L11:	CALL FIND-NOT-HERE,TBL,PRSO? >OBJ
	ZERO? OBJ /FALSE
	EQUAL? OBJ,NOT-HERE-OBJECT /?L28
	RTRUE
?L7:	EQUAL? PRSA,V?TELL-ME,V?SGIVE /?L22
	EQUAL? PRSA,V?SEARCH-OBJECT-FOR,V?ASK-FOR,V?ASK-ABOUT \?L28
?L22:	CALL FIND-NOT-HERE,TBL,PRSO? >OBJ
	ZERO? OBJ /FALSE
	EQUAL? OBJ,NOT-HERE-OBJECT \TRUE
?L28:	SET 'P-WON,0
	PRINTI "(You can't see any"
	CALL NOT-HERE-PRINT
	PRINTR " here!)"

	.FUNCT FIND-NOT-HERE,TBL,PRSO?,M-F,OBJ,?TMP
	CALL MOBY-FIND,TBL >M-F
	ZERO? DEBUG /?L1
	PRINTI "[Moby-found "
	PRINTN M-F
	PRINTI " objects"
	PRINTI "]"
	CRLF
?L1:	EQUAL? 1,M-F \?L6
	ZERO? DEBUG /?L8
	PRINTI "[Namely: "
	PRINTD P-MOBY-FOUND
	PRINTI "]"
	CRLF
?L8:	ZERO? PRSO? /?L13
	SET 'PRSO,P-MOBY-FOUND
	RFALSE
?L13:	SET 'PRSI,P-MOBY-FOUND
	RFALSE
?L6:	LESS? 1,M-F \?L16
	GET TBL,1 >OBJ
	GETP OBJ,P?GENERIC >STACK
	CALL STACK,OBJ >OBJ
	ZERO? OBJ /?L16
	ZERO? DEBUG /?L17
	PRINTI "[Generic: "
	PRINTD OBJ
	PRINTI "]"
	CRLF
?L17:	EQUAL? OBJ,NOT-HERE-OBJECT /TRUE
	ZERO? PRSO? /?L24
	SET 'PRSO,OBJ
	RFALSE
?L24:	SET 'PRSI,OBJ
	RFALSE
?L16:	ZERO? PRSO? \?L52
	EQUAL? PRSA,V?TELL-ME,V?ASK-FOR,V?ASK-ABOUT /?L30
	ZERO? PRSO? /?L29
?L52:	EQUAL? PRSA,V?ASK-CONTEXT-FOR,V?ASK-CONTEXT-ABOUT /?L30
?L29:	EQUAL? WINNER,PLAYER /?L26
	EQUAL? PRSA,V?SGIVE /?L30
	EQUAL? PRSA,V?GIVE,V?WHAT,V?FIND \?L26
?L30:	EQUAL? PRSA,V?ASK-FOR,V?ASK-ABOUT \?L31
	PRINTD PRSO
	JUMP ?L35
?L31:	ZERO? QCONTEXT /?L38
	EQUAL? HERE,QCONTEXT-ROOM \?L38
	SET '?TMP,HERE
	CALL META-LOC,QCONTEXT >STACK
	EQUAL? ?TMP,STACK \?L38
	PUSH QCONTEXT
	JUMP ?L41
?L38:	EQUAL? WINNER,PLAYER /?L40
	PUSH WINNER
	JUMP ?L41
?L40:	CALL FIND-FLAG,HERE,PERSON >STACK
?L41:	PRINTD STACK
?L35:	PRINTI " looks confused. ""I don't know anything about any"
	CALL NOT-HERE-PRINT
	PRINTR "!"""
?L26:	ZERO? PRSO? \?L46
	PRINTI "You wouldn't find any"
	CALL NOT-HERE-PRINT
	PRINTR " there."
?L46:	RETURN NOT-HERE-OBJECT

	.FUNCT NOT-HERE-PRINT
	ZERO? P-OFLAG \?L3
	ZERO? P-MERGED /?L1
?L3:	ZERO? P-XADJ /?L4
	PRINTI " "
	PRINTB P-XADJN
?L4:	ZERO? P-XNAM /FALSE
	PRINTI " "
	PRINTB P-XNAM
	RTRUE
?L1:	EQUAL? PRSO,NOT-HERE-OBJECT \?L14
	GET P-ITBL,P-NC1L >STACK
	GET P-ITBL,P-NC1 >STACK
	CALL BUFFER-PRINT,STACK,STACK,0 >STACK
	RSTACK
?L14:	GET P-ITBL,P-NC2L >STACK
	GET P-ITBL,P-NC2 >STACK
	CALL BUFFER-PRINT,STACK,STACK,0 >STACK
	RSTACK

	.FUNCT IT-F
	EQUAL? PRSI,IT \?L4
	EQUAL? PRSA,V?TELL-ME,V?SEARCH-OBJECT-FOR,V?ASK-FOR /?L5
	EQUAL? PRSA,V?ASK-ABOUT /?L5
?L4:	EQUAL? PRSO,IT \FALSE
	EQUAL? PRSA,V?WHAT /?L5
	EQUAL? PRSA,V?FIND,V?ASK-CONTEXT-FOR,V?ASK-CONTEXT-ABOUT \FALSE
?L5:	PRINTR """I'm not sure what you're talking about."""

	.FUNCT THE?,NOUN
	EQUAL? NOUN,MONICA-ROOM,LINDER-ROOM,LIMBO /TRUE
	EQUAL? NOUN,PHONG,LINDER,STILES /TRUE
	EQUAL? NOUN,GLOBAL-PHONG,GLOBAL-LINDER,GLOBAL-STILES /TRUE
	EQUAL? NOUN,MONICA,GLOBAL-MONICA,GLOBAL-TERRY /TRUE
	EQUAL? NOUN,IT,YOU,HIM-HER /TRUE
	EQUAL? NOUN,LINDER-WINDOW,GLOBAL-DUFFY /TRUE
	PRINTI " the"
	RTRUE

	.FUNCT THIS-IS-IT,OBJ
	SET 'P-IT-OBJECT,OBJ
	SET 'P-IT-LOC,HERE
	RETURN P-IT-LOC

	.FUNCT RECURSIVE-BOOK-F
	EQUAL? PRSA,V?ASK-FOR \?L1
	EQUAL? PRSO,PHONG \?L1
	FCLEAR PRSI,NDESCBIT
	RFALSE
?L1:	EQUAL? PRSA,V?TAKE,V?GIVE \?L3
	IN? RECURSIVE-BOOK,PHONG \?L3
	FCLEAR PRSO,NDESCBIT
	RFALSE
?L3:	EQUAL? PRSA,V?DROP \?L4
	IN? PHONG,BUTLER-ROOM \?L4
	MOVE RECURSIVE-BOOK,PHONG
	PRINTR "Phong picks up the book and starts to read."
?L4:	EQUAL? PRSA,V?EXAMINE \?L7
	PRINTR "This is a mystery story called 'Deadline,' just now published as a book."
?L7:	EQUAL? PRSA,V?LOOK-INSIDE /?L11
	EQUAL? PRSA,V?OPEN,V?READ,V?SEARCH \FALSE
?L11:	FSET RECURSIVE-BOOK,OPENBIT
	PRINTI "The book is a novel-length version of 'Deadline,' a whodunit set in the future in Connecticut. You start to read it, and it seems oddly familiar, as if you might live through it yourself some day."
	IN? GUN-RECEIPT,RECURSIVE-BOOK \?L14
	FCLEAR GUN-RECEIPT,INVISIBLE
	PRINTI " A receipt of some kind is being used as a bookmark."
?L14:	CRLF
	RTRUE

	.FUNCT GUN-RECEIPT-F
	EQUAL? PRSA,V?READ,V?EXAMINE \FALSE
	GET 0,8 >STACK
	BOR STACK,2 >STACK
	PUT 0,8,STACK
	PRINTI """            FRITZI'S
   fine merchandise - quick loans
        Cabeza Plana, Calif.
                        Number: 69105
                        Date: 12/1/37
Sold to: Nemo Newbourne
Address: 137 E. Second Street

Two handguns - - - - - - - - - $ 8.00
[RWD_ID: things:214, VAL: 1] 
[PAID]"""
	CRLF
	GET 0,8 >STACK
	BAND STACK,-3 >STACK
	PUT 0,8,STACK
	RTRUE

	.FUNCT MATCHBOOK-F
	EQUAL? PRSA,V?SLAP,V?LAMP-ON \?L1
	PRINTR "The matches don't seem to work."
?L1:	EQUAL? PRSA,V?OPEN,V?LOOK-INSIDE \?L5
	PRINTR "(You'll find the match book in your game package.)"
?L5:	EQUAL? PRSA,V?LOOK-UP \FALSE
	CALL PHONE-IN?,HERE >STACK
	ZERO? STACK /FALSE
	PRINTR "The listing for Stiles in the phone book is the same as the number written in the match book."

	.FUNCT HANDCUFFS-F
	EQUAL? PRSA,V?TAKE \FALSE
	EQUAL? PRSO,HANDCUFFS \FALSE
	EQUAL? HANDCUFFS,MONICA-TIED-WITH \FALSE
	ZERO? PRSI /?L5
	EQUAL? PRSI,MONICA \FALSE
?L5:	CALL PERFORM,V?UNTIE,MONICA
	RTRUE

	.FUNCT HOUSE-F
	EQUAL? PRSA,V?FIND \?L1
	PRINTR "It's right here. Some detective you are."
?L1:	EQUAL? PRSA,V?WALK-TO \?L5
	EQUAL? HERE,DRIVEWAY-ENTRANCE,DRIVEWAY \?L5
	CALL PERFORM,V?WALK,P?NORTH
	RTRUE
?L5:	EQUAL? PRSA,V?THROUGH \?L6
	EQUAL? HERE,FRONT-YARD \?L7
	FSET? DINING-DOOR,OPENBIT \?L7
	CALL GOTO,DINING-ROOM >STACK
	RSTACK
?L7:	EQUAL? HERE,FRONT-PORCH \?L9
	FSET? FRONT-DOOR,OPENBIT \?L9
	CALL GOTO,ENTRY >STACK
	RSTACK
?L9:	EQUAL? HERE,OFFICE-PORCH \?L10
	FSET? OFFICE-BACK-DOOR,OPENBIT \?L10
	CALL GOTO,OFFICE >STACK
	RSTACK
?L10:	EQUAL? HERE,BACK-YARD \?L11
	FSET? MONICA-BACK-DOOR,OPENBIT \?L11
	CALL GOTO,MONICA-ROOM >STACK
	RSTACK
?L11:	EQUAL? HERE,ROCK-GARDEN \?L12
	FSET? LINDER-BACK-DOOR,OPENBIT \?L12
	CALL GOTO,LINDER-ROOM >STACK
	RSTACK
?L12:	PRINTR "You might try the front door."
?L6:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "The house looks like a mixture of a California bungalow and East Asian influences."

	.FUNCT FENCE-F
	EQUAL? PRSA,V?CLIMB-UP,V?CLIMB-ON,V?CLIMB-FOO \?L1
	PRINTI "You can't leave the property yet. It would mean your job."
	CRLF
	CALL PRINT-ID,STR?163 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?LOOK-OUTSIDE,V?LOOK-INSIDE,V?LOOK-BEHIND \?L5
	PRINTR "It's too dark to see anything."
?L5:	EQUAL? PRSA,V?FIND \?L8
	PRINTR "It's right here. Some detective you are."
?L8:	EQUAL? PRSA,V?EXAMINE \FALSE
	PRINTR "This is a Japanese-style ""shadow fence"" made of wooden slats, opaque from most angles but designed to let breezes through."

	.FUNCT GROUND-F
	EQUAL? PRSO,GROUND \?L1
	EQUAL? PRSA,V?WHAT,V?FIND,V?ASK-CONTEXT-FOR /FALSE
	EQUAL? PRSA,V?ASK-CONTEXT-ABOUT /FALSE
?L1:	EQUAL? PRSI,GROUND \?L4
	EQUAL? PRSA,V?TELL-ME,V?SEARCH-OBJECT-FOR,V?ASK-FOR /FALSE
	EQUAL? PRSA,V?ASK-ABOUT /FALSE
?L4:	GETP HERE,P?LINE >STACK
	EQUAL? STACK,OUTSIDE-LINE-C /?L6
	SET 'P-WON,0
	PRINTI "(You can't see any"
	CALL PRSO-PRINT
	PRINTR " here!)"
?L6:	EQUAL? PRSA,V?PUT \?L9
	EQUAL? PRSI,GROUND \?L9
	CALL PERFORM,V?DROP,PRSO
	RTRUE
?L9:	EQUAL? PRSA,V?SEARCH,V?EXAMINE \FALSE
	PRINTR "You don't find anything new there."

	.FUNCT FLOOR-F
	EQUAL? PRSO,FLOOR \?L1
	EQUAL? PRSA,V?WHAT,V?FIND,V?ASK-CONTEXT-FOR /FALSE
	EQUAL? PRSA,V?ASK-CONTEXT-ABOUT /FALSE
?L1:	EQUAL? PRSI,FLOOR \?L4
	EQUAL? PRSA,V?TELL-ME,V?SEARCH-OBJECT-FOR,V?ASK-FOR /FALSE
	EQUAL? PRSA,V?ASK-ABOUT /FALSE
?L4:	GETP HERE,P?LINE >STACK
	EQUAL? STACK,OUTSIDE-LINE-C \?L6
	SET 'P-WON,0
	PRINTI "(You can't see any"
	CALL PRSO-PRINT
	PRINTR " here!)"
?L6:	EQUAL? PRSA,V?PUT \?L9
	EQUAL? PRSI,FLOOR \?L9
	CALL PERFORM,V?DROP,PRSO
	RTRUE
?L9:	EQUAL? PRSA,V?SEARCH,V?EXAMINE \FALSE
	PRINTR "You don't find anything new there."

	.FUNCT MUSIC-F
	EQUAL? PRSA,V?LISTEN \FALSE
	ZERO? RADIO-ON /?L3
	PRINTR "You're too far away to make out what it is."
?L3:	PRINTR "You'd enjoy it more if you turned on the radio."

	.FUNCT SEEKING-DRINK?
	EQUAL? PRSA,V?GIVE \?L1
	EQUAL? PRSI,PLAYER \FALSE
	EQUAL? WINNER,PLAYER \TRUE
	RFALSE
?L1:	EQUAL? PRSA,V?SGIVE \?L6
	EQUAL? PRSO,PLAYER \FALSE
	EQUAL? WINNER,PLAYER \TRUE
	RFALSE
?L6:	EQUAL? PRSA,V?ASK-FOR \?L10
	FSET? PRSO,PERSON /TRUE
	RFALSE
?L10:	EQUAL? PRSA,V?TAKE \FALSE
	CALL FIND-FLAG,HERE,PERSON >STACK
	ZERO? STACK \TRUE
	ZERO? PRSI /FALSE
	FSET? PRSI,PERSON /TRUE
	RFALSE

	.FUNCT LIQUOR-F
	ZERO? LINDER-FOLLOWS-YOU /?L1
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTR "Linder is drinking something that looks like whisky, straight up."
?L1:	CALL SEEKING-DRINK? >STACK
	ZERO? STACK /?L5
	ZERO? DRUNK-FLAG /?L6
	CALL NO-DRINK
	RTRUE
?L6:	SET 'DRUNK-FLAG,1
	EQUAL? MONICA,WINNER,PRSO,PRSI \?L9
	PRINTR """So you want to dip your beak? Go ahead."""
?L9:	MOVE DRINK,PLAYER
	FSET DRINK,TAKEBIT
	PRINTR """I think we both need one.""  And so you both have one."
?L5:	EQUAL? PRSA,V?DRINK /?L17
	EQUAL? PRSA,V?OPEN \FALSE
	EQUAL? PRSO,BOURBON,SCOTCH \FALSE
?L17:	ZERO? DRUNK-FLAG /?L18
	CALL NO-DRINK
	RTRUE
?L18:	SET 'DRUNK-FLAG,1
	MOVE DRINK,PLAYER
	FSET DRINK,TAKEBIT
	PRINTI "You take a belt of the stuff and roll it on your tongue before swallowing. It's good whisky."
	CRLF
	CALL PRINT-ID,STR?164 >STACK
	RSTACK

	.FUNCT NO-DRINK
	PRINTI "You could drink this stuff all night, but you have work to do."
	CRLF
	CALL PRINT-ID,STR?165 >STACK
	RSTACK

	.FUNCT CIGARETTE-F
	EQUAL? PRSA,V?SEARCH-OBJECT-FOR,V?SEARCH,V?FIND \?L1
	PRINTR "Like any hard-boiled police detective, you must have a pack on you somewhere."
?L1:	EQUAL? PRSA,V?EXAMINE \?L5
	EQUAL? HERE,KITCHEN \?L6
	PRINTR "Phong's cigarettes are Lucky Strikes."
?L6:	PRINTR "All you can see is an ashtray full of butts."
?L5:	EQUAL? PRSA,V?SMOKE \?L13
	PRINTI "You light up a Camel, take a deep drag, and watch the smoke drift through the air. A few more puffs, and you're ready to go to work again."
	CRLF
	CALL PRINT-ID,STR?166 >STACK
	RSTACK
?L13:	EQUAL? PRSA,V?TURN,V?GIVE \?L18
	EQUAL? PRSI,PLAYER \?L18
	EQUAL? WINNER,PLAYER \?L21
?L18:	EQUAL? PRSA,V?SGIVE \?L19
	EQUAL? PRSO,PLAYER \?L19
	EQUAL? WINNER,PLAYER \?L21
?L19:	EQUAL? PRSA,V?ASK-FOR \?L20
	FSET? PRSO,PERSON /?L21
?L20:	EQUAL? PRSA,V?TAKE \FALSE
	CALL FIND-FLAG,HERE,PERSON,WINNER >STACK
	ZERO? STACK \?L21
	FSET? PRSI,PERSON \FALSE
?L21:	PRINTR """I think we both need one."" And so you both have one."

	.FUNCT BROKEN-GLASS-F
	EQUAL? PRSA,V?TAKE \FALSE
	PRINTI "You'd probably cut yourself on the sharp edges."
	CRLF
	CALL PRINT-ID,STR?167 >STACK
	RSTACK

	.FUNCT INSIDE-GUN-F
	EQUAL? PRSA,V?COMPARE \?L1
	EQUAL? PRSO,OUTSIDE-GUN /?L3
	EQUAL? PRSI,OUTSIDE-GUN \?L1
?L3:	EQUAL? P-ADVERB,W?CAREFULLY \?L4
	SET 'GUNS-MATCHED,1
	PRINTI "The two guns are virtually identical,"
	PRINTR " except that one has a very short barrel."
?L4:	PRINTI "The two guns appear to be very similar,"
	PRINTR " except that one has a very short barrel."
?L1:	EQUAL? PRSA,V?EXAMINE \?L11
	PRINTI "Y"
	PRINTI "ou can see it's just a cheap low-quality handgun."
	PRINTR " The barrel is very short, as if someone sawed it off."
?L11:	EQUAL? PRSA,V?OPEN \?L14
	PRINTR "You open the gun, find no spare bullets inside, and close it again."
?L14:	EQUAL? PRSA,V?SMELL \FALSE
	PRINTR "It smells as though it's recently been fired."

	.FUNCT OUTSIDE-GUN-F
	EQUAL? PRSA,V?EXAMINE \?L1
	PRINTI "[RWD_ID: things:586, VAL: 1]The gun is muddy from the ground, but y"
	PRINTR "ou can see it's just a cheap low-quality handgun."
?L1:	EQUAL? PRSA,V?OPEN \?L5
	PRINTR "You open the gun, find no spare bullets inside, and close it again."
?L5:	EQUAL? PRSA,V?SMELL \FALSE
	PRINTR "It smells as though it's recently been fired."

	.FUNCT GENERIC-GUN-F,OBJ
	EQUAL? PRSA,V?TAKE,V?SEARCH-OBJECT-FOR,V?SGIVE /?L3
	EQUAL? PRSA,V?GIVE,V?WHAT,V?TELL-ME /?L3
	EQUAL? PRSA,V?FIND,V?ASK-CONTEXT-FOR /?L3
	EQUAL? PRSA,V?ASK-FOR,V?ASK-CONTEXT-ABOUT,V?ASK-ABOUT \?L1
?L3:	RETURN GENERIC-GUN
?L1:	LOC PISTOL >STACK
	EQUAL? STACK,PLAYER,HERE /FALSE
	SET 'P-WON,0
	PRINTI "(You can't see any "
	PRINTI "gun"
	PRINTI " here!)"
	CRLF
	RETURN NOT-HERE-OBJECT

	.FUNCT PHONG-KEYS-F
	EQUAL? PRSA,V?GIVE \?L4
	EQUAL? PRSI,PLAYER \?L4
	EQUAL? WINNER,PHONG /?L3
?L4:	EQUAL? PRSA,V?TAKE \FALSE
	IN? PHONG-KEYS,PHONG \FALSE
?L3:	ZERO? PHONG-SEEN-CORPSE? /?L5
	MOVE PHONG-KEYS,PLAYER
	FCLEAR PHONG-KEYS,NDESCBIT
	PRINTR """Here, you may as well take them. I don't see how Mr. Linder can object now.[RWD_ID: things:666, VAL: 1]"""
?L5:	PRINTR """I don't think Mr. Linder would like that."""

	.FUNCT GENERIC-KEY-F,OBJ
	EQUAL? PRSA,V?TAKE,V?SEARCH-OBJECT-FOR,V?SGIVE /?L3
	EQUAL? PRSA,V?GIVE,V?WHAT,V?TELL-ME /?L3
	EQUAL? PRSA,V?FIND,V?ASK-CONTEXT-FOR /?L3
	EQUAL? PRSA,V?ASK-FOR,V?ASK-CONTEXT-ABOUT,V?ASK-ABOUT \?L1
?L3:	RETURN GENERIC-KEY
?L1:	LOC PHONG-KEYS >STACK
	EQUAL? STACK,PLAYER,HERE /FALSE
	SET 'P-WON,0
	PRINTI "(You can't see any "
	PRINTI "key"
	PRINTI " here!)"
	CRLF
	RETURN NOT-HERE-OBJECT

	.FUNCT HANDWRITING-F
	EQUAL? PRSA,V?ANALYZE \FALSE
	EQUAL? PRSO,HANDWRITING \FALSE
	ZERO? PRSI \FALSE
	LOC THREAT-NOTE >STACK
	LOC MATCHBOOK >STACK
	EQUAL? PLAYER,STACK,STACK \FALSE
	PRINTR "You didn't say what to analyze the handwriting on."

	.FUNCT GLOBAL-FINGERPRINTS-F
	EQUAL? PRSA,V?TAKE \FALSE
	EQUAL? PRSO,GLOBAL-FINGERPRINTS \FALSE
	ZERO? PRSI \?L3
	PRINTR "You didn't say what to take the fingerprints from."
?L3:	CALL PERFORM,V?FINGERPRINT,PRSI
	RTRUE

	.FUNCT GLOBAL-SUICIDE-F,STR
	EQUAL? PRSA,V?FIND \FALSE
	EQUAL? WINNER,PLAYER /FALSE
	PRINTR """She shot herself in the bathtub."""

	.FUNCT TELEPHONE-F
	EQUAL? PRSA,V?PHONE \?L1
	PRINTR "You should type what number to call, for example ""DIAL HYACINTH 1031."""
?L1:	EQUAL? PRSA,V?REPLY \?L5
	PRINTR "Don't bother unless it rings."
?L5:	EQUAL? PRSA,V?TAKE,V?RAISE \FALSE
	PRINTR "You lift the receiver and get a dial tone. Well done!"

	.FUNCT CORONER-F
	EQUAL? PRSA,V?PHONE \FALSE
	CALL PHONE-IN?,HERE >STACK
	ZERO? STACK /FALSE
	RANDOM 100 >STACK
	GRTR? 69,STACK \?L3
	PRINTR "You dial the number and wait a long time for someone to answer. Finally you hear a voice: ""We're awful busy here. Call back in ten minutes."" He hangs up before you can say a word."
?L3:	PRINTR "You dial the number and get a busy signal."

	.FUNCT BUTTON-F
	EQUAL? HERE,FRONT-PORCH \?L1
	EQUAL? PRSI,BUTTON \?L3
	CALL PERFORM,PRSA,PRSO,DOORBELL
	RTRUE
?L3:	EQUAL? PRSO,BUTTON \FALSE
	CALL PERFORM,PRSA,DOORBELL,PRSI
	RTRUE
?L1:	CALL OUTSIDE?,HERE >STACK
	ZERO? STACK /?L7
	PRINTR "There's no button here."
?L7:	EQUAL? PRSA,V?RING,V?PUSH \FALSE
	IN? PHONG,HERE \?L11
	PRINTR "Phong looks annoyed. ""You needn't ring for me. I'm right here."""
?L11:	CALL YOU-RANG
	PRINTR "You barely hear a bell ring in the distance."

	.FUNCT YOU-RANG
	GET GOAL-TABLES,PHONG-C >STACK
	GET STACK,GOAL-S >STACK
	ZERO? STACK \FALSE
	SET 'PHONG-CALLED,1
	LOC PHONG >PHONG-OLD-LOC
	CALL ESTABLISH-GOAL,PHONG,HERE >STACK
	RSTACK

	.FUNCT BLACK-WIRE-F
	GETP HERE,P?LINE >STACK
	EQUAL? STACK,OUTSIDE-LINE-C \?L1
	PRINTR "There's no wire here."
?L1:	EQUAL? PRSO,WHITE-WIRE \?L5
	EQUAL? HERE,WORKSHOP /?L5
	CALL WINDOW-IN?,HERE >STACK
	ZERO? STACK \?L5
	PRINTR "There's no white wire here."
?L5:	EQUAL? PRSA,V?EXAMINE \?L8
	EQUAL? PRSO,BLACK-WIRE \?L9
	EQUAL? HERE,WORKSHOP \?L11
	PRINTI "You can see several kinds of "
	PRINTI "black"
	PRINTR " wire on spools, not to mention the snarl in the junction box."
?L11:	PRINTR "A pair of black wires goes from the butler's button into the floor."
?L9:	EQUAL? HERE,WORKSHOP \?L18
	PRINTI "You can see several kinds of "
	PRINTI "white"
	PRINTR " wire on spools, not to mention the snarl in the junction box."
?L18:	PRINTI "A pair of white wires goes from some sort of electric switch on the "
	EQUAL? HERE,ENTRY,GARAGE \?L24
	PUSH STR?168
	JUMP ?L26
?L24:	PUSH STR?169
?L26:	PRINT STACK
	PRINTR " into the frame."
?L8:	EQUAL? PRSA,V?FOLLOW \?L27
	EQUAL? PRSO,BLACK-WIRE \?L28
	PRINTR "The wire goes into the floor and disappears."
?L28:	EQUAL? HERE,WORKSHOP \?L32
	PRINTR "It just goes around and around the spools."
?L32:	PRINTR "The wire goes into the wall and disappears."
?L27:	EQUAL? PRSA,V?TAKE \FALSE
	PRINTR "You don't really want to do that."

	.FUNCT MUDDY-SHOES-F
	EQUAL? PRSA,V?PUT,V?COMPARE \?L6
	EQUAL? PRSO,BACK-FOOTPRINTS-CAST,BACK-FOOTPRINTS /?L3
	EQUAL? PRSI,BACK-FOOTPRINTS-CAST,BACK-FOOTPRINTS \?L1
?L3:	PRINTI "The boots don't seem to match "
	PRINTI "the foot prints that you found in the "
	PRINTR "back yard."
?L1:	EQUAL? PRSA,V?PUT,V?COMPARE \?L6
	EQUAL? PRSO,SIDE-FOOTPRINTS-CAST,SIDE-FOOTPRINTS /?L7
	EQUAL? PRSI,SIDE-FOOTPRINTS-CAST,SIDE-FOOTPRINTS \?L6
?L7:	EQUAL? PRSA,V?PUT /?L10
	EQUAL? P-ADVERB,W?CAREFULLY \?L8
?L10:	SET 'SIDE-FOOTPRINTS-MATCHED,1
	PRINTR "The boots and the foot prints match each other perfectly."
?L8:	PRINTI "The boots appear to be similar to "
	PRINTI "the foot prints that you found in the "
	PRINTR "side yard."
?L6:	EQUAL? PRSA,V?EXAMINE \?L16
	PRINTR "They're just ordinary gardening boots, with some fresh adobe mud around the bottom."
?L16:	EQUAL? PRSA,V?TAKE \FALSE
	FCLEAR MUDDY-SHOES,NDESCBIT
	RFALSE

	.FUNCT BED-F,RARG=100
	EQUAL? RARG,100 \FALSE
	EQUAL? PRSA,V?LOOK-ON,V?LOOK-INSIDE,V?EXAMINE \?L3
	EQUAL? HERE,MONICA-ROOM \?L3
	IN? MONICA,MONICA-ROOM \?L3
	PRINTR "Monica is lying on her bed, softly sobbing."
?L3:	EQUAL? PRSA,V?LOOK-UNDER \FALSE
	PRINTR "If you wanted to find the bogey man, you're out of luck."

	.FUNCT GLOBAL-CALL-F
	EQUAL? PRSA,V?WALK,V?TURN \FALSE
	PRINTR "(Use compass directions to move around here.)"

	.FUNCT CORPSE-F,ARG=0,T
	SUB PRESENT-TIME,MURDER-TIME >T
	EQUAL? ARG,M-OBJDESC \?L1
	PRINTR "The body of Mr. Linder is still crumpled in a heap on the floor."
?L1:	EQUAL? PRSA,V?ANALYZE \?L5
	EQUAL? PRSO,CORPSE \?L5
	EQUAL? PRSI,TUMOR \?L6
	SET 'DUFFY-SAW-MEDICAL-REPORT,1
?L6:	PRINTR "Only the coroner can do that."
?L5:	EQUAL? PRSA,V?ARREST \?L11
	EQUAL? PRSO,CORPSE \?L11
	CALL ARREST,GLOBAL-LINDER >STACK
	RSTACK
?L11:	EQUAL? PRSA,V?$0024CALL,V?PHONE /?L13
	EQUAL? PRSA,V?TELL,V?ASK-FOR,V?ASK-ABOUT \?L12
?L13:	EQUAL? PRSO,CORPSE \?L12
	PRINTI "Talking to corpses will get you nowhere."
	CRLF
	RETURN M-FATAL
?L12:	EQUAL? PRSA,V?TAKEOUT \?L16
	EQUAL? PRSI,LINDER-BACK-DOOR,MONICA-BACK-DOOR,OFFICE-BACK-DOOR \?L16
	PRINTI "You can't move"
	CALL THE-PRSO-PRINT
	PRINTR "."
?L16:	EQUAL? PRSA,V?TIE-WITH,V?TIE-TO \?L19
	PRINTR "Don't tell me you think the body's going to run away!"
?L19:	EQUAL? PRSA,V?RUB,V?EXAMINE \FALSE
	LESS? T,10 \?L23
	PRINTR "The blood is still spreading on Linder's shirt."
?L23:	LESS? T,60 \?L27
	PRINTR "The blood on Linder's shirt has clotted and turned dark."
?L27:	LESS? T,180 \?L30
	PRINTR "Linder's body is getting stiff."
?L30:	PRINTR "The corpse is pretty stiff now."

	.FUNCT GLOBAL-WARRANT-F
	EQUAL? PRSA,V?FIND,V?TAKE \FALSE
	PRINTR "Knowing the courts, it would probably take days to get one."

	.FUNCT STUB-F
	EQUAL? PRSA,V?READ,V?EXAMINE \FALSE
	GET 0,8 >STACK
	BOR STACK,2 >STACK
	PUT 0,8,STACK
	PRINTI "
   #570716

BIJOU THEATRE

  ADMIT ONE

   25 CENTS

-^-^-^-^-^-^-
"
	CRLF
	GET 0,8 >STACK
	BAND STACK,-3 >STACK
	PUT 0,8,STACK
	RTRUE

	.FUNCT MIRROR-F
	EQUAL? PRSA,V?MUNG \?L1
	PRINTI "According to superstition, it's bad luck to break mirrors."
	CRLF
	CALL PRINT-ID,STR?170 >STACK
	RSTACK
?L1:	EQUAL? PRSA,V?LOOK-INSIDE \FALSE
	PRINTR "A harried and weary police detective looks back at you, with a look that seems to say, ""Look what the cat dragged in."""

	.FUNCT CLOSET-F
	EQUAL? HERE,MONICA-ROOM,LINDER-ROOM,BUTLER-ROOM /?L1
	EQUAL? HERE,ENTRY /?L1
	SET 'P-WON,0
	PRINTI "(You can't see any "
	PRINTI "closet"
	PRINTR " here!)"
?L1:	EQUAL? PRSA,V?OPEN /?L6
	EQUAL? PRSA,V?SEARCH,V?LOOK-INSIDE,V?EXAMINE \?L5
?L6:	PRINTR "You open the closet and find a bunch of stylish clothes, but nothing in your size."
?L5:	EQUAL? PRSA,V?THROUGH \FALSE
	PRINTR "The closet's too crowded to get in."

	.FUNCT GLOBAL-CAN-OF-WORMS-F
	EQUAL? PHONG,PRSO,WINNER /FALSE
	EQUAL? PRSA,V?FIND \?L3
	PRINTR "In a sense, they're all around you!"
?L3:	EQUAL? PRSA,V?WHAT \?L6
	PRINTR "That would be telling!"
?L6:	EQUAL? HERE,KITCHEN \FALSE
	PRINTR "This case is tangled enough already."

	.FUNCT RANDOM-MEAL-F
	EQUAL? PRSA,V?FIND /?L3
	EQUAL? PRSA,V?EAT,V?ASK-FOR,V?ASK-ABOUT \?L1
?L3:	PRINTR "The blue-plate special at the diner was enough for you."
?L1:	PRINTR "What a strange notion!"

	.FUNCT GLOBAL-HOUSE-F
	EQUAL? PRSA,V?WALK-AROUND \FALSE
	PRINTR "(Use compass directions to move around here.)"

	.INSERT "witness/witness_str"
	.END
